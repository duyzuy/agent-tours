!function(){"use strict";let t,r,n,o,a,l;var i,s,d,c,u,m,f,g,p=function(t){if(null===t)return"null";if(void 0===t)return"undefined";var r=typeof t;return"object"===r&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":r},h=function(t){return{eq:t}},b=h(function(t,r){return t===r}),v=function(t){return h(function(r,n){if(r.length!==n.length)return!1;for(var o=r.length,a=0;a<o;a++)if(!t.eq(r[a],n[a]))return!1;return!0})},y=function(t){return h(function(r,n){var o,a,l=Object.keys(r),i=Object.keys(n);if(!(o=v(b),a=function(t){var r;return r=void 0,Array.prototype.slice.call(t).sort(r)},h(function(t,r){return o.eq(a(t),a(r))})).eq(l,i))return!1;for(var s=l.length,d=0;d<s;d++){var c=l[d];if(!t.eq(r[c],n[c]))return!1}return!0})},C=h(function(t,r){if(t===r)return!0;var n=p(t);return n===p(r)&&(-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(n)?t===r:"array"===n?v(C).eq(t,r):"object"===n&&y(C).eq(t,r))});let w=Object.getPrototypeOf,x=(t,r,n)=>{var o;return!!n(t,r.prototype)||(null===(o=t.constructor)||void 0===o?void 0:o.name)===r.name},E=t=>r=>(t=>{let r=typeof t;return null===t?"null":"object"===r&&Array.isArray(t)?"array":"object"===r&&x(t,String,(t,r)=>r.isPrototypeOf(t))?"string":r})(r)===t,k=t=>r=>typeof r===t,S=t=>r=>t===r,_=(t,r)=>R(t)&&x(t,r,(t,r)=>w(t)===r),N=E("string"),R=E("object"),A=t=>_(t,Object),O=E("array"),T=S(null),B=k("boolean"),D=S(void 0),P=t=>null==t,L=t=>!P(t),F=k("function"),M=k("number"),I=(t,r)=>{if(O(t)){for(let n=0,o=t.length;n<o;++n)if(!r(t[n]))return!1;return!0}return!1},U=()=>{},z=(t,r)=>(...n)=>t(r.apply(null,n)),j=(t,r)=>n=>t(r(n)),H=t=>()=>t,$=t=>t,q=(t,r)=>t===r;function V(t,...r){return(...n)=>{let o=r.concat(n);return t.apply(null,o)}}let W=t=>r=>!t(r),K=t=>()=>{throw Error(t)},G=t=>t(),Y=t=>{t()},X=H(!1),Q=H(!0);class J{constructor(t,r){this.tag=t,this.value=r}static some(t){return new J(!0,t)}static none(){return J.singletonNone}fold(t,r){return this.tag?r(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?J.some(t(this.value)):J.none()}bind(t){return this.tag?t(this.value):J.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:J.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw Error(null!=t?t:"Called getOrDie on None")}static from(t){return L(t)?J.some(t):J.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}J.singletonNone=new J(!1);let Z=Array.prototype.slice,ee=Array.prototype.indexOf,et=Array.prototype.push,er=(t,r)=>ee.call(t,r),en=(t,r)=>er(t,r)>-1,eo=(t,r)=>{for(let n=0,o=t.length;n<o;n++)if(r(t[n],n))return!0;return!1},ea=(t,r)=>{let n=t.length,o=Array(n);for(let a=0;a<n;a++){let n=t[a];o[a]=r(n,a)}return o},el=(t,r)=>{for(let n=0,o=t.length;n<o;n++)r(t[n],n)},ei=(t,r)=>{for(let n=t.length-1;n>=0;n--)r(t[n],n)},es=(t,r)=>{let n=[],o=[];for(let a=0,l=t.length;a<l;a++){let l=t[a];(r(l,a)?n:o).push(l)}return{pass:n,fail:o}},ed=(t,r)=>{let n=[];for(let o=0,a=t.length;o<a;o++){let a=t[o];r(a,o)&&n.push(a)}return n},ec=(t,r,n)=>(ei(t,(t,o)=>{n=r(n,t,o)}),n),eu=(t,r,n)=>(el(t,(t,o)=>{n=r(n,t,o)}),n),em=(t,r,n)=>{for(let o=0,a=t.length;o<a;o++){let a=t[o];if(r(a,o))return J.some(a);if(n(a,o))break}return J.none()},ef=(t,r)=>em(t,r,X),eg=(t,r)=>{for(let n=0,o=t.length;n<o;n++)if(r(t[n],n))return J.some(n);return J.none()},ep=t=>{let r=[];for(let n=0,o=t.length;n<o;++n){if(!O(t[n]))throw Error("Arr.flatten item "+n+" was not an array, input: "+t);et.apply(r,t[n])}return r},eh=(t,r)=>ep(ea(t,r)),eb=(t,r)=>{for(let n=0,o=t.length;n<o;++n)if(!0!==r(t[n],n))return!1;return!0},ev=t=>{let r=Z.call(t,0);return r.reverse(),r},ey=(t,r)=>ed(t,t=>!en(r,t)),eC=(t,r)=>{let n={};for(let o=0,a=t.length;o<a;o++){let a=t[o];n[String(a)]=r(a,o)}return n},ew=(t,r)=>{let n=Z.call(t,0);return n.sort(r),n},ex=(t,r)=>r>=0&&r<t.length?J.some(t[r]):J.none(),eE=t=>ex(t,0),ek=t=>ex(t,t.length-1),eS=F(Array.from)?Array.from:t=>Z.call(t),e_=(t,r)=>{for(let n=0;n<t.length;n++){let o=r(t[n],n);if(o.isSome())return o}return J.none()},eN=Object.keys,eR=Object.hasOwnProperty,eA=(t,r)=>{let n=eN(t);for(let o=0,a=n.length;o<a;o++){let a=n[o];r(t[a],a)}},eO=(t,r)=>eT(t,(t,n)=>({k:n,v:r(t,n)})),eT=(t,r)=>{let n={};return eA(t,(t,o)=>{let a=r(t,o);n[a.k]=a.v}),n},eB=t=>(r,n)=>{t[n]=r},eD=(t,r,n,o)=>{eA(t,(t,a)=>{(r(t,a)?n:o)(t,a)})},eP=(t,r)=>{let n={};return eD(t,r,eB(n),U),n},eL=(t,r)=>{let n=[];return eA(t,(t,o)=>{n.push(r(t,o))}),n},eF=t=>eL(t,$),eM=(t,r)=>eI(t,r)?J.from(t[r]):J.none(),eI=(t,r)=>eR.call(t,r),eU=(t,r)=>eI(t,r)&&void 0!==t[r]&&null!==t[r],ez=t=>{let r={};return el(t,t=>{r[t]={}}),eN(r)},ej=t=>void 0!==t.length,eH=Array.isArray,e$=(t,r,n)=>{if(!t)return!1;if(n=n||t,ej(t)){for(let o=0,a=t.length;o<a;o++)if(!1===r.call(n,t[o],o,t))return!1}else for(let o in t)if(eI(t,o)&&!1===r.call(n,t[o],o,t))return!1;return!0},eq=(t,r)=>{let n=[];return e$(t,(o,a)=>{n.push(r(o,a,t))}),n},eV=(t,r)=>{let n=[];return e$(t,(o,a)=>{r&&!r(o,a,t)||n.push(o)}),n},eW=(t,r,n,o)=>{let a=D(n)?t[0]:n;for(let n=0;n<t.length;n++)a=r.call(o,a,t[n],n);return a},eK=(t,r,n)=>{for(let o=0,a=t.length;o<a;o++)if(r.call(n,t[o],o,t))return o;return -1},eG=t=>t[t.length-1],eY=t=>{let r,n=!1;return(...o)=>(n||(n=!0,r=t.apply(null,o)),r)},eX=()=>eQ(0,0),eQ=(t,r)=>({major:t,minor:r}),eJ=(t,r)=>{let n=String(r).toLowerCase();return 0===t.length?eX():((t,r)=>{let n=((t,r)=>{for(let n=0;n<t.length;n++){let o=t[n];if(o.test(r))return o}})(t,r);if(!n)return{major:0,minor:0};let o=t=>Number(r.replace(n,"$"+t));return eQ(o(1),o(2))})(t,n)},eZ=(t,r)=>{let n=String(r).toLowerCase();return ef(t,t=>t.search(n))},e0=(t,r,n)=>""===r||t.length>=r.length&&t.substr(n,n+r.length)===r,e1=(t,r)=>{let n;return e3(t,r)?(n=r.length,t.substring(n)):t},e2=(t,r,n=0,o)=>{let a=t.indexOf(r,n);return -1!==a&&(!!D(o)||a+r.length<=o)},e3=(t,r)=>e0(t,r,0),e8=(t,r)=>e0(t,r,t.length-r.length),e5=t=>r=>r.replace(t,""),e6=e5(/^\s+|\s+$/g),e9=e5(/^\s+/g),e4=e5(/\s+$/g),e7=t=>t.length>0,te=t=>!e7(t),tt=(t,r=10)=>{let n=parseInt(t,r);return isNaN(n)?J.none():J.some(n)},tr=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,tn=t=>r=>e2(r,t),to=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:t=>e2(t,"edge/")&&e2(t,"chrome")&&e2(t,"safari")&&e2(t,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,tr],search:t=>e2(t,"chrome")&&!e2(t,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:t=>e2(t,"msie")||e2(t,"trident")},{name:"Opera",versionRegexes:[tr,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:tn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:tn("firefox")},{name:"Safari",versionRegexes:[tr,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:t=>(e2(t,"safari")||e2(t,"mobile/"))&&e2(t,"applewebkit")}],ta=[{name:"Windows",search:tn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:t=>e2(t,"iphone")||e2(t,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:tn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:tn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:tn("linux"),versionRegexes:[]},{name:"Solaris",search:tn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:tn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:tn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],tl={browsers:H(to),oses:H(ta)},ti="Edge",ts="Chromium",td="Opera",tc="Firefox",tu="Safari",tm=t=>{let r=t.current,n=t.version,o=t=>()=>r===t;return{current:r,version:n,isEdge:o(ti),isChromium:o(ts),isIE:o("IE"),isOpera:o(td),isFirefox:o(tc),isSafari:o(tu)}},tf=()=>tm({current:void 0,version:eX()}),tg=(H(ti),H(ts),H("IE"),H(td),H(tc),H(tu),"Windows"),tp="Android",th="Linux",tb="macOS",tv="Solaris",ty="FreeBSD",tC="ChromeOS",tw=t=>{let r=t.current,n=t.version,o=t=>()=>r===t;return{current:r,version:n,isWindows:o(tg),isiOS:o("iOS"),isAndroid:o(tp),isMacOS:o(tb),isLinux:o(th),isSolaris:o(tv),isFreeBSD:o(ty),isChromeOS:o(tC)}},tx=()=>tw({current:void 0,version:eX()}),tE=(H(tg),H("iOS"),H(tp),H(th),H(tb),H(tv),H(ty),H(tC),t=>window.matchMedia(t).matches),tk=eY(()=>((t,r,n)=>{let o=tl.browsers(),a=tl.oses(),l=r.bind(t=>e_(t.brands,t=>{let r=t.brand.toLowerCase();return ef(o,t=>{var n;return r===(null===(n=t.brand)||void 0===n?void 0:n.toLowerCase())}).map(r=>({current:r.name,version:eQ(parseInt(t.version,10),0)}))})).orThunk(()=>eZ(o,t).map(r=>{let n=eJ(r.versionRegexes,t);return{current:r.name,version:n}})).fold(tf,tm),i=eZ(a,t).map(r=>{let n=eJ(r.versionRegexes,t);return{current:r.name,version:n}}).fold(tx,tw),s=((t,r,n,o)=>{let a=t.isiOS()&&!0===/ipad/i.test(n),l=t.isiOS()&&!a,i=t.isiOS()||t.isAndroid(),s=i||o("(pointer:coarse)"),d=a||!l&&i&&o("(min-device-width:768px)"),c=l||i&&!d,u=r.isSafari()&&t.isiOS()&&!1===/safari/i.test(n);return{isiPad:H(a),isiPhone:H(l),isTablet:H(d),isPhone:H(c),isTouch:H(s),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:H(u),isDesktop:H(!c&&!d&&!u)}})(i,l,t,n);return{browser:l,os:i,deviceType:s}})(navigator.userAgent,J.from(navigator.userAgentData),tE)),tS=()=>tk(),t_=navigator.userAgent,tN=tS(),tR=tN.browser,tA=tN.os,tO=tN.deviceType,tT=-1!==t_.indexOf("Windows Phone"),tB={transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",documentMode:tR.isIE()?document.documentMode||7:10,cacheSuffix:null,container:null,canHaveCSP:!tR.isIE(),windowsPhone:tT,browser:{current:tR.current,version:tR.version,isChromium:tR.isChromium,isEdge:tR.isEdge,isFirefox:tR.isFirefox,isIE:tR.isIE,isOpera:tR.isOpera,isSafari:tR.isSafari},os:{current:tA.current,version:tA.version,isAndroid:tA.isAndroid,isChromeOS:tA.isChromeOS,isFreeBSD:tA.isFreeBSD,isiOS:tA.isiOS,isLinux:tA.isLinux,isMacOS:tA.isMacOS,isSolaris:tA.isSolaris,isWindows:tA.isWindows},deviceType:{isDesktop:tO.isDesktop,isiPad:tO.isiPad,isiPhone:tO.isiPhone,isPhone:tO.isPhone,isTablet:tO.isTablet,isTouch:tO.isTouch,isWebView:tO.isWebView}},tD=/^\s*|\s*$/g,tP=t=>P(t)?"":(""+t).replace(tD,""),tL=function(t,r,n,o){o=o||this,t&&(n&&(t=t[n]),e$(t,(t,a)=>!1!==r.call(o,t,a,n)&&(tL(t,r,n,o),!0)))},tF={trim:tP,isArray:eH,is:(t,r)=>r?!("array"!==r||!eH(t))||typeof t===r:void 0!==t,toArray:t=>{if(eH(t))return t;{let r=[];for(let n=0,o=t.length;n<o;n++)r[n]=t[n];return r}},makeMap:(t,r,n={})=>{let o=N(t)?t.split(r||","):t||[],a=o.length;for(;a--;)n[o[a]]={};return n},each:e$,map:eq,grep:eV,inArray:(t,r)=>{if(t){for(let n=0,o=t.length;n<o;n++)if(t[n]===r)return n}return -1},hasOwn:eI,extend:(t,...r)=>{for(let n=0;n<r.length;n++){let o=r[n];for(let r in o)if(eI(o,r)){let n=o[r];void 0!==n&&(t[r]=n)}}return t},walk:tL,resolve:(t,r=window)=>{let n=t.split(".");for(let t=0,o=n.length;t<o&&(r=r[n[t]]);t++);return r},explode:(t,r)=>O(t)?t:""===t?[]:eq(t.split(r||","),tP),_addCacheSuffix:t=>{let r=tB.cacheSuffix;return r&&(t+=(-1===t.indexOf("?")?"?":"&")+r),t}},tM=(t,r,n=q)=>t.exists(t=>n(t,r)),tI=(t,r,n=q)=>tU(t,r,n).getOr(t.isNone()&&r.isNone()),tU=(t,r,n)=>t.isSome()&&r.isSome()?J.some(n(t.getOrDie(),r.getOrDie())):J.none(),tz=(t,r)=>t?J.some(r):J.none(),tj="undefined"!=typeof window?window:Function("return this;")(),tH=(t,r)=>((t,r)=>{let n=null!=r?r:tj;for(let r=0;r<t.length&&null!=n;++r)n=n[t[r]];return n})(t.split("."),r),t$=Object.getPrototypeOf,tq=t=>{let r=tH("ownerDocument.defaultView",t);return R(t)&&(((t,r)=>{let n=tH(t,r);if(null==n)throw Error(t+" not available on this browser");return n})("HTMLElement",r).prototype.isPrototypeOf(t)||/^HTML\w*Element$/.test(t$(t).constructor.name))},tV=t=>t.dom.nodeName.toLowerCase(),tW=t=>t.dom.nodeType,tK=t=>r=>tW(r)===t,tG=t=>tY(t)&&tq(t.dom),tY=tK(1),tX=tK(3),tQ=tK(9),tJ=tK(11),tZ=t=>r=>tY(r)&&tV(r)===t,t0=(t,r,n)=>{if(!(N(n)||B(n)||M(n)))throw console.error("Invalid call to Attribute.set. Key ",r,":: Value ",n,":: Element ",t),Error("Attribute value was not simple");t.setAttribute(r,n+"")},t1=(t,r,n)=>{t0(t.dom,r,n)},t2=(t,r)=>{let n=t.dom;eA(r,(t,r)=>{t0(n,r,t)})},t3=(t,r)=>{let n=t.dom.getAttribute(r);return null===n?void 0:n},t8=(t,r)=>J.from(t3(t,r)),t5=(t,r)=>{let n=t.dom;return!(!n||!n.hasAttribute)&&n.hasAttribute(r)},t6=(t,r)=>{t.dom.removeAttribute(r)},t9=t=>eu(t.dom.attributes,(t,r)=>(t[r.name]=r.value,t),{}),t4=(t,r)=>{let n=t3(t,r);return void 0===n||""===n?[]:n.split(" ")},t7=t=>void 0!==t.dom.classList,re=t=>t4(t,"class"),rt=(t,r)=>((t,r,n)=>{let o=t4(t,r).concat([n]);return t1(t,r,o.join(" ")),!0})(t,"class",r),rr=(t,r)=>((t,r,n)=>{let o=ed(t4(t,r),t=>t!==n);return o.length>0?t1(t,r,o.join(" ")):t6(t,r),!1})(t,"class",r),rn=(t,r)=>{t7(t)?t.dom.classList.add(r):rt(t,r)},ro=t=>{0===(t7(t)?t.dom.classList:re(t)).length&&t6(t,"class")},ra=(t,r)=>{t7(t)?t.dom.classList.remove(r):rr(t,r),ro(t)},rl=(t,r)=>t7(t)&&t.dom.classList.contains(r),ri=t=>{if(null==t)throw Error("Node cannot be null or undefined");return{dom:t}},rs=(t,r)=>{let n=(r||document).createElement("div");if(n.innerHTML=t,!n.hasChildNodes()||n.childNodes.length>1){let r="HTML does not have a single root node";throw console.error(r,t),Error(r)}return ri(n.childNodes[0])},rd=(t,r)=>ri((r||document).createElement(t)),rc=(t,r)=>ri((r||document).createTextNode(t)),ru=(t,r,n)=>J.from(t.dom.elementFromPoint(r,n)).map(ri),rm=(t,r)=>{let n=[],o=t=>(n.push(t),r(t)),a=r(t);do a=a.bind(o);while(a.isSome());return n},rf=(t,r)=>{let n=t.dom;if(1!==n.nodeType)return!1;if(void 0!==n.matches)return n.matches(r);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(r);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(r);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(r);throw Error("Browser lacks native selectors")},rg=t=>1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount,rp=(t,r)=>t.dom===r.dom,rh=(t,r)=>{let n=t.dom,o=r.dom;return n!==o&&n.contains(o)},rb=t=>ri(t.dom.ownerDocument),rv=t=>tQ(t)?t:rb(t),ry=t=>ri(rv(t).dom.defaultView),rC=t=>J.from(t.dom.parentNode).map(ri),rw=t=>J.from(t.dom.parentElement).map(ri),rx=(t,r)=>{let n=F(r)?r:X,o=t.dom,a=[];for(;null!==o.parentNode&&void 0!==o.parentNode;){let t=o.parentNode,r=ri(t);if(a.push(r),!0===n(r))break;o=t}return a},rE=t=>J.from(t.dom.previousSibling).map(ri),rk=t=>J.from(t.dom.nextSibling).map(ri),rS=t=>ev(rm(t,rE)),r_=t=>rm(t,rk),rN=t=>ea(t.dom.childNodes,ri),rR=(t,r)=>{let n=t.dom.childNodes;return J.from(n[r]).map(ri)},rA=t=>rR(t,0),rO=t=>rR(t,t.dom.childNodes.length-1),rT=t=>t.dom.childNodes.length,rB=t=>tJ(t)&&L(t.dom.host),rD=F(Element.prototype.attachShadow)&&F(Node.prototype.getRootNode),rP=H(rD),rL=rD?t=>ri(t.dom.getRootNode()):rv,rF=t=>rB(t)?t:(t=>{let r=t.dom.head;if(null==r)throw Error("Head is not available yet");return ri(r)})(rv(t)),rM=t=>ri(t.dom.host),rI=t=>{if(rP()&&L(t.target)){let r=ri(t.target);if(tY(r)&&rU(r)&&t.composed&&t.composedPath){let r=t.composedPath();if(r)return eE(r)}}return J.from(t.target)},rU=t=>L(t.dom.shadowRoot),rz=t=>{let r=tX(t)?t.dom.parentNode:t.dom;if(null==r||null===r.ownerDocument)return!1;let n=r.ownerDocument;return(t=>{let r=rL(t);return rB(r)?J.some(r):J.none()})(ri(r)).fold(()=>n.body.contains(r),j(rz,rM))};var rj=(t,r,n,o,a)=>t(n,o)?J.some(n):F(a)&&a(n)?J.none():r(n,o,a);let rH=(t,r,n)=>{let o=t.dom,a=F(n)?n:X;for(;o.parentNode;){let t=ri(o=o.parentNode);if(r(t))return J.some(t);if(a(t))break}return J.none()},r$=(t,r,n)=>rj((t,r)=>r(t),rH,t,r,n),rq=(t,r,n)=>rH(t,t=>rf(t,r),n),rV=(t,r)=>((t,r)=>{let n=void 0===r?document:r.dom;return rg(n)?J.none():J.from(n.querySelector(t)).map(ri)})(r,t),rW=(t,r,n)=>rj((t,r)=>rf(t,r),rq,t,r,n),rK=(t,r=!1)=>rz(t)?t.dom.isContentEditable:rW(t,"[contenteditable]").fold(H(r),t=>"true"===rG(t)),rG=t=>t.dom.contentEditable,rY=t=>void 0!==t.style&&F(t.style.getPropertyValue),rX=(t,r,n)=>{if(!N(n))throw console.error("Invalid call to CSS.set. Property ",r,":: Value ",n,":: Element ",t),Error("CSS value must be a string: "+n);rY(t)&&t.style.setProperty(r,n)},rQ=(t,r,n)=>{rX(t.dom,r,n)},rJ=(t,r)=>{let n=t.dom;eA(r,(t,r)=>{rX(n,r,t)})},rZ=(t,r)=>{let n=t.dom,o=window.getComputedStyle(n).getPropertyValue(r);return""!==o||rz(t)?o:r0(n,r)},r0=(t,r)=>rY(t)?t.style.getPropertyValue(r):"",r1=(t,r)=>{let n=r0(t.dom,r);return J.from(n).filter(t=>t.length>0)},r2=t=>{let r={},n=t.dom;if(rY(n))for(let t=0;t<n.style.length;t++){let o=n.style.item(t);r[o]=n.style[o]}return r},r3=(t,r)=>{var n;rY(n=t.dom)&&n.style.removeProperty(r),tM(t8(t,"style").map(e6),"")&&t6(t,"style")},r8=(t,r)=>{rC(t).each(n=>{n.dom.insertBefore(r.dom,t.dom)})},r5=(t,r)=>{rk(t).fold(()=>{rC(t).each(t=>{r9(t,r)})},t=>{r8(t,r)})},r6=(t,r)=>{rA(t).fold(()=>{r9(t,r)},n=>{t.dom.insertBefore(r.dom,n.dom)})},r9=(t,r)=>{t.dom.appendChild(r.dom)},r4=(t,r)=>{r8(t,r),r9(r,t)},r7=(t,r)=>{el(r,r=>{r9(t,r)})},ne=t=>{t.dom.textContent="",el(rN(t),t=>{nt(t)})},nt=t=>{let r=t.dom;null!==r.parentNode&&r.parentNode.removeChild(r)},nr=t=>{let r=rN(t);r.length>0&&el(r,(n,o)=>{r5(0===o?t:r[o-1],n)}),nt(t)},nn=t=>ea(t,ri),no=t=>t.dom.innerHTML,na=(t,r)=>{let n=rb(t).dom,o=ri(n.createDocumentFragment());r7(o,((t,r)=>{let n=(r||document).createElement("div");return n.innerHTML=t,rN(ri(n))})(r,n)),ne(t),r9(t,o)},nl=(t,r,n,o)=>((t,r,n,o,a)=>{let l=t=>{n(t)&&o((t=>{let r=ri(rI(t).getOr(t.target)),n=()=>t.stopPropagation(),o=()=>t.preventDefault(),a=z(o,n);return{target:r,x:t.clientX,y:t.clientY,stop:n,prevent:o,kill:a,raw:t}})(t))};return t.dom.addEventListener(r,l,!1),{unbind:V(ni,t,r,l,!1)}})(t,r,n,o),ni=(t,r,n,o)=>{t.dom.removeEventListener(r,n,o)},ns=(t,r)=>({left:t,top:r,translate:(n,o)=>ns(t+n,r+o)}),nd=(t,r)=>void 0!==t?t:void 0!==r?r:0,nc=t=>{let r=t.dom,n=r.ownerDocument.body;return n===r?ns(n.offsetLeft,n.offsetTop):rz(t)?(t=>{let r=t.getBoundingClientRect();return ns(r.left,r.top)})(r):ns(0,0)},nu=t=>{let r=void 0!==t?t.dom:document;return ns(r.body.scrollLeft||r.documentElement.scrollLeft,r.body.scrollTop||r.documentElement.scrollTop)},nm=(t,r,n)=>{let o=(void 0!==n?n.dom:document).defaultView;o&&o.scrollTo(t,r)},nf=(t,r)=>{tS().browser.isSafari()&&F(t.dom.scrollIntoViewIfNeeded)?t.dom.scrollIntoViewIfNeeded(!1):t.dom.scrollIntoView(r)},ng=(t,r,n,o)=>({x:t,y:r,width:n,height:o,right:t+n,bottom:r+o}),np=t=>{let r=void 0===t?window:t,n=nu(ri(r.document));return(t=>{let r=void 0===t?window:t;return tS().browser.isFirefox()?J.none():J.from(r.visualViewport)})(r).fold(()=>{let t=r.document.documentElement,o=t.clientWidth,a=t.clientHeight;return ng(n.left,n.top,o,a)},t=>ng(Math.max(t.pageLeft,n.left),Math.max(t.pageTop,n.top),t.width,t.height))},nh=(t,r)=>{let n=[];return el(rN(t),t=>{r(t)&&(n=n.concat([t])),n=n.concat(nh(t,r))}),n},nb=(t,r)=>((t,r)=>{let n=void 0===r?document:r.dom;return rg(n)?[]:ea(n.querySelectorAll(t),ri)})(r,t),nv=(t,r,n)=>rq(t,r,n).isSome();class ny{constructor(t,r){this.node=t,this.rootNode=r,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}current(){return this.node}next(t){return this.node=this.findSibling(this.node,"firstChild","nextSibling",t),this.node}prev(t){return this.node=this.findSibling(this.node,"lastChild","previousSibling",t),this.node}prev2(t){return this.node=this.findPreviousNode(this.node,t),this.node}findSibling(t,r,n,o){if(t){if(!o&&t[r])return t[r];if(t!==this.rootNode){let r=t[n];if(r)return r;for(let o=t.parentNode;o&&o!==this.rootNode;o=o.parentNode)if(r=o[n])return r}}}findPreviousNode(t,r){if(t){let n=t.previousSibling;if(this.rootNode&&n===this.rootNode)return;if(n){if(!r){for(let t=n.lastChild;t;t=t.lastChild)if(!t.lastChild)return t}return n}let o=t.parentNode;if(o&&o!==this.rootNode)return o}}}let nC=t=>r=>!!r&&r.nodeType===t,nw=t=>!!t&&!Object.getPrototypeOf(t),nx=nC(1),nE=t=>{let r=t.toLowerCase();return t=>L(t)&&t.nodeName.toLowerCase()===r},nk=t=>{let r=t.map(t=>t.toLowerCase());return t=>!!t&&!!t.nodeName&&en(r,t.nodeName.toLowerCase())},nS=(t,r)=>{let n=r.toLowerCase().split(" ");return r=>{if(nx(r)){let o=r.ownerDocument.defaultView;if(o)for(let a=0;a<n.length;a++){let l=o.getComputedStyle(r,null);if((l?l.getPropertyValue(t):null)===n[a])return!0}}return!1}},n_=t=>r=>nx(r)&&r.hasAttribute(t),nN=t=>nx(t)&&t.hasAttribute("data-mce-bogus"),nR=t=>nx(t)&&"TABLE"===t.tagName,nA=t=>r=>!!nx(r)&&(r.contentEditable===t||r.getAttribute("data-mce-contenteditable")===t),nO=nk(["textarea","input"]),nT=nC(3),nB=nC(4),nD=nC(7),nP=nC(8),nL=nC(9),nF=nC(11),nM=nE("br"),nI=nE("img"),nU=nA("true"),nz=nA("false"),nj=nk(["td","th"]),nH=nk(["td","th","caption"]),n$=nk(["video","audio","object","embed"]),nq=nE("li"),nV=nE("details"),nW=nE("summary"),nK=t=>"\uFEFF"===t,nG=((t,r)=>{let n=r=>t(r)?J.from(r.dom.nodeValue):J.none();return{get:r=>{if(!t(r))throw Error("Can only get text value of a text node");return n(r).getOr("")},getOption:n,set:(r,n)=>{if(!t(r))throw Error("Can only set raw text value of a text node");r.dom.nodeValue=n}}})(tX),nY=t=>nG.get(t),nX=t=>nG.getOption(t),nQ=["pre"].concat(["h1","h2","h3","h4","h5","h6"]),nJ=t=>{let r;return n=>eI(r=r||eC(t,Q),tV(n))},nZ=nJ(["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"]),n0=t=>tY(t)&&!nZ(t),n1=t=>tY(t)&&"br"===tV(t),n2=nJ(["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"]),n3=nJ(["ul","ol","dl"]),n8=nJ(["li","dd","dt"]),n5=nJ(["thead","tbody","tfoot"]),n6=nJ(["td","th"]),n9=nJ(["pre","script","textarea","style"]),n4=nJ(nQ),n7=t=>n4(t)||n0(t),oe=()=>{let t=rd("br");return t1(t,"data-mce-bogus","1"),t},ot=t=>{ne(t),r9(t,oe())},or=t=>{rO(t).each(r=>{rE(r).each(n=>{nZ(t)&&n1(r)&&nZ(n)&&nt(r)})})},on=t=>t.replace(/\uFEFF/g,""),oo=t=>(nT(t)&&(t=t.parentNode),nx(t)&&t.hasAttribute("data-mce-caret")),oa=t=>nT(t)&&nK(t.data),ol=t=>oo(t)||oa(t),oi=t=>t.firstChild!==t.lastChild||!nM(t.firstChild),os=t=>{let r=t.container();return!!nT(r)&&("\uFEFF"===r.data.charAt(t.offset())||t.isAtStart()&&oa(r.previousSibling))},od=t=>{let r=t.container();return!!nT(r)&&("\uFEFF"===r.data.charAt(t.offset()-1)||t.isAtEnd()&&oa(r.nextSibling))},oc=t=>nT(t)&&"\uFEFF"===t.data[0],ou=t=>nT(t)&&"\uFEFF"===t.data[t.data.length-1],om=t=>t&&t.hasAttribute("data-mce-caret")?((t=>{var r;let n=t.getElementsByTagName("br"),o=n[n.length-1];nN(o)&&(null===(r=o.parentNode)||void 0===r||r.removeChild(o))})(t),t.removeAttribute("data-mce-caret"),t.removeAttribute("data-mce-bogus"),t.removeAttribute("style"),t.removeAttribute("data-mce-style"),t.removeAttribute("_moz_abspos"),t):null,of=t=>oo(t.startContainer),og=nk(["script","style","textarea"]),op=nk(["img","input","textarea","hr","iframe","video","audio","object","embed"]),oh=nk(["table"]),ob=t=>!ol(t)&&(nT(t)?!og(t.parentNode):op(t)||nM(t)||oh(t)||ov(t)),ov=t=>!(nx(t)&&"true"===t.getAttribute("unselectable"))&&nz(t),oy=(t,r)=>ob(t)&&((t,r)=>{for(let n=t.parentNode;n&&n!==r;n=n.parentNode){if(ov(n))return!1;if(nU(n))break}return!0})(t,r),oC=/^[ \t\r\n]*$/,ow=t=>oC.test(t),ox=t=>{for(let r of t)if(!nK(r))return!1;return!0},oE=t=>"\n"===t||"\r"===t,ok=(t,r=4,n=!0,o=!0)=>{let a=r<=0?"":Array(r+1).join(" "),l=t.replace(/\t/g,a);return eu(l,(t,r)=>{let a;return -1!==" \f	\v".indexOf(r)||"\xa0"===r?t.pcIsSpace||""===t.str&&n||t.str.length===l.length-1&&o||(a=t.str.length+1)<l.length&&a>=0&&oE(l[a])?{pcIsSpace:!1,str:t.str+"\xa0"}:{pcIsSpace:!0,str:t.str+" "}:{pcIsSpace:oE(r),str:t.str+r}},{pcIsSpace:!1,str:""}).str},oS=(t,r)=>ob(t)&&(!(nT(t)&&ow(t.data))||!!((t,r)=>{let n=ri(r);return nv(ri(t),"pre,code",V(rp,n))})(t,r))||nx(t)&&"A"===t.nodeName&&!t.hasAttribute("href")&&(t.hasAttribute("name")||t.hasAttribute("id"))||o_(t),o_=n_("data-mce-bookmark"),oN=n_("data-mce-bogus"),oR=t=>nx(t)&&"all"===t.getAttribute("data-mce-bogus"),oA=(t,r=!0)=>((t,r)=>{let n=0;if(oS(t,t))return!1;{let o=t.firstChild;if(!o)return!0;let a=new ny(o,t);do{if(r){if(oR(o)){o=a.next(!0);continue}if(oN(o)){o=a.next();continue}}if(nM(o))n++,o=a.next();else{if(oS(o,t))return!1;o=a.next()}}while(o);return n<=1}})(t.dom,r),oO="data-mce-block",oT=t=>ed(eN(t),t=>!/[A-Z]/.test(t)).join(","),oB=(t,r)=>L(r.querySelector(t))?(r.setAttribute(oO,"true"),"inline-boundary"===r.getAttribute("data-mce-selected")&&r.removeAttribute("data-mce-selected"),!0):(r.removeAttribute(oO),!1),oD=(t,r)=>{let n=oT(t.getTransparentElements()),o=oT(t.getBlockElements());return ed(r.querySelectorAll(n),t=>oB(o,t))},oP=(t,r)=>{var n;let o=r?"lastChild":"firstChild";for(let r=t[o];r;r=r[o])if(oA(ri(r)))return void(null===(n=r.parentNode)||void 0===n||n.removeChild(r))},oL=(t,r,n)=>{let o=t.getBlockElements(),a=ri(r),l=t=>tV(t) in o,i=t=>rp(t,a);el(nn(n),r=>{rH(r,l,i).each(n=>{let o=ed(rN(r),r=>l(r)&&!t.isValidChild(tV(n),tV(r)));if(o.length>0){let r=rw(n);el(o,t=>{rH(t,l,i).each(r=>{((t,r)=>{let n=document.createRange(),o=t.parentNode;if(o){n.setStartBefore(t),n.setEndBefore(r);let a=n.extractContents();oP(a,!0),n.setStartAfter(r),n.setEndAfter(t);let l=n.extractContents();oP(l,!1),oA(ri(a))||o.insertBefore(a,t),oA(ri(r))||o.insertBefore(r,t),oA(ri(l))||o.insertBefore(l,t),o.removeChild(t)}})(r.dom,t.dom)})}),r.each(r=>oD(t,r.dom))}})})},oF=(t,r)=>{let n=oD(t,r);oL(t,r,n),el([...n,...oj(t,r)?[r]:[]],r=>el(nb(ri(r),r.nodeName.toLowerCase()),r=>{oH(t,r.dom)&&nr(r)}))},oM=(t,r)=>{oz(t,r)&&oB(oT(t.getBlockElements()),r)},oI=t=>t.hasAttribute(oO),oU=(t,r)=>eI(t.getTransparentElements(),r),oz=(t,r)=>nx(r)&&oU(t,r.nodeName),oj=(t,r)=>oz(t,r)&&oI(r),oH=(t,r)=>oz(t,r)&&!oI(r),o$=(t,r)=>1===r.type&&oU(t,r.name)&&N(r.attr(oO)),oq=tS().browser,oV=t=>ef(t,tY),oW=(t,r)=>t.children&&en(t.children,r),oK=(t,r={})=>{let n=0,o={},a=ri(t),l=rv(a),i=t=>new Promise((i,s)=>{let d;let c=tF._addCacheSuffix(t),u=eM(o,c).getOrThunk(()=>({id:"mce-u"+n++,passed:[],failed:[],count:0}));o[c]=u,u.count++;let m=(t,r)=>{el(t,Y),u.status=r,u.passed=[],u.failed=[],d&&(d.onload=null,d.onerror=null,d=null)},f=()=>m(u.passed,2),g=()=>m(u.failed,3);if(i&&u.passed.push(i),s&&u.failed.push(s),1===u.status)return;if(2===u.status)return void f();if(3===u.status)return void g();u.status=1;let p=rd("link",l.dom);t2(p,{rel:"stylesheet",type:"text/css",id:u.id}),r.contentCssCors&&t1(p,"crossOrigin","anonymous"),r.referrerPolicy&&t1(p,"referrerpolicy",r.referrerPolicy),(d=p.dom).onload=f,d.onerror=g,r9(rF(a),p),t1(p,"href",c)}),s=t=>{let r=tF._addCacheSuffix(t);eM(o,r).each(t=>{0==--t.count&&(delete o[r],(t=>{rV(rF(a),"#"+t).each(nt)})(t.id))})};return{load:i,loadAll:t=>Promise.allSettled(ea(t,t=>i(t).then(H(t)))).then(t=>{let r=es(t,t=>"fulfilled"===t.status);return r.fail.length>0?Promise.reject(ea(r.fail,t=>t.reason)):ea(r.pass,t=>t.value)}),unload:s,unloadAll:t=>{el(t,t=>{s(t)})},_setReferrerPolicy:t=>{r.referrerPolicy=t},_setContentCssCors:t=>{r.contentCssCors=t}}},oG=(()=>{let t=new WeakMap;return{forElement:(r,n)=>{let o=rL(r).dom;return J.from(t.get(o)).getOrThunk(()=>{let r=oK(o,n);return t.set(o,r),r})}}})(),oY=(t,r)=>L(t)&&(oS(t,r)||n0(ri(t))),oX=t=>"span"===t.nodeName.toLowerCase()&&"bookmark"===t.getAttribute("data-mce-type"),oQ=(t,r,n)=>{var o;let a=n||r;if(nx(r)&&oX(r))return r;let l=r.childNodes;for(let r=l.length-1;r>=0;r--)oQ(t,l[r],a);if(nx(r)){let t=r.childNodes;1===t.length&&oX(t[0])&&(null===(o=r.parentNode)||void 0===o||o.insertBefore(t[0],r))}return nF(r)||nL(r)||oS(r,a)||nx(r)&&r.childNodes.length>0||nT(r)&&r.data.length>0&&((t,r)=>{let n=new ny(t,r).prev(!1),o=new ny(t,r).next(!1),a=D(n)||oY(n,r),l=D(o)||oY(o,r);return a&&l})(r,a)||t.remove(r),r},oJ=tF.makeMap,oZ=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,o0=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,o1=/[<>&\"\']/g,o2=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,o3={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},o8={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},o5={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},o6=(t,r)=>{let n={};if(t){let o=t.split(",");r=r||10;for(let t=0;t<o.length;t+=2){let a=String.fromCharCode(parseInt(o[t],r));if(!o8[a]){let r="&"+o[t+1]+";";n[a]=r,n[r]=a}}return n}},o9=o6("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),o4=(t,r)=>t.replace(r?oZ:o0,t=>o8[t]||t),o7=(t,r)=>t.replace(r?oZ:o0,t=>t.length>1?"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";":o8[t]||"&#"+t.charCodeAt(0)+";"),ae=(t,r,n)=>{let o=n||o9;return t.replace(r?oZ:o0,t=>o8[t]||o[t]||t)},at={encodeRaw:o4,encodeAllRaw:t=>(""+t).replace(o1,t=>o8[t]||t),encodeNumeric:o7,encodeNamed:ae,getEncodeFunc:(t,r)=>{let n=o6(r)||o9,o=oJ(t.replace(/\+/g,","));return o.named&&o.numeric?(t,r)=>t.replace(r?oZ:o0,t=>void 0!==o8[t]?o8[t]:void 0!==n[t]?n[t]:t.length>1?"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";":"&#"+t.charCodeAt(0)+";"):o.named?r?(t,r)=>ae(t,r,n):ae:o.numeric?o7:o4},decode:t=>t.replace(o2,(t,r)=>r?(r="x"===r.charAt(0).toLowerCase()?parseInt(r.substr(1),16):parseInt(r,10))>65535?String.fromCharCode(55296+((r-=65536)>>10),56320+(1023&r)):o3[r]||String.fromCharCode(r):o5[t]||o9[t]||(t=>{let r=rd("div").dom;return r.innerHTML=t,r.textContent||r.innerText||t})(t))},ar=(t,r)=>(t=tF.trim(t))?t.split(r||" "):[],an=t=>RegExp("^"+t.replace(/([?+*])/g,".$1")+"$"),ao={},aa=tF.makeMap,al=tF.each,ai=tF.extend,as=tF.explode,ad=(t,r={})=>ai(aa(t," ",aa(t.toUpperCase()," ")),r),ac=t=>ad("td th li dt dd figcaption caption details summary",t.getTextBlockElements()),au=(t,r)=>{if(t){let n={};return N(t)&&(t={"*":t}),al(t,(t,o)=>{n[o]=n[o.toUpperCase()]="map"===r?aa(t,/[, ]/):as(t,/[, ]/)}),n}},am=(t={})=>{var r;let n={},o={},a=[],l={},i={},s=(r,n,o)=>{let a=t[r];if(a)return aa(a,/[, ]/,aa(a.toUpperCase(),/[, ]/));{let t=ao[r];return t||(t=ad(n,o),ao[r]=t),t}},d=null!==(r=t.schema)&&void 0!==r?r:"html5",c=(t=>{let r,n,o,a;let{globalAttributes:l,phrasingContent:i,flowContent:s}=(r="id accesskey class dir lang style tabindex title role",n="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",o="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==t&&(r+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",n+=" article aside details dialog figure main header footer hgroup section nav a ins del canvas map",o+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==t&&(r+=" xml:lang",o=[o,"acronym applet basefont big font strike tt"].join(" "),a=[n=[n,"center dir isindex noframes"].join(" "),o].join(" ")),a=a||[n,o].join(" "),{globalAttributes:r,blockContent:n,phrasingContent:o,flowContent:a}),d={},c=(t,r="",n="")=>{let o=ar(n),a=ar(t),i=a.length;for(;i--;){let t=ar([l,r].join(" "));d[a[i]]={attributes:eC(t,H({})),attributesOrder:t,children:eC(o,H({}))}}},u=(t,r)=>{let n=ar(t),o=ar(r),a=n.length;for(;a--;){let t=d[n[a]];for(let r=0,n=o.length;r<n;r++)t.attributes[o[r]]={},t.attributesOrder.push(o[r])}};return"html5-strict"!==t&&(el(ar("acronym applet basefont big font strike tt"),t=>{c(t,"",i)}),el(ar("center dir isindex noframes"),t=>{c(t,"",s)})),c("html","manifest","head body"),c("head","","base command link meta noscript script style title"),c("title hr noscript br"),c("base","href target"),c("link","href rel media hreflang type sizes hreflang"),c("meta","name http-equiv content charset"),c("style","media type scoped"),c("script","src async defer type charset"),c("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",s),c("dd div","",s),c("address dt caption","","html4"===t?i:s),c("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",i),c("blockquote","cite",s),c("ol","reversed start type","li"),c("ul","","li"),c("li","value",s),c("dl","","dt dd"),c("a","href target rel media hreflang type","html4"===t?i:s),c("q","cite",i),c("ins del","cite datetime",s),c("img","src sizes srcset alt usemap ismap width height"),c("iframe","src name width height",s),c("embed","src type width height"),c("object","data type typemustmatch name usemap form width height",[s,"param"].join(" ")),c("param","name value"),c("map","name",[s,"area"].join(" ")),c("area","alt coords shape href target rel media hreflang type"),c("table","border","caption colgroup thead tfoot tbody tr"+("html4"===t?" col":"")),c("colgroup","span","col"),c("col","span"),c("tbody thead tfoot","","tr"),c("tr","","td th"),c("td","colspan rowspan headers",s),c("th","colspan rowspan headers scope abbr",s),c("form","accept-charset action autocomplete enctype method name novalidate target",s),c("fieldset","disabled form name",[s,"legend"].join(" ")),c("label","form for",i),c("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),c("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===t?s:i),c("select","disabled form multiple name required size","option optgroup"),c("optgroup","disabled label","option"),c("option","disabled label selected value"),c("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),c("menu","type label",[s,"li"].join(" ")),c("noscript","",s),"html4"!==t&&(c("wbr"),c("ruby","",[i,"rt rp"].join(" ")),c("figcaption","",s),c("mark rt rp summary bdi","",i),c("canvas","width height",s),c("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[s,"track source"].join(" ")),c("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[s,"track source"].join(" ")),c("picture","","img source"),c("source","src srcset type media sizes"),c("track","kind src srclang label default"),c("datalist","",[i,"option"].join(" ")),c("article section nav aside main header footer","",s),c("hgroup","","h1 h2 h3 h4 h5 h6"),c("figure","",[s,"figcaption"].join(" ")),c("time","datetime",i),c("dialog","open",s),c("command","type label icon disabled checked radiogroup command"),c("output","for form name",i),c("progress","value max",i),c("meter","value min max low high optimum",i),c("details","open",[s,"summary"].join(" ")),c("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==t&&(u("script","language xml:space"),u("style","xml:space"),u("object","declare classid code codebase codetype archive standby align border hspace vspace"),u("embed","align name hspace vspace"),u("param","valuetype type"),u("a","charset name rev shape coords"),u("br","clear"),u("applet","codebase archive code object alt name width height align hspace vspace"),u("img","name longdesc align border hspace vspace"),u("iframe","longdesc frameborder marginwidth marginheight scrolling align"),u("font basefont","size color face"),u("input","usemap align"),u("select"),u("textarea"),u("h1 h2 h3 h4 h5 h6 div p legend caption","align"),u("ul","type compact"),u("li","type"),u("ol dl menu dir","compact"),u("pre","width xml:space"),u("hr","align noshade size width"),u("isindex","prompt"),u("table","summary width frame rules cellspacing cellpadding align bgcolor"),u("col","width align char charoff valign"),u("colgroup","width align char charoff valign"),u("thead","align char charoff valign"),u("tr","align char charoff valign bgcolor"),u("th","axis align char charoff valign nowrap bgcolor width height"),u("form","accept"),u("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),u("tfoot","align char charoff valign"),u("tbody","align char charoff valign"),u("area","nohref"),u("body","background bgcolor text link vlink alink")),"html4"!==t&&(u("input button select textarea","autofocus"),u("input textarea","placeholder"),u("a","download"),u("link script img","crossorigin"),u("img","loading"),u("iframe","sandbox seamless allow allowfullscreen loading")),"html4"!==t&&el([d.video,d.audio],t=>{delete t.children.audio,delete t.children.video}),el(ar("a form meter progress dfn"),t=>{d[t]&&delete d[t].children[t]}),delete d.caption.children.table,delete d.script,d})(d);!1===t.verify_html&&(t.valid_elements="*[*]");let u=au(t.valid_styles),m=au(t.invalid_styles,"map"),f=au(t.valid_classes,"map"),g=s("whitespace_elements","pre script noscript style textarea video audio iframe object code"),p=s("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),h=s("void_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),b=s("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls allowfullscreen"),v="td th iframe video audio object script code",y=s("non_empty_elements",v+" pre",h),C=s("move_caret_before_on_enter_elements",v+" table",h),w=s("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),x=s("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",w),E=s("text_inline_elements","span strong b em i font s strike u var cite dfn code mark q sup sub samp"),k=s("transparent_elements","a ins del canvas map");al("script noscript iframe noframes noembed title style textarea xmp plaintext".split(" "),t=>{i[t]=RegExp("</"+t+"[^>]*>","gi")});let S=t=>{let r=J.from(n["@"]),o=/[*?+]/;el(((t,r)=>{let n=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/;return eh(ar(r,","),r=>{let o=n.exec(r);if(o){let r=o[1],n=o[2],a=o[3],l=o[4],i=o[5],s={attributes:{},attributesOrder:[]};if(t.each(t=>{eA(t.attributes,(t,r)=>{s.attributes[r]=t}),s.attributesOrder.push(...t.attributesOrder)}),"#"===r?s.paddEmpty=!0:"-"===r&&(s.removeEmpty=!0),"!"===l&&(s.removeEmptyAttrs=!0),i&&((t,r)=>{let n=/^([!\-])?(\w+[\\:]:\w+|[^=~<]+)?(?:([=~<])(.*))?$/,o=/[*?+]/,{attributes:a,attributesOrder:l}=r;el(ar(t,"|"),t=>{let i=n.exec(t);if(i){let t={},n=i[1],s=i[2].replace(/[\\:]:/g,":"),d=i[3],c=i[4];if("!"===n&&(r.attributesRequired=r.attributesRequired||[],r.attributesRequired.push(s),t.required=!0),"-"===n)return delete a[s],void l.splice(tF.inArray(l,s),1);(d&&("="===d?(r.attributesDefault=r.attributesDefault||[],r.attributesDefault.push({name:s,value:c}),t.defaultValue=c):"~"===d?(r.attributesForced=r.attributesForced||[],r.attributesForced.push({name:s,value:c}),t.forcedValue=c):"<"===d&&(t.validValues=tF.makeMap(c,"?"))),o.test(s))?(r.attributePatterns=r.attributePatterns||[],t.pattern=an(s),r.attributePatterns.push(t)):(a[s]||l.push(s),a[s]=t)}})})(i,s),a&&(s.outputName=n),"@"===n){if(!t.isNone())return[];t=J.some(s)}return[a?{name:n,element:s,aliasName:a}:{name:n,element:s}]}return[]})})(r,null!=t?t:""),({name:t,element:r,aliasName:l})=>{(l&&(n[l]=r),o.test(t))?(r.pattern=an(t),a.push(r)):n[t]=r})},_=t=>{a=[],el(eN(n),t=>{delete n[t]}),S(t)},N=t=>{delete ao.text_block_elements,delete ao.block_elements,el((t=>{let r=/^(~)?(.+)$/;return eh(ar(t,","),t=>{let n=r.exec(t);if(n){let t="~"===n[1];return[{inline:t,cloneName:t?"span":"div",name:n[2]}]}return[]})})(null!=t?t:""),({inline:t,name:r,cloneName:a})=>{if(o[r]=o[a],l[r]=a,y[r.toUpperCase()]={},y[r]={},t||(x[r.toUpperCase()]={},x[r]={}),!n[r]){let t=n[a];t=ai({},t),delete t.removeEmptyAttrs,delete t.removeEmpty,n[r]=t}eA(o,(t,n)=>{t[a]&&(o[n]=t=ai({},o[n]),t[r]=t[a])})})},R=t=>{el((t=>{let r=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;return eh(ar(t,","),t=>{let n=r.exec(t);if(n){let t=n[1];return[{operation:t?"-"===t?"remove":"add":"replace",name:n[2],validChildren:ar(n[3],"|")}]}return[]})})(null!=t?t:""),({operation:t,name:r,validChildren:n})=>{let a="replace"===t?{"#comment":{}}:o[r];el(n,r=>{"remove"===t?delete a[r]:a[r]={}}),o[r]=a})},A=t=>{let r=n[t];if(r)return r;let o=a.length;for(;o--;){let r=a[o];if(r.pattern.test(t))return r}};t.valid_elements?(_(t.valid_elements),al(c,(t,r)=>{o[r]=t.children})):(al(c,(t,r)=>{n[r]={attributes:t.attributes,attributesOrder:t.attributesOrder},o[r]=t.children}),al(ar("strong/b em/i"),t=>{let r=ar(t,"/");n[r[1]].outputName=r[0]}),al(E,(r,o)=>{n[o]&&(t.padd_empty_block_inline_children&&(n[o].paddInEmptyBlock=!0),n[o].removeEmpty=!0)}),al(ar("ol ul blockquote a table tbody"),t=>{n[t]&&(n[t].removeEmpty=!0)}),al(ar("p h1 h2 h3 h4 h5 h6 th td pre div address caption li summary"),t=>{n[t]&&(n[t].paddEmpty=!0)}),al(ar("span"),t=>{n[t].removeEmptyAttrs=!0})),N(t.custom_elements),R(t.valid_children),S(t.extended_valid_elements),R("+ol[ul|ol],+ul[ul|ol]"),al({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(t,r)=>{n[r]&&(n[r].parentsRequired=ar(t))}),t.invalid_elements&&al(as(t.invalid_elements),t=>{n[t]&&delete n[t]}),A("span")||S("span[!data-mce-type|*]");let O=H(u),T=H(m),B=H(f),D=H(b),P=H(x),L=H(w),F=H(E),M=H(Object.seal(h)),I=H(p),U=H(y),z=H(C),j=H(g);return{type:d,children:o,elements:n,getValidStyles:O,getValidClasses:B,getBlockElements:P,getInvalidStyles:T,getVoidElements:M,getTextBlockElements:L,getTextInlineElements:F,getBoolAttrs:D,getElementRule:A,getSelfClosingElements:I,getNonEmptyElements:U,getMoveCaretBeforeOnEnterElements:z,getWhitespaceElements:j,getTransparentElements:H(k),getSpecialElements:H(Object.seal(i)),isValidChild:(t,r)=>{let n=o[t.toLowerCase()];return!(!n||!n[r.toLowerCase()])},isValid:(t,r)=>{let n=A(t);if(n){if(!r)return!0;{if(n.attributes[r])return!0;let t=n.attributePatterns;if(t){let n=t.length;for(;n--;)if(t[n].pattern.test(r))return!0}}}return!1},getCustomElements:H(l),addValidElements:S,setValidElements:_,addCustomElements:N,addValidChildren:R}},af=(t={},r)=>{let n,o;let a=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,l=/\s*([^:]+):\s*([^;]+);?/g,i=/\s+$/,s={};r&&(n=r.getValidStyles(),o=r.getInvalidStyles());let d="\\\" \\' \\; \\: ; : \uFEFF".split(" ");for(let t=0;t<d.length;t++)s[d[t]]="\uFEFF"+t,s["\uFEFF"+t]=d[t];let c={parse:r=>{var n,o,d;let u={},m=!1,f=t.url_converter,g=t.url_converter_scope||c,p=(t,r,n)=>{let o=u[t+"-top"+r];if(!o)return;let a=u[t+"-right"+r];if(!a)return;let l=u[t+"-bottom"+r];if(!l)return;let i=u[t+"-left"+r];if(!i)return;let s=[o,a,l,i],d=s.length-1;for(;d--&&s[d]===s[d+1];);d>-1&&n||(u[t+r]=-1===d?s[0]:s.join(" "),delete u[t+"-top"+r],delete u[t+"-right"+r],delete u[t+"-bottom"+r],delete u[t+"-left"+r])},h=t=>{let r=u[t];if(!r)return;let n=r.indexOf(",")>-1?[r]:r.split(" "),o=n.length;for(;o--;)if(n[o]!==n[0])return!1;return u[t]=n[0],!0},b=t=>(m=!0,s[t]),v=(t,r)=>(m&&(t=t.replace(/\uFEFF[0-9]/g,t=>s[t])),r||(t=t.replace(/\\([\'\";:])/g,"$1")),t),y=t=>String.fromCharCode(parseInt(t.slice(1),16)),C=t=>t.replace(/\\[0-9a-f]+/gi,y),w=(r,n,o,a,l,i)=>{if(l=l||i)return"'"+(l=v(l)).replace(/\'/g,"\\'")+"'";if(n=v(n||o||a||""),!t.allow_script_urls){let r=n.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(r)||!t.allow_svg_data_urls&&/^data:image\/svg/i.test(r))return""}return f&&(n=f.call(g,n,"style")),"url('"+n.replace(/\'/g,"\\'")+"')"};if(r){let s;for(r=(r=r.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,b).replace(/\"[^\"]+\"|\'[^\']+\'/g,t=>t.replace(/[;:]/g,b));s=l.exec(r);){l.lastIndex=s.index+s[0].length;let r=s[1].replace(i,"").toLowerCase(),n=s[2].replace(i,"");if(r&&n){if(r=C(r),n=C(n),-1!==r.indexOf("\uFEFF")||-1!==r.indexOf('"')||!t.allow_script_urls&&("behavior"===r||/expression\s*\(|\/\*|\*\//.test(n)))continue;"font-weight"===r&&"700"===n?n="bold":"color"!==r&&"background-color"!==r||(n=n.toLowerCase()),n=n.replace(a,w),u[r]=m?v(n,!0):n}}p("border","",!0),p("border","-width"),p("border","-color"),p("border","-style"),p("padding",""),p("margin",""),o="border-style",d="border-color",h(n="border-width")&&h(o)&&h(d)&&(u.border=u[n]+" "+u[o]+" "+u[d],delete u[n],delete u[o],delete u[d]),"medium none"===u.border&&delete u.border,"none"===u["border-image"]&&delete u["border-image"]}return u},serialize:(t,r)=>{let a="",l=(r,n)=>{let o=n[r];if(o)for(let r=0,n=o.length;r<n;r++){let n=o[r],l=t[n];l&&(a+=(a.length>0?" ":"")+n+": "+l+";")}};return r&&n?(l("*",n),l(r,n)):eA(t,(t,n)=>{t&&((t,r)=>{if(!o||!r)return!0;let n=o["*"];return!(n&&n[t]||(n=o[r])&&n[t])})(n,r)&&(a+=(a.length>0?" ":"")+n+": "+t+";")}),a}};return c},ag={keyLocation:!0,layerX:!0,layerY:!0,returnValue:!0,webkitMovementX:!0,webkitMovementY:!0,keyIdentifier:!0,mozPressure:!0},ap=(t,r)=>{let n=null!=r?r:{};for(let r in t)eI(ag,r)||(n[r]=t[r]);return L(t.composedPath)&&(n.composedPath=()=>t.composedPath()),L(t.getModifierState)&&(n.getModifierState=r=>t.getModifierState(r)),n},ah=(t,r,n,o)=>{var a;let l;let i=ap(r,o);return i.type=t,P(i.target)&&(i.target=null!==(a=i.srcElement)&&void 0!==a?a:n),(P(r.preventDefault)||(l=r)instanceof Event||F(l.initEvent))&&(i.preventDefault=()=>{i.defaultPrevented=!0,i.isDefaultPrevented=Q,F(r.preventDefault)&&r.preventDefault()},i.stopPropagation=()=>{i.cancelBubble=!0,i.isPropagationStopped=Q,F(r.stopPropagation)&&r.stopPropagation()},i.stopImmediatePropagation=()=>{i.isImmediatePropagationStopped=Q,i.stopPropagation()},i.isDefaultPrevented===Q||i.isDefaultPrevented===X||(i.isDefaultPrevented=!0===i.defaultPrevented?Q:X,i.isPropagationStopped=!0===i.cancelBubble?Q:X,i.isImmediatePropagationStopped=X)),i},ab=/^(?:mouse|contextmenu)|click/,av=(t,r,n,o)=>{t.addEventListener(r,n,o||!1)},ay=(t,r,n,o)=>{t.removeEventListener(r,n,o||!1)},aC=(t,r)=>{let n=ah(t.type,t,document,r);if(L(t)&&ab.test(t.type)&&D(t.pageX)&&!D(t.clientX)){let r=n.target.ownerDocument||document,o=r.documentElement,a=r.body;n.pageX=t.clientX+(o&&o.scrollLeft||a&&a.scrollLeft||0)-(o&&o.clientLeft||a&&a.clientLeft||0),n.pageY=t.clientY+(o&&o.scrollTop||a&&a.scrollTop||0)-(o&&o.clientTop||a&&a.clientTop||0)}return n},aw=(t,r,n)=>{let o=t.document,a={type:"ready"};if(n.domLoaded)return void r(a);let l=()=>{ay(t,"DOMContentLoaded",l),ay(t,"load",l),n.domLoaded||(n.domLoaded=!0,r(a)),t=null};"complete"===o.readyState||"interactive"===o.readyState&&o.body?l():av(t,"DOMContentLoaded",l),n.domLoaded||av(t,"load",l)};class ax{constructor(){this.domLoaded=!1,this.events={},this.count=1,this.expando="mce-data-"+(+new Date).toString(32),this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}bind(t,r,n,o){let a,l;let i=this,s=window,d=t=>{i.executeHandlers(aC(t||s.event),l)};if(!t||nT(t)||nP(t))return n;t[i.expando]?l=t[i.expando]:(l=i.count++,t[i.expando]=l,i.events[l]={}),o=o||t;let c=r.split(" "),u=c.length;for(;u--;){let r=c[u],m=d,f=!1,g=!1;"DOMContentLoaded"===r&&(r="ready"),i.domLoaded&&"ready"===r&&"complete"===t.readyState?n.call(o,aC({type:r})):(i.hasFocusIn||"focusin"!==r&&"focusout"!==r||(f=!0,g="focusin"===r?"focus":"blur",m=t=>{let r=aC(t||s.event);r.type="focus"===r.type?"focusin":"focusout",i.executeHandlers(r,l)}),(a=i.events[l][r])?"ready"===r&&i.domLoaded?n(aC({type:r})):a.push({func:n,scope:o}):(i.events[l][r]=a=[{func:n,scope:o}],a.fakeName=g,a.capture=f,a.nativeHandler=m,"ready"===r?aw(t,m,i):av(t,g||r,m,f)))}return t=a=null,n}unbind(t,r,n){if(!t||nT(t)||nP(t))return this;let o=t[this.expando];if(o){let a=this.events[o];if(r){let o=r.split(" "),l=o.length;for(;l--;){let r=o[l],i=a[r];if(i){if(n){let t=i.length;for(;t--;)if(i[t].func===n){let n=i.nativeHandler,o=i.fakeName,l=i.capture,s=i.slice(0,t).concat(i.slice(t+1));s.nativeHandler=n,s.fakeName=o,s.capture=l,a[r]=s}}n&&0!==i.length||(delete a[r],ay(t,i.fakeName||r,i.nativeHandler,i.capture))}}}else eA(a,(r,n)=>{ay(t,r.fakeName||n,r.nativeHandler,r.capture)}),a={};for(let t in a)if(eI(a,t))return this;delete this.events[o];try{delete t[this.expando]}catch(r){t[this.expando]=null}}return this}fire(t,r,n){return this.dispatch(t,r,n)}dispatch(t,r,n){if(!t||nT(t)||nP(t))return this;let o=aC({type:r,target:t},n);do{let r=t[this.expando];r&&this.executeHandlers(o,r),t=t.parentNode||t.ownerDocument||t.defaultView||t.parentWindow}while(t&&!o.isPropagationStopped());return this}clean(t){if(!t||nT(t)||nP(t))return this;if(t[this.expando]&&this.unbind(t),t.getElementsByTagName||(t=t.document),t&&t.getElementsByTagName){this.unbind(t);let r=t.getElementsByTagName("*"),n=r.length;for(;n--;)(t=r[n])[this.expando]&&this.unbind(t)}return this}destroy(){this.events={}}cancel(t){return t&&(t.preventDefault(),t.stopImmediatePropagation()),!1}executeHandlers(t,r){let n=this.events[r],o=n&&n[t.type];if(o)for(let r=0,n=o.length;r<n;r++){let n=o[r];if(n&&!1===n.func.call(n.scope,t)&&t.preventDefault(),t.isImmediatePropagationStopped())return}}}ax.Event=new ax;let aE=tF.each,ak=tF.grep,aS="data-mce-style",a_=tF.makeMap("fill-opacity font-weight line-height opacity orphans widows z-index zoom"," "),aN=(t,r,n)=>{P(n)||""===n?t6(t,r):t1(t,r,n)},aR=t=>t.replace(/[A-Z]/g,t=>"-"+t.toLowerCase()),aA=(t,r)=>{let n=0;if(t)for(let o=t.nodeType,a=t.previousSibling;a;a=a.previousSibling){let t=a.nodeType;r&&nT(a)&&(t===o||!a.data.length)||(n++,o=t)}return n},aO=(t,r)=>{let n=t3(r,"style"),o=t.serialize(t.parse(n),tV(r));aN(r,aS,o)},aT=(t,r,n)=>{let o=aR(r);P(n)||""===n?r3(t,o):rQ(t,o,M(n)?eI(a_,o)?n+"":n+"px":n)},aB=(t,r={})=>{let n={},o=window,a={},l=0,i=oG.forElement(ri(t),{contentCssCors:r.contentCssCors,referrerPolicy:r.referrerPolicy}),s=[],d=r.schema?r.schema:am({}),c=af({url_converter:r.url_converter,url_converter_scope:r.url_converter_scope},r.schema),u=r.ownEvents?new ax:ax.Event,m=d.getBlockElements(),f=r=>r&&t&&N(r)?t.getElementById(r):r,g=t=>{let r=f(t);return L(r)?ri(r):null},p=(t,r,n="")=>{let o;let a=g(t);if(L(a)&&tY(a)){let t=K[r];o=t&&t.get?t.get(a.dom,r):t3(a,r)}return L(o)?o:n},h=t=>{let r=f(t);return P(r)?[]:r.attributes},b=(t,n,o)=>{S(t,t=>{if(nx(t)){let a=ri(t),l=""===o?null:o,i=t3(a,n),s=K[n];s&&s.set?s.set(a.dom,l,n):aN(a,n,l),i!==l&&r.onSetAttrib&&r.onSetAttrib({attrElm:a.dom,attrName:n,attrValue:l})}})},v=()=>r.root_element||t.body,y=(r,n)=>((t,r,n)=>{let o=0,a=0,l=t.ownerDocument;if(n=n||t,r){let i;if(n===t&&r.getBoundingClientRect&&"static"===rZ(ri(t),"position")){let n=r.getBoundingClientRect();return{x:o=n.left+(l.documentElement.scrollLeft||t.scrollLeft)-l.documentElement.clientLeft,y:a=n.top+(l.documentElement.scrollTop||t.scrollTop)-l.documentElement.clientTop}}let s=r;for(;s&&s!==n&&s.nodeType&&!oW(s,n);){let t=s;o+=t.offsetLeft||0,a+=t.offsetTop||0,s=t.offsetParent}for(s=r.parentNode;s&&s!==n&&s.nodeType&&!oW(s,n);)o-=s.scrollLeft||0,a-=s.scrollTop||0,s=s.parentNode;a+=(i=ri(r),oq.isFirefox()&&"table"===tV(i)?oV(rN(i)).filter(t=>"caption"===tV(t)).bind(t=>oV(r_(t)).map(r=>{let n=r.dom.offsetTop,o=t.dom.offsetTop,a=t.dom.offsetHeight;return n<=o?-a:0})).getOr(0):0)}return{x:o,y:a}})(t.body,f(r),n),C=(t,r,n)=>{let o=f(t);if(!P(o)&&nx(o))return n?rZ(ri(o),aR(r)):("float"===(r=r.replace(/-(\D)/g,(t,r)=>r.toUpperCase()))&&(r="cssFloat"),o.style?o.style[r]:void 0)},w=t=>{let r=f(t);if(!r)return{w:0,h:0};let n=C(r,"width"),o=C(r,"height");return n&&-1!==n.indexOf("px")||(n="0"),o&&-1!==o.indexOf("px")||(o="0"),{w:parseInt(n,10)||r.offsetWidth||r.clientWidth,h:parseInt(o,10)||r.offsetHeight||r.clientHeight}},x=(t,r)=>!!t&&eo(O(t)?t:[t],t=>rf(ri(t),r)),E=(t,r,n,o)=>{let a=[],l=f(t);o=void 0===o;let i=n||("BODY"!==v().nodeName?v().parentNode:null);if(N(r)){if("*"===r)r=nx;else{let t=r;r=r=>x(r,t)}}for(;l&&!(l===i||P(l.nodeType)||nL(l)||nF(l));){if(!r||r(l)){if(!o)return[l];a.push(l)}l=l.parentNode}return o?a:null},k=(t,r,n)=>{let o=r;if(t){N(r)&&(o=t=>x(t,r));for(let r=t[n];r;r=r[n])if(F(o)&&o(r))return r}return null},S=function(t,r,n){let o=null!=n?n:this;if(O(t)){let n=[];return aE(t,(t,a)=>{let l=f(t);l&&n.push(r.call(o,l,a))}),n}{let n=f(t);return!!n&&r.call(o,n)}},_=(t,r)=>{S(t,t=>{eA(r,(r,n)=>{b(t,n,r)})})},R=(t,r)=>{S(t,t=>{na(ri(t),r)})},A=(r,n,o,a,l)=>S(r,r=>{let i=N(n)?t.createElement(n):n;return L(o)&&_(i,o),a&&(!N(a)&&a.nodeType?i.appendChild(a):N(a)&&R(i,a)),l?i:r.appendChild(i)}),T=(r,n,o)=>A(t.createElement(r),r,n,o,!0),B=at.encodeAllRaw,D=(t,r)=>S(t,t=>{let n=ri(t);return r&&el(rN(n),t=>{tX(t)&&0===t.dom.length?nt(t):r8(n,t)}),nt(n),n.dom}),M=(t,r,n)=>{S(t,t=>{if(nx(t)){let o=ri(t);el(r.split(" "),t=>{L(n)?(n?rn:ra)(o,t):(t7(o)?o.dom.classList.toggle(t):en(re(o),t)?rr(o,t):rt(o,t),ro(o))})}})},I=(t,r,n)=>S(r,o=>{var a;let l=O(r)?t.cloneNode(!0):t;return n&&aE(ak(o.childNodes),t=>{l.appendChild(t)}),null===(a=o.parentNode)||void 0===a||a.replaceChild(l,o),o}),z=t=>{if(nx(t)){let r="a"===t.nodeName.toLowerCase()&&!p(t,"href")&&p(t,"id");if(p(t,"name")||p(t,"data-mce-bookmark")||r)return!0}return!1},j=()=>t.createRange(),$=(n,a,l,i)=>{if(O(n)){let t=n.length,r=[];for(;t--;)r[t]=$(n[t],a,l,i);return r}return r.collect&&(n===t||n===o)&&s.push([n,a,l,i]),u.bind(n,a,l,i||W)},q=(r,n,a)=>{if(O(r)){let t=r.length,o=[];for(;t--;)o[t]=q(r[t],n,a);return o}if(s.length>0&&(r===t||r===o)){let t=s.length;for(;t--;){let[o,l,i]=s[t];r!==o||n&&n!==l||a&&a!==i||u.unbind(o,l,i)}}return u.unbind(r,n,a)},V=t=>{if(t&&nx(t)){let r=t.getAttribute("data-mce-contenteditable");return r&&"inherit"!==r?r:"inherit"!==t.contentEditable?t.contentEditable:null}return null},W={doc:t,settings:r,win:o,files:a,stdMode:!0,boxModel:!0,styleSheetLoader:i,boundEvents:s,styles:c,schema:d,events:u,isBlock:t=>N(t)?eI(m,t):nx(t)&&(eI(m,t.nodeName)||oj(d,t)),root:null,clone:(t,r)=>t.cloneNode(r),getRoot:v,getViewPort:t=>{let r=np(t);return{x:r.x,y:r.y,w:r.width,h:r.height}},getRect:t=>{let r=f(t),n=y(r),o=w(r);return{x:n.x,y:n.y,w:o.w,h:o.h}},getSize:w,getParent:(t,r,n)=>{let o=E(t,r,n,!1);return o&&o.length>0?o[0]:null},getParents:E,get:f,getNext:(t,r)=>k(t,r,"nextSibling"),getPrev:(t,r)=>k(t,r,"previousSibling"),select:(n,o)=>{var a,l;let i=null!==(l=null!==(a=f(o))&&void 0!==a?a:r.root_element)&&void 0!==l?l:t;return F(i.querySelectorAll)?eS(i.querySelectorAll(n)):[]},is:x,add:A,create:T,createHTML:(t,r,n="")=>{let o="<"+t;for(let t in r)eU(r,t)&&(o+=" "+t+'="'+B(r[t])+'"');return te(n)&&eI(d.getVoidElements(),t)?o+" />":o+">"+n+"</"+t+">"},createFragment:r=>{let n;let o=t.createElement("div"),a=t.createDocumentFragment();for(a.appendChild(o),r&&(o.innerHTML=r);n=o.firstChild;)a.appendChild(n);return a.removeChild(o),a},remove:D,setStyle:(t,n,o)=>{S(t,t=>{let a=ri(t);aT(a,n,o),r.update_styles&&aO(c,a)})},getStyle:C,setStyles:(t,n)=>{S(t,t=>{let o=ri(t);eA(n,(t,r)=>{aT(o,r,t)}),r.update_styles&&aO(c,o)})},removeAllAttribs:t=>S(t,t=>{let r=t.attributes;for(let n=r.length-1;n>=0;n--)t.removeAttributeNode(r.item(n))}),setAttrib:b,setAttribs:_,getAttrib:p,getPos:y,parseStyle:t=>c.parse(t),serializeStyle:(t,r)=>c.serialize(t,r),addStyle:r=>{if(W!==aB.DOM&&t===document){if(n[r])return;n[r]=!0}let o=t.getElementById("mceDefaultStyles");if(!o){(o=t.createElement("style")).id="mceDefaultStyles",o.type="text/css";let r=t.head;r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o)}o.styleSheet?o.styleSheet.cssText+=r:o.appendChild(t.createTextNode(r))},loadCSS:t=>{t||(t=""),el(t.split(","),t=>{a[t]=!0,i.load(t).catch(U)})},addClass:(t,r)=>{M(t,r,!0)},removeClass:(t,r)=>{M(t,r,!1)},hasClass:(t,r)=>{let n=g(t),o=r.split(" ");return L(n)&&eb(o,t=>rl(n,t))},toggleClass:M,show:t=>{S(t,t=>r3(ri(t),"display"))},hide:t=>{S(t,t=>rQ(ri(t),"display","none"))},isHidden:t=>{let r=g(t);return L(r)&&tM(r1(r,"display"),"none")},uniqueId:t=>(t||"mce_")+l++,setHTML:R,getOuterHTML:t=>{let r=g(t);return L(r)?nx(r.dom)?r.dom.outerHTML:(t=>{let r=rd("div");return r9(r,ri(t.dom.cloneNode(!0))),no(r)})(r):""},setOuterHTML:(t,r)=>{S(t,t=>{nx(t)&&(t.outerHTML=r)})},decode:at.decode,encode:B,insertAfter:(t,r)=>{let n=f(r);return S(t,t=>{let r=null==n?void 0:n.parentNode,o=null==n?void 0:n.nextSibling;return r&&(o?r.insertBefore(t,o):r.appendChild(t)),t})},replace:I,rename:(t,r)=>{if(t.nodeName!==r.toUpperCase()){let n=T(r);return aE(h(t),r=>{b(n,r.nodeName,p(t,r.nodeName))}),I(n,t,!0),n}return t},findCommonAncestor:(t,r)=>{let n=t;for(;n;){let t=r;for(;t&&n!==t;)t=t.parentNode;if(n===t)break;n=n.parentNode}return!n&&t.ownerDocument?t.ownerDocument.documentElement:n},run:S,getAttribs:h,isEmpty:(t,r,n)=>{let o=0;if(z(t))return!1;let a=t.firstChild;if(a){let l=new ny(a,t),i=d?d.getWhitespaceElements():{},s=r||(d?d.getNonEmptyElements():null),c=a;do{if(nx(c)){let t=c.getAttribute("data-mce-bogus");if(t){c=l.next("all"===t);continue}let r=c.nodeName.toLowerCase();if(s&&s[r]){if("br"===r){o++,c=l.next();continue}return!1}if(z(c))return!1}if(nP(c)||nT(c)&&!ow(c.data)&&(!(null==n?void 0:n.includeZwsp)||!ox(c.data))||nT(c)&&c.parentNode&&i[c.parentNode.nodeName]&&ow(c.data))return!1;c=l.next()}while(c)}return o<=1},createRng:j,nodeIndex:aA,split:(t,r,n)=>{let o,a,l=j();if(t&&r&&t.parentNode&&r.parentNode){let i=t.parentNode;return l.setStart(i,aA(t)),l.setEnd(r.parentNode,aA(r)),o=l.extractContents(),(l=j()).setStart(r.parentNode,aA(r)+1),l.setEnd(i,aA(t)+1),a=l.extractContents(),i.insertBefore(oQ(W,o),t),n?i.insertBefore(n,t):i.insertBefore(r,t),i.insertBefore(oQ(W,a),t),D(t),n||r}},bind:$,unbind:q,fire:(t,r,n)=>u.dispatch(t,r,n),dispatch:(t,r,n)=>u.dispatch(t,r,n),getContentEditable:V,getContentEditableParent:t=>{let r=v(),n=null;for(let o=t;o&&o!==r&&null===(n=V(o));o=o.parentNode);return n},isEditable:t=>{if(L(t)){let r=nx(t)?t:t.parentElement;return L(r)&&rK(ri(r))}return!1},destroy:()=>{if(s.length>0){let t=s.length;for(;t--;){let[r,n,o]=s[t];u.unbind(r,n,o)}}eA(a,(t,r)=>{i.unload(r),delete a[r]})},isChildOf:(t,r)=>t===r||r.contains(t),dumpRng:t=>"startContainer: "+t.startContainer.nodeName+", startOffset: "+t.startOffset+", endContainer: "+t.endContainer.nodeName+", endOffset: "+t.endOffset},K=((t,r,n)=>{let o=r.keep_values,a={set:(t,o,a)=>{let l=ri(t);F(r.url_converter)&&L(o)&&(o=r.url_converter.call(r.url_converter_scope||n(),String(o),a,t)),aN(l,"data-mce-"+a,o),aN(l,a,o)},get:(t,r)=>{let n=ri(t);return t3(n,"data-mce-"+r)||t3(n,r)}},l={style:{set:(r,n)=>{let a=ri(r);o&&aN(a,aS,n),t6(a,"style"),N(n)&&rJ(a,t.parse(n))},get:r=>{let n=ri(r),o=t3(n,aS)||t3(n,"style");return t.serialize(t.parse(o),tV(n))}}};return o&&(l.href=l.src=a),l})(c,r,H(W));return W};aB.DOM=aB(document),aB.nodeIndex=aA;let aD=aB.DOM;class aP{constructor(t={}){this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=!1,this.settings=t}_setReferrerPolicy(t){this.settings.referrerPolicy=t}loadScript(t){return new Promise((r,n)=>{let o;let a=()=>{aD.remove(l),o&&(o.onerror=o.onload=o=null)},l=aD.uniqueId();(o=document.createElement("script")).id=l,o.type="text/javascript",o.src=tF._addCacheSuffix(t),this.settings.referrerPolicy&&aD.setAttrib(o,"referrerpolicy",this.settings.referrerPolicy),o.onload=()=>{a(),r()},o.onerror=()=>{a(),n("Failed to load script: "+t)},(document.getElementsByTagName("head")[0]||document.body).appendChild(o)})}isDone(t){return 2===this.states[t]}markDone(t){this.states[t]=2}add(t){let r=this;return r.queue.push(t),void 0===r.states[t]&&(r.states[t]=0),new Promise((n,o)=>{r.scriptLoadedCallbacks[t]||(r.scriptLoadedCallbacks[t]=[]),r.scriptLoadedCallbacks[t].push({resolve:n,reject:o})})}load(t){return this.add(t)}remove(t){delete this.states[t],delete this.scriptLoadedCallbacks[t]}loadQueue(){let t=this.queue;return this.queue=[],this.loadScripts(t)}loadScripts(t){let r=this,n=(t,n)=>{eM(r.scriptLoadedCallbacks,n).each(r=>{el(r,r=>r[t](n))}),delete r.scriptLoadedCallbacks[n]},o=t=>{let r=ed(t,t=>"rejected"===t.status);return r.length>0?Promise.reject(eh(r,({reason:t})=>O(t)?t:[t])):Promise.resolve()},a=t=>Promise.allSettled(ea(t,t=>2===r.states[t]?(n("resolve",t),Promise.resolve()):3===r.states[t]?(n("reject",t),Promise.reject(t)):(r.states[t]=1,r.loadScript(t).then(()=>{r.states[t]=2,n("resolve",t);let l=r.queue;return l.length>0?(r.queue=[],a(l).then(o)):Promise.resolve()},()=>(r.states[t]=3,n("reject",t),Promise.reject(t)))))),l=t=>(r.loading=!0,a(t).then(t=>{r.loading=!1;let n=r.queueLoadedCallbacks.shift();return J.from(n).each(Y),o(t)})),i=ez(t);return r.loading?new Promise((t,n)=>{r.queueLoadedCallbacks.push(()=>{l(i).then(t,n)})}):l(i)}}aP.ScriptLoader=new aP;let aL=t=>{let r=t;return{get:()=>r,set:t=>{r=t}}},aF={},aM=aL("en"),aI=()=>eM(aF,aM.get()),aU={getData:()=>eO(aF,t=>({...t})),setCode:t=>{t&&aM.set(t)},getCode:()=>aM.get(),add:(t,r)=>{let n=aF[t];n||(aF[t]=n={});let o=ea(eN(r),t=>t.toLowerCase());eA(r,(t,a)=>{let l=a.toLowerCase();l!==a&&((t,r)=>{let n=t.indexOf(r);return -1!==n&&t.indexOf(r,n+1)>n})(o,l)?(eI(r,l)||(n[l]=t),n[a]=t):n[l]=t})},translate:t=>{let r=aI().getOr({}),n=t=>F(t)?Object.prototype.toString.call(t):o(t)?"":""+t,o=t=>""===t||null==t,a=t=>{let o=n(t);return eI(r,o)?n(r[o]):eM(r,o.toLowerCase()).map(n).getOr(o)},l=t=>t.replace(/{context:\w+}$/,"");if(o(t))return"";if(R(t)&&eI(t,"raw"))return n(t.raw);if(O(t)&&t.length>1){let r=t.slice(1);return l(a(t[0]).replace(/\{([0-9]+)\}/g,(t,o)=>eI(r,o)?n(r[o]):t))}return l(a(t))},isRtl:()=>aI().bind(t=>eM(t,"_dir")).exists(t=>"rtl"===t),hasCode:t=>eI(aF,t)},az=()=>{let t=[],r={},n={},o=[],a=(t,r)=>{el(ed(o,n=>n.name===t&&n.state===r),t=>t.resolve())},l=t=>eI(r,t),i=(t,n)=>{let o=aU.getCode();!o||n&&-1===(","+(n||"")+",").indexOf(","+o+",")||aP.ScriptLoader.add(r[t]+"/langs/"+o+".js")},s=(t,r="added")=>"added"===r&&eI(n,t)||"loaded"===r&&l(t)?Promise.resolve():new Promise(n=>{o.push({name:t,state:r,resolve:n})});return{items:t,urls:r,lookup:n,get:t=>{if(n[t])return n[t].instance},requireLangPack:(t,r)=>{!1!==az.languageLoad&&(l(t)?i(t,r):s(t,"loaded").then(()=>i(t,r)))},add:(r,o)=>(t.push(o),n[r]={instance:o},a(r,"added"),o),remove:t=>{delete r[t],delete n[t]},createUrl:(t,r)=>N(r)?N(t)?{prefix:"",resource:r,suffix:""}:{prefix:t.prefix,resource:r,suffix:t.suffix}:r,load:(t,o)=>{if(r[t])return Promise.resolve();let l=N(o)?o:o.prefix+o.resource+o.suffix;0!==l.indexOf("/")&&-1===l.indexOf("://")&&(l=az.baseURL+"/"+l),r[t]=l.substring(0,l.lastIndexOf("/"));let i=()=>(a(t,"loaded"),Promise.resolve());return n[t]?i():aP.ScriptLoader.add(l).then(i)},waitFor:s}};az.languageLoad=!0,az.baseURL="",az.PluginManager=az(),az.ThemeManager=az(),az.ModelManager=az();let aj=t=>{let r=aL(J.none()),n=()=>r.get().each(t=>clearInterval(t));return{clear:()=>{n(),r.set(J.none())},isSet:()=>r.get().isSome(),get:()=>r.get(),set:o=>{n(),r.set(J.some(setInterval(o,t)))}}},aH=()=>{let t=(t=>{let r=aL(J.none()),n=()=>r.get().each(t);return{clear:()=>{n(),r.set(J.none())},isSet:()=>r.get().isSome(),get:()=>r.get(),set:t=>{n(),r.set(J.some(t))}}})(U);return{...t,on:r=>t.get().each(r)}},a$=(t,r)=>{let n=null;return{cancel:()=>{T(n)||(clearTimeout(n),n=null)},throttle:(...o)=>{T(n)&&(n=setTimeout(()=>{n=null,t.apply(null,o)},r))}}},aq=(t,r)=>{let n=null,o=()=>{T(n)||(clearTimeout(n),n=null)};return{cancel:o,throttle:(...a)=>{o(),n=setTimeout(()=>{n=null,t.apply(null,a)},r)}}},aV=H("mce-annotation"),aW=H("data-mce-annotation"),aK=H("data-mce-annotation-uid"),aG=H("data-mce-annotation-active"),aY=H("data-mce-annotation-classes"),aX=H("data-mce-annotation-attrs"),aQ=t=>r=>rp(r,t),aJ=(t,r)=>{let n=t.selection.getRng(),o=ri(n.startContainer),a=ri(t.getBody()),l=r.fold(()=>"."+aV(),t=>`[${aW()}="${t}"]`);return rW(rR(o,n.startOffset).getOr(o),l,aQ(a)).bind(r=>t8(r,`${aK()}`).bind(n=>t8(r,`${aW()}`).map(r=>{let o=a0(t,n);return{uid:n,name:r,elements:o}})))},aZ=(t,r)=>t5(t,"data-mce-bogus")||nv(t,'[data-mce-bogus="all"]',aQ(r)),a0=(t,r)=>{let n=ri(t.getBody());return ed(nb(n,`[${aK()}="${r}"]`),t=>!aZ(t,n))},a1=(t,r)=>{let n=ri(t.getBody()),o=nb(n,`[${aW()}="${r}"]`),a={};return el(o,t=>{if(!aZ(t,n)){let r=t3(t,aK()),n=eM(a,r).getOr([]);a[r]=n.concat([t])}}),a},a2=0,a3=t=>{let r=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++a2+String(r)},a8=(t,r)=>ri(t.dom.cloneNode(r)),a5=t=>a8(t,!1),a6=t=>a8(t,!0),a9=(t,r,n=X)=>{let o=new ny(t,r),a=t=>{let r;do r=o[t]();while(r&&!nT(r)&&!n(r));return J.from(r).filter(nT)};return{current:()=>J.from(o.current()).filter(nT),next:()=>a("next"),prev:()=>a("prev"),prev2:()=>a("prev2")}},a4=(t,r)=>{let n=r||(r=>t.isBlock(r)||nM(r)||nz(r)),o=(t,r,n,a)=>{if(nT(t)){let n=a(t,r,t.data);if(-1!==n)return J.some({container:t,offset:n})}return n().bind(t=>o(t.container,t.offset,n,a))};return{backwards:(r,a,l,i)=>{let s=a9(r,null!=i?i:t.getRoot(),n);return o(r,a,()=>s.prev().map(t=>({container:t,offset:t.length})),l).getOrNull()},forwards:(r,a,l,i)=>{let s=a9(r,null!=i?i:t.getRoot(),n);return o(r,a,()=>s.next().map(t=>({container:t,offset:0})),l).getOrNull()}}},a7=Math.round,le=t=>t?{left:a7(t.left),top:a7(t.top),bottom:a7(t.bottom),right:a7(t.right),width:a7(t.width),height:a7(t.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0},lt=(t,r)=>(t=le(t),r||(t.left=t.left+t.width),t.right=t.left,t.width=0,t),lr=(t,r,n)=>t>=0&&t<=Math.min(r.height,n.height)/2,ln=(t,r)=>{let n=Math.min(r.height/2,t.height/2);return t.bottom-n<r.top||!(t.top>r.bottom)&&lr(r.top-t.bottom,t,r)},lo=(t,r)=>t.top>r.bottom||!(t.bottom<r.top)&&lr(r.bottom-t.top,t,r),la=(t,r,n)=>{let o=Math.max(Math.min(r,t.left+t.width),t.left),a=Math.max(Math.min(n,t.top+t.height),t.top);return Math.sqrt((r-o)*(r-o)+(n-a)*(n-a))},ll=t=>{let r=t.startContainer,n=t.startOffset;return r===t.endContainer&&r.hasChildNodes()&&t.endOffset===n+1?r.childNodes[n]:null},li=(t,r)=>{if(nx(t)&&t.hasChildNodes()){let n=t.childNodes,o=Math.min(Math.max(r,0),n.length-1);return n[o]}return t},ls=RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]"),ld=t=>N(t)&&t.charCodeAt(0)>=768&&ls.test(t),lc=nS("display","block table"),lu=((...t)=>r=>{for(let n=0;n<t.length;n++)if(!t[n](r))return!1;return!0})(nx,ob,W(nS("float","left right"))),lm=W(nS("white-space","pre pre-line pre-wrap")),lf=aB.nodeIndex,lg=(t,r)=>r<0&&nx(t)&&t.hasChildNodes()?void 0:li(t,r),lp=t=>t?t.createRange():aB.DOM.createRng(),lh=t=>N(t)&&/[\r\n\t ]/.test(t),lb=t=>!!t.setStart&&!!t.setEnd,lv=t=>{let r=t.startContainer,n=t.startOffset;if(lh(t.toString())&&lm(r.parentNode)&&nT(r)){let t=r.data;if(lh(t[n-1])||lh(t[n+1]))return!0}return!1},ly=t=>0===t.left&&0===t.right&&0===t.top&&0===t.bottom,lC=t=>{var r;let n;let o=t.getClientRects();return n=o.length>0?le(o[0]):le(t.getBoundingClientRect()),!lb(t)&&nM(t)&&ly(n)?(t=>{let r=t.ownerDocument,n=lp(r),o=r.createTextNode("\xa0"),a=t.parentNode;a.insertBefore(o,t),n.setStart(o,0),n.setEnd(o,1);let l=le(n.getBoundingClientRect());return a.removeChild(o),l})(t):ly(n)&&lb(t)&&null!==(r=(t=>{let r=t.startContainer,n=t.endContainer,o=t.startOffset,a=t.endOffset;if(r===n&&nT(n)&&0===o&&1===a){let r=t.cloneRange();return r.setEndAfter(n),lC(r)}return null})(t))&&void 0!==r?r:n},lw=(t,r)=>{let n=lt(t,r);return n.width=1,n.right=n.left+1,n},lx=(t,r,n)=>{let o=()=>(n||(n=(t=>{let r=[],n=t=>{var n;0!==t.height&&(r.length>0&&(n=r[r.length-1],t.left===n.left&&t.top===n.top&&t.bottom===n.bottom&&t.right===n.right)||r.push(t))},o=(t,r)=>{let o=lp(t.ownerDocument);if(r<t.data.length){if(ld(t.data[r]))return;if(ld(t.data[r-1])&&(o.setStart(t,r),o.setEnd(t,r+1),!lv(o)))return void n(lw(lC(o),!1))}r>0&&(o.setStart(t,r-1),o.setEnd(t,r),lv(o)||n(lw(lC(o),!1))),r<t.data.length&&(o.setStart(t,r),o.setEnd(t,r+1),lv(o)||n(lw(lC(o),!0)))},a=t.container(),l=t.offset();if(nT(a))return o(a,l),r;if(nx(a)){if(t.isAtEnd()){let t=lg(a,l);nT(t)&&o(t,t.data.length),lu(t)&&!nM(t)&&n(lw(lC(t),!1))}else{let i=lg(a,l);if(nT(i)&&o(i,0),lu(i)&&t.isAtEnd())return n(lw(lC(i),!1)),r;let s=lg(t.container(),t.offset()-1);lu(s)&&!nM(s)&&(lc(s)||lc(i)||!lu(i))&&n(lw(lC(s),!1)),lu(i)&&n(lw(lC(i),!0))}}return r})(lx(t,r))),n);return{container:H(t),offset:H(r),toRange:()=>{let n=lp(t.ownerDocument);return n.setStart(t,r),n.setEnd(t,r),n},getClientRects:o,isVisible:()=>o().length>0,isAtStart:()=>(nT(t),0===r),isAtEnd:()=>nT(t)?r>=t.data.length:r>=t.childNodes.length,isEqual:n=>n&&t===n.container()&&r===n.offset(),getNode:n=>lg(t,n?r-1:r)}};lx.fromRangeStart=t=>lx(t.startContainer,t.startOffset),lx.fromRangeEnd=t=>lx(t.endContainer,t.endOffset),lx.after=t=>lx(t.parentNode,lf(t)+1),lx.before=t=>lx(t.parentNode,lf(t)),lx.isAbove=(t,r)=>tU(eE(r.getClientRects()),ek(t.getClientRects()),ln).getOr(!1),lx.isBelow=(t,r)=>tU(ek(r.getClientRects()),eE(t.getClientRects()),lo).getOr(!1),lx.isAtStart=t=>!!t&&t.isAtStart(),lx.isAtEnd=t=>!!t&&t.isAtEnd(),lx.isTextPosition=t=>!!t&&nT(t.container()),lx.isElementPosition=t=>!lx.isTextPosition(t);let lE=(t,r)=>{nT(r)&&0===r.data.length&&t.remove(r)},lk=(t,r,n)=>{nF(n)?((t,r,n)=>{let o=J.from(n.firstChild),a=J.from(n.lastChild);r.insertNode(n),o.each(r=>lE(t,r.previousSibling)),a.each(r=>lE(t,r.nextSibling))})(t,r,n):(r.insertNode(n),lE(t,n.previousSibling),lE(t,n.nextSibling))},lS=aB.nodeIndex,l_=t=>{let r=t.parentNode;return nN(r)?l_(r):r},lN=t=>t?eW(t.childNodes,(t,r)=>(nN(r)&&"BR"!==r.nodeName?t=t.concat(lN(r)):t.push(r),t),[]):[],lR=t=>r=>t===r,lA=t=>(nT(t)?"text()":t.nodeName.toLowerCase())+"["+(t=>{let r,n;n=eK(r=lN(l_(t)),lR(t),t);let o=eW(r=r.slice(0,n+1),(t,n,o)=>(nT(n)&&nT(r[o-1])&&t++,t),0);return(n=eK(r=eV(r,nk([t.nodeName])),lR(t),t))-o})(t)+"]",lO=(t,r)=>{let n,o=[],a=r.container(),l=r.offset();if(nT(a))n=((t,r)=>{let n=t;for(;(n=n.previousSibling)&&nT(n);)r+=n.data.length;return r})(a,l);else{let t=a.childNodes;l>=t.length?(n="after",l=t.length-1):n="before",a=t[l]}o.push(lA(a));let i=((t,r,n)=>{let o=[];for(let n=r.parentNode;n&&n!==t;n=n.parentNode)o.push(n);return o})(t,a);return i=eV(i,W(nN)),(o=o.concat(eq(i,t=>lA(t)))).reverse().join("/")+","+n},lT=(t,r)=>{if(!r)return null;let n=r.split(","),o=n[0].split("/"),a=n.length>1?n[1]:"before",l=eW(o,(t,r)=>{var n,o;let a;let l=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(r);return l?("text()"===l[1]&&(l[1]="#text"),n=l[1],o=parseInt(l[2],10),a=eV(a=lN(t),(t,r)=>!nT(t)||!nT(a[r-1])),(a=eV(a,nk([n])))[o]):null},t);if(!l)return null;if(!nT(l)&&l.parentNode){let t;return t="after"===a?lS(l)+1:lS(l),lx(l.parentNode,t)}return((t,r)=>{let n=t,o=0;for(;nT(n);){let a=n.data.length;if(r>=o&&r<=o+a){t=n,r-=o;break}if(!nT(n.nextSibling)){t=n,r=a;break}o+=a,n=n.nextSibling}return nT(t)&&r>t.data.length&&(r=t.data.length),lx(t,r)})(l,parseInt(a,10))},lB=(t,r,n,o,a)=>{let l=a?o.startContainer:o.endContainer,i=a?o.startOffset:o.endOffset,s=[],d=t.getRoot();if(nT(l))s.push(n?((t,r,n)=>{let o=t(r.data.slice(0,n)).length;for(let n=r.previousSibling;n&&nT(n);n=n.previousSibling)o+=t(n.data).length;return o})(r,l,i):i);else{let r=0,o=l.childNodes;i>=o.length&&o.length&&(r=1,i=Math.max(0,o.length-1)),s.push(t.nodeIndex(o[i],n)+r)}for(let r=l;r&&r!==d;r=r.parentNode)s.push(t.nodeIndex(r,n));return s},lD=(t,r,n)=>{let o=0;return tF.each(t.select(r),t=>"all"===t.getAttribute("data-mce-bogus")?void 0:t!==n&&void o++),o},lP=(t,r)=>{let n=r?t.startContainer:t.endContainer,o=r?t.startOffset:t.endOffset;if(nx(n)&&"TR"===n.nodeName){let a=n.childNodes;(n=a[Math.min(r?o:o-1,a.length-1)])&&(o=r?0:n.childNodes.length,r?t.setStart(n,o):t.setEnd(n,o))}},lL=t=>(lP(t,!0),lP(t,!1),t),lF=(t,r)=>{if(nx(t)&&nz(t=li(t,r)))return t;if(ol(t)){nT(t)&&oo(t)&&(t=t.parentNode);let r=t.previousSibling;if(nz(r)||nz(r=t.nextSibling))return r}},lM=(t,r,n)=>{let o=n.getNode(),a=n.getRng();if("IMG"===o.nodeName||nz(o)){let t=o.nodeName;return{name:t,index:lD(n.dom,t,o)}}let l=lF(a.startContainer,a.startOffset)||lF(a.endContainer,a.endOffset);if(l){let t=l.tagName;return{name:t,index:lD(n.dom,t,l)}}return((t,r,n,o)=>{let a=r.dom,l=lB(a,t,n,o,!0),i=r.isForward(),s=of(o)?{isFakeCaret:!0}:{};return r.isCollapsed()?{start:l,forward:i,...s}:{start:l,end:lB(a,t,n,o,!1),forward:i,...s}})(t,n,r,a)},lI=(t,r,n)=>{let o={"data-mce-type":"bookmark",id:r,style:"overflow:hidden;line-height:0px"};return n?t.create("span",o,"&#xFEFF;"):t.create("span",o)},lU=(t,r)=>{let n=t.dom,o=t.getRng(),a=n.uniqueId(),l=t.isCollapsed(),i=t.getNode(),s=i.nodeName,d=t.isForward();if("IMG"===s)return{name:s,index:lD(n,s,i)};let c=lL(o.cloneRange());if(!l){c.collapse(!1);let t=lI(n,a+"_end",r);lk(n,c,t)}(o=lL(o)).collapse(!0);let u=lI(n,a+"_start",r);return lk(n,o,u),t.moveToBookmark({id:a,keep:!0,forward:d}),{id:a,forward:d}},lz=V(lM,$,!0),lj={value:t=>{let r=r=>r(t),n=H(t),o=()=>a,a={tag:!0,inner:t,fold:(r,n)=>n(t),isValue:Q,isError:X,map:r=>lj.value(r(t)),mapError:o,bind:r,exists:r,forall:r,getOr:n,or:o,getOrThunk:n,orThunk:o,getOrDie:n,each:r=>{r(t)},toOptional:()=>J.some(t)};return a},error:t=>{let r=()=>n,n={tag:!1,inner:t,fold:(r,n)=>r(t),isValue:X,isError:Q,map:r,mapError:r=>lj.error(r(t)),bind:r,exists:X,forall:Q,getOr:$,or:$,getOrThunk:G,orThunk:G,getOrDie:K(String(t)),each:U,toOptional:J.none};return n}},lH=t=>{if(!O(t))throw Error("cases must be an array");if(0===t.length)throw Error("there must be at least one case");let r=[],n={};return el(t,(o,a)=>{let l=eN(o);if(1!==l.length)throw Error("one and only one name per case");let i=l[0],s=o[i];if(void 0!==n[i])throw Error("duplicate key detected:"+i);if("cata"===i)throw Error("cannot have a case named cata (sorry)");if(!O(s))throw Error("case arguments must be an array");r.push(i),n[i]=(...n)=>{let o=n.length;if(o!==s.length)throw Error("Wrong number of arguments to case "+i+". Expected "+s.length+" ("+s+"), got "+o);return{fold:(...r)=>{if(r.length!==t.length)throw Error("Wrong number of arguments to fold. Expected "+t.length+", got "+r.length);return r[a].apply(null,n)},match:t=>{let o=eN(t);if(r.length!==o.length)throw Error("Wrong number of arguments to match. Expected: "+r.join(",")+"\nActual: "+o.join(","));if(!eb(r,t=>en(o,t)))throw Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+r.join(", "));return t[i].apply(null,n)},log:t=>{console.log(t,{constructors:r,constructor:i,params:n})}}}}),n};lH([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);let l$=t=>"inline-command"===t.type||"inline-format"===t.type,lq=t=>"block-command"===t.type||"block-format"===t.type,lV=t=>{let r=r=>lj.error({message:r,pattern:t}),n=(n,o,a)=>{if(void 0!==t.format){let a;if(O(t.format)){if(!eb(t.format,N))return r(n+" pattern has non-string items in the `format` array");a=t.format}else{if(!N(t.format))return r(n+" pattern has non-string `format` parameter");a=[t.format]}return lj.value(o(a))}return void 0!==t.cmd?N(t.cmd)?lj.value(a(t.cmd,t.value)):r(n+" pattern has non-string `cmd` parameter"):r(n+" pattern is missing both `format` and `cmd` parameters")};if(!R(t))return r("Raw pattern is not an object");if(!N(t.start))return r("Raw pattern is missing `start` parameter");if(void 0!==t.end){if(!N(t.end))return r("Inline pattern has non-string `end` parameter");if(0===t.start.length&&0===t.end.length)return r("Inline pattern has empty `start` and `end` parameters");let o=t.start,a=t.end;return 0===a.length&&(a=o,o=""),n("Inline",t=>({type:"inline-format",start:o,end:a,format:t}),(t,r)=>({type:"inline-command",start:o,end:a,cmd:t,value:r}))}return void 0!==t.replacement?N(t.replacement)?0===t.start.length?r("Replacement pattern has empty `start` parameter"):lj.value({type:"inline-command",start:"",end:t.start,cmd:"mceInsertContent",value:t.replacement}):r("Replacement pattern has non-string `replacement` parameter"):0===t.start.length?r("Block pattern has empty `start` parameter"):n("Block",r=>({type:"block-format",start:t.start,format:r[0]}),(r,n)=>({type:"block-command",start:t.start,cmd:r,value:n}))},lW=t=>ed(t,lq),lK=t=>ed(t,l$),lG=t=>{let r=(t=>{let r=[],n=[];return el(t,t=>{t.fold(t=>{r.push(t)},t=>{n.push(t)})}),{errors:r,values:n}})(ea(t,lV));return el(r.errors,t=>console.error(t.message,t.pattern)),r.values},lY=tS().deviceType,lX=lY.isTouch(),lQ=aB.DOM,lJ=t=>_(t,RegExp),lZ=t=>r=>r.options.get(t),l0=t=>N(t)||R(t),l1=(t,r="")=>n=>{let o=N(n);if(o)return -1!==n.indexOf("=")?{value:eM(eu(n.indexOf("=")>0?n.split(/[;,](?![^=;,]*(?:[;,]|$))/):n.split(","),(t,r)=>{let n=r.split("="),o=n[0],a=n.length>1?n[1]:o;return t[e6(o)]=e6(a),t},{}),t.id).getOr(r),valid:o}:{value:n,valid:o};return{valid:!1,message:"Must be a string."}},l2=lZ("iframe_attrs"),l3=lZ("doctype"),l8=lZ("document_base_url"),l5=lZ("body_id"),l6=lZ("body_class"),l9=lZ("content_security_policy"),l4=lZ("br_in_pre"),l7=lZ("forced_root_block"),ie=lZ("forced_root_block_attrs"),it=lZ("newline_behavior"),ir=lZ("br_newline_selector"),io=lZ("no_newline_selector"),ia=lZ("keep_styles"),il=lZ("end_container_on_empty_block"),ii=lZ("automatic_uploads"),is=lZ("images_reuse_filename"),id=lZ("images_replace_blob_uris"),ic=lZ("icons"),iu=lZ("icons_url"),im=lZ("images_upload_url"),ig=lZ("images_upload_base_path"),ip=lZ("images_upload_credentials"),ih=lZ("images_upload_handler"),ib=lZ("content_css_cors"),iv=lZ("referrer_policy"),iy=lZ("language"),iC=lZ("language_url"),iw=lZ("indent_use_margin"),ix=lZ("indentation"),iE=lZ("content_css"),ik=lZ("content_style"),iS=lZ("font_css"),i_=lZ("directionality"),iN=lZ("inline_boundaries_selector"),iR=lZ("object_resizing"),iA=lZ("resize_img_proportional"),iO=lZ("placeholder"),iT=lZ("event_root"),iB=lZ("service_message"),iD=lZ("theme"),iP=lZ("theme_url"),iL=lZ("model"),iF=lZ("model_url"),iM=lZ("inline_boundaries"),iI=lZ("formats"),iU=lZ("preview_styles"),iz=lZ("format_empty_lines"),ij=lZ("format_noneditable_selector"),iH=lZ("custom_ui_selector"),i$=lZ("inline"),iq=lZ("hidden_input"),iV=lZ("submit_patch"),iW=lZ("add_form_submit_trigger"),iK=lZ("add_unload_trigger"),iG=lZ("custom_undo_redo_levels"),iY=lZ("disable_nodechange"),iX=lZ("readonly"),iQ=lZ("editable_root"),iJ=lZ("content_css_cors"),iZ=lZ("plugins"),i0=lZ("external_plugins"),i1=lZ("block_unsupported_drop"),i2=lZ("visual"),i3=lZ("visual_table_class"),i8=lZ("visual_anchor_class"),i5=lZ("iframe_aria_text"),i6=lZ("setup"),i9=lZ("init_instance_callback"),i4=lZ("urlconverter_callback"),i7=lZ("auto_focus"),se=lZ("browser_spellcheck"),st=lZ("protect"),sr=lZ("paste_block_drop"),sn=lZ("paste_data_images"),so=lZ("paste_preprocess"),sa=lZ("paste_postprocess"),sl=lZ("newdocument_content"),si=lZ("paste_webkit_styles"),ss=lZ("paste_remove_styles_if_webkit"),sd=lZ("paste_merge_formats"),sc=lZ("smart_paste"),su=lZ("paste_as_text"),sm=lZ("paste_tab_spaces"),sf=lZ("allow_html_data_urls"),sg=lZ("text_patterns"),sp=lZ("text_patterns_lookup"),sh=lZ("noneditable_class"),sb=lZ("editable_class"),sv=lZ("noneditable_regexp"),sy=lZ("preserve_cdata"),sC=lZ("highlight_on_focus"),sw=lZ("xss_sanitization"),sx=lZ("init_content_sync"),sE=t=>tF.explode(t.options.get("images_file_types")),sk=lZ("table_tab_navigation"),sS=lZ("details_initial_state"),s_=lZ("details_serialized_state"),sN=t=>{let r=t.parentNode;r&&r.removeChild(t)},sR=t=>{let r=on(t);return{count:t.length-r.length,text:r}},sA=t=>{let r;for(;-1!==(r=t.data.lastIndexOf("\uFEFF"));)t.deleteData(r,1)},sO=(t,r)=>(sB(t),r),sT=(t,r)=>lx.isTextPosition(r)?nT(t)&&r.container()===t?((t,r)=>{let n=sR(t.data.substr(0,r.offset())),o=sR(t.data.substr(r.offset()));return(n.text+o.text).length>0?(sA(t),lx(t,r.offset()-n.count)):r})(t,r):sO(t,r):r.container()===t.parentNode?((t,r)=>{let n=r.container(),o=((t,r)=>{let n=er(t,r);return -1===n?J.none():J.some(n)})(eS(n.childNodes),t).map(t=>t<r.offset()?lx(n,r.offset()-1):r).getOr(r);return sB(t),o})(t,r):sO(t,r),sB=t=>{nx(t)&&ol(t)&&(oi(t)?t.removeAttribute("data-mce-caret"):sN(t)),nT(t)&&(sA(t),0===t.data.length&&sN(t))},sD=(t,r,n)=>{let o,a;let l=lt(r.getBoundingClientRect(),n);if("BODY"===t.tagName){let r=t.ownerDocument.documentElement;o=t.scrollLeft||r.scrollLeft,a=t.scrollTop||r.scrollTop}else{let r=t.getBoundingClientRect();o=t.scrollLeft-r.left,a=t.scrollTop-r.top}l.left+=o,l.right+=o,l.top+=a,l.bottom+=a,l.width=1;let i=r.offsetWidth-r.clientWidth;return i>0&&(n&&(i*=-1),l.left+=i,l.right+=i),l},sP=(t,r,n,o)=>{let a,l;let i=aH(),s=l7(t),d=t.dom,c=()=>{(t=>{var r,n;let o=nb(ri(t),"*[contentEditable=false],video,audio,embed,object");for(let t=0;t<o.length;t++){let a=o[t].dom,l=a.previousSibling;if(ou(l)){let t=l.data;1===t.length?null===(r=l.parentNode)||void 0===r||r.removeChild(l):l.deleteData(t.length-1,1)}oc(l=a.nextSibling)&&(1===l.data.length?null===(n=l.parentNode)||void 0===n||n.removeChild(l):l.deleteData(0,1))}})(r),l&&(sB(l),l=null),i.on(t=>{d.remove(t.caret),i.clear()}),a&&(clearInterval(a),a=void 0)};return{show:(t,u)=>{let m;if(c(),nj(u))return null;if(!n(u))return l=((t,r)=>{var n;let o=(null!==(n=t.ownerDocument)&&void 0!==n?n:document).createTextNode("\uFEFF"),a=t.parentNode;if(r){let r=t.previousSibling;if(nT(r)){if(ol(r))return r;if(ou(r))return r.splitText(r.data.length-1)}null==a||a.insertBefore(o,t)}else{let r=t.nextSibling;if(nT(r)){if(ol(r))return r;if(oc(r))return r.splitText(1),r}t.nextSibling?null==a||a.insertBefore(o,t.nextSibling):null==a||a.appendChild(o)}return o})(u,t),m=u.ownerDocument.createRange(),sF(l.nextSibling)?(m.setStart(l,0),m.setEnd(l,0)):(m.setStart(l,1),m.setEnd(l,1)),m;{let n=((t,r,n)=>{var o;let a=(null!==(o=r.ownerDocument)&&void 0!==o?o:document).createElement(t);a.setAttribute("data-mce-caret",n?"before":"after"),a.setAttribute("data-mce-bogus","all"),a.appendChild(oe().dom);let l=r.parentNode;return n?null==l||l.insertBefore(a,r):r.nextSibling?null==l||l.insertBefore(a,r.nextSibling):null==l||l.appendChild(a),a})(s,u,t),c=sD(r,u,t);d.setStyle(n,"top",c.top),l=n;let f=d.create("div",{class:"mce-visual-caret","data-mce-bogus":"all"});d.setStyles(f,{...c}),d.add(r,f),i.set({caret:f,element:u,before:t}),t&&d.addClass(f,"mce-visual-caret-before"),a=setInterval(()=>{i.on(t=>{o()?d.toggleClass(t.caret,"mce-visual-caret-hidden"):d.addClass(t.caret,"mce-visual-caret-hidden")})},500),(m=u.ownerDocument.createRange()).setStart(n,0),m.setEnd(n,0)}return m},hide:c,getCss:()=>".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}",reposition:()=>{i.on(t=>{let n=sD(r,t.element,t.before);d.setStyles(t.caret,{...n})})},destroy:()=>clearInterval(a)}},sL=()=>tB.browser.isFirefox(),sF=t=>nz(t)||n$(t),sM=t=>(sF(t)||nR(t)&&sL())&&rw(ri(t)).exists(rK),sI=nS("display","block table table-cell table-caption list-item"),sU=t=>t>0,sz=t=>t<0,sj=(t,r)=>{let n;for(;n=t(r);)if(!oo(n))return n;return null},sH=(t,r,n,o,a)=>{let l;let i=new ny(t,o),s=nz(t)||oo(t);if(sz(r)){if(s&&n(l=sj(i.prev.bind(i),!0)))return l;for(;l=sj(i.prev.bind(i),a);)if(n(l))return l}if(sU(r)){if(s&&n(l=sj(i.next.bind(i),!0)))return l;for(;l=sj(i.next.bind(i),a);)if(n(l))return l}return null},s$=(t,r)=>{for(;t&&t!==r;){if(sI(t))return t;t=t.parentNode}return null},sq=(t,r,n)=>s$(t.container(),n)===s$(r.container(),n),sV=(t,r)=>{if(!r)return J.none();let n=r.container(),o=r.offset();return nx(n)?J.from(n.childNodes[o+t]):J.none()},sW=(t,r)=>{var n;let o=(null!==(n=r.ownerDocument)&&void 0!==n?n:document).createRange();return t?(o.setStartBefore(r),o.setEndBefore(r)):(o.setStartAfter(r),o.setEndAfter(r)),o},sK=(t,r,n)=>s$(r,t)===s$(n,t),sG=(t,r,n)=>{let o=t?"previousSibling":"nextSibling",a=n;for(;a&&a!==r;){let t=a[o];if(t&&ol(t)&&(t=t[o]),nz(t)||n$(t)){if(sK(r,t,a))return t;break}if(ob(t))break;a=a.parentNode}return null},sY=V(sW,!0),sX=V(sW,!1),sQ=(t,r,n)=>{let o;let a=V(sG,!0,r),l=V(sG,!1,r),i=n.startContainer,s=n.startOffset;if(oo(i)){let t=nT(i)?i.parentNode:i,r=t.getAttribute("data-mce-caret");if("before"===r&&sM(o=t.nextSibling))return sY(o);if("after"===r&&sM(o=t.previousSibling))return sX(o)}if(!n.collapsed)return n;if(nT(i)){if(ol(i)){if(1===t){if(o=l(i))return sY(o);if(o=a(i))return sX(o)}if(-1===t){if(o=a(i))return sX(o);if(o=l(i))return sY(o)}return n}if(ou(i)&&s>=i.data.length-1)return 1===t&&(o=l(i))?sY(o):n;if(oc(i)&&s<=1)return -1===t&&(o=a(i))?sX(o):n;if(s===i.data.length)return(o=l(i))?sY(o):n;if(0===s)return(o=a(i))?sX(o):n}return n},sJ=(t,r)=>sV(t?0:-1,r).filter(nz),sZ=(t,r,n)=>{let o=sQ(t,r,n);return -1===t?lx.fromRangeStart(o):lx.fromRangeEnd(o)},s0=t=>J.from(t.getNode()).map(ri),s1=(t,r)=>{let n=r;for(;(n=t(n))&&!n.isVisible(););return n},s2=(t,r)=>{let n=sq(t,r);return!(n||!nM(t.getNode()))||n};(pR=pA||(pA={}))[pR.Backwards=-1]="Backwards",pR[pR.Forwards=1]="Forwards";let s3=t=>op(t)||!!ov(t)&&!eu(eS(t.getElementsByTagName("*")),(t,r)=>t||nU(r),!1),s8=(t,r)=>t.hasChildNodes()&&r<t.childNodes.length?t.childNodes[r]:null,s5=(t,r)=>{if(sU(t)){if(ob(r.previousSibling)&&!nT(r.previousSibling))return lx.before(r);if(nT(r))return lx(r,0)}if(sz(t)){if(ob(r.nextSibling)&&!nT(r.nextSibling))return lx.after(r);if(nT(r))return lx(r,r.data.length)}return sz(t)?nM(r)?lx.before(r):lx.after(r):lx.before(r)},s6=(t,r,n)=>{let o,a,l,i;if(!nx(n)||!r)return null;if(r.isEqual(lx.after(n))&&n.lastChild){if(i=lx.after(n.lastChild),sz(t)&&ob(n.lastChild)&&nx(n.lastChild))return nM(n.lastChild)?lx.before(n.lastChild):i}else i=r;let s=i.container(),d=i.offset();if(nT(s)){if(sz(t)&&d>0)return lx(s,--d);if(sU(t)&&d<s.length)return lx(s,++d);o=s}else{if(sz(t)&&d>0&&ob(a=s8(s,d-1)))return!s3(a)&&(l=sH(a,t,oy,a))?nT(l)?lx(l,l.data.length):lx.after(l):nT(a)?lx(a,a.data.length):lx.before(a);if(sU(t)&&d<s.childNodes.length&&ob(a=s8(s,d)))return nM(a)?((t,r)=>{let n=r.nextSibling;return n&&ob(n)?nT(n)?lx(n,0):lx.before(n):s6(pA.Forwards,lx.after(r),t)})(n,a):!s3(a)&&(l=sH(a,t,oy,a))?nT(l)?lx(l,0):lx.before(l):nT(a)?lx(a,0):lx.after(a);o=a||i.getNode()}if(o&&(sU(t)&&i.isAtEnd()||sz(t)&&i.isAtStart())&&oy(o=sH(o,t,Q,n,!0),n))return s5(t,o);a=o?sH(o,t,oy,n):o;let c=eG(ed(((t,r)=>{let n=[],o=t;for(;o&&o!==r;)n.push(o),o=o.parentNode;return n})(s,n),nz));return!c||a&&c.contains(a)?a?s5(t,a):null:i=sU(t)?lx.after(c):lx.before(c)},s9=t=>({next:r=>s6(pA.Forwards,r,t),prev:r=>s6(pA.Backwards,r,t)}),s4=t=>lx.isTextPosition(t)?0===t.offset():ob(t.getNode()),s7=t=>{if(lx.isTextPosition(t)){let r=t.container();return t.offset()===r.data.length}return ob(t.getNode(!0))},de=(t,r)=>!lx.isTextPosition(t)&&!lx.isTextPosition(r)&&t.getNode()===r.getNode(!0),dt=(t,r,n)=>{let o=s9(r);return J.from(t?o.next(n):o.prev(n))},dr=(t,r,n)=>dt(t,r,n).bind(o=>sq(n,o,r)&&(t?!de(n,o)&&!(!lx.isTextPosition(n)&&nM(n.getNode()))&&s7(n)&&s4(o):!de(o,n)&&s4(n)&&s7(o))?dt(t,r,o):J.some(o)),dn=(t,r,n,o)=>dr(t,r,n).bind(n=>o(n)?dn(t,r,n,o):J.some(n)),da=(t,r)=>{let n=t?r.firstChild:r.lastChild;return nT(n)?J.some(lx(n,t?0:n.data.length)):n?ob(n)?J.some(t?lx.before(n):nM(n)?lx.before(n):lx.after(n)):((t,r,n)=>{let o=t?lx.before(n):lx.after(n);return dt(t,r,o)})(t,r,n):J.none()},dl=V(dt,!0),di=V(dt,!1),ds=V(da,!0),dd=V(da,!1),dc="_mce_caret",du=t=>nx(t)&&t.id===dc,dm=(t,r)=>{let n=r;for(;n&&n!==t;){if(du(n))return n;n=n.parentNode}return null},df=t=>eI(t,"name"),dg=t=>tF.isArray(t.start),dp=t=>!(!df(t)&&B(t.forward))||t.forward,dh=(t,r)=>(nx(r)&&t.isBlock(r)&&!r.innerHTML&&(r.innerHTML='<br data-mce-bogus="1" />'),r),db=(t,r)=>dd(t).fold(X,t=>(r.setStart(t.container(),t.offset()),r.setEnd(t.container(),t.offset()),!0)),dv=(t,r,n)=>!(r.hasChildNodes()||!dm(t,r)||(((t,r)=>{var n;let o=(null!==(n=t.ownerDocument)&&void 0!==n?n:document).createTextNode("\uFEFF");t.appendChild(o),r.setStart(o,0),r.setEnd(o,0)})(r,n),0)),dy=(t,r,n,o)=>{let a=n[r?"start":"end"],l=t.getRoot();if(a){let t=l,n=a[0];for(let r=a.length-1;t&&r>=1;r--){let n=t.childNodes;if(dv(l,t,o))return!0;if(a[r]>n.length-1)return!!dv(l,t,o)||db(t,o);t=n[a[r]]}nT(t)&&(n=Math.min(a[0],t.data.length)),nx(t)&&(n=Math.min(a[0],t.childNodes.length)),r?o.setStart(t,n):o.setEnd(t,n)}return!0},dC=t=>nT(t)&&t.data.length>0,dw=(t,r,n)=>{let o=t.get(n.id+"_"+r),a=null==o?void 0:o.parentNode,l=n.keep;if(o&&a){let i,s;if("start"===r?l?o.hasChildNodes()?(i=o.firstChild,s=1):dC(o.nextSibling)?(i=o.nextSibling,s=0):dC(o.previousSibling)?(i=o.previousSibling,s=o.previousSibling.data.length):(i=a,s=t.nodeIndex(o)+1):(i=a,s=t.nodeIndex(o)):l?o.hasChildNodes()?(i=o.firstChild,s=1):dC(o.previousSibling)?(i=o.previousSibling,s=o.previousSibling.data.length):(i=a,s=t.nodeIndex(o)):(i=a,s=t.nodeIndex(o)),!l){let a;let l=o.previousSibling,d=o.nextSibling;for(tF.each(tF.grep(o.childNodes),t=>{nT(t)&&(t.data=t.data.replace(/\uFEFF/g,""))});a=t.get(n.id+"_"+r);)t.remove(a,!0);if(nT(d)&&nT(l)&&!tB.browser.isOpera()){let r=l.data.length;l.appendData(d.data),t.remove(d),i=l,s=r}}return J.some(lx(i,s))}return J.none()},dx=(t,r,n)=>((t,r,n=!1)=>2===r?lM(on,n,t):3===r?(t=>{let r=t.getRng();return{start:lO(t.dom.getRoot(),lx.fromRangeStart(r)),end:lO(t.dom.getRoot(),lx.fromRangeEnd(r)),forward:t.isForward()}})(t):r?{rng:t.getRng(),forward:t.isForward()}:lU(t,!1))(t,r,n),dE=(t,r)=>{((t,r)=>{let n=t.dom;if(r){if(dg(r))return((t,r)=>{let n=t.createRng();return dy(t,!0,r,n)&&dy(t,!1,r,n)?J.some({range:n,forward:dp(r)}):J.none()})(n,r);if(N(r.start))return tU(J.from(lT(n.getRoot(),r.start)),J.from(lT(n.getRoot(),r.end)),(t,o)=>{let a=n.createRng();return a.setStart(t.container(),t.offset()),a.setEnd(o.container(),o.offset()),{range:a,forward:dp(r)}});if(eI(r,"id"))return((t,r)=>{let n=dw(t,"start",r);return tU(n,dw(t,"end",r).or(n),(n,o)=>{let a=t.createRng();return a.setStart(dh(t,n.container()),n.offset()),a.setEnd(dh(t,o.container()),o.offset()),{range:a,forward:dp(r)}})})(n,r);if(df(r))return J.from(n.select(r.name)[r.index]).map(t=>{let r=n.createRng();return r.selectNode(t),{range:r,forward:!0}});if(eI(r,"rng"))return J.some({range:r.rng,forward:dp(r)})}return J.none()})(t,r).each(({range:r,forward:n})=>{t.setRng(r,n)})},dk=t=>nx(t)&&"SPAN"===t.tagName&&"bookmark"===t.getAttribute("data-mce-type"),dS=t=>"\xa0"===t,d_=t=>""!==t&&-1!==" \f\n\r	\v".indexOf(t),dN=t=>!d_(t)&&!dS(t)&&!nK(t),dR=t=>{let r=t.toString(16);return(1===r.length?"0"+r:r).toUpperCase()},dA=t=>({value:e1(dR(t.red)+dR(t.green)+dR(t.blue),"#").toUpperCase()}),dO=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,dT=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,dB=(t,r,n,o)=>({red:t,green:r,blue:n,alpha:o}),dD=(t,r,n,o)=>{let a=parseInt(t,10);return dB(a,parseInt(r,10),parseInt(n,10),parseFloat(o))},dP=t=>(t=>{if("transparent"===t)return J.some(dB(0,0,0,0));let r=dO.exec(t);if(null!==r)return J.some(dD(r[1],r[2],r[3],"1"));let n=dT.exec(t);return null!==n?J.some(dD(n[1],n[2],n[3],n[4])):J.none()})(t).map(dA).map(t=>"#"+t.value).getOr(t),dL=t=>{let r=[];if(t)for(let n=0;n<t.rangeCount;n++)r.push(t.getRangeAt(n));return r},dF=(t,r)=>{let n=nb(r,"td[data-mce-selected],th[data-mce-selected]");return n.length>0?n:ed(eh(t,t=>{let r=ll(t);return r?[ri(r)]:[]}),n6)},dM=t=>dF(dL(t.selection.getSel()),ri(t.getBody())),dI=(t,r)=>rq(t,"table",r),dU=t=>rA(t).fold(H([t]),r=>[t].concat(dU(r))),dz=t=>rO(t).fold(H([t]),r=>"br"===tV(r)?rE(r).map(r=>[t].concat(dz(r))).getOr([]):[t].concat(dz(r))),dj=(t,r)=>tU((t=>{let r=t.startContainer,n=t.startOffset;return nT(r)?0===n?J.some(ri(r)):J.none():J.from(r.childNodes[n]).map(ri)})(r),(t=>{let r=t.endContainer,n=t.endOffset;return nT(r)?n===r.data.length?J.some(ri(r)):J.none():J.from(r.childNodes[n-1]).map(ri)})(r),(r,n)=>{let o=ef(dU(t),V(rp,r)),a=ef(dz(t),V(rp,n));return o.isSome()&&a.isSome()}).getOr(!1),dH=(t,r,n,o)=>{let a=new ny(n,n),l=eP(t.schema.getMoveCaretBeforeOnEnterElements(),(t,r)=>!en(["td","th","table"],r.toLowerCase())),i=n;do{if(nT(i)&&0!==tF.trim(i.data).length)return void(o?r.setStart(i,0):r.setEnd(i,i.data.length));if(l[i.nodeName])return void(o?r.setStartBefore(i):"BR"===i.nodeName?r.setEndBefore(i):r.setEndAfter(i))}while(i=o?a.next():a.prev());"BODY"===n.nodeName&&(o?r.setStart(n,0):r.setEnd(n,n.childNodes.length))},d$=t=>{let r=t.selection.getSel();return L(r)&&r.rangeCount>0},dq=(t,r)=>{let n=dM(t);n.length>0?el(n,n=>{let o=n.dom,a=t.dom.createRng();a.setStartBefore(o),a.setEndAfter(o),r(a,!0)}):r(t.selection.getRng(),!1)},dV=(t,r,n)=>{let o=lU(t,r);n(o),t.moveToBookmark(o)},dW=t=>M(null==t?void 0:t.nodeType),dK=t=>nx(t)&&!dk(t)&&!du(t)&&!nN(t),dG=t=>!0===t.isContentEditable,dY=(t,r,n)=>{let{selection:o,dom:a}=t,l=o.getNode(),i=nz(l);dV(o,!0,()=>{r()}),i&&nz(l)&&a.isChildOf(l,t.getBody())?t.selection.select(l):n(o.getStart())&&dX(a,o)},dX=(t,r)=>{var n,o;let a=r.getRng(),{startContainer:l,startOffset:i}=a;if(!((t,r)=>{if(dK(r)&&!/^(TD|TH)$/.test(r.nodeName)){let n=parseInt(t.getAttrib(r,"data-mce-selected"),10);return!isNaN(n)&&n>0}return!1})(t,r.getNode())&&nx(l)){let s;let d=l.childNodes,c=t.getRoot();if(i<d.length){let r=d[i];s=new ny(r,null!==(n=t.getParent(r,t.isBlock))&&void 0!==n?n:c)}else{let r=d[d.length-1];(s=new ny(r,null!==(o=t.getParent(r,t.isBlock))&&void 0!==o?o:c)).next(!0)}for(let n=s.current();n;n=s.next()){if("false"===t.getContentEditable(n))return;if(nT(n)&&!d0(n))return a.setStart(n,0),void r.setRng(a)}}},dQ=(t,r,n)=>{if(t){let o=r?"nextSibling":"previousSibling";for(t=n?t:t[o];t;t=t[o])if(nx(t)||!d0(t))return t}},dJ=(t,r)=>!!t.getTextBlockElements()[r.nodeName.toLowerCase()]||oj(t,r),dZ=(t,r,n)=>t.schema.isValidChild(r,n),d0=(t,r=!1)=>!!(L(t)&&nT(t))&&ow(r?t.data.replace(/ /g,"\xa0"):t.data),d1=(t,r)=>{let n=t.dom;return dK(r)&&"false"===n.getContentEditable(r)&&((t,r)=>{let n="[data-mce-cef-wrappable]",o=ij(t),a=te(o)?n:`${n},${o}`;return rf(ri(r),a)})(t,r)&&0===n.select('[contenteditable="true"]',r).length},d2=(t,r)=>F(t)?t(r):(L(r)&&(t=t.replace(/%(\w+)/g,(t,n)=>r[n]||t)),t),d3=(t,r)=>(r=r||"",t=""+((t=t||"").nodeName||t),r=""+(r.nodeName||r),t.toLowerCase()===r.toLowerCase()),d8=(t,r)=>{if(P(t))return null;{let n=String(t);return"color"!==r&&"backgroundColor"!==r||(n=dP(n)),"fontWeight"===r&&700===t&&(n="bold"),"fontFamily"===r&&(n=n.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),n}},d5=(t,r,n)=>d8(t.getStyle(r,n),n),d6=(t,r)=>{let n;return t.getParent(r,r=>!!nx(r)&&!!(n=t.getStyle(r,"text-decoration"))&&"none"!==n),n},d9=(t,r,n)=>t.getParents(r,n,t.getRoot()),d4=(t,r,n)=>{let o=t.formatter.get(r);return L(o)&&eo(o,n)},d7=t=>eU(t,"block"),ce=t=>eU(t,"selector"),ct=t=>eU(t,"inline"),cr=t=>ce(t)&&!1!==t.expand&&!ct(t),cn=(t,r)=>{let n=r;for(;n;){if(nx(n)&&t.getContentEditable(n))return"false"===t.getContentEditable(n)?n:r;n=n.parentNode}return r},co=(t,r,n,o)=>{let a=r.data;if(t){for(let t=n;t>0;t--)if(o(a.charAt(t-1)))return t}else for(let t=n;t<a.length;t++)if(o(a.charAt(t)))return t;return -1},ca=(t,r,n)=>co(t,r,n,t=>dS(t)||d_(t)),cl=(t,r,n)=>co(t,r,n,dN),ci=(t,r,n,o,a,l)=>{let i;let s=t.getParent(n,t.isBlock)||r,d=(r,n,o)=>{let l=a4(t),d=a?l.backwards:l.forwards;return J.from(d(r,n,(t,r)=>dk(t.parentNode)?-1:(i=t,o(a,t,r)),s))};return d(n,o,ca).bind(t=>l?d(t.container,t.offset+(a?-1:0),cl):J.some(t)).orThunk(()=>i?J.some({container:i,offset:a?0:i.length}):J.none())},cs=(t,r,n,o,a)=>{let l=o[a];nT(o)&&te(o.data)&&l&&(o=l);let i=d9(t,o);for(let o=0;o<i.length;o++)for(let a=0;a<r.length;a++){let l=r[a];if((!L(l.collapsed)||l.collapsed===n.collapsed)&&ce(l)&&t.is(i[o],l.selector))return i[o]}return o},cd=(t,r,n,o)=>{var a;let l=n,i=t.getRoot(),s=r[0];if(d7(s)&&(l=s.wrapper?null:t.getParent(n,s.block,i)),!l){let r=null!==(a=t.getParent(n,"LI,TD,TH"))&&void 0!==a?a:i;l=t.getParent(nT(n)?n.parentNode:n,r=>r!==i&&dJ(t.schema,r),r)}if(l&&d7(s)&&s.wrapper&&(l=d9(t,l,"ul,ol").reverse()[0]||l),!l)for(l=n;l&&l[o]&&!t.isBlock(l[o])&&!d3(l=l[o],"br"););return l||n},cc=(t,r,n,o)=>{let a=n.parentNode;return!L(n[o])&&(!(a!==r&&!P(a)&&!t.isBlock(a))||cc(t,r,a,o))},cu=(t,r,n,o,a)=>{var l;let i=n,s=a?"previousSibling":"nextSibling",d=t.getRoot();if(nT(n)&&!d0(n)&&(a?o>0:o<n.data.length))return n;for(;i;){if(!r[0].block_expand&&t.isBlock(i))return i;for(let r=i[s];r;r=r[s]){let n=nT(r)&&!cc(t,d,r,s);if(!dk(r)&&(!nM(l=r)||!l.getAttribute("data-mce-bogus")||l.nextSibling)&&!d0(r,n))return i}if(i===d||i.parentNode===d){n=i;break}i=i.parentNode}return n},cm=t=>dk(t.parentNode)||dk(t),cf=(t,r,n,o=!1)=>{let{startContainer:a,startOffset:l,endContainer:i,endOffset:s}=r,d=n[0];return nx(a)&&a.hasChildNodes()&&nT(a=li(a,l))&&(l=0),nx(i)&&i.hasChildNodes()&&nT(i=li(i,r.collapsed?s:s-1))&&(s=i.data.length),a=cn(t,a),i=cn(t,i),cm(a)&&(a=dk(a)?a:a.parentNode,nT(a=r.collapsed?a.previousSibling||a:a.nextSibling||a)&&(l=r.collapsed?a.length:0)),cm(i)&&(i=dk(i)?i:i.parentNode,nT(i=r.collapsed?i.nextSibling||i:i.previousSibling||i)&&(s=r.collapsed?0:i.length)),r.collapsed&&(ci(t,t.getRoot(),a,l,!0,o).each(({container:t,offset:r})=>{a=t,l=r}),ci(t,t.getRoot(),i,s,!1,o).each(({container:t,offset:r})=>{i=t,s=r})),(ct(d)||d.block_expand)&&(ct(d)&&nT(a)&&0!==l||(a=cu(t,n,a,l,!0)),ct(d)&&nT(i)&&s!==i.data.length||(i=cu(t,n,i,s,!1))),cr(d)&&(a=cs(t,n,r,a,"previousSibling"),i=cs(t,n,r,i,"nextSibling")),(d7(d)||ce(d))&&(a=cd(t,n,a,"previousSibling"),i=cd(t,n,i,"nextSibling"),d7(d)&&(t.isBlock(a)||(a=cu(t,n,a,l,!0)),t.isBlock(i)||(i=cu(t,n,i,s,!1)))),nx(a)&&a.parentNode&&(l=t.nodeIndex(a),a=a.parentNode),nx(i)&&i.parentNode&&(s=t.nodeIndex(i)+1,i=i.parentNode),{startContainer:a,startOffset:l,endContainer:i,endOffset:s}},cg=(t,r,n)=>{var o;let a=r.startOffset,l=li(r.startContainer,a),i=r.endOffset,s=li(r.endContainer,i-1),d=t=>{let r=t[0];nT(r)&&r===l&&a>=r.data.length&&t.splice(0,1);let n=t[t.length-1];return 0===i&&t.length>0&&n===s&&nT(n)&&t.splice(t.length-1,1),t},c=(t,r,n)=>{let o=[];for(;t&&t!==n;t=t[r])o.push(t);return o},u=(r,n)=>t.getParent(r,t=>t.parentNode===n,n),m=(t,r,o)=>{let a=o?"nextSibling":"previousSibling";for(let l=t,i=l.parentNode;l&&l!==r;l=i){i=l.parentNode;let r=c(l===t?l:l[a],a);r.length&&(o||r.reverse(),n(d(r)))}};if(l===s)return n(d([l]));let f=null!==(o=t.findCommonAncestor(l,s))&&void 0!==o?o:t.getRoot();if(t.isChildOf(l,s))return m(l,f,!0);if(t.isChildOf(s,l))return m(s,f);let g=u(l,f)||l,p=u(s,f)||s;m(l,g,!0);let h=c(g===l?g:g.nextSibling,"nextSibling",p===s?p.nextSibling:p);h.length&&n(d(h)),m(s,p)},cp=['pre[class*=language-][contenteditable="false"]',"figure.image","div[data-ephox-embed-iri]","div.tiny-pageembed","div.mce-toc","div[data-mce-toc]"],ch=(t,r,n,o,a,l)=>{let{uid:i=r,...s}=n;rn(t,aV()),t1(t,`${aK()}`,i),t1(t,`${aW()}`,o);let{attributes:d={},classes:c=[]}=a(i,s);if(t2(t,d),el(c,r=>{rn(t,r)}),l){c.length>0&&t1(t,`${aY()}`,c.join(","));let r=eN(d);r.length>0&&t1(t,`${aX()}`,r.join(","))}},cb=(t,r,n,o,a)=>{let l=rd("span",t);return ch(l,r,n,o,a,!1),l},cv=(t,r,n,o,a,l)=>{let i=[],s=cb(t.getDoc(),n,l,o,a),d=aH(),c=()=>{d.clear()},u=t=>{el(t,m)},m=r=>{let m,f;switch(m="span",f=tV(r),rC(r).fold(()=>"skipping",n=>"br"===f||tX(r)&&"\uFEFF"===nY(r)?"valid":tY(r)&&rl(r,aV())?"existing":du(r.dom)?"caret":eo(cp,t=>rf(r,t))?"valid-block":dZ(t,m,f)&&dZ(t,tV(n),m)?"valid":"invalid-child")){case"invalid-child":c(),u(rN(r)),c();break;case"valid-block":c(),ch(r,n,l,o,a,!0);break;case"valid":r4(r,d.get().getOrThunk(()=>{let t=a5(s);return i.push(t),d.set(t),t}))}};return cg(t.dom,r,t=>{c(),u(ea(t,ri))}),i},cy=t=>{let r=(()=>{let t={};return{register:(r,n)=>{t[r]={name:r,settings:n}},lookup:r=>eM(t,r).map(t=>t.settings),getNames:()=>eN(t)}})();((t,r)=>{let n=aW(),o=t=>J.from(t.attr(n)).bind(r.lookup),a=t=>{var r,n;t.attr(aK(),null),t.attr(aW(),null),t.attr(aG(),null);let o=J.from(t.attr(aX())).map(t=>t.split(",")).getOr([]),a=J.from(t.attr(aY())).map(t=>t.split(",")).getOr([]);el(o,r=>t.attr(r,null));let l=ey(null!==(n=null===(r=t.attr("class"))||void 0===r?void 0:r.split(" "))&&void 0!==n?n:[],[aV()].concat(a));t.attr("class",l.length>0?l.join(" "):null),t.attr(aY(),null),t.attr(aX(),null)};t.serializer.addTempAttr(aG()),t.serializer.addAttributeFilter(n,t=>{for(let r of t)o(r).each(t=>{!1===t.persistent&&("span"===r.name?r.unwrap():a(r))})})})(t,r);let n=((t,r)=>{let n=aL({}),o=()=>({listeners:[],previous:aH()}),a=(t,r)=>{l(t,t=>(r(t),t))},l=(t,r)=>{let a=n.get(),l=r(eM(a,t).getOrThunk(o));a[t]=l,n.set(a)},i=(r,n)=>{el(a0(t,r),t=>{n?t1(t,aG(),"true"):t6(t,aG())})},s=aq(()=>{el(ew(r.getNames()),r=>{l(r,n=>{let o=n.previous.get();return aJ(t,J.some(r)).fold(()=>{o.each(t=>{a(r,t=>{el(t.listeners,t=>t(!1,r))}),n.previous.clear(),i(t,!1)})},({uid:t,name:r,elements:l})=>{tM(o,t)||(o.each(t=>i(t,!1)),a(r,n=>{el(n.listeners,n=>n(!0,r,{uid:t,nodes:ea(l,t=>t.dom)}))}),n.previous.set(t),i(t,!0))}),{previous:n.previous,listeners:n.listeners}})})},30);return t.on("remove",()=>{s.cancel()}),t.on("NodeChange",()=>{s.throttle()}),{addListener:(t,r)=>{l(t,t=>({previous:t.previous,listeners:t.listeners.concat([r])}))}}})(t,r),o=tZ("span"),a=t=>{el(t,t=>{o(t)?nr(t):(t=>{ra(t,aV()),t6(t,`${aK()}`),t6(t,`${aW()}`),t6(t,`${aG()}`);let r=t8(t,`${aX()}`).map(t=>t.split(",")).getOr([]),n=t8(t,`${aY()}`).map(t=>t.split(",")).getOr([]);el(r,r=>t6(t,r)),el(n,r=>{ra(t,r)}),t6(t,`${aY()}`),t6(t,`${aX()}`)})(t)})};return{register:(t,n)=>{r.register(t,n)},annotate:(n,o)=>{r.lookup(n).each(r=>{((t,r,n,o)=>{t.undoManager.transact(()=>{let a=t.selection,l=a.getRng(),i=dM(t).length>0,s=a3("mce-annotation");if(l.collapsed&&!i&&((t,r)=>{let n=cf(t.dom,r,[{inline:"span"}]);r.setStart(n.startContainer,n.startOffset),r.setEnd(n.endContainer,n.endOffset),t.selection.setRng(r)})(t,l),a.getRng().collapsed&&!i){let l=cb(t.getDoc(),s,o,r,n.decorate);na(l,"\xa0"),a.getRng().insertNode(l.dom),a.select(l.dom)}else dV(a,!1,()=>{dq(t,a=>{cv(t,a,s,r,n.decorate,o)})})})})(t,n,r,o)})},annotationChanged:(t,r)=>{n.addListener(t,r)},remove:r=>{aJ(t,J.some(r)).each(({elements:r})=>{let n=t.selection.getBookmark();a(r),t.selection.moveToBookmark(n)})},removeAll:r=>{let n=t.selection.getBookmark();eA(a1(t,r),(t,r)=>{a(t)}),t.selection.moveToBookmark(n)},getAll:r=>eO(a1(t,r),t=>ea(t,t=>t.dom))}},cC=t=>({getBookmark:V(dx,t),moveToBookmark:V(dE,t)});cC.isBookmarkNode=dk;let cw=(t,r,n)=>!n.collapsed&&eo(n.getClientRects(),n=>t>=n.left&&t<=n.right&&r>=n.top&&r<=n.bottom),cx=(t,r,n)=>{t.dispatch(r,n)},cE=(t,r,n,o)=>{t.dispatch("FormatApply",{format:r,node:n,vars:o})},ck=(t,r,n,o)=>{t.dispatch("FormatRemove",{format:r,node:n,vars:o})},cS=(t,r)=>t.dispatch("SetContent",r),c_=(t,r)=>t.dispatch("GetContent",r),cN=(t,r)=>t.dispatch("PastePlainTextToggle",{state:r}),cR={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:t=>t.shiftKey||t.ctrlKey||t.altKey||cR.metaKeyPressed(t),metaKeyPressed:t=>tB.os.isMacOS()||tB.os.isiOS()?t.metaKey:t.ctrlKey&&!t.altKey},cA="data-mce-selected",cO=Math.abs,cT=Math.round,cB={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},cD=(t,r)=>{let n,o,a,l,i,s,d,c,u,m,f,g,p,h,b;let v=r.dom,y=r.getDoc(),C=document,w=r.getBody(),x=t=>L(t)&&(nI(t)||v.is(t,"figure.image")),E=t=>n$(t)||v.hasClass(t,"mce-preview-object"),k=t=>{let n=t.target;((t,r)=>{if("longpress"===t.type||0===t.type.indexOf("touch")){let n=t.touches[0];return x(t.target)&&!cw(n.clientX,n.clientY,r)}return x(t.target)&&!cw(t.clientX,t.clientY,r)})(t,r.selection.getRng())&&!t.isDefaultPrevented()&&r.selection.select(n)},S=t=>v.hasClass(t,"mce-preview-object")&&L(t.firstElementChild)?[t,t.firstElementChild]:v.is(t,"figure.image")?[t.querySelector("img")]:[t],_=t=>{let n=iR(r);return!!n&&"false"!==t.getAttribute("data-mce-resize")&&t!==r.getBody()&&(v.hasClass(t,"mce-preview-object")&&L(t.firstElementChild)?rf(ri(t.firstElementChild),n):rf(ri(t),n))},N=(t,n,o)=>{L(o)&&el(S(t),t=>{t.style[n]||!r.schema.isValid(t.nodeName.toLowerCase(),n)?v.setStyle(t,n,o):v.setAttrib(t,n,""+o)})},R=(t,r,n)=>{N(t,"width",r),N(t,"height",n)},A=t=>{let i,y,C,k;i=t.screenX-s,y=t.screenY-d,g=i*l[2]+c,p=y*l[3]+u,g=g<5?5:g,p=p<5?5:p,((x(n)||E(n))&&!1!==iA(r)?!cR.modifierPressed(t):cR.modifierPressed(t))&&(cO(i)>cO(y)?(p=cT(g*m),g=cT(p/m)):(g=cT(p/m),p=cT(g*m))),R(o,g,p),C=l.startPos.x+i,k=l.startPos.y+y,C=C>0?C:0,k=k>0?k:0,v.setStyles(a,{left:C,top:k,display:"block"}),a.innerHTML=g+" &times; "+p,l[2]<0&&o.clientWidth<=g&&v.setStyle(o,"left",(void 0)+(c-g)),l[3]<0&&o.clientHeight<=p&&v.setStyle(o,"top",(void 0)+(u-p)),(i=w.scrollWidth-h)+(y=w.scrollHeight-b)!=0&&v.setStyles(a,{left:C-i,top:k-y}),f||(((t,r,n,o,a)=>{t.dispatch("ObjectResizeStart",{target:r,width:n,height:o,origin:a})})(r,n,c,u,"corner-"+l.name),f=!0)},O=()=>{let t=f;f=!1,t&&(N(n,"width",g),N(n,"height",p)),v.unbind(y,"mousemove",A),v.unbind(y,"mouseup",O),C!==y&&(v.unbind(C,"mousemove",A),v.unbind(C,"mouseup",O)),v.remove(o),v.remove(a),v.remove(i),T(n),t&&(((t,r,n,o,a)=>{t.dispatch("ObjectResized",{target:r,width:n,height:o,origin:a})})(r,n,g,p,"corner-"+l.name),v.setAttrib(n,"style",v.getAttrib(n,"style"))),r.nodeChanged()},T=t=>{M();let f=v.getPos(t,w),x=f.x,k=f.y,N=t.getBoundingClientRect(),T=N.width||N.right-N.left,B=N.height||N.bottom-N.top;n!==t&&(D(),n=t,g=p=0);let P=r.dispatch("ObjectSelected",{target:t});_(t)&&!P.isDefaultPrevented()?eA(cB,(t,r)=>{let f=v.get("mceResizeHandle"+r);f&&v.remove(f),f=v.add(w,"div",{id:"mceResizeHandle"+r,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+r+"-resize; margin:0; padding:0"}),v.bind(f,"mousedown",f=>{f.stopImmediatePropagation(),f.preventDefault(),(f=>{var g;let p=S(n)[0];s=f.screenX,d=f.screenY,c=p.clientWidth,m=(u=p.clientHeight)/c,(l=t).name=r,l.startPos={x:T*t[0]+x,y:B*t[1]+k},h=w.scrollWidth,b=w.scrollHeight,i=v.add(w,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"}),v.setStyles(i,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),o=E(g=n)?v.create("img",{src:tB.transparentSrc}):g.cloneNode(!0),v.addClass(o,"mce-clonedresizable"),v.setAttrib(o,"data-mce-bogus","all"),o.contentEditable="false",v.setStyles(o,{left:x,top:k,margin:0}),R(o,T,B),o.removeAttribute(cA),w.appendChild(o),v.bind(y,"mousemove",A),v.bind(y,"mouseup",O),C!==y&&(v.bind(C,"mousemove",A),v.bind(C,"mouseup",O)),a=v.add(w,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},c+" &times; "+u)})(f)}),t.elm=f,v.setStyles(f,{left:T*t[0]+x-f.offsetWidth/2,top:B*t[1]+k-f.offsetHeight/2})}):D(!1)},B=a$(T,0),D=(t=!0)=>{B.cancel(),M(),n&&t&&n.removeAttribute(cA),eA(cB,(t,r)=>{let n=v.get("mceResizeHandle"+r);n&&(v.unbind(n),v.remove(n))})},P=(t,r)=>v.isChildOf(t,r),F=n=>{if(f||r.removed||r.composing)return;let o=rW(ri("mousedown"===n.type?n.target:t.getNode()),"table,img,figure.image,hr,video,span.mce-preview-object,details").map(t=>t.dom).filter(t=>v.isEditable(t.parentElement)).getOrUndefined(),a=L(o)?v.getAttrib(o,cA,"1"):"1";if(el(v.select(`img[${cA}],hr[${cA}]`),t=>{t.removeAttribute(cA)}),L(o)&&P(o,w)&&r.hasFocus()&&(I(),P(t.getStart(!0),o)&&P(t.getEnd(!0),o)))return v.setAttrib(o,cA,a),void B.throttle(o);D()},M=()=>{eA(cB,t=>{t.elm&&(v.unbind(t.elm),delete t.elm)})},I=()=>{try{r.getDoc().execCommand("enableObjectResizing",!1,"false")}catch(t){}};return r.on("init",()=>{I(),r.on("NodeChange ResizeEditor ResizeWindow ResizeContent drop",F),r.on("keyup compositionend",t=>{n&&"TABLE"===n.nodeName&&F(t)}),r.on("hide blur",D),r.on("contextmenu longpress",k,!0)}),r.on("remove",M),{isResizable:_,showResizeRect:T,hideResizeRect:D,updateResizeRect:F,destroy:()=>{B.cancel(),n=o=i=null}}},cP=(t,r,n)=>{let o=t.document.createRange();return r.fold(t=>{o.setStartBefore(t.dom)},(t,r)=>{o.setStart(t.dom,r)},t=>{o.setStartAfter(t.dom)}),((t,r)=>{r.fold(r=>{t.setEndBefore(r.dom)},(r,n)=>{t.setEnd(r.dom,n)},r=>{t.setEndAfter(r.dom)})})(o,n),o},cL=(t,r,n,o,a)=>{let l=t.document.createRange();return l.setStart(r.dom,n),l.setEnd(o.dom,a),l},cF=lH([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),cM=(t,r,n)=>r(ri(n.startContainer),n.startOffset,ri(n.endContainer),n.endOffset);cF.ltr,cF.rtl;let cI=(t,r,n,o)=>({start:t,soffset:r,finish:n,foffset:o}),cU=document.caretPositionFromPoint?(t,r,n)=>{var o,a;return J.from(null===(a=(o=t.dom).caretPositionFromPoint)||void 0===a?void 0:a.call(o,r,n)).bind(r=>{if(null===r.offsetNode)return J.none();let n=t.dom.createRange();return n.setStart(r.offsetNode,r.offset),n.collapse(),J.some(n)})}:document.caretRangeFromPoint?(t,r,n)=>{var o,a;return J.from(null===(a=(o=t.dom).caretRangeFromPoint)||void 0===a?void 0:a.call(o,r,n))}:J.none,cz=lH([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),cj={before:cz.before,on:cz.on,after:cz.after,cata:(t,r,n,o)=>t.fold(r,n,o),getStart:t=>t.fold($,$,$)},cH=lH([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),c$={domRange:cH.domRange,relative:cH.relative,exact:cH.exact,exactFromRange:t=>cH.exact(t.start,t.soffset,t.finish,t.foffset),getWin:t=>ry(t.match({domRange:t=>ri(t.startContainer),relative:(t,r)=>cj.getStart(t),exact:(t,r,n,o)=>t})),range:cI},cq=(t,r)=>{let n=tV(t);return"input"===n?cj.after(t):en(["br","img"],n)?0===r?cj.before(t):cj.after(t):cj.on(t,r)},cV=(t,r)=>{let n=t.fold(cj.before,cq,cj.after),o=r.fold(cj.before,cq,cj.after);return c$.relative(n,o)},cW=(t,r,n,o)=>{let a=cq(t,r),l=cq(n,o);return c$.relative(a,l)},cK=(t,r)=>{let n=(r||document).createDocumentFragment();return el(t,t=>{n.appendChild(t.dom)}),ri(n)},cG=t=>{let r=c$.getWin(t).dom,n=(t,n,o,a)=>cL(r,t,n,o,a);return((t,r)=>{let n=r.ltr();return n.collapsed?r.rtl().filter(t=>!1===t.collapsed).map(t=>cF.rtl(ri(t.endContainer),t.endOffset,ri(t.startContainer),t.startOffset)).getOrThunk(()=>cM(0,cF.ltr,n)):cM(0,cF.ltr,n)})(0,t.match({domRange:t=>{let r=ri(t.startContainer),n=ri(t.endContainer);return cW(r,t.startOffset,n,t.endOffset)},relative:cV,exact:cW}).match({domRange:t=>({ltr:H(t),rtl:J.none}),relative:(t,n)=>({ltr:eY(()=>cP(r,t,n)),rtl:eY(()=>J.some(cP(r,n,t)))}),exact:(t,n,o,a)=>({ltr:eY(()=>cL(r,t,n,o,a)),rtl:eY(()=>J.some(cL(r,o,a,t,n)))})})).match({ltr:n,rtl:n})},cY=(t,r,n)=>{var o;return(o=ry(ri(n)).dom,cU(ri(o.document),t,r).map(t=>cI(ri(t.startContainer),t.startOffset,ri(t.endContainer),t.endOffset))).map(t=>{let r=n.createRange();return r.setStart(t.start.dom,t.soffset),r.setEnd(t.finish.dom,t.foffset),r}).getOrUndefined()},cX=(t,r)=>L(t)&&L(r)&&t.startContainer===r.startContainer&&t.startOffset===r.startOffset&&t.endContainer===r.endContainer&&t.endOffset===r.endOffset,cQ=(t,r,n)=>null!==((t,r,n)=>{let o=t;for(;o&&o!==r;){if(n(o))return o;o=o.parentNode}return null})(t,r,n),cJ=(t,r,n)=>cQ(t,r,t=>t.nodeName===n),cZ=(t,r)=>ol(t)&&!cQ(t,r,du),c0=(t,r,n)=>{let o=r.parentNode;if(o){let a;let l=new ny(r,t.getParent(o,t.isBlock)||t.getRoot());for(;a=l[n?"prev":"next"]();)if(nM(a))return!0}return!1},c1=(t,r,n,o,a)=>{let l,i;let s=t.getRoot(),d=t.schema.getNonEmptyElements(),c=a.parentNode;if(!c)return J.none();let u=t.getParent(c,t.isBlock)||s;if(o&&nM(a)&&r&&t.isEmpty(u))return J.some(lx(c,t.nodeIndex(a)));let m=new ny(a,u);for(;i=m[o?"prev":"next"]();){if("false"===t.getContentEditableParent(i)||cZ(i,s))return J.none();if(nT(i)&&i.data.length>0)return cJ(i,s,"A")?J.none():J.some(lx(i,o?i.data.length:0));if(t.isBlock(i)||d[i.nodeName.toLowerCase()])return J.none();l=i}return nP(l)?J.none():n&&l?J.some(lx(l,0)):J.none()},c2=(t,r,n,o)=>{var a;let l=t.getRoot(),i,s=!1,d=n?o.startContainer:o.endContainer,c=n?o.startOffset:o.endOffset,u=nx(d)&&c===d.childNodes.length,m=t.schema.getNonEmptyElements(),f=n;if(ol(d))return J.none();if(nx(d)&&c>d.childNodes.length-1&&(f=!1),nL(d)&&(d=l,c=0),d===l){if(f&&(i=d.childNodes[c>0?c-1:0])&&(ol(i)||m[i.nodeName]||nR(i)))return J.none();if(d.hasChildNodes()){if(c=Math.min(!f&&c>0?c-1:c,d.childNodes.length-1),c=nT(d=d.childNodes[c])&&u?d.data.length:0,!r&&d===l.lastChild&&nR(d)||((t,r)=>{let n=r;for(;n&&n!==t;){if(nz(n))return!0;n=n.parentNode}return!1})(l,d)||ol(d))return J.none();if(d.hasChildNodes()&&!nR(d)){i=d;let r=new ny(d,l);do{if(nz(i)||ol(i)){s=!1;break}if(nT(i)&&i.data.length>0){c=f?0:i.data.length,d=i,s=!0;break}if(m[i.nodeName.toLowerCase()]&&!nH(i)){c=t.nodeIndex(i),d=i.parentNode,f||c++,s=!0;break}}while(i=f?r.next():r.prev())}}}return r&&(nT(d)&&0===c&&c1(t,u,r,!0,d).each(t=>{d=t.container(),c=t.offset(),s=!0}),nx(d)&&((i=d.childNodes[c])||(i=d.childNodes[c-1]),!i||!nM(i)||"A"===(null===(a=i.previousSibling)||void 0===a?void 0:a.nodeName)||c0(t,i,!1)||c0(t,i,!0)||c1(t,u,r,!0,i).each(t=>{d=t.container(),c=t.offset(),s=!0}))),f&&!r&&nT(d)&&c===d.data.length&&c1(t,u,r,!1,d).each(t=>{d=t.container(),c=t.offset(),s=!0}),s&&d?J.some(lx(d,c)):J.none()},c3=(t,r)=>{let n=r.collapsed,o=r.cloneRange(),a=lx.fromRangeStart(r);return c2(t,n,!0,o).each(t=>{n&&lx.isAbove(a,t)||o.setStart(t.container(),t.offset())}),n||c2(t,n,!1,o).each(t=>{o.setEnd(t.container(),t.offset())}),n&&o.collapse(!0),cX(r,o)?J.none():J.some(o)},c8=(t,r)=>t.splitText(r),c5=t=>{let r=t.startContainer,n=t.startOffset,o=t.endContainer,a=t.endOffset;if(r===o&&nT(r)){if(n>0&&n<r.data.length){if(r=(o=c8(r,n)).previousSibling,a>n){let t=c8(o,a-=n).previousSibling;r=o=t,a=t.data.length,n=0}else a=0}}else if(nT(r)&&n>0&&n<r.data.length&&(r=c8(r,n),n=0),nT(o)&&a>0&&a<o.data.length){let t=c8(o,a).previousSibling;o=t,a=t.data.length}return{startContainer:r,startOffset:n,endContainer:o,endOffset:a}},c6=t=>({walk:(r,n)=>cg(t,r,n),split:c5,expand:(r,n={type:"word"})=>{if("word"===n.type){let n=cf(t,r,[{inline:"span"}]),o=t.createRng();return o.setStart(n.startContainer,n.startOffset),o.setEnd(n.endContainer,n.endOffset),o}return r},normalize:r=>c3(t,r).fold(X,t=>(r.setStart(t.startContainer,t.startOffset),r.setEnd(t.endContainer,t.endOffset),!0))});c6.compareRanges=cX,c6.getCaretRangeFromPoint=cY,c6.getSelectedNode=ll,c6.getNode=li;let c9=((t,r)=>{let n=r=>{let n=(t=>{let r=t.dom;return rz(t)?r.getBoundingClientRect().height:r.offsetHeight})(r);return n<=0||null===n?parseFloat(rZ(r,t))||0:n},o=(t,r)=>eu(r,(r,n)=>{let o=rZ(t,n),a=void 0===o?0:parseInt(o,10);return isNaN(a)?r:r+a},0);return{set:(r,n)=>{if(!M(n)&&!n.match(/^[0-9]+$/))throw Error(t+".set accepts only positive integer values. Value was "+n);let o=r.dom;rY(o)&&(o.style[t]=n+"px")},get:n,getOuter:n,aggregate:o,max:(t,r,n)=>{let a=o(t,n);return r>a?r-a:0}}})("height"),c4=()=>ri(document),c7=(t,r)=>t.view(r).fold(H([]),r=>{let n=t.owner(r);return[r].concat(c7(t,n))});var ue=Object.freeze({__proto__:null,view:t=>{var r;return(t.dom===document?J.none():J.from(null===(r=t.dom.defaultView)||void 0===r?void 0:r.frameElement)).map(ri)},owner:t=>rv(t)});let ut=t=>"textarea"===tV(t),ur=(t,r)=>{let n=(t=>{let r=t.dom.ownerDocument,n=r.body,o=r.defaultView,a=r.documentElement;if(n===t.dom)return ns(n.offsetLeft,n.offsetTop);let l=nd(null==o?void 0:o.pageYOffset,a.scrollTop),i=nd(null==o?void 0:o.pageXOffset,a.scrollLeft),s=nd(a.clientTop,n.clientTop),d=nd(a.clientLeft,n.clientLeft);return nc(t).translate(i-d,l-s)})(t),o=c9.get(t);return{element:t,bottom:n.top+o,height:o,pos:n,cleanup:r}},un=(t,r,n,o)=>{ui(t,(a,l)=>ua(t,r,n,o),n)},uo=(t,r,n,o,a)=>{let l={elm:o.element.dom,alignToTop:a};t.dispatch("ScrollIntoView",l).isDefaultPrevented()||(n(t,r,nu(r).top,o,a),((t,r)=>{t.dispatch("AfterScrollIntoView",r)})(t,l))},ua=(t,r,n,o)=>{let a=ri(t.getBody()),l=ri(t.getDoc());a.dom.offsetWidth;let i=((t,r)=>{let n=((t,r)=>{let n=rN(t);if(0===n.length||ut(t))return{element:t,offset:r};if(r<n.length&&!ut(n[r]))return{element:n[r],offset:0};{let o=n[n.length-1];return ut(o)?{element:t,offset:r}:"img"===tV(o)?{element:o,offset:1}:tX(o)?{element:o,offset:nY(o).length}:{element:o,offset:rN(o).length}}})(t,r),o=rs('<span data-mce-bogus="all" style="display: inline-block;">\uFEFF</span>');return r8(n.element,o),ur(o,()=>nt(o))})(ri(n.startContainer),n.startOffset);uo(t,l,r,i,o),i.cleanup()},ul=(t,r,n,o)=>{let a=ri(t.getDoc());uo(t,a,n,ur(ri(r),U),o)},ui=(t,r,n)=>{let o=n.startContainer,a=n.startOffset,l=n.endContainer,i=n.endOffset;r(ri(o),ri(l));let s=t.dom.createRng();s.setStart(o,a),s.setEnd(l,i),t.selection.setRng(n)},us=(t,r,n,o,a)=>{let l=r.pos;if(o)nm(l.left,l.top,a);else{let o=l.top-n+r.height;nm(-t.getBody().getBoundingClientRect().left,o,a)}},ud=(t,r,n,o,a,l)=>{let i=o+n,s=a.pos.top,d=a.bottom,c=d-s>=o;s<n?us(t,a,o,!1!==l,r):s>i?us(t,a,o,c?!1!==l:!0===l,r):d>i&&!c&&us(t,a,o,!0===l,r)},uc=(t,r,n,o,a)=>{let l=ry(r).dom.innerHeight;ud(t,r,n,l,o,a)},uu=(t,r,n,o,a)=>{let l=ry(r).dom.innerHeight;ud(t,r,n,l,o,a);let i=(t=>{let r=nu(c4()),n=((t,r)=>{let n=r.owner(t);return c7(r,n)})(t,ue),o=nc(t),a=ec(n,(t,r)=>{let n=nc(r);return{left:t.left+n.left,top:t.top+n.top}},{left:0,top:0});return ns(a.left+o.left+r.left,a.top+o.top+r.top)})(o.element),s=np(window);i.top<s.y?nf(o.element,!1!==a):i.top>s.bottom&&nf(o.element,!0===a)},um=(t,r,n)=>un(t,uc,r,n),uf=(t,r,n)=>ul(t,r,uc,n),ug=(t,r,n)=>un(t,uu,r,n),up=(t,r,n)=>ul(t,r,uu,n),uh=(t,r,n)=>{(t.inline?um:ug)(t,r,n)},ub=t=>t.dom.focus(),uv=t=>{let r=rL(t).dom;return t.dom===r.activeElement},uy=(t=c4())=>J.from(t.dom.activeElement).map(ri),uC=(t,r)=>{let n=tX(r)?nY(r).length:rN(r).length+1;return t>n?n:t<0?0:t},uw=t=>c$.range(t.start,uC(t.soffset,t.start),t.finish,uC(t.foffset,t.finish)),ux=(t,r)=>!nw(r.dom)&&(rh(t,r)||rp(t,r)),uE=t=>r=>ux(t,r.start)&&ux(t,r.finish),uk=t=>c$.range(ri(t.startContainer),t.startOffset,ri(t.endContainer),t.endOffset),uS=t=>{let r=document.createRange();try{return r.setStart(t.start.dom,t.soffset),r.setEnd(t.finish.dom,t.foffset),J.some(r)}catch(t){return J.none()}},u_=t=>{var r;let n=t.inline||tB.browser.isFirefox()?(t=>{let r=t.getSelection();return(r&&0!==r.rangeCount?J.from(r.getRangeAt(0)):J.none()).map(uk)})(ry(r=ri(t.getBody())).dom).filter(uE(r)):J.none();t.bookmark=n.isSome()?n:t.bookmark},uN=t=>(t.bookmark?t.bookmark:J.none()).bind(r=>{var n;return n=ri(t.getBody()),J.from(r).filter(uE(n)).map(uw)}).bind(uS),uR={isEditorUIElement:t=>{let r=t.className.toString();return -1!==r.indexOf("tox-")||-1!==r.indexOf("mce-")}},uA={setEditorTimeout:(t,r,n)=>{let o,a;return o=()=>{t.removed||r()},M(a=n)||(a=0),setTimeout(o,a)},setEditorInterval:(t,r,n)=>{let o,a;let l=(o=()=>{t.removed?clearInterval(l):r()},M(a=n)||(a=0),setInterval(o,a));return l}},uO=aB.DOM,uT=t=>{let r=t.classList;return void 0!==r&&(r.contains("tox-edit-area")||r.contains("tox-edit-area__iframe")||r.contains("mce-content-body"))},uB=(t,r)=>{let n=iH(t);return null!==uO.getParent(r,r=>nx(r)&&uR.isEditorUIElement(r)||!!n&&t.dom.is(r,n))},uD=t=>{try{let r=rL(ri(t.getElement()));return uy(r).fold(()=>document.body,t=>t.dom)}catch(t){return document.body}},uP=(r,n)=>{let o=n.editor;(t=>{let r=a$(()=>{u_(t)},0);t.on("init",()=>{t.inline&&((t,r)=>{let n=()=>{r.throttle()};aB.DOM.bind(document,"mouseup",n),t.on("remove",()=>{aB.DOM.unbind(document,"mouseup",n)})})(t,r),((t,r)=>{t.on("mouseup touchend",t=>{r.throttle()})})(t,r),t.on("keyup NodeChange AfterSetSelectionRange",r=>{"nodechange"===r.type&&r.selectionChange||u_(t)})}),t.on("remove",()=>{r.cancel()})})(o);let a=(t,r)=>{sC(t)&&!0!==t.inline&&r(ri(t.getContainer()),"tox-edit-focus")};o.on("focusin",()=>{let t=r.focusedEditor;uT(uD(o))&&a(o,rn),t!==o&&(t&&t.dispatch("blur",{focusedEditor:o}),r.setActive(o),r.focusedEditor=o,o.dispatch("focus",{blurredEditor:t}),o.focus(!0))}),o.on("focusout",()=>{uA.setEditorTimeout(o,()=>{let t=r.focusedEditor;uT(uD(o))&&t===o||a(o,ra),uB(o,uD(o))||t!==o||(o.dispatch("blur",{focusedEditor:null}),r.focusedEditor=null)})}),t||(t=t=>{let n=r.activeEditor;n&&rI(t).each(t=>{t.ownerDocument===document&&(t===document.body||uB(n,t)||r.focusedEditor!==n||(n.dispatch("blur",{focusedEditor:null}),r.focusedEditor=null))})},uO.bind(document,"focusin",t))},uL=(r,n)=>{r.focusedEditor===n.editor&&(r.focusedEditor=null),!r.activeEditor&&t&&(uO.unbind(document,"focusin",t),t=null)},uF=(t,r)=>{var n;(n=ri(t.getBody()),(r.collapsed?J.from(li(r.startContainer,r.startOffset)).map(ri):J.none()).bind(t=>n5(t)?J.some(t):rh(n,t)?J.none():J.some(n))).bind(t=>ds(t.dom)).fold(()=>{t.selection.normalize()},r=>t.selection.setRng(r.toRange()))},uM=t=>{if(t.setActive)try{t.setActive()}catch(r){t.focus()}else t.focus()},uI=t=>t.inline?(t=>{var r;let n=t.getBody();return n&&(uv(r=ri(n))||uy(rL(r)).filter(t=>r.dom.contains(t.dom)).isSome())})(t):L(t.iframeElement)&&uv(ri(t.iframeElement)),uU=t=>t.editorManager.setActive(t),uz=(t,r,n,o,a)=>{let l=n?r.startContainer:r.endContainer,i=n?r.startOffset:r.endOffset;return J.from(l).map(ri).map(t=>o&&r.collapsed?t:rR(t,a(t,i)).getOr(t)).bind(t=>tY(t)?J.some(t):rC(t).filter(tY)).map(t=>t.dom).getOr(t)},uj=(t,r,n=!1)=>uz(t,r,!0,n,(t,r)=>Math.min(rT(t),r)),uH=(t,r,n=!1)=>uz(t,r,!1,n,(t,r)=>r>0?r-1:r),u$=(t,r)=>{let n=t;for(;t&&nT(t)&&0===t.length;)t=r?t.nextSibling:t.previousSibling;return t||n},uq=(t,r)=>ea(r,r=>{let n=t.dispatch("GetSelectionRange",{range:r});return n.range!==r?n.range:r}),uV=["img","br"],uW=t=>nX(t).filter(t=>0!==t.trim().length||t.indexOf("\xa0")>-1).isSome()||en(uV,tV(t))||tG(t)&&"false"===t3(t,"contenteditable"),uK="[data-mce-autocompleter]",uG=(t,r)=>{if(uY(ri(t.getBody())).isNone()){let n=rs('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc());r9(n,ri(r.extractContents())),r.insertNode(n.dom),rC(n).each(t=>t.dom.normalize()),((t,r)=>{let n=t=>{let o=rN(t);for(let t=o.length-1;t>=0;t--){let a=o[t];if(r(a))return J.some(a);let l=n(a);if(l.isSome())return l}return J.none()};return n(t)})(n,uW).map(r=>{t.selection.setCursorLocation(r.dom,"img"===tV(r)?1:nX(r).fold(()=>rN(r).length,t=>t.length))})}},uY=t=>rV(t,uK),uX={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},uQ=(t,r,n)=>{let o=n?"lastChild":"firstChild",a=n?"prev":"next";if(t[o])return t[o];if(t!==r){let n=t[a];if(n)return n;for(let o=t.parent;o&&o!==r;o=o.parent)if(n=o[a])return n}},uJ=t=>{var r;let n=null!==(r=t.value)&&void 0!==r?r:"";if(!ow(n))return!1;let o=t.parent;return!o||"span"===o.name&&!o.attr("style")||!/^[ ]+$/.test(n)},uZ=t=>{let r="a"===t.name&&!t.attr("href")&&t.attr("id");return t.attr("name")||t.attr("id")&&!t.firstChild||t.attr("data-mce-bookmark")||r};class u0{static create(t,r){let n=new u0(t,uX[t]||1);return r&&eA(r,(t,r)=>{n.attr(r,t)}),n}constructor(t,r){this.name=t,this.type=r,1===r&&(this.attributes=[],this.attributes.map={})}replace(t){return t.parent&&t.remove(),this.insert(t,this),this.remove(),this}attr(t,r){let n=this;if(!N(t))return L(t)&&eA(t,(t,r)=>{n.attr(r,t)}),n;let o=n.attributes;if(o){if(void 0!==r){if(null===r){if(t in o.map){delete o.map[t];let r=o.length;for(;r--;)if(o[r].name===t)return o.splice(r,1),n}return n}if(t in o.map){let n=o.length;for(;n--;)if(o[n].name===t){o[n].value=r;break}}else o.push({name:t,value:r});return o.map[t]=r,n}return o.map[t]}}clone(){let t=new u0(this.name,this.type),r=this.attributes;if(r){let n=[];n.map={};for(let t=0,o=r.length;t<o;t++){let o=r[t];"id"!==o.name&&(n[n.length]={name:o.name,value:o.value},n.map[o.name]=o.value)}t.attributes=n}return t.value=this.value,t}wrap(t){return this.parent&&(this.parent.insert(t,this),t.append(this)),this}unwrap(){for(let t=this.firstChild;t;){let r=t.next;this.insert(t,this,!0),t=r}this.remove()}remove(){let t=this.parent,r=this.next,n=this.prev;return t&&(t.firstChild===this?(t.firstChild=r,r&&(r.prev=null)):n&&(n.next=r),t.lastChild===this?(t.lastChild=n,n&&(n.next=null)):r&&(r.prev=n),this.parent=this.next=this.prev=null),this}append(t){t.parent&&t.remove();let r=this.lastChild;return r?(r.next=t,t.prev=r,this.lastChild=t):this.lastChild=this.firstChild=t,t.parent=this,t}insert(t,r,n){t.parent&&t.remove();let o=r.parent||this;return n?(r===o.firstChild?o.firstChild=t:r.prev&&(r.prev.next=t),t.prev=r.prev,t.next=r,r.prev=t):(r===o.lastChild?o.lastChild=t:r.next&&(r.next.prev=t),t.next=r.next,t.prev=r,r.next=t),t.parent=o,t}getAll(t){let r=[];for(let n=this.firstChild;n;n=uQ(n,this))n.name===t&&r.push(n);return r}children(){let t=[];for(let r=this.firstChild;r;r=r.next)t.push(r);return t}empty(){if(this.firstChild){let t=[];for(let r=this.firstChild;r;r=uQ(r,this))t.push(r);let r=t.length;for(;r--;){let n=t[r];n.parent=n.firstChild=n.lastChild=n.next=n.prev=null}}return this.firstChild=this.lastChild=null,this}isEmpty(t,r={},n){var o;let a=this.firstChild;if(uZ(this))return!1;if(a)do{if(1===a.type){if(a.attr("data-mce-bogus"))continue;if(t[a.name]||uZ(a))return!1}if(8===a.type||3===a.type&&!uJ(a)||3===a.type&&a.parent&&r[a.parent.name]&&ow(null!==(o=a.value)&&void 0!==o?o:"")||n&&n(a))return!1}while(a=uQ(a,this));return!0}walk(t){return uQ(this,null,t)}}let u1=t=>(0===t.length?"":`${ea(t,t=>`[${t}]`).join(",")},`)+'[data-mce-bogus="all"]',u2=t=>document.createTreeWalker(t,NodeFilter.SHOW_COMMENT,null),u3=(t,r)=>null!==t.querySelector(u1(r)),u8=(t,r)=>{el(t.querySelectorAll(u1(r)),t=>{let n=ri(t);"all"===t3(n,"data-mce-bogus")?nt(n):el(r,t=>{t5(n,t)&&t6(n,t)})})},u5=t=>t.cloneNode(!0),u6=(t,r)=>{let n=t;return null!==u2(t).nextNode()?((t=>{let r=u2(t),n=r.nextNode();for(;null!==n;){let t=r.currentNode;n=r.nextNode(),N(t.nodeValue)&&t.nodeValue.includes("\uFEFF")&&nt(ri(t))}})(n=u5(t)),u3(n,r)&&u8(n,r)):u3(t,r)&&u8(n=u5(t),r),n},u9=t=>{el(nb(t,"[data-mce-bogus]"),t=>{"all"===t3(t,"data-mce-bogus")?nt(t):n1(t)?(r8(t,rc("\uFEFF")),nt(t)):nr(t)})},u4=t=>{el(nb(t,"input"),t=>{t6(t,"name")})},u7=(t,r,n)=>{let o;return o="raw"===r.format?tF.trim(on(u6(n,t.serializer.getTempAttrs()).innerHTML)):"text"===r.format?((t,r)=>{let n=t.getDoc(),o=rL(ri(t.getBody())),a=rd("div",n);t1(a,"data-mce-bogus","all"),rJ(a,{position:"fixed",left:"-9999999px",top:"0"}),na(a,r.innerHTML),u9(a),u4(a),r9(rB(o)?o:ri(rv(o).dom.body),a);let l=on(a.dom.innerText);return nt(a),l})(t,n):"tree"===r.format?t.serializer.serialize(n,r):((t,r)=>{let n=l7(t),o=RegExp(`^(<${n}[^>]*>(&nbsp;|&#160;|\\s|\xa0|<br \\/>|)<\\/${n}>[\r
]*|<br \\/>[\r
]*)$`);return r.replace(o,"")})(t,t.serializer.serialize(n,r)),"text"!==r.format&&!n9(ri(n))&&N(o)?tF.trim(o):o},me=tF.makeMap,mt=t=>{let r=[],n=(t=t||{}).indent,o=me(t.indent_before||""),a=me(t.indent_after||""),l=at.getEncodeFunc(t.entity_encoding||"raw",t.entities),i="xhtml"!==t.element_format;return{start:(t,s,d)=>{if(n&&o[t]&&r.length>0){let t=r[r.length-1];t.length>0&&"\n"!==t&&r.push("\n")}if(r.push("<",t),s)for(let t=0,n=s.length;t<n;t++){let n=s[t];r.push(" ",n.name,'="',l(n.value,!0),'"')}if(r[r.length]=!d||i?">":" />",d&&n&&a[t]&&r.length>0){let t=r[r.length-1];t.length>0&&"\n"!==t&&r.push("\n")}},end:t=>{let o;r.push("</",t,">"),n&&a[t]&&r.length>0&&(o=r[r.length-1]).length>0&&"\n"!==o&&r.push("\n")},text:(t,n)=>{t.length>0&&(r[r.length]=n?t:l(t))},cdata:t=>{r.push("<![CDATA[",t,"]]>")},comment:t=>{r.push("<!--",t,"-->")},pi:(t,o)=>{o?r.push("<?",t," ",l(o),"?>"):r.push("<?",t,"?>"),n&&r.push("\n")},doctype:t=>{r.push("<!DOCTYPE",t,">",n?"\n":"")},reset:()=>{r.length=0},getContent:()=>r.join("").replace(/\n$/,"")}},mr=(t={},r=am())=>{let n=mt(t);return t.validate=!("validate"in t)||t.validate,{serialize:o=>{let a=t.validate,l={3:t=>{var r;n.text(null!==(r=t.value)&&void 0!==r?r:"",t.raw)},8:t=>{var r;n.comment(null!==(r=t.value)&&void 0!==r?r:"")},7:t=>{n.pi(t.name,t.value)},10:t=>{var r;n.doctype(null!==(r=t.value)&&void 0!==r?r:"")},4:t=>{var r;n.cdata(null!==(r=t.value)&&void 0!==r?r:"")},11:t=>{let r=t;if(r=r.firstChild)do i(r);while(r=r.next)}};n.reset();let i=t=>{var o;let s=l[t.type];if(s)s(t);else{let l=t.name,s=l in r.getVoidElements(),d=t.attributes;if(a&&d&&d.length>1){let n=[];n.map={};let o=r.getElementRule(t.name);if(o){for(let t=0,r=o.attributesOrder.length;t<r;t++){let r=o.attributesOrder[t];if(r in d.map){let t=d.map[r];n.map[r]=t,n.push({name:r,value:t})}}for(let t=0,r=d.length;t<r;t++){let r=d[t].name;if(!(r in n.map)){let t=d.map[r];n.map[r]=t,n.push({name:r,value:t})}}d=n}}if(n.start(l,d,s),!s){let r=t.firstChild;if(r){"pre"!==l&&"textarea"!==l||3!==r.type||"\n"!==(null===(o=r.value)||void 0===o?void 0:o[0])||n.text("\n",!0);do i(r);while(r=r.next)}n.end(l)}}};return 1!==o.type||t.inner?3===o.type?l[3](o):l[11](o):i(o),n.getContent()}}},mn=new Set;el(["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"],t=>{mn.add(t)});let mo=["font","text-decoration","text-emphasis"],ma=(t,r)=>eN(t.parseStyle(t.getAttrib(r,"style"))),ml=(t,r,n)=>{let o=ma(t,r),a=ma(t,n),l=o=>{var a,l;let i=null!==(a=t.getStyle(r,o))&&void 0!==a?a:"",s=null!==(l=t.getStyle(n,o))&&void 0!==l?l:"";return e7(i)&&e7(s)&&i!==s};return eo(o,t=>{let r=r=>eo(r,r=>r===t);if(!r(a)&&r(mo)){let t=ed(a,t=>eo(mo,r=>e3(t,r)));return eo(t,l)}return l(t)})},mi=(t,r,n)=>J.from(n.container()).filter(nT).exists(o=>r(o.data.charAt(n.offset()+(t?0:-1)))),ms=V(mi,!0,d_),md=V(mi,!1,d_),mc=t=>{let r=t.container();return nT(r)&&(0===r.data.length||nK(r.data)&&cC.isBookmarkNode(r.parentNode))},mu=(t,r)=>n=>sV(t?0:-1,n).filter(r).isSome(),mm=t=>nI(t)&&"block"===rZ(ri(t),"display"),mf=t=>nz(t)&&!(nx(t)&&"all"===t.getAttribute("data-mce-bogus")),mg=mu(!0,mm),mp=mu(!1,mm),mh=mu(!0,n$),mb=mu(!1,n$),mv=mu(!0,nR),my=mu(!1,nR),mC=mu(!0,mf),mw=mu(!1,mf),mx=(t,r)=>rh(r,t)?rx(t,t=>X(t)||rp(t,r)).slice(0,-1):[],mE=(t,r)=>[t].concat(mx(t,r)),mk=(t,r,n)=>dn(t,r,n,mc),mS=(t,r)=>ef(mE(ri(r.container()),t),nZ),m_=(t,r,n)=>mk(t,r.dom,n).forall(t=>mS(r,n).fold(()=>!sq(t,n,r.dom),o=>!sq(t,n,r.dom)&&rh(o,ri(t.container())))),mN=(t,r,n)=>mS(r,n).fold(()=>mk(t,r.dom,n).forall(t=>!sq(t,n,r.dom)),r=>mk(t,r.dom,n).isNone()),mR=V(mN,!1),mA=V(mN,!0),mO=V(m_,!1),mT=V(m_,!0),mB=t=>s0(t).exists(n1),mD=(t,r,n)=>dt(t,eE(ed(mE(ri(n.container()),r),nZ)).getOr(r).dom,n).filter(mB),mP=(t,r)=>s0(r).exists(n1)||mD(!0,t,r).isSome(),mL=(t,r)=>J.from(r.getNode(!0)).map(ri).exists(n1)||mD(!1,t,r).isSome(),mF=V(mD,!1),mM=V(mD,!0),mI=t=>lx.isTextPosition(t)&&!t.isAtStart()&&!t.isAtEnd(),mU=(t,r)=>eE(ed(mE(ri(r.container()),t),nZ)).getOr(t),mz=(t,r)=>mI(r)?md(r):md(r)||di(mU(t,r).dom,r).exists(md),mj=(t,r)=>mI(r)?ms(r):ms(r)||dl(mU(t,r).dom,r).exists(ms),mH=t=>s0(t).bind(t=>r$(t,tY)).exists(t=>en(["pre","pre-wrap"],rZ(t,"white-space"))),m$=(t,r)=>n=>{var o;return L(o=new ny(n,t)[r]())&&nz(o)&&sI(o)},mq=(t,r)=>!mH(r)&&(di(t.dom,r).isNone()||dl(t.dom,r).isNone()||mR(t,r)||mA(t,r)||mL(t,r)||mP(t,r)||mz(t,r)||mj(t,r)),mV=(t,r)=>!mH(r)&&(mR(t,r)||mO(t,r)||mL(t,r)||mz(t,r)||((t,r)=>{let n=di(t.dom,r).getOr(r),o=m$(t.dom,"prev");return r.isAtStart()&&(o(r.container())||o(n.container()))})(t,r)),mW=(t,r)=>!mH(r)&&(mA(t,r)||mT(t,r)||mP(t,r)||mj(t,r)||((t,r)=>{let n=dl(t.dom,r).getOr(r),o=m$(t.dom,"next");return r.isAtEnd()&&(o(r.container())||o(n.container()))})(t,r)),mK=(t,r)=>mV(t,r)||mW(t,(t=>{let r=t.container(),n=t.offset();return nT(r)&&n<r.data.length?lx(r,n+1):t})(r)),mG=(t,r)=>dS(t.charAt(r)),mY=(t,r)=>d_(t.charAt(r)),mX=(t,r,n)=>{let o=r.data,a=lx(r,0);return n||!mG(o,0)||mK(t,a)?!!(n&&mY(o,0)&&mV(t,a))&&(r.data="\xa0"+o.slice(1),!0):(r.data=" "+o.slice(1),!0)},mQ=(t,r,n)=>{let o=r.data,a=lx(r,o.length-1);return n||!mG(o,o.length-1)||mK(t,a)?!!(n&&mY(o,o.length-1)&&mW(t,a))&&(r.data=o.slice(0,-1)+"\xa0",!0):(r.data=o.slice(0,-1)+" ",!0)},mJ=(t,r)=>{let n=r.container();return nT(n)?(t=>{let r=t.container();return nT(r)&&e2(r.data,"\xa0")})(r)?tz(mX(t,n,!1)||(t=>{let r=t.data,n=(t=>{let r=t.split("");return ea(r,(t,n)=>dS(t)&&n>0&&n<r.length-1&&dN(r[n-1])&&dN(r[n+1])?" ":t).join("")})(r);return n!==r&&(t.data=n,!0)})(n)||mQ(t,n,!1),r):mK(t,r)?tz(mX(t,n,!0)||mQ(t,n,!0),r):J.none():J.none()},mZ=(t,r,n)=>{if(0===n)return;let o=ri(t),a=rH(o,nZ).getOr(o),l=t.data.slice(r,r+n),i=r+n>=t.data.length&&mW(a,lx(t,t.data.length)),s=0===r&&mV(a,lx(t,0));t.replaceData(r,n,ok(l,4,s,i))},m0=(t,r)=>{let n=t.data.slice(r);mZ(t,r,n.length-e9(n).length)},m1=(t,r)=>{let n=t.data.slice(0,r),o=n.length-e4(n).length;mZ(t,r-o,o)},m2=(t,r,n,o=!0)=>{let a=e4(t.data).length,l=o?t:r,i=o?r:t;return o?l.appendData(i.data):l.insertData(0,i.data),nt(ri(i)),n&&m0(l,a),l},m3=(t,r)=>((t,r)=>{let n=t.container(),o=t.offset();return!lx.isTextPosition(t)&&n===r.parentNode&&o>lx.before(r).offset()})(r,t)?lx(r.container(),r.offset()-1):r,m8=t=>{var r;return ob(t.previousSibling)?J.some(nT(r=t.previousSibling)?lx(r,r.data.length):lx.after(r)):t.previousSibling?dd(t.previousSibling):J.none()},m5=t=>{var r;return ob(t.nextSibling)?J.some(nT(r=t.nextSibling)?lx(r,0):lx.before(r)):t.nextSibling?ds(t.nextSibling):J.none()},m6=(t,r,n)=>(t?m5(n).orThunk(()=>m8(n)).orThunk(()=>dl(r,lx.after(n)).orThunk(()=>di(r,lx.before(n)))):m8(n).orThunk(()=>m5(n)).orThunk(()=>J.from(n.previousSibling?n.previousSibling:n.parentNode).bind(t=>di(r,lx.before(t))).orThunk(()=>dl(r,lx.after(n))))).map(V(m3,n)),m9=(t,r,n)=>{n.fold(()=>{t.focus()},n=>{t.selection.setRng(n.toRange(),r)})},m4=(t,r)=>r&&eI(t.schema.getBlockElements(),tV(r)),m7=t=>{if(oA(t)){let r=rs('<br data-mce-bogus="1">');return ne(t),r9(t,r),J.some(lx.before(r.dom))}return J.none()},fe=(t,r,n,o=!0)=>{var a;let l=m6(r,t.getBody(),n.dom),i=rH(n,V(m4,t),(a=t.getBody(),t=>t.dom===a)),s=((t,r,n)=>{var o;let a=rE(t).filter(tX),l=rk(t).filter(tX);return nt(t),(o=(t,r,o)=>{let a=t.dom,l=r.dom,i=a.data.length;return m2(a,l,n),o.container()===l?lx(a,i):o},a.isSome()&&l.isSome()&&r.isSome()?J.some(o(a.getOrDie(),l.getOrDie(),r.getOrDie())):J.none()).orThunk(()=>(n&&(a.each(t=>m1(t.dom,t.dom.length)),l.each(t=>m0(t.dom,0))),r))})(n,l,eI(t.schema.getTextInlineElements(),tV(n)));t.dom.isEmpty(t.getBody())?(t.setContent(""),t.selection.setCursorLocation()):i.bind(m7).fold(()=>{o&&m9(t,r,s)},n=>{o&&m9(t,r,J.some(n))})},ft=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,fr=(t,r)=>rf(ri(r),iN(t))&&!oj(t.schema,r)&&t.dom.isEditable(r),fn=t=>{var r;let n;return"rtl"===aB.DOM.getStyle(t,"direction",!0)||(n=null!==(r=t.textContent)&&void 0!==r?r:"",ft.test(n))},fo=(t,r,n)=>{let o=ed(aB.DOM.getParents(n.container(),"*",r),t);return J.from(o[o.length-1])},fa=(t,r)=>{let n=r.container(),o=r.offset();return t?oa(n)?nT(n.nextSibling)?lx(n.nextSibling,0):lx.after(n):os(r)?lx(n,o+1):r:oa(n)?nT(n.previousSibling)?lx(n.previousSibling,n.previousSibling.data.length):lx.before(n):od(r)?lx(n,o-1):r},fl=V(fa,!0),fi=V(fa,!1),fs=(t,r)=>{let n=t=>t.stopImmediatePropagation();t.on("beforeinput input",n,!0),t.getDoc().execCommand(r),t.off("beforeinput input",n)},fd=t=>fs(t,"Delete"),fc=t=>n2(t)||n8(t),fu=(t,r)=>rh(t,r)?r$(r,fc,r=>tM(rC(r),t,rp)):J.none(),fm=(t,r=!0)=>{t.dom.isEmpty(t.getBody())&&t.setContent("",{no_selection:!r})},ff=(t,r,n)=>tU(ds(n),dd(n),(o,a)=>{let l=fa(!0,o),i=fa(!1,a),s=fa(!1,r);return t?dl(n,s).exists(t=>t.isEqual(i)&&r.isEqual(l)):di(n,s).exists(t=>t.isEqual(l)&&r.isEqual(i))}).getOr(!0),fg=t=>(8===tW(t)||"#comment"===tV(t)?rE(t):rO(t)).bind(fg).orThunk(()=>J.some(t)),fp=(t,r,n,o=!0)=>{var a;r.deleteContents();let l=fg(n).getOr(n),i=ri(null!==(a=t.dom.getParent(l.dom,t.dom.isBlock))&&void 0!==a?a:n.dom);i.dom===t.getBody()?fm(t,o):oA(i)&&(ot(i),o&&t.selection.setCursorLocation(i.dom,0)),rp(n,i)||el((tM(rC(i),n)?[]:rC(i).map(rN).map(t=>ed(t,t=>!rp(i,t))).getOr([])).concat(rN(n)),t=>{rp(t,i)||rh(t,i)||!oA(t)||nt(t)})},fh=t=>nb(t,"td,th"),fb=(t,r)=>({start:t,end:r}),fv=lH([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]),fy=(t,r)=>rW(ri(t),"td,th",r),fC=t=>!rp(t.start,t.end),fw=(t,r)=>dI(t.start,r).bind(n=>dI(t.end,r).bind(t=>tz(rp(n,t),n))),fx=t=>r=>fw(r,t).map(t=>({rng:r,table:t,cells:fh(t)})),fE=(t,r,n,o)=>{if(n.collapsed||!t.forall(fC))return J.none();if(r.isSameTable){let r=t.bind(fx(o));return J.some({start:r,end:r})}{let t=fy(n.startContainer,o),r=fy(n.endContainer,o),a=t.bind(t=>dI(t,o).bind(r=>ek(fh(r)).map(r=>fb(t,r)))).bind(fx(o)),l=r.bind(t=>dI(t,o).bind(r=>eE(fh(r)).map(r=>fb(r,t)))).bind(fx(o));return J.some({start:a,end:l})}},fk=(t,r)=>eg(t,t=>rp(t,r)),fS=t=>tU(fk(t.cells,t.rng.start),fk(t.cells,t.rng.end),(r,n)=>t.cells.slice(r,n+1)),f_=(t,r)=>{let{startTable:n,endTable:o}=r,a=t.cloneRange();return n.each(t=>a.setStartAfter(t.dom)),o.each(t=>a.setEndBefore(t.dom)),a},fN=(t,r)=>{let n=r=>rp(t,r),o=tU(fy(r.startContainer,n),fy(r.endContainer,n),fb),a=((t,r)=>{let n=t=>dI(ri(t),r),o=n(t.startContainer),a=n(t.endContainer),l=o.isSome(),i=a.isSome(),s=tU(o,a,rp).getOr(!1);return{startTable:o,endTable:a,isStartInTable:l,isEndInTable:i,isSameTable:s,isMultiTable:!s&&l&&i}})(r,n);return o.exists(t=>!fC(t)&&fw(t,n).exists(t=>{let r=t.dom.rows;return 1===r.length&&1===r[0].cells.length})&&dj(t.start,r))?o.map(t=>fv.singleCellTable(r,t.start)):a.isMultiTable?fE(o,a,r,n).bind(({start:t,end:n})=>{let o=t.bind(fS).getOr([]),l=n.bind(fS).getOr([]);if(o.length>0&&l.length>0){let t=f_(r,a);return J.some(fv.multiTable(o,l,t))}return J.none()}):fE(o,a,r,n).bind(({start:t,end:r})=>t.or(r)).bind(t=>{let{isSameTable:n}=a,o=fS(t).getOr([]);if(n&&t.cells.length===o.length)return J.some(fv.fullTable(t.table));if(o.length>0){if(n)return J.some(fv.partialTable(o,J.none()));{let t=f_(r,a);return J.some(fv.partialTable(o,J.some({...a,rng:t})))}}return J.none()})},fR=t=>el(t,t=>{t6(t,"contenteditable"),ot(t)}),fA=(t,r,n,o)=>{let a=n.cloneRange();o?(a.setStart(n.startContainer,n.startOffset),a.setEndAfter(r.dom.lastChild)):(a.setStartBefore(r.dom.firstChild),a.setEnd(n.endContainer,n.endOffset)),fD(t,a,r,!1).each(t=>t())},fO=t=>{let r=dM(t),n=ri(t.selection.getNode());nj(n.dom)&&oA(n)?t.selection.setCursorLocation(n.dom,0):t.selection.collapse(!0),r.length>1&&eo(r,t=>rp(t,n))&&t1(n,"data-mce-selected","1")},fT=(t,r,n)=>J.some(()=>{let o=t.selection.getRng();fR(n.bind(({rng:n,isStartInTable:a})=>{let l;let i=(l=a?n.endContainer:n.startContainer,J.from(t.dom.getParent(l,t.dom.isBlock)).map(ri));n.deleteContents(),((t,r,n)=>{n.each(n=>{r?nt(n):(ot(n),t.selection.setCursorLocation(n.dom,0))})})(t,a,i.filter(oA));let s=a?r[0]:r[r.length-1];return fA(t,s,o,a),oA(s)?J.none():J.some(a?r.slice(1):r.slice(0,-1))}).getOr(r)),fO(t)}),fB=(t,r,n,o)=>J.some(()=>{let a=t.selection.getRng(),l=r[0],i=n[n.length-1];fA(t,l,a,!0),fA(t,i,a,!1);let s=oA(l)?r:r.slice(1),d=oA(i)?n:n.slice(0,-1);fR(s.concat(d)),o.deleteContents(),fO(t)}),fD=(t,r,n,o=!0)=>J.some(()=>{fp(t,r,n,o)}),fP=(t,r)=>J.some(()=>fe(t,!1,r)),fL=(t,r)=>ef(mE(r,t),n6),fF=(t,r)=>ef(mE(r,t),tZ("caption")),fM=(t,r)=>J.some(()=>{ot(r),t.selection.setCursorLocation(r.dom,0)}),fI=(t,r)=>t?mv(r):my(r),fU=(t,r,n)=>{let o=ri(t.getBody());return fF(o,n).fold(()=>((t,r,n,o)=>{let a=lx.fromRangeStart(t.selection.getRng());return fL(n,o).bind(o=>oA(o)?fM(t,o):dr(r,t.getBody(),a).bind(t=>fL(n,ri(t.getNode())).bind(t=>rp(t,o)?J.none():J.some(U))))})(t,r,o,n).orThunk(()=>tz(((t,r)=>{let n=lx.fromRangeStart(t.selection.getRng());return fI(r,n)||dt(r,t.getBody(),n).exists(t=>fI(r,t))})(t,r),U)),n=>((t,r,n,o)=>{let a=lx.fromRangeStart(t.selection.getRng());return oA(o)?fM(t,o):dr(r,t.getBody(),a).fold(()=>J.some(U),l=>ds(o.dom).bind(t=>dd(o.dom).map(n=>r?a.isEqual(t)&&l.isEqual(n):a.isEqual(n)&&l.isEqual(t))).getOr(!0)?fM(t,o):fF(n,ri(l.getNode())).fold(()=>J.some(U),t=>tz(!rp(t,o),U)))})(t,r,o,n))},fz=(t,r)=>{let n=ri(t.selection.getStart(!0)),o=dM(t);return t.selection.isCollapsed()&&0===o.length?fU(t,r,n):((t,r,n)=>{let o=ri(t.getBody()),a=t.selection.getRng();return 0!==n.length?fT(t,n,J.none()):fF(o,r).fold(()=>fN(o,a).bind(r=>r.fold(V(fD,t),V(fP,t),V(fT,t),V(fB,t))),r=>fM(t,r))})(t,n,o)},fj=(t,r)=>{let n=r;for(;n&&n!==t;){if(nU(n)||nz(n))return n;n=n.parentNode}return null},fH=["data-ephox-","data-mce-","data-alloy-","data-snooker-","_"],f$=tF.each,fq=t=>{let r=t.dom,n=new Set(t.serializer.getTempAttrs()),o=t=>eo(fH,r=>e3(t,r))||n.has(t);return{compare:(t,n)=>{if(t.nodeName!==n.nodeName||t.nodeType!==n.nodeType)return!1;let a=t=>{let n={};return f$(r.getAttribs(t),a=>{let l=a.nodeName.toLowerCase();"style"===l||o(l)||(n[l]=r.getAttrib(t,l))}),n},l=(t,r)=>{for(let n in t)if(eI(t,n)){let o=r[n];if(D(o)||t[n]!==o)return!1;delete r[n]}for(let t in r)if(eI(r,t))return!1;return!0};return(!(nx(t)&&nx(n))||!!l(a(t),a(n))&&!!l(r.parseStyle(r.getAttrib(t,"style")),r.parseStyle(r.getAttrib(n,"style"))))&&!dk(t)&&!dk(n)},isAttributeInternal:o}},fV=(t,r,n,o)=>{let a=n.name;for(let r=0,l=t.length;r<l;r++){let l=t[r];if(l.name===a){let t=o.nodes[a];t?t.nodes.push(n):o.nodes[a]={filter:l,nodes:[n]}}}if(n.attributes)for(let t=0,a=r.length;t<a;t++){let a=r[t],l=a.name;if(l in n.attributes.map){let t=o.attributes[l];t?t.nodes.push(n):o.attributes[l]={filter:a,nodes:[n]}}}},fW=(t,r)=>{let n=(t,n)=>{eA(t,t=>{let o=eS(t.nodes);el(t.filter.callbacks,a=>{for(let r=o.length-1;r>=0;r--){let a=o[r];((n?void 0===a.attr(t.filter.name):a.name!==t.filter.name)||P(a.parent))&&o.splice(r,1)}o.length>0&&a(o,t.filter.name,r)})})};n(t.nodes,!1),n(t.attributes,!0)},fK=(t,r,n,o={})=>{fW(((t,r,n)=>{let o={nodes:{},attributes:{}};return n.firstChild&&((n,a)=>{let l=n;for(;l=l.walk();)fV(t,r,l,o)})(n),o})(t,r,n),o)},fG=(t,r,n,o)=>{if((t.pad_empty_with_br||r.insert)&&n(o)){let t=new u0("br",1);r.insert&&t.attr("data-mce-bogus","1"),o.empty().append(t)}else o.empty().append(new u0("#text",3)).value="\xa0"},fY=(t,r)=>{let n=null==t?void 0:t.firstChild;return L(n)&&n===t.lastChild&&n.name===r},fX=(t,r,n,o)=>o.isEmpty(r,n,r=>((t,r)=>{let n=t.getElementRule(r.name);return!0===(null==n?void 0:n.paddEmpty)})(t,r)),fQ=t=>{let r;for(let n=t;n;n=n.parent){let t=n.attr("contenteditable");if("false"===t)break;"true"===t&&(r=n)}return J.from(r)},fJ=(t,r,n=t.parent)=>{if(r.getSpecialElements()[t.name])t.empty().remove();else{for(let o of t.children())n&&!r.isValidChild(n.name,o.name)&&fJ(o,r,n);t.unwrap()}},fZ=(t,r,n,o=U)=>{let a=r.getTextBlockElements(),l=r.getNonEmptyElements(),i=r.getWhitespaceElements(),s=tF.makeMap("tr,td,th,tbody,thead,tfoot,table,summary"),d=new Set,c=t=>t!==n&&!s[t.name];for(let n=0;n<t.length;n++){let s,u,m;let f=t[n];if(!f.parent||d.has(f))continue;if(a[f.name]&&"li"===f.parent.name){let t=f.next;for(;t&&a[t.name];)t.name="li",d.add(t),f.parent.insert(t,f.parent),t=t.next;f.unwrap();continue}let g=[f];for(s=f.parent;s&&!r.isValidChild(s.name,f.name)&&c(s);s=s.parent)g.push(s);if(s&&g.length>1){if(r.isValidChild(s.name,f.name)){g.reverse(),o(u=g[0].clone());let t=u;for(let n=0;n<g.length-1;n++){r.isValidChild(t.name,g[n].name)&&n>0?(o(m=g[n].clone()),t.append(m)):m=t;for(let t=g[n].firstChild;t&&t!==g[n+1];){let r=t.next;m.append(t),t=r}t=m}fX(r,l,i,u)?s.insert(f,g[0],!0):(s.insert(u,g[0],!0),s.insert(f,u)),(fX(r,l,i,s=g[0])||fY(s,"br"))&&s.empty().remove()}else fJ(f,r)}else if(f.parent){if("li"===f.name){let t=f.prev;if(t&&("ul"===t.name||"ol"===t.name)){t.append(f);continue}if((t=f.next)&&("ul"===t.name||"ol"===t.name)&&t.firstChild){t.insert(f,t.firstChild,!0);continue}let r=new u0("ul",1);o(r),f.wrap(r);continue}if(r.isValidChild(f.parent.name,"div")&&r.isValidChild("div",f.name)){let t=new u0("div",1);o(t),f.wrap(t)}else fJ(f,r)}}},f0=(t,r,n=r.parent)=>!(!n||!t.children[r.name]||t.isValidChild(n.name,r.name))||!(!n||"a"!==r.name||!((t,r)=>{let n=t;for(;n;){if("a"===n.name)return!0;n=n.parent}return!1})(n)),f1=t=>t.collapsed?t:(t=>{let r=lx.fromRangeStart(t),n=lx.fromRangeEnd(t),o=t.commonAncestorContainer;return dt(!1,o,n).map(a=>!sq(r,n,o)&&sq(r,a,o)?((t,r,n,o)=>{let a=document.createRange();return a.setStart(t,r),a.setEnd(n,o),a})(r.container(),r.offset(),a.container(),a.offset()):t).getOr(t)})(t),f2=(t,r)=>{let n=r.firstChild,o=r.lastChild;return n&&"meta"===n.name&&(n=n.next),o&&"mce_marker"===o.attr("id")&&(o=o.prev),((t,r)=>{let n,o;let a=t.getNonEmptyElements();return L(r)&&(r.isEmpty(a)||t.getBlockElements()[r.name]&&L((n=r).firstChild)&&n.firstChild===n.lastChild&&("br"===(o=r.firstChild).name||"\xa0"===o.value))})(t,o)&&(o=null==o?void 0:o.prev),!(!n||n!==o||"ul"!==n.name&&"ol"!==n.name)},f3=t=>{var r;let n;return t.length>0&&(!(r=t[t.length-1]).firstChild||L(null==r?void 0:r.firstChild)&&r.firstChild===r.lastChild&&("\xa0"===(n=r.firstChild).data||nM(n)))?t.slice(0,-1):t},f8=(t,r)=>{let n=t.getParent(r,t.isBlock);return n&&"LI"===n.nodeName?n:null},f5=(t,r)=>{let n=lx.after(t),o=s9(r).prev(n);return o?o.toRange():null},f6=(t,r,n,o)=>{var a,l;let i=((t,r,n)=>{let o=r.serialize(n);return(t=>{var r,n;let o=t.firstChild,a=t.lastChild;return o&&"META"===o.nodeName&&(null===(r=o.parentNode)||void 0===r||r.removeChild(o)),a&&"mce_marker"===a.id&&(null===(n=a.parentNode)||void 0===n||n.removeChild(a)),t})(t.createFragment(o))})(r,t,o),s=f8(r,n.startContainer),d=f3(ed(null!==(l=null==(a=i.firstChild)?void 0:a.childNodes)&&void 0!==l?l:[],t=>"LI"===t.nodeName)),c=r.getRoot(),u=t=>{let o=lx.fromRangeStart(n),a=s9(r.getRoot()),l=1===t?a.prev(o):a.next(o),i=null==l?void 0:l.getNode();return!i||f8(r,i)!==s};return s?u(1)?((t,r,n)=>{let o=t.parentNode;return o&&tF.each(r,r=>{o.insertBefore(r,t)}),((t,r)=>{let n=lx.before(t),o=s9(r).next(n);return o?o.toRange():null})(t,n)})(s,d,c):u(2)?(r.insertAfter(d.reverse(),s),f5(d[0],c)):((t,r,n,o)=>{let a=((t,r)=>{let n=r.cloneRange(),o=r.cloneRange();return n.setStartBefore(t),o.setEndAfter(t),[n.cloneContents(),o.cloneContents()]})(t,o),l=t.parentNode;return l&&(l.insertBefore(a[0],t),tF.each(r,r=>{l.insertBefore(r,t)}),l.insertBefore(a[1],t),l.removeChild(t)),f5(r[r.length-1],n)})(s,d,c,n):null},f9=["pre"],f4=(t,r,n)=>{var o,a,l;let i;let s=t.selection,d=t.dom,c=t.parser,u=n.merge,m=mr({validate:!0},t.schema),f='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';-1===r.indexOf("{$caret}")&&(r+="{$caret}"),r=r.replace(/\{\$caret\}/,f);let g=s.getRng(),p=g.startContainer,h=t.getBody();p===h&&s.isCollapsed()&&d.isBlock(h.firstChild)&&L(i=h.firstChild)&&!t.schema.getVoidElements()[i.nodeName]&&d.isEmpty(h.firstChild)&&((g=d.createRng()).setStart(h.firstChild,0),g.setEnd(h.firstChild,0),s.setRng(g)),s.isCollapsed()||(t=>{let r=t.dom,n=f1(t.selection.getRng());t.selection.setRng(n);let o=r.getParent(n.startContainer,nj);L(o)&&o===r.getParent(n.endContainer,nj)&&dj(ri(o),n)?fD(t,n,ri(o)):n.startContainer===n.endContainer&&n.endOffset-n.startOffset==1&&nT(n.startContainer.childNodes[n.startOffset])?n.deleteContents():t.getDoc().execCommand("Delete",!1)})(t);let b=s.getNode(),v={context:b.nodeName.toLowerCase(),data:n.data,insert:!0},y=c.parse(r,v);if(!0===n.paste&&f2(t.schema,y)&&f8(d,b))return(g=f6(m,d,s.getRng(),y))&&s.setRng(g),r;!0===n.paste&&((t,r,n,o)=>{var a;let l=r.firstChild,i=r.lastChild,s=l===("bookmark"===i.attr("data-mce-type")?i.prev:i),d=en(f9,l.name);if(s&&d){let r="false"!==l.attr("contenteditable"),i=(null===(a=t.getParent(n,t.isBlock))||void 0===a?void 0:a.nodeName.toLowerCase())===l.name,s=J.from(fj(o,n)).forall(nU);return r&&i&&s}return!1})(d,y,b,t.getBody())&&(null===(o=y.firstChild)||void 0===o||o.unwrap()),(t=>{let r=t;for(;r=r.walk();)1===r.type&&r.attr("data-mce-fragment","1")})(y);let C=y.lastChild;if(C&&"mce_marker"===C.attr("id")){let r=C;for(C=C.prev;C;C=C.walk(!0))if(3===C.type||!d.isBlock(C.name)){C.parent&&t.schema.isValidChild(C.parent.name,"span")&&C.parent.insert(r,C,"br"===C.name);break}}if(t._selectionOverrides.showBlockCaretContainer(b),v.invalid){t.selection.setContent(f);let n,o=s.getNode(),l=t.getBody();for(nL(o)?o=n=l:n=o;n&&n!==l;)o=n,n=n.parentNode;r=o===l?l.innerHTML:d.getOuterHTML(o);let i=c.parse(r),u=(t=>{for(let r=t;r;r=r.walk())if("mce_marker"===r.attr("id"))return J.some(r);return J.none()})(i),g=u.bind(fQ).getOr(i);u.each(t=>t.replace(y));let p=y.children(),h=null!==(a=y.parent)&&void 0!==a?a:i;y.unwrap(),fZ(ed(p,r=>f0(t.schema,r,h)),t.schema,g),fK(c.getNodeFilters(),c.getAttributeFilters(),i),r=m.serialize(i),o===l?d.setHTML(l,r):d.setOuterHTML(o,r)}else((t,r,n)=>{var o;if("all"===n.getAttribute("data-mce-bogus"))null===(o=n.parentNode)||void 0===o||o.insertBefore(t.dom.createFragment(r),n);else{let o=n.firstChild,a=n.lastChild;o&&(o!==a||"BR"!==o.nodeName)?t.selection.setContent(r,{no_events:!0}):t.dom.setHTML(n,r)}})(t,r=m.serialize(y),b);return((t,r)=>{let n=t.schema.getTextInlineElements(),o=t.dom;if(r){let r=t.getBody(),a=fq(t);tF.each(o.select("*[data-mce-fragment]"),t=>{if(L(n[t.nodeName.toLowerCase()])&&eb(ma(o,t),t=>!mn.has(t))){for(let n=t.parentElement;L(n)&&n!==r&&!ml(o,t,n);n=n.parentElement)if(a.compare(n,t)){o.remove(t,!0);break}}})}})(t,u),((t,r)=>{var n,o,a,l;let i;let s=t.dom,d=t.selection;if(!r)return;d.scrollIntoView(r);let c=fj(t.getBody(),r);if(c&&"false"===s.getContentEditable(c))return s.remove(r),void d.select(c);let u=s.createRng(),m=r.previousSibling;if(nT(m)){u.setStart(m,null!==(o=null===(n=m.nodeValue)||void 0===n?void 0:n.length)&&void 0!==o?o:0);let t=r.nextSibling;nT(t)&&(m.appendData(t.data),null===(a=t.parentNode)||void 0===a||a.removeChild(t))}else u.setStartBefore(r),u.setEndBefore(r);let f=s.getParent(r,s.isBlock);if(s.remove(r),f&&s.isEmpty(f)){let r;let n=nj(f);ne(ri(f)),u.setStart(f,0),u.setEnd(f,0),n||f.getAttribute("data-mce-fragment")||(l=u,r=lx.fromRangeStart(l),!(i=null==(r=s9(t.getBody()).next(r))?void 0:r.toRange()))?s.add(f,s.create("br",n?{}:{"data-mce-bogus":"1"})):(u=i,s.remove(f))}d.setRng(u)})(t,d.get("mce_marker")),l=t.getBody(),tF.each(l.getElementsByTagName("*"),t=>{t.removeAttribute("data-mce-fragment")}),((t,r)=>{J.from(t.getParent(r,"td,th")).map(ri).each(or)})(d,s.getStart()),((t,r,n)=>{let o=rx(ri(n),t=>rp(t,ri(r)));ex(o,o.length-2).filter(tY).fold(()=>oF(t,r),r=>oF(t,r.dom))})(t.schema,t.getBody(),s.getStart()),r},f7=t=>t instanceof u0,ge=(t,r,n)=>{t.dom.setHTML(t.getBody(),r),!0!==n&&uI(t)&&ds(t.getBody()).each(r=>{let n=r.getNode(),o=nR(n)?ds(n).getOr(r):r;t.selection.setRng(o.toRange())})},gt=(t,r)=>((t,r)=>{let n,o;let a=t.dom;return a.parentNode?(n=ri(a.parentNode),o=n=>!rp(t,n)&&r(n),ef(n.dom.childNodes,t=>o(ri(t))).map(ri)):J.none()})(t,r).isSome(),gr=t=>F(t)?t:X,gn=(t,r,n)=>{let o=r(t),a=gr(n);return o.orThunk(()=>a(t)?J.none():((t,r,n)=>{let o=t.dom,a=gr(n);for(;o.parentNode;){let t=ri(o=o.parentNode),n=r(t);if(n.isSome())return n;if(a(t))break}return J.none()})(t,r,a))},go=(t,r,n)=>{let o=t.formatter.get(n);if(o)for(let n=0;n<o.length;n++){let a=o[n];if(ce(a)&&!1===a.inherit&&t.dom.is(r,a.selector))return!0}return!1},ga=(t,r,n,o,a)=>{let l=t.dom.getRoot();if(r===l)return!1;let i=t.dom.getParent(r,r=>!!go(t,r,n)||r.parentNode===l||!!gs(t,r,n,o,!0));return!!gs(t,i,n,o,a)},gl=(t,r,n)=>!(!ct(n)||!d3(r,n.inline))||!(!d7(n)||!d3(r,n.block))||!!ce(n)&&nx(r)&&t.is(r,n.selector),gi=(t,r,n,o,a,l)=>{let i=n[o],s="attributes"===o;if(F(n.onmatch))return n.onmatch(r,n,o);if(i){if(ej(i))for(let n=0;n<i.length&&(s?!t.getAttrib(r,i[n]):!d5(t,r,i[n]));n++);else for(let o in i)if(eI(i,o)){let d=s?t.getAttrib(r,o):d5(t,r,o),c=d2(i[o],l),u=P(d)||te(d);if(u&&P(c))continue;if(a&&u&&!n.exact||(!a||n.exact)&&!d3(d,d8(c,o)))return!1}}return!0},gs=(t,r,n,o,a)=>{let l=t.formatter.get(n),i=t.dom;if(l&&nx(r))for(let n=0;n<l.length;n++){let s=l[n];if(gl(t.dom,r,s)&&gi(i,r,s,"attributes",a,o)&&gi(i,r,s,"styles",a,o)){let n=s.classes;if(n){for(let a=0;a<n.length;a++)if(!t.dom.hasClass(r,d2(n[a],o)))return}return s}}},gd=(t,r,n,o,a)=>{if(o)return ga(t,o,r,n,a);if(o=t.selection.getNode(),ga(t,o,r,n,a))return!0;let l=t.selection.getStart();return!(l===o||!ga(t,l,r,n,a))},gc=t=>(t=>{let r=[],n=t;for(;n;){if(nT(n)&&"\uFEFF"!==n.data||n.childNodes.length>1)return[];nx(n)&&r.push(n),n=n.firstChild}return r})(t).length>0,gu=t=>{if(t){let r=new ny(t,t);for(let t=r.current();t;t=r.next())if(nT(t))return t}return null},gm=t=>{let r=rd("span");return t2(r,{id:dc,"data-mce-bogus":"1","data-mce-type":"format-caret"}),t&&r9(r,rc("\uFEFF")),r},gf=(t,r,n=!0)=>{let o=t.dom,a=t.selection;if(gc(r))fe(t,!1,ri(r),n);else{let t=a.getRng(),n=o.getParent(r,o.isBlock),l=t.startContainer,i=t.startOffset,s=t.endContainer,d=t.endOffset,c=(t=>{let r=gu(t);return r&&"\uFEFF"===r.data.charAt(0)&&r.deleteData(0,1),r})(r);o.remove(r,!0),l===c&&i>0&&t.setStart(c,i-1),s===c&&d>0&&t.setEnd(c,d-1),n&&o.isEmpty(n)&&ot(ri(n)),a.setRng(t)}},gg=(t,r,n=!0)=>{let o=t.dom,a=t.selection;if(r)gf(t,r,n);else if(!(r=dm(t.getBody(),a.getStart())))for(;r=o.get(dc);)gf(t,r,n)},gp=(t,r)=>(t.appendChild(r),r),gh=(t,r)=>{var n;let o=ec(t,(t,r)=>gp(t,r.cloneNode(!1)),r),a=null!==(n=o.ownerDocument)&&void 0!==n?n:document;return gp(o,a.createTextNode("\uFEFF"))},gb=(t,r,n,o)=>{let a;let l=t.dom,i=t.selection,s=!1,d=t.formatter.get(r);if(!d)return;let c=i.getRng(),u=c.startContainer,m=c.startOffset,f=u;nT(u)&&(m!==u.data.length&&(s=!0),f=f.parentNode);let g=[];for(;f;){if(gs(t,f,r,n,o)){a=f;break}f.nextSibling&&(s=!0),g.push(f),f=f.parentNode}if(a){if(s){let a=i.getBookmark();c.collapse(!0);let s=cf(l,c,d,!0);s=c5(s),t.formatter.remove(r,n,s,o),i.moveToBookmark(a)}else{let s=dm(t.getBody(),a),d=gm(!1).dom;((t,r,n)=>{var o,a;let l=t.dom,i=l.getParent(n,V(dJ,t.schema));i&&l.isEmpty(i)?null===(o=n.parentNode)||void 0===o||o.replaceChild(r,n):((t=>{let r=nb(t,"br"),n=ed((t=>{let r=[],n=t.dom;for(;n;)r.push(ri(n)),n=n.lastChild;return r})(t).slice(-1),n1);r.length===n.length&&el(n,nt)})(ri(n)),l.isEmpty(n)?null===(a=n.parentNode)||void 0===a||a.replaceChild(r,n):l.insertAfter(r,n))})(t,d,null!=s?s:a);let c=((t,r,n,o,a,l)=>{let i=t.formatter,s=t.dom,d=ed(eN(i.get()),t=>t!==o&&!e2(t,"removeformat"));if(ed(eu(d,(r,o)=>{let a=d4(t,o,t=>{let r=t=>F(t)||t.length>1&&"%"===t.charAt(0);return eo(["styles","attributes"],n=>eM(t,n).exists(t=>eo(O(t)?t:eF(t),r)))});return t.formatter.matchNode(n,o,{},a)?r.concat([o]):r},[]),r=>!((t,r,n)=>{let o=["inline","block","selector","attributes","styles","classes"],a=t=>eP(t,(t,r)=>eo(o,t=>t===r));return d4(t,r,r=>{let o=a(r);return d4(t,n,t=>((t,r,n=C)=>y(n).eq(t,r))(o,a(t)))})})(t,r,o)).length>0){let t=n.cloneNode(!1);return s.add(r,t),i.remove(o,a,t,l),s.remove(t),J.some(t)}return J.none()})(t,d,a,r,n,o),u=gh(g.concat(c.toArray()),d);s&&gf(t,s,!1),i.setCursorLocation(u,1),l.isEmpty(a)&&l.remove(a)}}},gv=t=>{let r=gm(!1),n=gh(t,r.dom);return{caretContainer:r,caretPosition:lx(n,0)}},gy=(t,r)=>{let{caretContainer:n,caretPosition:o}=gv(r);return r8(ri(t),n),nt(ri(t)),o},gC=(t,r)=>eI(t.schema.getTextInlineElements(),tV(r))&&!du(r.dom)&&!nN(r.dom),gw=t=>du(t.dom)&&gc(t.dom),gx={},gE=nk(["pre"]);gx.pre||(gx.pre=[]),gx.pre.push(t=>{if(!t.selection.getRng().collapsed){let r=t.selection.getSelectedBlocks();el(ed(ed(r,gE),t=>{let n=t.previousSibling;return gE(n)&&en(r,n)}),t=>{((t,r)=>{let n=ri(r),o=rv(n).dom;nt(n),r7(ri(t),[rd("br",o),rd("br",o),...rN(n)])})(t.previousSibling,t)})}});let gk=["fontWeight","fontStyle","color","fontSize","fontFamily"],gS=(t,r)=>{let n=t.get(r);return O(n)?ef(n,t=>{let r;return ct(t)&&"span"===t.inline&&R((r=t).styles)&&eo(eN(r.styles),t=>en(gk,t))}):J.none()},g_=(t,r)=>di(r,lx.fromRangeStart(t)).isNone(),gN=(t,r)=>!1===dl(r,lx.fromRangeEnd(t)).exists(t=>!nM(t.getNode())||dl(r,t).isSome()),gR=t=>r=>nq(r)&&t.isEditable(r),gA=t=>ed(t.getSelectedBlocks(),gR(t.dom)),gO=tF.each,gT=t=>nx(t)&&!dk(t)&&!du(t)&&!nN(t),gB=(t,r)=>{for(let n=t;n&&!(nT(n)&&e7(n.data));n=n[r])if(nx(n)&&!dk(n))return n;return t},gD=(t,r,n)=>{let o=fq(t),a=nx(r)&&dG(r),l=nx(n)&&dG(n);if(a&&l){let a=gB(r,"previousSibling"),l=gB(n,"nextSibling");if(o.compare(a,l)){for(let t=a.nextSibling;t&&t!==l;){let r=t;t=t.nextSibling,a.appendChild(r)}return t.dom.remove(l),tF.each(tF.grep(l.childNodes),t=>{a.appendChild(t)}),a}}return n},gP=(t,r,n,o)=>{var a;if(o&&!1!==r.merge_siblings){let r=null!==(a=gD(t,dQ(o),o))&&void 0!==a?a:o;gD(t,r,dQ(r,!0))}},gL=(t,r,n)=>{gO(t.childNodes,t=>{gT(t)&&(r(t)&&n(t),t.hasChildNodes()&&gL(t,r,n))})},gF=(t,r)=>n=>!(!n||!d5(t,n,r)),gM=(t,r,n)=>o=>{t.setStyle(o,r,n),""===o.getAttribute("style")&&o.removeAttribute("style"),"SPAN"===o.nodeName&&0===t.getAttribs(o).length&&t.remove(o,!0)},gI=lH([{keep:[]},{rename:["name"]},{removed:[]}]),gU=/^(src|href|style)$/,gz=tF.each,gj=(t,r,n)=>t.isChildOf(r,n)&&r!==n&&!t.isBlock(n),gH=(t,r,n)=>{let o=r[n?"startContainer":"endContainer"],a=r[n?"startOffset":"endOffset"];if(nx(o)){let t=o.childNodes.length-1;!n&&a&&a--,o=o.childNodes[a>t?t:a]}return nT(o)&&n&&a>=o.data.length&&(o=new ny(o,t.getBody()).next()||o),nT(o)&&!n&&0===a&&(o=new ny(o,t.getBody()).prev()||o),o},g$=(t,r)=>{let n=r?"firstChild":"lastChild",o=t[n];return/^(TR|TH|TD)$/.test(t.nodeName)&&o?"TR"===t.nodeName&&o[n]||o:t},gq=(t,r,n,o)=>{var a;let l=t.create(n,o);return null===(a=r.parentNode)||void 0===a||a.insertBefore(l,r),l.appendChild(r),l},gV=(t,r,n,o,a)=>{let l=ri(r),i=ri(t.create(o,a));return r7(i,n?r_(l):rS(l)),n?(r8(l,i),r6(i,l)):(r5(l,i),r9(i,l)),i.dom},gW=(t,r,n)=>{let o;let a=r.parentNode,l=t.dom,i=l7(t);d7(n)&&a===l.getRoot()&&(n.list_block&&d3(r,n.list_block)||el(eS(r.childNodes),r=>{dZ(t,i,r.nodeName.toLowerCase())?o?o.appendChild(r):(o=gq(l,r,i),l.setAttribs(o,ie(t))):o=null})),ce(n)&&ct(n)&&tM(eM(n,"mixed"),!0)&&!d3(n.inline,r)||l.remove(r,!0)},gK=(t,r,n)=>M(t)?{name:r,value:null}:{name:t,value:d2(r,n)},gG=(t,r)=>{""===t.getAttrib(r,"style")&&(r.removeAttribute("style"),r.removeAttribute("data-mce-style"))},gY=(t,r,n,o,a)=>{let l=!1;gz(n.styles,(i,s)=>{let{name:d,value:c}=gK(s,i,o),u=d8(c,d);(n.remove_similar||T(c)||!nx(a)||d3(d5(t,a,d),u))&&t.setStyle(r,d,""),l=!0}),l&&gG(t,r)},gX=(t,r,n,o,a)=>{let l=t.dom,i=fq(t),s=t.schema;if(ct(r)&&oU(s,r.inline)&&oj(s,o)&&o.parentElement===t.getBody())return gW(t,o,r),gI.removed();if(!r.ceFalseOverride&&o&&"false"===l.getContentEditableParent(o)||o&&!gl(l,o,r)&&(!r.links||"A"!==o.nodeName))return gI.keep();let d=r.preserve_attributes;if(ct(r)&&"all"===r.remove&&O(d)){let t=ed(l.getAttribs(o),t=>en(d,t.name.toLowerCase()));if(l.removeAllAttribs(o),el(t,t=>l.setAttrib(o,t.name,t.value)),t.length>0)return gI.rename("span")}if("all"!==r.remove){gY(l,o,r,n,a),gz(r.attributes,(t,i)=>{let{name:s,value:d}=gK(i,t,n);if(r.remove_similar||T(d)||!nx(a)||d3(l.getAttrib(a,s),d)){if("class"===s){let t=l.getAttrib(o,s);if(t){let r="";if(el(t.split(/\s+/),t=>{/mce\-\w+/.test(t)&&(r+=(r?" ":"")+t)}),r)return void l.setAttrib(o,s,r)}}if(gU.test(s)&&o.removeAttribute("data-mce-"+s),"style"===s&&nk(["li"])(o)&&"none"===l.getStyle(o,"list-style-type"))return o.removeAttribute(s),void l.setStyle(o,"list-style-type","none");"class"===s&&o.removeAttribute("className"),o.removeAttribute(s)}}),gz(r.classes,t=>{t=d2(t,n),nx(a)&&!l.hasClass(a,t)||l.removeClass(o,t)});let t=l.getAttribs(o);for(let r=0;r<t.length;r++){let n=t[r].nodeName;if(!i.isAttributeInternal(n))return gI.keep()}}return"none"!==r.remove?(gW(t,o,r),gI.removed()):gI.keep()},gQ=(t,r,n,o)=>gX(t,r,n,o,o).fold(H(o),r=>(t.dom.createFragment().appendChild(o),t.dom.rename(o,r)),H(null)),gJ=(t,r,n,o,a)=>{(o||t.selection.isEditable())&&((t,r,n,o,a)=>{let l=t.formatter.get(r),i=l[0],s=t.dom,d=t.selection,c=o=>{let s;let d=(o.parentNode&&el(d9(t.dom,o.parentNode).reverse(),o=>{if(!s&&nx(o)&&"_start"!==o.id&&"_end"!==o.id){let l=gs(t,o,r,n,a);l&&!1!==l.split&&(s=o)}}),s);return((t,r,n,o,a,l,i,s)=>{var d,c;let u,m;let f=t.dom;if(n){let l=n.parentNode;for(let n=o.parentNode;n&&n!==l;n=n.parentNode){let o=f.clone(n,!1);for(let n=0;n<r.length&&null!==(o=gQ(t,r[n],s,o));n++);o&&(u&&o.appendChild(u),m||(m=o),u=o)}i.mixed&&f.isBlock(n)||(o=null!==(d=f.split(n,o))&&void 0!==d?d:o),u&&m&&(null===(c=a.parentNode)||void 0===c||c.insertBefore(u,a),m.appendChild(a),ct(i)&&gP(t,i,0,u))}return o})(t,l,d,o,o,0,i,n)},u=r=>eo(l,o=>gZ(t,o,n,r,r)),m=r=>{let n=eS(r.childNodes),o=u(r)||eo(l,t=>gl(s,r,t)),a=r.parentNode;if(!o&&L(a)&&cr(i)&&u(a),i.deep&&n.length)for(let t=0;t<n.length;t++)m(n[t]);el(["underline","line-through","overline"],n=>{nx(r)&&t.dom.getStyle(r,"text-decoration")===n&&r.parentNode&&d6(s,r.parentNode)===n&&gZ(t,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:n}},void 0,r)})},f=t=>{let r=s.get(t?"_start":"_end");if(r){let n,o=r[t?"firstChild":"lastChild"];return dk(n=o)&&nx(n)&&("_start"===n.id||"_end"===n.id)&&(o=o[t?"firstChild":"lastChild"]),nT(o)&&0===o.data.length&&(o=t?r.previousSibling||r.nextSibling:r.nextSibling||r.previousSibling),s.remove(r,!0),o}return null},g=r=>{let n,o,a=cf(s,r,l,r.collapsed);if(i.split){if((n=gH(t,a=c5(a),!0))!==(o=gH(t,a))){if(gj(s,n=g$(n,!0),o=g$(o,!1)))return c(gV(s,J.from(n.firstChild).getOr(n),!0,"span",{id:"_start","data-mce-type":"bookmark"})),void f(!0);if(gj(s,o,n))return c(gV(s,J.from(o.lastChild).getOr(o),!1,"span",{id:"_end","data-mce-type":"bookmark"})),void f(!1);n=gq(s,n,"span",{id:"_start","data-mce-type":"bookmark"}),o=gq(s,o,"span",{id:"_end","data-mce-type":"bookmark"});let t=s.createRng();t.setStartAfter(n),t.setEndBefore(o),cg(s,t,t=>{el(t,t=>{dk(t)||dk(t.parentNode)||c(t)})}),c(n),c(o),n=f(!0),o=f()}else n=o=c(n);a.startContainer=n.parentNode?n.parentNode:n,a.startOffset=s.nodeIndex(n),a.endContainer=o.parentNode?o.parentNode:o,a.endOffset=s.nodeIndex(o)+1}cg(s,a,t=>{el(t,m)})};if(o){if(dW(o)){let t=s.createRng();t.setStartBefore(o),t.setEndAfter(o),g(t)}else g(o);ck(t,r,o,n)}else d.isCollapsed()&&ct(i)&&!dM(t).length?gb(t,r,n,a):(dY(t,()=>dq(t,g),o=>ct(i)&&gd(t,r,n,o)),t.nodeChanged()),"removeformat"===r?el(gA(t.selection),r=>{el(gk,n=>t.dom.setStyle(r,n,"")),gG(t.dom,r)}):gS(t.formatter,r).each(r=>{el(gA(t.selection),o=>gY(t.dom,o,r,n,null))}),ck(t,r,o,n)})(t,r,n,o,a)},gZ=(t,r,n,o,a)=>gX(t,r,n,o,a).fold(X,r=>(t.dom.rename(o,r),!0),Q),g0=tF.each,g1=tF.each,g2=(t,r,n,o)=>{if(g1(n.styles,(n,a)=>{t.setStyle(r,a,d2(n,o))}),n.styles){let n=t.getAttrib(r,"style");n&&t.setAttrib(r,"data-mce-style",n)}},g3=(t,r,n,o)=>{let a=t.formatter.get(r),l=a[0],i=!o&&t.selection.isCollapsed(),s=t.dom,d=t.selection,c=(t,r=l)=>{F(r.onformat)&&r.onformat(t,r,n,o),g2(s,t,r,n),g1(r.attributes,(r,o)=>{s.setAttrib(t,o,d2(r,n))}),g1(r.classes,r=>{let o=d2(r,n);s.hasClass(t,o)||s.addClass(t,o)})},u=(t,r)=>{let n=!1;return g1(t,t=>!(!ce(t)||("false"!==s.getContentEditable(r)||t.ceFalseOverride)&&(!L(t.collapsed)||t.collapsed===i)&&s.is(r,t.selector)&&!du(r)&&(c(r,t),n=!0,1))),n},m=t=>{if(N(t)){let r=s.create(t);return c(r),r}return null},f=(o,i,s)=>{let d=[],f=!0,g=l.inline||l.block,p=m(g);cg(o,i,i=>{let m;let h=i=>{let b=!1,v=f,y=!1,C=i.parentNode,w=C.nodeName.toLowerCase(),x=o.getContentEditable(i);L(x)&&(v=f,f="true"===x,b=!0,y=d1(t,i));let E=f&&!b;if(nM(i)&&!((t,r,n,o)=>{if(iz(t)&&ct(r)&&n.parentNode){let r=ac(t.schema),a=gt(ri(n),t=>du(t.dom));return eU(r,o)&&oA(ri(n.parentNode),!1)&&!a}return!1})(t,l,i,w))return m=null,void(d7(l)&&o.remove(i));if(d7(l)&&!0===l.wrapper&&gs(t,i,r,n))m=null;else{if(((r,n,o)=>{let a=d7(l)&&!0!==l.wrapper&&dJ(t.schema,r)&&dZ(t,n,g);return o&&a})(i,w,E)){let t=o.rename(i,g);return c(t),d.push(t),void(m=null)}if(ce(l)){let t=u(a,i);if(!t&&L(C)&&cr(l)&&(t=u(a,C)),!ct(l)||t)return void(m=null)}L(p)&&((r,n,a,i)=>{let d=dZ(t,g,r.nodeName.toLowerCase())&&dZ(t,n,g),c=!s&&nT(r)&&nK(r.data),u=du(r),m=!ct(l)||!o.isBlock(r);return(a||i)&&d&&!c&&!u&&m})(i,w,E,y)?(m||(m=o.clone(p,!1),C.insertBefore(m,i),d.push(m)),y&&b&&(f=v),m.appendChild(i)):(m=null,el(eS(i.childNodes),h),b&&(f=v),m=null)}};el(i,h)}),!0===l.links&&el(d,t=>{let r=t=>{"A"===t.nodeName&&c(t,l),el(eS(t.childNodes),r)};r(t)}),el(d,i=>{var s,u;let m;let f=(m=0,el(i.childNodes,t=>{L(t)&&nT(t)&&0===t.length||dk(t)||m++}),m);!(d.length>1)&&o.isBlock(i)||0!==f?(ct(l)||d7(l)&&l.wrapper)&&(l.exact||1!==f||(i=ef((s=i).childNodes,dK).filter(t=>"false"!==o.getContentEditable(t)&&gl(o,t,l)).map(t=>{let r=o.clone(t,!1);return c(r),o.replace(r,s,!0),o.remove(t,!0),r}).getOr(s)),u=i,g0(a,r=>{ct(r)&&g0(t.dom.select(r.inline,u),o=>{gT(o)&&gZ(t,r,n,o,r.exact?o:null)}),((t,r,n)=>{if(r.clear_child_styles){let o=r.links?"*:not(a)":"*";gO(t.select(o,n),n=>{gT(n)&&dG(n)&&gO(r.styles,(r,o)=>{t.setStyle(n,o,"")})})}})(t.dom,r,u)}),((t,r,n,o,a)=>{let l=a.parentNode;gs(t,l,n,o)&&gZ(t,r,o,a)||r.merge_with_parents&&l&&t.dom.getParent(l,l=>!!gs(t,l,n,o)&&(gZ(t,r,o,a),!0))})(t,l,r,n,i),((t,r,n,o)=>{if(r.styles&&r.styles.backgroundColor){let a=gF(t,"fontSize");gL(o,t=>a(t)&&dG(t),gM(t,"backgroundColor",d2(r.styles.backgroundColor,n)))}})(o,l,n,i),((t,r,n,o)=>{let a=r=>{if(nx(r)&&nx(r.parentNode)&&dG(r)){let n=d6(t,r.parentNode);t.getStyle(r,"color")&&n?t.setStyle(r,"text-decoration",n):t.getStyle(r,"text-decoration")===n&&t.setStyle(r,"text-decoration",null)}};r.styles&&(r.styles.color||r.styles.textDecoration)&&(tF.walk(o,a,"childNodes"),a(o))})(o,l,0,i),((t,r,n,o)=>{if(ct(r)&&("sub"===r.inline||"sup"===r.inline)){let n=gF(t,"fontSize");gL(o,t=>n(t)&&dG(t),gM(t,"fontSize",""));let a=ed(t.select("sup"===r.inline?"sub":"sup",o),dG);t.remove(a,!0)}})(o,l,0,i),gP(t,l,0,i)):o.remove(i,!0)})},g=dW(o)?o:d.getNode();if("false"===s.getContentEditable(g)&&!d1(t,g))return u(a,o=g),void cE(t,r,o,n);if(l){if(o){if(dW(o)){if(!u(a,o)){let t=s.createRng();t.setStartBefore(o),t.setEndAfter(o),f(s,cf(s,t,a),!0)}}else f(s,o,!0)}else i&&ct(l)&&!dM(t).length?((t,r,n)=>{var o,a;let l;let i=t.selection,s=t.formatter.get(r);if(!s)return;let d=i.getRng(),c=d.startOffset,u=d.startContainer.nodeValue;l=dm(t.getBody(),i.getStart());let m=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(u&&c>0&&c<u.length&&m.test(u.charAt(c))&&m.test(u.charAt(c-1))){let o=i.getBookmark();d.collapse(!0);let a=cf(t.dom,d,s);a=c5(a),t.formatter.apply(r,n,a),i.moveToBookmark(o)}else{let s=l?gu(l):null;l&&(null==s?void 0:s.data)==="\uFEFF"||(o=t.getDoc(),a=gm(!0).dom,s=(l=o.importNode(a,!0)).firstChild,d.insertNode(l),c=1),t.formatter.apply(r,n,l),i.setCursorLocation(s,c)}})(t,r,n):(d.setRng(f1(d.getRng())),dY(t,()=>{dq(t,(t,r)=>{let n=r?t:cf(s,t,a);f(s,n,!1)})},Q),t.nodeChanged()),gS(t.formatter,r).each(r=>{let o;el(ed((t=>{let r=t.getSelectedBlocks(),n=t.getRng();if(t.isCollapsed())return[];if(1===r.length)return g_(n,r[0])&&gN(n,r[0])?r:[];{let t=eE(r).filter(t=>g_(n,t)).toArray(),o=ek(r).filter(t=>gN(n,t)).toArray(),a=r.slice(1,-1);return t.concat(a).concat(o)}})(o=t.selection),gR(o.dom)),t=>g2(s,t,r,n))});eI(gx,r)&&el(gx[r],r=>{r(t)})}cE(t,r,o,n)},g8=(t,r,n,o)=>{(o||t.selection.isEditable())&&g3(t,r,n,o)},g5=t=>eI(t,"vars"),g6=t=>t.selection.getStart(),g9=(t,r,n,o,a)=>em(r,r=>!D(t.formatter.matchNode(r,n,null!=a?a:{},o)),r=>!!go(t,r,n)||!o&&L(t.formatter.matchNode(r,n,a,!0))),g4=(t,r)=>{let n=null!=r?r:g6(t);return ed(d9(t.dom,n),t=>nx(t)&&!nN(t))},g7=(t,r,n)=>{let o=g4(t,r);eA(n,(n,a)=>{let l=n=>{let l=g9(t,o,a,n.similar,g5(n)?n.vars:void 0),i=l.isSome();if(n.state.get()!==i){n.state.set(i);let t=l.getOr(r);g5(n)?n.callback(i,{node:t,format:a,parents:o}):el(n.callbacks,r=>r(i,{node:t,format:a,parents:o}))}};el([n.withSimilar,n.withoutSimilar],l),el(n.withVars,l)})},pe=tF.explode,pt=()=>{let t={};return{addFilter:(r,n)=>{el(pe(r),r=>{eI(t,r)||(t[r]={name:r,callbacks:[]}),t[r].callbacks.push(n)})},getFilters:()=>eF(t),removeFilter:(r,n)=>{el(pe(r),r=>{if(eI(t,r)){if(L(n)){let o=t[r],a=ed(o.callbacks,t=>t!==n);a.length>0?o.callbacks=a:delete t[r]}else delete t[r]}})}}},pr=(t,r,n)=>{var o;let a=af();r.convert_fonts_to_spans&&((t,r,n)=>{t.addNodeFilter("font",t=>{el(t,t=>{let o=r.parse(t.attr("style")),a=t.attr("color"),l=t.attr("face"),i=t.attr("size");a&&(o.color=a),l&&(o["font-family"]=l),i&&tt(i).each(t=>{o["font-size"]=n[t-1]}),t.name="span",t.attr("style",r.serialize(o)),el(["color","face","size"],r=>{t.attr(r,null)})})})})(t,a,tF.explode(null!==(o=r.font_size_legacy_values)&&void 0!==o?o:"")),((t,r,n)=>{t.addNodeFilter("strike",t=>{let o="html4"!==r.type;el(t,t=>{if(o)t.name="s";else{let r=n.parse(t.attr("style"));r["text-decoration"]="line-through",t.name="span",t.attr("style",n.serialize(r))}})})})(t,n,a)},pn=(t,r,n)=>{r.addNodeFilter("br",(r,o,a)=>{let l=tF.extend({},n.getBlockElements()),i=n.getNonEmptyElements(),s=n.getWhitespaceElements();l.body=1;let d=t=>t.name in l||o$(n,t);for(let o=0,c=r.length;o<c;o++){let c=r[o],u=c.parent;if(u&&d(u)&&c===u.lastChild){let r=c.prev;for(;r;){let t=r.name;if("span"!==t||"bookmark"!==r.attr("data-mce-type")){"br"===t&&(c=null);break}r=r.prev}if(c&&(c.remove(),fX(n,i,s,u))){let r=n.getElementRule(u.name);r&&(r.removeEmpty?u.remove():r.paddEmpty&&fG(t,a,d,u))}}else{let t=c;for(;u&&u.firstChild===t&&u.lastChild===t&&(t=u,!l[u.name]);)u=u.parent;if(t===u){let t=new u0("#text",3);t.value="\xa0",c.replace(t)}}}})},po=t=>{let[r,...n]=t.split(","),o=n.join(","),a=/data:([^/]+\/[^;]+)(;.+)?/.exec(r);if(a){let t=";base64"===a[2],r=t?(t=>{let r=/([a-z0-9+\/=\s]+)/i.exec(t);return r?r[1]:""})(o):decodeURIComponent(o);return J.some({type:a[1],data:r,base64Encoded:t})}return J.none()},pa=(t,r,n=!0)=>{let o=r;if(n)try{o=atob(r)}catch(t){return J.none()}let a=new Uint8Array(o.length);for(let t=0;t<a.length;t++)a[t]=o.charCodeAt(t);return J.some(new Blob([a],{type:t}))},pl=t=>new Promise((r,n)=>{let o=new FileReader;o.onloadend=()=>{r(o.result)},o.onerror=()=>{var t;n(null===(t=o.error)||void 0===t?void 0:t.message)},o.readAsDataURL(t)}),pi=0,ps=(t,r,n)=>po(t).bind(({data:t,type:o,base64Encoded:a})=>r&&!a?J.none():n(a?t:btoa(t),o)),pd=(t,r,n)=>{let o=t.create("blobid"+pi++,r,n);return t.add(o),o},pc=(t,r,n=!1)=>ps(r,n,(r,n)=>J.from(t.getByData(r,n)).orThunk(()=>pa(n,r).map(n=>pd(t,n,r)))),pu=(t,r)=>{let n=t.schema;r.remove_trailing_brs&&pn(r,t,n),t.addAttributeFilter("href",t=>{let n=t.length,o=t=>{let r=t?tF.trim(t):"";return/\b(noopener)\b/g.test(r)?r:r.split(" ").filter(t=>t.length>0).concat(["noopener"]).sort().join(" ")};if(!r.allow_unsafe_link_target)for(;n--;){let r=t[n];"a"===r.name&&"_blank"===r.attr("target")&&r.attr("rel",o(r.attr("rel")))}}),r.allow_html_in_named_anchor||t.addAttributeFilter("id,name",t=>{let r,n,o,a,l=t.length;for(;l--;)if("a"===(a=t[l]).name&&a.firstChild&&!a.attr("href"))for(o=a.parent,r=a.lastChild;r&&o;)n=r.prev,o.insert(r,a),r=n}),r.fix_list_elements&&t.addNodeFilter("ul,ol",t=>{let r,n,o=t.length;for(;o--;)if((n=(r=t[o]).parent)&&("ul"===n.name||"ol"===n.name)){if(r.prev&&"li"===r.prev.name)r.prev.append(r);else{let t=new u0("li",1);t.attr("style","list-style-type: none"),r.wrap(t)}}});let o=n.getValidClasses();r.validate&&o&&t.addAttributeFilter("class",t=>{var r;let n=t.length;for(;n--;){let a=t[n],l=null!==(r=a.attr("class"))&&void 0!==r?r:"",i=tF.explode(l," "),s="";for(let t=0;t<i.length;t++){let r=i[t],n=!1,l=o["*"];l&&l[r]&&(n=!0),l=o[a.name],!n&&l&&l[r]&&(n=!0),n&&(s&&(s+=" "),s+=r)}s.length||(s=null),a.attr("class",s)}}),((t,r)=>{let{blob_cache:n}=r;if(n){let r=t=>{let r=t.attr("src");t.attr("src")===tB.transparentSrc||L(t.attr("data-mce-placeholder"))||L(t.attr("data-mce-bogus"))||P(r)||pc(n,r,!0).each(r=>{t.attr("src",r.blobUri())})};t.addAttributeFilter("src",t=>el(t,r))}})(t,r)};function pm(t){return(pm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pf(t,r){return(pf=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function pg(t,r,n){return(pg=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}()?function(t,r,n){var o=[null];o.push.apply(o,r);var a=new(Function.bind.apply(t,o));return n&&pf(a,n.prototype),a}:Reflect.construct).apply(null,arguments)}function pp(t){return function(t){if(Array.isArray(t))return ph(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,r){if(t){if("string"==typeof t)return ph(t,void 0);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ph(t,void 0):void 0}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ph(t,r){(null==r||r>t.length)&&(r=t.length);for(var n=0,o=Array(r);n<r;n++)o[n]=t[n];return o}var pb=Object.hasOwnProperty,pv=Object.setPrototypeOf,py=Object.isFrozen,pC=Object.getPrototypeOf,pw=Object.getOwnPropertyDescriptor,px=Object.freeze,pE=Object.seal,pk=Object.create,pS="undefined"!=typeof Reflect&&Reflect,p_=pS.apply,pN=pS.construct;p_||(p_=function(t,r,n){return t.apply(r,n)}),px||(px=function(t){return t}),pE||(pE=function(t){return t}),pN||(pN=function(t,r){return pg(t,pp(r))});var pR,pA,pO,pT=pj(Array.prototype.forEach),pB=pj(Array.prototype.pop),pD=pj(Array.prototype.push),pP=pj(String.prototype.toLowerCase),pL=pj(String.prototype.match),pF=pj(String.prototype.replace),pM=pj(String.prototype.indexOf),pI=pj(String.prototype.trim),pU=pj(RegExp.prototype.test),pz=(pO=TypeError,function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return pN(pO,r)});function pj(t){return function(r){for(var n=arguments.length,o=Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return p_(t,r,o)}}function pH(t,r){pv&&pv(t,null);for(var n=r.length;n--;){var o=r[n];if("string"==typeof o){var a=pP(o);a!==o&&(py(r)||(r[n]=a),o=a)}t[o]=!0}return t}function p$(t){var r,n=pk(null);for(r in t)p_(pb,t,[r])&&(n[r]=t[r]);return n}function pq(t,r){for(;null!==t;){var n=pw(t,r);if(n){if(n.get)return pj(n.get);if("function"==typeof n.value)return pj(n.value)}t=pC(t)}return function(t){return console.warn("fallback value for",t),null}}var pV=px(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),pW=px(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),pK=px(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),pG=px(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),pY=px(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),pX=px(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),pQ=px(["#text"]),pJ=px(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),pZ=px(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),p0=px(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),p1=px(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),p2=pE(/\{\{[\w\W]*|[\w\W]*\}\}/gm),p3=pE(/<%[\w\W]*|[\w\W]*%>/gm),p8=pE(/^data-[\-\w.\u00B7-\uFFFF]/),p5=pE(/^aria-[\-\w]+$/),p6=pE(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),p9=pE(/^(?:\w+script|data):/i),p4=pE(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),p7=pE(/^html$/i),he=function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,n=function(r){return t(r)};if(n.version="2.3.8",n.removed=[],!r||!r.document||9!==r.document.nodeType)return n.isSupported=!1,n;var o=r.document,a=r.document,l=r.DocumentFragment,i=r.HTMLTemplateElement,s=r.Node,d=r.Element,c=r.NodeFilter,u=r.NamedNodeMap,m=void 0===u?r.NamedNodeMap||r.MozNamedAttrMap:u,f=r.HTMLFormElement,g=r.DOMParser,p=r.trustedTypes,h=d.prototype,b=pq(h,"cloneNode"),v=pq(h,"nextSibling"),y=pq(h,"childNodes"),C=pq(h,"parentNode");if("function"==typeof i){var w=a.createElement("template");w.content&&w.content.ownerDocument&&(a=w.content.ownerDocument)}var x=function(t,r){if("object"!==pm(t)||"function"!=typeof t.createPolicy)return null;var n=null,o="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(o)&&(n=r.currentScript.getAttribute(o));var a="dompurify"+(n?"#"+n:"");try{return t.createPolicy(a,{createHTML:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+a+" could not be created."),null}}(p,o),E=x?x.createHTML(""):"",k=a,S=k.implementation,_=k.createNodeIterator,N=k.createDocumentFragment,R=k.getElementsByTagName,A=o.importNode,O={};try{O=p$(a).documentMode?a.documentMode:{}}catch(t){}var T={};n.isSupported="function"==typeof C&&S&&void 0!==S.createHTMLDocument&&9!==O;var B,D,P=p6,L=null,F=pH({},[].concat(pp(pV),pp(pW),pp(pK),pp(pY),pp(pQ))),M=null,I=pH({},[].concat(pp(pJ),pp(pZ),pp(p0),pp(p1))),U=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),z=null,j=null,H=!0,$=!0,q=!1,V=!1,W=!1,K=!1,G=!1,Y=!1,X=!1,Q=!1,J=!0,Z=!0,ee=!1,et={},er=null,en=pH({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),eo=null,ea=pH({},["audio","video","img","source","image","track"]),el=null,ei=pH({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),es="http://www.w3.org/1998/Math/MathML",ed="http://www.w3.org/2000/svg",ec="http://www.w3.org/1999/xhtml",eu=ec,em=!1,ef=["application/xhtml+xml","text/html"],eg=null,ep=a.createElement("form"),eh=function(t){return t instanceof RegExp||t instanceof Function},eb=function(t){eg&&eg===t||(t&&"object"===pm(t)||(t={}),L="ALLOWED_TAGS"in(t=p$(t))?pH({},t.ALLOWED_TAGS):F,M="ALLOWED_ATTR"in t?pH({},t.ALLOWED_ATTR):I,el="ADD_URI_SAFE_ATTR"in t?pH(p$(ei),t.ADD_URI_SAFE_ATTR):ei,eo="ADD_DATA_URI_TAGS"in t?pH(p$(ea),t.ADD_DATA_URI_TAGS):ea,er="FORBID_CONTENTS"in t?pH({},t.FORBID_CONTENTS):en,z="FORBID_TAGS"in t?pH({},t.FORBID_TAGS):{},j="FORBID_ATTR"in t?pH({},t.FORBID_ATTR):{},et="USE_PROFILES"in t&&t.USE_PROFILES,H=!1!==t.ALLOW_ARIA_ATTR,$=!1!==t.ALLOW_DATA_ATTR,q=t.ALLOW_UNKNOWN_PROTOCOLS||!1,V=t.SAFE_FOR_TEMPLATES||!1,W=t.WHOLE_DOCUMENT||!1,Y=t.RETURN_DOM||!1,X=t.RETURN_DOM_FRAGMENT||!1,Q=t.RETURN_TRUSTED_TYPE||!1,G=t.FORCE_BODY||!1,J=!1!==t.SANITIZE_DOM,Z=!1!==t.KEEP_CONTENT,ee=t.IN_PLACE||!1,P=t.ALLOWED_URI_REGEXP||P,eu=t.NAMESPACE||ec,t.CUSTOM_ELEMENT_HANDLING&&eh(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(U.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&eh(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(U.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(U.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),D="application/xhtml+xml"===(B=B=-1===ef.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE)?function(t){return t}:pP,V&&($=!1),X&&(Y=!0),et&&(L=pH({},pp(pQ)),M=[],!0===et.html&&(pH(L,pV),pH(M,pJ)),!0===et.svg&&(pH(L,pW),pH(M,pZ),pH(M,p1)),!0===et.svgFilters&&(pH(L,pK),pH(M,pZ),pH(M,p1)),!0===et.mathMl&&(pH(L,pY),pH(M,p0),pH(M,p1))),t.ADD_TAGS&&(L===F&&(L=p$(L)),pH(L,t.ADD_TAGS)),t.ADD_ATTR&&(M===I&&(M=p$(M)),pH(M,t.ADD_ATTR)),t.ADD_URI_SAFE_ATTR&&pH(el,t.ADD_URI_SAFE_ATTR),t.FORBID_CONTENTS&&(er===en&&(er=p$(er)),pH(er,t.FORBID_CONTENTS)),Z&&(L["#text"]=!0),W&&pH(L,["html","head","body"]),L.table&&(pH(L,["tbody"]),delete z.tbody),px&&px(t),eg=t)},ev=pH({},["mi","mo","mn","ms","mtext"]),ey=pH({},["foreignobject","desc","title","annotation-xml"]),eC=pH({},["title","style","font","a","script"]),ew=pH({},pW);pH(ew,pK),pH(ew,pG);var ex=pH({},pY);pH(ex,pX);var eE=function(t){pD(n.removed,{element:t});try{t.parentNode.removeChild(t)}catch(r){try{t.outerHTML=E}catch(r){t.remove()}}},ek=function(t,r){try{pD(n.removed,{attribute:r.getAttributeNode(t),from:r})}catch(t){pD(n.removed,{attribute:null,from:r})}if(r.removeAttribute(t),"is"===t&&!M[t]){if(Y||X)try{eE(r)}catch(t){}else try{r.setAttribute(t,"")}catch(t){}}},eS=function(t){if(G)t="<remove></remove>"+t;else{var r,n,o=pL(t,/^[\r\n\t ]+/);n=o&&o[0]}"application/xhtml+xml"===B&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var l=x?x.createHTML(t):t;if(eu===ec)try{r=(new g).parseFromString(l,B)}catch(t){}if(!r||!r.documentElement){r=S.createDocument(eu,"template",null);try{r.documentElement.innerHTML=em?"":l}catch(t){}}var i=r.body||r.documentElement;return t&&n&&i.insertBefore(a.createTextNode(n),i.childNodes[0]||null),eu===ec?R.call(r,W?"html":"body")[0]:W?r.documentElement:i},e_=function(t){return _.call(t.ownerDocument||t,t,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},eN=function(t){return"object"===pm(s)?t instanceof s:t&&"object"===pm(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},eR=function(t,r,o){T[t]&&pT(T[t],function(t){t.call(n,r,o,eg)})},eA=function(t){if(eR("beforeSanitizeElements",t,null),t instanceof f&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof m)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore)||pU(/[\u0080-\uFFFF]/,t.nodeName))return eE(t),!0;var r,o,a,l,i=D(t.nodeName);if(eR("uponSanitizeElement",t,{tagName:i,allowedTags:L}),t.hasChildNodes()&&!eN(t.firstElementChild)&&(!eN(t.content)||!eN(t.content.firstElementChild))&&pU(/<[/\w]/g,t.innerHTML)&&pU(/<[/\w]/g,t.textContent)||"select"===i&&pU(/<template/i,t.innerHTML))return eE(t),!0;if(!L[i]||z[i]){if(!z[i]&&eT(i)&&(U.tagNameCheck instanceof RegExp&&pU(U.tagNameCheck,i)||U.tagNameCheck instanceof Function&&U.tagNameCheck(i)))return!1;if(Z&&!er[i]){var s=C(t)||t.parentNode,c=y(t)||t.childNodes;if(c&&s)for(var u=c.length-1;u>=0;--u)s.insertBefore(b(c[u],!0),v(t))}return eE(t),!0}return!(t instanceof d)||((r=C(t))&&r.tagName||(r={namespaceURI:ec,tagName:"template"}),o=pP(t.tagName),a=pP(r.tagName),t.namespaceURI===ed?r.namespaceURI===ec?"svg"===o:r.namespaceURI===es?"svg"===o&&("annotation-xml"===a||ev[a]):ew[o]:t.namespaceURI===es?r.namespaceURI===ec?"math"===o:r.namespaceURI===ed?"math"===o&&ey[a]:ex[o]:t.namespaceURI===ec&&(r.namespaceURI!==ed||ey[a])&&(r.namespaceURI!==es||ev[a])&&!ex[o]&&(eC[o]||!ew[o]))?("noscript"===i||"noembed"===i)&&pU(/<\/no(script|embed)/i,t.innerHTML)?(eE(t),!0):(V&&3===t.nodeType&&(l=pF(l=t.textContent,p2," "),l=pF(l,p3," "),t.textContent!==l&&(pD(n.removed,{element:t.cloneNode()}),t.textContent=l)),eR("afterSanitizeElements",t,null),!1):(eE(t),!0)},eO=function(t,r,n){if(J&&("id"===r||"name"===r)&&(n in a||n in ep))return!1;if($&&!j[r]&&pU(p8,r));else if(H&&pU(p5,r));else if(!M[r]||j[r]){if(!(eT(t)&&(U.tagNameCheck instanceof RegExp&&pU(U.tagNameCheck,t)||U.tagNameCheck instanceof Function&&U.tagNameCheck(t))&&(U.attributeNameCheck instanceof RegExp&&pU(U.attributeNameCheck,r)||U.attributeNameCheck instanceof Function&&U.attributeNameCheck(r))||"is"===r&&U.allowCustomizedBuiltInElements&&(U.tagNameCheck instanceof RegExp&&pU(U.tagNameCheck,n)||U.tagNameCheck instanceof Function&&U.tagNameCheck(n))))return!1}else if(el[r]);else if(pU(P,pF(n,p4,"")));else if("src"!==r&&"xlink:href"!==r&&"href"!==r||"script"===t||0!==pM(n,"data:")||!eo[t]){if(q&&!pU(p9,pF(n,p4,"")));else if(n)return!1}return!0},eT=function(t){return t.indexOf("-")>0},eB=function(t){eR("beforeSanitizeAttributes",t,null);var r,n,o,a,l=t.attributes;if(l){var i={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:M};for(a=l.length;a--;){var s=r=l[a],d=s.name,c=s.namespaceURI;n="value"===d?r.value:pI(r.value),o=D(d);var u=n;if(i.attrName=o,i.attrValue=n,i.keepAttr=!0,i.forceKeepAttr=void 0,eR("uponSanitizeAttribute",t,i),n=i.attrValue,!i.forceKeepAttr){if(i.keepAttr){if(pU(/\/>/i,n))ek(d,t);else if(V&&(n=pF(n,p2," "),n=pF(n,p3," ")),eO(D(t.nodeName),o,n)){if(n!==u)try{c?t.setAttributeNS(c,d,n):t.setAttribute(d,n)}catch(r){ek(d,t)}}else ek(d,t)}else ek(d,t)}}eR("afterSanitizeAttributes",t,null)}},eD=function t(r){var n,o=e_(r);for(eR("beforeSanitizeShadowDOM",r,null);n=o.nextNode();)eR("uponSanitizeShadowNode",n,null),eA(n)||(n.content instanceof l&&t(n.content),eB(n));eR("afterSanitizeShadowDOM",r,null)};return n.sanitize=function(t,a){if((em=!t)&&(t="<!-->"),"string"!=typeof t&&!eN(t)){if("function"!=typeof t.toString)throw pz("toString is not a function");if("string"!=typeof(t=t.toString()))throw pz("dirty is not a string, aborting")}if(!n.isSupported){if("object"===pm(r.toStaticHTML)||"function"==typeof r.toStaticHTML){if("string"==typeof t)return r.toStaticHTML(t);if(eN(t))return r.toStaticHTML(t.outerHTML)}return t}if(K||eb(a),n.removed=[],"string"==typeof t&&(ee=!1),ee){if(t.nodeName){var i,d,c,u,m,f=D(t.nodeName);if(!L[f]||z[f])throw pz("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof s)1===(d=(i=eS("<!---->")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===d.nodeName||"HTML"===d.nodeName?i=d:i.appendChild(d);else{if(!Y&&!V&&!W&&-1===t.indexOf("<"))return x&&Q?x.createHTML(t):t;if(!(i=eS(t)))return Y?null:Q?E:""}i&&G&&eE(i.firstChild);for(var g=e_(ee?t:i);c=g.nextNode();)3===c.nodeType&&c===u||eA(c)||(c.content instanceof l&&eD(c.content),eB(c),u=c);if(u=null,ee)return t;if(Y){if(X)for(m=N.call(i.ownerDocument);i.firstChild;)m.appendChild(i.firstChild);else m=i;return M.shadowroot&&(m=A.call(o,m,!0)),m}var p=W?i.outerHTML:i.innerHTML;return W&&L["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&pU(p7,i.ownerDocument.doctype.name)&&(p="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+p),V&&(p=pF(p,p2," "),p=pF(p,p3," ")),x&&Q?x.createHTML(p):p},n.setConfig=function(t){eb(t),K=!0},n.clearConfig=function(){eg=null,K=!1},n.isValidAttribute=function(t,r,n){return eg||eb({}),eO(D(t),D(r),n)},n.addHook=function(t,r){"function"==typeof r&&(T[t]=T[t]||[],pD(T[t],r))},n.removeHook=function(t){if(T[t])return pB(T[t])},n.removeHooks=function(t){T[t]&&(T[t]=[])},n.removeAllHooks=function(){T={}},n}();let ht=tF.each,hr=tF.trim,hn=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],ho={ftp:21,http:80,https:443,mailto:25},ha=["img","video"],hl=(t,r,n)=>{let o;let a=(t=>{try{return decodeURIComponent(t)}catch(r){return unescape(t)}})(r).replace(/\s/g,"");return!t.allow_script_urls&&(!!/((java|vb)script|mhtml):/i.test(a)||!t.allow_html_data_urls&&(/^data:image\//i.test(a)?(L(o=t.allow_svg_data_urls)?!o:!L(n)||!en(ha,n))&&/^data:image\/svg\+xml/i.test(a):/^data:/i.test(a)))};class hi{static parseDataUri(t){let r;let n=decodeURIComponent(t).split(","),o=/data:([^;]+)/.exec(n[0]);return o&&(r=o[1]),{type:r,data:n[1]}}static isDomSafe(t,r,n={}){return!!n.allow_script_urls||!hl(n,at.decode(t).replace(/[\s\u0000-\u001F]+/g,""),r)}static getDocumentBaseUrl(t){var r;let n;return n=0!==t.protocol.indexOf("http")&&"file:"!==t.protocol?null!==(r=t.href)&&void 0!==r?r:"":t.protocol+"//"+t.host+t.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(n)&&(n=n.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(n)||(n+="/")),n}constructor(t,r={}){this.path="",this.directory="",t=hr(t),this.settings=r;let n=r.base_uri,o=this;if(/^([\w\-]+):([^\/]{2})/i.test(t)||/^\s*#/.test(t))return void(o.source=t);let a=0===t.indexOf("//");if(0!==t.indexOf("/")||a||(t=(n&&n.protocol||"http")+"://mce_host"+t),!/^[\w\-]*:?\/\//.test(t)){let r=n?n.path:new hi(document.location.href).directory;if(""===(null==n?void 0:n.protocol))t="//mce_host"+o.toAbsPath(r,t);else{let a=/([^#?]*)([#?]?.*)/.exec(t);a&&(t=(n&&n.protocol||"http")+"://mce_host"+o.toAbsPath(r,a[1])+a[2])}}t=t.replace(/@@/g,"(mce_at)");let l=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);l&&ht(hn,(t,r)=>{let n=l[r];n&&(n=n.replace(/\(mce_at\)/g,"@@")),o[t]=n}),n&&(o.protocol||(o.protocol=n.protocol),o.userInfo||(o.userInfo=n.userInfo),o.port||"mce_host"!==o.host||(o.port=n.port),o.host&&"mce_host"!==o.host||(o.host=n.host),o.source=""),a&&(o.protocol="")}setPath(t){let r=/^(.*?)\/?(\w+)?$/.exec(t);r&&(this.path=r[0],this.directory=r[1],this.file=r[2]),this.source="",this.getURI()}toRelative(t){if("./"===t)return t;let r=new hi(t,{base_uri:this});if("mce_host"!==r.host&&this.host!==r.host&&r.host||this.port!==r.port||this.protocol!==r.protocol&&""!==r.protocol)return r.getURI();let n=this.getURI(),o=r.getURI();if(n===o||"/"===n.charAt(n.length-1)&&n.substr(0,n.length-1)===o)return n;let a=this.toRelPath(this.path,r.path);return r.query&&(a+="?"+r.query),r.anchor&&(a+="#"+r.anchor),a}toAbsolute(t,r){let n=new hi(t,{base_uri:this});return n.getURI(r&&this.isSameOrigin(n))}isSameOrigin(t){if(this.host==t.host&&this.protocol==t.protocol){if(this.port==t.port)return!0;let r=this.protocol?ho[this.protocol]:null;if(r&&(this.port||r)==(t.port||r))return!0}return!1}toRelPath(t,r){let n,o,a=0,l="",i=t.substring(0,t.lastIndexOf("/")).split("/"),s=r.split("/");if(i.length>=s.length){for(n=0,o=i.length;n<o;n++)if(n>=s.length||i[n]!==s[n]){a=n+1;break}}if(i.length<s.length){for(n=0,o=s.length;n<o;n++)if(n>=i.length||i[n]!==s[n]){a=n+1;break}}if(1===a)return r;for(n=0,o=i.length-(a-1);n<o;n++)l+="../";for(n=a-1,o=s.length;n<o;n++)l+=n!==a-1?"/"+s[n]:s[n];return l}toAbsPath(t,r){let n,o=0,a=/\/$/.test(r)?"/":"",l=t.split("/"),i=r.split("/"),s=[];ht(l,t=>{t&&s.push(t)});let d=[];for(let t=i.length-1;t>=0;t--)0!==i[t].length&&"."!==i[t]&&(".."!==i[t]?o>0?o--:d.push(i[t]):o++);let c=s.length-o;return 0!==(n=c<=0?ev(d).join("/"):s.slice(0,c).join("/")+"/"+ev(d).join("/")).indexOf("/")&&(n="/"+n),a&&n.lastIndexOf("/")!==n.length-1&&(n+=a),n}getURI(t=!1){let r;return this.source&&!t||(r="",t||(this.protocol?r+=this.protocol+"://":r+="//",this.userInfo&&(r+=this.userInfo+"@"),this.host&&(r+=this.host),this.port&&(r+=":"+this.port)),this.path&&(r+=this.path),this.query&&(r+="?"+this.query),this.anchor&&(r+="#"+this.anchor),this.source=r),this.source}}let hs=tF.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),hd="data-mce-type",hc=0,hu=(t,r,n,o)=>{var a,l,i,s;let d=r.validate,c=n.getSpecialElements();8===t.nodeType&&!r.allow_conditional_comments&&/^\[if/i.test(null!==(a=t.nodeValue)&&void 0!==a?a:"")&&(t.nodeValue=" "+t.nodeValue);let u=null!==(l=null==o?void 0:o.tagName)&&void 0!==l?l:t.nodeName.toLowerCase();if(1!==t.nodeType||"body"===u)return;let m=ri(t),f=t5(m,hd),g=t3(m,"data-mce-bogus");if(!f&&N(g))return void("all"===g?nt(m):nr(m));let p=n.getElementRule(u);if(!d||p){if(L(o)&&(o.allowedTags[u]=!0),d&&p&&!f){if(el(null!==(i=p.attributesForced)&&void 0!==i?i:[],t=>{t1(m,t.name,"{$uid}"===t.value?"mce_"+hc++:t.value)}),el(null!==(s=p.attributesDefault)&&void 0!==s?s:[],t=>{t5(m,t.name)||t1(m,t.name,"{$uid}"===t.value?"mce_"+hc++:t.value)}),p.attributesRequired&&!eo(p.attributesRequired,t=>t5(m,t))||p.removeEmptyAttrs&&(t=>{let r=t.dom.attributes;return null==r||0===r.length})(m))return void nr(m);p.outputName&&p.outputName!==u&&((t,r)=>{let n=((t,r)=>{let n=rd(r);return t2(n,t9(t)),n})(t,r);r5(t,n),r7(n,rN(t)),nt(t)})(m,p.outputName)}}else eI(c,u)?nt(m):nr(m)},hm=(t,r,n,o,a)=>!(o in hs&&hl(t,a,n))&&(!t.validate||r.isValid(n,o)||e3(o,"data-")||e3(o,"aria-")),hf=(t,r)=>t.hasAttribute(hd)&&("id"===r||"class"===r||"style"===r),hg=(t,r)=>t in r.getBoolAttrs(),hp=(t,r,n)=>{let{attributes:o}=t;for(let a=o.length-1;a>=0;a--){let l=o[a],i=l.name,s=l.value;hm(r,n,t.tagName.toLowerCase(),i,s)||hf(t,i)?hg(i,n)&&t.setAttribute(i,i):t.removeAttribute(i)}},hh=(t,r)=>{let n=he();return n.addHook("uponSanitizeElement",(n,o)=>{hu(n,t,r,o)}),n.addHook("uponSanitizeAttribute",(n,o)=>{let a=n.tagName.toLowerCase(),{attrName:l,attrValue:i}=o;o.keepAttr=hm(t,r,a,l,i),o.keepAttr?(o.allowedAttributes[l]=!0,hg(l,r)&&(o.attrValue=l),t.allow_svg_data_urls&&e3(i,"data:image/svg+xml")&&(o.forceKeepAttr=!0)):hf(n,l)&&(o.forceKeepAttr=!0)}),n},hb=tF.makeMap,hv=tF.extend,hy=(t,r,n)=>{let o=t.name,a=o in n&&"title"!==o&&"textarea"!==o,l=r.childNodes;for(let r=0,o=l.length;r<o;r++){let o=l[r],i=new u0(o.nodeName.toLowerCase(),o.nodeType);if(nx(o)){let t=o.attributes;for(let r=0,n=t.length;r<n;r++){let n=t[r];i.attr(n.name,n.value)}}else nT(o)?(i.value=o.data,a&&(i.raw=!0)):(nP(o)||nB(o)||nD(o))&&(i.value=o.data);hy(i,o,n),t.append(i)}},hC=(t={},r=am())=>{let n=pt(),o=pt(),a={validate:!0,root_name:"body",sanitize:!0,...t},l=new DOMParser,i=((t,r)=>{if(t.sanitize){let n=hh(t,r);return(r,o)=>{n.sanitize(r,((t,r)=>{let n={IN_PLACE:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ALLOWED_TAGS:["#comment","#cdata-section","body"],ALLOWED_ATTR:[]};return n.PARSER_MEDIA_TYPE=r,t.allow_script_urls?n.ALLOWED_URI_REGEXP=/.*/:t.allow_html_data_urls&&(n.ALLOWED_URI_REGEXP=/^(?!(\w+script|mhtml):)/i),n})(t,o)),n.removed=[]}}return(n,o)=>{let a;let l=document.createNodeIterator(n,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT);for(;a=l.nextNode();)hu(a,t,r),nx(a)&&hp(a,t,r)}})(a,r),s=n.addFilter,d=n.getFilters,c=n.removeFilter,u=o.addFilter,m=o.getFilters,f=o.removeFilter,g=(t,n)=>{let o=N(n.attr(hd)),a=1===n.type&&!eI(t,n.name)&&!o$(r,n);return 3===n.type||a&&!o},p={schema:r,addAttributeFilter:u,getAttributeFilters:m,removeAttributeFilter:f,addNodeFilter:s,getNodeFilters:d,removeNodeFilter:c,parse:(t,n={})=>{var o;let s=a.validate,c=null!==(o=n.context)&&void 0!==o?o:a.root_name,u=((t,n,o="html")=>{let a="xhtml"===o?"application/xhtml+xml":"text/html",s=eI(r.getSpecialElements(),n.toLowerCase()),d=s?`<${n}>${t}</${n}>`:t,c="xhtml"===o?`<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>${d}</body></html>`:`<body>${d}</body>`,u=l.parseFromString(c,a).body;return i(u,a),s?u.firstChild:u})(t,c,n.format);oF(r,u);let f=new u0(c,11);hy(f,u,r.getSpecialElements()),u.innerHTML="";let[p,h]=((t,r,n,o)=>{let a=n.validate,l=r.getNonEmptyElements(),i=r.getWhitespaceElements(),s=hv(hb("script,style,head,html,body,title,meta,param"),r.getBlockElements()),d=ac(r),c=/[ \t\r\n]+/g,u=/^[ \t\r\n]+/,m=/[ \t\r\n]+$/,f=t=>{let r=t.parent;for(;L(r);){if(r.name in i)return!0;r=r.parent}return!1},g=t=>t.name in s||o$(r,t),p=(r,n)=>!L(n?r.prev:r.next)&&!P(r.parent)&&g(r.parent)&&(r.parent!==t||!0===o.isRootContent);return[t=>{var r;if(3===t.type&&!f(t)){let n,o=null!==(r=t.value)&&void 0!==r?r:"";o=o.replace(c," "),(L(n=t.prev)&&(g(n)||"br"===n.name)||p(t,!0))&&(o=o.replace(u,"")),0===o.length?t.remove():t.value=o}},t=>{var s,c;if(1===t.type){let s=r.getElementRule(t.name);if(a&&s){let a=fX(r,l,i,t);s.paddInEmptyBlock&&a&&(t=>{let n=t;for(;L(n);){if(n.name in d)return fX(r,l,i,n);n=n.parent}return!1})(t)?fG(n,o,g,t):s.removeEmpty&&a?g(t)?t.remove():t.unwrap():s.paddEmpty&&(a||fY(t,"#text")&&(null===(c=null==t?void 0:t.firstChild)||void 0===c?void 0:c.value)==="\xa0")&&fG(n,o,g,t)}}else if(3===t.type&&!f(t)){let r=null!==(s=t.value)&&void 0!==s?s:"";(t.next&&g(t.next)||p(t,!1))&&(r=r.replace(m,"")),0===r.length?t.remove():t.value=r}}]})(f,r,a,n),b=[],v={nodes:{},attributes:{}},y=t=>fV(d(),m(),t,v);if(((t,r,n)=>{let o=[];for(let n=t,a=n;n;a=n,n=n.walk()){let l=n;el(r,t=>t(l)),P(l.parent)&&l!==t?n=a:o.push(l)}for(let t=o.length-1;t>=0;t--){let r=o[t];el(n,t=>t(r))}})(f,[p,y],[h,s?t=>{f0(r,t)&&b.push(t)}:U]),b.reverse(),s&&b.length>0){if(n.context){let{pass:t,fail:o}=es(b,t=>t.parent===f);fZ(o,r,f,y),n.invalid=t.length>0}else fZ(b,r,f,y)}let C=((t,r)=>{var n;let o=null!==(n=r.forced_root_block)&&void 0!==n?n:t.forced_root_block;return!1===o?"":!0===o?"p":o})(a,n);return C&&("body"===f.name||n.isRootContent)&&((t,n)=>{let o=hv(hb("script,style,head,html,body,title,meta,param"),r.getBlockElements()),l=/^[ \t\r\n]+/,i=/[ \t\r\n]+$/,s=t.firstChild,d=null,c=t=>{var r,n;t&&((s=t.firstChild)&&3===s.type&&(s.value=null===(r=s.value)||void 0===r?void 0:r.replace(l,"")),(s=t.lastChild)&&3===s.type&&(s.value=null===(n=s.value)||void 0===n?void 0:n.replace(i,"")))};if(r.isValidChild(t.name,n.toLowerCase())){for(;s;){let r=s.next;g(o,s)?(d||((d=new u0(n,1)).attr(a.forced_root_block_attrs),t.insert(d,s)),d.append(s)):(c(d),d=null),s=r}c(d)}})(f,C),n.invalid||fW(v,n),f}};return pu(p,a),a.inline_styles&&pr(p,a,r),p},hw=(t,r,n)=>{let o=f7(t)?mr({validate:!1}).serialize(t):t,a=r(o);if(a.isDefaultPrevented())return a;if(f7(t)){if(a.content!==o){let r=hC({validate:!1,forced_root_block:!1,sanitize:n}).parse(a.content,{context:t.name});return{...a,content:r}}return{...a,content:t}}return a},hx=(t,r)=>{if(r.no_events)return lj.value(r);{let n=t.dispatch("BeforeGetContent",r);return n.isDefaultPrevented()?lj.error(c_(t,{content:"",...n}).content):lj.value(n)}},hE=(t,r,n)=>n.no_events?r:hw(r,r=>c_(t,{...n,content:r}),sw(t)).content,hk=(t,r)=>{if(r.no_events)return lj.value(r);{let n=hw(r.content,n=>{let o;return o={...r,content:n},t.dispatch("BeforeSetContent",o)},sw(t));return n.isDefaultPrevented()?(cS(t,n),lj.error(void 0)):lj.value(n)}},hS=(t,r,n)=>{n.no_events||cS(t,{...n,content:r})},h_=(t,r,n)=>({element:t,width:r,rows:n}),hN=(t,r)=>({element:t,cells:r}),hR=(t,r)=>({x:t,y:r}),hA=(t,r)=>t8(t,r).bind(tt).getOr(1),hO=(t,r,n)=>{let o=t.rows;return!!(o[n]?o[n].cells:[])[r]},hT=t=>eu(t,(t,r)=>r.cells.length>t?r.cells.length:t,0),hB=(t,r)=>{let n=t.rows;for(let t=0;t<n.length;t++){let o=n[t].cells;for(let n=0;n<o.length;n++)if(rp(o[n],r))return J.some(hR(n,t))}return J.none()},hD=(t,r,n,o,a)=>{let l=[],i=t.rows;for(let t=n;t<=a;t++){let n=i[t].cells,a=r<o?n.slice(r,o+1):n.slice(o,r+1);l.push(hN(i[t].element,a))}return l},hP=t=>((t,r)=>{let n=a5(t.element),o=rd("tbody");return r7(o,r),r9(n,o),n})(t,ea(t.rows,t=>{let r=ea(t.cells,t=>{let r=a6(t);return t6(r,"colspan"),t6(r,"rowspan"),r}),n=a5(t.element);return r7(n,r),n})),hL=(t,r)=>{let n=ri(r.commonAncestorContainer),o=mE(n,t),a=ed(o,n7),l=ef(o,t=>"li"===tV(t)&&dj(t,r)).fold(H([]),t=>ef(o,t=>"ul"===tV(t)||"ol"===tV(t)).map(t=>{let r=rd(tV(t));return rJ(r,eP(r2(t),(t,r)=>e3(r,"list-style"))),[rd("li"),r]}).getOr([]));return ea(a.concat(l.length?l:n8(n)?rC(n).filter(n3).fold(H([]),t=>[n,t]):n3(n)?[n]:[]),a5)},hF=()=>cK([]),hM=(t,r)=>rq(r[0],"table",V(rp,t)).bind(t=>{let n;let o=r[0],a=r[r.length-1];return hB(n=(t=>{let r=h_(a5(t),0,[]);return el(nb(t,"tr"),(t,n)=>{el(nb(t,"td,th"),(o,a)=>{((t,r,n,o,a)=>{let l=hA(a,"rowspan"),i=hA(a,"colspan"),s=t.rows;for(let t=n;t<n+l;t++){s[t]||(s[t]=hN(a6(o),[]));for(let o=r;o<r+i;o++)s[t].cells[o]=t===n&&o===r?a:a5(a)}})(r,((t,r,n)=>{for(;hO(t,r,n);)r++;return r})(r,a,n),n,t,o)})}),h_(r.element,hT(r.rows),r.rows)})(t),o).bind(t=>hB(n,a).map(r=>((t,r,n)=>{let o=r.x,a=r.y,l=n.x,i=n.y,s=a<i?hD(t,o,a,l,i):hD(t,o,i,l,a);return h_(t.element,hT(s),s)})(n,t,r))).map(t=>cK([hP(t)]))}).getOrThunk(hF),hI=(t,r)=>{let n;let o=dF(r,t);return o.length>0?hM(t,o):r.length>0&&r[0].collapsed?hF():((t,r)=>{let n=eu(r,(t,r)=>(r9(r,t),r),t);return r.length>0?cK([n]):n})(ri((n=r[0]).cloneContents()),hL(t,n))},hU=(t,r)=>r>=0&&r<t.length&&d_(t.charAt(r)),hz=t=>on(t.innerText),hj=t=>nx(t)?t.outerHTML:nT(t)?at.encodeRaw(t.data,!1):nP(t)?"<!--"+t.data+"-->":"",hH=(t,r)=>{var n;let o;return n=((t,r)=>{let n=t.length+r.length+2,o=Array(n),a=Array(n),l=(n,o,a,i,d)=>{let c=s(n,o,a,i);if(null===c||c.start===o&&c.diag===o-i||c.end===n&&c.diag===n-a){let l=n,s=a;for(;l<o||s<i;)l<o&&s<i&&t[l]===r[s]?(d.push([0,t[l]]),++l,++s):o-n>i-a?(d.push([2,t[l]]),++l):(d.push([1,r[s]]),++s)}else{l(n,c.start,a,c.start-c.diag,d);for(let r=c.start;r<c.end;++r)d.push([0,t[r]]);l(c.end,o,c.end-c.diag,i,d)}},i=(n,o,a,l)=>{let i=n;for(;i-o<l&&i<a&&t[i]===r[i-o];)++i;return{start:n,end:i,diag:o}},s=(n,l,s,d)=>{let c,u,m,f,g;let p=l-n,h=d-s;if(0===p||0===h)return null;let b=p-h,v=h+p,y=(v%2==0?v:v+1)/2;for(o[1+y]=n,a[1+y]=l+1,c=0;c<=y;++c){for(u=-c;u<=c;u+=2){for(m=u+y,u===-c||u!==c&&o[m-1]<o[m+1]?o[m]=o[m+1]:o[m]=o[m-1]+1,g=(f=o[m])-n+s-u;f<l&&g<d&&t[f]===r[g];)o[m]=++f,++g;if(b%2!=0&&b-c<=u&&u<=b+c&&a[m-b]<=o[m])return i(a[m-b],u+n-s,l,d)}for(u=b-c;u<=b+c;u+=2){for(m=u+y-b,u===b-c||u!==b+c&&a[m+1]<=a[m-1]?a[m]=a[m+1]-1:a[m]=a[m-1],g=(f=a[m]-1)-n+s-u;f>=n&&g>=s&&t[f]===r[g];)a[m]=f--,g--;if(b%2==0&&-c<=u&&u<=c&&a[m]<=o[m+b])return i(a[m],u+n-s,l,d)}}return null},d=[];return l(0,t.length,0,r.length,d),d})(ea(eS(r.childNodes),hj),t),o=0,el(n,t=>{0===t[0]?o++:1===t[0]?(((t,r,n)=>{let o=(t=>{let r;let n=document.createElement("div"),o=document.createDocumentFragment();for(t&&(n.innerHTML=t);r=n.firstChild;)o.appendChild(r);return o})(r);if(t.hasChildNodes()&&n<t.childNodes.length){let r=t.childNodes[n];t.insertBefore(o,r)}else t.appendChild(o)})(r,t[1],o),o++):2===t[0]&&((t,r)=>{if(t.hasChildNodes()&&r<t.childNodes.length){let n=t.childNodes[r];t.removeChild(n)}})(r,o)}),r},h$=eY(()=>document.implementation.createHTMLDocument("undo")),hq=t=>{let r=t.serializer.getTempAttrs(),n=u6(t.getBody(),r);return null!==n.querySelector("iframe")?{type:"fragmented",fragments:ed(ea(eS(n.childNodes),z(on,hj)),t=>t.length>0),content:"",bookmark:null,beforeBookmark:null}:{type:"complete",fragments:null,content:on(n.innerHTML),bookmark:null,beforeBookmark:null}},hV=(t,r,n)=>{let o=n?r.beforeBookmark:r.bookmark;"fragmented"===r.type?hH(r.fragments,t.getBody()):t.setContent(r.content,{format:"raw",no_selection:!L(o)||!dg(o)||!o.isFakeCaret}),o&&(t.selection.moveToBookmark(o),t.selection.scrollIntoView())},hW=t=>"fragmented"===t.type?t.fragments.join(""):t.content,hK=t=>{let r=rd("body",h$());return na(r,hW(t)),el(nb(r,"*[data-mce-bogus]"),nr),no(r)},hG=(t,r)=>!(!t||!r)&&(hW(t)===hW(r)||hK(t)===hK(r)),hY=t=>0===t.get(),hX=(t,r,n)=>{hY(n)&&(t.typing=r)},hQ=(t,r)=>{t.typing&&(hX(t,!1,r),t.add())},hJ=t=>({init:{bindEvents:U},undoManager:{beforeChange:(r,n)=>{hY(r)&&n.set(lz(t.selection))},add:(r,n,o,a,l,i)=>((t,r,n,o,a,l,i)=>{let s=hq(t),d=tF.extend(l||{},s);if(!hY(o)||t.removed)return null;let c=r.data[n.get()];if(t.dispatch("BeforeAddUndo",{level:d,lastLevel:c,originalEvent:i}).isDefaultPrevented()||c&&hG(c,d))return null;r.data[n.get()]&&a.get().each(t=>{r.data[n.get()].beforeBookmark=t});let u=iG(t);if(u&&r.data.length>u){for(let t=0;t<r.data.length-1;t++)r.data[t]=r.data[t+1];r.data.length--,n.set(r.data.length)}d.bookmark=lz(t.selection),n.get()<r.data.length-1&&(r.data.length=n.get()+1),r.data.push(d),n.set(r.data.length-1);let m={level:d,lastLevel:c,originalEvent:i};return n.get()>0?(t.setDirty(!0),t.dispatch("AddUndo",m),t.dispatch("change",m)):t.dispatch("AddUndo",m),d})(t,r,n,o,a,l,i),undo:(r,n,o)=>{let a;return r.typing&&(r.add(),r.typing=!1,hX(r,!1,n)),o.get()>0&&(o.set(o.get()-1),hV(t,a=r.data[o.get()],!0),t.setDirty(!0),t.dispatch("Undo",{level:a})),a},redo:(r,n)=>{let o;return r.get()<n.length-1&&(r.set(r.get()+1),hV(t,o=n[r.get()],!1),t.setDirty(!0),t.dispatch("Redo",{level:o})),o},clear:(r,n)=>{r.data=[],n.set(0),r.typing=!1,t.dispatch("ClearUndos")},reset:t=>{t.clear(),t.add()},hasUndo:(r,n)=>n.get()>0||r.typing&&r.data[0]&&!hG(hq(t),r.data[0]),hasRedo:(t,r)=>r.get()<t.data.length-1&&!t.typing,transact:(t,r,n)=>(hQ(t,r),t.beforeChange(),t.ignore(n),t.add()),ignore:(t,r)=>((t,r)=>{try{t.set(t.get()+1),r()}finally{t.set(t.get()-1)}})(t,r),extra:(r,n,o,a)=>((t,r,n,o,a)=>{if(r.transact(o)){let o=r.data[n.get()].bookmark;hV(t,r.data[n.get()-1],!0),r.transact(a)&&(r.data[n.get()-1].beforeBookmark=o)}})(t,r,n,o,a)},formatter:{match:(r,n,o,a)=>gd(t,r,n,o,a),matchAll:(r,n)=>((t,r,n)=>{let o=[],a={},l=t.selection.getStart();return t.dom.getParent(l,l=>{for(let i=0;i<r.length;i++){let s=r[i];!a[s]&&gs(t,l,s,n)&&(a[s]=!0,o.push(s))}},t.dom.getRoot()),o})(t,r,n),matchNode:(r,n,o,a)=>gs(t,r,n,o,a),canApply:r=>((t,r)=>{let n=t.formatter.get(r),o=t.dom;if(n&&t.selection.isEditable()){let r=d9(o,t.selection.getStart());for(let t=n.length-1;t>=0;t--){let a=n[t];if(!ce(a))return!0;for(let t=r.length-1;t>=0;t--)if(o.is(r[t],a.selector))return!0}}return!1})(t,r),closest:r=>((t,r)=>{let n=r=>rp(r,ri(t.getBody()));return J.from(t.selection.getStart(!0)).bind(o=>gn(ri(o),n=>e_(r,r=>gs(t,n.dom,r)?J.some(r):J.none()),n)).getOrNull()})(t,r),apply:(r,n,o)=>g8(t,r,n,o),remove:(r,n,o,a)=>gJ(t,r,n,o,a),toggle:(r,n,o)=>((t,r,n,o)=>{let a=t.formatter.get(r);a&&(!gd(t,r,n,o)||"toggle"in a[0]&&!a[0].toggle?g8(t,r,n,o):gJ(t,r,n,o))})(t,r,n,o),formatChanged:(r,n,o,a,l)=>(((t,r,n,o,a,l)=>{let i=r.get();el(n.split(","),r=>{let n=eM(i,r).getOrThunk(()=>{let t={withSimilar:{state:aL(!1),similar:!0,callbacks:[]},withoutSimilar:{state:aL(!1),similar:!1,callbacks:[]},withVars:[]};return i[r]=t,t}),s=()=>{let n=g4(t);return g9(t,n,r,a,l).isSome()};if(D(l)){let t=a?n.withSimilar:n.withoutSimilar;t.callbacks.push(o),1===t.callbacks.length&&t.state.set(s())}else n.withVars.push({state:aL(s()),similar:a,vars:l,callback:o})}),r.set(i)})(t,r,n,o,a,l),{unbind:()=>((t,r,n)=>{let o=t.get();el(r.split(","),t=>eM(o,t).each(r=>{o[t]={withSimilar:{...r.withSimilar,callbacks:ed(r.withSimilar.callbacks,t=>t!==n)},withoutSimilar:{...r.withoutSimilar,callbacks:ed(r.withoutSimilar.callbacks,t=>t!==n)},withVars:ed(r.withVars,t=>t.callback!==n)}})),t.set(o)})(r,n,o)})},editor:{getContent:r=>J.from(t.getBody()).fold(H("tree"===r.format?new u0("body",11):""),n=>u7(t,r,n)),setContent:(r,n)=>J.from(t.getBody()).map(o=>f7(r)?((t,r,n,o)=>{fK(t.parser.getNodeFilters(),t.parser.getAttributeFilters(),n);let a=mr({validate:!1},t.schema).serialize(n),l=n9(ri(r))?a:tF.trim(a);return ge(t,l,o.no_selection),{content:n,html:l}})(t,o,r,n):((t,r,n,o)=>{if(0===n.length||/^\s+$/.test(n)){let a='<br data-mce-bogus="1">';"TABLE"===r.nodeName?n="<tr><td>"+a+"</td></tr>":/^(UL|OL)$/.test(r.nodeName)&&(n="<li>"+a+"</li>");let l=l7(t);return t.schema.isValidChild(r.nodeName.toLowerCase(),l.toLowerCase())?(n=a,n=t.dom.createHTML(l,ie(t),n)):n||(n=a),ge(t,n,o.no_selection),{content:n,html:n}}{"raw"!==o.format&&(n=mr({validate:!1},t.schema).serialize(t.parser.parse(n,{isRootContent:!0,insert:!0})));let a=n9(ri(r))?n:tF.trim(n);return ge(t,a,o.no_selection),{content:a,html:a}}})(t,o,r,n)).getOr({content:r,html:f7(n.content)?"":n.content}),insertContent:(r,n)=>f4(t,r,n),addVisual:r=>((t,r)=>{let n=t.dom,o=L(r)?r:t.getBody();el(n.select("table,a",o),r=>{switch(r.nodeName){case"TABLE":let o=i3(t),a=n.getAttrib(r,"border");a&&"0"!==a||!t.hasVisual?n.removeClass(r,o):n.addClass(r,o);break;case"A":if(!n.getAttrib(r,"href")){let o=n.getAttrib(r,"name")||r.id,a=i8(t);o&&t.hasVisual?n.addClass(r,a):n.removeClass(r,a)}}}),t.dispatch("VisualAid",{element:r,hasVisual:t.hasVisual})})(t,r)},selection:{getContent:(r,n)=>((t,r,n={})=>hx(t,{...n,format:r,get:!0,selection:!0,getInner:!0}).fold($,r=>{let n=((t,r)=>{if("text"===r.format)return J.from(t.selection.getRng()).map(r=>{var n;let o=J.from(t.dom.getParent(r.commonAncestorContainer,t.dom.isBlock)),a=t.getBody(),l=o.map(t=>t.nodeName).getOr("div").toLowerCase(),i=ri(r.cloneContents());u9(i),u4(i);let s=t.dom.add(a,l,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},i.dom),d=hz(s),c=on(null!==(n=s.textContent)&&void 0!==n?n:"");if(t.dom.remove(s),hU(c,0)||hU(c,c.length-1)){let t=hz(o.getOr(a)),r=t.indexOf(d);return -1===r?d:(hU(t,r-1)?" ":"")+d+(hU(t,r+d.length)?" ":"")}return d}).getOr("");{let n=((t,r)=>{let n=t.selection.getRng(),o=t.dom.create("body"),a=t.selection.getSel(),l=uq(t,dL(a)),i=r.contextual?hI(ri(t.getBody()),l).dom:n.cloneContents();return i&&o.appendChild(i),t.selection.serializer.serialize(o,r)})(t,r);return"tree"===r.format?n:t.selection.isCollapsed()?"":n}})(t,r);return hE(t,n,r)}))(t,r,n)},autocompleter:{addDecoration:r=>uG(t,r),removeDecoration:()=>uY(ri(t.getBody())).each(r=>{let n=t.selection.getBookmark();nr(r),t.selection.moveToBookmark(n)})},raw:{getModel:()=>J.none()}}),hZ=t=>eI(t.plugins,"rtc"),h0=t=>t.rtcInstance?t.rtcInstance:hJ(t),h1=t=>{let r=t.rtcInstance;if(r)return r;throw Error("Failed to get RTC instance not yet initialized.")},h2=t=>h1(t).init.bindEvents(),h3=t=>0===t.dom.length?(nt(t),J.none()):J.some(t),h8=(t,r,n,o)=>{t.bind(t=>((o?m1:m0)(t.dom,o?t.dom.length:0),r.filter(tX).map(r=>((t,r,n,o)=>{let a=t.dom,l=r.dom,i=o?a.length:l.length;o?(m2(a,l,!1,!o),n.setStart(l,i)):(m2(l,a,!1,!o),n.setEnd(l,i))})(t,r,n,o)))).orThunk(()=>r.filter(t=>cC.isBookmarkNode(t.dom)).bind(o?rk:rE).or(r).filter(tX).map(t=>((t,r)=>{rC(t).each(n=>{let o=t.dom;r&&mV(n,lx(o,0))?m0(o,0):!r&&mW(n,lx(o,o.length))&&m1(o,o.length)})})(t,o)))},h5=(t,r,n)=>{if(eI(t,r)){let o=ed(t[r],t=>t!==n);0===o.length?delete t[r]:t[r]=o}},h6=t=>!(!t||!t.ownerDocument)&&rh(ri(t.ownerDocument),ri(t)),h9=(t,r,n,o)=>{let a,l;let{selectorChangedWithUnbind:i}=((t,r)=>{let n,o;let a=(r,n)=>ef(n,n=>t.is(n,r)),l=r=>t.getParents(r,void 0,t.getRoot());return{selectorChangedWithUnbind:(t,i)=>(n||(n={},o={},r.on("NodeChange",t=>{let r=t.element,i=l(r),s={};eA(n,(t,r)=>{a(r,i).each(n=>{o[r]||(el(t,t=>{t(!0,{node:n,selector:r,parents:i})}),o[r]=t),s[r]=t})}),eA(o,(t,n)=>{s[n]||(delete o[n],el(t,t=>{t(!1,{node:r,selector:n,parents:i})}))})})),n[t]||(n[t]=[]),n[t].push(i),a(t,l(r.selection.getStart())).each(()=>{o[t]=n[t]}),{unbind:()=>{h5(n,t,i),h5(o,t,i)}})}})(t,o),s=(t,r)=>((t,r,n={})=>{hk(t,{format:"html",...n,set:!0,selection:!0,content:r}).each(r=>{let n=((t,r)=>{if("raw"!==r.format){let n=t.selection.getRng(),o=t.dom.getParent(n.commonAncestorContainer,t.dom.isBlock),a=o?{context:o.nodeName.toLowerCase()}:{},l=t.parser.parse(r.content,{forced_root_block:!1,...a,...r});return mr({validate:!1},t.schema).serialize(l)}return r.content})(t,r),o=t.selection.getRng();((t,r)=>{let n=J.from(r.firstChild).map(ri),o=J.from(r.lastChild).map(ri);t.deleteContents(),t.insertNode(r);let a=n.bind(rE).filter(tX).bind(h3),l=o.bind(rk).filter(tX).bind(h3);h8(a,n,t,!0),h8(l,o,t,!1),t.collapse(!1)})(o,o.createContextualFragment(n)),t.selection.setRng(o),uh(t,o),hS(t,n,r)})})(o,t,r),d=t=>{let r=u();r.collapse(!!t),m(r)},c=()=>r.getSelection?r.getSelection():r.document.selection,u=()=>{let n;let i=(t,r,n)=>{try{return r.compareBoundaryPoints(t,n)}catch(t){return -1}},s=r.document;if(L(o.bookmark)&&!uI(o)){let t=uN(o);if(t.isSome())return t.map(t=>uq(o,[t])[0]).getOr(s.createRange())}try{let t=c();t&&!nw(t.anchorNode)&&(n=t.rangeCount>0?t.getRangeAt(0):s.createRange(),n=uq(o,[n])[0])}catch(t){}if(n||(n=s.createRange()),nL(n.startContainer)&&n.collapsed){let r=t.getRoot();n.setStart(r,0),n.setEnd(r,0)}return a&&l&&(0===i(n.START_TO_START,n,a)&&0===i(n.END_TO_END,n,a)?n=l:(a=null,l=null)),n},m=(t,r)=>{let n;if(!((n=t)&&h6(n.startContainer)&&h6(n.endContainer)))return;let i=c();if(t=o.dispatch("SetSelectionRange",{range:t,forward:r}).range,i){l=t;try{i.removeAllRanges(),i.addRange(t)}catch(t){}!1===r&&i.extend&&(i.collapse(t.endContainer,t.endOffset),i.extend(t.startContainer,t.startOffset)),a=i.rangeCount>0?i.getRangeAt(0):null}if(!t.collapsed&&t.startContainer===t.endContainer&&(null==i?void 0:i.setBaseAndExtent)&&t.endOffset-t.startOffset<2&&t.startContainer.hasChildNodes()){let r=t.startContainer.childNodes[t.startOffset];r&&"IMG"===r.nodeName&&(i.setBaseAndExtent(t.startContainer,t.startOffset,t.endContainer,t.endOffset),i.anchorNode===t.startContainer&&i.focusNode===t.endContainer||i.setBaseAndExtent(r,0,r,1))}o.dispatch("AfterSetSelectionRange",{range:t,forward:r})},f=()=>{let r=c(),n=null==r?void 0:r.anchorNode,o=null==r?void 0:r.focusNode;if(!r||!n||!o||nw(n)||nw(o))return!0;let a=t.createRng(),l=t.createRng();try{a.setStart(n,r.anchorOffset),a.collapse(!0),l.setStart(o,r.focusOffset),l.collapse(!0)}catch(t){return!0}return 0>=a.compareBoundaryPoints(a.START_TO_START,l)},g={dom:t,win:r,serializer:n,editor:o,expand:(r={type:"word"})=>m(c6(t).expand(u(),r)),collapse:d,setCursorLocation:(r,n)=>{let a=t.createRng();L(r)&&L(n)?(a.setStart(r,n),a.setEnd(r,n),m(a),d(!1)):(dH(t,a,o.getBody(),!0),m(a))},getContent:t=>((t,r={})=>{let n;return n=r.format?r.format:"html",h1(t).selection.getContent(n,r)})(o,t),setContent:s,getBookmark:(t,r)=>p.getBookmark(t,r),moveToBookmark:t=>p.moveToBookmark(t),select:(r,n)=>(J.from(r).bind(r=>J.from(r.parentNode).map(o=>{let a=t.nodeIndex(r),l=t.createRng();return l.setStart(o,a),l.setEnd(o,a+1),n&&(dH(t,l,r,!0),dH(t,l,r,!1)),l})).each(m),r),isCollapsed:()=>{let t=u(),r=c();return!(!t||t.item)&&(t.compareEndPoints?0===t.compareEndPoints("StartToEnd",t):!r||t.collapsed)},isEditable:()=>{let r=u(),n=o.getBody().querySelectorAll('[data-mce-selected="1"]');return n.length>0?eb(n,r=>t.isEditable(r.parentElement)):r.startContainer===r.endContainer?t.isEditable(r.startContainer):t.isEditable(r.startContainer)&&t.isEditable(r.endContainer)},isForward:f,setNode:r=>(s(t.getOuterHTML(r)),r),getNode:()=>((t,r)=>{if(!r)return t;let n=r.startContainer,o=r.endContainer,a=r.startOffset,l=r.endOffset,i=r.commonAncestorContainer;r.collapsed||(n===o&&l-a<2&&n.hasChildNodes()&&(i=n.childNodes[a]),nT(n)&&nT(o)&&(n=n.length===a?u$(n.nextSibling,!0):n.parentNode,o=0===l?u$(o.previousSibling,!1):o.parentNode,n&&n===o&&(i=n)));let s=nT(i)?i.parentNode:i;return nx(s)?s:t})(o.getBody(),u()),getSel:c,setRng:m,getRng:u,getStart:t=>uj(o.getBody(),u(),t),getEnd:t=>uH(o.getBody(),u(),t),getSelectedBlocks:(r,n)=>((t,r,n,o)=>{let a=[],l=t.getRoot(),i=t.getParent(n||uj(l,r,r.collapsed),t.isBlock),s=t.getParent(o||uH(l,r,r.collapsed),t.isBlock);if(i&&i!==l&&a.push(i),i&&s&&i!==s){let r;let n=new ny(i,l);for(;(r=n.next())&&r!==s;)t.isBlock(r)&&a.push(r)}return s&&i!==s&&s!==l&&a.push(s),a})(t,u(),r,n),normalize:()=>{let r=u();if(!(dL(c()).length>1)&&d$(o)){let n=c3(t,r);return n.each(t=>{m(t,f())}),n.getOr(r)}return r},selectorChanged:(t,r)=>(i(t,r),g),selectorChangedWithUnbind:i,getScrollContainer:()=>{let r,n=t.getRoot();for(;n&&"BODY"!==n.nodeName;){if(n.scrollHeight>n.clientHeight){r=n;break}n=n.parentNode}return r},scrollIntoView:(t,r)=>{L(t)?((t,r,n)=>{(t.inline?uf:up)(t,r,n)})(o,t,r):uh(o,u(),r)},placeCaretAt:(t,r)=>m(cY(t,r,o.getDoc())),getBoundingClientRect:()=>{let t=u();return t.collapsed?lx.fromRangeStart(t).getClientRects()[0]:t.getBoundingClientRect()},destroy:()=>{r=a=l=null,h.destroy()}},p=cC(g),h=cD(g,o);return g.bookmarkManager=p,g.controlSelection=h,g},h4=(t,r,n)=>{-1===tF.inArray(r,n)&&(t.addAttributeFilter(n,(t,r)=>{let n=t.length;for(;n--;)t[n].attr(r,null)}),r.push(n))},h7=(t,r)=>{let n=["data-mce-selected"],o={entity_encoding:"named",remove_trailing_brs:!0,pad_empty_with_br:!1,...t},a=r&&r.dom?r.dom:aB.DOM,l=r&&r.schema?r.schema:am(o),i=hC(o,l);return i.addAttributeFilter("data-mce-tabindex",(t,r)=>{let n=t.length;for(;n--;){let o=t[n];o.attr("tabindex",o.attr("data-mce-tabindex")),o.attr(r,null)}}),i.addAttributeFilter("src,href,style",(t,r)=>{let n="data-mce-"+r,l=o.url_converter,i=o.url_converter_scope,s=t.length;for(;s--;){let o=t[s],d=o.attr(n);void 0!==d?(o.attr(r,d.length>0?d:null),o.attr(n,null)):(d=o.attr(r),"style"===r?d=a.serializeStyle(a.parseStyle(d),o.name):l&&(d=l.call(i,d,r,o.name)),o.attr(r,d.length>0?d:null))}}),i.addAttributeFilter("class",t=>{let r=t.length;for(;r--;){let n=t[r],o=n.attr("class");o&&(o=o.replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),n.attr("class",o.length>0?o:null))}}),i.addAttributeFilter("data-mce-type",(t,r,n)=>{let o=t.length;for(;o--;){let r=t[o];"bookmark"!==r.attr("data-mce-type")||n.cleanup||(J.from(r.firstChild).exists(t=>{var r;return!nK(null!==(r=t.value)&&void 0!==r?r:"")})?r.unwrap():r.remove())}}),i.addNodeFilter("noscript",t=>{var r;let n=t.length;for(;n--;){let o=t[n].firstChild;o&&(o.value=at.decode(null!==(r=o.value)&&void 0!==r?r:""))}}),i.addNodeFilter("script,style",(t,r)=>{var n;let a=t=>t.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,""),l=t.length;for(;l--;){let i=t[l],s=i.firstChild,d=null!==(n=null==s?void 0:s.value)&&void 0!==n?n:"";if("script"===r){let t=i.attr("type");t&&i.attr("type","mce-no/type"===t?null:t.replace(/^mce\-/,"")),"xhtml"===o.element_format&&s&&d.length>0&&(s.value="// <![CDATA[\n"+a(d)+"\n// ]]>")}else"xhtml"===o.element_format&&s&&d.length>0&&(s.value="<!--\n"+a(d)+"\n-->")}}),i.addNodeFilter("#comment",t=>{let r=t.length;for(;r--;){let n=t[r],l=n.value;o.preserve_cdata&&0===(null==l?void 0:l.indexOf("[CDATA["))?(n.name="#cdata",n.type=4,n.value=a.decode(l.replace(/^\[CDATA\[|\]\]$/g,""))):0===(null==l?void 0:l.indexOf("mce:protected "))&&(n.name="#text",n.type=3,n.raw=!0,n.value=unescape(l).substr(14))}}),i.addNodeFilter("xml:namespace,input",(t,r)=>{let n=t.length;for(;n--;){let o=t[n];7===o.type?o.remove():1===o.type&&("input"!==r||o.attr("type")||o.attr("type","text"))}}),i.addAttributeFilter("data-mce-type",t=>{el(t,t=>{"format-caret"===t.attr("data-mce-type")&&(t.isEmpty(i.schema.getNonEmptyElements())?t.remove():t.unwrap())})}),i.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-block,data-mce-type,data-mce-resize,data-mce-placeholder",(t,r)=>{let n=t.length;for(;n--;)t[n].attr(r,null)}),o.remove_trailing_brs&&pn(o,i,i.schema),{schema:l,addNodeFilter:i.addNodeFilter,addAttributeFilter:i.addAttributeFilter,serialize:(t,n={})=>{let s={format:"html",...n},d=((t,r,n)=>{let o=n.selection?{forced_root_block:!1,...n}:n,a=t.parse(r,o);return(t=>{let r=t=>"br"===(null==t?void 0:t.name),n=t.lastChild;if(r(n)){let t=n.prev;r(t)&&(n.remove(),t.remove())}})(a),a})(i,((t,r,n)=>{let o=on(n.getInner?r.innerHTML:t.getOuterHTML(r));return n.selection||n9(ri(r))?o:tF.trim(o)})(a,L(r)&&r.hasEventListeners("PreProcess")&&!s.no_events?((t,r,n)=>{let o;let a=t.dom,l=r.cloneNode(!0),i=document.implementation;if(i.createHTMLDocument){let t=i.createHTMLDocument("");tF.each("BODY"===l.nodeName?l.childNodes:[l],r=>{t.body.appendChild(t.importNode(r,!0))}),l="BODY"!==l.nodeName?t.body.firstChild:t.body,o=a.doc,a.doc=t}return((t,r)=>{t.dispatch("PreProcess",r)})(t,{...n,node:l}),o&&(a.doc=o),l})(r,t,s):t,s),s);return"tree"===s.format?d:((t,r,n)=>{if(!r.no_events&&t){let o;return(o={...r,content:n},t.dispatch("PostProcess",o)).content}return n})(r,s,mr(o,l).serialize(d))},addRules:l.addValidElements,setRules:l.setValidElements,addTempAttr:V(h4,i,n),getTempAttrs:H(n),getNodeFilters:i.getNodeFilters,getAttributeFilters:i.getAttributeFilters,removeNodeFilter:i.removeNodeFilter,removeAttributeFilter:i.removeAttributeFilter}},be=(t,r)=>{let n=h7(t,r);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters,removeNodeFilter:n.removeNodeFilter,removeAttributeFilter:n.removeAttributeFilter}},bt=(t,r,n={})=>hk(t,{format:"html",...n,set:!0,content:r}).map(r=>{let n;let o=(n=r.content,h0(t).editor.setContent(n,r));return hS(t,o.html,r),o.content}).getOr(r),br="autoresize_on_init,content_editable_state,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,tabfocus_elements,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_enable_default_filters,paste_filter_drop,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists".split(","),bn="template_cdate_classes,template_mdate_classes,template_selected_content_classes,template_preview_replace_values,template_replace_values,templates,template_cdate_format,template_mdate_format".split(","),bo="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,textcolor".split(","),ba=[{name:"template",replacedWith:"Advanced Template"},{name:"rtc"}],bl=(t,r)=>ew(ed(r,r=>eI(t,r))),bi=t=>{let r=bl(t,br),n=t.forced_root_block;return!1!==n&&""!==n||r.push("forced_root_block (false only)"),ew(r)},bs=t=>bl(t,bn),bd=(t,r)=>{let n=tF.makeMap(t.plugins," ");return ew(ed(r,t=>eI(n,t)))},bc=t=>bd(t,bo),bu=t=>bd(t,ba.map(t=>t.name)),bm=t=>ef(ba,r=>r.name===t).fold(()=>t,r=>r.replacedWith?`${t}, replaced by ${r.replacedWith}`:t),bf=aB.DOM,bg=t=>J.from(t).each(t=>t.destroy()),bp=(()=>{let t={};return{add:(r,n)=>{t[r]=n},get:r=>t[r]?t[r]:{icons:{}},has:r=>eI(t,r)}})(),bh=az.ModelManager,bb=(t,r)=>r.dom[t],bv=(t,r)=>parseInt(rZ(r,t),10),by=V(bb,"clientWidth"),bC=V(bb,"clientHeight"),bw=V(bv,"margin-top"),bx=V(bv,"margin-left"),bE=t=>{let r=[],n=()=>{let r=t.theme;return r&&r.getNotificationManagerImpl?r.getNotificationManagerImpl():(()=>{let t=()=>{throw Error("Theme did not provide a NotificationManager implementation.")};return{open:t,close:t,getArgs:t}})()},o=()=>J.from(r[0]),a=()=>{el(r,t=>{t.reposition()})},l=t=>{eg(r,r=>r===t).each(t=>{r.splice(t,1)})},i=(i,s=!0)=>{var d;return t.removed||!(d=t.inline?t.getBody():t.getContentAreaContainer(),J.from(d).map(ri)).map(rz).getOr(!1)?{}:(s&&t.dispatch("BeforeOpenNotification",{notification:i}),ef(r,t=>{var r;return!((r=n().getArgs(t)).type!==i.type||r.text!==i.text||r.progressBar||r.timeout||i.progressBar||i.timeout)}).getOrThunk(()=>{t.editorManager.setActive(t);let s=n().open(i,()=>{l(s),a(),o().fold(()=>t.focus(),t=>ub(ri(t.getEl())))});return r.push(s),a(),t.dispatch("OpenNotification",{notification:{...s}}),s}))},s=H(r);return t.on("SkinLoaded",()=>{let r=iB(t);r&&i({text:r,type:"warning",timeout:0},!1),a()}),t.on("show ResizeEditor ResizeWindow NodeChange",()=>{requestAnimationFrame(a)}),t.on("remove",()=>{el(r.slice(),t=>{n().close(t)})}),{open:i,close:()=>{o().each(t=>{n().close(t),l(t),a()})},getNotifications:s}},bk=az.PluginManager,bS=az.ThemeManager,b_=t=>{let r=[],n=()=>{let r=t.theme;return r&&r.getWindowManagerImpl?r.getWindowManagerImpl():(()=>{let t=()=>{throw Error("Theme did not provide a WindowManager implementation.")};return{open:t,openUrl:t,alert:t,confirm:t,close:t}})()},o=(t,r)=>(...n)=>r?r.apply(t,n):void 0,a=n=>{t.dispatch("CloseWindow",{dialog:n}),0===(r=ed(r,t=>t!==n)).length&&t.focus()},l=n=>{t.editorManager.setActive(t),u_(t),t.ui.show();let o=n();return r.push(o),t.dispatch("OpenWindow",{dialog:o}),o};return t.on("remove",()=>{el(r,t=>{n().close(t)})}),{open:(t,r)=>l(()=>n().open(t,r,a)),openUrl:t=>l(()=>n().openUrl(t,a)),alert:(t,r,a)=>{let l=n();l.alert(t,o(a||l,r))},confirm:(t,r,a)=>{let l=n();l.confirm(t,o(a||l,r))},close:()=>{J.from(r[r.length-1]).each(t=>{n().close(t),a(t)})}}},bN=(t,r)=>{t.notificationManager.open({type:"error",text:r})},bR=(t,r)=>{t._skinLoaded?bN(t,r):t.on("SkinLoaded",()=>{bN(t,r)})},bA=(t,r,n)=>{cx(t,r,{message:n}),console.error(n)},bO=(t,r,n)=>n?`Failed to load ${t}: ${n} from url ${r}`:`Failed to load ${t} url: ${r}`,bT=(t,...r)=>{let n=window.console;n&&(n.error?n.error(t,...r):n.log(t,...r))},bB=(t,r)=>{let n=t.editorManager.baseURL+"/skins/content",o=`content${t.editorManager.suffix}.css`;return ea(r,r=>/^[a-z0-9\-]+$/i.test(r)&&!t.inline?`${n}/${r}/${o}`:t.documentBaseURI.toAbsolute(r))},bD=(t,r)=>{let n={};return{findAll:(o,a=Q)=>Promise.all(ea(ed(o?eS(o.getElementsByTagName("img")):[],r=>{let n=r.src;return!r.hasAttribute("data-mce-bogus")&&!r.hasAttribute("data-mce-placeholder")&&!(!n||n===tB.transparentSrc)&&(e3(n,"blob:")?!t.isUploaded(n)&&a(r):!!e3(n,"data:")&&a(r))}),t=>{let o=t.src;if(eI(n,o))return n[o].then(r=>N(r)?r:{image:t,blobInfo:r.blobInfo});{let a=((t,r)=>{let n=()=>Promise.reject("Invalid data URI");if(e3(r,"blob:")){let o=t.getByUri(r);return L(o)?Promise.resolve(o):(e3(r,"blob:")?fetch(r).then(t=>t.ok?t.blob():Promise.reject()).catch(()=>Promise.reject({message:`Cannot convert ${r} to Blob. Resource might not exist or is inaccessible.`,uriType:"blob"})):e3(r,"data:")?new Promise((t,n)=>{po(r).bind(({type:t,data:r,base64Encoded:n})=>pa(t,r,n)).fold(()=>n("Invalid data URI"),t)}):Promise.reject("Unknown URI format")).then(r=>pl(r).then(o=>ps(o,!1,n=>J.some(pd(t,r,n))).getOrThunk(n)))}return e3(r,"data:")?pc(t,r).fold(n,t=>Promise.resolve(t)):Promise.reject("Unknown image data format")})(r,o).then(r=>(delete n[o],{image:t,blobInfo:r})).catch(t=>(delete n[o],t));return n[o]=a,a}}))}},bP=()=>{let t={},r=(t,r)=>({status:t,resultUri:r}),n=r=>r in t;return{hasBlobUri:n,getResultUri:r=>{let n=t[r];return n?n.resultUri:null},isPending:r=>!!n(r)&&1===t[r].status,isUploaded:r=>!!n(r)&&2===t[r].status,markPending:n=>{t[n]=r(1,null)},markUploaded:(n,o)=>{t[n]=r(2,o)},removeFailed:r=>{delete t[r]},destroy:()=>{t={}}}},bL=0,bF=(t,r)=>{let n={},o=(t,n)=>new Promise((o,a)=>{let l=new XMLHttpRequest;l.open("POST",r.url),l.withCredentials=r.credentials,l.upload.onprogress=t=>{n(t.loaded/t.total*100)},l.onerror=()=>{a("Image upload failed due to a XHR Transport error. Code: "+l.status)},l.onload=()=>{var t,n;if(l.status<200||l.status>=300)return void a("HTTP Error: "+l.status);let i=JSON.parse(l.responseText);i&&N(i.location)?o((t=r.basePath,n=i.location,t?t.replace(/\/$/,"")+"/"+n.replace(/^\//,""):n)):a("Invalid JSON: "+l.responseText)};let i=new FormData;i.append("file",t.blob(),t.filename()),l.send(i)}),a=F(r.handler)?r.handler:o,l=(t,r)=>({url:r,blobInfo:t,status:!0}),i=(t,r)=>({url:"",blobInfo:t,status:!1,error:r}),s=(t,r)=>{tF.each(n[t],t=>{t(r)}),delete n[t]};return{upload:(d,c)=>{let u;return r.url||a!==o?(u=d,u=tF.grep(u,r=>!t.isUploaded(r.blobUri())),Promise.all(tF.map(u,r=>t.isPending(r.blobUri())?(t=>{let r=t.blobUri();return new Promise(t=>{n[r]=n[r]||[],n[r].push(t)})})(r):(t.markPending(r.blobUri()),new Promise(n=>{let o,d;try{let u=()=>{o&&(o.close(),d=U)},m=o=>{u(),t.removeFailed(r.blobUri()),s(r.blobUri(),i(r,o)),n(i(r,o))};d=t=>{t<0||t>100||J.from(o).orThunk(()=>J.from(c).map(G)).each(r=>{o=r,r.progressBar.value(t)})},a(r,d).then(o=>{u(),t.markUploaded(r.blobUri(),o),s(r.blobUri(),l(r,o)),n(l(r,o))},t=>{m(N(t)?{message:t}:t)})}catch(t){n(i(r,t))}}))))):new Promise(t=>{t([])})}}},bM=t=>()=>t.notificationManager.open({text:t.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0}),bI=(t,r)=>bF(r,{url:im(t),basePath:ig(t),credentials:ip(t),handler:ih(t)}),bU=t=>{let r,n;let o=(()=>{let t=[],r=t=>{if(!t.blob||!t.base64)throw Error("blob and base64 representations of the image are required for BlobInfo to be created");let r=t.id||"blobid"+bL+++(()=>{let t=()=>Math.round(4294967295*Math.random()).toString(36);return"s"+(new Date).getTime().toString(36)+t()+t()+t()})(),n=t.name||r,o=t.blob;return{id:H(r),name:H(n),filename:H(t.filename||n+"."+(({"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"})[o.type.toLowerCase()]||"dat")),blob:H(o),base64:H(t.base64),blobUri:H(t.blobUri||URL.createObjectURL(o)),uri:H(t.uri)}},n=r=>ef(t,r).getOrUndefined(),o=t=>n(r=>r.id()===t);return{create:(t,n,o,a,l)=>{if(N(t))return r({id:t,name:a,filename:l,blob:n,base64:o});if(R(t))return r(t);throw Error("Unknown input type")},add:r=>{o(r.id())||t.push(r)},get:o,getByUri:t=>n(r=>r.blobUri()===t),getByData:(t,r)=>n(n=>n.base64()===t&&n.blob().type===r),findFirst:n,removeByUri:r=>{t=ed(t,t=>t.blobUri()!==r||(URL.revokeObjectURL(t.blobUri()),!1))},destroy:()=>{el(t,t=>{URL.revokeObjectURL(t.blobUri())}),t=[]}}})(),a=bP(),l=[],i=r=>n=>t.selection?r(n):[],s=(t,r,n)=>{let o=0;do -1!==(o=t.indexOf(r,o))&&(t=t.substring(0,o)+n+t.substr(o+r.length),o+=n.length-r.length+1);while(-1!==o);return t},d=(t,r,n)=>(t=s(t,`src="${r}"`,`src="${n}"${n===tB.transparentSrc?' data-mce-placeholder="1"':""}`),s(t,'data-mce-src="'+r+'"','data-mce-src="'+n+'"')),c=(r,n)=>{el(t.undoManager.data,t=>{"fragmented"===t.type?t.fragments=ea(t.fragments,t=>d(t,r,n)):t.content=d(t.content,r,n)})},u=()=>(r||(r=bI(t,a)),g().then(i(n=>{let a=ea(n,t=>t.blobInfo);return r.upload(a,bM(t)).then(i(r=>{let a=[],l=!1,i=ea(r,(r,i)=>{var s;let{blobInfo:d,image:u}=n[i],m=!1;return r.status&&id(t)?(r.url&&!e2(u.src,r.url)&&(l=!0),o.removeByUri(u.src),hZ(t)||((r,n)=>{let o=t.convertURL(n,"src");c(r.src,n),t2(ri(r),{src:is(t)?n+(-1===n.indexOf("?")?"?":"&")+(new Date).getTime():n,"data-mce-src":o})})(u,r.url)):r.error&&(r.error.remove&&(c(u.src,tB.transparentSrc),a.push(u),m=!0),s=r.error.message,bR(t,aU.translate(["Failed to upload image: {0}",s]))),{element:u,status:r.status,uploadUri:r.url,blobInfo:d,removed:m}});return a.length>0&&!hZ(t)?t.undoManager.transact(()=>{el(nn(a),r=>{let n=rC(r);nt(r),n.each(r=>{t.dom.isEmpty(r.dom)&&L(t.schema.getTextBlockElements()[tV(r)])&&r9(r,rs('<br data-mce-bogus="1" />'))}),o.removeByUri(r.dom.src)})}):l&&t.undoManager.dispatchChange(),i}))}))),m=()=>ii(t)?u():Promise.resolve([]),f=t=>eb(l,r=>r(t)),g=()=>(n||(n=bD(a,o)),n.findAll(t.getBody(),f).then(i(r=>{let n=ed(r,r=>N(r)?(bR(t,r),!1):"blob"!==r.uriType);return hZ(t)||el(n,t=>{c(t.image.src,t.blobInfo.blobUri()),t.image.src=t.blobInfo.blobUri(),t.image.removeAttribute("data-mce-src")}),n}))),p=r=>r.replace(/src="(blob:[^"]+)"/g,(r,n)=>{let l=a.getResultUri(n);if(l)return'src="'+l+'"';let i=o.getByUri(n);return i||(i=eu(t.editorManager.get(),(t,r)=>t||r.editorUpload&&r.editorUpload.blobCache.getByUri(n),void 0)),i?'src="data:'+i.blob().type+";base64,"+i.base64()+'"':r});return t.on("SetContent",()=>{ii(t)?m():g()}),t.on("RawSaveContent",t=>{t.content=p(t.content)}),t.on("GetContent",t=>{t.source_view||"raw"===t.format||"tree"===t.format||(t.content=p(t.content))}),t.on("PostRender",()=>{t.parser.addNodeFilter("img",t=>{el(t,t=>{let r=t.attr("src");if(!r||o.getByUri(r))return;let n=a.getResultUri(r);n&&t.attr("src",n)})})}),{blobCache:o,addFilter:t=>{l.push(t)},uploadImages:u,uploadImagesAuto:m,scanForImages:g,destroy:()=>{o.destroy(),a.destroy(),n=r=null}}},bz={remove_similar:!0,inherit:!1},bj={selector:"td,th",...bz},bH=H({tablecellbackgroundcolor:{styles:{backgroundColor:"%value"},...bj},tablecellverticalalign:{styles:{"vertical-align":"%value"},...bj},tablecellbordercolor:{styles:{borderColor:"%value"},...bj},tablecellclass:{classes:["%value"],...bj},tableclass:{selector:"table",classes:["%value"],...bz},tablecellborderstyle:{styles:{borderStyle:"%value"},...bj},tablecellborderwidth:{styles:{borderWidth:"%value"},...bj}}),b$=tF.each,bq=aB.DOM,bV=t=>L(t)&&R(t),bW=(t,r)=>{let n=r&&r.schema||am({}),o=t=>{let r=N(t)?{name:t,classes:[],attrs:{}}:t,n=bq.create(r.name);return r.classes.length>0&&bq.addClass(n,r.classes.join(" ")),bq.setAttribs(n,r.attrs),n},a=(t,r,l)=>{let i;let s=r[0],d=bV(s)?s.name:void 0,c=((t,r)=>{let o=n.getElementRule(t.nodeName.toLowerCase()),a=null==o?void 0:o.parentsRequired;return!(!a||!a.length)&&(r&&en(a,r)?r:a[0])})(t,d);if(c)d===c?(i=s,r=r.slice(1)):i=c;else if(s)i=s,r=r.slice(1);else if(!l)return t;let u=i?o(i):bq.create("div");return u.appendChild(t),l&&tF.each(l,r=>{let n=o(r);u.insertBefore(n,t)}),a(u,r,bV(i)?i.siblings:void 0)},l=bq.create("div");if(t.length>0){let r=t[0],n=o(r),i=bV(r)?r.siblings:void 0;l.appendChild(a(n,t.slice(1),i))}return l},bK=t=>{let r="div",n={name:r,classes:[],attrs:{},selector:t=tF.trim(t)};return"*"!==t&&(r=t.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(t,r,o,a,l)=>{switch(r){case"#":n.attrs.id=o;break;case".":n.classes.push(o);break;case":":-1!==tF.inArray("checked disabled enabled read-only required".split(" "),o)&&(n.attrs[o]=o)}if("["===a){let t=l.match(/([\w\-]+)(?:\=\"([^\"]+))?/);t&&(n.attrs[t[1]]=t[2])}return""})),n.name=r||"div",n},bG=(t,r)=>{var n;let o="",a=iU(t);if(""===a)return"";let l=t=>N(t)?t.replace(/%(\w+)/g,""):"",i=(r,n)=>bq.getStyle(null!=n?n:t.getBody(),r,!0);if(N(r)){let n=t.formatter.get(r);if(!n)return"";r=n[0]}if("preview"in r){let t=r.preview;if(!1===t)return"";a=t||a}let s,d=r.block||r.inline||"span",c=N(n=r.selector)?(n=(n=n.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),tF.map(n.split(/(?:>|\s+(?![^\[\]]+\]))/),t=>{let r=tF.map(t.split(/(?:~\+|~|\+)/),bK),n=r.pop();return r.length&&(n.siblings=r),n}).reverse()):[];c.length>0?(c[0].name||(c[0].name=d),d=r.selector,s=bW(c,t)):s=bW([d],t);let u=bq.select(d,s)[0]||s.firstChild;b$(r.styles,(t,r)=>{let n=l(t);n&&bq.setStyle(u,r,n)}),b$(r.attributes,(t,r)=>{let n=l(t);n&&bq.setAttrib(u,r,n)}),b$(r.classes,t=>{let r=l(t);bq.hasClass(u,r)||bq.addClass(u,r)}),t.dispatch("PreviewFormats"),bq.setStyles(s,{position:"absolute",left:-65535}),t.getBody().appendChild(s);let m=i("fontSize"),f=/px$/.test(m)?parseInt(m,10):0;return b$(a.split(" "),t=>{let r=i(t,u);if(!("background-color"===t&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(r)&&"#ffffff"===dP(r=i(t)).toLowerCase()||"color"===t&&"#000000"===dP(r).toLowerCase())){if("font-size"===t&&/em|%$/.test(r)){if(0===f)return;r=parseFloat(r)/(/%$/.test(r)?100:1)*f+"px"}"border"===t&&r&&(o+="padding:0 2px;"),o+=t+":"+r+";"}}),t.dispatch("AfterPreviewFormats"),bq.remove(s),o},bY=t=>{let r=(t=>{let r={},n=(t,o)=>{t&&(N(t)?(O(o)||(o=[o]),el(o,t=>{D(t.deep)&&(t.deep=!ce(t)),D(t.split)&&(t.split=!ce(t)||ct(t)),D(t.remove)&&ce(t)&&!ct(t)&&(t.remove="none"),ce(t)&&ct(t)&&(t.mixed=!0,t.block_expand=!0),N(t.classes)&&(t.classes=t.classes.split(/\s+/))}),r[t]=o):eA(t,(t,r)=>{n(r,t)}))};return n((t=>{let r=t.dom,n=t.schema.type,o={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"left"},inherit:!1,preview:!1},{selector:"img,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginLeft:"0px",marginRight:"auto"},onformat:t=>{r.setStyle(t,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"},{selector:".mce-preview-object",ceFalseOverride:!0,styles:{display:"table",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{marginLeft:"auto",marginRight:"auto"},preview:!1}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginRight:"0px",marginLeft:"auto"},onformat:t=>{r.setStyle(t,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"right"},preview:!1}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"justify"},inherit:!1,preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:(()=>{let t={inline:"span",styles:{textDecoration:"line-through"},exact:!0},r={inline:"strike",remove:"all",preserve_attributes:["class","style"]},o={inline:"s",remove:"all",preserve_attributes:["class","style"]};return"html4"!==n?[o,t,r]:[t,o,r]})(),forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:(t,r,n)=>nx(t)&&t.hasAttribute("href"),onformat:(t,n,o)=>{tF.each(o,(n,o)=>{r.setAttrib(t,o,n)})}},lang:{inline:"span",clear_child_styles:!0,remove_similar:!0,attributes:{lang:"%value","data-mce-lang":t=>{var r;return null!==(r=null==t?void 0:t.customValue)&&void 0!==r?r:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return tF.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd samp".split(/\s/),t=>{o[t]={block:t,remove:"all"}}),o})(t)),n(bH()),n(iI(t)),{get:t=>L(t)?r[t]:r,has:t=>eI(r,t),register:n,unregister:t=>(t&&r[t]&&delete r[t],r)}})(t),n=aL({});return(t=>{t.addShortcut("meta+b","","Bold"),t.addShortcut("meta+i","","Italic"),t.addShortcut("meta+u","","Underline");for(let r=1;r<=6;r++)t.addShortcut("access+"+r,"",["FormatBlock",!1,"h"+r]);t.addShortcut("access+7","",["FormatBlock",!1,"p"]),t.addShortcut("access+8","",["FormatBlock",!1,"div"]),t.addShortcut("access+9","",["FormatBlock",!1,"address"])})(t),(t=>{t.on("mouseup keydown",r=>{var n;((t,r,n)=>{let o=t.selection,a=t.getBody();gg(t,null,n),(8===r||46===r)&&o.isCollapsed()&&"\uFEFF"===o.getStart().innerHTML&&gg(t,dm(a,o.getStart())),37!==r&&39!==r||gg(t,dm(a,o.getStart()))})(t,r.keyCode,nT(n=t.selection.getRng().endContainer)&&e8(n.data,"\xa0"))})})(t),hZ(t)||(n.set({}),t.on("NodeChange",r=>{g7(t,r.element,n.get())}),t.on("FormatApply FormatRemove",r=>{let o=J.from(r.node).map(t=>dW(t)?t:t.startContainer).bind(t=>nx(t)?J.some(t):J.from(t.parentElement)).getOrThunk(()=>g6(t));g7(t,o,n.get())})),{get:r.get,has:r.has,register:r.register,unregister:r.unregister,apply:(r,n,o)=>{((t,r,n,o)=>{h1(t).formatter.apply(r,n,o)})(t,r,n,o)},remove:(r,n,o,a)=>{((t,r,n,o,a)=>{h1(t).formatter.remove(r,n,o,a)})(t,r,n,o,a)},toggle:(r,n,o)=>{((t,r,n,o)=>{h1(t).formatter.toggle(r,n,o)})(t,r,n,o)},match:(r,n,o,a)=>h1(t).formatter.match(r,n,o,a),closest:r=>h1(t).formatter.closest(r),matchAll:(r,n)=>h1(t).formatter.matchAll(r,n),matchNode:(r,n,o,a)=>h1(t).formatter.matchNode(r,n,o,a),canApply:r=>h1(t).formatter.canApply(r),formatChanged:(r,o,a,l)=>h1(t).formatter.formatChanged(n,r,o,a,l),getCssText:V(bG,t)}},bX=t=>{switch(t.toLowerCase()){case"undo":case"redo":case"mcefocus":return!0;default:return!1}},bQ=t=>{let r=aH(),n=aL(0),o=aL(0),a={data:[],typing:!1,beforeChange:()=>{((t,r,n)=>{h1(t).undoManager.beforeChange(r,n)})(t,n,r)},add:(l,i)=>h1(t).undoManager.add(a,o,n,r,l,i),dispatchChange:()=>{t.setDirty(!0);let r=hq(t);r.bookmark=lz(t.selection),t.dispatch("change",{level:r,lastLevel:ex(a.data,o.get()).getOrUndefined()})},undo:()=>h1(t).undoManager.undo(a,n,o),redo:()=>{let r;return r=a.data,h1(t).undoManager.redo(o,r)},clear:()=>{((t,r,n)=>{h1(t).undoManager.clear(r,n)})(t,a,o)},reset:()=>{((t,r)=>{h1(t).undoManager.reset(r)})(t,a)},hasUndo:()=>h1(t).undoManager.hasUndo(a,o),hasRedo:()=>h1(t).undoManager.hasRedo(a,o),transact:r=>h1(t).undoManager.transact(a,n,r),ignore:r=>{((t,r,n)=>{h1(t).undoManager.ignore(r,n)})(t,n,r)},extra:(r,n)=>{((t,r,n,o,a)=>{h1(t).undoManager.extra(r,n,o,a)})(t,a,o,r,n)}};return hZ(t)||((t,r,n)=>{let o=aL(!1),a=t=>{hX(r,!1,n),r.add({},t)};t.on("init",()=>{r.add()}),t.on("BeforeExecCommand",t=>{bX(t.command)||(hQ(r,n),r.beforeChange())}),t.on("ExecCommand",t=>{bX(t.command)||a(t)}),t.on("ObjectResizeStart cut",()=>{r.beforeChange()}),t.on("SaveContent ObjectResized blur",a),t.on("dragend",a),t.on("keyup",n=>{let l=n.keyCode;if(n.isDefaultPrevented())return;let i=tB.os.isMacOS()&&"Meta"===n.key;(l>=33&&l<=36||l>=37&&l<=40||45===l||n.ctrlKey||i)&&(a(),t.nodeChanged()),46!==l&&8!==l||t.nodeChanged(),o.get()&&r.typing&&!hG(hq(t),r.data[0])&&(t.isDirty()||t.setDirty(!0),t.dispatch("TypingUndo"),o.set(!1),t.nodeChanged())}),t.on("keydown",t=>{let l=t.keyCode;if(t.isDefaultPrevented())return;if(l>=33&&l<=36||l>=37&&l<=40||45===l)return void(r.typing&&a(t));let i=t.ctrlKey&&!t.altKey||t.metaKey;if((l<16||l>20)&&224!==l&&91!==l&&!r.typing&&!i)return r.beforeChange(),hX(r,!0,n),r.add({},t),void o.set(!0);(tB.os.isMacOS()?t.metaKey:t.ctrlKey&&!t.altKey)&&r.beforeChange()}),t.on("mousedown",t=>{r.typing&&a(t)}),t.on("input",t=>{let r;t.inputType&&("insertReplacementText"===t.inputType||"insertText"===t.inputType&&null===t.data||"insertFromPaste"===(r=t).inputType||"insertFromDrop"===r.inputType)&&a(t)}),t.on("AddUndo Undo Redo ClearUndos",r=>{r.isDefaultPrevented()||t.nodeChanged()})})(t,a,n),t.addShortcut("meta+z","","Undo"),t.addShortcut("meta+y,meta+shift+z","","Redo"),a},bJ=[9,27,cR.HOME,cR.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,cR.DOWN,cR.UP,cR.LEFT,cR.RIGHT].concat(tB.browser.isFirefox()?[224]:[]),bZ="data-mce-placeholder",b0=t=>"keydown"===t.type||"keyup"===t.type,b1=t=>{let r=t.keyCode;return r===cR.BACKSPACE||r===cR.DELETE},b2=(t,r)=>({from:t,to:r}),b3=(t,r)=>fu(ri(t),ri(r.container())).map(t=>({block:t,position:r})),b8=(t,r)=>r$(r,t=>n6(t)||nU(t.dom),r=>rp(r,t)).filter(tY).getOr(t),b5=t=>{let r=(t=>{let r=rN(t);return eg(r,nZ).fold(H(r),t=>r.slice(0,t))})(t);return el(r,nt),r},b6=(t,r)=>ef(mE(r,t).reverse(),t=>oA(t)).each(nt),b9=(t,r,n,o)=>{if(oA(n))return ot(n),ds(n.dom);0===ed(rS(o),t=>!oA(t)).length&&oA(r)&&r8(o,rd("br"));let a=di(n.dom,lx.before(o.dom));return el(b5(r),t=>{r8(o,t)}),b6(t,r),a},b4=(t,r,n)=>{if(oA(n)){if(oA(r)){let t=ec((t=>{let r=(t,n)=>rA(t).fold(()=>n,t=>n0(t)?r(t,n.concat(a5(t))):n);return r(t,[])})(n),(t,r)=>(r4(t,r),r),oe());ne(r),r9(r,t)}return nt(n),ds(r.dom)}let o=dd(n.dom);return el(b5(r),t=>{r9(n,t)}),b6(t,r),o},b7=(t,r)=>{da(t,r.dom).bind(t=>J.from(t.getNode())).map(ri).filter(n1).each(nt)},ve=(t,r,n)=>(b7(!0,r),b7(!1,n),(rh(n,r)?((t,r)=>{let n=mE(r,t);return J.from(n[n.length-1])})(n,r):J.none()).fold(V(b4,t,r,n),V(b9,t,r,n))),vt=(t,r,n,o)=>r?ve(t,o,n):ve(t,n,o),vr=(t,r)=>{let n,o;let a=ri(t.getBody());return(n=a.dom,(o=t.selection.getRng()).collapsed?((t,r,n)=>{let o=b3(t,lx.fromRangeStart(n)),a=o.bind(n=>dt(r,t,n.position).bind(n=>b3(t,n).map(n=>nM(n.position.getNode())&&!oA(n.block)?da(!1,n.block.dom).bind(o=>o.isEqual(n.position)?dt(r,t,o).bind(r=>b3(t,r)):J.some(n)).getOr(n):n)));return tU(o,a,b2).filter(r=>{let n;return!rp(r.from.block,r.to.block)&&((t,r)=>{let n=ri(t);return rp(b8(n,r.from.block),b8(n,r.to.block))})(t,r)&&!1===nz((n=r).from.block.dom)&&!1===nz(n.to.block.dom)&&(t=>{let r=t=>n2(t)||oI(t.dom);return r(t.from.block)&&r(t.to.block)})(r)})})(n,r,o):J.none()).map(n=>()=>{vt(a,r,n.from.block,n.to.block).each(r=>{t.selection.setRng(r.toRange())})})},vn=(t,r)=>rH(ri(r),n6,V(rp,t)).isSome(),vo=t=>{let r=ri(t.getBody());return((t,r)=>{let n=di(t.dom,lx.fromRangeStart(r)).isNone(),o=dl(t.dom,lx.fromRangeEnd(r)).isNone();return!(vn(t,r.startContainer)||vn(t,r.endContainer))&&n&&o})(r,t.selection.getRng())?J.some(()=>{t.setContent(""),t.selection.setCursorLocation()}):((t,r)=>{let n=r.getRng();return tU(fu(t,ri(n.startContainer)),fu(t,ri(n.endContainer)),(o,a)=>rp(o,a)?J.none():J.some(()=>{n.deleteContents(),vt(t,!0,o,a).each(t=>{r.setRng(t.toRange())})})).getOr(J.none())})(r,t.selection)},va=(t,r)=>t.selection.isCollapsed()?J.none():vo(t),vl=(t,r,n,o,a)=>J.from(r._selectionOverrides.showCaret(t,n,o,a)),vi=(t,r)=>t.dispatch("BeforeObjectSelected",{target:r}).isDefaultPrevented()?J.none():J.some((t=>{let r=t.ownerDocument.createRange();return r.selectNode(t),r})(r)),vs=(t,r,n)=>r.collapsed?((t,r,n)=>{let o=sQ(1,t.getBody(),r),a=lx.fromRangeStart(o),l=a.getNode();if(sF(l))return vl(1,t,l,!a.isAtEnd(),!1);let i=a.getNode(!0);if(sF(i))return vl(1,t,i,!1,!1);let s=fj(t.dom.getRoot(),a.getNode());return sF(s)?vl(1,t,s,!1,n):J.none()})(t,r,n).getOr(r):r,vd=t=>mC(t)||mh(t),vc=t=>mw(t)||mb(t),vu=(t,r,n,o,a,l)=>{var i;vl(o,t,l.getNode(!a),a,!0).each(n=>{if(r.collapsed){let t=r.cloneRange();a?t.setEnd(n.startContainer,n.startOffset):t.setStart(n.endContainer,n.endOffset),t.deleteContents()}else r.deleteContents();t.selection.setRng(n)}),i=t.dom,nT(n)&&0===n.data.length&&i.remove(n)},vm=(t,r)=>((t,r)=>{let n=t.selection.getRng();if(!nT(n.commonAncestorContainer))return J.none();let o=r?pA.Forwards:pA.Backwards,a=s9(t.getBody()),l=V(s1,r?a.next:a.prev),i=r?vd:vc,s=sZ(o,t.getBody(),n),d=l(s),c=d?fa(r,d):d;if(!c||!s2(s,c))return J.none();if(i(c))return J.some(()=>vu(t,n,s.getNode(),o,r,c));let u=l(c);return u&&i(u)&&s2(c,u)?J.some(()=>vu(t,n,s.getNode(),o,r,u)):J.none()})(t,r),vf=(t,r)=>{let n=t.getBody();return r?ds(n).filter(mC):dd(n).filter(mw)},vg=t=>{let r=t.selection.getRng();return!r.collapsed&&(vf(t,!0).exists(t=>t.isEqual(lx.fromRangeStart(r)))||vf(t,!1).exists(t=>t.isEqual(lx.fromRangeEnd(r))))},vp=lH([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),vh=(t,r,n)=>dt(r,t,n).bind(o=>{var a;return L(a=o.getNode())&&(n6(ri(a))||n8(ri(a)))||((t,r,n,o)=>{let a=r=>n0(ri(r))&&!sq(n,o,t);return sJ(!r,n).fold(()=>sJ(r,o).fold(X,a),a)})(t,r,n,o)?J.none():r&&nz(o.getNode())||!r&&nz(o.getNode(!0))?((t,r,n,o)=>{let a=o.getNode(!r);return fu(ri(t),ri(n.getNode())).map(t=>oA(t)?vp.remove(t.dom):vp.moveToElement(a)).orThunk(()=>J.some(vp.moveToElement(a)))})(t,r,n,o):r&&mw(n)||!r&&mC(n)?J.some(vp.moveToPosition(o)):J.none()}),vb=(t,r)=>J.from(fj(t.getBody(),r)),vv=(t,r)=>{let n=t.selection.getNode();return vb(t,n).filter(nz).fold(()=>((t,r,n)=>{let o;let a=sQ(r?1:-1,t,n),l=lx.fromRangeStart(a),i=ri(t);return!r&&mw(l)?J.some(vp.remove(l.getNode(!0))):r&&mC(l)?J.some(vp.remove(l.getNode())):!r&&mC(l)&&mL(i,l)?mF(i,l).map(t=>vp.remove(t.getNode())):r&&mw(l)&&mP(i,l)?mM(i,l).map(t=>vp.remove(t.getNode())):((t,r)=>{let n=r.getNode(!t);return nx(n)&&n.getAttribute("data-mce-caret")===(t?"after":"before")})(r,l)?(P(o=l.getNode(!r))?J.none():r&&nz(o.nextSibling)?J.some(vp.moveToElement(o.nextSibling)):!r&&nz(o.previousSibling)?J.some(vp.moveToElement(o.previousSibling)):J.none()).orThunk(()=>vh(t,r,l)):vh(t,r,l).bind(r=>r.fold(t=>J.some(vp.remove(t)),t=>J.some(vp.moveToElement(t)),r=>sq(l,r,t)?J.none():J.some(vp.moveToPosition(r))))})(t.getBody(),r,t.selection.getRng()).map(n=>()=>n.fold(n=>(t._selectionOverrides.hideFakeCaret(),fe(t,r,ri(n)),!0),n=>{let o=r?lx.before(n):lx.after(n);return t.selection.setRng(o.toRange()),!0},r=>(t.selection.setRng(r.toRange()),!0))),()=>J.some(U))},vy=t=>{let r=t.dom,n=t.selection,o=fj(t.getBody(),n.getNode());if(nU(o)&&r.isBlock(o)&&r.isEmpty(o)){let t=r.create("br",{"data-mce-bogus":"1"});r.setHTML(o,""),o.appendChild(t),n.setRng(lx.before(t).toRange())}return!0},vC=(t,r)=>t.selection.isCollapsed()?vv(t,r):((t,r)=>{let n=t.selection.getNode();return nz(n)&&!nj(n)?vb(t,n.parentNode).filter(nz).fold(()=>J.some(()=>{el(nb(ri(t.getBody()),".mce-offscreen-selection"),nt),fe(t,r,ri(t.selection.getNode())),fm(t)}),()=>J.some(U)):vg(t)?J.some(()=>{fp(t,t.selection.getRng(),ri(t.getBody()))}):J.none()})(t,r),vw=(t,r)=>t.selection.isCollapsed()?((t,r)=>{let n=lx.fromRangeStart(t.selection.getRng());return dt(r,t.getBody(),n).filter(t=>r?mg(t):mp(t)).bind(t=>sV(r?0:-1,t)).map(r=>()=>t.selection.select(r))})(t,r):J.none(),vx=t=>nT(t)&&"\uFEFF"===t.data[0],vE=t=>nT(t)&&"\uFEFF"===t.data[t.data.length-1],vk=t=>{var r;return(null!==(r=t.ownerDocument)&&void 0!==r?r:document).createTextNode("\uFEFF")},vS=(t,r)=>t?(t=>{var r;if(nT(t.previousSibling))return vE(t.previousSibling)||t.previousSibling.appendData("\uFEFF"),t.previousSibling;if(nT(t))return vx(t)||t.insertData(0,"\uFEFF"),t;{let n=vk(t);return null===(r=t.parentNode)||void 0===r||r.insertBefore(n,t),n}})(r):(t=>{var r,n;if(nT(t.nextSibling))return vx(t.nextSibling)||t.nextSibling.insertData(0,"\uFEFF"),t.nextSibling;if(nT(t))return vE(t)||t.appendData("\uFEFF"),t;{let o=vk(t);return t.nextSibling?null===(r=t.parentNode)||void 0===r||r.insertBefore(o,t.nextSibling):null===(n=t.parentNode)||void 0===n||n.appendChild(o),o}})(r),v_=V(vS,!0),vN=V(vS,!1),vR=(t,r)=>nT(t.container())?vS(r,t.container()):vS(r,t.getNode()),vA=(t,r)=>{let n=r.get();return n&&t.container()===n&&oa(n)},vO=(t,r)=>r.fold(r=>{sB(t.get());let n=v_(r);return t.set(n),J.some(lx(n,n.length-1))},r=>ds(r).map(r=>{if(vA(r,t))return lx(t.get(),1);{sB(t.get());let n=vR(r,!0);return t.set(n),lx(n,1)}}),r=>dd(r).map(r=>{if(vA(r,t)){let r=t.get();return lx(r,r.length-1)}{sB(t.get());let n=vR(r,!1);return t.set(n),lx(n,n.length-1)}}),r=>{sB(t.get());let n=vN(r);return t.set(n),J.some(lx(n,1))}),vT=(t,r)=>{for(let n=0;n<t.length;n++){let o=t[n].apply(null,r);if(o.isSome())return o}return J.none()},vB=lH([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),vD=(t,r)=>s$(r,t)||t,vP=(t,r,n)=>{let o=fl(n),a=vD(r,o.container());return fo(t,a,o).fold(()=>dl(a,o).bind(V(fo,t,a)).map(t=>vB.before(t)),J.none)},vL=(t,r)=>null===dm(t,r),vF=(t,r,n)=>fo(t,r,n).filter(V(vL,r)),vM=(t,r,n)=>{let o=fi(n);return vF(t,r,o).bind(t=>di(t,o).isNone()?J.some(vB.start(t)):J.none())},vI=(t,r,n)=>{let o=fl(n);return vF(t,r,o).bind(t=>dl(t,o).isNone()?J.some(vB.end(t)):J.none())},vU=(t,r,n)=>{let o=fi(n),a=vD(r,o.container());return fo(t,a,o).fold(()=>di(a,o).bind(V(fo,t,a)).map(t=>vB.after(t)),J.none)},vz=t=>!fn(vH(t)),vj=(t,r,n)=>vT([vP,vM,vI,vU],[t,r,n]).filter(vz),vH=t=>t.fold($,$,$,$),v$=t=>t.fold(H("before"),H("start"),H("end"),H("after")),vq=t=>t.fold(vB.before,vB.before,vB.after,vB.after),vV=t=>t.fold(vB.start,vB.start,vB.end,vB.end),vW=(t,r,n,o,a,l)=>tU(fo(r,n,o),fo(r,n,a),(r,o)=>r!==o&&((t,r,n)=>{let o=s$(r,t),a=s$(n,t);return L(o)&&o===a})(n,r,o)?vB.after(t?r:o):l).getOr(l),vK=(t,r)=>t.fold(Q,t=>!(v$(t)===v$(r)&&vH(t)===vH(r))),vG=(t,r)=>t?r.fold(z(J.some,vB.start),J.none,z(J.some,vB.after),J.none):r.fold(J.none,z(J.some,vB.before),J.none,z(J.some,vB.end)),vY=(t,r,n)=>(r.setRng(lx(n.container(),n.offset()+(t?1:-1)).toRange()),r.getSel().modify("move",t?"forward":"backward","word"),!0);(i=u||(u={}))[i.Br=0]="Br",i[i.Block=1]="Block",i[i.Wrap=2]="Wrap",i[i.Eol=3]="Eol";let vX=(t,r)=>t===pA.Backwards?ev(r):r,vQ=(t,r,n)=>t===pA.Forwards?r.next(n):r.prev(n),vJ=(t,r,n,o)=>nM(o.getNode(r===pA.Forwards))?u.Br:!1===sq(n,o)?u.Block:u.Wrap,vZ=(t,r,n,o)=>{let a=s9(n),l=o,i=[];for(;l;){let n=vQ(r,a,l);if(!n)break;if(nM(n.getNode(!1)))return r===pA.Forwards?{positions:vX(r,i).concat([n]),breakType:u.Br,breakAt:J.some(n)}:{positions:vX(r,i),breakType:u.Br,breakAt:J.some(n)};if(n.isVisible()){if(t(l,n)){let t=vJ(0,r,l,n);return{positions:vX(r,i),breakType:t,breakAt:J.some(n)}}i.push(n),l=n}else l=n}return{positions:vX(r,i),breakType:u.Eol,breakAt:J.none()}},v0=(t,r,n,o)=>r(n,o).breakAt.map(o=>{let a=r(n,o).positions;return t===pA.Backwards?a.concat(o):[o].concat(a)}).getOr([]),v1=(t,r)=>eu(t,(t,n)=>t.fold(()=>J.some(n),o=>tU(eE(o.getClientRects()),eE(n.getClientRects()),(t,a)=>{let l=Math.abs(r-t.left);return Math.abs(r-a.left)<=l?n:o}).or(t)),J.none()),v2=(t,r)=>eE(r.getClientRects()).bind(r=>v1(t,r.left)),v3=V(vZ,lx.isAbove,-1),v8=V(vZ,lx.isBelow,1),v5=V(v0,-1,v3),v6=V(v0,1,v8),v9=(t,r)=>v3(t,r).breakAt.isNone(),v4=(t,r)=>v8(t,r).breakAt.isNone(),v7=(t,r)=>v2(v5(t,r),r),ye=(t,r)=>v2(v6(t,r),r),yt=(t,r)=>Math.abs(t.left-r),yr=(t,r)=>Math.abs(t.right-r),yn=(t,r)=>eW(t,(t,n)=>{let o=Math.min(yt(t,r),yr(t,r)),a=Math.min(yt(n,r),yr(n,r));return a===o&&eU(n,"node")&&nz(n.node)||a<o?n:t}),yo=t=>{let r=r=>ea(r,r=>{let n=le(r);return n.node=t,n});if(nx(t))return r(t.getClientRects());if(nT(t)){let n=t.ownerDocument.createRange();return n.setStart(t,0),n.setEnd(t,t.data.length),r(n.getClientRects())}return[]},ya=t=>eh(t,yo);(s=m||(m={}))[s.Up=-1]="Up",s[s.Down=1]="Down";let yl=(t,r,n,o,a,l)=>{let i=0,s=[],d=o=>{let l=ya([o]);-1===t&&(l=l.reverse());for(let t=0;t<l.length;t++){let o=l[t];if(!n(o,c)){if(s.length>0&&r(o,eG(s))&&i++,o.line=i,a(o))return!0;s.push(o)}}return!1},c=eG(l.getClientRects());if(!c)return s;let u=l.getNode();return u&&(d(u),((t,r,n,o)=>{let a=o;for(;a=sH(a,t,oy,r);)if(n(a))return})(t,o,d,u)),s},yi=V(yl,m.Up,ln,lo),ys=V(yl,m.Down,lo,ln),yd=t=>eG(t.getClientRects()),yc=t=>r=>r.line>t,yu=t=>r=>r.line===t,ym=(t,r)=>{t.selection.setRng(r),uh(t,t.selection.getRng())},yf=(t,r,n)=>J.some(vs(t,r,n)),yg=(t,r,n,o,a,l)=>{let i=r===pA.Forwards,s=s9(t.getBody()),d=V(s1,i?s.next:s.prev),c=i?o:a;if(!n.collapsed){let o=ll(n);if(l(o))return vl(r,t,o,r===pA.Backwards,!1);if(vg(t)){let t=n.cloneRange();return t.collapse(r===pA.Backwards),J.from(t)}}let u=sZ(r,t.getBody(),n);if(c(u))return vi(t,u.getNode(!i));let m=d(u),f=of(n);if(!m)return f?J.some(n):J.none();if(c(m=fa(i,m)))return vl(r,t,m.getNode(!i),i,!1);let g=d(m);return g&&c(g)&&s2(m,g)?vl(r,t,g.getNode(!i),i,!1):f?yf(t,m.toRange(),!1):J.none()},yp=(t,r,n,o,a,l)=>{let i;let s=sZ(r,t.getBody(),n),d=eG(s.getClientRects()),c=r===m.Down,u=t.getBody();if(!d)return J.none();if(vg(t)){let t=c?lx.fromRangeEnd(n):lx.fromRangeStart(n);return(c?ye:v7)(u,t).orThunk(()=>J.from(t)).map(t=>t.toRange())}let f=ed((c?ys:yi)(u,yc(1),s),yu(1)),g=d.left,p=yn(f,g);if(p&&l(p.node)){let n=Math.abs(g-p.left),o=Math.abs(g-p.right);return vl(r,t,p.node,n<o,!1)}if(i=o(s)?s.getNode():a(s)?s.getNode(!0):ll(n)){let n=((t,r,n,o)=>{let a,l,i,s;let d=s9(r),c=[],u=0;1===t?(a=d.next,l=lo,i=ln,s=lx.after(o)):(a=d.prev,l=ln,i=lo,s=lx.before(o));let m=yd(s);do{if(!s.isVisible())continue;let t=yd(s);if(i(t,m))continue;c.length>0&&l(t,eG(c))&&u++;let r=le(t);if(r.position=s,r.line=u,n(r))break;c.push(r)}while(s=a(s));return c})(r,u,yc(1),i),o=yn(ed(n,yu(1)),g);if(o||(o=eG(ed(n,yu(0)))))return yf(t,o.position.toRange(),!1)}return 0===f.length?yh(t,c).filter(c?a:o).map(r=>vs(t,r.toRange(),!1)):J.none()},yh=(t,r)=>{var n,o;let a=t.selection.getRng(),l=r?lx.fromRangeEnd(a):lx.fromRangeStart(a),i=(n=l.container(),o=t.getBody(),rH(ri(n),t=>nU(t.dom),t=>t.dom===o).map(t=>t.dom).getOr(o));return r?ek(v8(i,l).positions):eE(v3(i,l).positions)},yb=(t,r,n)=>yh(t,r).filter(n).exists(r=>(t.selection.setRng(r.toRange()),!0)),yv=(t,r)=>{let n=t.dom.createRng();n.setStart(r.container(),r.offset()),n.setEnd(r.container(),r.offset()),t.selection.setRng(n)},yy=(t,r)=>{t?r.setAttribute("data-mce-selected","inline-boundary"):r.removeAttribute("data-mce-selected")},yC=(t,r,n)=>vO(r,n).map(r=>(yv(t,r),n)),yw=(t,r,n)=>{let o=t.getBody(),a=((t,r,n)=>{let o=lx.fromRangeStart(t);if(t.collapsed)return o;{let a=lx.fromRangeEnd(t);return n?di(r,a).getOr(a):dl(r,o).getOr(o)}})(t.selection.getRng(),o,n);return((t,r,n,o)=>{let a=fa(t,o),l=vj(r,n,a);return vj(r,n,a).bind(V(vG,t)).orThunk(()=>((t,r,n,o,a)=>{let l=fa(t,a);return dt(t,n,l).map(V(fa,t)).fold(()=>o.map(vq),a=>vj(r,n,a).map(V(vW,t,r,n,l,a)).filter(V(vK,o))).filter(vz)})(t,r,n,l,o))})(n,V(fr,t),o,a).bind(n=>yC(t,r,n))},yx=(t,r,n)=>!!iM(t)&&yw(t,r,n).isSome(),yE=(t,r,n)=>!!iM(r)&&((t,r)=>{let n=r.selection.getRng(),o=t?lx.fromRangeEnd(n):lx.fromRangeStart(n);return!!F(r.selection.getSel().modify)&&(t&&os(o)?vY(!0,r.selection,o):!(t||!od(o))&&vY(!1,r.selection,o))})(t,r),yk=t=>{let r=aL(null),n=V(fr,t);return t.on("NodeChange",o=>{var a;iM(t)&&(((t,r,n)=>{let o=ed(ea(nb(ri(r.getRoot()),'*[data-mce-selected="inline-boundary"]'),t=>t.dom),t),a=ed(n,t);el(ey(o,a),V(yy,!1)),el(ey(a,o),V(yy,!0))})(n,t.dom,o.parents),((t,r)=>{let n=r.get();if(t.selection.isCollapsed()&&!t.composing&&n){let o=lx.fromRangeStart(t.selection.getRng());lx.isTextPosition(o)&&!(os(o)||od(o))&&(yv(t,sT(n,o)),r.set(null))}})(t,r),a=o.parents,t.selection.isCollapsed()&&el(ed(a,n),o=>{let a=lx.fromRangeStart(t.selection.getRng());vj(n,t.getBody(),a).bind(n=>yC(t,r,n))}))}),r},yS=V(yE,!0),y_=V(yE,!1),yN=(t,r,n)=>{if(iM(t)){let o=yh(t,r).getOrThunk(()=>{let n=t.selection.getRng();return r?lx.fromRangeEnd(n):lx.fromRangeStart(n)});return vj(V(fr,t),t.getBody(),o).exists(r=>vO(n,vq(r)).exists(r=>(yv(t,r),!0)))}return!1},yR=(t,r)=>n=>vO(r,n).map(r=>()=>yv(t,r)),yA=(t,r,n,o)=>{let a=t.getBody(),l=V(fr,t);t.undoManager.ignore(()=>{t.selection.setRng(((t,r)=>{let n=document.createRange();return n.setStart(t.container(),t.offset()),n.setEnd(r.container(),r.offset()),n})(n,o)),fd(t),vj(l,a,lx.fromRangeStart(t.selection.getRng())).map(vV).bind(yR(t,r)).each(Y)}),t.nodeChanged()},yO=(t,r,n)=>{if(t.selection.isCollapsed()&&iM(t)){let o=lx.fromRangeStart(t.selection.getRng());return((t,r,n,o)=>{let a;let l=(a=t.getBody(),s$(o.container(),a)||a),i=V(fr,t),s=vj(i,l,o);return s.bind(t=>n?t.fold(H(J.some(vV(t))),J.none,H(J.some(vq(t))),J.none):t.fold(J.none,H(J.some(vq(t))),J.none,H(J.some(vV(t))))).map(yR(t,r)).getOrThunk(()=>{let a=dr(n,l,o),d=a.bind(t=>vj(i,l,t));return tU(s,d,()=>fo(i,l,o).bind(r=>tU(ds(r),dd(r),(t,n)=>{let o=fa(!0,t),a=fa(!1,n);return dl(r,o).forall(t=>t.isEqual(a))}).getOr(!0)?J.some(()=>{fe(t,n,ri(r))}):J.none())).getOrThunk(()=>d.bind(()=>a.map(a=>()=>{n?yA(t,r,o,a):yA(t,r,a,o)})))})})(t,r,n,o)}return J.none()},yT=(t,r)=>{let n=ri(t.getBody()),o=mE(ri(t.selection.getStart()),n);return eg(o,r).fold(H(o),t=>o.slice(0,t))},yB=t=>1===rT(t),yD=(t,r)=>{let n=V(gC,t);return eh(r,t=>n(t)?[t.dom]:[])},yP=t=>{let r=yT(t,nZ);return yD(t,r)},yL=(t,r)=>{let n=ed(yT(t,t=>nZ(t)||rT(t)>1),yB);return ek(n).bind(o=>ff(r,lx.fromRangeStart(t.selection.getRng()),o.dom)&&!gw(o)?J.some(()=>((t,r,n,o)=>{let a=yD(r,o);if(0===a.length)fe(r,t,n);else{let t=gy(n.dom,a);r.selection.setRng(t.toRange())}})(r,t,o,n)):J.none())},yF=(t,r)=>{let n=t.selection.getStart(),o=((t,r)=>{let n=r.parentElement;return nM(r)&&!T(n)&&t.dom.isEmpty(n)})(t,n)||gw(ri(n))?gy(n,r):((t,r)=>{let{caretContainer:n,caretPosition:o}=gv(r);return t.insertNode(n.dom),o})(t.selection.getRng(),r);t.selection.setRng(o.toRange())},yM=t=>nT(t.startContainer),yI=t=>{let r=t.selection.getRng();return 0===r.startOffset&&yM(r)&&((t,r)=>{let n=r.startContainer.parentElement;return!T(n)&&gC(t,ri(n))})(t,r)&&((t=>{let r=t.startContainer.parentNode,n=t.endContainer.parentNode;return!T(r)&&!T(n)&&r.isEqualNode(n)})(r)&&(t=>{let r=t.endContainer;return t.endOffset===(nT(r)?r.length:r.childNodes.length)})(r)||!r.endContainer.isEqualNode(r.commonAncestorContainer))},yU=(t,r)=>t.selection.isCollapsed()?yL(t,r):(t=>{if(yI(t)){let r=yP(t);return J.some(()=>{fd(t),((t,r)=>{let n=ey(r,yP(t));n.length>0&&yF(t,n)})(t,r)})}return J.none()})(t),yz=t=>rH(t,t=>du(t.dom),nZ).isSome(),yj=t=>((t=>{let r=t.selection.getRng();return r.collapsed&&(yM(r)||t.dom.isEmpty(r.startContainer))&&!yz(ri(t.selection.getStart()))})(t)&&yF(t,[]),!0),yH=(t,r,n)=>L(n)?J.some(()=>{t._selectionOverrides.hideFakeCaret(),fe(t,r,ri(n))}):J.none(),y$=(t,r)=>t.selection.isCollapsed()?((t,r)=>{let n=r?mh:mb,o=sZ(r?pA.Forwards:pA.Backwards,t.getBody(),t.selection.getRng());return n(o)?yH(t,r,o.getNode(!r)):J.from(fa(r,o)).filter(t=>n(t)&&s2(o,t)).bind(n=>yH(t,r,n.getNode(!r)))})(t,r):((t,r)=>{let n=t.selection.getNode();return n$(n)?yH(t,r,n):J.none()})(t,r),yq=t=>tt(null!=t?t:"").getOr(0),yV=(t,r)=>(t||"table"===tV(r)?"margin":"padding")+("rtl"===rZ(r,"direction")?"-right":"-left"),yW=t=>{let r=yG(t);return!t.mode.isReadOnly()&&(r.length>1||eb(r,r=>{let n=yV(iw(t),r),o=r1(r,n).map(yq).getOr(0);return"false"!==t.dom.getContentEditable(r.dom)&&o>0}))},yK=t=>n3(t)||n8(t),yG=t=>ed(nn(t.selection.getSelectedBlocks()),t=>!yK(t)&&!rC(t).exists(yK)&&r$(t,t=>nU(t.dom)||nz(t.dom)).exists(t=>nU(t.dom))),yY=(t,r)=>{var n,o;let{dom:a}=t,l=ix(t),i=null!==(o=null===(n=/[a-z%]+$/i.exec(l))||void 0===n?void 0:n[0])&&void 0!==o?o:"px",s=yq(l),d=iw(t);el(yG(t),t=>{((t,r,n,o,a,l)=>{let i=yV(n,ri(l)),s=yq(t.getStyle(l,i));if("outdent"===r){let r=Math.max(0,s-o);t.setStyle(l,i,r?r+a:"")}else t.setStyle(l,i,s+o+a)})(a,r,d,s,i,t.dom)})},yX=t=>yY(t,"outdent"),yQ=t=>{if(t.selection.isCollapsed()&&yW(t)){let r=t.dom,n=t.selection.getRng(),o=lx.fromRangeStart(n),a=r.getParent(n.startContainer,r.isBlock);if(null!==a&&mR(ri(a),o))return J.some(()=>yX(t))}return J.none()},yJ=(t,r,n)=>e_([yQ,vC,vm,(t,n)=>yO(t,r,n),vr,fz,vw,y$,va,yU],r=>r(t,n)).filter(r=>t.selection.isEditable()),yZ=(t,r)=>{t.addCommand("delete",()=>{((t,r)=>{yJ(t,r,!1).fold(()=>{fd(t),fm(t)},Y)})(t,r)}),t.addCommand("forwardDelete",()=>{((t,r)=>{yJ(t,r,!0).fold(()=>fs(t,"ForwardDelete"),Y)})(t,r)})},y0=t=>void 0===t.touches||1!==t.touches.length?J.none():J.some(t.touches[0]),y1=(t,r)=>eI(t,r.nodeName),y2=(t,r)=>!!nT(r)||!!nx(r)&&!y1(t.getBlockElements(),r)&&!dk(r)&&!oj(t,r),y3=(t,r)=>!!(nT(r)&&(0===r.data.length||/^\s+$/.test(r.data)&&(!r.nextSibling||y1(t,r.nextSibling)))),y8=t=>t.dom.create(l7(t),ie(t)),y5=t=>{let r=t.dom,n=t.selection,o=t.schema,a=o.getBlockElements(),l=n.getStart(),i=t.getBody(),s,d,c=!1,u=l7(t);if(!l||!nx(l))return;let m=i.nodeName.toLowerCase();if(!o.isValidChild(m,u.toLowerCase())||eo(mx(ri(l),ri(i)),t=>y1(a,t.dom)))return;let f=n.getRng(),{startContainer:g,startOffset:p,endContainer:h,endOffset:b}=f,v=uI(t),y=i.firstChild;for(;y;)if(nx(y)&&oM(o,y),y2(o,y)){if(y3(a,y)){d=y,y=y.nextSibling,r.remove(d);continue}s||(s=y8(t),i.insertBefore(s,y),c=!0),d=y,y=y.nextSibling,s.appendChild(d)}else s=null,y=y.nextSibling;c&&v&&(f.setStart(g,p),f.setEnd(h,b),n.setRng(f),t.nodeChanged())},y6=(t,r,n)=>{let o=ri(y8(t)),a=oe();r9(o,a),n(r,o);let l=document.createRange();return l.setStartBefore(a.dom),l.setEndBefore(a.dom),l},y9=t=>r=>-1!==(" "+r.attr("class")+" ").indexOf(t),y4=(t,r,n)=>function(o){let a=arguments,l=a[a.length-2],i=l>0?r.charAt(l-1):"";if('"'===i)return o;if(">"===i){let t=r.lastIndexOf("<",l);if(-1!==t&&-1!==r.substring(t,l).indexOf('contenteditable="false"'))return o}return'<span class="'+n+'" data-mce-content="'+t.dom.encode(a[0])+'">'+t.dom.encode("string"==typeof a[1]?a[1]:a[0])+"</span>"},y7=(t,r)=>{r.hasAttribute("data-mce-caret")&&(om(r),t.selection.setRng(t.selection.getRng()),t.selection.scrollIntoView(r))},Ce=(t,r)=>{let n=rV(ri(t.getBody()),"*[data-mce-caret]").map(t=>t.dom).getOrNull();if(n)return"compositionstart"===r.type?(r.preventDefault(),r.stopPropagation(),void y7(t,n)):void(oi(n)&&(y7(t,n),t.undoManager.add()))},Ct=(t,r,n)=>{let o=s9(t.getBody()),a=V(s1,1===r?o.next:o.prev);if(n.collapsed){let o=t.dom.getParent(n.startContainer,"PRE");if(!o)return;if(!a(lx.fromRangeStart(n))){let n=ri((t=>{let r=t.dom.create(l7(t));return r.innerHTML='<br data-mce-bogus="1">',r})(t));1===r?r5(ri(o),n):r8(ri(o),n),t.selection.select(n.dom,!0),t.selection.collapse()}}},Cr=(t,r)=>{var n;return((t,r)=>{let n=r?pA.Forwards:pA.Backwards,o=t.selection.getRng();return yg(t,n,o,mC,mw,nz).orThunk(()=>(Ct(t,n,o),J.none()))})(t,(n=t.selection,fn(r?n.getEnd(!0):n.getStart(!0))?!r:r)).exists(r=>(ym(t,r),!0))},Cn=(t,r)=>((t,r)=>{let n=r?1:-1,o=t.selection.getRng();return yp(t,n,o,t=>mC(t)||mv(t),t=>mw(t)||my(t),nz).orThunk(()=>(Ct(t,n,o),J.none()))})(t,r).exists(r=>(ym(t,r),!0)),Co=(t,r)=>yb(t,r,r?mw:mC),Ca=(t,r)=>vf(t,!r).map(n=>{let o=n.toRange(),a=t.selection.getRng();return r?o.setStart(a.startContainer,a.startOffset):o.setEnd(a.endContainer,a.endOffset),o}).exists(r=>(ym(t,r),!0)),Cl=t=>en(["figcaption"],tV(t)),Ci=(t,r)=>!!t.selection.isCollapsed()&&((t,r)=>{let n=ri(t.getBody()),o=lx.fromRangeStart(t.selection.getRng());return((t,r)=>{let n=V(rp,r);return r$(ri(t.container()),nZ,n).filter(Cl)})(o,n).exists(()=>{if(r?v4(n.dom,o):v9(n.dom,o)){let o=y6(t,n,r?r9:r6);return t.selection.setRng(o),!0}return!1})})(t,r),Cs=(t,r)=>r?J.from(t.dom.getParent(t.selection.getNode(),"details")).map(r=>((t,r)=>{let n=t.selection.getRng(),o=lx.fromRangeStart(n);return!(t.getBody().lastChild!==r||!v4(r,o)||(t.execCommand("InsertNewBlockAfter"),0))})(t,r)).getOr(!1):J.from(t.dom.getParent(t.selection.getNode(),"summary")).bind(r=>J.from(t.dom.getParent(r,"details")).map(n=>((t,r,n)=>{let o=t.selection.getRng(),a=lx.fromRangeStart(o);return!(t.getBody().firstChild!==r||!v9(n,a)||(t.execCommand("InsertNewBlockBefore"),0))})(t,n,r))).getOr(!1),Cd={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0},Cc=(t,r)=>r.keyCode===t.keyCode&&r.shiftKey===t.shiftKey&&r.altKey===t.altKey&&r.ctrlKey===t.ctrlKey&&r.metaKey===t.metaKey,Cu=(t,...r)=>()=>t.apply(null,r),Cm=(t,r)=>ef(eh(ea(t,t=>({...Cd,...t})),t=>Cc(t,r)?[t]:[]),t=>t.action()),Cf=(t,r)=>e_(eh(ea(t,t=>({...Cd,...t})),t=>Cc(t,r)?[t]:[]),t=>t.action()),Cg=(t,r)=>{let n=r?pA.Forwards:pA.Backwards,o=t.selection.getRng();return yg(t,n,o,mh,mb,n$).exists(r=>(ym(t,r),!0))},Cp=(t,r)=>{let n=t.selection.getRng();return yp(t,r?1:-1,n,mh,mb,n$).exists(r=>(ym(t,r),!0))},Ch=(t,r)=>yb(t,r,r?mb:mh),Cb=lH([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Cv={...Cb,none:t=>Cb.none(t)},Cy=(t,r,n)=>eh(rN(t),t=>rf(t,r)?n(t)?[t]:[]:Cy(t,r,n)),CC=(t,r)=>rW(t,"table",r),Cw=(t,r,n,o,a=Q)=>{let l=1===o;if(!l&&n<=0)return Cv.first(t[0]);if(l&&n>=t.length-1)return Cv.last(t[t.length-1]);{let l=n+o,i=t[l];return a(i)?Cv.middle(r,i):Cw(t,r,l,o,a)}},Cx=(t,r)=>CC(t,r).bind(r=>{let n=Cy(r,"th,td",Q);return eg(n,r=>rp(t,r)).map(t=>({index:t,all:n}))}),CE=(t,r,n,o,a)=>eu(ed(eh(nb(ri(n),"td,th,caption").map(t=>t.dom),r=>{let n;let o={left:(n=le(r.getBoundingClientRect())).left- -1,top:n.top- -1,right:n.right+-2,bottom:n.bottom+-2,width:n.width+-1,height:n.height+-1};return[{x:o.left,y:t(o),cell:r},{x:o.right,y:t(o),cell:r}]}),t=>r(t,a)),(t,r)=>t.fold(()=>J.some(r),t=>{let n=Math.sqrt(Math.abs(t.x-o)+Math.abs(t.y-a)),l=Math.sqrt(Math.abs(r.x-o)+Math.abs(r.y-a));return J.some(l<n?r:t)}),J.none()).map(t=>t.cell),Ck=V(CE,t=>t.bottom,(t,r)=>t.y<r),CS=V(CE,t=>t.top,(t,r)=>t.y>r),C_=(t,r,n)=>{let o;let a=t(r,n);return(a.breakType!==u.Wrap||0!==a.positions.length)&&(nM(n.getNode())||(o=a).breakType!==u.Br||1!==o.positions.length)?a.breakAt.isNone():!a.breakAt.exists(n=>t(r,n).breakAt.isSome())},CN=V(C_,v3),CR=V(C_,v8),CA=(t,r,n,o)=>{let a=t.selection.getRng();return!(!sL()||!((t,r,n)=>{let o=lx.fromRangeStart(r);return da(!t,n).exists(t=>t.isEqual(o))})(r,a,n)||(vl(r?1:-1,t,n,!r,!1).each(r=>{ym(t,r)}),0))},CO=(t,r,n)=>{let o=((t,r)=>{let n=r.getNode(t);return nR(n)?J.some(n):J.none()})(!!r,n),a=!1===r;o.fold(()=>ym(t,n.toRange()),o=>da(a,t.getBody()).filter(t=>t.isEqual(n)).fold(()=>ym(t,n.toRange()),n=>((t,r,n)=>{r.undoManager.transact(()=>{let o=y6(r,ri(n),t?r5:r8);ym(r,o)})})(r,t,o)))},CT=(t,r,n,o)=>{let a=t.selection.getRng(),l=lx.fromRangeStart(a),i=t.getBody();return!r&&CN(o,l)?(CO(t,r,eE(l.getClientRects()).bind(t=>Ck(n,t.left,t.top)).bind(t=>v2(dd(t).map(r=>v3(t,r).positions.concat(r)).getOr([]),l)).orThunk(()=>eE(l.getClientRects()).bind(t=>v1(v5(i,lx.before(n)),t.left))).getOr(lx.before(n))),!0):!!(r&&CR(o,l))&&(CO(t,r,ek(l.getClientRects()).bind(t=>CS(n,t.left,t.top)).bind(t=>v2(ds(t).map(r=>[r].concat(v8(t,r).positions)).getOr([]),l)).orThunk(()=>eE(l.getClientRects()).bind(t=>v1(v6(i,lx.after(n)),t.left))).getOr(lx.after(n))),!0)},CB=(t,r,n)=>J.from(t.dom.getParent(t.selection.getNode(),"td,th")).bind(o=>J.from(t.dom.getParent(o,"table")).map(a=>n(t,r,a,o))).getOr(!1),CD=(t,r)=>CB(t,r,CA),CP=(t,r)=>CB(t,r,CT),CL=(t,r,n)=>n.fold(J.none,J.none,(t,r)=>((t,r)=>{let n=t=>{for(let o=0;o<t.childNodes.length;o++){let a=ri(t.childNodes[o]);if(r(a))return J.some(a);let l=n(t.childNodes[o]);if(l.isSome())return l}return J.none()};return n(t.dom)})(r,uW).map(t=>cG(c$.exact(t,0,t,0))),n=>(t.execCommand("mceTableInsertRowAfter"),CF(t,r,n))),CF=(t,r,n)=>CL(t,r,Cx(n,void 0).fold(()=>Cv.none(n),t=>Cw(t.all,n,t.index,1,rK))),CM=(t,r,n)=>CL(t,r,Cx(n,void 0).fold(()=>Cv.none(),t=>Cw(t.all,n,t.index,-1,rK))),CI=(t,r)=>{let n=["table","li","dl"],o=ri(t.getBody()),a=t=>{let r=tV(t);return rp(t,o)||en(n,r)},l=t.selection.getRng();return((t,r,n=X)=>n(r)?J.none():en(t,tV(r))?J.some(r):rq(r,t.join(","),t=>rf(t,"table")||n(t)))(["td","th"],ri(r?l.endContainer:l.startContainer),a).map(n=>(CC(n,a).each(r=>{t.model.table.clearSelectedCells(r.dom)}),t.selection.collapse(!r),(r?CF:CM)(t,a,n).each(r=>{t.selection.setRng(r)}),!0)).getOr(!1)},CU=(t,r)=>({container:t,offset:r}),Cz=aB.DOM,Cj=t=>r=>t===r?-1:0,CH=(t,r,n)=>{if(nT(t)&&r>=0)return J.some(CU(t,r));{let o=a4(Cz);return J.from(o.backwards(t,r,Cj(t),n)).map(t=>CU(t.container,t.container.data.length))}},C$=(t,r,n)=>{if(!nT(t))return J.none();let o=t.data;if(r>=0&&r<=o.length)return J.some(CU(t,r));{let o=a4(Cz);return J.from(o.backwards(t,r,Cj(t),n)).bind(t=>{let o=t.container.data;return C$(t.container,r+o.length,n)})}},Cq=(t,r,n)=>{if(!nT(t))return J.none();let o=t.data;if(r<=o.length)return J.some(CU(t,r));{let a=a4(Cz);return J.from(a.forwards(t,r,Cj(t),n)).bind(t=>Cq(t.container,r-o.length,n))}},CV=(t,r,n,o,a)=>{let l=a4(t,r=>t.isBlock(r)||en(["BR","IMG","HR","INPUT"],r.nodeName)||"false"===t.getContentEditable(r));return J.from(l.backwards(r,n,o,a))},CW=t=>on(t.toString().replace(/\u00A0/g," ")),CK=t=>""!==t&&-1!==" \xa0\f\n\r	\v".indexOf(t),CG=(t,r)=>t.substring(r.length),CY=(t,r,n,o=0)=>rW(ri(r.startContainer),uK).fold(()=>((t,r,n,o=0)=>{if(!r.collapsed||!nT(r.startContainer))return J.none();let a={text:"",offset:0},l=t.getParent(r.startContainer,t.isBlock)||t.getRoot();return CV(t,r.startContainer,r.startOffset,(t,r,o)=>(a.text=o+a.text,a.offset+=r,((t,r,n)=>{let o;let a=n.charAt(0);for(o=r-1;o>=0;o--){let l=t.charAt(o);if(CK(l))return J.none();if(a===l&&e2(t,n,o,r))break}return J.some(o)})(a.text,a.offset,n).getOr(r)),l).bind(t=>{let a=r.cloneRange();if(a.setStart(t.container,t.offset),a.setEnd(r.endContainer,r.endOffset),a.collapsed)return J.none();let l=CW(a);return 0!==l.lastIndexOf(n)||CG(l,n).length<o?J.none():J.some({text:CG(l,n),range:a,trigger:n})})})(t,r,n,o),r=>{let o=t.createRng();o.selectNode(r.dom);let a=CW(o);return J.some({range:o,text:CG(a,n),trigger:n})}),CX=t=>{if(3===t.nodeType)return CU(t,t.data.length);{let r=t.childNodes;return r.length>0?CX(r[r.length-1]):CU(t,r.length)}},CQ=(t,r)=>{let n=t.childNodes;return n.length>0&&r<n.length?CQ(n[r],0):n.length>0&&1===t.nodeType&&n.length===r?CX(n[n.length-1]):CU(t,r)},CJ=(t,r,n,o={})=>{var a;let l=r(),i=null!==(a=t.selection.getRng().startContainer.nodeValue)&&void 0!==a?a:"",s=ed(l.lookupByTrigger(n.trigger),r=>n.text.length>=r.minChars&&r.matches.getOrThunk(()=>{let r;return r=t.dom,t=>!((t,r)=>{var n;let o=null!==(n=t.getParent(r.container,t.isBlock))&&void 0!==n?n:t.getRoot();return CV(t,r.container,r.offset,(t,r)=>0===r?-1:r,o).filter(t=>!CK(t.container.data.charAt(t.offset-1))).isSome()})(r,CQ(t.startContainer,t.startOffset))})(n.range,i,n.text));if(0===s.length)return J.none();let d=Promise.all(ea(s,t=>t.fetch(n.text,t.maxResults,o).then(r=>({matchText:n.text,items:r,columns:t.columns,onAction:t.onAction,highlightOn:t.highlightOn}))));return J.some({lookupData:d,context:n})};(d=f||(f={}))[d.Error=0]="Error",d[d.Value=1]="Value";let CZ=(t,r,n)=>t.stype===f.Error?r(t.serror):n(t.svalue),C0=t=>({stype:f.Value,svalue:t}),C1=t=>({stype:f.Error,serror:t}),C2=t=>R(t)&&eN(t).length>100?" removed due to size":JSON.stringify(t,null,2),C3=(t,r)=>C1([{path:t,getErrorInfo:r}]),C8=(t,r)=>({extract:(n,o)=>eM(o,t).fold(()=>C3(n,()=>'Choice schema did not contain choice key: "'+t+'"'),t=>eM(r,t).fold(()=>C3(n,()=>'The chosen schema: "'+t+'" did not exist in branches: '+C2(r)),r=>r.extract(n.concat(["branch: "+t]),o))),toString:()=>"chooseOn("+t+"). Possible values: "+eN(r)}),C5=t=>(...r)=>{if(0===r.length)throw Error("Can't merge zero objects");let n={};for(let o=0;o<r.length;o++){let a=r[o];for(let r in a)eI(a,r)&&(n[r]=t(n[r],a[r]))}return n},C6=C5((t,r)=>A(t)&&A(r)?C6(t,r):r),C9=(C5((t,r)=>r),t=>({tag:"defaultedThunk",process:H(t)})),C4=t=>{var r;let n=(t=>{let r=[],n=[];return el(t,t=>{CZ(t,t=>n.push(t),t=>r.push(t))}),{values:r,errors:n}})(t);return n.errors.length>0?(r=n.errors,z(C1,ep)(r)):C0(n.values)},C7=(t,r,n)=>{switch(t.tag){case"field":return r(t.key,t.newKey,t.presence,t.prop);case"custom":return n(t.newKey,t.instantiator)}},we=t=>({extract:(r,n)=>{var o,a;return o=t(n),a=t=>C3(r,H(t)),o.stype===f.Error?a(o.serror):o},toString:H("val")}),wt=we(C0),wr=(t,r,n,o)=>o(eM(t,r).getOrThunk(()=>n(t))),wn=(t,r,n,o,a)=>{let l=t=>a.extract(r.concat([o]),t),i=t=>t.fold(()=>C0(J.none()),t=>{var n;let l=a.extract(r.concat([o]),t);return n=J.some,l.stype===f.Value?{stype:f.Value,svalue:n(l.svalue)}:l});switch(t.tag){case"required":return eM(n,o).fold(()=>C3(r,()=>'Could not find valid *required* value for "'+o+'" in '+C2(n)),l);case"defaultedThunk":return wr(n,o,t.process,l);case"option":return i(eM(n,o));case"defaultedOptionThunk":let s;return s=t.process,i(eM(n,o).map(t=>!0===t?s(n):t));case"mergeWithThunk":return wr(n,o,H({}),r=>l(C6(t.process(n),r)))}},wo=t=>({extract:(r,n)=>((t,r,n)=>{let o={},a=[];for(let l of n)C7(l,(n,l,i,s)=>{CZ(wn(i,t,r,n,s),t=>{a.push(...t)},t=>{o[l]=t})},(t,n)=>{o[t]=n(r)});return a.length>0?C1(a):C0(o)})(r,n,t),toString:()=>"obj{\n"+ea(t,t=>C7(t,(t,r,n,o)=>t+" -> "+o.toString(),(t,r)=>"state("+t+")")).join("\n")+"}"}),wa=t=>({extract:(r,n)=>C4(ea(n,(n,o)=>t.extract(r.concat(["["+o+"]"]),n))),toString:()=>"array("+t.toString()+")"}),wl=(t,r,n)=>{let o,a;return o=r.extract([t],n),a=t=>({input:n,errors:t}),CZ(o.stype===f.Error?{stype:f.Error,serror:a(o.serror)}:o,lj.error,lj.value)},wi=(t,r)=>C8(t,eO(r,wo)),ws=H(wt),wd=(t,r)=>we(n=>{let o=typeof n;return t(n)?C0(n):C1(`Expected type: ${r} but got: ${o}`)}),wc=wd(M,"number"),wu=wd(N,"string"),wm=wd(B,"boolean"),wf=wd(F,"function"),wg=(t,r,n,o)=>({tag:"field",key:t,newKey:r,presence:n,prop:o}),wp=(t,r)=>({tag:"custom",newKey:t,instantiator:r}),wh=(t,r)=>wg(t,t,{tag:"required",process:{}},r),wb=t=>wh(t,wu),wv=t=>wh(t,wf),wy=(t,r)=>wg(t,t,{tag:"option",process:{}},r),wC=t=>wy(t,wu),ww=(t,r,n)=>wg(t,t,C9(r),n),wx=(t,r)=>ww(t,r,wc),wE=(t,r,n)=>{var o;return ww(t,r,(o=t=>en(n,t)?lj.value(t):lj.error(`Unsupported value: "${t}", choose one of "${n.join(", ")}".`),we(t=>o(t).fold(C1,C0))))},wk=(t,r)=>ww(t,r,wm),wS=(t,r)=>ww(t,r,wf),w_=wb("type"),wN=wv("fetch"),wR=wv("onAction"),wA=wS("onSetup",()=>U),wO=wC("text"),wT=wC("icon"),wB=wC("tooltip"),wD=wC("label"),wP=wk("active",!1),wL=wk("enabled",!0),wF=wk("primary",!1),wM=t=>ww("type",t,wu),wI=wo([w_,wb("trigger"),wx("minChars",1),wg(o="columns",o,C9(1),ws()),wx("maxResults",10),wy("matches",wf),wN,wR,ww("highlightOn",[],wa(wu))]),wU=[wL,wB,wT,wO,wA],wz=[wP].concat(wU),wj=[wS("predicate",X),wE("scope","node",["node","editor"]),wE("position","selection",["node","selection","line"])],wH=wU.concat([wM("contextformbutton"),wF,wR,wp("original",$)]),w$=wz.concat([wM("contextformbutton"),wF,wR,wp("original",$)]),wq=wU.concat([wM("contextformbutton")]),wV=wz.concat([wM("contextformtogglebutton")]),wW=wi("type",{contextformbutton:wH,contextformtogglebutton:w$});wo([wM("contextform"),wS("initValue",H("")),wD,wg(a="commands",a,{tag:"required",process:{}},wa(wW)),wy("launch",wi("type",{contextformbutton:wq,contextformtogglebutton:wV}))].concat(wj));let wK=t=>{let r=eO(t.ui.registry.getAll().popups,t=>wl("Autocompleter",wI,{trigger:t.ch,...t}).fold(t=>{var r;throw Error("Errors: \n"+ea((r=t.errors).length>10?r.slice(0,10).concat([{path:[],getErrorInfo:H("... (only showing first ten failures)")}]):r,t=>"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()).join("\n")+"\n\nInput object: "+C2(t.input))},$)),n=ez(eL(r,t=>t.trigger)),o=eF(r);return{dataset:r,triggers:n,lookupByTrigger:t=>ed(o,r=>r.trigger===t)}},wG=t=>{let r=aH(),n=aL(!1),o=r.isSet,a=()=>{o()&&((t=>{h1(t).autocompleter.removeDecoration()})(t),(t=>{t.dispatch("AutocompleterEnd")})(t),n.set(!1),r.clear())},l=eY(()=>wK(t)),i=i=>{r.get().map(r=>CY(t.dom,t.selection.getRng(),r.trigger).bind(r=>CJ(t,l,r,i))).getOrThunk(()=>((t,r)=>{let n;let o=r(),a=t.selection.getRng();return(n=t.dom,e_(o.triggers,t=>CY(n,a,t))).bind(n=>CJ(t,r,n))})(t,l)).fold(a,l=>{var i;i=l.context,o()||(((t,r)=>{h1(t).autocompleter.addDecoration(r)})(t,i.range),r.set({trigger:i.trigger,matchLength:i.text.length})),l.lookupData.then(o=>{r.get().map(i=>{let s=l.context;i.trigger===s.trigger&&(s.text.length-i.matchLength>=10?a():(r.set({...i,matchLength:s.text.length}),n.get()?((t,r)=>{t.dispatch("AutocompleterUpdate",r)})(t,{lookupData:o}):(n.set(!0),((t,r)=>{t.dispatch("AutocompleterStart",r)})(t,{lookupData:o}))))})})})};t.addCommand("mceAutocompleterReload",(t,r)=>{i(R(r)?r.fetchOptions:{})}),t.addCommand("mceAutocompleterClose",a),((t,r)=>{let n=aq(r.load,50);t.on("keypress compositionend",t=>{27!==t.which&&n.throttle()}),t.on("keydown",t=>{let o=t.which;8===o?n.throttle():27===o&&r.cancelIfNecessary()}),t.on("remove",n.cancel)})(t,{cancelIfNecessary:a,load:i})},wY=tS().browser.isSafari(),wX=t=>ot(ri(t)),wQ=(t,r)=>{var n;return 0===t.startOffset&&t.endOffset===(null===(n=r.textContent)||void 0===n?void 0:n.length)},wJ=(t,r)=>J.from(t.getParent(r.container(),"details")),wZ=(t,r)=>wJ(t,r).isSome(),w0=(t,r)=>{let n=r.getNode();D(n)||t.selection.setCursorLocation(n,r.offset())},w1=(t,r,n)=>{let o=t.dom.getParent(r.container(),"details");if(o&&!o.open){let r=t.dom.select("summary",o)[0];r&&(n?ds(r):dd(r)).each(r=>w0(t,r))}else w0(t,r)},w2=(t,r,n)=>{let{dom:o,selection:a}=t,l=t.getBody();if("character"===n){let n=lx.fromRangeStart(a.getRng()),i=o.getParent(n.container(),o.isBlock),s=wJ(o,n),d=i&&o.isEmpty(i),c=T(null==i?void 0:i.previousSibling),u=T(null==i?void 0:i.nextSibling);return!!(d&&(r?u:c)&&dr(!r,l,n).exists(t=>wZ(o,t)&&!tI(s,wJ(o,t))))||dr(r,l,n).fold(X,n=>{let a=wJ(o,n);if(wZ(o,n)&&!tI(s,a)){if(r||w1(t,n,!1),i&&d){if(r&&c||!r&&u)return!0;w1(t,n,r),t.dom.remove(i)}return!0}return!1})}return!1},w3=(t,r,n,o)=>{let a=t.selection.getRng(),l=lx.fromRangeStart(a),i=t.getBody();return"selection"===o?((t,r)=>{let n=r.startSummary.exists(r=>r.contains(t.startContainer)),o=r.startSummary.exists(r=>r.contains(t.endContainer)),a=r.startDetails.forall(t=>r.endDetails.forall(r=>t!==r));return(n||o)&&!(n&&o)||a})(a,r):n?r.startSummary.exists(t=>dd(t).exists(r=>nM(r.getNode())&&di(t,r).exists(t=>t.isEqual(l))||r.isEqual(l)))||r.startDetails.exists(t=>dl(i,l).forall(r=>!t.contains(r.container()))):r.startSummary.exists(t=>ds(t).exists(t=>t.isEqual(l)))||r.startDetails.exists(t=>di(t,l).forall(t=>r.startSummary.exists(r=>!r.contains(l.container())&&r.contains(t.container()))))},w8=(t,r,n)=>((t,r)=>{let n=J.from(t.getParent(r.startContainer,"details")),o=J.from(t.getParent(r.endContainer,"details"));if(n.isSome()||o.isSome()){let r=n.bind(r=>J.from(t.select("summary",r)[0]));return J.some({startSummary:r,startDetails:n,endDetails:o})}return J.none()})(t.dom,t.selection.getRng()).fold(()=>w2(t,r,n),o=>w3(t,o,r,n)||w2(t,r,n))||wY&&((t,r,n)=>{let o=t.selection,a=o.getNode(),l=o.getRng(),i=lx.fromRangeStart(l);return!!nW(a)&&("selection"===n&&wQ(l,a)||ff(r,i,a)?wX(a):t.undoManager.transact(()=>{let l=o.getSel(),{anchorNode:i,anchorOffset:s,focusNode:d,focusOffset:c}=null!=l?l:{},u=()=>{L(i)&&L(s)&&L(d)&&L(c)&&(null==l||l.setBaseAndExtent(i,s,d,c))},m=(t,r)=>{el(t.childNodes,t=>{dW(t)&&r.appendChild(t)})},f=t.dom.create("span",{"data-mce-bogus":"1"});m(a,f),a.appendChild(f),u(),"word"!==n&&"line"!==n||null==l||l.modify("extend",r?"right":"left",n),!o.isCollapsed()&&wQ(o.getRng(),f)?wX(a):(t.execCommand(r?"ForwardDelete":"Delete"),i=null==l?void 0:l.anchorNode,s=null==l?void 0:l.anchorOffset,d=null==l?void 0:l.focusNode,c=null==l?void 0:l.focusOffset,m(f,a),u()),t.dom.remove(f)}),!0)})(t,r,n)?J.some(U):J.none(),w5=t=>(r,n,o={})=>{let a=r.getBody(),l={bubbles:!0,composed:!0,data:null,isComposing:!1,detail:0,view:null,target:a,currentTarget:a,eventPhase:Event.AT_TARGET,originalTarget:a,explicitOriginalTarget:a,isTrusted:!1,srcElement:a,cancelable:!1,preventDefault:U,inputType:n},i=ap(new InputEvent(t));return r.dispatch(t,{...i,...l,...o})},w6=w5("input"),w9=w5("beforeinput"),w4=tS(),w7=w4.os,xe=w7.isMacOS()||w7.isiOS(),xt=w4.browser.isFirefox(),xr=(t,r)=>{let n=t.dom,o=t.schema.getMoveCaretBeforeOnEnterElements();if(!r)return;if(/^(LI|DT|DD)$/.test(r.nodeName)){let t=(t=>{for(;t;){if(nx(t)||nT(t)&&t.data&&/[\r\n\s]/.test(t.data))return t;t=t.nextSibling}return null})(r.firstChild);t&&/^(UL|OL|DL)$/.test(t.nodeName)&&r.insertBefore(n.doc.createTextNode("\xa0"),r.firstChild)}let a=n.createRng();if(r.normalize(),r.hasChildNodes()){let t=new ny(r,r),n,l=r;for(;n=t.current();){if(nT(n)){a.setStart(n,0),a.setEnd(n,0);break}if(o[n.nodeName.toLowerCase()]){a.setStartBefore(n),a.setEndBefore(n);break}l=n,n=t.next()}n||(a.setStart(l,0),a.setEnd(l,0))}else nM(r)?r.nextSibling&&n.isBlock(r.nextSibling)?(a.setStartBefore(r),a.setEndBefore(r)):(a.setStartAfter(r),a.setEndAfter(r)):(a.setStart(r,0),a.setEnd(r,0));t.selection.setRng(a),uh(t,a)},xn=(t,r)=>{let n=t.getRoot(),o,a=r;for(;a!==n&&a&&"false"!==t.getContentEditable(a);){if("true"===t.getContentEditable(a)){o=a;break}a=a.parentNode}return a!==n?o:n},xo=t=>J.from(t.dom.getParent(t.selection.getStart(!0),t.dom.isBlock)),xa=t=>{t.innerHTML='<br data-mce-bogus="1">'},xl=(t,r)=>{l7(t).toLowerCase()===r.tagName.toLowerCase()&&((t,r,n)=>{let o=t.dom;J.from(n.style).map(o.parseStyle).each(t=>{let n={...r2(ri(r)),...t};o.setStyles(r,n)}),tU(J.from(n.class).map(t=>t.split(/\s+/)),J.from(r.className).map(t=>ed(t.split(/\s+/),t=>""!==t)),(t,n)=>{let a=ed(n,r=>!en(t,r)),l=[...t,...a];o.setAttrib(r,"class",l.join(" "))});let a=["style","class"],l=eP(n,(t,r)=>!en(a,r));o.setAttribs(r,l)})(t,r,ie(t))},xi=(t,r,n,o,a=!0,l)=>{let i;let s=t.dom,d=t.schema,c=l7(t),u=n?n.nodeName.toUpperCase():"",m=r,f=d.getTextInlineElements(),g=i=l||"TABLE"===u||"HR"===u?s.create(l||c):n.cloneNode(!1);if(a)do if(f[m.nodeName]){if(du(m)||dk(m))continue;let t=m.cloneNode(!1);s.setAttrib(t,"id",""),i.hasChildNodes()?t.appendChild(i.firstChild):g=t,i.appendChild(t)}while((m=m.parentNode)&&m!==o);else s.setAttrib(i,"style",null),s.setAttrib(i,"class",null);return xl(t,i),xa(g),i},xs=(t,r)=>{let n=null==t?void 0:t.parentNode;return L(n)&&n.nodeName===r},xd=t=>L(t)&&/^(OL|UL|LI)$/.test(t.nodeName),xc=t=>{let r=t.parentNode;return L(r)&&/^(LI|DT|DD)$/.test(r.nodeName)?r:t},xu=(t,r,n)=>{let o=t[n?"firstChild":"lastChild"];for(;o&&!nx(o);)o=o[n?"nextSibling":"previousSibling"];return o===r},xm=(t,r)=>r&&"A"===r.nodeName&&t.isEmpty(r),xf=(t,r)=>t.nodeName===r||t.previousSibling&&t.previousSibling.nodeName===r,xg=(t,r)=>L(r)&&t.isBlock(r)&&!/^(TD|TH|CAPTION|FORM)$/.test(r.nodeName)&&!/^(fixed|absolute)/i.test(r.style.position)&&t.isEditable(r.parentNode)&&"false"!==t.getContentEditable(r),xp=(t,r,n)=>nT(r)?t?1===n&&"\uFEFF"===r.data.charAt(n-1)?0:n:n===r.data.length-1&&"\uFEFF"===r.data.charAt(n)?r.data.length:n:n,xh={insert:(t,r)=>{let n,o,a,l,i,s,d=!1,c=t.dom,u=t.schema.getNonEmptyElements(),m=t.selection.getRng(),f=l7(t),g=ri(m.startContainer),p=rR(g,m.startOffset),h=p.exists(t=>tG(t)&&!rK(t)),b=m.collapsed&&h,v=r=>xi(t,a,k,E,ia(t),r),y=t=>{let r;let n=xp(t,a,l);if(nT(a)&&(t?n>0:n<a.data.length))return!1;if(a.parentNode===k&&d&&!t||t&&nx(a)&&a===k.firstChild)return!0;if(xf(a,"TABLE")||xf(a,"HR"))return d&&!t||!d&&t;let o=new ny(a,k);for(nT(a)&&(t&&0===n?o.prev():t||n!==a.data.length||o.next());r=o.current();){if(nx(r)){if(!r.getAttribute("data-mce-bogus")){let t=r.nodeName.toLowerCase();if(u[t]&&"br"!==t)return!1}}else if(nT(r)&&!ow(r.data))return!1;t?o.prev():o.next()}return!0},C=()=>{let r;return r=/^(H[1-6]|PRE|FIGURE)$/.test(i)&&"HGROUP"!==S?v(f):v(),((t,r)=>{let n=il(t);return!P(r)&&(N(n)?en(tF.explode(n),r.nodeName.toLowerCase()):n)})(t,s)&&xg(c,s)&&c.isEmpty(k,void 0,{includeZwsp:!0})?r=c.split(s,k):c.insertAfter(r,k),xr(t,r),r};c3(c,m).each(t=>{m.setStart(t.startContainer,t.startOffset),m.setEnd(t.endContainer,t.endOffset)}),a=m.startContainer,l=m.startOffset;let w=!(!r||!r.shiftKey),x=!(!r||!r.ctrlKey);nx(a)&&a.hasChildNodes()&&!b&&(d=l>a.childNodes.length-1,a=a.childNodes[Math.min(l,a.childNodes.length-1)]||a,l=d&&nT(a)?a.data.length:0);let E=xn(c,a);if(!E||((t,r)=>{let n=t.dom.getParent(r,"ol,ul,dl");return null!==n&&"false"===t.dom.getContentEditableParent(n)})(t,a))return;w||(a=((t,r,n,o,a)=>{var l,i;let s=t.dom,d=null!==(l=xn(s,o))&&void 0!==l?l:s.getRoot(),c=s.getParent(o,s.isBlock);if(!c||!xg(s,c)){if(!(c=c||d).hasChildNodes()){let o=s.create(r);return xl(t,o),c.appendChild(o),n.setStart(o,0),n.setEnd(o,0),o}let l,u=o;for(;u&&u.parentNode!==c;)u=u.parentNode;for(;u&&!s.isBlock(u);)l=u,u=u.previousSibling;let m=null===(i=null==l?void 0:l.parentElement)||void 0===i?void 0:i.nodeName;if(l&&m&&t.schema.isValidChild(m,r.toLowerCase())){let i=l.parentNode,d=s.create(r);for(xl(t,d),i.insertBefore(d,l),u=l;u&&!s.isBlock(u);){let t=u.nextSibling;d.appendChild(u),u=t}n.setStart(o,a),n.setEnd(o,a)}}return o})(t,f,m,a,l));let k=c.getParent(a,c.isBlock)||c.getRoot();s=L(null==k?void 0:k.parentNode)?c.getParent(k.parentNode,c.isBlock):null,i=k?k.nodeName.toUpperCase():"";let S=s?s.nodeName.toUpperCase():"";if("LI"!==S||x||(k=s,s=s.parentNode,i=S),nx(s)&&(n=k,!w&&n.nodeName.toLowerCase()===l7(t)&&t.dom.isEmpty(n)&&((r,n,o)=>{let a=n;for(;a&&a!==r&&T(a.nextSibling);){let r=a.parentElement;if(!r||!eI(t.schema.getTextBlockElements(),r.nodeName.toLowerCase()))return nV(r);a=r}return!1})(t.getBody(),n)))return((t,r,n)=>{var o,a,l;let i=r(l7(t)),s=t.dom.getParent(n,nV);s&&(t.dom.insertAfter(i,s),xr(t,i),(null!==(l=null===(a=null===(o=n.parentElement)||void 0===o?void 0:o.childNodes)||void 0===a?void 0:a.length)&&void 0!==l?l:0)>1&&t.dom.remove(n))})(t,v,k);if(/^(LI|DT|DD)$/.test(i)&&nx(s)&&c.isEmpty(k))return void((t,r,n,o,a)=>{var l,i,s;let d=t.dom,c=t.selection.getRng(),u=n.parentNode;if(n===t.getBody()||!u)return;xd(l=n)&&xd(l.parentNode)&&(a="LI");let m=r(a);if(xu(n,o,!0)&&xu(n,o,!1)){if(xs(n,"LI")){let t=xc(n);d.insertAfter(m,t),(null===(s=(i=n).parentNode)||void 0===s?void 0:s.firstChild)===i?d.remove(t):d.remove(n)}else d.replace(m,n)}else if(xu(n,o,!0))xs(n,"LI")?(d.insertAfter(m,xc(n)),m.appendChild(d.doc.createTextNode(" ")),m.appendChild(n)):u.insertBefore(m,n),d.remove(o);else if(xu(n,o,!1))d.insertAfter(m,xc(n)),d.remove(o);else{let t;n=xc(n);let r=c.cloneRange();r.setStartAfter(o),r.setEndAfter(n);let l=r.extractContents();"LI"===a&&(t=l).firstChild&&"LI"===t.firstChild.nodeName?(m=l.firstChild,d.insertAfter(l,n)):(d.insertAfter(l,n),d.insertAfter(m,n)),d.remove(o)}xr(t,m)})(t,v,s,k,f);if(!(b||k!==t.getBody()&&xg(c,k)))return;let _=k.parentNode;if(b)o=v(f),p.fold(()=>{r9(g,ri(o))},t=>{r8(t,ri(o))}),t.selection.setCursorLocation(o,0);else if(oo(k))o=om(k),c.isEmpty(k)&&xa(k),xl(t,o),xr(t,o);else if(y(!1))o=C();else if(y(!0)&&_){o=_.insertBefore(v(),k);let r=ri(m.startContainer).dom.hasChildNodes()&&m.collapsed;xr(t,xf(k,"HR")||r?o:k)}else{let r=(t=>{let r=t.cloneRange();return r.setStart(t.startContainer,xp(!0,t.startContainer,t.startOffset)),r.setEnd(t.endContainer,xp(!1,t.endContainer,t.endOffset)),r})(m).cloneRange();r.setEndAfter(k);let n=r.extractContents();el(nh(ri(n),tX),t=>{let r=t.dom;r.nodeValue=on(r.data)}),(t=>{let r=t;do nT(r)&&(r.data=r.data.replace(/^[\r\n]+/,"")),r=r.firstChild;while(r)})(n),o=n.firstChild,c.insertAfter(n,k),((t,r,n)=>{var o;let a=[];if(!n)return;let l=n;for(;l=l.firstChild;){if(t.isBlock(l))return;nx(l)&&!r[l.nodeName.toLowerCase()]&&a.push(l)}let i=a.length;for(;i--;)(!(l=a[i]).hasChildNodes()||l.firstChild===l.lastChild&&""===(null===(o=l.firstChild)||void 0===o?void 0:o.nodeValue)||xm(t,l))&&t.remove(l)})(c,u,o),((t,r)=>{r.normalize();let n=r.lastChild;(!n||nx(n)&&/^(left|right)$/gi.test(t.getStyle(n,"float",!0)))&&t.add(r,"br")})(c,k),c.isEmpty(k)&&xa(k),o.normalize(),c.isEmpty(o)?(c.remove(o),C()):(xl(t,o),xr(t,o))}c.setAttrib(o,"id",""),t.dispatch("NewBlock",{newBlock:o})},fakeEventName:"insertParagraph"},xb=(t,r,n)=>{let o=t.dom.createRng();n?(o.setStartBefore(r),o.setEndBefore(r)):(o.setStartAfter(r),o.setEndAfter(r)),t.selection.setRng(o),uh(t,o)},xv=(t,r)=>{let n=rd("br");r8(ri(r),n),t.undoManager.add()},xy=(t,r)=>{xC(t.getBody(),r)||r5(ri(r),rd("br"));let n=rd("br");r5(ri(r),n),xb(t,n.dom,!1),t.undoManager.add()},xC=(t,r)=>!!nM(lx.after(r).getNode())||dl(t,lx.after(r)).map(t=>nM(t.getNode())).getOr(!1),xw=t=>t&&"A"===t.nodeName&&"href"in t,xx=t=>t.fold(X,xw,xw,X),xE=(t,r)=>{r.fold(U,V(xv,t),V(xy,t),U)},xk={insert:(t,r)=>{let n=(t=>{let r=V(fr,t),n=lx.fromRangeStart(t.selection.getRng());return vj(r,t.getBody(),n).filter(xx)})(t);n.isSome()?n.each(V(xE,t)):((t,r)=>{let n=t.selection,o=t.dom,a=n.getRng(),l,i=!1;c3(o,a).each(t=>{a.setStart(t.startContainer,t.startOffset),a.setEnd(t.endContainer,t.endOffset)});let s=a.startOffset,d=a.startContainer;if(nx(d)&&d.hasChildNodes()){let t=s>d.childNodes.length-1;d=d.childNodes[Math.min(s,d.childNodes.length-1)]||d,s=t&&nT(d)?d.data.length:0}let c=o.getParent(d,o.isBlock),u=c&&c.parentNode?o.getParent(c.parentNode,o.isBlock):null,m=u?u.nodeName.toUpperCase():"",f=!(!r||!r.ctrlKey);"LI"!==m||f||(c=u),nT(d)&&s>=d.data.length&&(((t,r,n)=>{let o;let a=new ny(r,n),l=t.getNonEmptyElements();for(;o=a.next();)if(l[o.nodeName.toLowerCase()]||nT(o)&&o.length>0)return!0;return!1})(t.schema,d,c||o.getRoot())||(l=o.create("br"),a.insertNode(l),a.setStartAfter(l),a.setEndAfter(l),i=!0)),l=o.create("br"),lk(o,a,l),xb(t,l,i),t.undoManager.add()})(t,r)},fakeEventName:"insertLineBreak"},xS=(t,r)=>xo(t).filter(t=>r.length>0&&rf(ri(t),r)).isSome(),x_=lH([{br:[]},{block:[]},{none:[]}]),xN=(t,r)=>xS(t,io(t)),xR=t=>(r,n)=>xo(r).filter(t=>n8(ri(t))).isSome()===t,xA=(t,r)=>(n,o)=>xo(n).fold(H(""),t=>t.nodeName.toUpperCase())===t.toUpperCase()===r,xO=t=>P(xn(t.dom,t.selection.getStart())),xT=t=>xA("pre",t),xB=t=>(r,n)=>l4(r)===t,xD=(t,r)=>xS(t,ir(t)),xP=(t,r)=>r,xL=t=>{let r=l7(t),n=xn(t.dom,t.selection.getStart());return L(n)&&t.schema.isValidChild(n.nodeName,r)},xF=t=>{let r=t.selection.getRng(),n=rR(ri(r.startContainer),r.startOffset).map(t=>tG(t)&&!rK(t));return r.collapsed&&n.getOr(!0)},xM=(t,r)=>(n,o)=>eu(t,(t,r)=>t&&r(n,o),!0)?J.some(r):J.none(),xI=(t,r,n)=>{r.selection.isCollapsed()||(t=>{t.execCommand("delete")})(r),L(n)&&w9(r,t.fakeEventName).isDefaultPrevented()||(t.insert(r,n),L(n)&&w6(r,t.fakeEventName))},xU=(t,r)=>{let n=()=>xI(xk,t,r),o=()=>xI(xh,t,r),a=vT([xM([xN],x_.none()),xM([xT(!0),xO],x_.none()),xM([xA("summary",!0)],x_.br()),xM([xT(!0),xB(!1),xP],x_.br()),xM([xT(!0),xB(!1)],x_.block()),xM([xT(!0),xB(!0),xP],x_.block()),xM([xT(!0),xB(!0)],x_.br()),xM([xR(!0),xP],x_.br()),xM([xR(!0)],x_.block()),xM([xD],x_.br()),xM([xP],x_.br()),xM([xL],x_.block()),xM([xF],x_.block())],[t,!(!r||!r.shiftKey)]).getOr(x_.none());switch(it(t)){case"linebreak":a.fold(n,n,U);break;case"block":a.fold(o,o,U);break;case"invert":a.fold(o,n,U);break;default:a.fold(n,o,U)}},xz=tS(),xj=xz.os.isiOS()&&xz.browser.isSafari(),xH=(t,r)=>{var n;r.isDefaultPrevented()||(r.preventDefault(),(n=t.undoManager).typing&&(n.typing=!1,n.add()),t.undoManager.transact(()=>{xU(t,r)}))},x$=tS(),xq=t=>t.stopImmediatePropagation(),xV=t=>t.keyCode===cR.PAGE_UP||t.keyCode===cR.PAGE_DOWN,xW=(t,r,n)=>{n&&!t.get()?r.on("NodeChange",xq,!0):!n&&t.get()&&r.off("NodeChange",xq),t.set(n)},xK=(t,r)=>{let n=r.container(),o=r.offset();return nT(n)?(n.insertData(o,t),J.some(lx(n,o+t.length))):s0(r).map(n=>{let o=rc(t);return r.isAtEnd()?r5(n,o):r8(n,o),lx(o.dom,t.length)})},xG=V(xK,"\xa0"),xY=V(xK," "),xX=t=>r=>{t.selection.setRng(r.toRange()),t.nodeChanged()},xQ=t=>{let r=lx.fromRangeStart(t.selection.getRng()),n=ri(t.getBody());if(t.selection.isCollapsed()){let o=V(fr,t),a=lx.fromRangeStart(t.selection.getRng());return vj(o,t.getBody(),a).bind(t=>t.fold(t=>di(n.dom,lx.before(t)),t=>ds(t),t=>dd(t),t=>dl(n.dom,lx.after(t)))).map(o=>()=>(mq(n,o)?xG(r):xY(r)).each(xX(t)))}return J.none()},xJ=t=>{var r,n;return tz(tB.browser.isFirefox()&&t.selection.isEditable()&&(r=t.dom,n=t.selection.getRng().startContainer,r.isEditable(r.getParent(n,"summary"))),()=>{let r;let n=ri(t.getBody());t.selection.isCollapsed()||t.getDoc().execCommand("Delete"),(mq(n,r=lx.fromRangeStart(t.selection.getRng()))?xG(r):xY(r)).each(xX(t))})},xZ=t=>sk(t)?[{keyCode:cR.TAB,action:Cu(CI,t,!0)},{keyCode:cR.TAB,shiftKey:!0,action:Cu(CI,t,!1)}]:[],x0=t=>{if(t.addShortcut("Meta+P","","mcePrint"),wG(t),hZ(t))return aL(null);{let r,n;let o=yk(t);return(t=>{t.on("keyup compositionstart",V(Ce,t))})(t),((t,r)=>{t.on("keydown",n=>{n.isDefaultPrevented()||((t,r,n)=>{let o=tB.os.isMacOS()||tB.os.isiOS();Cm([{keyCode:cR.RIGHT,action:Cu(Cr,t,!0)},{keyCode:cR.LEFT,action:Cu(Cr,t,!1)},{keyCode:cR.UP,action:Cu(Cn,t,!1)},{keyCode:cR.DOWN,action:Cu(Cn,t,!0)},...o?[{keyCode:cR.UP,action:Cu(Ca,t,!1),metaKey:!0,shiftKey:!0},{keyCode:cR.DOWN,action:Cu(Ca,t,!0),metaKey:!0,shiftKey:!0}]:[],{keyCode:cR.RIGHT,action:Cu(CD,t,!0)},{keyCode:cR.LEFT,action:Cu(CD,t,!1)},{keyCode:cR.UP,action:Cu(CP,t,!1)},{keyCode:cR.DOWN,action:Cu(CP,t,!0)},{keyCode:cR.UP,action:Cu(CP,t,!1)},{keyCode:cR.UP,action:Cu(Cs,t,!1)},{keyCode:cR.DOWN,action:Cu(Cs,t,!0)},{keyCode:cR.RIGHT,action:Cu(Cg,t,!0)},{keyCode:cR.LEFT,action:Cu(Cg,t,!1)},{keyCode:cR.UP,action:Cu(Cp,t,!1)},{keyCode:cR.DOWN,action:Cu(Cp,t,!0)},{keyCode:cR.RIGHT,action:Cu(yx,t,r,!0)},{keyCode:cR.LEFT,action:Cu(yx,t,r,!1)},{keyCode:cR.RIGHT,ctrlKey:!o,altKey:o,action:Cu(yS,t,r)},{keyCode:cR.LEFT,ctrlKey:!o,altKey:o,action:Cu(y_,t,r)},{keyCode:cR.UP,action:Cu(Ci,t,!1)},{keyCode:cR.DOWN,action:Cu(Ci,t,!0)}],n).each(t=>{n.preventDefault()})})(t,r,n)})})(t,o),r=!1,t.on("keydown",n=>{r=n.keyCode===cR.BACKSPACE,n.isDefaultPrevented()||((t,r,n)=>{let o=n.keyCode===cR.BACKSPACE?"deleteContentBackward":"deleteContentForward",a=t.selection.isCollapsed(),l=a?"character":"selection",i=t=>a?t?"word":"line":"selection";Cf([{keyCode:cR.BACKSPACE,action:Cu(yQ,t)},{keyCode:cR.BACKSPACE,action:Cu(vC,t,!1)},{keyCode:cR.DELETE,action:Cu(vC,t,!0)},{keyCode:cR.BACKSPACE,action:Cu(vm,t,!1)},{keyCode:cR.DELETE,action:Cu(vm,t,!0)},{keyCode:cR.BACKSPACE,action:Cu(yO,t,r,!1)},{keyCode:cR.DELETE,action:Cu(yO,t,r,!0)},{keyCode:cR.BACKSPACE,action:Cu(fz,t,!1)},{keyCode:cR.DELETE,action:Cu(fz,t,!0)},{keyCode:cR.BACKSPACE,action:Cu(w8,t,!1,l)},{keyCode:cR.DELETE,action:Cu(w8,t,!0,l)},...xe?[{keyCode:cR.BACKSPACE,altKey:!0,action:Cu(w8,t,!1,i(!0))},{keyCode:cR.DELETE,altKey:!0,action:Cu(w8,t,!0,i(!0))},{keyCode:cR.BACKSPACE,metaKey:!0,action:Cu(w8,t,!1,i(!1))}]:[{keyCode:cR.BACKSPACE,ctrlKey:!0,action:Cu(w8,t,!1,i(!0))},{keyCode:cR.DELETE,ctrlKey:!0,action:Cu(w8,t,!0,i(!0))}],{keyCode:cR.BACKSPACE,action:Cu(vw,t,!1)},{keyCode:cR.DELETE,action:Cu(vw,t,!0)},{keyCode:cR.BACKSPACE,action:Cu(y$,t,!1)},{keyCode:cR.DELETE,action:Cu(y$,t,!0)},{keyCode:cR.BACKSPACE,action:Cu(va,t,!1)},{keyCode:cR.DELETE,action:Cu(va,t,!0)},{keyCode:cR.BACKSPACE,action:Cu(vr,t,!1)},{keyCode:cR.DELETE,action:Cu(vr,t,!0)},{keyCode:cR.BACKSPACE,action:Cu(yU,t,!1)},{keyCode:cR.DELETE,action:Cu(yU,t,!0)}],n).filter(r=>t.selection.isEditable()).each(r=>{n.preventDefault(),w9(t,o).isDefaultPrevented()||(r(),w6(t,o))})})(t,o,n)}),t.on("keyup",n=>{var o;n.isDefaultPrevented()||(o=r,Cm([{keyCode:cR.BACKSPACE,action:Cu(vy,t)},{keyCode:cR.DELETE,action:Cu(vy,t)},...xe?[{keyCode:cR.BACKSPACE,altKey:!0,action:Cu(yj,t)},{keyCode:cR.DELETE,altKey:!0,action:Cu(yj,t)},...o?[{keyCode:xt?224:91,action:Cu(yj,t)}]:[]]:[{keyCode:cR.BACKSPACE,ctrlKey:!0,action:Cu(yj,t)},{keyCode:cR.DELETE,ctrlKey:!0,action:Cu(yj,t)}]],n)),r=!1}),n=J.none(),t.on("keydown",r=>{r.keyCode===cR.ENTER&&(xj&&(t=>{if(!t.collapsed)return!1;let r=t.startContainer;if(nT(r)){let n=r.data.charAt(t.startOffset-1);return/^[\uAC00-\uD7AF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uD7B0-\uD7FF]$/.test(n)}return!1})(t.selection.getRng())?(n=J.some(t.selection.getBookmark()),t.undoManager.add()):xH(t,r))}),t.on("keyup",r=>{r.keyCode===cR.ENTER&&n.each(()=>{t.undoManager.undo(),n.fold(U,r=>t.selection.moveToBookmark(r)),xH(t,r),n=J.none()})}),(t=>{t.on("keydown",r=>{r.isDefaultPrevented()||((t,r)=>{Cf([{keyCode:cR.SPACEBAR,action:Cu(xQ,t)},{keyCode:cR.SPACEBAR,action:Cu(xJ,t)}],r).each(n=>{r.preventDefault(),w9(t,"insertText",{data:" "}).isDefaultPrevented()||(n(),w6(t,"insertText",{data:" "}))})})(t,r)})})(t),(t=>{t.on("input",r=>{r.isComposing||(t=>{let r=ri(t.getBody());t.selection.isCollapsed()&&mJ(r,lx.fromRangeStart(t.selection.getRng())).each(r=>{t.selection.setRng(r.toRange())})})(t)})})(t),(t=>{t.on("keydown",r=>{r.isDefaultPrevented()||((t,r)=>{Cm([...xZ(t)],r).each(t=>{r.preventDefault()})})(t,r)})})(t),((t,r)=>{t.on("keydown",n=>{n.isDefaultPrevented()||((t,r,n)=>{let o=tB.os.isMacOS()||tB.os.isiOS();Cm([{keyCode:cR.END,action:Cu(Co,t,!0)},{keyCode:cR.HOME,action:Cu(Co,t,!1)},...o?[]:[{keyCode:cR.HOME,action:Cu(Ca,t,!1),ctrlKey:!0,shiftKey:!0},{keyCode:cR.END,action:Cu(Ca,t,!0),ctrlKey:!0,shiftKey:!0}],{keyCode:cR.END,action:Cu(Ch,t,!0)},{keyCode:cR.HOME,action:Cu(Ch,t,!1)},{keyCode:cR.END,action:Cu(yN,t,!0,r)},{keyCode:cR.HOME,action:Cu(yN,t,!1,r)}],n).each(t=>{n.preventDefault()})})(t,r,n)})})(t,o),((t,r)=>{if(x$.os.isMacOS())return;let n=aL(!1);t.on("keydown",r=>{xV(r)&&xW(n,t,!0)}),t.on("keyup",o=>{o.isDefaultPrevented()||Cm([{keyCode:cR.PAGE_UP,action:Cu(yN,t,!1,r)},{keyCode:cR.PAGE_DOWN,action:Cu(yN,t,!0,r)}],o),xV(o)&&n.get()&&(xW(n,t,!1),t.nodeChanged())})})(t,o),o}};class x1{constructor(t){let r;this.lastPath=[],this.editor=t;let n=this;"onselectionchange"in t.getDoc()||t.on("NodeChange click mouseup keyup focus",n=>{let o=t.selection.getRng(),a={startContainer:o.startContainer,startOffset:o.startOffset,endContainer:o.endContainer,endOffset:o.endOffset};"nodechange"!==n.type&&cX(a,r)||t.dispatch("SelectionChange"),r=a}),t.on("contextmenu",()=>{t.dispatch("SelectionChange")}),t.on("SelectionChange",()=>{let r=t.selection.getStart(!0);r&&d$(t)&&!n.isSameElementPath(r)&&t.dom.isChildOf(r,t.getBody())&&t.nodeChanged({selectionChange:!0})}),t.on("mouseup",r=>{!r.isDefaultPrevented()&&d$(t)&&("IMG"===t.selection.getNode().nodeName?uA.setEditorTimeout(t,()=>{t.nodeChanged()}):t.nodeChanged())})}nodeChanged(t={}){let r;let n=this.editor.selection;if(this.editor.initialized&&n&&!iY(this.editor)&&!this.editor.mode.isReadOnly()){let o=this.editor.getBody();(r=n.getStart(!0)||o).ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(r,o)||(r=o);let a=[];this.editor.dom.getParent(r,t=>t===o||(a.push(t),!1)),this.editor.dispatch("NodeChange",{...t,element:r,parents:a})}}isSameElementPath(t){let r;let n=this.editor,o=ev(n.dom.getParents(t,Q,n.getBody()));if(o.length===this.lastPath.length){for(r=o.length;r>=0&&o[r]===this.lastPath[r];r--);if(-1===r)return this.lastPath=o,!0}return this.lastPath=o,!1}}let x2=a3("image"),x3=a3("event"),x8=t=>r=>{r[x3]=t},x5=x8(0),x6=x8(2),x9=x8(1),x4=t=>J.from(t[x3]).exists(t=>0===t),x7=a3("mode"),Ee=t=>r=>{r[x7]=t},Et=(t,r)=>Ee(r)(t),Er=Ee(0),En=Ee(2),Eo=Ee(1),Ea=t=>r=>J.from(r[x7]).exists(r=>r===t),El=Ea(0),Ei=Ea(1),Es=["none","copy","link","move"],Ed=["none","copy","copyLink","copyMove","link","linkMove","move","all","uninitialized"],Ec=()=>{let t=new window.DataTransfer,r="move",n="all",o={get dropEffect(){return r},set dropEffect(e){en(Es,e)&&(r=e)},get effectAllowed(){return n},set effectAllowed(e){x4(o)&&en(Ed,e)&&(n=e)},get items(){let r;return{...r=t.items,get length(){return r.length},add:(t,n)=>{if(El(o)){if(!N(t))return r.add(t);if(!D(n))return r.add(t,n)}return null},remove:t=>{El(o)&&r.remove(t)},clear:()=>{El(o)&&r.clear()}}},get files(){return Ei(o)?Object.freeze({length:0,item:t=>null}):t.files},get types(){return t.types},setDragImage:(r,n,a)=>{var l;El(o)&&(l={image:r,x:n,y:a},o[x2]=l,t.setDragImage(r,n,a))},getData:r=>Ei(o)?"":t.getData(r),setData:(r,n)=>{El(o)&&t.setData(r,n)},clearData:r=>{El(o)&&t.clearData(r)}};return Er(o),o},Eu=(t,r)=>t.setData("text/html",r),Em="x-tinymce/html",Ef=H(Em),Eg="<!-- "+Em+" -->",Ep=t=>Eg+t,Eh=t=>-1!==t.indexOf(Eg),Eb="%MCEPASTEBIN%",Ev=t=>t.dom.get("mcepastebin"),Ey=t=>L(t)&&"mcepastebin"===t.id,EC=t=>t===Eb,Ew=(t,r)=>(tF.each(r,r=>{t=_(r,RegExp)?t.replace(r,""):t.replace(r[0],r[1])}),t),Ex=t=>Ew(t,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,(t,r,n)=>r||n?"\xa0":" "],/<br class="Apple-interchange-newline">/g,/<br>$/i]),EE=(t,r)=>({content:t,cancelled:r}),Ek=(t,r)=>(t.insertContent(r,{merge:sd(t),paste:!0}),!0),ES=t=>/^https?:\/\/[\w\-\/+=.,!;:&%@^~(){}?#]+$/i.test(t),E_=(t,r,n)=>!(t.selection.isCollapsed()||!ES(r))&&(t.undoManager.extra(()=>{n(t,r)},()=>{t.execCommand("mceInsertLink",!1,r)}),!0),EN=(t,r,n)=>!!(ES(r)&&eo(sE(t),t=>e8(r.toLowerCase(),`.${t.toLowerCase()}`)))&&(t.undoManager.extra(()=>{n(t,r)},()=>{t.insertContent('<img src="'+r+'">')}),!0),ER=(l=0,()=>"mceclip"+l++),EA=t=>{let r=Ec();return Eu(r,t),En(r),r},EO=(t,r,n,o,a)=>{let l=((t,r,n)=>{let o=t.dispatch("PastePreProcess",{content:r,internal:n}),a=((t,r)=>{let n=hC({sanitize:sw(t)},t.schema);n.addNodeFilter("meta",t=>{tF.each(t,t=>{t.remove()})});let o=n.parse(r,{forced_root_block:!1,isRootContent:!0});return mr({validate:!0},t.schema).serialize(o)})(t,o.content);return t.hasEventListeners("PastePostProcess")&&!o.isDefaultPrevented()?((t,r,n)=>{let o=t.dom.create("div",{style:"display:none"},r),a=t.dispatch("PastePostProcess",{node:o,internal:n});return EE(a.node.innerHTML,a.isDefaultPrevented())})(t,a,n):EE(a,o.isDefaultPrevented())})(t,r,n);if(!l.cancelled){let r=l.content,n=()=>{o||!sc(t)?Ek(t,r):tF.each([E_,EN,Ek],n=>!n(t,r,Ek))};a?w9(t,"insertFromPaste",{dataTransfer:EA(r)}).isDefaultPrevented()||(n(),w6(t,"insertFromPaste")):n()}},ET=(t,r,n,o)=>{let a=n||Eh(r);EO(t,r.replace(Eg,""),a,!1,o)},EB=(t,r,n)=>{let o=((t,r,n)=>{let o=t.split(/\n\n/),a=((t,r)=>{let n="<"+t,o=eL(r,(t,r)=>r+'="'+at.encodeAllRaw(t)+'"');return o.length&&(n+=" "+o.join(" ")),n+">"})(r,n),l="</"+r+">",i=ea(o,t=>t.split(/\n/).join("<br />"));return 1===i.length?i[0]:ea(i,t=>a+t+l).join("")})(ok(t.dom.encode(r).replace(/\r\n/g,"\n"),sm(t)),l7(t),ie(t));EO(t,o,!1,!0,n)},ED=t=>{let r={};if(t&&t.types)for(let n=0;n<t.types.length;n++){let o=t.types[n];try{r[o]=t.getData(o)}catch(t){r[o]=""}}return r},EP=(t,r)=>r in t&&t[r].length>0,EL=t=>EP(t,"text/html")||EP(t,"text/plain"),EF=(t,r,n)=>{let o="paste"===r.type?r.clipboardData:r.dataTransfer;if(sn(t)&&o){let a=((t,r)=>{let n=r.items?eh(eS(r.items),t=>"file"===t.kind?[t.getAsFile()]:[]):[],o=r.files?eS(r.files):[];return ed(n.length>0?n:o,(t=>{let r=sE(t);return t=>e3(t.type,"image/")&&eo(r,r=>(t=>{let r=t.toLowerCase(),n={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"};return tF.hasOwn(n,r)?"image/"+n[r]:"image/"+r})(r)===t.type)})(t))})(t,o);if(a.length>0)return r.preventDefault(),Promise.all(ea(a,t=>pl(t).then(r=>({file:t,uri:r})))).then(r=>{n&&t.selection.setRng(n),el(r,r=>{((t,r)=>{po(r.uri).each(({data:n,type:o,base64Encoded:a})=>{let l=a?n:btoa(n),i=r.file,s=t.editorUpload.blobCache,d=s.getByData(l,o),c=null!=d?d:((t,r,n,o)=>{let a=ER(),l=is(t)&&L(n.name),i=l?((t,r)=>{let n=r.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return L(n)?t.dom.encode(n[1]):void 0})(t,n.name):a,s=l?n.name:void 0,d=r.create(a,n,o,i,s);return r.add(d),d})(t,s,i,l);ET(t,`<img src="${c.blobUri()}">`,!1,!0)})})(t,r)})}),!0}return!1},EM=(t,r,n,o,a)=>{let l,i=Ex(n),s=EP(r,Ef())||Eh(n),d=!s&&(l=i,!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(l)),c=ES(i);(EC(i)||!i.length||d&&!c)&&(o=!0),(o||c)&&(i=EP(r,"text/plain")&&d?r["text/plain"]:(t=>{let r=am(),n=hC({},r),o="",a=r.getVoidElements(),l=tF.makeMap("script noscript style textarea video audio iframe object"," "),i=r.getBlockElements(),s=t=>{let n=t.name;if("br"!==n){if("wbr"!==n){if(a[n]&&(o+=" "),l[n])o+=" ";else{if(3===t.type&&(o+=t.value),!(t.name in r.getVoidElements())){let r=t.firstChild;if(r)do s(r);while(r=r.next)}i[n]&&t.next&&(o+="\n","p"===n&&(o+="\n"))}}}else o+="\n"};return t=Ew(t,[/<!\[[^\]]+\]>/g]),s(n.parse(t)),o})(i)),EC(i)||(o?EB(t,i,a):ET(t,i,s,a))},EI=(t,r,n)=>{let o;t.on("keydown",t=>{(cR.metaKeyPressed(t)&&86===t.keyCode||t.shiftKey&&45===t.keyCode)&&!t.isDefaultPrevented()&&(o=t.shiftKey&&86===t.keyCode)}),t.on("paste",a=>{var l,i;if(a.isDefaultPrevented()||tB.os.isAndroid()&&0===(null===(i=null===(l=a.clipboardData)||void 0===l?void 0:l.items)||void 0===i?void 0:i.length))return;let s="text"===n.get()||o;o=!1;let d=ED(a.clipboardData);!EL(d)&&EF(t,a,r.getLastRng()||t.selection.getRng())||(EP(d,"text/html")?(a.preventDefault(),EM(t,d,d["text/html"],s,!0)):EP(d,"text/plain")&&EP(d,"text/uri-list")?(a.preventDefault(),EM(t,d,d["text/plain"],s,!0)):(r.create(),uA.setEditorTimeout(t,()=>{let n=r.getHtml();r.remove(),EM(t,d,n,s,!1)},0)))}),(t=>{let r=t=>e3(t,"webkit-fake-url"),n=t=>e3(t,"data:");t.parser.addNodeFilter("img",(o,a,l)=>{var i;if(!sn(t)&&!0===(null===(i=l.data)||void 0===i?void 0:i.paste))for(let a of o){let o=a.attr("src");N(o)&&!a.attr("data-mce-object")&&o!==tB.transparentSrc&&(r(o)||!sf(t)&&n(o))&&a.remove()}})})(t)},EU=(t,r,n,o)=>{((t,r,n)=>{if(!t)return!1;try{return t.clearData(),t.setData("text/html",r),t.setData("text/plain",n),t.setData(Ef(),r),!0}catch(t){return!1}})(t.clipboardData,r.html,r.text)?(t.preventDefault(),o()):n(r.html,o)},Ez=t=>(r,n)=>{let{dom:o,selection:a}=t,l=o.create("div",{contenteditable:"false","data-mce-bogus":"all"}),i=o.create("div",{contenteditable:"true"},r);o.setStyles(l,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),l.appendChild(i),o.add(t.getBody(),l);let s=a.getRng();i.focus();let d=o.createRng();d.selectNodeContents(i),a.setRng(d),uA.setEditorTimeout(t,()=>{a.setRng(s),o.remove(l),n()},0)},Ej=t=>({html:Ep(t.selection.getContent({contextual:!0})),text:t.selection.getContent({format:"text"})}),EH=t=>!t.selection.isCollapsed()||!!t.dom.getParent(t.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",t.getBody()),E$=(t,r)=>{var n,o;return c6.getCaretRangeFromPoint(null!==(n=r.clientX)&&void 0!==n?n:0,null!==(o=r.clientY)&&void 0!==o?o:0,t.getDoc())},Eq=(t,r)=>{t.focus(),r&&t.selection.setRng(r)},EV=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,EW=t=>tF.trim(t).replace(EV,dP).toLowerCase(),EK=(t,r,n)=>{let o=si(t);if(n||"all"===o||!ss(t))return r;let a=o?o.split(/[, ]/):[];if(a&&"none"!==o){let n=t.dom,o=t.selection.getNode();r=r.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(t,r,l,i)=>{let s=n.parseStyle(n.decode(l)),d={};for(let t=0;t<a.length;t++){let r=s[a[t]],l=r,i=n.getStyle(o,a[t],!0);/color/.test(a[t])&&(l=EW(l),i=EW(i)),i!==l&&(d[a[t]]=r)}let c=n.serializeStyle(d,"span");return c?r+' style="'+c+'"'+i:r+i})}else r=r.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return r=r.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(t,r,n,o)=>r+' style="'+n+'"'+o)},EG=t=>{let r=aL(!1),n=aL(su(t)?"text":"html"),o=(t=>{let r=aL(null);return{create:()=>((t,r)=>{let{dom:n,selection:o}=t,a=t.getBody();r.set(o.getRng());let l=n.add(t.getBody(),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},Eb);tB.browser.isFirefox()&&n.setStyle(l,"left","rtl"===n.getStyle(a,"direction",!0)?65535:-65535),n.bind(l,"beforedeactivate focusin focusout",t=>{t.stopPropagation()}),l.focus(),o.select(l,!0)})(t,r),remove:()=>((t,r)=>{let n=t.dom;if(Ev(t)){let o;let a=r.get();for(;o=Ev(t);)n.remove(o),n.unbind(o);a&&t.selection.setRng(a)}r.set(null)})(t,r),getEl:()=>Ev(t),getHtml:()=>(t=>{let r=t.dom,n=(t,n)=>{t.appendChild(n),r.remove(n,!0)},[o,...a]=ed(t.getBody().childNodes,Ey);el(a,t=>{n(o,t)});let l=r.select("div[id=mcepastebin]",o);for(let t=l.length-1;t>=0;t--){let a=r.create("div");o.insertBefore(a,l[t]),n(a,l[t])}return o?o.innerHTML:""})(t),getLastRng:r.get}})(t);(tB.browser.isChromium()||tB.browser.isSafari())&&((t,r)=>{t.on("PastePreProcess",n=>{n.content=r(t,n.content,n.internal)})})(t,EK),t.addCommand("mceTogglePlainTextPaste",()=>{"text"===n.get()?(n.set("html"),cN(t,!1)):(n.set("text"),cN(t,!0)),t.focus()}),t.addCommand("mceInsertClipboardContent",(r,n)=>{n.html&&ET(t,n.html,n.internal,!1),n.text&&EB(t,n.text,!1)}),(t=>{let r=r=>n=>{r(t,n)},n=so(t);F(n)&&t.on("PastePreProcess",r(n));let o=sa(t);F(o)&&t.on("PastePostProcess",r(o))})(t),t.on("PreInit",()=>{t.on("cut",r=>{!r.isDefaultPrevented()&&EH(t)&&EU(r,Ej(t),Ez(t),()=>{if(tB.browser.isChromium()||tB.browser.isFirefox()){let r=t.selection.getRng();uA.setEditorTimeout(t,()=>{t.selection.setRng(r),t.execCommand("Delete")},0)}else t.execCommand("Delete")})}),t.on("copy",r=>{!r.isDefaultPrevented()&&EH(t)&&EU(r,Ej(t),Ez(t),U)}),sr(t)&&t.on("dragend dragover draggesture dragdrop drop drag",t=>{t.preventDefault(),t.stopPropagation()}),sn(t)||t.on("drop",t=>{let r=t.dataTransfer;r&&eo(r.files,t=>/^image\//.test(t.type))&&t.preventDefault()}),t.on("drop",n=>{if(n.isDefaultPrevented())return;let o=E$(t,n);if(P(o))return;let a=ED(n.dataTransfer),l=EP(a,Ef());if((!EL(a)||(t=>{let r=t["text/plain"];return!!r&&0===r.indexOf("file://")})(a))&&EF(t,n,o))return;let i=a[Ef()],s=i||a["text/html"]||a["text/plain"],d=((t,r,n,o)=>{let a=t.getParent(n,t=>oj(r,t));return!T(t.getParent(n,"summary"))||!!(a&&eI(o,"text/html"))&&!T((new DOMParser).parseFromString(o["text/html"],"text/html").body.querySelector(a.nodeName.toLowerCase()))})(t.dom,t.schema,o.startContainer,a),c=r.get();c&&!d||s&&(n.preventDefault(),uA.setEditorTimeout(t,()=>{t.undoManager.transact(()=>{(i||c&&d)&&t.execCommand("Delete"),Eq(t,o);let r=Ex(s);a["text/html"]?ET(t,r,l,!0):EB(t,r,!0)})}))}),t.on("dragstart",t=>{r.set(!0)}),t.on("dragover dragend",n=>{sn(t)&&!r.get()&&(n.preventDefault(),Eq(t,E$(t,n))),"dragend"===n.type&&r.set(!1)}),(t=>{t.on("input",r=>{"deleteByDrag"===r.inputType&&el(ed(t.dom.select("details"),t=>T(t.querySelector("summary"))),r=>{nM(r.firstChild)&&r.firstChild.remove();let n=t.dom.create("summary");n.appendChild(oe().dom),r.prepend(n)})})})(t),EI(t,o,n)})},EY=t=>nz(t.dom),EX=t=>r=>rp(ri(t),r),EQ=(t,r)=>r$(ri(t),EY,EX(r)),EJ=(t,r,n)=>{let o=new ny(t,r),a=n?o.next.bind(o):o.prev.bind(o),l=t;for(let r=n?t:a();r&&!nM(r);r=a())ob(r)&&(l=r);return l},EZ=t=>{let r=((t,r)=>{let n=lx.fromRangeStart(t).getNode(),o=r$(ri(n),t=>nU(t.dom)||nZ(t),EX(r)).getOr(ri(r)).dom,a=EJ(n,o,!1),l=EJ(n,o,!0),i=document.createRange();return EQ(a,o).fold(()=>{nT(a)?i.setStart(a,0):i.setStartBefore(a)},t=>i.setStartBefore(t.dom)),EQ(l,o).fold(()=>{nT(l)?i.setEnd(l,l.data.length):i.setEndAfter(l)},t=>i.setEndAfter(t.dom)),i})(t.selection.getRng(),t.getBody());t.selection.setRng(f1(r))};(c=g||(g={})).Before="before",c.After="after";let E0=(t,r)=>Math.abs(t.left-r),E1=(t,r)=>Math.abs(t.right-r),E2=(t,r)=>eu(ed(t,t=>r>=t.top&&r<=t.bottom),(t,r)=>t.fold(()=>J.some(r),t=>{let n=Math.min(r.left,t.left),o=Math.min(r.top,t.top),a=Math.max(r.right,t.right),l=Math.max(r.bottom,t.bottom);return J.some({top:o,right:a,bottom:l,left:n,width:a-n,height:l-o})}),J.none()).fold(()=>[[],t],r=>{let{pass:n,fail:o}=es(t,t=>((t,r)=>{let n=Math.max(0,Math.min(t.bottom,r.bottom)-Math.max(t.top,r.top))/Math.min(t.height,r.height);return t.top<r.bottom&&t.bottom>r.top&&n>.5})(t,r));return[n,o]}),E3=(t,r,n)=>r>t.left&&r<t.right?0:Math.min(Math.abs(t.left-r),Math.abs(t.right-r)),E8=(t,r,n)=>{let o=t=>ob(t.node)?J.some(t):nx(t.node)?E8(eS(t.node.childNodes),r,n):J.none(),a=(t,a)=>{let l=ew(t,(t,o)=>a(t,r,n)-a(o,r,n));return((t,a)=>{if(t.length>=2){let l=o(t[0]).getOr(t[0]),i=o(t[1]).getOr(t[1]);if(2>Math.abs(a(l,r,n)-a(i,r,n))){if(nT(l.node))return J.some(l);if(nT(i.node))return J.some(i)}}return J.none()})(l,a).orThunk(()=>e_(l,o))},[l,i]=E2(ya(t),n),{pass:s,fail:d}=es(i,t=>t.top<n);return a(l,E3).orThunk(()=>a(d,la)).orThunk(()=>a(s,la))},E5=(t,r,n)=>((t,r,n)=>{let o=ri(t),a=ru(rv(o),r,n).filter(t=>rh(o,t)).getOr(o);return((t,r,n,o)=>{let a=(r,l)=>{let i=ed(r.dom.childNodes,W(t=>nx(t)&&t.classList.contains("mce-drag-container")));return l.fold(()=>E8(i,n,o),t=>E8(ed(i,r=>r!==t.dom),n,o)).orThunk(()=>(rp(r,t)?J.none():rw(r)).bind(t=>a(t,J.some(r))))};return a(r,J.none())})(o,a,r,n)})(t,r,n).filter(t=>sM(t.node)).map(t=>({node:t.node,position:E0(t,r)<E1(t,r)?g.Before:g.After})),E6=t=>{var r,n;let o=t.getBoundingClientRect(),a=t.ownerDocument,l=a.documentElement,i=a.defaultView;return{top:o.top+(null!==(r=null==i?void 0:i.scrollY)&&void 0!==r?r:0)-l.clientTop,left:o.left+(null!==(n=null==i?void 0:i.scrollX)&&void 0!==n?n:0)-l.clientLeft}},E9=t=>({target:t,srcElement:t}),E4=(t,r,n,o)=>{let a=((t,r)=>{let n=(t=>{let r=Ec(),n=J.from(t[x7]);return En(t),x5(r),r.dropEffect=t.dropEffect,r.effectAllowed=t.effectAllowed,J.from(t[x2]).each(t=>r.setDragImage(t.image,t.x,t.y)),el(t.types,n=>{"Files"!==n&&r.setData(n,t.getData(n))}),el(t.files,t=>r.items.add(t)),J.from(t[x3]).each(t=>{((t,r)=>{x8(r)(t)})(r,t)}),n.each(n=>{Et(t,n),Et(r,n)}),r})(t);return"dragstart"===r?(x5(n),Er(n)):"drop"===r?(x6(n),En(n)):(x9(n),Eo(n)),n})(n,t);return D(o)?((t,r,n)=>{let o=K("Function not supported on simulated event.");return{bubbles:!0,cancelBubble:!1,cancelable:!0,composed:!1,currentTarget:null,defaultPrevented:!1,eventPhase:0,isTrusted:!0,returnValue:!1,timeStamp:0,type:t,composedPath:o,initEvent:o,preventDefault:U,stopImmediatePropagation:U,stopPropagation:U,AT_TARGET:window.Event.AT_TARGET,BUBBLING_PHASE:window.Event.BUBBLING_PHASE,CAPTURING_PHASE:window.Event.CAPTURING_PHASE,NONE:window.Event.NONE,altKey:!1,button:0,buttons:0,clientX:0,clientY:0,ctrlKey:!1,metaKey:!1,movementX:0,movementY:0,offsetX:0,offsetY:0,pageX:0,pageY:0,relatedTarget:null,screenX:0,screenY:0,shiftKey:!1,x:0,y:0,detail:0,view:null,which:0,initUIEvent:o,initMouseEvent:o,getModifierState:o,dataTransfer:n,...E9(r)}})(t,r,a):{...o,dataTransfer:a,type:t,...E9(r)}},E7=((...t)=>r=>{for(let n=0;n<t.length;n++)if(t[n](r))return!0;return!1})(nz,nU),ke=(t,r,n,o)=>{let a=t.dom,l=r.cloneNode(!0);a.setStyles(l,{width:n,height:o}),a.setAttrib(l,"data-mce-selected",null);let i=a.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return a.setStyles(i,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:o}),a.setStyles(l,{margin:0,boxSizing:"border-box"}),i.appendChild(l),i},kt=(t,r)=>n=>()=>{let o="left"===t?n.scrollX:n.scrollY;n.scroll({[t]:o+r,behavior:"smooth"})},kr=kt("left",-32),kn=kt("left",32),ko=kt("top",-32),ka=kt("top",32),kl=t=>{t&&t.parentNode&&t.parentNode.removeChild(t)},ki=(t,r,n,o,a)=>{"dragstart"===r&&Eu(o,t.dom.getOuterHTML(n));let l=E4(r,n,o,a);return t.dispatch(r,l)},ks=(t,r)=>{let n=a$((t,n)=>{r._selectionOverrides.hideFakeCaret(),E5(r.getBody(),t,n).fold(()=>r.selection.placeCaretAt(t,n),o=>{let a=r._selectionOverrides.showCaret(1,o.node,o.position===g.Before,!1);a?r.selection.setRng(a):r.selection.placeCaretAt(t,n)})},0);return r.on("remove",n.cancel),o=>t.on(a=>{var l,i,s,d,c;let u=Math.max(Math.abs(o.screenX-a.screenX),Math.abs(o.screenY-a.screenY));if(!a.dragging&&u>10){let t=ki(r,"dragstart",a.element,a.dataTransfer,o);if(L(t.dataTransfer)&&(a.dataTransfer=t.dataTransfer),t.isDefaultPrevented())return;a.dragging=!0,r.focus()}if(a.dragging){let u;let m=o.currentTarget===r.getDoc().documentElement,f=(s=r.inline?E6(r.getBody()):{left:0,top:0},d=(t=>{let r=t.getBody();return t.inline?{left:r.scrollLeft,top:r.scrollTop}:{left:0,top:0}})(r),{pageX:(u={pageX:(c=((t,r)=>{if(r.target.ownerDocument!==t.getDoc()){let n=E6(t.getContentAreaContainer()),o=(t=>{let r=t.getBody(),n=t.getDoc().documentElement,o={left:r.scrollLeft,top:r.scrollTop},a={left:r.scrollLeft||n.scrollLeft,top:r.scrollTop||n.scrollTop};return t.inline?o:a})(t);return{left:r.pageX-n.left+o.left,top:r.pageY-n.top+o.top}}return{left:r.pageX,top:r.pageY}})(r,o)).left-s.left+d.left,pageY:c.top-s.top+d.top}).pageX-a.relX,pageY:u.pageY+5});l=a.ghost,i=r.getBody(),l.parentNode!==i&&i.appendChild(l),((t,r,n,o,a,l,i,s,d,c,u,m)=>{let f=0,g=0;t.style.left=r.pageX+"px",t.style.top=r.pageY+"px",r.pageX+n>a&&(f=r.pageX+n-a),r.pageY+o>l&&(g=r.pageY+o-l),t.style.width=n-f+"px",t.style.height=o-g+"px";let p=d.clientHeight,h=d.clientWidth,b=i+d.getBoundingClientRect().top,v=s+d.getBoundingClientRect().left;u.on(t=>{t.intervalId.clear(),t.dragging&&m&&(i+8>=p?t.intervalId.set(ka(c)):i-8<=0?t.intervalId.set(ko(c)):s+8>=h?t.intervalId.set(kn(c)):s-8<=0?t.intervalId.set(kr(c)):b+16>=window.innerHeight?t.intervalId.set(ka(window)):b-16<=0?t.intervalId.set(ko(window)):v+16>=window.innerWidth?t.intervalId.set(kn(window)):v-16<=0&&t.intervalId.set(kr(window)))})})(a.ghost,f,a.width,a.height,a.maxX,a.maxY,o.clientY,o.clientX,r.getContentAreaContainer(),r.getWin(),t,m),n.throttle(o.clientX,o.clientY)}})},kd=(t,r,n)=>{t.on(t=>{t.intervalId.clear(),t.dragging&&n.fold(()=>ki(r,"dragend",t.element,t.dataTransfer),n=>ki(r,"dragend",t.element,t.dataTransfer,n))}),kc(t)},kc=t=>{t.on(t=>{t.intervalId.clear(),kl(t.ghost)}),t.clear()},ku=t=>{let r=aH(),n=aB.DOM,o=document,a=ks(r,t),l=n=>kd(r,t,J.some(n));t.on("mousedown",n=>{if(0===n.button){let o,a;let l=ef(t.dom.getParents(n.target),E7).getOr(null);if(L(l)&&(o=t.dom,a=t.getBody(),nz(l)&&l!==a&&o.isEditable(l.parentElement))){let o=t.dom.getPos(l),a=t.getBody(),i=t.getDoc().documentElement;r.set({element:l,dataTransfer:Ec(),dragging:!1,screenX:n.screenX,screenY:n.screenY,maxX:(t.inline?a.scrollWidth:i.offsetWidth)-2,maxY:(t.inline?a.scrollHeight:i.offsetHeight)-2,relX:n.pageX-o.x,relY:n.pageY-o.y,width:l.offsetWidth,height:l.offsetHeight,ghost:ke(t,l,l.offsetWidth,l.offsetHeight),intervalId:aj(100)})}}}),t.on("mousemove",a),t.on("mouseup",n=>{r.on(r=>{var o;if(r.intervalId.clear(),r.dragging){let a,l;if(a=(t=>{let r=t.getSel();if(L(r)){let t=r.getRangeAt(0).startContainer;return nT(t)?t.parentNode:t}return null})(t.selection),l=r.element,!P(a)&&a!==l&&!t.dom.isChildOf(a,l)&&t.dom.isEditable(a)){let a=null!==(o=t.getDoc().elementFromPoint(n.clientX,n.clientY))&&void 0!==o?o:t.getBody();ki(t,"drop",a,r.dataTransfer,n).isDefaultPrevented()||t.undoManager.transact(()=>{((t,r)=>{let n=t.getParent(r.parentNode,t.isBlock);kl(r),n&&n!==t.getRoot()&&t.isEmpty(n)&&ot(ri(n))})(t.dom,r.element),(t=>{let r=t.getData("text/html");return""===r?J.none():J.some(r)})(r.dataTransfer).each(r=>t.insertContent(r)),t._selectionOverrides.hideFakeCaret()})}ki(t,"dragend",t.getBody(),r.dataTransfer,n)}}),kc(r)}),n.bind(o,"mousemove",a),n.bind(o,"mouseup",l),t.on("remove",()=>{n.unbind(o,"mousemove",a),n.unbind(o,"mouseup",l)}),t.on("keydown",n=>{n.keyCode===cR.ESC&&kd(r,t,J.none())})},km=(t,r)=>fj(t.getBody(),r),kf=t=>{let r;let n=t.selection,o=t.dom,a=t.getBody(),l=sP(t,a,o.isBlock,()=>uI(t)),i="sel-"+o.uniqueId(),s="data-mce-selected",d=t=>t!==a&&(nz(t)||n$(t))&&o.isChildOf(t,a)&&o.isEditable(t.parentNode),c=(r,o,a,i=!0)=>t.dispatch("ShowCaret",{target:o,direction:r,before:a}).isDefaultPrevented()?null:(i&&n.scrollIntoView(o,-1===r),l.show(a,o)),u=t=>ol(t)||oc(t)||ou(t),m=t=>u(t.startContainer)||u(t.endContainer),f=r=>{let n=t.schema.getVoidElements(),a=o.createRng(),l=r.startContainer,i=r.startOffset,s=r.endContainer,d=r.endOffset;return eI(n,l.nodeName.toLowerCase())?0===i?a.setStartBefore(l):a.setStartAfter(l):a.setStart(l,i),eI(n,s.nodeName.toLowerCase())?0===d?a.setEndBefore(s):a.setEndAfter(s):a.setEnd(s,d),a},p=(l,u)=>{if(!l)return null;if(l.collapsed){if(!m(l)){let t=u?1:-1,r=sZ(t,a,l),n=r.getNode(!u);if(L(n)){if(sM(n))return c(t,n,!!u&&!r.isAtEnd(),!1);if(oa(n)&&nz(n.nextSibling)){let t=o.createRng();return t.setStart(n,0),t.setEnd(n,0),t}}let i=r.getNode(u);if(L(i)){if(sM(i))return c(t,i,!u&&!r.isAtEnd(),!1);if(oa(i)&&nz(i.previousSibling)){let t=o.createRng();return t.setStart(i,1),t.setEnd(i,1),t}}}return null}let f=l.startContainer,g=l.startOffset,p=l.endOffset;if(nT(f)&&0===g&&nz(f.parentNode)&&(f=f.parentNode,g=o.nodeIndex(f),f=f.parentNode),!nx(f))return null;if(p===g+1&&f===l.endContainer){let a=f.childNodes[g];if(d(a))return(a=>{let l=a.cloneNode(!0),d=t.dispatch("ObjectSelected",{target:a,targetClone:l});if(d.isDefaultPrevented())return null;let c=((r,a)=>{let l=ri(t.getBody()),s=t.getDoc(),d=rV(l,"#"+i).getOrThunk(()=>{let t=rs('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>',s);return t1(t,"id",i),r9(l,t),t}),c=o.createRng();ne(d),r7(d,[rc("\xa0",s),ri(a),rc("\xa0",s)]),c.setStart(d.dom.firstChild,1),c.setEnd(d.dom.lastChild,0),rJ(d,{top:o.getPos(r,t.getBody()).y+"px"}),ub(d);let u=n.getSel();return u&&(u.removeAllRanges(),u.addRange(c)),c})(a,d.targetClone),u=ri(a);return el(nb(ri(t.getBody()),`*[${s}]`),t=>{rp(u,t)||t6(t,s)}),o.getAttrib(a,s)||a.setAttribute(s,"1"),r=a,b(),c})(a)}return null},h=()=>{r&&r.removeAttribute(s),rV(ri(t.getBody()),"#"+i).each(nt),r=null},b=()=>{l.hide()};return hZ(t)||(t.on("click",r=>{o.isEditable(r.target)||(r.preventDefault(),t.focus())}),t.on("blur NewBlock",h),t.on("ResizeWindow FullscreenStateChanged",l.reposition),t.on("tap",r=>{let n=r.target,o=km(t,n);nz(o)?(r.preventDefault(),vi(t,o).each(p)):d(n)&&vi(t,n).each(p)},!0),t.on("mousedown",r=>{let l=r.target;if(l!==a&&"HTML"!==l.nodeName&&!o.isChildOf(l,a)||!((t,r,n)=>{let o=ri(t.getBody()),a=t.inline?o:ri(rv(o).dom.documentElement),l=((t,r,n,o)=>{let a=r.dom.getBoundingClientRect();return{x:n-(t?a.left+r.dom.clientLeft+bx(r):0),y:o-(t?a.top+r.dom.clientTop+bw(r):0)}})(t.inline,a,r,n);return((t,r,n)=>{let o=by(t),a=bC(t);return r>=0&&n>=0&&r<=o&&n<=a})(a,l.x,l.y)})(t,r.clientX,r.clientY))return;h(),b();let i=km(t,l);nz(i)?(r.preventDefault(),vi(t,i).each(p)):E5(a,r.clientX,r.clientY).each(o=>{var a;r.preventDefault(),(a=c(1,o.node,o.position===g.Before,!1))&&n.setRng(a),nx(i)?i.focus():t.getBody().focus()})}),t.on("keypress",t=>{cR.modifierPressed(t)||nz(n.getNode())&&t.preventDefault()}),t.on("GetSelectionRange",t=>{let n=t.range;if(r){if(!r.parentNode)return void(r=null);(n=n.cloneRange()).selectNode(r),t.range=n}}),t.on("SetSelectionRange",t=>{t.range=f(t.range);let r=p(t.range,t.forward);r&&(t.range=r)}),t.on("AfterSetSelectionRange",t=>{let r=t.range,n=r.startContainer.parentElement;m(r)||nx(n)&&"mcepastebin"===n.id||b(),L(n)&&o.hasClass(n,"mce-offscreen-selection")||h()}),ku(t),i1(t)&&(t=>{let r=r=>{if(!r.isDefaultPrevented()){let n=r.dataTransfer;n&&(en(n.types,"Files")||n.files.length>0)&&(r.preventDefault(),"drop"===r.type&&bR(t,"Dropped file type is not supported"))}},n=n=>{uB(t,n.target)&&r(n)},o=()=>{let o=aB.DOM,a=t.dom,l=document,i=t.inline?t.getBody():t.getDoc(),s=["drop","dragover"];el(s,t=>{o.bind(l,t,n),a.bind(i,t,r)}),t.on("remove",()=>{el(s,t=>{o.unbind(l,t,n),a.unbind(i,t,r)})})};t.on("init",()=>{uA.setEditorTimeout(t,o,0)})})(t),(t=>{let r=a$(()=>{if(!t.removed&&t.getBody().contains(document.activeElement)){let r=t.selection.getRng();if(r.collapsed){let n=vs(t,r,!1);t.selection.setRng(n)}}},0);t.on("focus",()=>{r.throttle()}),t.on("blur",()=>{r.cancel()})})(t),(t=>{t.on("init",()=>{t.on("focusin",r=>{let n=r.target;if(n$(n)){let r=fj(t.getBody(),n),o=nz(r)?r:n;t.selection.getNode()!==o&&vi(t,o).each(r=>t.selection.setRng(r))}})})})(t)),{showCaret:c,showBlockCaretContainer:t=>{t.hasAttribute("data-mce-caret")&&(om(t),n.scrollIntoView(t))},hideFakeCaret:b,destroy:()=>{l.destroy(),r=null}}},kg=(t,r)=>{let n=r;for(let r=t.previousSibling;nT(r);r=r.previousSibling)n+=r.data.length;return n},kp=(t,r,n,o,a)=>{if(nT(n)&&(o<0||o>n.data.length))return[];let l=a&&nT(n)?[kg(n,o)]:[o],i=n;for(;i!==r&&i.parentNode;)l.push(t.nodeIndex(i,a)),i=i.parentNode;return i===r?l.reverse():[]},kh=(t,r,n,o,a,l,i=!1)=>({start:kp(t,r,n,o,i),end:kp(t,r,a,l,i)}),kb=(t,r)=>{let n=r.slice(),o=n.pop();return M(o)?eu(n,(t,r)=>t.bind(t=>J.from(t.childNodes[r])),J.some(t)).bind(t=>nT(t)&&(o<0||o>t.data.length)?J.none():J.some({node:t,offset:o})):J.none()},kv=(t,r)=>kb(t,r.start).bind(({node:n,offset:o})=>kb(t,r.end).map(({node:t,offset:r})=>{let a=document.createRange();return a.setStart(n,o),a.setEnd(t,r),a})),ky=(t,r,n)=>{if(r&&t.isEmpty(r)&&!n(r)){let o=r.parentNode;t.remove(r,nT(r.firstChild)&&ow(r.firstChild.data)),ky(t,o,n)}},kC=(t,r,n,o=!0)=>{let a=r.startContainer.parentNode,l=r.endContainer.parentNode;r.deleteContents(),o&&!n(r.startContainer)&&(nT(r.startContainer)&&0===r.startContainer.data.length&&t.remove(r.startContainer),nT(r.endContainer)&&0===r.endContainer.data.length&&t.remove(r.endContainer),ky(t,a,n),a!==l&&ky(t,l,n))},kw=(t,r)=>J.from(t.dom.getParent(r.startContainer,t.dom.isBlock)),kx=(t,r,n)=>{let o=t.dynamicPatternsLookup({text:n,block:r});return{...t,blockPatterns:lW(o).concat(t.blockPatterns),inlinePatterns:lK(o).concat(t.inlinePatterns)}},kE=(t,r,n,o)=>{let a=t.createRng();return a.setStart(r,0),a.setEnd(n,o),a.toString()},kk=(t,r,n)=>{((t,r,n)=>{if(nT(t)&&0>=t.length)return J.some(CU(t,0));{let r=a4(Cz);return J.from(r.forwards(t,0,Cj(t),n)).map(t=>CU(t.container,0))}})(r,0,r).each(o=>{var a;let l=o.container;Cq(l,n.start.length,r).each(n=>{let o=t.createRng();o.setStart(l,0),o.setEnd(n.container,n.offset),kC(t,o,t=>t===r)});let i=ri(l),s=nY(i);/^\s[^\s]/.test(s)&&(a=s.slice(1),nG.set(i,a))})},kS=(t,r)=>t.create("span",{"data-mce-type":"bookmark",id:r}),k_=(t,r)=>{let n=t.createRng();return n.setStartAfter(r.start),n.setEndBefore(r.end),n},kN=(t,r,n)=>{let o=kv(t.getRoot(),n).getOrDie("Unable to resolve path range"),a=o.startContainer,l=o.endContainer,i=0===o.endOffset?l:l.splitText(o.endOffset),s=0===o.startOffset?a:a.splitText(o.startOffset),d=s.parentNode;return{prefix:r,end:i.parentNode.insertBefore(kS(t,r+"-end"),i),start:d.insertBefore(kS(t,r+"-start"),s)}},kR=(t,r,n)=>{ky(t,t.get(r.prefix+"-end"),n),ky(t,t.get(r.prefix+"-start"),n)},kA=t=>0===t.start.length,kO=(t,r,n,o)=>{let a=r.start;return CV(t,o.container,o.offset,(t,r)=>{let n=t.data.substring(0,r),o=n.lastIndexOf(a.charAt(a.length-1)),l=n.lastIndexOf(a);return -1!==l?l+a.length:-1!==o?o+1:-1},n).bind(o=>{var l,i;let s=null!==(i=null===(l=n.textContent)||void 0===l?void 0:l.indexOf(a))&&void 0!==i?i:-1;if(-1!==s&&o.offset>=s+a.length){let r=t.createRng();return r.setStart(o.container,o.offset-a.length),r.setEnd(o.container,o.offset),J.some(r)}{let l=o.offset-a.length;return C$(o.container,l,n).map(r=>{let n=t.createRng();return n.setStart(r.container,r.offset),n.setEnd(o.container,o.offset),n}).filter(t=>t.toString()===a).orThunk(()=>kO(t,r,n,CU(o.container,0)))}})},kT=(t,r,n,o)=>{let a=t.dom,l=a.getRoot(),i=n.pattern,s=n.position.container,d=n.position.offset;return C$(s,d-n.pattern.end.length,r).bind(c=>{let u=kh(a,l,c.container,c.offset,s,d,o);if(kA(i))return J.some({matches:[{pattern:i,startRng:u,endRng:u}],position:c});{let s=kB(t,n.remainingPatterns,c.container,c.offset,r,o),d=s.getOr({matches:[],position:c}),m=d.position;return((t,r,n,o,a,l=!1)=>{if(0===r.start.length&&!l){let r=t.createRng();return r.setStart(n,o),r.setEnd(n,o),J.some(r)}return CH(n,o,a).bind(n=>kO(t,r,a,n).bind(t=>{var r;return l&&(t.endContainer===n.container&&t.endOffset===n.offset||0===n.offset&&(null===(r=t.endContainer.textContent)||void 0===r?void 0:r.length)===t.endOffset)?J.none():J.some(t)}))})(a,i,m.container,m.offset,r,s.isNone()).map(t=>{let r=((t,r,n,o=!1)=>kh(t,r,n.startContainer,n.startOffset,n.endContainer,n.endOffset,o))(a,l,t,o);return{matches:d.matches.concat([{pattern:i,startRng:r,endRng:u}]),position:CU(t.startContainer,t.startOffset)}})}})},kB=(t,r,n,o,a,l)=>{let i=t.dom;return CH(n,o,i.getRoot()).bind(s=>{let d=kE(i,a,n,o);for(let i=0;i<r.length;i++){let c=r[i];if(!e8(d,c.end))continue;let u=r.slice();u.splice(i,1);let m=kT(t,a,{pattern:c,remainingPatterns:u,position:s},l);if(m.isNone()&&o>0)return kB(t,r,n,o-1,a,l);if(m.isSome())return m}return J.none()})},kD=(t,r,n)=>{t.selection.setRng(n),"inline-format"===r.type?el(r.format,r=>{t.formatter.apply(r)}):t.execCommand(r.cmd,!1,r.value)},kP=(t,r,n,o,a,l)=>((t,r)=>{let n=eb(t,t=>eo(r,r=>t.pattern.start===r.pattern.start&&t.pattern.end===r.pattern.end));return t.length===r.length?n?t:r:t.length>r.length?t:r})(kB(t,a.inlinePatterns,n,o,r,l).fold(()=>[],t=>t.matches),kB(t,ew(a.inlinePatterns,(t,r)=>r.end.length-t.end.length),n,o,r,l).fold(()=>[],t=>t.matches)),kL=(t,r)=>{if(0===r.length)return;let n=t.dom,o=t.selection.getBookmark();el(((t,r)=>{let n=a3("mce_textpattern"),o=ec(r,(r,o)=>{let a=kN(t,n+`_end${r.length}`,o.endRng);return r.concat([{...o,endMarker:a}])},[]);return ec(o,(r,a)=>{let l=o.length-r.length-1,i=kA(a.pattern)?a.endMarker:kN(t,n+`_start${l}`,a.startRng);return r.concat([{...a,startMarker:i}])},[])})(n,r),r=>{let o=n.getParent(r.startMarker.start,n.isBlock),a=t=>t===o;kA(r.pattern)?((t,r,n,o)=>{let a=k_(t.dom,n);kC(t.dom,a,o),kD(t,r,a)})(t,r.pattern,r.endMarker,a):((t,r,n,o,a)=>{let l=t.dom,i=k_(l,o),s=k_(l,n);kC(l,s,a),kC(l,i,a),kD(t,r,k_(l,{prefix:n.prefix,start:n.end,end:o.start}))})(t,r.pattern,r.startMarker,r.endMarker,a),kR(n,r.endMarker,a),kR(n,r.startMarker,a)}),t.selection.moveToBookmark(o)},kF=(t,r)=>{let n=t.selection.getRng();return kw(t,n).map(o=>{var a;let l=Math.max(0,n.startOffset),i=kx(r,o,null!==(a=o.textContent)&&void 0!==a?a:""),s=kP(t,o,n.startContainer,l,i,!0),d=((t,r,n,o)=>{var a;let l=t.dom,i=l7(t);if(!l.is(r,i))return[];let s=null!==(a=r.textContent)&&void 0!==a?a:"";return((t,r)=>{let n=ew(t,(t,r)=>r.start.length-t.start.length),o=r.replace("\xa0"," ");return ef(n,t=>0===r.indexOf(t.start)||0===o.indexOf(t.start))})(n.blockPatterns,s).map(t=>tF.trim(s).length===t.start.length?[]:[{pattern:t,range:kh(l,l.getRoot(),r,0,r,0,!0)}]).getOr([])})(t,o,i);return(d.length>0||s.length>0)&&(t.undoManager.add(),t.undoManager.extra(()=>{t.execCommand("mceInsertNewLine")},()=>{t.insertContent("\uFEFF"),kL(t,s),((t,r)=>{if(0===r.length)return;let n=t.selection.getBookmark();el(r,r=>((t,r)=>{let n=t.dom,o=r.pattern;return kw(t,kv(n.getRoot(),r.range).getOrDie("Unable to resolve path range")).each(r=>{"block-format"===o.type?((t,r)=>{let n=r.get(t);return O(n)&&eE(n).exists(t=>eI(t,"block"))})(o.format,t.formatter)&&t.undoManager.transact(()=>{kk(t.dom,r,o),t.formatter.apply(o.format)}):"block-command"===o.type&&t.undoManager.transact(()=>{kk(t.dom,r,o),t.execCommand(o.cmd,!1,o.value)})}),!0})(t,r)),t.selection.moveToBookmark(n)})(t,d);let r=t.selection.getRng(),n=CH(r.startContainer,r.startOffset,t.dom.getRoot());t.execCommand("mceInsertNewLine"),n.each(r=>{let n=r.container;"\uFEFF"===n.data.charAt(r.offset-1)&&(n.deleteData(r.offset-1,1),ky(t.dom,n.parentNode,r=>r===t.dom.getRoot()))})}),!0)}).getOr(!1)},kM=(t,r,n)=>{for(let o=0;o<t.length;o++)if(n(t[o],r))return!0;return!1},kI=t=>{let r=tF.each,n=cR.BACKSPACE,o=cR.DELETE,a=t.dom,l=t.selection,i=t.parser,s=tB.browser,d=s.isFirefox(),c=s.isChromium()||s.isSafari(),u=tB.deviceType.isiPhone()||tB.deviceType.isiPad(),m=tB.os.isMacOS()||tB.os.isiOS(),f=(r,n)=>{try{t.getDoc().execCommand(r,!1,String(n))}catch(t){}},g=t=>t.isDefaultPrevented(),p=()=>{t.shortcuts.add("meta+a",null,"SelectAll")},h=()=>{t.inline||a.bind(t.getDoc(),"mousedown mouseup",r=>{let n;if(r.target===t.getDoc().documentElement){if(n=l.getRng(),t.getBody().focus(),"mousedown"===r.type){if(ol(n.startContainer))return;l.placeCaretAt(r.clientX,r.clientY)}else l.setRng(n)}})},b=()=>{Range.prototype.getClientRects||t.on("mousedown",r=>{if(!g(r)&&"HTML"===r.target.nodeName){let r=t.getBody();r.blur(),uA.setEditorTimeout(t,()=>{r.focus()})}})},v=()=>{let r=i8(t);t.on("click",n=>{let o=n.target;/^(IMG|HR)$/.test(o.nodeName)&&a.isEditable(o.parentNode)&&(n.preventDefault(),t.selection.select(o),t.nodeChanged()),"A"===o.nodeName&&a.hasClass(o,r)&&0===o.childNodes.length&&a.isEditable(o.parentNode)&&(n.preventDefault(),l.select(o))})},y=()=>{t.on("keydown",t=>{if(!g(t)&&t.keyCode===n&&l.isCollapsed()&&0===l.getRng().startOffset){let r=l.getNode().previousSibling;if(r&&r.nodeName&&"table"===r.nodeName.toLowerCase())return t.preventDefault(),!1}return!0})},C=()=>{iX(t)||t.on("BeforeExecCommand mousedown",()=>{f("StyleWithCSS",!1),f("enableInlineTableEditing",!1),iR(t)||f("enableObjectResizing",!1)})},w=()=>{t.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},x=()=>{t.inline||t.on("keydown",()=>{document.activeElement===document.body&&t.getWin().focus()})},E=()=>{t.inline||(t.contentStyles.push("body {min-height: 150px}"),t.on("click",r=>{let n;"HTML"===r.target.nodeName&&(n=t.selection.getRng(),t.getBody().focus(),t.selection.setRng(n),t.selection.normalize(),t.nodeChanged())}))},k=()=>{m&&t.on("keydown",r=>{!cR.metaKeyPressed(r)||r.shiftKey||37!==r.keyCode&&39!==r.keyCode||(r.preventDefault(),t.selection.getSel().modify("move",37===r.keyCode?"backward":"forward","lineboundary"))})},S=()=>{t.on("click",t=>{let r=t.target;do if("A"===r.tagName)return void t.preventDefault();while(r=r.parentNode)}),t.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},_=()=>{t.on("init",()=>{t.dom.bind(t.getBody(),"submit",t=>{t.preventDefault()})})};return hZ(t)?(c&&(h(),v(),_(),p(),u&&(x(),E(),S())),d&&(b(),C(),w(),k())):(t.on("keydown",r=>{if(g(r)||r.keyCode!==cR.BACKSPACE)return;let n=l.getRng(),o=n.startContainer,i=n.startOffset,s=a.getRoot(),d=o;if(n.collapsed&&0===i){for(;d.parentNode&&d.parentNode.firstChild===d&&d.parentNode!==s;)d=d.parentNode;"BLOCKQUOTE"===d.nodeName&&(t.formatter.toggle("blockquote",void 0,d),(n=a.createRng()).setStart(o,0),n.setEnd(o,0),l.setRng(n))}}),(()=>{let r=t=>{let r=a.create("body"),n=t.cloneContents();return r.appendChild(n),l.serializer.serialize(r,{format:"html"})};t.on("keydown",l=>{let i=l.keyCode;if(!g(l)&&(i===o||i===n)&&t.selection.isEditable()){let n=t.selection.isCollapsed(),o=t.getBody();if(n&&(!a.isEmpty(o)||eo(nb(ri(o),'[contenteditable="true"]'),t=>rw(t).exists(t=>!rK(t))))||!n&&!(n=>{let o=r(n),l=a.createRng();return l.selectNode(t.getBody()),o===r(l)})(t.selection.getRng()))return;l.preventDefault(),t.setContent(""),o.firstChild&&a.isBlock(o.firstChild)?t.selection.setCursorLocation(o.firstChild,0):t.selection.setCursorLocation(o,0),t.nodeChanged()}})})(),tB.windowsPhone||t.on("keyup focusin mouseup",r=>{cR.modifierPressed(r)||(t=>{let r=t.getBody(),n=t.selection.getRng();return n.startContainer===n.endContainer&&n.startContainer===r&&0===n.startOffset&&n.endOffset===r.childNodes.length})(t)||l.normalize()},!0),c&&(h(),v(),t.on("init",()=>{f("DefaultParagraphSeparator",l7(t))}),_(),y(),i.addNodeFilter("br",t=>{let r=t.length;for(;r--;)"Apple-interchange-newline"===t[r].attr("class")&&t[r].remove()}),u?(x(),E(),S()):p()),d&&(t.on("keydown",r=>{if(!g(r)&&r.keyCode===n&&t.getBody().getElementsByTagName("hr").length&&l.isCollapsed()&&0===l.getRng().startOffset){let t=l.getNode(),n=t.previousSibling;if("HR"===t.nodeName)return a.remove(t),void r.preventDefault();n&&n.nodeName&&"hr"===n.nodeName.toLowerCase()&&(a.remove(n),r.preventDefault())}}),b(),(()=>{let n=()=>{let n=a.getAttribs(l.getStart().cloneNode(!1));return()=>{let o=l.getStart();o!==t.getBody()&&(a.setAttrib(o,"style",null),r(n,t=>{o.setAttributeNode(t.cloneNode(!0))}))}},o=()=>!l.isCollapsed()&&a.getParent(l.getStart(),a.isBlock)!==a.getParent(l.getEnd(),a.isBlock);t.on("keypress",r=>{let a;return!(!(g(r)||8!==r.keyCode&&46!==r.keyCode)&&o()&&(a=n(),t.getDoc().execCommand("delete",!1),a(),r.preventDefault(),1))}),a.bind(t.getDoc(),"cut",r=>{if(!g(r)&&o()){let r=n();uA.setEditorTimeout(t,()=>{r()})}})})(),C(),t.on("SetContent ExecCommand",t=>{"setcontent"!==t.type&&"mceInsertLink"!==t.command||r(a.select("a:not([data-mce-block])"),t=>{var r;let n=t.parentNode,o=a.getRoot();if((null==n?void 0:n.lastChild)===t){for(;n&&!a.isBlock(n);){if((null===(r=n.parentNode)||void 0===r?void 0:r.lastChild)!==n||n===o)return;n=n.parentNode}a.add(n,"br",{"data-mce-bogus":1})}})}),w(),k(),y(),t.on("drop",r=>{var n;let o=null===(n=r.dataTransfer)||void 0===n?void 0:n.getData("text/html");N(o)&&/^<img[^>]*>$/.test(o)&&t.dispatch("dragend",new window.DragEvent("dragend",r))}))),{refreshContentEditable:U,isHidden:()=>{if(!d||t.removed)return!1;let r=t.selection.getSel();return!r||!r.rangeCount||0===r.rangeCount}}},kU=aB.DOM,kz=t=>t.inline?t.getElement().nodeName.toLowerCase():void 0,kj=t=>eP(t,t=>!1===D(t)),kH=t=>{let r=t.options.get,n=t.editorUpload.blobCache;return kj({allow_conditional_comments:r("allow_conditional_comments"),allow_html_data_urls:r("allow_html_data_urls"),allow_svg_data_urls:r("allow_svg_data_urls"),allow_html_in_named_anchor:r("allow_html_in_named_anchor"),allow_script_urls:r("allow_script_urls"),allow_unsafe_link_target:r("allow_unsafe_link_target"),convert_fonts_to_spans:r("convert_fonts_to_spans"),fix_list_elements:r("fix_list_elements"),font_size_legacy_values:r("font_size_legacy_values"),forced_root_block:r("forced_root_block"),forced_root_block_attrs:r("forced_root_block_attrs"),preserve_cdata:r("preserve_cdata"),inline_styles:r("inline_styles"),root_name:kz(t),sanitize:r("xss_sanitization"),validate:!0,blob_cache:n,document:t.getDoc()})},k$=t=>{let r=t.options.get;return kj({custom_elements:r("custom_elements"),extended_valid_elements:r("extended_valid_elements"),invalid_elements:r("invalid_elements"),invalid_styles:r("invalid_styles"),schema:r("schema"),valid_children:r("valid_children"),valid_classes:r("valid_classes"),valid_elements:r("valid_elements"),valid_styles:r("valid_styles"),verify_html:r("verify_html"),padd_empty_block_inline_children:r("format_empty_lines")})},kq=t=>t.inline?t.ui.styleSheetLoader:t.dom.styleSheetLoader,kV=t=>{let r=kq(t),n=iS(t),o=t.contentCSS,a=()=>{r.unloadAll(o),t.inline||t.ui.styleSheetLoader.unloadAll(n)},l=()=>{t.removed?a():t.on("remove",a)};if(t.contentStyles.length>0){let r="";tF.each(t.contentStyles,t=>{r+=t+"\r\n"}),t.dom.addStyle(r)}let i=Promise.all(((t,r,n)=>{let o=[kq(t).loadAll(r)];return t.inline?o:o.concat([t.ui.styleSheetLoader.loadAll(n)])})(t,o,n)).then(l).catch(l),s=ik(t);return s&&((t,r)=>{let n=rF(rL(ri(t.getBody()))),o=rd("style");t1(o,"type","text/css"),r9(o,rc(r)),r9(n,o),t.on("remove",()=>{nt(o)})})(t,s),i},kW=t=>{!0!==t.removed&&(hZ(t)||t.load({initial:!0,format:"html"}),t.startContent=t.getContent({format:"raw"}),(t=>{t.bindPendingEventDelegates(),t.initialized=!0,(t=>{t.dispatch("Init")})(t),t.focus(!0),(t=>{let r=t.dom.getRoot();t.inline||d$(t)&&t.selection.getStart(!0)!==r||ds(r).each(r=>{let n=r.getNode(),o=nR(n)?ds(n).getOr(r):r;t.selection.setRng(o.toRange())})})(t),t.nodeChanged({initial:!0});let r=i9(t);F(r)&&r.call(t,t),(t=>{let r=i7(t);r&&uA.setEditorTimeout(t,()=>{let n;(n=!0===r?t:t.editorManager.get(r))&&!n.destroyed&&(n.focus(),n.selection.scrollIntoView())},100)})(t)})(t))},kK=t=>{let r=t.getElement(),n=t.getDoc();t.inline&&(kU.addClass(r,"mce-content-body"),t.contentDocument=n=document,t.contentWindow=window,t.bodyElement=r,t.contentAreaContainer=r);let o=t.getBody();o.disabled=!0,t.readonly=iX(t),t._editableRoot=iQ(t),!t.readonly&&t.hasEditableRoot()&&(t.inline&&"static"===kU.getStyle(o,"position",!0)&&(o.style.position="relative"),o.contentEditable="true"),o.disabled=!1,t.editorUpload=bU(t),t.schema=am(k$(t)),t.dom=aB(n,{keep_values:!0,url_converter:t.convertURL,url_converter_scope:t,update_styles:!0,root_element:t.inline?t.getBody():null,collect:t.inline,schema:t.schema,contentCssCors:ib(t),referrerPolicy:iv(t),onSetAttrib:r=>{t.dispatch("SetAttrib",r)}}),t.parser=(t=>{let r=hC(kH(t),t.schema);return r.addAttributeFilter("src,href,style,tabindex",(r,n)=>{let o=t.dom,a="data-mce-"+n,l=r.length;for(;l--;){let i=r[l],s=i.attr(n);if(s&&!i.attr(a)){if(0===s.indexOf("data:")||0===s.indexOf("blob:"))continue;"style"===n?((s=o.serializeStyle(o.parseStyle(s),i.name)).length||(s=null),i.attr(a,s),i.attr(n,s)):"tabindex"===n?(i.attr(a,s),i.attr(n,null)):i.attr(a,t.convertURL(s,n,i.name))}}}),r.addNodeFilter("script",t=>{let r=t.length;for(;r--;){let n=t[r],o=n.attr("type")||"no/type";0!==o.indexOf("mce-")&&n.attr("type","mce-"+o)}}),sy(t)&&r.addNodeFilter("#cdata",r=>{var n;let o=r.length;for(;o--;){let a=r[o];a.type=8,a.name="#comment",a.value="[CDATA["+t.dom.encode(null!==(n=a.value)&&void 0!==n?n:"")+"]]"}}),r.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",r=>{let n=r.length,o=t.schema.getNonEmptyElements();for(;n--;){let t=r[n];t.isEmpty(o)&&0===t.getAll("br").length&&t.append(new u0("br",1))}}),r})(t),t.serializer=be((t=>{let r=t.options.get;return{...kH(t),...k$(t),...kj({remove_trailing_brs:r("remove_trailing_brs"),pad_empty_with_br:r("pad_empty_with_br"),url_converter:r("url_converter"),url_converter_scope:r("url_converter_scope"),element_format:r("element_format"),entities:r("entities"),entity_encoding:r("entity_encoding"),indent:r("indent"),indent_after:r("indent_after"),indent_before:r("indent_before")})}})(t),t),t.selection=h9(t.dom,t.getWin(),t.serializer,t),t.annotator=cy(t),t.formatter=bY(t),t.undoManager=bQ(t),t._nodeChangeDispatcher=new x1(t),t._selectionOverrides=kf(t),(t=>{let r=aH(),n=aL(!1),o=aq(r=>{t.dispatch("longpress",{...r,type:"longpress"}),n.set(!0)},400);t.on("touchstart",t=>{y0(t).each(a=>{o.cancel();let l={x:a.clientX,y:a.clientY,target:t.target};o.throttle(t),n.set(!1),r.set(l)})},!0),t.on("touchmove",a=>{o.cancel(),y0(a).each(o=>{r.on(a=>{((t,r)=>{let n=Math.abs(t.clientX-r.x),o=Math.abs(t.clientY-r.y);return n>5||o>5})(o,a)&&(r.clear(),n.set(!1),t.dispatch("longpresscancel"))})})},!0),t.on("touchend touchcancel",a=>{o.cancel(),"touchcancel"!==a.type&&r.get().filter(t=>t.target.isEqualNode(a.target)).each(()=>{n.get()?a.preventDefault():t.dispatch("tap",{...a,type:"tap"})})},!0)})(t),(t=>{t.on("click",r=>{t.dom.getParent(r.target,"details")&&r.preventDefault()})})(t),t.parser.addNodeFilter("details",r=>{let n=sS(t);el(r,t=>{"expanded"===n?t.attr("open","open"):"collapsed"===n&&t.attr("open",null)})}),t.serializer.addNodeFilter("details",r=>{let n=s_(t);el(r,t=>{"expanded"===n?t.attr("open","open"):"collapsed"===n&&t.attr("open",null)})}),(t=>{let r="contenteditable",n=" "+tF.trim(sb(t))+" ",o=" "+tF.trim(sh(t))+" ",a=y9(n),l=y9(o),i=sv(t);i.length>0&&t.on("BeforeSetContent",r=>{((t,r,n)=>{let o=r.length,a=n.content;if("raw"!==n.format){for(;o--;)a=a.replace(r[o],y4(t,a,sh(t)));n.content=a}})(t,i,r)}),t.parser.addAttributeFilter("class",t=>{let n=t.length;for(;n--;){let o=t[n];a(o)?o.attr(r,"true"):l(o)&&o.attr(r,"false")}}),t.serializer.addAttributeFilter(r,t=>{let n=t.length;for(;n--;){let o=t[n];(a(o)||l(o))&&(i.length>0&&o.attr("data-mce-content")?(o.name="#text",o.type=3,o.raw=!0,o.value=o.attr("data-mce-content")):o.attr(r,null))}})})(t),hZ(t)||((t=>{t.on("mousedown",r=>{r.detail>=3&&(r.preventDefault(),EZ(t))})})(t),(t=>{let r=[",",".",";",":","!","?"],n=[32],o=()=>{var r,n;return r=sg(t),n=sp(t),{inlinePatterns:lK(r),blockPatterns:lW(r),dynamicPatternsLookup:n}},a=()=>t.options.isSet("text_patterns_lookup");t.on("keydown",r=>{if(13===r.keyCode&&!cR.modifierPressed(r)&&t.selection.isCollapsed()){let n=o();(n.inlinePatterns.length>0||n.blockPatterns.length>0||a())&&kF(t,n)&&r.preventDefault()}},!0);let l=()=>{if(t.selection.isCollapsed()){let r=o();(r.inlinePatterns.length>0||a())&&((t,r)=>{let n=t.selection.getRng();kw(t,n).map(o=>{let a=Math.max(0,n.startOffset-1),l=kE(t.dom,o,n.startContainer,a),i=kx(r,o,l),s=kP(t,o,n.startContainer,a,i,!1);s.length>0&&t.undoManager.transact(()=>{kL(t,s)})})})(t,r)}};t.on("keyup",t=>{kM(n,t,(t,r)=>t===r.keyCode&&!cR.modifierPressed(r))&&l()}),t.on("keypress",n=>{kM(r,n,(t,r)=>t.charCodeAt(0)===r.charCode)&&uA.setEditorTimeout(t,l)})})(t));let a=x0(t);yZ(t,a),(t=>{t.on("NodeChange",V(y5,t))})(t),(t=>{var r;let n=t.dom,o=l7(t),a=null!==(r=iO(t))&&void 0!==r?r:"",l=(r,i)=>{if((t=>{if(b0(t)){let r=t.keyCode;return!b1(t)&&(cR.metaKeyPressed(t)||t.altKey||r>=112&&r<=123||en(bJ,r))}return!1})(r))return;let s=t.getBody(),d=!(b0(r)&&!(b1(r)||"keyup"===r.type&&229===r.keyCode))&&((t,r,n)=>{if(oA(ri(r),!1)){let o=r.firstElementChild;return!o||!t.getStyle(r.firstElementChild,"padding-left")&&!t.getStyle(r.firstElementChild,"padding-right")&&n===o.nodeName.toLowerCase()}return!1})(n,s,o);(""!==n.getAttrib(s,bZ)!==d||i)&&(n.setAttrib(s,bZ,d?a:null),n.setAttrib(s,"aria-placeholder",d?a:null),((t,r)=>{t.dispatch("PlaceholderToggle",{state:r})})(t,d),t.on(d?"keydown":"keyup",l),t.off(d?"keyup":"keydown",l))};e7(a)&&t.on("init",r=>{l(r,!0),t.on("change SetContent ExecCommand",l),t.on("paste",r=>uA.setEditorTimeout(t,()=>l(r)))})})(t),EG(t);let l=eM(t.plugins,"rtc").bind(t=>J.from(t.setup)).fold(()=>(t.rtcInstance=hJ(t),J.none()),r=>(t.rtcInstance=(()=>{let t=H(null),r=H("");return{init:{bindEvents:U},undoManager:{beforeChange:U,add:t,undo:t,redo:t,clear:U,reset:U,hasUndo:X,hasRedo:X,transact:t,ignore:U,extra:U},formatter:{match:X,matchAll:H([]),matchNode:H(void 0),canApply:X,closest:r,apply:U,remove:U,toggle:U,formatChanged:H({unbind:U})},editor:{getContent:r,setContent:H({content:"",html:""}),insertContent:H(""),addVisual:U},selection:{getContent:r},autocompleter:{addDecoration:U,removeDecoration:U},raw:{getModel:H(J.none())}}})(),J.some(()=>r().then(r=>(t.rtcInstance=(t=>{let r=t=>R(t)?t:{},{init:n,undoManager:o,formatter:a,editor:l,selection:i,autocompleter:s,raw:d}=t;return{init:{bindEvents:n.bindEvents},undoManager:{beforeChange:o.beforeChange,add:o.add,undo:o.undo,redo:o.redo,clear:o.clear,reset:o.reset,hasUndo:o.hasUndo,hasRedo:o.hasRedo,transact:(t,r,n)=>o.transact(n),ignore:(t,r)=>o.ignore(r),extra:(t,r,n,a)=>o.extra(n,a)},formatter:{match:(t,n,o,l)=>a.match(t,r(n),l),matchAll:a.matchAll,matchNode:a.matchNode,canApply:t=>a.canApply(t),closest:t=>a.closest(t),apply:(t,n,o)=>a.apply(t,r(n)),remove:(t,n,o,l)=>a.remove(t,r(n)),toggle:(t,n,o)=>a.toggle(t,r(n)),formatChanged:(t,r,n,o,l)=>a.formatChanged(r,n,o,l)},editor:{getContent:t=>l.getContent(t),setContent:(t,r)=>({content:l.setContent(t,r),html:""}),insertContent:(t,r)=>(l.insertContent(t),""),addVisual:l.addVisual},selection:{getContent:(t,r)=>i.getContent(r)},autocompleter:{addDecoration:s.addDecoration,removeDecoration:s.removeDecoration},raw:{getModel:()=>J.some(d.getRawModel())}}})(r),r.rtc.isRemote)))));(t=>{let r=t.getDoc(),n=t.getBody();(t=>{t.dispatch("PreInit")})(t),se(t)||(r.body.spellcheck=!1,kU.setAttrib(n,"spellcheck","false")),t.quirks=kI(t),(t=>{t.dispatch("PostRender")})(t);let o=i_(t);void 0!==o&&(n.dir=o);let a=st(t);a&&t.on("BeforeSetContent",t=>{tF.each(a,r=>{t.content=t.content.replace(r,t=>"<!--mce:protected "+escape(t)+"-->")})}),t.on("SetContent",()=>{t.addVisual(t.getBody())}),t.on("compositionstart compositionend",r=>{t.composing="compositionstart"===r.type})})(t),l.fold(()=>{let r=(t=>{let r=!1,n=setTimeout(()=>{r||t.setProgressState(!0)},500);return()=>{clearTimeout(n),r=!0,t.setProgressState(!1)}})(t);kV(t).then(()=>{kW(t),r()})},r=>{t.setProgressState(!0),kV(t).then(()=>{r().then(r=>{t.setProgressState(!1),kW(t),h2(t)},r=>{t.notificationManager.open({type:"error",text:String(r)}),kW(t),h2(t)})})})},kG=aB.DOM,kY=aB.DOM,kX=(t,r)=>({editorContainer:t,iframeContainer:r,api:{}}),kQ=t=>{let r=t.getElement();return t.inline?kX(null):(t=>{let r=kY.create("div");return kY.insertAfter(r,t),kX(r,r)})(r)},kJ=async t=>{var r;t.dispatch("ScriptsLoaded"),(t=>{let r=tF.trim(ic(t)),n=t.ui.registry.getAll().icons;eA({...bp.get("default").icons,...bp.get(r).icons},(r,o)=>{eI(n,o)||t.ui.registry.addIcon(o,r)})})(t),(t=>{let r=iD(t);if(N(r)){let n=bS.get(r);t.theme=n(t,bS.urls[r])||{},F(t.theme.init)&&t.theme.init(t,bS.urls[r]||t.documentBaseUrl.replace(/\/$/,""))}else t.theme={}})(t),(t=>{let r=iL(t),n=bh.get(r);t.model=n(t,bh.urls[r])})(t),(t=>{let r=[];el(iZ(t),n=>{((t,r,n)=>{let o=bk.get(n),a=bk.urls[n]||t.documentBaseUrl.replace(/\/$/,"");if(n=tF.trim(n),o&&-1===tF.inArray(r,n)){if(t.plugins[n])return;try{let l=o(t,a)||{};t.plugins[n]=l,F(l.init)&&(l.init(t,a),r.push(n))}catch(r){((t,r,n)=>{let o=aU.translate(["Failed to initialize plugin: {0}",r]);cx(t,"PluginLoadError",{message:o}),bT(o,n),bR(t,o)})(t,n,r)}}})(t,r,n.replace(/^\-/,""))})})(t);let n=await (t=>{let r=t.getElement();return t.orgDisplay=r.style.display,N(iD(t))?(t=>{let r=t.theme.renderUI;return r?r():kQ(t)})(t):F(iD(t))?(t=>{let r=t.getElement(),n=iD(t)(t,r);return n.editorContainer.nodeType&&(n.editorContainer.id=n.editorContainer.id||t.id+"_parent"),n.iframeContainer&&n.iframeContainer.nodeType&&(n.iframeContainer.id=n.iframeContainer.id||t.id+"_iframecontainer"),n.height=n.iframeHeight?n.iframeHeight:r.offsetHeight,n})(t):kQ(t)})(t);((t,r)=>{let n={show:J.from(r.show).getOr(U),hide:J.from(r.hide).getOr(U),isEnabled:J.from(r.isEnabled).getOr(Q),setEnabled:n=>{t.mode.isReadOnly()||J.from(r.setEnabled).each(t=>t(n))}};t.ui={...t.ui,...n}})(t,J.from(n.api).getOr({})),t.editorContainer=n.editorContainer,t.contentCSS=t.contentCSS.concat(bB(t,iE(t)),bB(t,iS(t))),t.inline?kK(t):(((t,r)=>{let n=t.translate("Rich Text Area"),o=t8(ri(t.getElement()),"tabindex").bind(tt),a=((t,r,n,o)=>{let a=rd("iframe");return o.each(t=>t1(a,"tabindex",t)),t2(a,n),t2(a,{id:t+"_ifr",frameBorder:"0",allowTransparency:"true",title:r}),rn(a,"tox-edit-area__iframe"),a})(t.id,n,l2(t),o).dom;a.onload=()=>{a.onload=null,t.dispatch("load")},t.contentAreaContainer=r.iframeContainer,t.iframeElement=a,t.iframeHTML=(t=>{let r=l3(t)+"<html><head>";l8(t)!==t.documentBaseUrl&&(r+='<base href="'+t.documentBaseURI.getURI()+'" />'),r+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';let n=l5(t),o=l6(t),a=t.translate(i5(t));return l9(t)&&(r+='<meta http-equiv="Content-Security-Policy" content="'+l9(t)+'" />'),r+=`</head><body id="${n}" class="mce-content-body ${o}" data-id="${t.id}" aria-label="${a}"><br></body></html>`})(t),kG.add(r.iframeContainer,a)})(t,r={editorContainer:n.editorContainer,iframeContainer:n.iframeContainer}),r.editorContainer&&(r.editorContainer.style.display=t.orgDisplay,t.hidden=kG.isHidden(r.editorContainer)),t.getElement().style.display="none",kG.setAttrib(t.id,"aria-hidden","true"),t.getElement().style.visibility=t.orgVisibility,(t=>{let r=t.iframeElement,n=()=>{t.contentDocument=r.contentDocument,kK(t)};if(sx(t)||tB.browser.isFirefox()){let r=t.getDoc();r.open(),r.write(t.iframeHTML),r.close(),n()}else{let o=nl(ri(r),"load",Q,()=>{o.unbind(),n()});r.srcdoc=t.iframeHTML}})(t))},kZ=aB.DOM,k0=t=>"-"===t.charAt(0),k1=(t,r,n)=>J.from(r).filter(t=>e7(t)&&!bp.has(t)).map(r=>({url:`${t.editorManager.baseURL}/icons/${r}/icons${n}.js`,name:J.some(r)})),k2=(t,r)=>{var n,o;let a=aP.ScriptLoader,l=()=>{!t.removed&&(t=>{let r=iD(t);return!N(r)||L(bS.get(r))})(t)&&(t=>{let r=iL(t);return L(bh.get(r))})(t)&&kJ(t)};((t,r)=>{let n=iD(t);if(N(n)&&!k0(n)&&!eI(bS.urls,n)){let o=iP(t),a=o?t.documentBaseURI.toAbsolute(o):`themes/${n}/theme${r}.js`;bS.load(n,a).catch(()=>{bA(t,"ThemeLoadError",bO("theme",a,n))})}})(t,r),((t,r)=>{let n=iL(t);if("plugin"!==n&&!eI(bh.urls,n)){let o=iF(t),a=N(o)?t.documentBaseURI.toAbsolute(o):`models/${n}/model${r}.js`;bh.load(n,a).catch(()=>{bA(t,"ModelLoadError",bO("model",a,n))})}})(t,r),((t,r)=>{let n=iy(r),o=iC(r);if(!aU.hasCode(n)&&"en"!==n){let a=e7(o)?o:`${r.editorManager.baseURL}/langs/${n}.js`;t.add(a).catch(()=>{bA(r,"LanguageLoadError",bO("language",a,n))})}})(a,t),n=a,el((t=>{let r=[],n=t=>{r.push(t)};for(let r=0;r<t.length;r++)t[r].each(n);return r})([k1(o=t,"default",r),J.from(iu(o)).filter(e7).map(t=>({url:t,name:J.none()})).orThunk(()=>k1(o,ic(o),""))]),t=>{n.add(t.url).catch(()=>{bA(o,"IconsLoadError",bO("icons",t.url,t.name.getOrUndefined()))})}),((t,r)=>{let n=(r,n)=>{bk.load(r,n).catch(()=>{bA(t,"PluginLoadError",bO("plugin",n,r))})};eA(i0(t),(r,o)=>{n(o,r),t.options.set("plugins",iZ(t).concat(o))}),el(iZ(t),t=>{!(t=tF.trim(t))||bk.urls[t]||k0(t)||n(t,`plugins/${t}/plugin${r}.js`)})})(t,r),a.loadQueue().then(l,l)},k3=tS().deviceType,k8=k3.isPhone(),k5=k3.isTablet(),k6=t=>P(t)?[]:ed(ea(O(t)?t:t.split(/[ ,]/),e6),e7),k9=(t,r)=>{var n,o;let a=((r,n)=>{let o={},a={};return eD(r,(r,n)=>en(t,n),eB(o),eB(a)),{t:o,f:a}})(r);return n=a.t,o=a.f,{sections:H(n),options:H(o)}},k4=(t,r)=>eI(t.sections(),r),k7=(t,r)=>({table_grid:!1,object_resizing:!1,resize:!1,toolbar_mode:eM(t,"toolbar_mode").getOr("scrolling"),toolbar_sticky:!1,...r?{menubar:!1}:{}}),Se=(t,r)=>{var n;let o=null!==(n=r.external_plugins)&&void 0!==n?n:{};return t&&t.external_plugins?tF.extend({},t.external_plugins,o):o},St=(t,r,n,o,a)=>{var l;let i=k9(["mobile"],C6(t?{mobile:k7(null!==(l=a.mobile)&&void 0!==l?l:{},r)}:{},a)),s=tF.extend(n,o,i.options(),t&&k4(i,"mobile")?((t,r,n={})=>{let o=eM(t.sections(),r).getOr({});return tF.extend({},n,o)})(i,"mobile"):{},{external_plugins:Se(o,i.options())});return((t,r,n,o)=>{let a,l;let i=k6(n.forced_plugins),s=k6(o.plugins),d=k4(r,a="mobile")?r.sections()[a]:{},c=(l=d.plugins?k6(d.plugins):s,t&&k4(r,"mobile")?l:s),u=[...k6(i),...k6(c)];return tF.extend(o,{forced_plugins:i,plugins:u})})(t,i,o,s)},Sr=t=>{(t=>{let r=r=>()=>{var n;el("left,center,right,justify".split(","),n=>{r!==n&&t.formatter.remove("align"+n)}),"none"!==r&&(n="align"+r,t.formatter.toggle(n,void 0),t.nodeChanged())};t.editorCommands.addCommands({JustifyLeft:r("left"),JustifyCenter:r("center"),JustifyRight:r("right"),JustifyFull:r("justify"),JustifyNone:r("none")})})(t),(t=>{let r=r=>()=>{let n=t.selection;return eo(n.isCollapsed()?[t.dom.getParent(n.getNode(),t.dom.isBlock)]:n.getSelectedBlocks(),n=>L(t.formatter.matchNode(n,r)))};t.editorCommands.addCommands({JustifyLeft:r("alignleft"),JustifyCenter:r("aligncenter"),JustifyRight:r("alignright"),JustifyFull:r("alignjustify")},"state")})(t)},Sn=(t,r)=>{let n=t.selection,o=t.dom;return/^ | $/.test(r)?((t,r,n)=>{let o=ri(t.getRoot());return n=mV(o,lx.fromRangeStart(r))?n.replace(/^ /,"&nbsp;"):n.replace(/^&nbsp;/," "),mW(o,lx.fromRangeEnd(r))?n.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):n.replace(/&nbsp;(<br( \/)?>)?$/," ")})(o,n.getRng(),r):r},So=(t,r)=>{if(t.selection.isEditable()){let{content:n,details:o}=(t=>{if("string"!=typeof t){let r=tF.extend({paste:t.paste,data:{paste:t.paste}},t);return{content:t.content,details:r}}return{content:t,details:{}}})(r);hk(t,{...o,content:Sn(t,n),format:"html",set:!1,selection:!0}).each(r=>{let n;let a=(n=r.content,h0(t).editor.insertContent(n,o));hS(t,a,r),t.addVisual()})}},Sa={"font-size":"size","font-family":"face"},Sl=tZ("font"),Si=t=>(r,n)=>J.from(n).map(ri).filter(tY).bind(n=>{let o;return gn(ri(n.dom),r=>r1(r,t).orThunk(()=>Sl(r)?eM(Sa,t).bind(t=>t8(r,t)):J.none()),t=>rp(ri(r),t)).or((o=n.dom,J.from(aB.DOM.getStyle(o,t,!0))))}).getOr(""),Ss=Si("font-size"),Sd=z(t=>t.replace(/[\'\"\\]/g,"").replace(/,\s+/g,","),Si("font-family")),Sc=t=>ds(t.getBody()).bind(t=>{let r=t.container();return J.from(nT(r)?r.parentNode:r)}),Su=(t,r)=>{var n;return n=j(J.some,r),J.from(t.selection.getRng()).bind(r=>{let n=t.getBody();return r.startContainer===n&&0===r.startOffset?J.none():J.from(t.selection.getStart(!0))}).orThunk(V(Sc,t)).map(ri).filter(tY).bind(n)},Sm=(t,r)=>{if(/^[0-9.]+$/.test(r)){let n=parseInt(r,10);if(n>=1&&n<=7){let o=tF.explode(t.options.get("font_size_style_values")),a=tF.explode(t.options.get("font_size_classes"));return a.length>0?a[n-1]||r:o[n-1]||r}}return r},Sf=t=>ea(t.split(/\s*,\s*/),t=>-1===t.indexOf(" ")||e3(t,'"')||e3(t,"'")?t:`'${t}'`).join(","),Sg=(t,r)=>{let n=t.dom,o=t.selection.getRng(),a=r?t.selection.getStart():t.selection.getEnd(),l=r?o.startContainer:o.endContainer,i=xn(n,l);if(!i||!i.isContentEditable)return;let s=r?r8:r5,d=l7(t);((t,r,n,o)=>{let a=t.dom,l=t=>a.isBlock(t)&&t.parentElement===n,i=l(r)?r:a.getParent(o,l,n);return J.from(i).map(ri)})(t,a,i,l).each(r=>{let n=xi(t,l,r.dom,i,!1,d);s(r,ri(n)),t.selection.setCursorLocation(n,0),t.dispatch("NewBlock",{newBlock:n}),w6(t,"insertParagraph")})},Sp=t=>{Sr(t),(t=>{t.editorCommands.addCommands({"Cut,Copy,Paste":r=>{let n;let o=t.getDoc();try{o.execCommand(r)}catch(t){n=!0}if("paste"!==r||o.queryCommandEnabled(r)||(n=!0),n||!o.queryCommandSupported(r)){let r=t.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");(tB.os.isMacOS()||tB.os.isiOS())&&(r=r.replace(/Ctrl\+/g,"⌘+")),t.notificationManager.open({text:r,type:"error"})}}})})(t),(t=>{t.editorCommands.addCommands({mceAddUndoLevel:()=>{t.undoManager.add()},mceEndUndoLevel:()=>{t.undoManager.add()},Undo:()=>{t.undoManager.undo()},Redo:()=>{t.undoManager.redo()}})})(t),(t=>{t.editorCommands.addCommands({mceSelectNodeDepth:(r,n,o)=>{let a=0;t.dom.getParent(t.selection.getNode(),r=>!nx(r)||a++!==o||(t.selection.select(r),!1),t.getBody())},mceSelectNode:(r,n,o)=>{t.selection.select(o)},selectAll:()=>{let r=t.dom.getParent(t.selection.getStart(),nU);if(r){let n=t.dom.createRng();n.selectNodeContents(r),t.selection.setRng(n)}}})})(t),(t=>{t.editorCommands.addCommands({mceCleanup:()=>{let r=t.selection.getBookmark();t.setContent(t.getContent()),t.selection.moveToBookmark(r)},insertImage:(r,n,o)=>{So(t,t.dom.createHTML("img",{src:o}))},insertHorizontalRule:()=>{t.execCommand("mceInsertContent",!1,"<hr>")},insertText:(r,n,o)=>{So(t,t.dom.encode(o))},insertHTML:(r,n,o)=>{So(t,o)},mceInsertContent:(r,n,o)=>{So(t,o)},mceSetContent:(r,n,o)=>{t.setContent(o)},mceReplaceContent:(r,n,o)=>{t.execCommand("mceInsertContent",!1,o.replace(/\{\$selection\}/g,t.selection.getContent({format:"text"})))},mceNewDocument:()=>{t.setContent(sl(t))}})})(t),(t=>{let r=(r,n,o)=>{let a=N(o)?{href:o}:o,l=t.dom.getParent(t.selection.getNode(),"a");R(a)&&N(a.href)&&(a.href=a.href.replace(/ /g,"%20"),l&&a.href||t.formatter.remove("link"),a.href&&t.formatter.apply("link",a,l))};t.editorCommands.addCommands({unlink:()=>{if(t.selection.isEditable()){if(t.selection.isCollapsed()){let r=t.dom.getParent(t.selection.getStart(),"a");return void(r&&t.dom.remove(r,!0))}t.formatter.remove("link")}},mceInsertLink:r,createLink:r})})(t),t.editorCommands.addCommands({Indent:()=>{yY(t,"indent")},Outdent:()=>{yX(t)}}),t.editorCommands.addCommands({Outdent:()=>yW(t)},"state"),(t=>{t.editorCommands.addCommands({InsertNewBlockBefore:()=>{Sg(t,!0)},InsertNewBlockAfter:()=>{Sg(t,!1)}})})(t),(t=>{t.editorCommands.addCommands({insertParagraph:()=>{xI(xh,t)},mceInsertNewLine:(r,n,o)=>{xU(t,o)},InsertLineBreak:(r,n,o)=>{xI(xk,t)}})})(t),(t=>{t.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":r=>{t.getDoc().execCommand(r);let n=t.dom.getParent(t.selection.getNode(),"ol,ul");if(n){let r=n.parentNode;if(r&&/^(H[1-6]|P|ADDRESS|PRE)$/.test(r.nodeName)){let o=t.selection.getBookmark();t.dom.split(r,n),t.selection.moveToBookmark(o)}}}})})(t),(t=>{t.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":r=>{let n=t.dom.getParent(t.selection.getNode(),"ul,ol");return n&&("insertunorderedlist"===r&&"UL"===n.tagName||"insertorderedlist"===r&&"OL"===n.tagName)}},"state")})(t),(t=>{let r=(r,n)=>{t.formatter.toggle(r,n),t.nodeChanged()};t.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":t=>{r(t)},"ForeColor,HiliteColor":(t,n,o)=>{r(t,{value:o})},BackColor:(t,n,o)=>{r("hilitecolor",{value:o})},FontName:(r,n,o)=>{((t,r)=>{let n=Sm(t,r);t.formatter.toggle("fontname",{value:Sf(n)}),t.nodeChanged()})(t,o)},FontSize:(r,n,o)=>{t.formatter.toggle("fontsize",{value:Sm(t,o)}),t.nodeChanged()},LineHeight:(r,n,o)=>{t.formatter.toggle("lineheight",{value:String(o)}),t.nodeChanged()},Lang:(t,n,o)=>{var a;r(t,{value:o.code,customValue:null!==(a=o.customCode)&&void 0!==a?a:null})},RemoveFormat:r=>{t.formatter.remove(r)},mceBlockQuote:()=>{r("blockquote")},FormatBlock:(t,n,o)=>{r(N(o)?o:"p")},mceToggleFormat:(t,n,o)=>{r(o)}})})(t),(t=>{let r=r=>t.formatter.match(r);t.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":t=>r(t),mceBlockQuote:()=>r("blockquote")},"state"),t.editorCommands.addQueryValueHandler("FontName",()=>Su(t,r=>Sd(t.getBody(),r.dom)).getOr("")),t.editorCommands.addQueryValueHandler("FontSize",()=>Su(t,r=>Ss(t.getBody(),r.dom)).getOr("")),t.editorCommands.addQueryValueHandler("LineHeight",()=>Su(t,r=>gn(r,t=>r1(t,"line-height"),V(rp,ri(t.getBody()))).getOrThunk(()=>String(parseFloat(rZ(r,"line-height"))/parseFloat(rZ(r,"font-size"))))).getOr(""))})(t),(t=>{t.editorCommands.addCommands({mceRemoveNode:(r,n,o)=>{let a=null!=o?o:t.selection.getNode();if(a!==t.getBody()){let r=t.selection.getBookmark();t.dom.remove(a,!0),t.selection.moveToBookmark(r)}},mcePrint:()=>{t.getWin().print()},mceFocus:(r,n,o)=>{var a;a=!0===o,t.removed||(a?uU(t):(t=>{let r;let n=t.selection,o=t.getBody(),a=n.getRng();t.quirks.refreshContentEditable(),L(t.bookmark)&&!uI(t)&&uN(t).each(r=>{t.selection.setRng(r),a=r});let l=(r=n.getNode(),t.dom.getParent(r,r=>"true"===t.dom.getContentEditable(r)));if(l&&t.dom.isChildOf(l,o))return uM(l),uF(t,a),void uU(t);t.inline||(tB.browser.isOpera()||uM(o),t.getWin().focus()),(tB.browser.isFirefox()||t.inline)&&(uM(o),uF(t,a)),uU(t)})(t))},mceToggleVisualAid:()=>{t.hasVisual=!t.hasVisual,t.addVisual()}})})(t)},Sh=["toggleview"],Sb=t=>en(Sh,t.toLowerCase());class Sv{constructor(t){this.commands={state:{},exec:{},value:{}},this.editor=t}execCommand(t,r=!1,n,o){let a=this.editor,l=t.toLowerCase(),i=null==o?void 0:o.skip_focus;if(a.removed||("mcefocus"!==l&&(/^(mceAddUndoLevel|mceEndUndoLevel)$/i.test(l)||i?(t=>{uN(t).each(r=>t.selection.setRng(r))})(a):a.focus()),a.dispatch("BeforeExecCommand",{command:t,ui:r,value:n}).isDefaultPrevented()))return!1;let s=this.commands.exec[l];return!!F(s)&&(s(l,r,n),a.dispatch("ExecCommand",{command:t,ui:r,value:n}),!0)}queryCommandState(t){if(!Sb(t)&&this.editor.quirks.isHidden()||this.editor.removed)return!1;let r=t.toLowerCase(),n=this.commands.state[r];return!!F(n)&&n(r)}queryCommandValue(t){if(!Sb(t)&&this.editor.quirks.isHidden()||this.editor.removed)return"";let r=t.toLowerCase(),n=this.commands.value[r];return F(n)?n(r):""}addCommands(t,r="exec"){let n=this.commands;eA(t,(t,o)=>{el(o.toLowerCase().split(","),o=>{n[r][o]=t})})}addCommand(t,r,n){let o=t.toLowerCase();this.commands.exec[o]=(t,o,a)=>r.call(null!=n?n:this.editor,o,a)}queryCommandSupported(t){let r=t.toLowerCase();return!!this.commands.exec[r]}addQueryStateHandler(t,r,n){this.commands.state[t.toLowerCase()]=()=>r.call(null!=n?n:this.editor)}addQueryValueHandler(t,r,n){this.commands.value[t.toLowerCase()]=()=>r.call(null!=n?n:this.editor)}}let Sy="data-mce-contenteditable",SC=(t,r,n)=>{try{t.getDoc().execCommand(r,!1,String(n))}catch(t){}},Sw=(t,r)=>{t.dom.contentEditable=r?"true":"false"},Sx=(t,r)=>{var n;let o=ri(t.getBody());rl(o,n="mce-content-readonly")&&!r?ra(o,n):r&&rn(o,n),r?(t.selection.controlSelection.hideResizeRect(),t._selectionOverrides.hideFakeCaret(),(t=>{J.from(t.selection.getNode()).each(t=>{t.removeAttribute("data-mce-selected")})})(t),t.readonly=!0,Sw(o,!1),el(nb(o,'*[contenteditable="true"]'),t=>{t1(t,Sy,"true"),Sw(t,!1)})):(t.readonly=!1,t.hasEditableRoot()&&Sw(o,!0),el(nb(o,`*[${Sy}="true"]`),t=>{t6(t,Sy),Sw(t,!0)}),SC(t,"StyleWithCSS",!1),SC(t,"enableInlineTableEditing",!1),SC(t,"enableObjectResizing",!1),(uI(t)||uy(rL(ri(t.getElement()))).filter(r=>!uT(r.dom)&&uB(t,r.dom)).isSome())&&t.focus(),(t=>{t.selection.setRng(t.selection.getRng())})(t),t.nodeChanged())},SE=t=>t.readonly,Sk=t=>{t.parser.addAttributeFilter("contenteditable",r=>{SE(t)&&el(r,t=>{t.attr(Sy,t.attr("contenteditable")),t.attr("contenteditable","false")})}),t.serializer.addAttributeFilter(Sy,r=>{SE(t)&&el(r,t=>{t.attr("contenteditable",t.attr(Sy))})}),t.serializer.addTempAttr(Sy)},SS=["copy"],S_=tF.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," ");class SN{static isNative(t){return!!S_[t.toLowerCase()]}constructor(t){this.bindings={},this.settings=t||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||X}fire(t,r){return this.dispatch(t,r)}dispatch(t,r){let n=t.toLowerCase(),o=ah(n,null!=r?r:{},this.scope);this.settings.beforeFire&&this.settings.beforeFire(o);let a=this.bindings[n];if(a)for(let t=0,r=a.length;t<r;t++){let r=a[t];if(!r.removed){if(r.once&&this.off(n,r.func),o.isImmediatePropagationStopped())return o;if(!1===r.func.call(this.scope,o))return o.preventDefault(),o}}return o}on(t,r,n,o){if(!1===r&&(r=X),r){let a={func:r,removed:!1};o&&tF.extend(a,o);let l=t.toLowerCase().split(" "),i=l.length;for(;i--;){let t=l[i],r=this.bindings[t];r||(r=[],this.toggleEvent(t,!0)),r=n?[a,...r]:[...r,a],this.bindings[t]=r}}return this}off(t,r){if(t){let n=t.toLowerCase().split(" "),o=n.length;for(;o--;){let a=n[o],l=this.bindings[a];if(!a)return eA(this.bindings,(t,r)=>{this.toggleEvent(r,!1),delete this.bindings[r]}),this;if(l){if(r){let t=es(l,t=>t.func===r);l=t.fail,this.bindings[a]=l,el(t.pass,t=>{t.removed=!0})}else l.length=0;l.length||(this.toggleEvent(t,!1),delete this.bindings[a])}}}else eA(this.bindings,(t,r)=>{this.toggleEvent(r,!1)}),this.bindings={};return this}once(t,r,n){return this.on(t,r,n,{once:!0})}has(t){t=t.toLowerCase();let r=this.bindings[t];return!(!r||0===r.length)}}let SR=t=>(t._eventDispatcher||(t._eventDispatcher=new SN({scope:t,toggleEvent:(r,n)=>{SN.isNative(r)&&t.toggleNativeEvent&&t.toggleNativeEvent(r,n)}})),t._eventDispatcher),SA={fire(t,r,n){return this.dispatch(t,r,n)},dispatch(t,r,n){if(this.removed&&"remove"!==t&&"detach"!==t)return ah(t.toLowerCase(),null!=r?r:{},this);let o=SR(this).dispatch(t,r);if(!1!==n&&this.parent){let r=this.parent();for(;r&&!o.isPropagationStopped();)r.dispatch(t,o,!1),r=r.parent?r.parent():void 0}return o},on(t,r,n){return SR(this).on(t,r,n)},off(t,r){return SR(this).off(t,r)},once(t,r){return SR(this).once(t,r)},hasEventListeners(t){return SR(this).has(t)}},SO=aB.DOM,ST=(t,r)=>{if("selectionchange"===r)return t.getDoc();if(!t.inline&&/^(?:mouse|touch|click|contextmenu|drop|dragover|dragend)/.test(r))return t.getDoc().documentElement;let n=iT(t);return n?(t.eventRoot||(t.eventRoot=SO.select(n)[0]),t.eventRoot):t.getBody()},SB=(t,r,n)=>{var o,a;t.hidden||SE(t)?SE(t)&&(o=t,"click"!==(a=n).type||cR.metaKeyPressed(a)?en(SS,a.type)&&o.dispatch(a.type,a):rW(ri(a.target),"a",t=>rp(t,ri(o.getBody()))).bind(t=>t8(t,"href")).each(t=>{if(a.preventDefault(),/^#/.test(t)){let r=o.dom.select(`${t},[name="${e1(t,"#")}"]`);r.length&&o.selection.scrollIntoView(r[0],!0)}else window.open(t,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")})):t.dispatch(r,n)},SD=(t,n)=>{if(t.delegates||(t.delegates={}),t.delegates[n]||t.removed)return;let o=ST(t,n);if(iT(t)){if(r||(r={},t.editorManager.on("removeEditor",()=>{t.editorManager.activeEditor||r&&(eA(r,(r,n)=>{t.dom.unbind(ST(t,n))}),r=null)})),r[n])return;let a=r=>{let o=r.target,a=t.editorManager.get(),l=a.length;for(;l--;){let t=a[l].getBody();(t===o||SO.isChildOf(o,t))&&SB(a[l],n,r)}};r[n]=a,SO.bind(o,n,a)}else{let r=r=>{SB(t,n,r)};SO.bind(o,n,r),t.delegates[n]=r}},SP={...SA,bindPendingEventDelegates(){let t=this;tF.each(t._pendingNativeEvents,r=>{SD(t,r)})},toggleNativeEvent(t,r){"focus"!==t&&"blur"!==t&&(this.removed||(r?this.initialized?SD(this,t):this._pendingNativeEvents?this._pendingNativeEvents.push(t):this._pendingNativeEvents=[t]:this.initialized&&this.delegates&&(this.dom.unbind(ST(this,t),t,this.delegates[t]),delete this.delegates[t])))},unbindAllNativeEvents(){let t=this,r=t.getBody(),n=t.dom;t.delegates&&(eA(t.delegates,(r,n)=>{t.dom.unbind(ST(t,n),n,r)}),delete t.delegates),!t.inline&&r&&n&&(r.onload=null,n.unbind(t.getWin()),n.unbind(t.getDoc())),n&&(n.unbind(r),n.unbind(t.getContainer()))}},SL=t=>N(t)?{value:t.split(/[ ,]/),valid:!0}:I(t,N)?{value:t,valid:!0}:{valid:!1,message:"The value must be a string[] or a comma/space separated string."},SF=(t,r)=>t+(te(r.message)?"":`. ${r.message}`),SM=t=>t.valid,SI=(t,r,n="")=>{let o=r(t);return B(o)?o?{value:t,valid:!0}:{valid:!1,message:n}:o},SU=["design","readonly"],Sz=(t,r,n,o)=>{let a=n[r.get()],l=n[o];try{l.activate()}catch(t){return void console.error(`problem while activating editor mode ${o}:`,t)}a.deactivate(),a.editorReadOnly!==l.editorReadOnly&&Sx(t,l.editorReadOnly),r.set(o),((t,r)=>{t.dispatch("SwitchMode",{mode:r})})(t,o)},Sj=tF.each,SH=tF.explode,S$={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},Sq=tF.makeMap("alt,ctrl,shift,meta,access"),SV=t=>{let r;let n={},o=tB.os.isMacOS()||tB.os.isiOS();Sj(SH(t.toLowerCase(),"+"),t=>{t in Sq?n[t]=!0:/^[0-9]{2,}$/.test(t)?n.keyCode=parseInt(t,10):(n.charCode=t.charCodeAt(0),n.keyCode=S$[t]||t.toUpperCase().charCodeAt(0))});let a=[n.keyCode];for(r in Sq)n[r]?a.push(r):n[r]=!1;return n.id=a.join(","),n.access&&(n.alt=!0,o?n.ctrl=!0:n.shift=!0),n.meta&&(o?n.meta=!0:(n.ctrl=!0,n.meta=!1)),n};class SW{constructor(t){this.shortcuts={},this.pendingPatterns=[],this.editor=t;let r=this;t.on("keyup keypress keydown",t=>{!r.hasModifier(t)&&!r.isFunctionKey(t)||t.isDefaultPrevented()||(Sj(r.shortcuts,n=>{r.matchShortcut(t,n)&&(r.pendingPatterns=n.subpatterns.slice(0),"keydown"===t.type&&r.executeShortcutAction(n))}),r.matchShortcut(t,r.pendingPatterns[0])&&(1===r.pendingPatterns.length&&"keydown"===t.type&&r.executeShortcutAction(r.pendingPatterns[0]),r.pendingPatterns.shift()))})}add(t,r,n,o){let a=this,l=a.normalizeCommandFunc(n);return Sj(SH(tF.trim(t)),t=>{let n=a.createShortcut(t,r,l,o);a.shortcuts[n.id]=n}),!0}remove(t){let r=this.createShortcut(t);return!!this.shortcuts[r.id]&&(delete this.shortcuts[r.id],!0)}normalizeCommandFunc(t){let r=this;return"string"==typeof t?()=>{r.editor.execCommand(t,!1,null)}:tF.isArray(t)?()=>{r.editor.execCommand(t[0],t[1],t[2])}:t}createShortcut(t,r,n,o){let a=tF.map(SH(t,">"),SV);return a[a.length-1]=tF.extend(a[a.length-1],{func:n,scope:o||this.editor}),tF.extend(a[0],{desc:this.editor.translate(r),subpatterns:a.slice(1)})}hasModifier(t){return t.altKey||t.ctrlKey||t.metaKey}isFunctionKey(t){return"keydown"===t.type&&t.keyCode>=112&&t.keyCode<=123}matchShortcut(t,r){return!!r&&r.ctrl===t.ctrlKey&&r.meta===t.metaKey&&r.alt===t.altKey&&r.shift===t.shiftKey&&!!(t.keyCode===r.keyCode||t.charCode&&t.charCode===r.charCode)&&(t.preventDefault(),!0)}executeShortcutAction(t){return t.func?t.func.call(t.scope):null}}let SK=()=>{let t=(()=>{let t={},r={},n={},o={},a={},l={},i={},s={},d=(t,r)=>(n,o)=>{t[n.toLowerCase()]={...o,type:r}};return{addButton:d(t,"button"),addGroupToolbarButton:d(t,"grouptoolbarbutton"),addToggleButton:d(t,"togglebutton"),addMenuButton:d(t,"menubutton"),addSplitButton:d(t,"splitbutton"),addMenuItem:d(r,"menuitem"),addNestedMenuItem:d(r,"nestedmenuitem"),addToggleMenuItem:d(r,"togglemenuitem"),addAutocompleter:d(n,"autocompleter"),addContextMenu:d(a,"contextmenu"),addContextToolbar:d(l,"contexttoolbar"),addContextForm:d(l,"contextform"),addSidebar:d(i,"sidebar"),addView:d(s,"views"),addIcon:(t,r)=>o[t.toLowerCase()]=r,getAll:()=>({buttons:t,menuItems:r,icons:o,popups:n,contextMenus:a,contextToolbars:l,sidebars:i,views:s})}})();return{addAutocompleter:t.addAutocompleter,addButton:t.addButton,addContextForm:t.addContextForm,addContextMenu:t.addContextMenu,addContextToolbar:t.addContextToolbar,addIcon:t.addIcon,addMenuButton:t.addMenuButton,addMenuItem:t.addMenuItem,addNestedMenuItem:t.addNestedMenuItem,addSidebar:t.addSidebar,addSplitButton:t.addSplitButton,addToggleButton:t.addToggleButton,addGroupToolbarButton:t.addGroupToolbarButton,addToggleMenuItem:t.addToggleMenuItem,addView:t.addView,getAll:t.getAll}},SG=aB.DOM,SY=tF.extend,SX=tF.each;class SQ{constructor(t,r,n){this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.composing=!1,this.destroyed=!1,this.hasHiddenInput=!1,this.iframeElement=null,this.initialized=!1,this.readonly=!1,this.removed=!1,this.startContent="",this._pendingNativeEvents=[],this._skinLoaded=!1,this._editableRoot=!0,this.editorManager=n,this.documentBaseUrl=n.documentBaseURL,SY(this,SP),this.id=t,this.hidden=!1;let o=St(k8||k5,k8,r,n.defaultOptions,r);this.options=((t,r)=>{let n={},o={},a=(t,r,n)=>{let a=SI(r,n);return SM(a)?(o[t]=a.value,!0):(console.warn(SF(`Invalid value passed for the ${t} option`,a)),!1)},l=t=>eI(n,t);return{register:(t,l)=>{let i=N(l.processor)?(t=>{let r=(()=>{switch(t){case"array":return O;case"boolean":return B;case"function":return F;case"number":return M;case"object":return R;case"string":return N;case"string[]":return SL;case"object[]":return t=>I(t,R);case"regexp":return t=>_(t,RegExp);default:return Q}})();return n=>SI(n,r,`The value must be a ${t}.`)})(l.processor):l.processor,s=((t,r,n)=>{if(!D(r)){let o=SI(r,n);if(SM(o))return o.value;console.error(SF(`Invalid default value passed for the "${t}" option`,o))}})(t,l.default,i);n[t]={...l,default:s,processor:i},eM(o,t).orThunk(()=>eM(r,t)).each(r=>a(t,r,i))},isRegistered:l,get:t=>eM(o,t).orThunk(()=>eM(n,t).map(t=>t.default)).getOrUndefined(),set:(t,r)=>{if(l(t)){let o=n[t];return o.immutable?(console.error(`"${t}" is an immutable option and cannot be updated`),!1):a(t,r,o.processor)}return console.warn(`"${t}" is not a registered option. Ensure the option has been registered before setting a value.`),!1},unset:t=>{let r=l(t);return r&&delete o[t],r},isSet:t=>eI(o,t)}})(0,o),(t=>{let r=t.options.register;r("id",{processor:"string",default:t.id}),r("selector",{processor:"string"}),r("target",{processor:"object"}),r("suffix",{processor:"string"}),r("cache_suffix",{processor:"string"}),r("base_url",{processor:"string"}),r("referrer_policy",{processor:"string",default:""}),r("language_load",{processor:"boolean",default:!0}),r("inline",{processor:"boolean",default:!1}),r("iframe_attrs",{processor:"object",default:{}}),r("doctype",{processor:"string",default:"<!DOCTYPE html>"}),r("document_base_url",{processor:"string",default:t.documentBaseUrl}),r("body_id",{processor:l1(t,"tinymce"),default:"tinymce"}),r("body_class",{processor:l1(t),default:""}),r("content_security_policy",{processor:"string",default:""}),r("br_in_pre",{processor:"boolean",default:!0}),r("forced_root_block",{processor:t=>{let r=N(t)&&e7(t);return r?{value:t,valid:r}:{valid:!1,message:"Must be a non-empty string."}},default:"p"}),r("forced_root_block_attrs",{processor:"object",default:{}}),r("newline_behavior",{processor:t=>{let r=en(["block","linebreak","invert","default"],t);return r?{value:t,valid:r}:{valid:!1,message:"Must be one of: block, linebreak, invert or default."}},default:"default"}),r("br_newline_selector",{processor:"string",default:".mce-toc h2,figcaption,caption"}),r("no_newline_selector",{processor:"string",default:""}),r("keep_styles",{processor:"boolean",default:!0}),r("end_container_on_empty_block",{processor:t=>B(t)||N(t)?{valid:!0,value:t}:{valid:!1,message:"Must be boolean or a string"},default:"blockquote"}),r("font_size_style_values",{processor:"string",default:"xx-small,x-small,small,medium,large,x-large,xx-large"}),r("font_size_legacy_values",{processor:"string",default:"xx-small,small,medium,large,x-large,xx-large,300%"}),r("font_size_classes",{processor:"string",default:""}),r("automatic_uploads",{processor:"boolean",default:!0}),r("images_reuse_filename",{processor:"boolean",default:!1}),r("images_replace_blob_uris",{processor:"boolean",default:!0}),r("icons",{processor:"string",default:""}),r("icons_url",{processor:"string",default:""}),r("images_upload_url",{processor:"string",default:""}),r("images_upload_base_path",{processor:"string",default:""}),r("images_upload_credentials",{processor:"boolean",default:!1}),r("images_upload_handler",{processor:"function"}),r("language",{processor:"string",default:"en"}),r("language_url",{processor:"string",default:""}),r("entity_encoding",{processor:"string",default:"named"}),r("indent",{processor:"boolean",default:!0}),r("indent_before",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),r("indent_after",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),r("indent_use_margin",{processor:"boolean",default:!1}),r("indentation",{processor:"string",default:"40px"}),r("content_css",{processor:t=>{let r=!1===t||N(t)||I(t,N);return r?N(t)?{value:ea(t.split(","),e6),valid:r}:O(t)?{value:t,valid:r}:!1===t?{value:[],valid:r}:{value:t,valid:r}:{valid:!1,message:"Must be false, a string or an array of strings."}},default:i$(t)?[]:["default"]}),r("content_style",{processor:"string"}),r("content_css_cors",{processor:"boolean",default:!1}),r("font_css",{processor:t=>{let r=N(t)||I(t,N);return r?{value:O(t)?t:ea(t.split(","),e6),valid:r}:{valid:!1,message:"Must be a string or an array of strings."}},default:[]}),r("inline_boundaries",{processor:"boolean",default:!0}),r("inline_boundaries_selector",{processor:"string",default:"a[href],code,span.mce-annotation"}),r("object_resizing",{processor:t=>{let r=B(t)||N(t);return r?!1===t||lY.isiPhone()||lY.isiPad()?{value:"",valid:r}:{value:!0===t?"table,img,figure.image,div,video,iframe":t,valid:r}:{valid:!1,message:"Must be boolean or a string"}},default:!lX}),r("resize_img_proportional",{processor:"boolean",default:!0}),r("event_root",{processor:"object"}),r("service_message",{processor:"string"}),r("theme",{processor:t=>!1===t||N(t)||F(t),default:"silver"}),r("theme_url",{processor:"string"}),r("formats",{processor:"object"}),r("format_empty_lines",{processor:"boolean",default:!1}),r("format_noneditable_selector",{processor:"string",default:""}),r("preview_styles",{processor:t=>{let r=!1===t||N(t);return r?{value:!1===t?"":t,valid:r}:{valid:!1,message:"Must be false or a string"}},default:"font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"}),r("custom_ui_selector",{processor:"string",default:""}),r("hidden_input",{processor:"boolean",default:!0}),r("submit_patch",{processor:"boolean",default:!0}),r("encoding",{processor:"string"}),r("add_form_submit_trigger",{processor:"boolean",default:!0}),r("add_unload_trigger",{processor:"boolean",default:!0}),r("custom_undo_redo_levels",{processor:"number",default:0}),r("disable_nodechange",{processor:"boolean",default:!1}),r("readonly",{processor:"boolean",default:!1}),r("editable_root",{processor:"boolean",default:!0}),r("plugins",{processor:"string[]",default:[]}),r("external_plugins",{processor:"object"}),r("forced_plugins",{processor:"string[]"}),r("model",{processor:"string",default:t.hasPlugin("rtc")?"plugin":"dom"}),r("model_url",{processor:"string"}),r("block_unsupported_drop",{processor:"boolean",default:!0}),r("visual",{processor:"boolean",default:!0}),r("visual_table_class",{processor:"string",default:"mce-item-table"}),r("visual_anchor_class",{processor:"string",default:"mce-item-anchor"}),r("iframe_aria_text",{processor:"string",default:"Rich Text Area. Press ALT-0 for help."}),r("setup",{processor:"function"}),r("init_instance_callback",{processor:"function"}),r("url_converter",{processor:"function",default:t.convertURL}),r("url_converter_scope",{processor:"object",default:t}),r("urlconverter_callback",{processor:"function"}),r("allow_conditional_comments",{processor:"boolean",default:!1}),r("allow_html_data_urls",{processor:"boolean",default:!1}),r("allow_svg_data_urls",{processor:"boolean"}),r("allow_html_in_named_anchor",{processor:"boolean",default:!1}),r("allow_script_urls",{processor:"boolean",default:!1}),r("allow_unsafe_link_target",{processor:"boolean",default:!1}),r("convert_fonts_to_spans",{processor:"boolean",default:!0,deprecated:!0}),r("fix_list_elements",{processor:"boolean",default:!1}),r("preserve_cdata",{processor:"boolean",default:!1}),r("remove_trailing_brs",{processor:"boolean",default:!0}),r("pad_empty_with_br",{processor:"boolean",default:!1}),r("inline_styles",{processor:"boolean",default:!0,deprecated:!0}),r("element_format",{processor:"string",default:"html"}),r("entities",{processor:"string"}),r("schema",{processor:"string",default:"html5"}),r("convert_urls",{processor:"boolean",default:!0}),r("relative_urls",{processor:"boolean",default:!0}),r("remove_script_host",{processor:"boolean",default:!0}),r("custom_elements",{processor:"string"}),r("extended_valid_elements",{processor:"string"}),r("invalid_elements",{processor:"string"}),r("invalid_styles",{processor:l0}),r("valid_children",{processor:"string"}),r("valid_classes",{processor:l0}),r("valid_elements",{processor:"string"}),r("valid_styles",{processor:l0}),r("verify_html",{processor:"boolean",default:!0}),r("auto_focus",{processor:t=>N(t)||!0===t}),r("browser_spellcheck",{processor:"boolean",default:!1}),r("protect",{processor:"array"}),r("images_file_types",{processor:"string",default:"jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp"}),r("deprecation_warnings",{processor:"boolean",default:!0}),r("a11y_advanced_options",{processor:"boolean",default:!1}),r("api_key",{processor:"string"}),r("paste_block_drop",{processor:"boolean",default:!1}),r("paste_data_images",{processor:"boolean",default:!0}),r("paste_preprocess",{processor:"function"}),r("paste_postprocess",{processor:"function"}),r("paste_webkit_styles",{processor:"string",default:"none"}),r("paste_remove_styles_if_webkit",{processor:"boolean",default:!0}),r("paste_merge_formats",{processor:"boolean",default:!0}),r("smart_paste",{processor:"boolean",default:!0}),r("paste_as_text",{processor:"boolean",default:!1}),r("paste_tab_spaces",{processor:"number",default:4}),r("text_patterns",{processor:t=>I(t,R)||!1===t?{value:lG(!1===t?[]:t),valid:!0}:{valid:!1,message:"Must be an array of objects or false."},default:[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}]}),r("text_patterns_lookup",{processor:t=>F(t)?{value:r=>lG(t(r)),valid:!0}:{valid:!1,message:"Must be a single function"},default:t=>[]}),r("noneditable_class",{processor:"string",default:"mceNonEditable"}),r("editable_class",{processor:"string",default:"mceEditable"}),r("noneditable_regexp",{processor:t=>I(t,lJ)?{value:t,valid:!0}:lJ(t)?{value:[t],valid:!0}:{valid:!1,message:"Must be a RegExp or an array of RegExp."},default:[]}),r("table_tab_navigation",{processor:"boolean",default:!0}),r("highlight_on_focus",{processor:"boolean",default:!1}),r("xss_sanitization",{processor:"boolean",default:!0}),r("details_initial_state",{processor:t=>{let r=en(["inherited","collapsed","expanded"],t);return r?{value:t,valid:r}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),r("details_serialized_state",{processor:t=>{let r=en(["inherited","collapsed","expanded"],t);return r?{value:t,valid:r}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),r("init_content_sync",{processor:"boolean",default:!1}),r("newdocument_content",{processor:"string",default:""}),t.on("ScriptsLoaded",()=>{r("directionality",{processor:"string",default:aU.isRtl()?"rtl":void 0}),r("placeholder",{processor:"string",default:lQ.getAttrib(t.getElement(),"placeholder")})})})(this);let a=this.options.get;a("deprecation_warnings")&&(((t,r)=>{let n=bi(t),o=bc(r),a=o.length>0,l=n.length>0,i="mobile"===r.theme;(a||l||i)&&console.warn("The following deprecated features are currently enabled and have been removed in TinyMCE 6.0. These features will no longer work and should be removed from the TinyMCE configuration. See https://www.tiny.cloud/docs/tinymce/6/migration-from-5x/ for more information."+(i?`

Themes:
- mobile`:"")+(a?`

Plugins:
- ${o.join("\n- ")}`:"")+(l?`

Options:
- ${n.join("\n- ")}`:""))})(r,o),((t,r)=>{let n=bs(t),o=bu(r),a=o.length>0,l=n.length>0;(a||l)&&console.warn("The following deprecated features are currently enabled but will be removed soon."+(a?`

Plugins:
- ${o.map(bm).join("\n- ")}`:"")+(l?`

Options:
- ${n.join("\n- ")}`:""))})(r,o));let l=a("suffix");l&&(n.suffix=l),this.suffix=n.suffix;let i=a("base_url");i&&n._setBaseUrl(i),this.baseUri=n.baseURI;let s=iv(this);s&&(aP.ScriptLoader._setReferrerPolicy(s),aB.DOM.styleSheetLoader._setReferrerPolicy(s));let d=iJ(this);L(d)&&aB.DOM.styleSheetLoader._setContentCssCors(d),az.languageLoad=a("language_load"),az.baseURL=n.baseURL,this.setDirty(!1),this.documentBaseURI=new hi(l8(this),{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=i$(this),this.hasVisual=i2(this),this.shortcuts=new SW(this),this.editorCommands=new Sv(this),Sp(this);let c=a("cache_suffix");c&&(tB.cacheSuffix=c.replace(/^[\?\&]+/,"")),this.ui={registry:SK(),styleSheetLoader:void 0,show:U,hide:U,setEnabled:U,isEnabled:Q},this.mode=(t=>{let r=aL("design"),n=aL({design:{activate:U,deactivate:U,editorReadOnly:!1},readonly:{activate:U,deactivate:U,editorReadOnly:!0}});return t.serializer?Sk(t):t.on("PreInit",()=>{Sk(t)}),t.on("ShowCaret",r=>{SE(t)&&r.preventDefault()}),t.on("ObjectSelected",r=>{SE(t)&&r.preventDefault()}),{isReadOnly:()=>SE(t),set:o=>((t,r,n,o)=>{if(o!==n.get()){if(!eI(r,o))throw Error(`Editor mode '${o}' is invalid`);t.initialized?Sz(t,n,r,o):t.on("init",()=>Sz(t,n,r,o))}})(t,n.get(),r,o),get:()=>r.get(),register:(t,r)=>{n.set(((t,r,n)=>{if(en(SU,r))throw Error(`Cannot override default mode ${r}`);return{...t,[r]:{...n,deactivate:()=>{try{n.deactivate()}catch(t){console.error(`problem while deactivating editor mode ${r}:`,t)}}}}})(n.get(),t,r))}}})(this),n.dispatch("SetupEditor",{editor:this});let u=i6(this);F(u)&&u.call(this,this)}render(){(t=>{let r=t.id;aU.setCode(iy(t));let n=()=>{kZ.unbind(window,"ready",n),t.render()};if(!ax.Event.domLoaded)return void kZ.bind(window,"ready",n);if(!t.getElement())return;let o=ri(t.getElement()),a=t9(o);t.on("remove",()=>{ei(o.dom.attributes,t=>t6(o,t.name)),t2(o,a)}),t.ui.styleSheetLoader=oG.forElement(o,{contentCssCors:iJ(t),referrerPolicy:iv(t)}),i$(t)?t.inline=!0:(t.orgVisibility=t.getElement().style.visibility,t.getElement().style.visibility="hidden");let l=t.getElement().form||kZ.getParent(r,"form");l&&(t.formElement=l,iq(t)&&!nO(t.getElement())&&(kZ.insertAfter(kZ.create("input",{type:"hidden",name:r}),r),t.hasHiddenInput=!0),t.formEventDelegate=r=>{t.dispatch(r.type,r)},kZ.bind(l,"submit reset",t.formEventDelegate),t.on("reset",()=>{t.resetContent()}),!iV(t)||l.submit.nodeType||l.submit.length||l._mceOldSubmit||(l._mceOldSubmit=l.submit,l.submit=()=>(t.editorManager.triggerSave(),t.setDirty(!1),l._mceOldSubmit(l)))),t.windowManager=b_(t),t.notificationManager=bE(t),"xml"===t.options.get("encoding")&&t.on("GetContent",t=>{t.save&&(t.content=kZ.encode(t.content))}),iW(t)&&t.on("submit",()=>{t.initialized&&t.save()}),iK(t)&&(t._beforeUnload=()=>{!t.initialized||t.destroyed||t.isHidden()||t.save({format:"raw",no_events:!0,set_dirty:!1})},t.editorManager.on("BeforeUnload",t._beforeUnload)),t.editorManager.add(t),k2(t,t.suffix)})(this)}focus(t){this.execCommand("mceFocus",!1,t)}hasFocus(){return uI(this)}translate(t){return aU.translate(t)}getParam(t,r,n){let o=this.options;return o.isRegistered(t)||(L(n)?o.register(t,{processor:n,default:r}):o.register(t,{processor:Q,default:r})),o.isSet(t)||D(r)?o.get(t):r}hasPlugin(t,r){return!(!en(iZ(this),t)||r&&void 0===bk.get(t))}nodeChanged(t){this._nodeChangeDispatcher.nodeChanged(t)}addCommand(t,r,n){this.editorCommands.addCommand(t,r,n)}addQueryStateHandler(t,r,n){this.editorCommands.addQueryStateHandler(t,r,n)}addQueryValueHandler(t,r,n){this.editorCommands.addQueryValueHandler(t,r,n)}addShortcut(t,r,n,o){this.shortcuts.add(t,r,n,o)}execCommand(t,r,n,o){return this.editorCommands.execCommand(t,r,n,o)}queryCommandState(t){return this.editorCommands.queryCommandState(t)}queryCommandValue(t){return this.editorCommands.queryCommandValue(t)}queryCommandSupported(t){return this.editorCommands.queryCommandSupported(t)}show(){this.hidden&&(this.hidden=!1,this.inline?this.getBody().contentEditable="true":(SG.show(this.getContainer()),SG.hide(this.id)),this.load(),this.dispatch("show"))}hide(){this.hidden||(this.save(),this.inline?(this.getBody().contentEditable="false",this===this.editorManager.focusedEditor&&(this.editorManager.focusedEditor=null)):(SG.hide(this.getContainer()),SG.setStyle(this.id,"display",this.orgDisplay)),this.hidden=!0,this.dispatch("hide"))}isHidden(){return this.hidden}setProgressState(t,r){this.dispatch("ProgressState",{state:t,time:r})}load(t={}){let r=this.getElement();if(this.removed)return"";if(r){let n={...t,load:!0},o=nO(r)?r.value:r.innerHTML,a=this.setContent(o,n);return n.no_events||this.dispatch("LoadContent",{...n,element:r}),a}return""}save(t={}){let r=this,n=r.getElement();if(!n||!r.initialized||r.removed)return"";let o={...t,save:!0,element:n},a=r.getContent(o),l={...o,content:a};if(l.no_events||r.dispatch("SaveContent",l),"raw"===l.format&&r.dispatch("RawSaveContent",l),a=l.content,nO(n))n.value=a;else{!t.is_removing&&r.inline||(n.innerHTML=a);let o=SG.getParent(r.id,"form");o&&SX(o.elements,t=>t.name!==r.id||(t.value=a,!1))}return l.element=o.element=n=null,!1!==l.set_dirty&&r.setDirty(!1),a}setContent(t,r){return bt(this,t,r)}getContent(t){return((t,r={})=>{let n;return hx(t,(n=r.format?r.format:"html",{...r,format:n,get:!0,getInner:!0})).fold($,r=>{let n=h0(t).editor.getContent(r);return hE(t,n,r)})})(this,t)}insertContent(t,r){r&&(t=SY({content:t},r)),this.execCommand("mceInsertContent",!1,t)}resetContent(t){void 0===t?bt(this,this.startContent,{format:"raw"}):bt(this,t),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()}isDirty(){return!this.isNotDirty}setDirty(t){let r=!this.isNotDirty;this.isNotDirty=!t,t&&t!==r&&this.dispatch("dirty")}getContainer(){return this.container||(this.container=this.editorContainer||SG.get(this.id+"_parent")),this.container}getContentAreaContainer(){return this.contentAreaContainer}getElement(){return this.targetElm||(this.targetElm=SG.get(this.id)),this.targetElm}getWin(){if(!this.contentWindow){let t=this.iframeElement;t&&(this.contentWindow=t.contentWindow)}return this.contentWindow}getDoc(){if(!this.contentDocument){let t=this.getWin();t&&(this.contentDocument=t.document)}return this.contentDocument}getBody(){var t,r;let n=this.getDoc();return null!==(r=null!==(t=this.bodyElement)&&void 0!==t?t:null==n?void 0:n.body)&&void 0!==r?r:null}convertURL(t,r,n){let o=this.options.get,a=i4(this);return F(a)?a.call(this,t,n,!0,r):!o("convert_urls")||"link"===n||R(n)&&"LINK"===n.nodeName||0===t.indexOf("file:")||0===t.length?t:o("relative_urls")?this.documentBaseURI.toRelative(t):t=this.documentBaseURI.toAbsolute(t,o("remove_script_host"))}addVisual(t){((t,r)=>{h1(t).editor.addVisual(r)})(this,t)}setEditableRoot(t){this._editableRoot!==t&&(this._editableRoot=t,this.readonly||(this.getBody().contentEditable=String(this.hasEditableRoot()),this.nodeChanged()),((t,r)=>{t.dispatch("EditableRootStateChange",{state:r})})(this,t))}hasEditableRoot(){return this._editableRoot}remove(){(t=>{if(!t.removed){let{_selectionOverrides:r,editorUpload:n}=t,o=t.getBody(),a=t.getElement();o&&t.save({is_removing:!0}),t.removed=!0,t.unbindAllNativeEvents(),t.hasHiddenInput&&L(null==a?void 0:a.nextSibling)&&bf.remove(a.nextSibling),(t=>{t.dispatch("remove")})(t),t.editorManager.remove(t),!t.inline&&o&&bf.setStyle(t.id,"display",t.orgDisplay),(t=>{t.dispatch("detach")})(t),bf.remove(t.getContainer()),bg(r),bg(n),t.destroy()}})(this)}destroy(t){((t,r)=>{let{selection:n,dom:o}=t;t.destroyed||(r||t.removed?(r||(t.editorManager.off("beforeunload",t._beforeUnload),t.theme&&t.theme.destroy&&t.theme.destroy(),bg(n),bg(o)),(t=>{let r=t.formElement;r&&(r._mceOldSubmit&&(r.submit=r._mceOldSubmit,delete r._mceOldSubmit),bf.unbind(r,"submit reset",t.formEventDelegate))})(t),(t=>{t.contentAreaContainer=t.formElement=t.container=t.editorContainer=null,t.bodyElement=t.contentDocument=t.contentWindow=null,t.iframeElement=t.targetElm=null;let r=t.selection;if(r){let n=r.dom;t.selection=r.win=r.dom=n.doc=null}})(t),t.destroyed=!0):t.remove())})(this,t)}uploadImages(){return this.editorUpload.uploadImages()}_scanForImages(){return this.editorUpload.scanForImages()}}let SJ=aB.DOM,SZ=tF.each,S0,S1=!1,S2=[],S3=t=>{let r=t.type;SZ(S9.get(),n=>{switch(r){case"scroll":n.dispatch("ScrollWindow",t);break;case"resize":n.dispatch("ResizeWindow",t)}})},S8=t=>{if(t!==S1){let r=aB.DOM;t?(r.bind(window,"resize",S3),r.bind(window,"scroll",S3)):(r.unbind(window,"resize",S3),r.unbind(window,"scroll",S3)),S1=t}},S5=t=>{let r=S2;return S2=ed(S2,r=>t!==r),S9.activeEditor===t&&(S9.activeEditor=S2.length>0?S2[0]:null),S9.focusedEditor===t&&(S9.focusedEditor=null),r.length!==S2.length},S6="CSS1Compat"!==document.compatMode,S9={...SA,baseURI:null,baseURL:null,defaultOptions:{},documentBaseURL:null,suffix:null,majorVersion:"6",minorVersion:"7.2",releaseDate:"2023-10-25",i18n:aU,activeEditor:null,focusedEditor:null,setup(){let t="",r="",n=hi.getDocumentBaseUrl(document.location);/^[^:]+:\/\/\/?[^\/]+\//.test(n)&&(n=n.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(n)||(n+="/"));let o=window.tinymce||window.tinyMCEPreInit;if(o)t=o.base||o.baseURL,r=o.suffix;else{let n=document.getElementsByTagName("script");for(let o=0;o<n.length;o++){let a=n[o].src||"";if(""===a)continue;let l=a.substring(a.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(a)){-1!==l.indexOf(".min")&&(r=".min"),t=a.substring(0,a.lastIndexOf("/"));break}}if(!t&&document.currentScript){let n=document.currentScript.src;-1!==n.indexOf(".min")&&(r=".min"),t=n.substring(0,n.lastIndexOf("/"))}}this.baseURL=new hi(n).toAbsolute(t),this.documentBaseURL=n,this.baseURI=new hi(this.baseURL),this.suffix=r,this.on("AddEditor",V(uP,this)),this.on("RemoveEditor",V(uL,this))},overrideDefaults(t){let r=t.base_url;r&&this._setBaseUrl(r);let n=t.suffix;n&&(this.suffix=n),this.defaultOptions=t;let o=t.plugin_base_urls;void 0!==o&&eA(o,(t,r)=>{az.PluginManager.urls[r]=t})},init(t){let r;let n=this,o=tF.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),a=t=>{r=t},l=()=>{let r,i=0,s=[];SJ.unbind(window,"ready",l),(r=>{let o=t.onpageload;o&&o.apply(n,[])})(),r=((t,r)=>{let n=[],o=F(r)?t=>eo(n,n=>r(n,t)):t=>en(n,t);for(let r=0,a=t.length;r<a;r++){let a=t[r];o(a)||n.push(a)}return n})(tB.browser.isIE()||tB.browser.isEdge()?(bT("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tiny.cloud/docs/tinymce/6/support/#supportedwebbrowsers"),[]):S6?(bT("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[]):N(t.selector)?SJ.select(t.selector):L(t.target)?[t.target]:[]),tF.each(r,t=>{var r;(r=n.get(t.id))&&r.initialized&&!(r.getContainer()||r.getBody()).parentNode&&(S5(r),r.unbindAllNativeEvents(),r.destroy(!0),r.removed=!0)}),0===(r=tF.grep(r,t=>!n.get(t.id))).length?a([]):SZ(r,l=>{let d;t.inline&&l.tagName.toLowerCase() in o?bT("Could not initialize inline editor on invalid inline target element",l):((t,o,l)=>{let d=new SQ(t,o,n);s.push(d),d.on("init",()=>{++i===r.length&&a(s)}),d.targetElm=d.targetElm||l,d.render()})(((d=l.id)||(d=eM(l,"name").filter(t=>!SJ.get(t)).getOrThunk(SJ.uniqueId),l.setAttribute("id",d)),d),t,l)})};return SJ.bind(window,"ready",l),new Promise(t=>{r?t(r):a=r=>{t(r)}})},get(t){return 0==arguments.length?S2.slice(0):N(t)?ef(S2,r=>r.id===t).getOr(null):M(t)&&S2[t]?S2[t]:null},add(t){let r=this,n=r.get(t.id);return n===t||(null===n&&S2.push(t),S8(!0),r.activeEditor=t,r.dispatch("AddEditor",{editor:t}),S0||(S0=t=>{let n=r.dispatch("BeforeUnload");if(n.returnValue)return t.preventDefault(),t.returnValue=n.returnValue,n.returnValue},window.addEventListener("beforeunload",S0))),t},createEditor(t,r){return this.add(new SQ(t,r,this))},remove(t){let r;let n=this;if(t){if(!N(t))return r=t,T(n.get(r.id))?null:(S5(r)&&n.dispatch("RemoveEditor",{editor:r}),0===S2.length&&window.removeEventListener("beforeunload",S0),r.remove(),S8(S2.length>0),r);SZ(SJ.select(t),t=>{(r=n.get(t.id))&&n.remove(r)})}else for(let t=S2.length-1;t>=0;t--)n.remove(S2[t])},execCommand(t,r,n){var o;let a=R(n)?null!==(o=n.id)&&void 0!==o?o:n.index:n;switch(t){case"mceAddEditor":return this.get(a)||new SQ(a,n.options,this).render(),!0;case"mceRemoveEditor":{let t=this.get(a);return t&&t.remove(),!0}case"mceToggleEditor":{let t=this.get(a);return t?t.isHidden()?t.show():t.hide():this.execCommand("mceAddEditor",!1,n),!0}}return!!this.activeEditor&&this.activeEditor.execCommand(t,r,n)},triggerSave:()=>{SZ(S2,t=>{t.save()})},addI18n:(t,r)=>{aU.add(t,r)},translate:t=>aU.translate(t),setActive(t){let r=this.activeEditor;this.activeEditor!==t&&(r&&r.dispatch("deactivate",{relatedTarget:t}),t.dispatch("activate",{relatedTarget:r})),this.activeEditor=t},_setBaseUrl(t){this.baseURL=new hi(this.documentBaseURL).toAbsolute(t.replace(/\/+$/,"")),this.baseURI=new hi(this.baseURL)}};S9.setup();let S4=(()=>{let t=aH();return{FakeClipboardItem:t=>({items:t,types:eN(t),getType:r=>eM(t,r).getOrUndefined()}),write:r=>{t.set(r)},read:()=>t.get().getOrUndefined(),clear:t.clear}})(),S7=Math.min,_e=Math.max,_t=Math.round,_r=(t,r,n)=>{let o=r.x,a=r.y,l=t.w,i=t.h,s=r.w,d=r.h,c=(n||"").split("");return"b"===c[0]&&(a+=d),"r"===c[1]&&(o+=s),"c"===c[0]&&(a+=_t(d/2)),"c"===c[1]&&(o+=_t(s/2)),"b"===c[3]&&(a-=i),"r"===c[4]&&(o-=l),"c"===c[3]&&(a-=_t(i/2)),"c"===c[4]&&(o-=_t(l/2)),_n(o,a,l,i)},_n=(t,r,n,o)=>({x:t,y:r,w:n,h:o}),_o=(()=>{let t={},r={};return{load:(n,o)=>{let a=`Script at URL "${o}" failed to load`,l=`Script at URL "${o}" did not call \`tinymce.Resource.add('${n}', data)\` within 1 second`;if(void 0!==t[n])return t[n];{let i=new Promise((t,i)=>{let s=((t,r,n=1e3)=>{let o=!1,a=null,l=t=>(...r)=>{o||(o=!0,null!==a&&(clearTimeout(a),a=null),t.apply(null,r))},i=l(t),s=l(r);return{start:(...t)=>{o||null!==a||(a=setTimeout(()=>s.apply(null,t),n))},resolve:i,reject:s}})(t,i);r[n]=s.resolve,aP.ScriptLoader.loadScript(o).then(()=>s.start(l),()=>s.reject(a))});return t[n]=i,i}},add:(n,o)=>{void 0!==r[n]&&(r[n](o),delete r[n]),t[n]=Promise.resolve(o)},unload:r=>{delete t[r]}}})();try{let t="__storage_test__";(n=window.localStorage).setItem(t,t),n.removeItem(t)}catch(t){n=(()=>{let t={},r=[],n={getItem:r=>t[r]||null,setItem:(n,o)=>{r.push(n),t[n]=String(o)},key:t=>r[t],removeItem:n=>{r=r.filter(t=>t===n),delete t[n]},clear:()=>{r=[],t={}},length:0};return Object.defineProperty(n,"length",{get:()=>r.length,configurable:!1,enumerable:!1}),n})()}let _a={geom:{Rect:{inflate:(t,r,n)=>_n(t.x-r,t.y-n,t.w+2*r,t.h+2*n),relativePosition:_r,findBestRelativePosition:(t,r,n,o)=>{for(let a=0;a<o.length;a++){let l=_r(t,r,o[a]);if(l.x>=n.x&&l.x+l.w<=n.w+n.x&&l.y>=n.y&&l.y+l.h<=n.h+n.y)return o[a]}return null},intersect:(t,r)=>{let n=_e(t.x,r.x),o=_e(t.y,r.y),a=S7(t.x+t.w,r.x+r.w),l=S7(t.y+t.h,r.y+r.h);return a-n<0||l-o<0?null:_n(n,o,a-n,l-o)},clamp:(t,r,n)=>{let o=t.x,a=t.y,l=t.x+t.w,i=t.y+t.h,s=r.x+r.w,d=r.y+r.h,c=_e(0,r.x-o),u=_e(0,r.y-a),m=_e(0,l-s),f=_e(0,i-d);return o+=c,a+=u,n&&(l+=c,i+=u,o-=m,a-=f),_n(o,a,(l-=m)-o,(i-=f)-a)},create:_n,fromClientRect:t=>_n(t.left,t.top,t.width,t.height)}},util:{Delay:uA,Tools:tF,VK:cR,URI:hi,EventDispatcher:SN,Observable:SA,I18n:aU,LocalStorage:n,ImageUploader:t=>{let r=bI(t,bP());return{upload:(n,o=!0)=>r.upload(n,o?bM(t):void 0)}}},dom:{EventUtils:ax,TreeWalker:ny,TextSeeker:a4,DOMUtils:aB,ScriptLoader:aP,RangeUtils:c6,Serializer:be,StyleSheetLoader:oK,ControlSelection:cD,BookmarkManager:cC,Selection:h9,Event:ax.Event},html:{Styles:af,Entities:at,Node:u0,Schema:am,DomParser:hC,Writer:mt,Serializer:mr},Env:tB,AddOnManager:az,Annotator:cy,Formatter:bY,UndoManager:bQ,EditorCommands:Sv,WindowManager:b_,NotificationManager:bE,EditorObservable:SP,Shortcuts:SW,Editor:SQ,FocusManager:uR,EditorManager:S9,DOM:aB.DOM,ScriptLoader:aP.ScriptLoader,PluginManager:bk,ThemeManager:bS,ModelManager:bh,IconManager:bp,Resource:_o,FakeClipboard:S4,trim:tF.trim,isArray:tF.isArray,is:tF.is,toArray:tF.toArray,makeMap:tF.makeMap,each:tF.each,map:tF.map,grep:tF.grep,inArray:tF.inArray,extend:tF.extend,walk:tF.walk,resolve:tF.resolve,explode:tF.explode,_addCacheSuffix:tF._addCacheSuffix},_l=tF.extend(S9,_a);window.tinymce=_l,window.tinyMCE=_l,(t=>{if("object"==typeof module)try{module.exports=t}catch(t){}})(_l)}();