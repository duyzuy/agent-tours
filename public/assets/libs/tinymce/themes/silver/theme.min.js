!function(){"use strict";let E=Object.getPrototypeOf,t=(E,T,D)=>{var B;return!!D(E,T.prototype)||(null===(B=E.constructor)||void 0===B?void 0:B.name)===T.name},o=E=>T=>(E=>{let T=typeof E;return null===E?"null":"object"===T&&Array.isArray(E)?"array":"object"===T&&t(E,String,(E,T)=>T.isPrototypeOf(E))?"string":T})(T)===E,n=E=>T=>typeof T===E,s=E=>T=>E===T,T=o("string"),D=o("object"),i=T=>{var B;return B=Object,D(T)&&t(T,B,(T,D)=>E(T)===D)},B=o("array"),M=s(null),er=n("boolean"),ec=s(void 0),m=E=>null==E,g=E=>!m(E),eu=n("function"),eg=n("number"),f=(E,T)=>{if(B(E)){for(let D=0,B=E.length;D<B;++D)if(!T(E[D]))return!1;return!0}return!1},b=()=>{},v=E=>()=>E(),y=(E,T)=>(...D)=>E(T.apply(null,D)),x=E=>()=>E,w=E=>E,S=(E,T)=>E===T;function k(E,...T){return(...D)=>{let B=T.concat(D);return E.apply(null,B)}}let C=E=>T=>!E(T),O=E=>()=>{throw Error(E)},_=E=>E(),ep=x(!1),eh=x(!0);let A=class A{constructor(E,T){this.tag=E,this.value=T}static some(E){return new A(!0,E)}static none(){return A.singletonNone}fold(E,T){return this.tag?T(this.value):E()}isSome(){return this.tag}isNone(){return!this.tag}map(E){return this.tag?A.some(E(this.value)):A.none()}bind(E){return this.tag?E(this.value):A.none()}exists(E){return this.tag&&E(this.value)}forall(E){return!this.tag||E(this.value)}filter(E){return!this.tag||E(this.value)?this:A.none()}getOr(E){return this.tag?this.value:E}or(E){return this.tag?this:E}getOrThunk(E){return this.tag?this.value:E()}orThunk(E){return this.tag?this:E()}getOrDie(E){if(this.tag)return this.value;throw Error(null!=E?E:"Called getOrDie on None")}static from(E){return g(E)?A.some(E):A.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(E){this.tag&&E(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}};A.singletonNone=new A(!1);let ef=Array.prototype.slice,ex=Array.prototype.indexOf,ew=Array.prototype.push,F=(E,T)=>ex.call(E,T),I=(E,T)=>{let D=F(E,T);return -1===D?A.none():A.some(D)},R=(E,T)=>F(E,T)>-1,N=(E,T)=>{for(let D=0,B=E.length;D<B;D++)if(T(E[D],D))return!0;return!1},V=(E,T)=>{let D=[];for(let B=0;B<E;B++)D.push(T(B));return D},z=(E,T)=>{let D=[];for(let B=0;B<E.length;B+=T){let M=ef.call(E,B,B+T);D.push(M)}return D},H=(E,T)=>{let D=E.length,B=Array(D);for(let M=0;M<D;M++){let D=E[M];B[M]=T(D,M)}return B},L=(E,T)=>{for(let D=0,B=E.length;D<B;D++)T(E[D],D)},P=(E,T)=>{let D=[],B=[];for(let M=0,er=E.length;M<er;M++){let er=E[M];(T(er,M)?D:B).push(er)}return{pass:D,fail:B}},U=(E,T)=>{let D=[];for(let B=0,M=E.length;B<M;B++){let M=E[B];T(M,B)&&D.push(M)}return D},W=(E,T,D)=>(((E,T)=>{for(let D=E.length-1;D>=0;D--)T(E[D],D)})(E,(E,B)=>{D=T(D,E,B)}),D),j=(E,T,D)=>(L(E,(E,B)=>{D=T(D,E,B)}),D),G=(E,T)=>((E,T,D)=>{for(let B=0,M=E.length;B<M;B++){let M=E[B];if(T(M,B))return A.some(M);if(D(M,B))break}return A.none()})(E,T,ep),$=(E,T)=>{for(let D=0,B=E.length;D<B;D++)if(T(E[D],D))return A.some(D);return A.none()},q=E=>{let T=[];for(let D=0,M=E.length;D<M;++D){if(!B(E[D]))throw Error("Arr.flatten item "+D+" was not an array, input: "+E);ew.apply(T,E[D])}return T},X=(E,T)=>q(H(E,T)),Y=(E,T)=>{for(let D=0,B=E.length;D<B;++D)if(!0!==T(E[D],D))return!1;return!0},K=E=>{let T=ef.call(E,0);return T.reverse(),T},J=(E,T)=>U(E,E=>!R(T,E)),Z=(E,T)=>{let D={};for(let B=0,M=E.length;B<M;B++){let M=E[B];D[String(M)]=T(M,B)}return D},Q=E=>[E],ee=(E,T)=>{let D=ef.call(E,0);return D.sort(T),D},te=(E,T)=>T>=0&&T<E.length?A.some(E[T]):A.none(),oe=E=>te(E,0),ne=E=>te(E,E.length-1),e_=eu(Array.from)?Array.from:E=>ef.call(E),re=(E,T)=>{for(let D=0;D<E.length;D++){let B=T(E[D],D);if(B.isSome())return B}return A.none()},eD=Object.keys,eH=Object.hasOwnProperty,le=(E,T)=>{let D=eD(E);for(let B=0,M=D.length;B<M;B++){let M=D[B];T(E[M],M)}},ce=(E,T)=>de(E,(E,D)=>({k:D,v:T(E,D)})),de=(E,T)=>{let D={};return le(E,(E,B)=>{let M=T(E,B);D[M.k]=M.v}),D},ue=E=>(T,D)=>{E[D]=T},me=(E,T,D,B)=>{le(E,(E,M)=>{(T(E,M)?D:B)(E,M)})},ge=(E,T)=>{let D={};return me(E,T,ue(D),b),D},pe=(E,T)=>{let D=[];return le(E,(E,B)=>{D.push(T(E,B))}),D},he=(E,T)=>{let D=eD(E);for(let B=0,M=D.length;B<M;B++){let M=D[B],er=E[M];if(T(er,M,E))return A.some(er)}return A.none()},fe=E=>pe(E,w),be=(E,T)=>ve(E,T)?A.from(E[T]):A.none(),ve=(E,T)=>eH.call(E,T),ye=(E,T)=>ve(E,T)&&void 0!==E[T]&&null!==E[T],xe=(E,T,D=S)=>E.exists(E=>D(E,T)),we=E=>{let T=[],o=E=>{T.push(E)};for(let T=0;T<E.length;T++)E[T].each(o);return T},Se=(E,T,D)=>E.isSome()&&T.isSome()?A.some(D(E.getOrDie(),T.getOrDie())):A.none(),ke=(E,T)=>null!=E?A.some(T(E)):A.none(),Ce=(E,T)=>E?A.some(T):A.none(),Oe=(E,T,D)=>""===T||E.length>=T.length&&E.substr(D,D+T.length)===T,_e=(E,T)=>{var D;return Ee(E,T)?(D=T.length,E.substring(D)):E},Te=(E,T,D=0,B)=>{let M=E.indexOf(T,D);return -1!==M&&(!!ec(B)||M+T.length<=B)},Ee=(E,T)=>Oe(E,T,0),Ae=(E,T)=>Oe(E,T,E.length-T.length),eR=(o5=/^\s+|\s+$/g,E=>E.replace(o5,"")),De=E=>E.length>0,Be=E=>void 0!==E.style&&eu(E.style.getPropertyValue),Fe=E=>{if(null==E)throw Error("Node cannot be null or undefined");return{dom:E}},Ie=(E,T)=>{let D=(T||document).createElement("div");if(D.innerHTML=E,!D.hasChildNodes()||D.childNodes.length>1){let T="HTML does not have a single root node";throw console.error(T,E),Error(T)}return Fe(D.childNodes[0])},Re=(E,T)=>{let D=(T||document).createElement(E);return Fe(D)},Ne=(E,T)=>{let D=(T||document).createTextNode(E);return Fe(D)},eN="undefined"!=typeof window?window:Function("return this;")(),He=(E,T)=>((E,T)=>{let D=null!=T?T:eN;for(let T=0;T<E.length&&null!=D;++T)D=D[E[T]];return D})(E.split("."),T),eU=Object.getPrototypeOf,Pe=E=>{let T=He("ownerDocument.defaultView",E);return D(E)&&(((E,T)=>{let D=He(E,T);if(null==D)throw Error(E+" not available on this browser");return D})("HTMLElement",T).prototype.isPrototypeOf(E)||/^HTML\w*Element$/.test(eU(E).constructor.name))},Ue=E=>E.dom.nodeName.toLowerCase(),We=E=>T=>T.dom.nodeType===E,je=E=>eL(E)&&Pe(E.dom),eL=We(1),ez=We(3),eP=We(9),eG=We(11),Ye=E=>T=>eL(T)&&Ue(T)===E,Ke=(E,T)=>{let D=E.dom;if(1!==D.nodeType)return!1;if(void 0!==D.matches)return D.matches(T);if(void 0!==D.msMatchesSelector)return D.msMatchesSelector(T);if(void 0!==D.webkitMatchesSelector)return D.webkitMatchesSelector(T);if(void 0!==D.mozMatchesSelector)return D.mozMatchesSelector(T);throw Error("Browser lacks native selectors")},Je=E=>1!==E.nodeType&&9!==E.nodeType&&11!==E.nodeType||0===E.childElementCount,Ze=(E,T)=>E.dom===T.dom,Qe=(E,T)=>{let D=E.dom,B=T.dom;return D!==B&&D.contains(B)},et=E=>Fe(E.dom.ownerDocument),tt=E=>eP(E)?E:et(E),ot=E=>Fe(tt(E).dom.documentElement),nt=E=>Fe(tt(E).dom.defaultView),st=E=>A.from(E.dom.parentNode).map(Fe),rt=E=>A.from(E.dom.parentElement).map(Fe),at=E=>A.from(E.dom.offsetParent).map(Fe),it=E=>H(E.dom.childNodes,Fe),lt=(E,T)=>{let D=E.dom.childNodes;return A.from(D[T]).map(Fe)},ct=E=>lt(E,0),dt=(E,T)=>({element:E,offset:T}),ut=(E,T)=>{let D=it(E);return D.length>0&&T<D.length?dt(D[T],0):dt(E,T)},mt=E=>eG(E)&&g(E.dom.host),eW=eu(Element.prototype.attachShadow)&&eu(Node.prototype.getRootNode),ej=x(eW),eJ=eW?E=>Fe(E.dom.getRootNode()):tt,ft=E=>mt(E)?E:Fe(tt(E).dom.body),bt=E=>{let T=eJ(E);return mt(T)?A.some(T):A.none()},vt=E=>Fe(E.dom.host),yt=E=>{let T=ez(E)?E.dom.parentNode:E.dom;if(null==T||null===T.ownerDocument)return!1;let D=T.ownerDocument;return bt(Fe(T)).fold(()=>D.body.contains(T),E=>yt(vt(E)))},xt=()=>wt(Fe(document)),wt=E=>{let T=E.dom.body;if(null==T)throw Error("Body is not available yet");return Fe(T)},St=(E,D,B)=>{if(!(T(B)||er(B)||eg(B)))throw console.error("Invalid call to Attribute.set. Key ",D,":: Value ",B,":: Element ",E),Error("Attribute value was not simple");E.setAttribute(D,B+"")},kt=(E,T,D)=>{St(E.dom,T,D)},Ct=(E,T)=>{let D=E.dom;le(T,(E,T)=>{St(D,T,E)})},Ot=(E,T)=>{let D=E.dom.getAttribute(T);return null===D?void 0:D},_t=(E,T)=>A.from(Ot(E,T)),Tt=(E,T)=>{let D=E.dom;return!(!D||!D.hasAttribute)&&D.hasAttribute(T)},Et=(E,T)=>{E.dom.removeAttribute(T)},At=(E,D,B)=>{if(!T(B))throw console.error("Invalid call to CSS.set. Property ",D,":: Value ",B,":: Element ",E),Error("CSS value must be a string: "+B);Be(E)&&E.style.setProperty(D,B)},Mt=(E,T)=>{Be(E)&&E.style.removeProperty(T)},Dt=(E,T,D)=>{let B=E.dom;At(B,T,D)},Bt=(E,T)=>{let D=E.dom;le(T,(E,T)=>{At(D,T,E)})},Ft=(E,T)=>{let D=E.dom;le(T,(E,T)=>{E.fold(()=>{Mt(D,T)},E=>{At(D,T,E)})})},It=(E,T)=>{let D=E.dom,B=window.getComputedStyle(D).getPropertyValue(T);return""!==B||yt(E)?B:Rt(D,T)},Rt=(E,T)=>Be(E)?E.style.getPropertyValue(T):"",Nt=(E,T)=>{let D=E.dom,B=Rt(D,T);return A.from(B).filter(E=>E.length>0)},Vt=E=>{let T={},D=E.dom;if(Be(D))for(let E=0;E<D.style.length;E++){let B=D.style.item(E);T[B]=D.style[B]}return T},zt=(E,T,D)=>{let B=Re(E);return Dt(B,T,D),Nt(B,T).isSome()},Ht=(E,T)=>{let D=E.dom;Mt(D,T),xe(_t(E,"style").map(eR),"")&&Et(E,"style")},Lt=E=>E.dom.offsetWidth,Pt=(E,T)=>{let o=D=>{let B=T(D);if(B<=0||null===B){let T=It(D,E);return parseFloat(T)||0}return B},n=(E,T)=>j(T,(T,D)=>{let B=It(E,D),M=void 0===B?0:parseInt(B,10);return isNaN(M)?T:T+M},0);return{set:(T,D)=>{if(!eg(D)&&!D.match(/^[0-9]+$/))throw Error(E+".set accepts only positive integer values. Value was "+D);let B=T.dom;Be(B)&&(B.style[E]=D+"px")},get:o,getOuter:o,aggregate:n,max:(E,T,D)=>{let B=n(E,D);return T>B?T-B:0}}},e$=Pt("height",E=>{let T=E.dom;return yt(E)?T.getBoundingClientRect().height:T.offsetHeight}),Wt=E=>e$.get(E),jt=E=>e$.getOuter(E),Gt=(E,T)=>({left:E,top:T,translate:(D,B)=>Gt(E+D,T+B)}),qt=(E,T)=>void 0!==E?E:void 0!==T?T:0,Xt=E=>{let T=E.dom.ownerDocument,D=T.body,B=T.defaultView,M=T.documentElement;if(D===E.dom)return Gt(D.offsetLeft,D.offsetTop);let er=qt(null==B?void 0:B.pageYOffset,M.scrollTop),ec=qt(null==B?void 0:B.pageXOffset,M.scrollLeft),eu=qt(M.clientTop,D.clientTop),eg=qt(M.clientLeft,D.clientLeft);return Yt(E).translate(ec-eg,er-eu)},Yt=E=>{let T=E.dom,D=T.ownerDocument.body;return D===T?Gt(D.offsetLeft,D.offsetTop):yt(E)?(E=>{let T=E.getBoundingClientRect();return Gt(T.left,T.top)})(T):Gt(0,0)},eX=Pt("width",E=>E.dom.offsetWidth),Jt=E=>eX.get(E),Zt=E=>eX.getOuter(E),Qt=E=>{let T,D=!1;return(...B)=>(D||(D=!0,T=E.apply(null,B)),T)},eo=()=>to(0,0),to=(E,T)=>({major:E,minor:T}),eq={nu:to,detect:(E,T)=>{let D=String(T).toLowerCase();return 0===E.length?eo():((E,T)=>{let D=((E,T)=>{for(let D=0;D<E.length;D++){let B=E[D];if(B.test(T))return B}})(E,T);if(!D)return{major:0,minor:0};let n=E=>Number(T.replace(D,"$"+E));return to(n(1),n(2))})(E,D)},unknown:eo},no=(E,T)=>{let D=String(T).toLowerCase();return G(E,E=>E.search(D))},eK=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ro=E=>T=>Te(T,E),eY=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:E=>Te(E,"edge/")&&Te(E,"chrome")&&Te(E,"safari")&&Te(E,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,eK],search:E=>Te(E,"chrome")&&!Te(E,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:E=>Te(E,"msie")||Te(E,"trident")},{name:"Opera",versionRegexes:[eK,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ro("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ro("firefox")},{name:"Safari",versionRegexes:[eK,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:E=>(Te(E,"safari")||Te(E,"mobile/"))&&Te(E,"applewebkit")}],eZ=[{name:"Windows",search:ro("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:E=>Te(E,"iphone")||Te(E,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ro("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:ro("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ro("linux"),versionRegexes:[]},{name:"Solaris",search:ro("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ro("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:ro("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],eQ={browsers:x(eY),oses:x(eZ)},e0="Edge",e1="Chromium",e2="Opera",e3="Firefox",e5="Safari",ho=E=>{let T=E.current,D=E.version,n=E=>()=>T===E;return{current:T,version:D,isEdge:n(e0),isChromium:n(e1),isIE:n("IE"),isOpera:n(e2),isFirefox:n(e3),isSafari:n(e5)}},fo=()=>ho({current:void 0,version:eq.unknown()}),e9=(x(e0),x(e1),x("IE"),x(e2),x(e3),x(e5),"Windows"),e4="Android",e6="Linux",e8="macOS",e7="Solaris",tn="FreeBSD",tr="ChromeOS",Oo=E=>{let T=E.current,D=E.version,n=E=>()=>T===E;return{current:T,version:D,isWindows:n(e9),isiOS:n("iOS"),isAndroid:n(e4),isMacOS:n(e8),isLinux:n(e6),isSolaris:n(e7),isFreeBSD:n(tn),isChromeOS:n(tr)}},_o=()=>Oo({current:void 0,version:eq.unknown()}),th=(x(e9),x("iOS"),x(e4),x(e6),x(e8),x(e7),x(tn),x(tr),E=>window.matchMedia(E).matches),tf=Qt(()=>((E,T,D)=>{let B=eQ.browsers(),M=eQ.oses(),er=T.bind(E=>re(E.brands,E=>{let T=E.brand.toLowerCase();return G(B,E=>{var D;return T===(null===(D=E.brand)||void 0===D?void 0:D.toLowerCase())}).map(T=>({current:T.name,version:eq.nu(parseInt(E.version,10),0)}))})).orThunk(()=>no(B,E).map(T=>{let D=eq.detect(T.versionRegexes,E);return{current:T.name,version:D}})).fold(fo,ho),ec=no(M,E).map(T=>{let D=eq.detect(T.versionRegexes,E);return{current:T.name,version:D}}).fold(_o,Oo),eu=((E,T,D,B)=>{let M=E.isiOS()&&!0===/ipad/i.test(D),er=E.isiOS()&&!M,ec=E.isiOS()||E.isAndroid(),eu=ec||B("(pointer:coarse)"),eg=M||!er&&ec&&B("(min-device-width:768px)"),ep=er||ec&&!eg,eh=T.isSafari()&&E.isiOS()&&!1===/safari/i.test(D),ef=!ep&&!eg&&!eh;return{isiPad:x(M),isiPhone:x(er),isTablet:x(eg),isPhone:x(ep),isTouch:x(eu),isAndroid:E.isAndroid,isiOS:E.isiOS,isWebView:x(eh),isDesktop:x(ef)}})(ec,er,E,D);return{browser:er,os:ec,deviceType:eu}})(navigator.userAgent,A.from(navigator.userAgentData),th)),Do=()=>tf(),Bo=E=>{let T=Fe((E=>{if(ej()&&g(E.target)){let T=Fe(E.target);if(eL(T)&&g(T.dom.shadowRoot)&&E.composed&&E.composedPath){let T=E.composedPath();if(T)return oe(T)}}return A.from(E.target)})(E).getOr(E.target)),o=()=>E.stopPropagation(),n=()=>E.preventDefault(),D=y(n,o);return{target:T,x:E.clientX,y:E.clientY,stop:o,prevent:n,kill:D,raw:E}},Fo=(E,T,D,B,M)=>{let r=E=>{D(E)&&B(Bo(E))};return E.dom.addEventListener(T,r,M),{unbind:k(Io,E,T,r,M)}},Io=(E,T,D,B)=>{E.dom.removeEventListener(T,D,B)},Ro=(E,T)=>{st(E).each(D=>{D.dom.insertBefore(T.dom,E.dom)})},No=(E,T)=>{let D=A.from(E.dom.nextSibling).map(Fe);D.fold(()=>{st(E).each(E=>{zo(E,T)})},E=>{Ro(E,T)})},Vo=(E,T)=>{ct(E).fold(()=>{zo(E,T)},D=>{E.dom.insertBefore(T.dom,D.dom)})},zo=(E,T)=>{E.dom.appendChild(T.dom)},Ho=(E,T)=>{L(T,T=>{zo(E,T)})},Lo=E=>{E.dom.textContent="",L(it(E),E=>{Po(E)})},Po=E=>{let T=E.dom;null!==T.parentNode&&T.parentNode.removeChild(T)},Uo=E=>{let T=void 0!==E?E.dom:document,D=T.body.scrollLeft||T.documentElement.scrollLeft,B=T.body.scrollTop||T.documentElement.scrollTop;return Gt(D,B)},Wo=(E,T,D)=>{let B=(void 0!==D?D.dom:document).defaultView;B&&B.scrollTo(E,T)},jo=(E,T,D,B)=>({x:E,y:T,width:D,height:B,right:E+D,bottom:T+B}),Go=E=>{let T=void 0===E?window:E,D=T.document,B=Uo(Fe(D));return(E=>{let T=void 0===E?window:E;return Do().browser.isFirefox()?A.none():A.from(T.visualViewport)})(T).fold(()=>{let E=T.document.documentElement,D=E.clientWidth,M=E.clientHeight;return jo(B.left,B.top,D,M)},E=>jo(Math.max(E.pageLeft,B.left),Math.max(E.pageTop,B.top),E.width,E.height))},$o=()=>Fe(document),qo=(E,T)=>E.view(T).fold(x([]),T=>{let D=E.owner(T),B=qo(E,D);return[T].concat(B)});var tx,ty,tw,tS,tO=Object.freeze({__proto__:null,view:E=>{var T;return(E.dom===document?A.none():A.from(null===(T=E.dom.defaultView)||void 0===T?void 0:T.frameElement)).map(Fe)},owner:E=>et(E)});let Yo=E=>{let T=$o(),D=Uo(T),B=((E,T)=>{let D=T.owner(E),B=qo(T,D);return A.some(B)})(E,tO);return B.fold(k(Xt,E),T=>{let B=Yt(E),M=W(T,(E,T)=>{let D=Yt(T);return{left:E.left+D.left,top:E.top+D.top}},{left:0,top:0});return Gt(M.left+B.left+D.left,M.top+B.top+D.top)})},Ko=(E,T,D,B)=>({x:E,y:T,width:D,height:B,right:E+D,bottom:T+B}),Jo=E=>{let T=Xt(E),D=Zt(E),B=jt(E);return Ko(T.left,T.top,D,B)},Zo=E=>{let T=Yo(E),D=Zt(E),B=jt(E);return Ko(T.left,T.top,D,B)},Qo=(E,T)=>{let D=Math.max(E.x,T.x),B=Math.max(E.y,T.y),M=Math.min(E.right,T.right),er=Math.min(E.bottom,T.bottom);return Ko(D,B,M-D,er-B)},en=()=>Go(window);var t_=tinymce.util.Tools.resolve("tinymce.ThemeManager");let on=E=>{let t=T=>T(E),T=x(E),n=()=>D,D={tag:!0,inner:E,fold:(T,D)=>D(E),isValue:eh,isError:ep,map:T=>tH.value(T(E)),mapError:n,bind:t,exists:t,forall:t,getOr:T,or:n,getOrThunk:T,orThunk:n,getOrDie:T,each:T=>{T(E)},toOptional:()=>A.some(E)};return D},nn=E=>{let t=()=>T,T={tag:!1,inner:E,fold:(T,D)=>T(E),isValue:ep,isError:eh,map:t,mapError:T=>tH.error(T(E)),bind:t,exists:ep,forall:eh,getOr:w,or:w,getOrThunk:_,orThunk:_,getOrDie:O(String(E)),each:b,toOptional:A.none};return T},tH={value:on,error:nn,fromOption:(E,T)=>E.fold(()=>nn(T),on)};(o3=o9||(o9={}))[o3.Error=0]="Error",o3[o3.Value=1]="Value";let an=(E,T,D)=>E.stype===o9.Error?T(E.serror):D(E.svalue),ln=E=>({stype:o9.Value,svalue:E}),cn=E=>({stype:o9.Error,serror:E}),gn=(E,T,D,B)=>({tag:"field",key:E,newKey:T,presence:D,prop:B}),pn=(E,T,D)=>{switch(E.tag){case"field":return T(E.key,E.newKey,E.presence,E.prop);case"custom":return D(E.newKey,E.instantiator)}},hn=E=>(...T)=>{if(0===T.length)throw Error("Can't merge zero objects");let D={};for(let B=0;B<T.length;B++){let M=T[B];for(let T in M)ve(M,T)&&(D[T]=E(D[T],M[T]))}return D},tR=hn((E,T)=>i(E)&&i(T)?tR(E,T):T),tN=hn((E,T)=>T),vn=E=>({tag:"defaultedThunk",process:E}),yn=E=>vn(x(E)),xn=E=>({tag:"mergeWithThunk",process:E}),wn=E=>{var T;let D=(E=>{let T=[],D=[];return L(E,E=>{an(E,E=>D.push(E),E=>T.push(E))}),{values:T,errors:D}})(E);return D.errors.length>0?(T=D.errors,y(cn,q)(T)):ln(D.values)},Sn=E=>D(E)&&eD(E).length>100?" removed due to size":JSON.stringify(E,null,2),kn=(E,T)=>cn([{path:E,getErrorInfo:T}]),Cn=E=>({extract:(T,D)=>{var B,M;return(B=E(D)).stype===o9.Error?(M=B.serror,kn(T,x(M))):B},toString:x("val")}),tU=Cn(ln),_n=(E,T,D,B)=>B(be(E,T).getOrThunk(()=>D(E))),Tn=(E,T,D,B,M)=>{var er;let r=E=>M.extract(T.concat([B]),E),a=E=>E.fold(()=>ln(A.none()),E=>{var D,er;return D=M.extract(T.concat([B]),E),er=A.some,D.stype===o9.Value?{stype:o9.Value,svalue:er(D.svalue)}:D});switch(E.tag){case"required":return be(D,B).fold(()=>kn(T,()=>'Could not find valid *required* value for "'+B+'" in '+Sn(D)),r);case"defaultedThunk":return _n(D,B,E.process,r);case"option":return a(be(D,B));case"defaultedOptionThunk":return er=E.process,a(be(D,B).map(E=>!0===E?er(D):E));case"mergeWithThunk":return _n(D,B,x({}),T=>{let B=tR(E.process(D),T);return r(B)})}},En=E=>({extract:(T,D)=>E().extract(T,D),toString:()=>E().toString()}),An=E=>eD(ge(E,g)),Mn=E=>{let T=Dn(E),D=W(E,(E,T)=>pn(T,T=>tR(E,{[T]:!0}),x(E)),{});return{extract:(E,B)=>{let M=er(B)?[]:An(B),ec=U(M,E=>!ye(D,E));return 0===ec.length?T.extract(E,B):kn(E,()=>"There are unsupported fields: ["+ec.join(", ")+"] specified")},toString:T.toString}},Dn=E=>({extract:(T,D)=>((E,T,D)=>{let B={},M=[];for(let er of D)pn(er,(D,er,ec,eu)=>{let eg=Tn(ec,E,T,D,eu);an(eg,E=>{M.push(...E)},E=>{B[er]=E})},(E,D)=>{B[E]=D(T)});return M.length>0?cn(M):ln(B)})(T,D,E),toString:()=>{let T=H(E,E=>pn(E,(E,T,D,B)=>E+" -> "+B.toString(),(E,T)=>"state("+E+")"));return"obj{\n"+T.join("\n")+"}"}}),Bn=E=>({extract:(T,D)=>{let B=H(D,(D,B)=>E.extract(T.concat(["["+B+"]"]),D));return wn(B)},toString:()=>"array("+E.toString()+")"}),Fn=(E,T)=>{let D=void 0!==T?T:w;return{extract:(T,B)=>{let M=[];for(let er of E){let E=er.extract(T,B);if(E.stype===o9.Value)return{stype:o9.Value,svalue:D(E.svalue)};M.push(E)}return wn(M)},toString:()=>"oneOf("+H(E,E=>E.toString()).join(", ")+")"}},In=(E,T)=>({extract:(D,B)=>{let M=eD(B),er=Bn(Cn(E)).extract(D,M);return er.stype===o9.Value?(E=>{let M=H(E,E=>gn(E,E,{tag:"required",process:{}},T));return Dn(M).extract(D,B)})(er.svalue):er},toString:()=>"setOf("+T.toString()+")"}),tL=y(Bn,Dn),tz=x(tU),Vn=(E,T)=>Cn(D=>{let B=typeof D;return E(D)?ln(D):cn(`Expected type: ${T} but got: ${B}`)}),tP=Vn(eg,"number"),tG=Vn(T,"string"),tW=Vn(er,"boolean"),tj=Vn(eu,"function"),Un=E=>{if(Object(E)!==E)return!0;switch(({}).toString.call(E).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(E).every(T=>Un(E[T]));default:return!1}},tJ=Cn(E=>Un(E)?ln(E):cn("Expected value to be acceptable for sending via postMessage")),jn=(E,T)=>({extract:(D,B)=>be(B,E).fold(()=>kn(D,()=>'Choice schema did not contain choice key: "'+E+'"'),E=>be(T,E).fold(()=>kn(D,()=>'The chosen schema: "'+E+'" did not exist in branches: '+Sn(T)),T=>T.extract(D.concat(["branch: "+E]),B))),toString:()=>"chooseOn("+E+"). Possible values: "+eD(T)}),Gn=E=>Cn(T=>E(T).fold(cn,ln)),$n=(E,T)=>In(T=>E(T).fold(cn,ln),T),qn=(E,T,D)=>{var B;return an((B=T.extract([E],D)).stype===o9.Error?{stype:o9.Error,serror:{input:D,errors:B.serror}}:B,tH.error,tH.value)},Xn=E=>E.fold(E=>{throw Error(Kn(E))},w),Yn=(E,T,D)=>Xn(qn(E,T,D)),Kn=E=>"Errors: \n"+(E=>{let T=E.length>10?E.slice(0,10).concat([{path:[],getErrorInfo:x("... (only showing first ten failures)")}]):E;return H(T,E=>"Failed path: ("+E.path.join(" > ")+")\n"+E.getErrorInfo())})(E.errors).join("\n")+"\n\nInput object: "+Sn(E.input),Jn=(E,T)=>jn(E,ce(T,Dn)),Zn=(E,T)=>((E,T)=>{let D=Qt(T);return{extract:(E,T)=>D().extract(E,T),toString:()=>D().toString()}})(0,T),es=(E,T)=>({tag:"custom",newKey:E,instantiator:T}),ts=E=>Gn(T=>R(E,T)?tH.value(T):tH.error(`Unsupported value: "${T}", choose one of "${E.join(", ")}".`)),os=E=>gn(E,E,{tag:"required",process:{}},tz()),ns=(E,T)=>gn(E,E,{tag:"required",process:{}},T),ss=E=>ns(E,tP),rs=E=>ns(E,tG),as=(E,T)=>gn(E,E,{tag:"required",process:{}},ts(T)),is=E=>ns(E,tj),ls=(E,T)=>gn(E,E,{tag:"required",process:{}},Dn(T)),cs=(E,T)=>gn(E,E,{tag:"required",process:{}},tL(T)),ds=(E,T)=>gn(E,E,{tag:"required",process:{}},Bn(T)),us=E=>gn(E,E,{tag:"option",process:{}},tz()),ms=(E,T)=>gn(E,E,{tag:"option",process:{}},T),gs=E=>ms(E,tP),ps=E=>ms(E,tG),hs=(E,T)=>ms(E,ts(T)),fs=E=>ms(E,tj),bs=(E,T)=>ms(E,Bn(T)),vs=(E,T)=>ms(E,Dn(T)),ys=(E,T)=>gn(E,E,yn(T),tz()),xs=(E,T,D)=>gn(E,E,yn(T),D),ws=(E,T)=>xs(E,T,tP),Ss=(E,T)=>xs(E,T,tG),ks=(E,T,D)=>xs(E,T,ts(D)),Cs=(E,T)=>xs(E,T,tW),Os=(E,T)=>xs(E,T,tj),_s=(E,T,D)=>xs(E,T,Bn(D)),Ts=(E,T,D)=>xs(E,T,Dn(D)),Es=E=>{let T=E;return{get:()=>T,set:E=>{T=E}}},As=E=>{if(!B(E))throw Error("cases must be an array");if(0===E.length)throw Error("there must be at least one case");let T=[],D={};return L(E,(M,er)=>{let ec=eD(M);if(1!==ec.length)throw Error("one and only one name per case");let eu=ec[0],eg=M[eu];if(void 0!==D[eu])throw Error("duplicate key detected:"+eu);if("cata"===eu)throw Error("cannot have a case named cata (sorry)");if(!B(eg))throw Error("case arguments must be an array");T.push(eu),D[eu]=(...D)=>{let B=D.length;if(B!==eg.length)throw Error("Wrong number of arguments to case "+eu+". Expected "+eg.length+" ("+eg+"), got "+B);return{fold:(...T)=>{if(T.length!==E.length)throw Error("Wrong number of arguments to fold. Expected "+E.length+", got "+T.length);return T[er].apply(null,D)},match:E=>{let B=eD(E);if(T.length!==B.length)throw Error("Wrong number of arguments to match. Expected: "+T.join(",")+"\nActual: "+B.join(","));if(!Y(T,E=>R(B,E)))throw Error("Not all branches were specified when using match. Specified: "+B.join(", ")+"\nRequired: "+T.join(", "));return E[eu].apply(null,D)},log:E=>{console.log(E,{constructors:T,constructor:eu,params:D})}}}}),D};As([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);let Ms=(E,T)=>({[E]:T}),Ds=E=>(E=>{let T={};return L(E,E=>{T[E.key]=E.value}),T})(E),Bs=E=>eu(E)?E:ep,Fs=(E,T,D)=>{let B=E.dom,M=Bs(D);for(;B.parentNode;){B=B.parentNode;let E=Fe(B),D=T(E);if(D.isSome())return D;if(M(E))break}return A.none()},Is=(E,T,D)=>{let B=T(E),M=Bs(D);return B.orThunk(()=>M(E)?A.none():Fs(E,T,M))},Rs=(E,T)=>Ze(E.element,T.event.target),t$={can:eh,abort:ep,run:b},Vs=E=>{if(!ye(E,"can")&&!ye(E,"abort")&&!ye(E,"run"))throw Error("EventHandler defined by: "+JSON.stringify(E,null,2)+" does not have can, abort, or run!");return{...t$,...E}},tX=x("touchstart"),tq=x("touchmove"),tK=x("touchend"),tY=x("touchcancel"),tZ=x("mousedown"),tQ=x("mousemove"),t0=x("mouseout"),t1=x("mouseup"),t2=x("mouseover"),t3=x("focusin"),t5=x("focusout"),t9=x("keydown"),t4=x("keyup"),t6=x("input"),t8=x("change"),t7=x("click"),oo=x("transitioncancel"),or=x("transitionend"),oh=x("transitionstart"),of=x("selectstart"),rr=E=>x("alloy."+E),ob={tap:rr("tap")},ox=rr("focus"),oy=rr("blur.post"),ow=rr("paste.post"),ok=rr("receive"),oS=rr("execute"),oO=rr("focus.item"),o_=ob.tap,oB=rr("longpress"),oM=rr("sandbox.close"),oI=rr("typeahead.cancel"),oH=rr("system.init"),oR=rr("system.touchmove"),oN=rr("system.touchend"),oU=rr("system.scroll"),oL=rr("system.resize"),oz=rr("system.attached"),oP=rr("system.detached"),oG=rr("system.dismissRequested"),oW=rr("system.repositionRequested"),oj=rr("focusmanager.shifted"),oJ=rr("slotcontainer.visibility"),o$=rr("system.external.element.scroll"),oX=rr("change.tab"),oq=rr("dismiss.tab"),oK=rr("highlight"),oY=rr("dehighlight"),Fr=(E,T)=>{Vr(E,E.element,T,{})},Ir=(E,T,D)=>{Vr(E,E.element,T,D)},Rr=E=>{Fr(E,oS())},Nr=(E,T,D)=>{Vr(E,T,D,{})},Vr=(E,T,D,B)=>{let M={target:T,...B};E.getSystem().triggerEvent(D,T,M)},zr=(E,T,D,B)=>{E.getSystem().triggerEvent(D,T,B.event)},Hr=E=>Ds(E),Lr=(E,T)=>({key:E,value:Vs({abort:T})}),Pr=E=>({key:E,value:Vs({run:(E,T)=>{T.event.prevent()}})}),Ur=(E,T)=>({key:E,value:Vs({run:T})}),Wr=(E,T,D)=>({key:E,value:Vs({run:(E,B)=>{T.apply(void 0,[E,B].concat(D))}})}),jr=E=>T=>({key:E,value:Vs({run:(E,D)=>{Rs(E,D)&&T(E,D)}})}),Gr=(E,T,D)=>{var B;return B=T.partUids[D],Ur(E,(T,D)=>{T.getSystem().getByUid(B).each(T=>{zr(T,T.element,E,D)})})},$r=(E,T)=>Ur(E,(E,D)=>{let B=D.event,M=E.getSystem().getByDom(B.target).getOrThunk(()=>Is(B.target,T=>E.getSystem().getByDom(T).toOptional(),ep).getOr(E));T(E,M,D)}),qr=E=>Ur(E,(E,T)=>{T.cut()}),Xr=E=>Ur(E,(E,T)=>{T.stop()}),Yr=(E,T)=>jr(E)(T),oZ=jr(oz()),oQ=jr(oP()),o0=jr(oH()),o1=(o4=oS(),E=>Ur(o4,E)),ea=E=>E.dom.innerHTML,ta=(E,T)=>{let D=et(E).dom,B=Fe(D.createDocumentFragment()),M=((E,T)=>{let D=(T||document).createElement("div");return D.innerHTML=E,it(Fe(D))})(T,D);Ho(B,M),Lo(E),zo(E,B)},oa=E=>mt(E)?"#shadow-root":(E=>{let T=Re("div"),D=Fe(E.dom.cloneNode(!0));return zo(T,D),ea(T)})(Fe(E.dom.cloneNode(!1))),na=E=>oa(E),o2=Hr([{key:ox(),value:Vs({can:(E,T)=>{let D=T.event,B=D.originator,M=D.target;return!Ze(B,E.element)||!!Ze(B,M)||(console.warn(ox()+" did not get interpreted by the desired target. \nOriginator: "+na(B)+"\nTarget: "+na(M)+"\nCheck the "+ox()+" event handlers"),!1)}})}]);var o3,o5,o9,o4,o6=Object.freeze({__proto__:null,events:o2});let o8=0,la=E=>{let T=(new Date).getTime();return E+"_"+Math.floor(1e9*Math.random())+ ++o8+String(T)},o7=x("alloy-id-"),nr=x("data-alloy-id"),ni=o7(),nc=nr(),ga=(E,T)=>{Object.defineProperty(E.dom,nc,{value:T,writable:!0})},pa=E=>{let T=eL(E)?E.dom[nc]:null;return A.from(T)},ha=E=>la(E),ba=E=>{let t=T=>`The component must be in a context to execute: ${T}`+(E?"\n"+na(E().element)+" is not in context.":""),o=E=>()=>{throw Error(t(E))},n=E=>()=>{console.warn(t(E))};return{debugInfo:x("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),build:o("build"),buildOrPatch:o("buildOrPatch"),addToWorld:o("addToWorld"),removeFromWorld:o("removeFromWorld"),addToGui:o("addToGui"),removeFromGui:o("removeFromGui"),getByUid:o("getByUid"),getByDom:o("getByDom"),isConnected:ep}},nd=ba(),ya=E=>H(E,E=>Ae(E,"/*")?E.substring(0,E.length-2):E),xa=(E,T)=>{let D=E.toString(),B=D.indexOf(")")+1,M=D.indexOf("("),er=D.substring(M+1,B-1).split(/,\s*/);return E.toFunctionAnnotation=()=>({name:T,parameters:ya(er)}),E},nf=la("alloy-premade"),Sa=E=>(Object.defineProperty(E.element.dom,nf,{value:E.uid,writable:!0}),Ms(nf,E)),ka=E=>be(E,nf),Ca=E=>((E,T)=>{let D=T.toString(),B=D.indexOf(")")+1,M=D.indexOf("("),er=D.substring(M+1,B-1).split(/,\s*/);return E.toFunctionAnnotation=()=>({name:"OVERRIDE",parameters:ya(er.slice(1))}),E})((T,...D)=>E(T.getApis(),T,...D),E),nb={init:()=>_a({readState:x("No State required")})},_a=E=>E,Ta=(E,T)=>{let D={};return le(E,(E,B)=>{le(E,(E,M)=>{let er=be(D,M).getOr([]);D[M]=er.concat([T(B,E)])})}),D},Ea=E=>({classes:ec(E.classes)?[]:E.classes,attributes:ec(E.attributes)?{}:E.attributes,styles:ec(E.styles)?{}:E.styles}),Aa=E=>E.cHandler,Ma=(E,T)=>({name:E,handler:T}),Da=(E,T)=>{let D={};return L(E,E=>{D[E.name()]=E.handlers(T)}),D},Ba=(E,T,D)=>{let B=T[D];return B?((E,T,D,B)=>{try{let M=ee(D,(D,M)=>{let er=D[T],ec=M[T],eu=B.indexOf(er),eg=B.indexOf(ec);if(-1===eu)throw Error("The ordering for "+E+" does not have an entry for "+er+".\nOrder specified: "+JSON.stringify(B,null,2));if(-1===eg)throw Error("The ordering for "+E+" does not have an entry for "+ec+".\nOrder specified: "+JSON.stringify(B,null,2));return eu<eg?-1:eg<eu?1:0});return tH.value(M)}catch(E){return tH.error([E])}})("Event: "+D,"name",E,B).map(E=>{var T;return T=H(E,E=>E.handler),{can:(...E)=>j(T,(T,D)=>T&&(0,D.can).apply(void 0,E),!0),abort:(...E)=>j(T,(T,D)=>T||(0,D.abort).apply(void 0,E),!1),run:(...E)=>{L(T,T=>{T.run.apply(void 0,E)})}}}):tH.error(["The event ("+D+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(H(E,E=>E.name),null,2)])},Fa=(E,T)=>((E,T)=>{var D,B;let M=(E=>{let T=[],D=[];return L(E,E=>{E.fold(E=>{T.push(E)},E=>{D.push(E)})}),{errors:T,values:D}})(E);return M.errors.length>0?(D=M.errors,tH.error(q(D))):0===(B=M.values).length?tH.value(T):tH.value(tR(T,tN.apply(void 0,B)))})(pe(E,(E,D)=>(1===E.length?tH.value(E[0].handler):Ba(E,T,D)).map(B=>{let M=(E=>{let T=eu(E)?{can:eh,abort:ep,run:E}:E;return(E,D,...B)=>{let M=[E,D].concat(B);T.abort.apply(void 0,M)?D.stop():T.can.apply(void 0,M)&&T.run.apply(void 0,M)}})(B),er=E.length>1?U(T[D],T=>N(E,E=>E.name===T)).join(" > "):E[0].name;return Ms(D,{handler:M,purpose:er})})),{}),nx="alloy.base.behaviour",ny=Dn([gn("dom","dom",{tag:"required",process:{}},Dn([os("tag"),ys("styles",{}),ys("classes",[]),ys("attributes",{}),us("value"),us("innerHtml")])),os("components"),os("uid"),ys("events",{}),ys("apis",{}),gn("eventOrder","eventOrder",xn(x({[oS()]:["disabling",nx,"toggling","typeaheadevents"],[ox()]:[nx,"focusing","keying"],[oH()]:[nx,"disabling","toggling","representing"],[t6()]:[nx,"representing","streaming","invalidating"],[oP()]:[nx,"representing","item-events","tooltipping"],[tZ()]:["focusing",nx,"item-type-events"],[tX()]:["focusing",nx,"item-type-events"],[t2()]:["item-type-events","tooltipping"],[ok()]:["receiving","reflecting","tooltipping"]})),tz()),us("domModification")]),Na=E=>E.events,Va=(E,T)=>{let D=Ot(E,T);return void 0===D||""===D?[]:D.split(" ")},za=E=>void 0!==E.dom.classList,Ha=E=>Va(E,"class"),La=(E,T)=>{za(E)?E.dom.classList.add(T):((E,T,D)=>{let B=Va(E,T).concat([D]);kt(E,T,B.join(" "))})(E,"class",T)},Pa=(E,T)=>{za(E)?E.dom.classList.remove(T):((E,T,D)=>{let B=U(Va(E,T),E=>E!==D);B.length>0?kt(E,T,B.join(" ")):Et(E,T)})(E,"class",T),0===(za(E)?E.dom.classList:Ha(E)).length&&Et(E,"class")},Ua=(E,T)=>za(E)&&E.dom.classList.contains(T),Wa=(E,T)=>{L(T,T=>{La(E,T)})},ja=(E,T)=>{L(T,T=>{Pa(E,T)})},Ga=(E,T)=>Y(T,T=>Ua(E,T)),$a=E=>E.dom.value,qa=(E,T)=>{if(void 0===T)throw Error("Value.set was undefined");E.dom.value=T},Xa=(E,T,D)=>{D.fold(()=>zo(E,T),E=>{Ze(E,T)||(Ro(E,T),Po(E))})},Ya=(E,T,D)=>{let B=H(T,D),M=it(E);return L(M.slice(B.length),Po),B},Ka=(E,T,D,B)=>{let M=lt(E,T),er=B(D,M),ec=lt(E,T).map(E=>{if(M.exists(T=>!Ze(T,E))){let T=M.map(Ue).getOr("span"),D=Re(T);return Ro(E,D),D}return E});return Xa(E,er.element,ec),er},Ja=(E,T)=>{let D=eD(E),B=eD(T),M=J(B,D),er=((E,D)=>{let B={},M={};return me(E,(E,D)=>!ve(T,D)||E!==T[D],ue(B),ue(M)),{t:B,f:M}})(E).t;return{toRemove:M,toSet:er}},Za=(E,T)=>{let{class:D,style:B,...M}=j(T.dom.attributes,(E,T)=>(E[T.name]=T.value,E),{}),{toSet:er,toRemove:ec}=Ja(E.attributes,M),eu=Vt(T),{toSet:eg,toRemove:ep}=Ja(E.styles,eu),eh=za(T)?(E=>{let T=E.dom.classList,D=Array(T.length);for(let E=0;E<T.length;E++){let B=T.item(E);null!==B&&(D[E]=B)}return D})(T):Ha(T),ef=J(eh,E.classes),ex=J(E.classes,eh);return L(ec,E=>Et(T,E)),Ct(T,er),Wa(T,ex),ja(T,ef),L(ep,E=>Ht(T,E)),Bt(T,eg),E.innerHtml.fold(()=>{let D=E.domChildren;Ya(T,D,(E,D)=>{let B=lt(T,D);return Xa(T,E,B),E})},E=>{ta(T,E)}),(()=>{let D=E.value.getOrUndefined();D!==$a(T)&&qa(T,null!=D?D:"")})(),T},Qa=E=>{let T=(E=>{let T=be(E,"behaviours").getOr({});return X(eD(T),E=>{let D=T[E];return g(D)?[D.me]:[]})})(E);return((E,T)=>{let D=H(T,E=>vs(E.name(),[os("config"),ys("state",nb)])),B=qn("component.behaviours",Dn(D),E.behaviours).fold(T=>{throw Error(Kn(T)+"\nComplete spec:\n"+JSON.stringify(E,null,2))},w);return{list:T,data:ce(B,E=>{let T=E.map(E=>({config:E.config,state:E.state.init(E.config)}));return x(T)})}})(E,T)},ei=(E,T)=>{let o=()=>ex,D=Es(nd),B=Xn(qn("custom.definition",ny,E)),M=Qa(E),er=M.list,ec=M.data,eg=((E,T,D)=>{let B={...E.dom,uid:E.uid,domChildren:H(E.components,E=>E.element)},M=E.domModification.fold(()=>Ea({}),Ea),er=T.length>0?((E,T,D,B)=>{let M={...T};L(D,T=>{M[T.name()]=T.exhibit(E,B)});let er=Ta(M,(E,T)=>({name:E,modification:T})),a=E=>W(E,(E,T)=>({...T.modification,...E}),{}),ec=W(er.classes,(E,T)=>T.modification.concat(E),[]),eu=a(er.attributes),eg=a(er.styles);return Ea({classes:ec,attributes:eu,styles:eg})})(D,{"alloy.base.modification":M},T,B):M;return{...B,attributes:{...B.attributes,...er.attributes},styles:{...B.styles,...er.styles},classes:B.classes.concat(er.classes)}})(B,er,ec),ep=((E,T)=>{let D=T.filter(T=>Ue(T)===E.tag&&(!E.innerHtml.isSome()||!(E.domChildren.length>0))&&!ve(T.dom,nf)).bind(T=>((E,T)=>{try{let D=Za(E,T);return A.some(D)}catch(E){return A.none()}})(E,T)).getOrThunk(()=>(E=>{let T=Re(E.tag);Ct(T,E.attributes),Wa(T,E.classes),Bt(T,E.styles),E.innerHtml.each(E=>ta(T,E));let D=E.domChildren;return Ho(T,D),E.value.each(E=>{qa(T,E)}),T})(E));return ga(D,E.uid),D})(eg,T),eh=((E,T,D)=>{let B={"alloy.base.behaviour":Na(E)};return((E,T,D,B)=>{let M=((E,T,D)=>{let B={...D,...Da(T,E)};return Ta(B,Ma)})(E,D,B);return Fa(M,T)})(D,E.eventOrder,T,B).getOrDie()})(B,er,ec),ef=Es(B.components),ex={uid:E.uid,getSystem:D.get,config:T=>(eu(ec[T.name()])?ec[T.name()]:()=>{throw Error("Could not find "+T.name()+" in "+JSON.stringify(E,null,2))})(),hasConfigured:E=>eu(ec[E.name()]),spec:E,readState:E=>ec[E]().map(E=>E.state.readState()).getOr("not enabled"),getApis:()=>B.apis,connect:E=>{D.set(E)},disconnect:()=>{D.set(ba(o))},element:ep,syncComponents:()=>{let E=it(ep),T=X(E,E=>D.get().getByDom(E).fold(()=>[],Q));ef.set(T)},components:ef.get,events:eh};return ex},ti=E=>{let T=Ne(E);return oi({element:T})},oi=E=>{let T=Yn("external.component",Mn([os("element"),us("uid")]),E),D=Es(ba()),B=T.uid.getOrThunk(()=>ha("external"));ga(T.element,B);let M={uid:B,getSystem:D.get,config:A.none,hasConfigured:ep,connect:E=>{D.set(E)},disconnect:()=>{D.set(ba(()=>M))},getApis:()=>({}),element:T.element,spec:E,readState:x("No state"),syncComponents:b,components:x([]),events:{}};return Sa(M)},si=(E,T)=>ka(E).getOrThunk(()=>((E,T)=>{let{events:D,...B}=w(E),M=((E,T)=>{let D=be(E,"components").getOr([]);return T.fold(()=>H(D,ri),E=>H(D,(T,D)=>si(T,lt(E,D))))})(B,T),er={...B,events:{...o6,...D},components:M};return tH.value(ei(er,T))})(ve(E,"uid")?E:{uid:ha(""),...E},T).getOrDie()),ri=E=>si(E,A.none());var li=(E,T,D,B,M)=>E(D,B)?A.some(D):eu(M)&&M(D)?A.none():T(D,B,M);let ci=(E,T,D)=>{let B=E.dom,M=eu(D)?D:ep;for(;B.parentNode;){B=B.parentNode;let E=Fe(B);if(T(E))return A.some(E);if(M(E))break}return A.none()},di=(E,T,D)=>li((E,T)=>T(E),ci,E,T,D),ui=(E,T,D)=>di(E,T,D).isSome(),mi=(E,T,D)=>ci(E,E=>Ke(E,T),D),gi=(E,T)=>G(E.dom.childNodes,E=>Ke(Fe(E),T)).map(Fe),pi=(E,T)=>((E,T)=>{let D=void 0===T?document:T.dom;return Je(D)?A.none():A.from(D.querySelector(E)).map(Fe)})(T,E),hi=(E,T,D)=>li((E,T)=>Ke(E,T),mi,E,T,D),nw="aria-controls",bi=()=>{let E=la(nw);return{id:E,link:T=>{kt(T,nw,E)},unlink:E=>{Et(E,nw)}}},vi=(E,T)=>ui(T,T=>Ze(T,E.element),ep)||di(T,E=>{if(!eL(E))return!1;let T=Ot(E,"id");return void 0!==T&&T.indexOf(nw)>-1}).bind(E=>{let T=Ot(E,"id"),D=eJ(E);return pi(D,`[${nw}="${T}"]`)}).exists(T=>vi(E,T));(i1=i9||(i9={}))[i1.STOP=0]="STOP",i1[i1.NORMAL=1]="NORMAL",i1[i1.LOGGING=2]="LOGGING";let nO=Es({}),n_=["alloy/data/Fields","alloy/debugging/Debugging"],Si=(E,T,D)=>((E,T,D)=>{switch(be(nO.get(),E).orThunk(()=>{let T=eD(nO.get());return re(T,T=>E.indexOf(T)>-1?A.some(nO.get()[T]):A.none())}).getOr(i9.NORMAL)){case i9.NORMAL:return D(nF());case i9.LOGGING:{let B=((E,T)=>{let D=[],B=(new Date).getTime();return{logEventCut:(E,T,B)=>{D.push({outcome:"cut",target:T,purpose:B})},logEventStopped:(E,T,B)=>{D.push({outcome:"stopped",target:T,purpose:B})},logNoParent:(E,T,B)=>{D.push({outcome:"no-parent",target:T,purpose:B})},logEventNoHandlers:(E,T)=>{D.push({outcome:"no-handlers-left",target:T})},logEventResponse:(E,T,B)=>{D.push({outcome:"response",purpose:B,target:T})},write:()=>{let M=(new Date).getTime();R(["mousemove","mouseover","mouseout",oH()],E)||console.log(E,{event:E,time:M-B,target:T.dom,sequence:H(D,E=>R(["cut","stopped","response"],E.outcome)?"{"+E.purpose+"} "+E.outcome+" at ("+na(E.target)+")":E.outcome)})}}})(E,T),M=D(B);return B.write(),M}case i9.STOP:return!0}})(E,T,D),nF=x({logEventCut:b,logEventStopped:b,logNoParent:b,logEventNoHandlers:b,logEventResponse:b,write:b}),nB=x([os("menu"),os("selectedMenu")]),nM=x([os("item"),os("selectedItem")]);x(Dn(nM().concat(nB())));let nI=x(Dn(nM())),nH=ls("initSize",[os("numColumns"),os("numRows")]),Ei=()=>ls("markers",[os("backgroundMenu")].concat(nB()).concat(nM())),Ai=E=>ls("markers",H(E,os)),Mi=(E,T,D)=>((()=>{let E=Error();if(void 0!==E.stack){let T=E.stack.split("\n");G(T,E=>E.indexOf("alloy")>0&&!N(n_,T=>E.indexOf(T)>-1)).getOr("unknown")}})(),gn(T,T,D,Gn(E=>tH.value((...T)=>E.apply(void 0,T))))),Di=E=>Mi(0,E,yn(b)),Bi=E=>Mi(0,E,yn(A.none)),Fi=E=>Mi(0,E,{tag:"required",process:{}}),Ii=E=>Mi(0,E,{tag:"required",process:{}}),Ri=(E,T)=>es(E,x(T)),Ni=E=>es(E,w),nR=x(nH),zi=(E,T,D,B,M,er,ec,eu=!1)=>({x:E,y:T,bubble:D,direction:B,placement:M,restriction:er,label:`${ec}-${M}`,alwaysFit:eu}),nN=As([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),nU=nN.southeast,nL=nN.southwest,nz=nN.northeast,nP=nN.northwest,nG=nN.south,nW=nN.north,nj=nN.east,nJ=nN.west,Xi=(E,T,D,B)=>{let M=E+T;return M>B?D:M<D?B:M},Yi=(E,T,D)=>Math.min(Math.max(E,T),D),Ki=(E,T)=>Z(["left","right","top","bottom"],D=>be(T,D).map(T=>((E,T)=>{switch(T){case 1:return E.x;case 0:return E.x+E.width;case 2:return E.y;case 3:return E.y+E.height}})(E,T))),n$="layout",Zi=E=>E.x,Qi=(E,T)=>E.x+E.width/2-T.width/2,el=(E,T)=>E.x+E.width-T.width,tl=(E,T)=>E.y-T.height,ol=E=>E.y+E.height,nl=(E,T)=>E.y+E.height/2-T.height/2,sl=(E,T,D)=>zi(Zi(E),ol(E),D.southeast(),nU(),"southeast",Ki(E,{left:1,top:3}),n$),rl=(E,T,D)=>zi(el(E,T),ol(E),D.southwest(),nL(),"southwest",Ki(E,{right:0,top:3}),n$),al=(E,T,D)=>zi(Zi(E),tl(E,T),D.northeast(),nz(),"northeast",Ki(E,{left:1,bottom:2}),n$),il=(E,T,D)=>zi(el(E,T),tl(E,T),D.northwest(),nP(),"northwest",Ki(E,{right:0,bottom:2}),n$),ll=(E,T,D)=>zi(Qi(E,T),tl(E,T),D.north(),nW(),"north",Ki(E,{bottom:2}),n$),cl=(E,T,D)=>zi(Qi(E,T),ol(E),D.south(),nG(),"south",Ki(E,{top:3}),n$),dl=(E,T,D)=>zi(E.x+E.width,nl(E,T),D.east(),nj(),"east",Ki(E,{left:0}),n$),ul=(E,T,D)=>zi(E.x-T.width,nl(E,T),D.west(),nJ(),"west",Ki(E,{right:1}),n$),ml=()=>[sl,rl,al,il,cl,ll,dl,ul],gl=()=>[rl,sl,il,al,cl,ll,dl,ul],pl=()=>[al,il,sl,rl,ll,cl],hl=()=>[il,al,rl,sl,ll,cl],fl=()=>[sl,rl,al,il,cl,ll],bl=()=>[rl,sl,il,al,cl,ll];var nX=Object.freeze({__proto__:null,events:E=>Hr([Ur(ok(),(T,D)=>{let B=E.channels,M=eD(B),er=D.universal?M:U(M,E=>R(D.channels,E));L(er,E=>{let M=B[E],er=M.schema,ec=Yn("channel["+E+"] data\nReceiver: "+na(T.element),er,D.data);M.onReceive(T,ec)})})])}),nq=[ns("channels",$n(tH.value,Mn([Fi("onReceive"),ys("schema",tz())])))];let xl=(E,T,D)=>o0((B,M)=>{D(B,E,T)}),wl=E=>({key:E,value:void 0}),Sl=(E,T,D,B,M,er,ec)=>{let i=E=>ye(E,D)?E[D]():A.none(),eu=ce(M,(E,T)=>((E,T,D)=>{let B=D.toString(),M=B.indexOf(")")+1,er=B.indexOf("("),ec=B.substring(er+1,M-1).split(/,\s*/);return E.toFunctionAnnotation=()=>({name:T,parameters:ya(ec.slice(0,1).concat(ec.slice(3)))}),E})((B,...M)=>{let er=[B].concat(M);return B.config({name:x(D)}).fold(()=>{throw Error("We could not find any behaviour configuration for: "+D+". Using API: "+T)},T=>{let D=Array.prototype.slice.call(er,1);return E.apply(void 0,[B,T.config,T.state].concat(D))})},T,E)),eg={...ce(er,(E,T)=>xa(E,T)),...eu,revoke:k(wl,D),config:T=>{let B=Yn(D+"-config",E,T);return{key:D,value:{config:B,me:eg,configAsRaw:Qt(()=>Yn(D+"-config",E,T)),initialConfig:T,state:ec}}},schema:x(T),exhibit:(E,T)=>Se(i(E),be(B,"exhibit"),(E,D)=>D(T,E.config,E.state)).getOrThunk(()=>Ea({})),name:x(D),handlers:E=>i(E).map(E=>be(B,"events").getOr(()=>({}))(E.config,E.state)).getOr({})};return eg},kl=E=>Ds(E),nK=Mn([os("fields"),os("name"),ys("active",{}),ys("apis",{}),ys("state",nb),ys("extra",{})]),Ol=E=>{let T=Yn("Creating behaviour: "+E.name,nK,E);return((E,T,D,B,M,er)=>{let ec=Mn(E),eu=vs(T,[ms("config",Mn(E))]);return Sl(ec,eu,T,D,B,M,er)})(T.fields,T.name,T.active,T.apis,T.extra,T.state)},nY=Mn([os("branchKey"),os("branches"),os("name"),ys("active",{}),ys("apis",{}),ys("state",nb),ys("extra",{})]),Tl=E=>{let T=Yn("Creating behaviour: "+E.name,nY,E);return((E,T,D,B,M,er)=>{let ec=vs(T,[ms("config",E)]);return Sl(E,ec,T,D,B,M,er)})(Jn(T.branchKey,T.branches),T.name,T.active,T.apis,T.extra,T.state)},nZ=x(void 0),nQ=Ol({fields:nq,name:"receiving",active:nX});var n0=Object.freeze({__proto__:null,exhibit:(E,T)=>Ea({classes:[],styles:T.useFixed()?{}:{position:"relative"}})});let Dl=E=>E.dom.focus(),Bl=E=>E.dom.blur(),Fl=E=>{let T=eJ(E).dom;return E.dom===T.activeElement},Il=(E=$o())=>A.from(E.dom.activeElement).map(Fe),Rl=E=>Il(eJ(E)).filter(T=>E.dom.contains(T.dom)),Nl=(E,T)=>{let D=eJ(T),B=Il(D).bind(E=>{let o=T=>Ze(E,T);return o(T)?A.some(T):((E,T)=>{let o=E=>{for(let D=0;D<E.childNodes.length;D++){let B=Fe(E.childNodes[D]);if(T(B))return A.some(B);let M=o(E.childNodes[D]);if(M.isSome())return M}return A.none()};return o(E.dom)})(T,o)}),M=E(T);return B.each(E=>{Il(D).filter(T=>Ze(T,E)).fold(()=>{Dl(E)},b)}),M},Vl=(E,T,D,B,M)=>{let r=E=>E+"px";return{position:E,left:T.map(r),top:D.map(r),right:B.map(r),bottom:M.map(r)}},zl=(E,T)=>{Ft(E,{...T,position:A.some(T.position)})},n1=As([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),Ll=(E,T,D,B,M,er)=>{let ec=T.rect,eu=ec.x-D,eg=ec.y-B,ep=M-(eu+ec.width),eh=er-(eg+ec.height),ef=A.some(eu),ex=A.some(eg),ew=A.some(ep),e_=A.some(eh),eD=A.none();return T.direction.fold(()=>Vl(E,ef,ex,eD,eD),()=>Vl(E,eD,ex,ew,eD),()=>Vl(E,ef,eD,eD,e_),()=>Vl(E,eD,eD,ew,e_),()=>Vl(E,ef,ex,eD,eD),()=>Vl(E,ef,eD,eD,e_),()=>Vl(E,ef,ex,eD,eD),()=>Vl(E,eD,ex,ew,eD))},Pl=(E,T)=>E.fold(()=>{let E=T.rect;return Vl("absolute",A.some(E.x),A.some(E.y),A.none(),A.none())},(E,D,B,M)=>Ll("absolute",T,E,D,B,M),(E,D,B,M)=>Ll("fixed",T,E,D,B,M)),Ul=(E,T)=>{let D=k(Yo,T),B=E.fold(D,D,()=>{let E=Uo();return Yo(T).translate(-E.left,-E.top)}),M=Zt(T),er=jt(T);return Ko(B.left,B.top,M,er)},Wl=(E,T)=>T.fold(()=>E.fold(en,en,Ko),T=>E.fold(x(T),x(T),()=>{let D=jl(E,T.x,T.y);return Ko(D.left,D.top,T.width,T.height)})),jl=(E,T,D)=>{let B=Gt(T,D);return E.fold(x(B),x(B),()=>{let E=Uo();return B.translate(-E.left,-E.top)})};n1.none;let n2=n1.relative,n3=n1.fixed,n5="data-alloy-placement",Xl=E=>_t(E,n5),n9=As([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),Kl=(E,T,D,B)=>{let M=E.bubble,er=M.offset,ec=((E,T,D)=>{let n=(B,M)=>T[B].map(T=>{let er="top"===B||"bottom"===B,ec=er?D.top:D.left,eu=("left"===B||"top"===B?Math.max:Math.min)(T,M)+ec;return er?Yi(eu,E.y,E.bottom):Yi(eu,E.x,E.right)}).getOr(M),B=n("left",E.x),M=n("top",E.y),er=n("right",E.right),ec=n("bottom",E.bottom);return Ko(B,M,er-B,ec-M)})(B,E.restriction,er),eu=E.x+er.left,eg=E.y+er.top,ep=Ko(eu,eg,T,D),{originInBounds:eh,sizeInBounds:ef,visibleW:ex,visibleH:ew}=((E,T)=>{let{x:D,y:B,right:M,bottom:er}=T,{x:ec,y:eu,right:eg,bottom:ep,width:eh,height:ef}=E;return{originInBounds:ec>=D&&ec<=M&&eu>=B&&eu<=er,sizeInBounds:eg<=M&&eg>=D&&ep<=er&&ep>=B,visibleW:Math.min(eh,ec>=D?M-ec:eg-D),visibleH:Math.min(ef,eu>=B?er-eu:ep-B)}})(ep,ec),e_=eh&&ef,eD=e_?ep:((E,T)=>{let{x:D,y:B,right:M,bottom:er}=T,{x:ec,y:eu,width:eg,height:ep}=E,eh=Math.max(D,M-eg),ef=Math.max(B,er-ep),ex=Yi(ec,D,eh),ew=Yi(eu,B,ef),e_=Math.min(ex+eg,M)-ex,eD=Math.min(ew+ep,er)-ew;return Ko(ex,ew,e_,eD)})(ep,ec),eH=eD.width>0&&eD.height>0,{maxWidth:eR,maxHeight:eN}=((E,T,D)=>{let B=x(T.bottom-D.y),M=x(D.bottom-T.y),er=E.fold(M,M,B,B,M,B,M,M),ec=x(T.right-D.x),eu=x(D.right-T.x),eg=E.fold(eu,ec,eu,ec,eu,eu,eu,ec);return{maxWidth:eg,maxHeight:er}})(E.direction,eD,B),eU={rect:eD,maxHeight:eN,maxWidth:eR,direction:E.direction,placement:E.placement,classes:{on:M.classesOn,off:M.classesOff},layout:E.label,testY:eg};return e_||E.alwaysFit?n9.fit(eU):n9.nofit(eU,ex,ew,eH)},Jl=E=>{let T=Es(A.none()),o=()=>T.get().each(E);return{clear:()=>{o(),T.set(A.none())},isSet:()=>T.get().isSome(),get:()=>T.get(),set:E=>{o(),T.set(A.some(E))}}},Zl=()=>Jl(E=>E.unbind()),Ql=()=>{let E=Jl(b);return{...E,on:T=>E.get().each(T)}},tc=(E,T,D)=>Fo(E,T,eh,D,!1),oc=(E,T,D)=>Fo(E,T,eh,D,!0),n4=["top","bottom","right","left"],n6="data-alloy-transition-timer",ac=(E,D,B,M,er,ec)=>{let eu=ec.exists(E=>{let T=M.mode;return"all"===T||E[T]!==er[T]});if(eu||Ga(E,M.classes)){Dt(E,"position",B.position);let ec=Ul(D,E),eg=Pl(D,{...er,rect:ec}),ep=Z(n4,E=>eg[E]);((E,T)=>{let o=E=>parseFloat(E).toFixed(3);return he(T,(T,D)=>!((E,T,D=S)=>Se(E,T,D).getOr(E.isNone()&&T.isNone()))(E[D].map(o),T.map(o))).isSome()})(B,ep)&&(Ft(E,ep),eu&&(Wa(E,M.classes),_t(E,n6).each(T=>{clearTimeout(parseInt(T,10)),Et(E,n6)}),((E,D)=>{let B;let M=Zl(),er=Zl(),a=T=>{var D;let B=null!==(D=T.raw.pseudoElement)&&void 0!==D?D:"";return Ze(T.target,E)&&!De(B)&&R(n4,T.raw.propertyName)},i=T=>{if(m(T)||a(T)){M.clear(),er.clear();let ec=null==T?void 0:T.raw.type;(m(ec)||ec===or())&&(clearTimeout(B),Et(E,n6),ja(E,D.classes))}},ec=tc(E,oh(),T=>{a(T)&&(ec.unbind(),M.set(tc(E,or(),i)),er.set(tc(E,oo(),i)))}),eu=(E=>{let t=T=>{let D=It(E,T).split(/\s*,\s*/);return U(D,De)},o=E=>{if(T(E)&&/^[\d.]+/.test(E)){let T=parseFloat(E);return Ae(E,"ms")?T:1e3*T}return 0},D=t("transition-delay"),B=t("transition-duration");return j(B,(E,T,B)=>{let M=o(D[B])+o(T);return Math.max(E,M)},0)})(E);requestAnimationFrame(()=>{kt(E,n6,B=setTimeout(i,eu+17))})})(E,M)),Lt(E))}else ja(E,M.classes)},ic=(E,T)=>{((E,T)=>{let D=e$.max(E,T,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);Dt(E,"max-height",D+"px")})(E,Math.floor(T))},n8=x((E,T)=>{ic(E,T),Bt(E,{"overflow-x":"hidden","overflow-y":"auto"})}),n7=x((E,T)=>{ic(E,T)}),dc=(E,T,D)=>void 0===E[T]?D:E[T],uc=(E,T,D,B)=>{let M=((E,T,D,B)=>{Ht(T,"max-height"),Ht(T,"max-width");let M={width:Zt(T),height:jt(T)};return((E,T,D,B,M,er)=>{let ec=B.width,eu=B.height,l=(T,eg,ep,eh,ef)=>{let ex=T(D,B,M,E,er),ew=Kl(ex,ec,eu,er);return ew.fold(x(ew),(E,T,D,B)=>(ef===B?D>eh||T>ep:!ef&&B)?ew:n9.nofit(eg,ep,eh,ef))};return j(T,(E,T)=>{let D=k(l,T);return E.fold(x(E),D)},n9.nofit({rect:D,maxHeight:B.height,maxWidth:B.width,direction:nU(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:D.y},-1,-1,!1)).fold(w,w)})(T,B.preference,E,M,D,B.bounds)})(E,T,D,B);return((E,T,D)=>{let B=Pl(D.origin,T);D.transition.each(M=>{ac(E,D.origin,B,M,T,D.lastPlacement)}),zl(E,B)})(T,M,B),kt(T,n5,M.placement),((E,T)=>{let D=T.classes;ja(E,D.off),Wa(E,D.on)})(T,M),((E,T,D)=>{(0,D.maxHeightFunction)(E,T.maxHeight)})(T,M,B),((E,T,D)=>{(0,D.maxWidthFunction)(E,T.maxWidth)})(T,M,B),{layout:M.layout,placement:M.placement}},rn=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],gc=(E,T,D,B=1)=>{let M=E*B,er=T*B,a=E=>be(D,E).getOr([]),i=(E,T,D)=>{let B=J(rn,D);return{offset:Gt(E,T),classesOn:X(D,a),classesOff:X(B,a)}};return{southeast:()=>i(-E,T,["top","alignLeft"]),southwest:()=>i(E,T,["top","alignRight"]),south:()=>i(-E/2,T,["top","alignCentre"]),northeast:()=>i(-E,-T,["bottom","alignLeft"]),northwest:()=>i(E,-T,["bottom","alignRight"]),north:()=>i(-E/2,-T,["bottom","alignCentre"]),east:()=>i(E,-T/2,["valignCentre","left"]),west:()=>i(-E,-T/2,["valignCentre","right"]),insetNortheast:()=>i(M,er,["top","alignLeft","inset"]),insetNorthwest:()=>i(-M,er,["top","alignRight","inset"]),insetNorth:()=>i(-M/2,er,["top","alignCentre","inset"]),insetSoutheast:()=>i(M,-er,["bottom","alignLeft","inset"]),insetSouthwest:()=>i(-M,-er,["bottom","alignRight","inset"]),insetSouth:()=>i(-M/2,-er,["bottom","alignCentre","inset"]),insetEast:()=>i(-M,-er/2,["valignCentre","right","inset"]),insetWest:()=>i(M,-er/2,["valignCentre","left","inset"])}},pc=()=>gc(0,0,{}),fc=(E,T)=>D=>"rtl"===bc(D)?T:E,bc=E=>"rtl"===It(E,"direction")?"rtl":"ltr";(i2=i4||(i4={})).TopToBottom="toptobottom",i2.BottomToTop="bottomtotop";let ra="data-alloy-vertical-dir",xc=E=>ui(E,E=>eL(E)&&Ot(E,"data-alloy-vertical-dir")===i4.BottomToTop),wc=()=>vs("layouts",[os("onLtr"),os("onRtl"),us("onBottomLtr"),us("onBottomRtl")]),Sc=(E,T,D,B,M,er,ec)=>{let eu=ec.map(xc).getOr(!1),eg=T.layouts.map(T=>T.onLtr(E)),ep=T.layouts.map(T=>T.onRtl(E)),eh=eu?T.layouts.bind(T=>T.onBottomLtr.map(T=>T(E))).or(eg).getOr(M):eg.getOr(D),ef=eu?T.layouts.bind(T=>T.onBottomRtl.map(T=>T(E))).or(ep).getOr(er):ep.getOr(B);return fc(eh,ef)(E)};var rc=[os("hotspot"),us("bubble"),ys("overrides",{}),wc(),Ri("placement",(E,T,D)=>{let B=T.hotspot,M=Ul(D,B.element),er=Sc(E.element,T,fl(),bl(),pl(),hl(),A.some(T.hotspot.element));return A.some(w({anchorBox:M,bubble:T.bubble.getOr(pc()),overrides:T.overrides,layouts:er}))})],ru=[os("x"),os("y"),ys("height",0),ys("width",0),ys("bubble",pc()),ys("overrides",{}),wc(),Ri("placement",(E,T,D)=>{let B=jl(D,T.x,T.y),M=Ko(B.left,B.top,T.width,T.height),er=Sc(E.element,T,ml(),gl(),ml(),gl(),A.none());return A.some(w({anchorBox:M,bubble:T.bubble,overrides:T.overrides,layouts:er}))})];let rf=As([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),_c=E=>E.fold(w,(E,T,D)=>E.translate(-T,-D)),Tc=E=>E.fold(w,w),Ec=E=>j(E,(E,T)=>E.translate(T.left,T.top),Gt(0,0)),Ac=E=>{let T=H(E,Tc);return Ec(T)},rb=rf.screen,rx=rf.absolute,Bc=(E,T,D)=>{let B=et(E.element),M=Uo(B),er=((E,T,D)=>{let B=nt(D.root).dom;return A.from(B.frameElement).map(Fe).filter(T=>{let D=et(T),B=et(E.element);return Ze(D,B)}).map(Xt)})(E,0,D).getOr(M);return rx(er,M.left,M.top)},Fc=(E,T,D,B)=>{let M=rb(Gt(E,T));return A.some({point:M,width:D,height:B})},Ic=(E,T,D,B,M)=>E.map(E=>{var er;let ec=[T,E.point],eu=B.fold(()=>Ac(ec),()=>Ac(ec),()=>(E=>{let T=H(E,_c);return Ec(T)})(ec)),eg=(er=eu.left,{x:er,y:eu.top,width:E.width,height:E.height}),ep=D.showAbove?pl():fl(),eh=D.showAbove?hl():bl(),ef=Sc(M,D,ep,eh,ep,eh,A.none());return w({anchorBox:eg,bubble:D.bubble.getOr(pc()),overrides:D.overrides,layouts:ef})});var ry=[os("node"),os("root"),us("bubble"),wc(),ys("overrides",{}),ys("showAbove",!1),Ri("placement",(E,T,D)=>{let B=Bc(E,0,T);return T.node.filter(yt).bind(M=>{let er=M.dom.getBoundingClientRect(),ec=Fc(er.left,er.top,er.width,er.height),eu=T.node.getOr(E.element);return Ic(ec,B,T,D,eu)})})];let Nc=(E,T,D,B)=>({start:E,soffset:T,finish:D,foffset:B}),rk=As([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),rO=(rk.before,rk.on,rk.after,E=>E.fold(w,w,w)),r_=As([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),rF={domRange:r_.domRange,relative:r_.relative,exact:r_.exact,exactFromRange:E=>r_.exact(E.start,E.soffset,E.finish,E.foffset),getWin:E=>{let T=E.match({domRange:E=>Fe(E.startContainer),relative:(E,T)=>rO(E),exact:(E,T,D,B)=>E});return nt(T)},range:Nc},Pc=(E,T,D)=>{let B=E.document.createRange();return T.fold(E=>{B.setStartBefore(E.dom)},(E,T)=>{B.setStart(E.dom,T)},E=>{B.setStartAfter(E.dom)}),((E,T)=>{T.fold(T=>{E.setEndBefore(T.dom)},(T,D)=>{E.setEnd(T.dom,D)},T=>{E.setEndAfter(T.dom)})})(B,D),B},Uc=(E,T,D,B,M)=>{let er=E.document.createRange();return er.setStart(T.dom,D),er.setEnd(B.dom,M),er},Wc=E=>({left:E.left,top:E.top,right:E.right,bottom:E.bottom,width:E.width,height:E.height}),rB=As([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Gc=(E,T,D)=>T(Fe(D.startContainer),D.startOffset,Fe(D.endContainer),D.endOffset),$c=(E,T)=>((E,T)=>{let D=T.match({domRange:E=>({ltr:x(E),rtl:A.none}),relative:(T,D)=>({ltr:Qt(()=>Pc(E,T,D)),rtl:Qt(()=>A.some(Pc(E,D,T)))}),exact:(T,D,B,M)=>({ltr:Qt(()=>Uc(E,T,D,B,M)),rtl:Qt(()=>A.some(Uc(E,B,M,T,D)))})});return((E,T)=>{let D=T.ltr();return D.collapsed?T.rtl().filter(E=>!1===E.collapsed).map(E=>rB.rtl(Fe(E.endContainer),E.endOffset,Fe(E.startContainer),E.startOffset)).getOrThunk(()=>Gc(0,rB.ltr,D)):Gc(0,rB.ltr,D)})(0,D)})(E,T).match({ltr:(T,D,B,M)=>{let er=E.document.createRange();return er.setStart(T.dom,D),er.setEnd(B.dom,M),er},rtl:(T,D,B,M)=>{let er=E.document.createRange();return er.setStart(B.dom,M),er.setEnd(T.dom,D),er}});rB.ltr,rB.rtl;let qc=(E,T,D)=>U(((E,T)=>{let D=eu(T)?T:ep,B=E.dom,M=[];for(;null!==B.parentNode&&void 0!==B.parentNode;){let E=B.parentNode,T=Fe(E);if(M.push(T),!0===D(T))break;B=E}return M})(E,D),T),Xc=(E,T)=>((E,T)=>{let D=void 0===T?document:T.dom;return Je(D)?[]:H(D.querySelectorAll(E),Fe)})(T,E),Yc=E=>{if(E.rangeCount>0){let T=E.getRangeAt(0),D=E.getRangeAt(E.rangeCount-1);return A.some(Nc(Fe(T.startContainer),T.startOffset,Fe(D.endContainer),D.endOffset))}return A.none()},Kc=E=>{if(null===E.anchorNode||null===E.focusNode)return Yc(E);{let T=Fe(E.anchorNode),D=Fe(E.focusNode);return((E,T,D,B)=>{let M=((E,T,D,B)=>{let M=et(E).dom.createRange();return M.setStart(E.dom,T),M.setEnd(D.dom,B),M})(E,T,D,B),er=Ze(E,D)&&T===B;return M.collapsed&&!er})(T,E.anchorOffset,D,E.focusOffset)?A.some(Nc(T,E.anchorOffset,D,E.focusOffset)):Yc(E)}},Jc=(E,T)=>(E=>{let T=E.getClientRects(),D=T.length>0?T[0]:E.getBoundingClientRect();return D.width>0||D.height>0?A.some(D).map(Wc):A.none()})($c(E,T)),rM=((E,T)=>{let o=T=>E(T)?A.from(T.dom.nodeValue):A.none();return{get:T=>{if(!E(T))throw Error("Can only get text value of a text node");return o(T).getOr("")},getOption:o,set:(T,D)=>{if(!E(T))throw Error("Can only set raw text value of a text node");T.dom.nodeValue=D}}})(ez),Qc=(E,T)=>({element:E,offset:T}),ed=(E,T)=>ez(E)?Qc(E,T):((E,T)=>{let D=it(E);if(0===D.length)return Qc(E,T);if(T<D.length)return Qc(D[T],0);{let E=D[D.length-1],T=ez(E)?rM.get(E).length:it(E).length;return Qc(E,T)}})(E,T),td=E=>void 0!==E.foffset,od=(E,T)=>T.getSelection.getOrThunk(()=>()=>A.from(E.getSelection()).filter(E=>E.rangeCount>0).bind(Kc))().map(E=>{if(td(E)){let T=ed(E.start,E.soffset),D=ed(E.finish,E.foffset);return rF.range(T.element,T.offset,D.element,D.offset)}return E});var rH=[us("getSelection"),os("root"),us("bubble"),wc(),ys("overrides",{}),ys("showAbove",!1),Ri("placement",(E,T,D)=>{let B=nt(T.root).dom,M=Bc(E,0,T),er=od(B,T).bind(E=>{if(td(E)){let T=(E=>{let T=E.getBoundingClientRect();return T.width>0||T.height>0?A.some(T).map(Wc):A.none()})($c(B,rF.exactFromRange(E))).orThunk(()=>{let T=Ne("\uFEFF");Ro(E.start,T);let D=Jc(B,rF.exact(T,0,T,1));return Po(T),D});return T.bind(E=>Fc(E.left,E.top,E.width,E.height))}{let T=ce(E,E=>E.dom.getBoundingClientRect()),D={left:Math.min(T.firstCell.left,T.lastCell.left),right:Math.max(T.firstCell.right,T.lastCell.right),top:Math.min(T.firstCell.top,T.lastCell.top),bottom:Math.max(T.firstCell.bottom,T.lastCell.bottom)};return Fc(D.left,D.top,D.right-D.left,D.bottom-D.top)}}),ec=od(B,T).bind(E=>td(E)?eL(E.start)?A.some(E.start):rt(E.start):A.some(E.firstCell)).getOr(E.element);return Ic(er,M,T,D,ec)})];let rR="link-layout",rd=E=>E.x+E.width,ad=(E,T)=>E.x-T.width,id=(E,T)=>E.y-T.height+E.height,ld=E=>E.y,cd=(E,T,D)=>zi(rd(E),ld(E),D.southeast(),nU(),"southeast",Ki(E,{left:0,top:2}),rR),dd=(E,T,D)=>zi(ad(E,T),ld(E),D.southwest(),nL(),"southwest",Ki(E,{right:1,top:2}),rR),ud=(E,T,D)=>zi(rd(E),id(E,T),D.northeast(),nz(),"northeast",Ki(E,{left:0,bottom:3}),rR),md=(E,T,D)=>zi(ad(E,T),id(E,T),D.northwest(),nP(),"northwest",Ki(E,{right:1,bottom:3}),rR),gd=()=>[cd,dd,ud,md],pd=()=>[dd,cd,md,ud];var rU=Jn("type",{selection:rH,node:ry,hotspot:rc,submenu:[os("item"),wc(),ys("overrides",{}),Ri("placement",(E,T,D)=>{let B=Ul(D,T.item.element),M=Sc(E.element,T,gd(),pd(),gd(),pd(),A.none());return A.some(w({anchorBox:B,bubble:pc(),overrides:T.overrides,layouts:M}))})],makeshift:ru});let rL=[ds("classes",tG),ks("mode","all",["all","layout","placement"])],rz=[ys("useFixed",ep),us("getBounds")],rP=[ns("anchor",rU),vs("transition",rL)],xd=(E,T,D,B,M,er)=>{let ec=Yn("placement.info",Dn(rP),M),eu=ec.anchor,eg=B.element,ep=D.get(B.uid);Nl(()=>{Dt(eg,"position","fixed");let M=Nt(eg,"visibility");Dt(eg,"visibility","hidden");let eh=T.useFixed()?(()=>{let E=document.documentElement;return n3(0,0,E.clientWidth,E.clientHeight)})():(E=>{let T=Xt(E.element),D=E.element.dom.getBoundingClientRect();return n2(T.left,T.top,D.width,D.height)})(E);eu.placement(E,eu,eh).each(E=>{var M,eu;let eg=er.orThunk(()=>T.getBounds.map(_)),ef=(M=ec.transition,((E,T,D,B,M,er,ec,eu)=>{let eg=dc(ec,"maxHeightFunction",n8()),ep=dc(ec,"maxWidthFunction",b),eh=E.anchorBox,ef=E.origin,ex={bounds:Wl(ef,er),origin:ef,preference:B,maxHeightFunction:eg,maxWidthFunction:ep,lastPlacement:M,transition:eu};return uc(eh,T,D,ex)})({anchorBox:E.anchorBox,origin:eh},B.element,E.bubble,E.layouts,ep,eg,E.overrides,M));D.set(B.uid,ef)}),M.fold(()=>{Ht(eg,"visibility")},E=>{Dt(eg,"visibility",E)}),Nt(eg,"left").isNone()&&Nt(eg,"top").isNone()&&Nt(eg,"right").isNone()&&Nt(eg,"bottom").isNone()&&xe(Nt(eg,"position"),"fixed")&&Ht(eg,"position")},eg)};var rG=Object.freeze({__proto__:null,position:(E,T,D,B,M)=>{let er=A.none();xd(E,T,D,B,M,er)},positionWithinBounds:xd,getMode:(E,T,D)=>T.useFixed()?"fixed":"absolute",reset:(E,T,D,B)=>{let M=B.element;L(["position","left","right","top","bottom"],E=>Ht(M,E)),Et(M,n5),D.clear(B.uid)}});let rW=Ol({fields:rz,name:"positioning",active:n0,apis:rG,state:Object.freeze({__proto__:null,init:()=>{let E={};return _a({readState:()=>E,clear:T=>{g(T)?delete E[T]:E={}},set:(T,D)=>{E[T]=D},get:T=>be(E,T)})}})}),kd=E=>E.getSystem().isConnected(),Cd=E=>{Fr(E,oP());let T=E.components();L(T,Cd)},Od=E=>{let T=E.components();L(T,Od),Fr(E,oz())},_d=(E,T)=>{E.getSystem().addToWorld(T),yt(E.element)&&Od(T)},Td=E=>{Cd(E),E.getSystem().removeFromWorld(E)},Ed=(E,T)=>{zo(E.element,T.element)},Ad=(E,T)=>{Md(E,T,zo)},Md=(E,T,D)=>{E.getSystem().addToWorld(T),D(E.element,T.element),yt(E.element)&&Od(T),E.syncComponents()},Dd=E=>{Cd(E),Po(E.element),E.getSystem().removeFromWorld(E)},Bd=E=>{let T=st(E.element).bind(T=>E.getSystem().getByDom(T).toOptional());Dd(E),T.each(E=>{E.syncComponents()})},Fd=E=>{let T=E.components();L(T,Dd),Lo(E.element),E.syncComponents()},Id=(E,T)=>{Nd(E,T,zo)},Rd=(E,T)=>{Nd(E,T,No)},Nd=(E,T,D)=>{D(E,T.element);let B=it(T.element);L(B,E=>{T.getByDom(E).each(Od)})},Vd=E=>{let T=it(E.element);L(T,T=>{E.getByDom(T).each(Cd)}),Po(E.element)},zd=(E,T,D,B)=>{D.get().each(T=>{Fd(E)});let M=T.getAttachPoint(E);Ad(M,E);let er=E.getSystem().build(B);return Ad(E,er),D.set(er),er},Hd=(E,T,D,B)=>{let M=zd(E,T,D,B);return T.onOpen(E,M),M},Ld=(E,T,D)=>{D.get().each(B=>{Fd(E),Bd(E),T.onClose(E,B),D.clear()})},Pd=(E,T,D)=>D.isOpen(),Ud=(E,T,D)=>{var B,M;let er=T.getAttachPoint(E);Dt(E.element,"position",rW.getMode(er)),B="visibility",M=T.cloakVisibilityAttr,Nt(E.element,B).fold(()=>{Et(E.element,M)},T=>{kt(E.element,M,T)}),Dt(E.element,B,"hidden")},Wd=(E,T,D)=>{var B;B=E.element,N(["top","left","right","bottom"],E=>Nt(B,E).isSome())||Ht(E.element,"position"),((E,T,D)=>{_t(E.element,D).fold(()=>Ht(E.element,T),D=>Dt(E.element,T,D))})(E,"visibility",T.cloakVisibilityAttr)};var rj=Object.freeze({__proto__:null,cloak:Ud,decloak:Wd,open:Hd,openWhileCloaked:(E,T,D,B,M)=>{Ud(E,T),Hd(E,T,D,B),M(),Wd(E,T)},close:Ld,isOpen:Pd,isPartOf:(E,T,D,B)=>Pd(0,0,D)&&D.get().exists(D=>T.isPartOf(E,D,B)),getState:(E,T,D)=>D.get(),setContent:(E,T,D,B)=>D.get().map(()=>zd(E,T,D,B))}),rJ=Object.freeze({__proto__:null,events:(E,T)=>Hr([Ur(oM(),(D,B)=>{Ld(D,E,T)})])}),r$=[Di("onOpen"),Di("onClose"),os("isPartOf"),os("getAttachPoint"),ys("cloakVisibilityAttr","data-precloak-visibility")],rX=Object.freeze({__proto__:null,init:()=>{let E=Ql(),T=x("not-implemented");return _a({readState:T,isOpen:E.isSet,clear:E.clear,set:E.set,get:E.get})}});let rq=Ol({fields:r$,name:"sandboxing",active:rJ,apis:rj,state:rX}),rK=x("dismiss.popups"),rY=x("reposition.popups"),rZ=x("mouse.released"),rQ=Mn([ys("isExtraPart",ep),vs("fireEventInstead",[ys("event",oG())])]),Qd=E=>{let T=Yn("Dismissal",rQ,E);return{[rK()]:{schema:Mn([os("target")]),onReceive:(E,D)=>{rq.isOpen(E)&&(rq.isPartOf(E,D.target)||T.isExtraPart(E,D.target)||T.fireEventInstead.fold(()=>rq.close(E),T=>Fr(E,T.event)))}}}},r0=Mn([vs("fireEventInstead",[ys("event",oW())]),is("doReposition")]),tu=E=>{let T=Yn("Reposition",r0,E);return{[rY()]:{onReceive:E=>{rq.isOpen(E)&&T.fireEventInstead.fold(()=>T.doReposition(E),T=>Fr(E,T.event))}}}},ou=(E,T,D)=>{T.store.manager.onLoad(E,T,D)},nu=(E,T,D)=>{T.store.manager.onUnload(E,T,D)};var r1=Object.freeze({__proto__:null,onLoad:ou,onUnload:nu,setValue:(E,T,D,B)=>{T.store.manager.setValue(E,T,D,B)},getValue:(E,T,D)=>T.store.manager.getValue(E,T,D),getState:(E,T,D)=>D}),r2=Object.freeze({__proto__:null,events:(E,T)=>{let D=E.resetOnDom?[oZ((D,B)=>{ou(D,E,T)}),oQ((D,B)=>{nu(D,E,T)})]:[xl(E,T,ou)];return Hr(D)}});let au=()=>{let E=Es(null);return _a({set:E.set,get:E.get,isNotSet:()=>null===E.get(),clear:()=>{E.set(null)},readState:()=>({mode:"memory",value:E.get()})})},iu=()=>{let E=Es({}),T=Es({});return _a({readState:()=>({mode:"dataset",dataByValue:E.get(),dataByText:T.get()}),lookup:D=>be(E.get(),D).orThunk(()=>be(T.get(),D)),update:D=>{let B=E.get(),M=T.get(),er={},ec={};L(D,E=>{er[E.value]=E,be(E,"meta").each(T=>{be(T,"text").each(T=>{ec[T]=E})})}),E.set({...B,...er}),T.set({...M,...ec})},clear:()=>{E.set({}),T.set({})}})};var r3=Object.freeze({__proto__:null,memory:au,dataset:iu,manual:()=>_a({readState:b}),init:E=>E.store.manager.state(E)});let cu=(E,T,D,B)=>{let M=T.store;D.update([B]),M.setValue(E,B),T.onSetValue(E,B)};var r5=[us("initialValue"),os("getFallbackEntry"),os("getDataKey"),os("setValue"),Ri("manager",{setValue:cu,getValue:(E,T,D)=>{let B=T.store,M=B.getDataKey(E);return D.lookup(M).getOrThunk(()=>B.getFallbackEntry(M))},onLoad:(E,T,D)=>{T.store.initialValue.each(B=>{cu(E,T,D,B)})},onUnload:(E,T,D)=>{D.clear()},state:iu})],r9=[os("getValue"),ys("setValue",b),us("initialValue"),Ri("manager",{setValue:(E,T,D,B)=>{T.store.setValue(E,B),T.onSetValue(E,B)},getValue:(E,T,D)=>T.store.getValue(E),onLoad:(E,T,D)=>{T.store.initialValue.each(D=>{T.store.setValue(E,D)})},onUnload:b,state:nb.init})],r4=[xs("store",{mode:"memory"},Jn("mode",{memory:[us("initialValue"),Ri("manager",{setValue:(E,T,D,B)=>{D.set(B),T.onSetValue(E,B)},getValue:(E,T,D)=>D.get(),onLoad:(E,T,D)=>{T.store.initialValue.each(E=>{D.isNotSet()&&D.set(E)})},onUnload:(E,T,D)=>{D.clear()},state:au})],manual:r9,dataset:r5})),Di("onSetValue"),ys("resetOnDom",!1)];let r6=Ol({fields:r4,name:"representing",active:r2,apis:r1,extra:{setValueFrom:(E,T)=>{let D=r6.getValue(T);r6.setValue(E,D)}},state:r3}),hu=(E,T)=>Ts(E,{},H(T,T=>{var D,B;return D=T.name(),B="Cannot configure "+T.name()+" for "+E,gn(D,D,{tag:"option",process:{}},Cn(E=>cn("The field: "+D+" is forbidden. "+B)))}).concat([es("dump",w)])),fu=E=>E.dump,bu=(E,T)=>({...kl(T),...E.dump}),r8="placeholder",r7=As([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Su=E=>ve(E,"uiType"),ku=(E,T,D,B)=>(Su(D)&&D.uiType===r8?E.exists(E=>E!==D.owner)?r7.single(!0,x(D)):be(B,D.name).fold(()=>{throw Error("Unknown placeholder component: "+D.name+"\nKnown: ["+eD(B)+"]\nNamespace: "+E.getOr("none")+"\nSpec: "+JSON.stringify(D,null,2))},E=>E.replace()):r7.single(!1,x(D))).fold((M,er)=>{let ec=Su(D)?er(T,D.config,D.validated):er(T),eu=be(ec,"components").getOr([]),eg=X(eu,D=>ku(E,T,D,B));return[{...ec,components:eg}]},(E,B)=>{if(Su(D)){let E=B(T,D.config,D.validated);return D.validated.preprocess.getOr(w)(E)}return B(T)}),ae=r7.single,ao=r7.multiple,ar=x(r8),aa=As([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),ai=ys("factory",{sketch:w}),ap=ys("schema",[]),ah=os("name"),af=gn("pname","pname",vn(E=>"<alloy."+la(E.name)+">"),tz()),ab=es("schema",()=>[us("preprocess")]),ax=ys("defaults",x({})),ay=ys("overrides",x({})),aA=Dn([ai,ap,ah,af,ax,ay]),ak=Dn([ai,ap,ah,ax,ay]),aS=Dn([ai,ap,ah,af,ax,ay]),aO=Dn([ai,ab,ah,os("unit"),af,ax,ay]),Hu=E=>E.fold(A.some,A.none,A.some,A.some),Lu=E=>{let t=E=>E.name;return E.fold(t,t,t,t)},Pu=(E,T)=>D=>{let B=Yn("Converting part type",T,D);return E(B)},aT=Pu(aa.required,aA),aF=Pu(aa.external,ak),aB=Pu(aa.optional,aS),aH=Pu(aa.group,aO),aR=x("entirety");var aN=Object.freeze({__proto__:null,required:aT,external:aF,optional:aB,group:aH,asNamedPart:Hu,name:Lu,asCommon:E=>E.fold(w,w,w,w),original:aR});let Xu=(E,T,D,B)=>tR(T.defaults(E,D,B),D,{uid:E.partUids[T.name]},T.overrides(E,D,B)),Yu=(E,T)=>{let D={};return L(T,T=>{Hu(T).each(T=>{let B=Ku(E,T.pname);D[T.name]=D=>{let M=Yn("Part: "+T.name+" in "+E,Dn(T.schema),D);return{...B,config:D,validated:M}}})}),D},Ku=(E,T)=>({uiType:ar(),owner:E,name:T}),Ju=(E,T,D)=>({uiType:ar(),owner:E,name:T,config:D,validated:{}}),Zu=E=>X(E,E=>E.fold(A.none,A.some,A.none,A.none).map(E=>ls(E.name,E.schema.concat([Ni(aR())]))).toArray()),Qu=E=>H(E,Lu),em=(E,T,D)=>((E,T,D)=>{let B={},M={};return L(D,E=>{E.fold(E=>{B[E.pname]=ae(!0,(T,D,B)=>E.factory.sketch(Xu(T,E,D,B)))},E=>{let D=T.parts[E.name];M[E.name]=x(E.factory.sketch(Xu(T,E,D[aR()]),D))},E=>{B[E.pname]=ae(!1,(T,D,B)=>E.factory.sketch(Xu(T,E,D,B)))},E=>{B[E.pname]=ao(!0,(T,D,B)=>{let M=T[E.name];return H(M,D=>E.factory.sketch(tR(E.defaults(T,D,B),D,E.overrides(T,D))))})})}),{internals:x(B),externals:x(M)}})(0,T,D),tm=(E,T,D)=>((E,T,D,B)=>{let M=ce(B,(E,T)=>{let D;return D=!1,{name:x(T),required:()=>E.fold((E,T)=>E,(E,T)=>E),used:()=>D,replace:()=>{if(D)throw Error("Trying to use the same placeholder more than once: "+T);return D=!0,E}}}),er=X(D,D=>ku(E,T,D,M));return le(M,D=>{if(!1===D.used()&&D.required())throw Error("Placeholder: "+D.name()+" was not found in components list\nNamespace: "+E.getOr("none")+"\nComponents: "+JSON.stringify(T.components,null,2))}),er})(A.some(E),T,T.components,D),om=(E,T,D)=>{let B=T.partUids[D];return E.getSystem().getByUid(B).toOptional()},nm=(E,T,D)=>om(E,T,D).getOrDie("Could not find part: "+D),sm=(E,T,D)=>{let B={},M=T.partUids,er=E.getSystem();return L(D,E=>{B[E]=x(er.getByUid(M[E]))}),B},rm=(E,T)=>{let D=E.getSystem();return ce(T.partUids,(E,T)=>x(D.getByUid(E)))},am=E=>eD(E.partUids),im=(E,T,D)=>{let B={},M=T.partUids,er=E.getSystem();return L(D,E=>{B[E]=x(er.getByUid(M[E]).getOrDie())}),B},lm=(E,T)=>{let D=Qu(T);return Ds(H(D,T=>({key:T,value:E+"-"+T})))},cm=E=>gn("partUids","partUids",xn(T=>lm(T.uid,E)),tz());var aU=Object.freeze({__proto__:null,generate:Yu,generateOne:Ju,schemas:Zu,names:Qu,substitutes:em,components:tm,defaultUids:lm,defaultUidsSchema:cm,getAllParts:rm,getAllPartNames:am,getPart:om,getPartOrDie:nm,getParts:sm,getPartsOrDie:im});let um=(E,T,D,B,M)=>{let er=(B.length>0?[ls("parts",B)]:[]).concat([os("uid"),ys("dom",{}),ys("components",[]),Ni("originalSpec"),ys("debug.sketcher",{})]).concat(M);return Yn(E+" [SpecSchema]",Mn(er.concat(T)),D)},mm=(E,T,D,B,M)=>{let er=gm(M),ec=Zu(D),eu=cm(D),eg=um(E,T,er,ec,[eu]),ep=em(0,eg,D);return B(eg,tm(E,eg,ep.internals()),er,ep.externals())},gm=E=>ve(E,"uid")?E:{...E,uid:ha("uid")},aL=Mn([os("name"),os("factory"),os("configFields"),ys("apis",{}),ys("extraApis",{})]),az=Mn([os("name"),os("factory"),os("configFields"),os("partFields"),ys("apis",{}),ys("extraApis",{})]),fm=E=>{let T=Yn("Sketcher for "+E.name,aL,E),D=ce(T.apis,Ca),B=ce(T.extraApis,(E,T)=>xa(E,T));return{name:T.name,configFields:T.configFields,sketch:E=>((E,T,D,B)=>{let M=gm(B);return D(um(E,T,M,[],[]),M)})(T.name,T.configFields,T.factory,E),...D,...B}},bm=E=>{let T=Yn("Sketcher for "+E.name,az,E),D=Yu(T.name,T.partFields),B=ce(T.apis,Ca),M=ce(T.extraApis,(E,T)=>xa(E,T));return{name:T.name,partFields:T.partFields,configFields:T.configFields,sketch:E=>mm(T.name,T.configFields,T.partFields,T.factory,E),parts:D,...B,...M}},vm=E=>Ye("input")(E)&&"radio"!==Ot(E,"type")||Ye("textarea")(E);var aP=Object.freeze({__proto__:null,getCurrent:(E,T,D)=>T.find(E)});let aG=[os("find")],aW=Ol({fields:aG,name:"composing",apis:aP}),aj=["input","button","textarea","select"],km=(E,T,D)=>{(T.disabled()?Am:Mm)(E,T)},Cm=(E,T)=>!0===T.useNative&&R(aj,Ue(E.element)),Om=E=>{kt(E.element,"disabled","disabled")},_m=E=>{Et(E.element,"disabled")},Tm=E=>{kt(E.element,"aria-disabled","true")},Em=E=>{kt(E.element,"aria-disabled","false")},Am=(E,T,D)=>{T.disableClass.each(T=>{La(E.element,T)}),(Cm(E,T)?Om:Tm)(E),T.onDisabled(E)},Mm=(E,T,D)=>{T.disableClass.each(T=>{Pa(E.element,T)}),(Cm(E,T)?_m:Em)(E),T.onEnabled(E)},Dm=(E,T)=>Cm(E,T)?Tt(E.element,"disabled"):"true"===Ot(E.element,"aria-disabled");var aJ=Object.freeze({__proto__:null,enable:Mm,disable:Am,isDisabled:Dm,onLoad:km,set:(E,T,D,B)=>{(B?Am:Mm)(E,T)}}),a$=Object.freeze({__proto__:null,exhibit:(E,T)=>Ea({classes:T.disabled()?T.disableClass.toArray():[]}),events:(E,T)=>Hr([Lr(oS(),(T,D)=>Dm(T,E)),xl(E,T,km)])}),aX=[Os("disabled",ep),ys("useNative",!0),us("disableClass"),Di("onDisabled"),Di("onEnabled")];let aq=Ol({fields:aX,name:"disabling",active:a$,apis:aJ}),Nm=(E,T,D,B)=>{let M=Xc(E.element,"."+T.highlightClass);L(M,D=>{N(B,E=>Ze(E.element,D))||(Pa(D,T.highlightClass),E.getSystem().getByDom(D).each(D=>{T.onDehighlight(E,D),Fr(D,oY())}))})},Vm=(E,T,D,B)=>{Nm(E,T,0,[B]),zm(E,T,D,B)||(La(B.element,T.highlightClass),T.onHighlight(E,B),Fr(B,oK()))},zm=(E,T,D,B)=>Ua(B.element,T.highlightClass),Hm=(E,T,D)=>pi(E.element,"."+T.itemClass).bind(T=>E.getSystem().getByDom(T).toOptional()),Lm=(E,T,D)=>{let B=Xc(E.element,"."+T.itemClass);return(B.length>0?A.some(B[B.length-1]):A.none()).bind(T=>E.getSystem().getByDom(T).toOptional())},Pm=(E,T,D,B)=>{let M=Xc(E.element,"."+T.itemClass);return $(M,E=>Ua(E,T.highlightClass)).bind(T=>{let D=Xi(T,B,0,M.length-1);return E.getSystem().getByDom(M[D]).toOptional()})},Um=(E,T,D)=>{let B=Xc(E.element,"."+T.itemClass);return we(H(B,T=>E.getSystem().getByDom(T).toOptional()))};var aK=Object.freeze({__proto__:null,dehighlightAll:(E,T,D)=>Nm(E,T,0,[]),dehighlight:(E,T,D,B)=>{zm(E,T,D,B)&&(Pa(B.element,T.highlightClass),T.onDehighlight(E,B),Fr(B,oY()))},highlight:Vm,highlightFirst:(E,T,D)=>{Hm(E,T).each(B=>{Vm(E,T,D,B)})},highlightLast:(E,T,D)=>{Lm(E,T).each(B=>{Vm(E,T,D,B)})},highlightAt:(E,T,D,B)=>{((E,T,D,B)=>{let M=Xc(E.element,"."+T.itemClass);return A.from(M[B]).fold(()=>tH.error(Error("No element found with index "+B)),E.getSystem().getByDom)})(E,T,0,B).fold(E=>{throw E},B=>{Vm(E,T,D,B)})},highlightBy:(E,T,D,B)=>{let M=Um(E,T);G(M,B).each(B=>{Vm(E,T,D,B)})},isHighlighted:zm,getHighlighted:(E,T,D)=>pi(E.element,"."+T.highlightClass).bind(T=>E.getSystem().getByDom(T).toOptional()),getFirst:Hm,getLast:Lm,getPrevious:(E,T,D)=>Pm(E,T,0,-1),getNext:(E,T,D)=>Pm(E,T,0,1),getCandidates:Um}),aY=[os("highlightClass"),os("itemClass"),Di("onHighlight"),Di("onDehighlight")];let aZ=Ol({fields:aY,name:"highlighting",apis:aK}),aQ=[9],a0=[13],a1=[27],a2=[32],a3=[37],a5=[38],a9=[39],a4=[40],tg=(E,T,D)=>{let B=K(E.slice(0,T)),M=K(E.slice(T+1));return G(B.concat(M),D)},og=(E,T,D)=>{let B=K(E.slice(0,T));return G(B,D)},ng=(E,T,D)=>{let B=E.slice(0,T),M=E.slice(T+1);return G(M.concat(B),D)},sg=(E,T,D)=>{let B=E.slice(T+1);return G(B,D)},rg=E=>T=>{let D=T.raw;return R(E,D.which)},ag=E=>T=>Y(E,E=>E(T)),ig=E=>!0===E.raw.shiftKey,lg=E=>!0===E.raw.ctrlKey,a6=C(ig),dg=(E,T)=>({matches:E,classification:T}),ug=(E,T,D)=>{T.exists(E=>D.exists(T=>Ze(T,E)))||Ir(E,oj(),{prevFocus:T,newFocus:D})},mg=()=>{let e=E=>Rl(E.element);return{get:e,set:(E,T)=>{let D=e(E);E.getSystem().triggerFocus(T,E.element);let B=e(E);ug(E,D,B)}}},gg=()=>{let e=E=>aZ.getHighlighted(E).map(E=>E.element);return{get:e,set:(E,T)=>{let D=e(E);E.getSystem().getByDom(T).fold(b,T=>{aZ.highlight(E,T)});let B=e(E);ug(E,D,B)}}};(i3=i6||(i6={})).OnFocusMode="onFocus",i3.OnEnterOrSpaceMode="onEnterOrSpace",i3.OnApiMode="onApi";let hg=(E,T,D,B,M)=>{let r=(E,T,D,B,M)=>{var er,ec;return(er=D(E,T,B,M),ec=T.event,G(er,E=>E.matches(ec)).map(E=>E.classification)).bind(D=>D(E,T,B,M))},er={schema:()=>E.concat([ys("focusManager",mg()),xs("focusInside","onFocus",Gn(E=>R(["onFocus","onEnterOrSpace","onApi"],E)?tH.value(E):tH.error("Invalid value for focusInside"))),Ri("handler",er),Ri("state",T),Ri("sendFocusIn",M)]),processKey:r,toEvents:(E,T)=>{let er=E.focusInside!==i6.OnFocusMode?A.none():M(E).map(D=>Ur(ox(),(B,M)=>{D(B,E,T),M.stop()})),ec=[Ur(t9(),(B,er)=>{r(B,er,D,E,T).fold(()=>{((D,B)=>{let er=rg(a2.concat(a0))(B.event);E.focusInside===i6.OnEnterOrSpaceMode&&er&&Rs(D,B)&&M(E).each(M=>{M(D,E,T),B.stop()})})(B,er)},E=>{er.stop()})}),Ur(t4(),(D,M)=>{r(D,M,B,E,T).each(E=>{M.stop()})})];return Hr(er.toArray().concat(ec))}};return er},fg=E=>{let T=[us("onEscape"),us("onEnter"),ys("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),ys("firstTabstop",0),ys("useTabstopAt",eh),us("visibilitySelector")].concat([E]),o=(E,T)=>{let D=E.visibilitySelector.bind(E=>hi(T,E)).getOr(T);return Wt(D)>0},n=(E,T)=>T.focusManager.get(E).bind(E=>hi(E,T.selector)),s=(E,T,D)=>{((E,T)=>{let D=Xc(E.element,T.selector),B=U(D,E=>o(T,E));return A.from(B[T.firstTabstop])})(E,T).each(D=>{T.focusManager.set(E,D)})},r=(E,T,D,B)=>{let M=Xc(E.element,D.selector);return n(E,D).bind(T=>$(M,k(Ze,T)).bind(T=>B(M,T,E=>o(D,E)&&D.useTabstopAt(E)).fold(()=>D.cyclic?A.some(!0):A.none(),T=>(D.focusManager.set(E,T),A.some(!0)))))},a=(E,T,D)=>{let B=D.cyclic?tg:og;return r(E,0,D,B)},i=(E,T,D)=>{let B=D.cyclic?ng:sg;return r(E,0,D,B)},D=x([dg(ag([ig,rg(aQ)]),a),dg(rg(aQ),i),dg(ag([a6,rg(a0)]),(E,T,D)=>D.onEnter.bind(D=>D(E,T)))]),B=x([dg(rg(a1),(E,T,D)=>D.onEscape.bind(D=>D(E,T))),dg(rg(aQ),(E,T,D)=>n(E,D).filter(E=>!D.useTabstopAt(E)).bind(B=>(st(B).bind(ct).exists(E=>Ze(E,B))?a:i)(E,T,D)))]);return hg(T,nb.init,D,B,()=>A.some(s))};var a8=fg(es("cyclic",ep)),a7=fg(es("cyclic",eh));let yg=(E,T,D)=>vm(D)&&rg(a2)(T.event)?A.none():(Nr(E,D,oS()),A.some(!0)),xg=(E,T)=>A.some(!0),se=[ys("execute",yg),ys("useSpace",!1),ys("useEnter",!0),ys("useControlEnter",!1),ys("useDown",!1)],Sg=(E,T,D)=>D.execute(E,T,E.element);var so=hg(se,nb.init,(E,T,D,B)=>{let M=D.useSpace&&!vm(E.element)?a2:[],er=D.useEnter?a0:[],ec=D.useDown?a4:[],eu=M.concat(er).concat(ec);return[dg(rg(eu),Sg)].concat(D.useControlEnter?[dg(ag([lg,rg(a0)]),Sg)]:[])},(E,T,D,B)=>D.useSpace&&!vm(E.element)?[dg(rg(a2),xg)]:[],()=>A.none());let Cg=()=>{let E=Ql();return _a({readState:()=>E.get().map(E=>({numRows:String(E.numRows),numColumns:String(E.numColumns)})).getOr({numRows:"?",numColumns:"?"}),setGridSize:(T,D)=>{E.set({numRows:T,numColumns:D})},getNumRows:()=>E.get().map(E=>E.numRows),getNumColumns:()=>E.get().map(E=>E.numColumns)})};var sn=Object.freeze({__proto__:null,flatgrid:Cg,init:E=>E.state(E)});let _g=E=>(T,D,B,M)=>{let er=E(T.element);return Mg(er,T,D,B,M)},Tg=(E,T)=>{let D=fc(E,T);return _g(D)},Eg=(E,T)=>{let D=fc(T,E);return _g(D)},Ag=E=>(T,D,B,M)=>Mg(E,T,D,B,M),Mg=(E,T,D,B,M)=>B.focusManager.get(T).bind(D=>E(T.element,D,B,M)).map(E=>(B.focusManager.set(T,E),!0)),Ig=E=>{var T;return!((T=E.dom).offsetWidth<=0)||!(T.offsetHeight<=0)},Rg=(E,T,D)=>{var B;let M=Xc(E,D);return $(B=U(M,Ig),E=>Ze(E,T)).map(E=>({index:E,candidates:B}))},Ng=(E,T)=>$(E,E=>Ze(T,E)),Vg=(E,T,D,B)=>B(Math.floor(T/D),T%D).bind(T=>{let B=T.row*D+T.column;return B>=0&&B<E.length?A.some(E[B]):A.none()}),zg=(E,T,D,B,M)=>Vg(E,T,B,(T,er)=>{let ec=T===D-1?E.length-T*B:B,eu=Xi(er,M,0,ec-1);return A.some({row:T,column:eu})}),Hg=(E,T,D,B,M)=>Vg(E,T,B,(T,er)=>{let ec=Xi(T,M,0,D-1),eu=ec===D-1?E.length-ec*B:B,eg=Yi(er,0,eu-1);return A.some({row:ec,column:eg})}),sr=[os("selector"),ys("execute",yg),Bi("onEscape"),ys("captureTab",!1),nR()],Pg=(E,T,D)=>{pi(E.element,T.selector).each(D=>{T.focusManager.set(E,D)})},Ug=E=>(T,D,B,M)=>Rg(T,D,B.selector).bind(T=>E(T.candidates,T.index,M.getNumRows().getOr(B.initSize.numRows),M.getNumColumns().getOr(B.initSize.numColumns))),Wg=(E,T,D)=>D.captureTab?A.some(!0):A.none(),sa=Ug((E,T,D,B)=>zg(E,T,D,B,-1)),sc=Ug((E,T,D,B)=>zg(E,T,D,B,1)),sd=Ug((E,T,D,B)=>Hg(E,T,D,B,-1)),su=Ug((E,T,D,B)=>Hg(E,T,D,B,1)),sf=x([dg(rg(a3),Tg(sa,sc)),dg(rg(a9),Eg(sa,sc)),dg(rg(a5),Ag(sd)),dg(rg(a4),Ag(su)),dg(ag([ig,rg(aQ)]),Wg),dg(ag([a6,rg(aQ)]),Wg),dg(rg(a2.concat(a0)),(E,T,D,B)=>D.focusManager.get(E).bind(E=>hi(E,D.selector)).bind(B=>D.execute(E,T,B)))]),sb=x([dg(rg(a1),(E,T,D)=>D.onEscape(E,T)),dg(rg(a2),xg)]);var sx=hg(sr,Cg,sf,sb,()=>A.some(Pg));let Jg=(E,T,D,B,M)=>{let r=(E,T,D)=>M(E,T,B,0,D.length-1,D[T],T=>{var B;return"button"===Ue(B=D[T])&&"disabled"===Ot(B,"disabled")?r(E,T,D):A.from(D[T])});return Rg(E,D,T).bind(E=>{let T=E.index,D=E.candidates;return r(T,T,D)})},Zg=(E,T,D,B)=>Jg(E,T,D,B,(E,T,D,B,M,er,ec)=>{let eu=Yi(T+D,B,M);return eu===E?A.from(er):ec(eu)}),Qg=(E,T,D,B)=>Jg(E,T,D,B,(E,T,D,B,M,er,ec)=>{let eu=Xi(T,D,B,M);return eu===E?A.none():ec(eu)}),sy=[os("selector"),ys("getInitial",A.none),ys("execute",yg),Bi("onEscape"),ys("executeOnMove",!1),ys("allowVertical",!0),ys("allowHorizontal",!0),ys("cycles",!0)],tp=(E,T,D)=>D.focusManager.get(E).bind(E=>hi(E,D.selector)).bind(B=>D.execute(E,T,B)),op=(E,T,D)=>{T.getInitial(E).orThunk(()=>pi(E.element,T.selector)).each(D=>{T.focusManager.set(E,D)})},np=(E,T,D)=>(D.cycles?Qg:Zg)(E,D.selector,T,-1),sp=(E,T,D)=>(D.cycles?Qg:Zg)(E,D.selector,T,1),rp=E=>(T,D,B,M)=>E(T,D,B,M).bind(()=>B.executeOnMove?tp(T,D,B):A.some(!0)),sw=x([dg(rg(a2),xg),dg(rg(a1),(E,T,D)=>D.onEscape(E,T))]);var sk=hg(sy,nb.init,(E,T,D,B)=>{let M=[...D.allowHorizontal?a3:[]].concat(D.allowVertical?a5:[]),er=[...D.allowHorizontal?a9:[]].concat(D.allowVertical?a4:[]);return[dg(rg(M),rp(Tg(np,sp))),dg(rg(er),rp(Eg(np,sp))),dg(rg(a0),tp),dg(rg(a2),tp)]},sw,()=>A.some(op));let lp=(E,T,D)=>A.from(E[T]).bind(E=>A.from(E[D]).map(E=>({rowIndex:T,columnIndex:D,cell:E}))),cp=(E,T,D,B)=>{let M=E[T].length,er=Xi(D,B,0,M-1);return lp(E,T,er)},dp=(E,T,D,B)=>{let M=Xi(D,B,0,E.length-1),er=E[M].length,ec=Yi(T,0,er-1);return lp(E,M,ec)},up=(E,T,D,B)=>{let M=E[T].length,er=Yi(D+B,0,M-1);return lp(E,T,er)},mp=(E,T,D,B)=>{let M=Yi(D+B,0,E.length-1),er=E[M].length,ec=Yi(T,0,er-1);return lp(E,M,ec)},sO=[ls("selectors",[os("row"),os("cell")]),ys("cycles",!0),ys("previousSelector",A.none),ys("execute",yg)],pp=(E,T,D)=>{T.previousSelector(E).orThunk(()=>{let D=T.selectors;return pi(E.element,D.cell)}).each(D=>{T.focusManager.set(E,D)})},hp=(E,T)=>(D,B,M)=>{let er=M.cycles?E:T;return hi(B,M.selectors.row).bind(E=>{let T=Xc(E,M.selectors.cell);return Ng(T,B).bind(T=>{let B=Xc(D,M.selectors.row);return Ng(B,E).bind(E=>{let D=H(B,E=>Xc(E,M.selectors.cell));return er(D,E,T).map(E=>E.cell)})})})},s_=hp((E,T,D)=>cp(E,T,D,-1),(E,T,D)=>up(E,T,D,-1)),sT=hp((E,T,D)=>cp(E,T,D,1),(E,T,D)=>up(E,T,D,1)),sF=hp((E,T,D)=>dp(E,D,T,-1),(E,T,D)=>mp(E,D,T,-1)),sM=hp((E,T,D)=>dp(E,D,T,1),(E,T,D)=>mp(E,D,T,1)),sH=x([dg(rg(a3),Tg(s_,sT)),dg(rg(a9),Eg(s_,sT)),dg(rg(a5),Ag(sF)),dg(rg(a4),Ag(sM)),dg(rg(a2.concat(a0)),(E,T,D)=>Rl(E.element).bind(B=>D.execute(E,T,B)))]),sR=x([dg(rg(a2),xg)]);var sN=hg(sO,nb.init,sH,sR,()=>A.some(pp));let sU=[os("selector"),ys("execute",yg),ys("moveOnTab",!1)],Cp=(E,T,D)=>D.focusManager.get(E).bind(B=>D.execute(E,T,B)),Op=(E,T,D)=>{pi(E.element,T.selector).each(D=>{T.focusManager.set(E,D)})},_p=(E,T,D)=>Qg(E,D.selector,T,-1),Tp=(E,T,D)=>Qg(E,D.selector,T,1),sL=x([dg(rg(a5),Ag(_p)),dg(rg(a4),Ag(Tp)),dg(ag([ig,rg(aQ)]),(E,T,D,B)=>D.moveOnTab?Ag(_p)(E,T,D,B):A.none()),dg(ag([a6,rg(aQ)]),(E,T,D,B)=>D.moveOnTab?Ag(Tp)(E,T,D,B):A.none()),dg(rg(a0),Cp),dg(rg(a2),Cp)]),sz=x([dg(rg(a2),xg)]);var sP=hg(sU,nb.init,sL,sz,()=>A.some(Op));let sG=[Bi("onSpace"),Bi("onEnter"),Bi("onShiftEnter"),Bi("onLeft"),Bi("onRight"),Bi("onTab"),Bi("onShiftTab"),Bi("onUp"),Bi("onDown"),Bi("onEscape"),ys("stopSpaceKeyup",!1),us("focusIn")];var sW=hg(sG,nb.init,(E,T,D)=>[dg(rg(a2),D.onSpace),dg(ag([a6,rg(a0)]),D.onEnter),dg(ag([ig,rg(a0)]),D.onShiftEnter),dg(ag([ig,rg(aQ)]),D.onShiftTab),dg(ag([a6,rg(aQ)]),D.onTab),dg(rg(a5),D.onUp),dg(rg(a4),D.onDown),dg(rg(a3),D.onLeft),dg(rg(a9),D.onRight),dg(rg(a2),D.onSpace)],(E,T,D)=>[...D.stopSpaceKeyup?[dg(rg(a2),xg)]:[],dg(rg(a1),D.onEscape)],E=>E.focusIn);let sj=a8.schema(),sJ=a7.schema(),s$=sk.schema(),sX=sx.schema(),sq=sN.schema(),sK=so.schema(),sY=sP.schema(),sZ=sW.schema(),sQ=Tl({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:sj,cyclic:sJ,flow:s$,flatgrid:sX,matrix:sq,execution:sK,menu:sY,special:sZ}),name:"keying",active:{events:(E,T)=>E.handler.toEvents(E,T)},apis:{focusIn:(E,T,D)=>{T.sendFocusIn(T).fold(()=>{E.getSystem().triggerFocus(E.element,E.element)},B=>{B(E,T,D)})},setGridSize:(E,T,D,B,M)=>{ye(D,"setGridSize")?D.setGridSize(B,M):console.error("Layout does not support setGridSize")}},state:sn}),Up=(E,T)=>{Nl(()=>{((E,T,D)=>{let B=E.components();L(E.components(),E=>Po(E.element)),Lo(E.element),E.syncComponents();let M=D(T),er=J(B,M);L(er,T=>{Cd(T),E.getSystem().removeFromWorld(T)}),L(M,T=>{kd(T)?Ed(E,T):(E.getSystem().addToWorld(T),Ed(E,T),yt(E.element)&&Od(T))}),E.syncComponents()})(E,T,()=>H(T,E.getSystem().build))},E.element)},Wp=(E,T)=>{Nl(()=>{((D,B,M)=>{var er,ec;let eu=D.components(),eg=X(B,E=>ka(E).toArray());L(eu,E=>{R(eg,E)||Td(E)});let ep=(er=E.element,ec=E.getSystem().buildOrPatch,Ya(er,T,(E,T)=>Ka(er,T,E,ec))),eh=J(eu,ep);L(eh,E=>{kd(E)&&Td(E)}),L(ep,E=>{kd(E)||_d(D,E)}),D.syncComponents()})(E,T)},E.element)},jp=(E,T,D,B)=>{Td(T);let M=Ka(E.element,D,B,E.getSystem().buildOrPatch);_d(E,M),E.syncComponents()},Gp=(E,T,D)=>{let B=E.getSystem().build(D);Md(E,B,T)},$p=(E,T,D,B)=>{Bd(T),Gp(E,(E,T)=>((E,T,D)=>{lt(E,D).fold(()=>{zo(E,T)},E=>{Ro(E,T)})})(E,T,D),B)},qp=(E,T)=>E.components(),Xp=(E,T,D,B,M)=>{let er=qp(E);return A.from(er[B]).map(D=>(M.fold(()=>Bd(D),M=>{(T.reuseDom?jp:$p)(E,D,B,M)}),D))};var s0=Object.freeze({__proto__:null,append:(E,T,D,B)=>{Gp(E,zo,B)},prepend:(E,T,D,B)=>{Gp(E,Vo,B)},remove:(E,T,D,B)=>{let M=qp(E),er=G(M,E=>Ze(B.element,E.element));er.each(Bd)},replaceAt:Xp,replaceBy:(E,T,D,B,M)=>{let er=qp(E);return $(er,B).bind(D=>Xp(E,T,0,D,M))},set:(E,T,D,B)=>(T.reuseDom?Wp:Up)(E,B),contents:qp});let s1=Ol({fields:[Cs("reuseDom",!0)],name:"replacing",apis:s0}),Jp=(E,T)=>{let D=((E,T)=>{let D=Hr(T);return Ol({fields:[os("enabled")],name:E,active:{events:x(D)}})})(E,T);return{key:E,value:{config:{},me:D,configAsRaw:x({}),initialConfig:{},state:nb}}},Zp=(E,T)=>{T.ignore||(Dl(E.element),T.onFocus(E))};var s2=Object.freeze({__proto__:null,focus:Zp,blur:(E,T)=>{T.ignore||Bl(E.element)},isFocused:E=>Fl(E.element)}),s3=Object.freeze({__proto__:null,exhibit:(E,T)=>{let D=T.ignore?{}:{attributes:{tabindex:"-1"}};return Ea(D)},events:E=>Hr([Ur(ox(),(T,D)=>{Zp(T,E),D.stop()})].concat(E.stopMousedown?[Ur(tZ(),(E,T)=>{T.event.prevent()})]:[]))}),s5=[Di("onFocus"),ys("stopMousedown",!1),ys("ignore",!1)];let s9=Ol({fields:s5,name:"focusing",active:s3,apis:s2}),nh=(E,T,D,B)=>{let M=D.get();D.set(B),((E,T,D)=>{T.toggleClass.each(T=>{D.get()?La(E.element,T):Pa(E.element,T)})})(E,T,D),((E,T,D)=>{let B=T.aria;B.update(E,B,D.get())})(E,T,D),M!==B&&T.onToggled(E,B)},sh=(E,T,D)=>{nh(E,T,D,!D.get())},rh=(E,T,D)=>{nh(E,T,D,T.selected)};var s4=Object.freeze({__proto__:null,onLoad:rh,toggle:sh,isOn:(E,T,D)=>D.get(),on:(E,T,D)=>{nh(E,T,D,!0)},off:(E,T,D)=>{nh(E,T,D,!1)},set:nh}),s6=Object.freeze({__proto__:null,exhibit:()=>Ea({}),events:(E,T)=>{let D=o1(D=>{sh(D,E,T)}),B=xl(E,T,rh);return Hr(q([E.toggleOnExecute?[D]:[],[B]]))}});let lh=(E,T,D)=>{kt(E.element,"aria-expanded",D)};var s8=[ys("selected",!1),us("toggleClass"),ys("toggleOnExecute",!0),Di("onToggled"),xs("aria",{mode:"none"},Jn("mode",{pressed:[ys("syncWithExpanded",!1),Ri("update",(E,T,D)=>{kt(E.element,"aria-pressed",D),T.syncWithExpanded&&lh(E,0,D)})],checked:[Ri("update",(E,T,D)=>{kt(E.element,"aria-checked",D)})],expanded:[Ri("update",lh)],selected:[Ri("update",(E,T,D)=>{kt(E.element,"aria-selected",D)})],none:[Ri("update",b)]}))];let s7=Ol({fields:s8,name:"toggling",active:s6,apis:s4,state:{init:()=>{let E=Es(!1);return{get:()=>E.get(),set:T=>E.set(T),clear:()=>E.set(!1),readState:()=>E.get()}}}}),uh=()=>{let e=(E,T)=>{T.stop(),Rr(E)};return[Ur(t7(),e),Ur(o_(),e),qr(tX()),qr(tZ())]},mh=E=>Hr(q([E.map(E=>o1((T,D)=>{E(T),D.stop()})).toArray(),uh()])),ie="alloy.item-hover",io="alloy.item-focus",ir="alloy.item-toggled",fh=E=>{(Rl(E.element).isNone()||s9.isFocused(E))&&(s9.isFocused(E)||s9.focus(E),Ir(E,ie,{item:E}))},bh=E=>{Ir(E,io,{item:E})},ia=x(ie),ii=x(io),ip=x(ir),wh=E=>E.toggling.map(E=>E.exclusive?"menuitemradio":"menuitemcheckbox").getOr("menuitem"),ih=[os("data"),os("components"),os("dom"),ys("hasSubmenu",!1),us("toggling"),hu("itemBehaviours",[s7,s9,sQ,r6]),ys("ignoreFocus",!1),ys("domModification",{}),Ri("builder",E=>({dom:E.dom,domModification:{...E.domModification,attributes:{role:wh(E),...E.domModification.attributes,"aria-haspopup":E.hasSubmenu,...E.hasSubmenu?{"aria-expanded":!1}:{}}},behaviours:bu(E.itemBehaviours,[E.toggling.fold(s7.revoke,E=>s7.config({aria:{mode:"checked"},...ge(E,(E,T)=>"exclusive"!==T),onToggled:(T,D)=>{eu(E.onToggled)&&E.onToggled(T,D),Ir(T,ir,{item:T,state:D})}})),s9.config({ignore:E.ignoreFocus,stopMousedown:E.ignoreFocus,onFocus:E=>{bh(E)}}),sQ.config({mode:"execution"}),r6.config({store:{mode:"memory",initialValue:E.data}}),Jp("item-type-events",[...uh(),Ur(t2(),fh),Ur(oO(),s9.focus)])]),components:E.components,eventOrder:E.eventOrder})),ys("eventOrder",{})],ib=[os("dom"),os("components"),Ri("builder",E=>({dom:E.dom,components:E.components,events:Hr([Xr(oO())])}))],iy=x("item-widget"),iA=x([aT({name:"widget",overrides:E=>({behaviours:kl([r6.config({store:{mode:"manual",getValue:T=>E.data,setValue:b}})])})})]),ik=[os("uid"),os("data"),os("components"),os("dom"),ys("autofocus",!1),ys("ignoreFocus",!1),hu("widgetBehaviours",[r6,s9,sQ]),ys("domModification",{}),cm(iA()),Ri("builder",E=>{let T=em(iy(),E,iA()),D=tm(iy(),E,T.internals()),n=T=>om(T,E,"widget").map(E=>(sQ.focusIn(E),E)),s=(T,D)=>(vm(D.event.target)||E.autofocus&&D.setSource(T.element),A.none());return{dom:E.dom,components:D,domModification:E.domModification,events:Hr([o1((E,T)=>{n(E).each(E=>{T.stop()})}),Ur(t2(),fh),Ur(oO(),(T,D)=>{E.autofocus?n(T):s9.focus(T)})]),behaviours:bu(E.widgetBehaviours,[r6.config({store:{mode:"memory",initialValue:E.data}}),s9.config({ignore:E.ignoreFocus,onFocus:E=>{bh(E)}}),sQ.config({mode:"special",focusIn:E.autofocus?E=>{n(E)}:nZ(),onLeft:s,onRight:s,onEscape:(T,D)=>s9.isFocused(T)||E.autofocus?(E.autofocus&&D.setSource(T.element),A.none()):(s9.focus(T),A.some(!0))})])}})],iF=Jn("type",{widget:ik,item:ih,separator:ib}),iB=x([aH({factory:{sketch:E=>{let T=Yn("menu.spec item",iF,E);return T.builder(T)}},name:"items",unit:"item",defaults:(E,T)=>ve(T,"uid")?T:{...T,uid:ha("item")},overrides:(E,T)=>({type:T.type,ignoreFocus:E.fakeFocus,domModification:{classes:[E.markers.item]}})})]),iM=x([os("value"),os("items"),os("dom"),os("components"),ys("eventOrder",{}),hu("menuBehaviours",[aZ,r6,aW,sQ]),xs("movement",{mode:"menu",moveOnTab:!0},Jn("mode",{grid:[nR(),Ri("config",(E,T)=>({mode:"flatgrid",selector:"."+E.markers.item,initSize:{numColumns:T.initSize.numColumns,numRows:T.initSize.numRows},focusManager:E.focusManager}))],matrix:[Ri("config",(E,T)=>({mode:"matrix",selectors:{row:T.rowSelector,cell:"."+E.markers.item},previousSelector:T.previousSelector,focusManager:E.focusManager})),os("rowSelector"),ys("previousSelector",A.none)],menu:[ys("moveOnTab",!0),Ri("config",(E,T)=>({mode:"menu",selector:"."+E.markers.item,moveOnTab:T.moveOnTab,focusManager:E.focusManager}))]})),ns("markers",nI()),ys("fakeFocus",!1),ys("focusManager",mg()),Di("onHighlight"),Di("onDehighlight")]),iI=x("alloy.menu-focus"),iH=bm({name:"Menu",configFields:iM(),partFields:iB(),factory:(E,T,D,B)=>({uid:E.uid,dom:E.dom,markers:E.markers,behaviours:bu(E.menuBehaviours,[aZ.config({highlightClass:E.markers.selectedItem,itemClass:E.markers.item,onHighlight:E.onHighlight,onDehighlight:E.onDehighlight}),r6.config({store:{mode:"memory",initialValue:E.value}}),aW.config({find:A.some}),sQ.config(E.movement.config(E,E.movement))]),events:Hr([Ur(ii(),(E,T)=>{let D=T.event;E.getSystem().getByDom(D.target).each(D=>{aZ.highlight(E,D),T.stop(),Ir(E,iI(),{menu:E,item:D})})}),Ur(ia(),(E,T)=>{let D=T.event.item;aZ.highlight(E,D)}),Ur(ip(),(E,T)=>{let{item:D,state:B}=T.event;B&&"menuitemradio"===Ot(D.element,"role")&&((E,T)=>{let D=Xc(E.element,'[role="menuitemradio"][aria-checked="true"]');L(D,D=>{Ze(D,T.element)||E.getSystem().getByDom(D).each(E=>{s7.off(E)})})})(E,D)})]),components:T,eventOrder:E.eventOrder,domModification:{attributes:{role:"menu"}}})}),Bh=(E,T,D,B)=>be(D,B).bind(B=>be(E,B).bind(B=>{let M=Bh(E,T,D,B);return A.some([B].concat(M))})).getOr([]),Fh=E=>"prepared"===E.type?A.some(E.menu):A.none(),Ih=()=>{let E=Es({}),T=Es({}),D=Es({}),B=Ql(),M=Es({}),r=E=>a(E).bind(Fh),a=E=>be(T.get(),E),i=T=>be(E.get(),T);return{setMenuBuilt:(E,D)=>{T.set({...T.get(),[E]:{type:"prepared",menu:D}})},setContents:(er,ec,eu,eg)=>{B.set(er),E.set(eu),T.set(ec),M.set(eg);let ep=((E,T)=>{let D={};le(E,(E,T)=>{L(E,E=>{D[E]=T})});let B=de(T,(E,T)=>({k:E,v:T})),M=ce(B,(E,M)=>[M].concat(Bh(D,T,B,M)));return ce(D,E=>be(M,E).getOr([E]))})(eg,eu);D.set(ep)},expand:T=>be(E.get(),T).map(E=>{let B=be(D.get(),T).getOr([]);return[E].concat(B)}),refresh:E=>be(D.get(),E),collapse:E=>be(D.get(),E).bind(E=>E.length>1?A.some(E.slice(1)):A.none()),lookupMenu:a,lookupItem:i,otherMenus:E=>{let T=M.get();return J(eD(T),E)},getPrimary:()=>B.get().bind(r),getMenus:()=>T.get(),clear:()=>{E.set({}),T.set({}),D.set({}),B.clear()},isClear:()=>B.get().isNone(),getTriggeringPath:(T,M)=>{let er=U(i(T).toArray(),E=>r(E).isSome());return be(D.get(),T).bind(T=>{let D=K(er.concat(T));return(E=>{let T=[];for(let D=0;D<E.length;D++){let B=E[D];if(!B.isSome())return A.none();T.push(B.getOrDie())}return A.some(T)})(X(D,(T,er)=>{var ec;return(ec=D.slice(0,er+1),r(T).bind(D=>he(E.get(),(E,D)=>E===T).bind(E=>M(E).map(E=>({triggeredMenu:D,triggeringItem:E,triggeringPath:ec}))))).fold(()=>xe(B.get(),T)?[]:[A.none()],E=>[A.some(E)])}))})}}},iR=la("tiered-menu-item-highlight"),iN=la("tiered-menu-item-dehighlight");(i5=i8||(i8={}))[i5.HighlightMenuAndItem=0]="HighlightMenuAndItem",i5[i5.HighlightJustMenu=1]="HighlightJustMenu",i5[i5.HighlightNone=2]="HighlightNone";let iU=x("collapse-item"),iL=fm({name:"TieredMenu",configFields:[Ii("onExecute"),Ii("onEscape"),Fi("onOpenMenu"),Fi("onOpenSubmenu"),Di("onRepositionMenu"),Di("onCollapseMenu"),ys("highlightOnOpen",i8.HighlightMenuAndItem),ls("data",[os("primary"),os("menus"),os("expansions")]),ys("fakeFocus",!1),Di("onHighlightItem"),Di("onDehighlightItem"),Di("onHover"),Ei(),os("dom"),ys("navigateOnHover",!0),ys("stayInDom",!1),hu("tmenuBehaviours",[sQ,aZ,aW,s1]),ys("eventOrder",{})],apis:{collapseMenu:(E,T)=>{E.collapseMenu(T)},highlightPrimary:(E,T)=>{E.highlightPrimary(T)},repositionMenus:(E,T)=>{E.repositionMenus(T)}},factory:(E,T)=>{var D;let B;let M=Ql(),er=Ih(),s=E=>r6.getValue(E).value,r=T=>ce(E.data.menus,(E,T)=>X(E.items,E=>"separator"===E.type?[]:[E.data.value])),ec=aZ.highlight,i=(T,D)=>{ec(T,D),aZ.getHighlighted(D).orThunk(()=>aZ.getFirst(D)).each(B=>{E.fakeFocus?aZ.highlight(D,B):Nr(T,B.element,oO())})},l=(E,T)=>we(H(T,T=>E.lookupMenu(T).bind(E=>"prepared"===E.type?A.some(E.menu):A.none()))),c=(T,D,B)=>{let M=l(D,D.otherMenus(B));L(M,D=>{ja(D.element,[E.markers.backgroundMenu]),E.stayInDom||s1.remove(T,D)})},d=(T,D)=>{let B=M.get().getOrThunk(()=>{let D={},B=Xc(T.element,`.${E.markers.item}`),er=U(B,E=>"true"===Ot(E,"aria-haspopup"));return L(er,E=>{T.getSystem().getByDom(E).each(E=>{let T=s(E);D[T]=E})}),M.set(D),D});le(B,(E,T)=>{let B=R(D,T);kt(E.element,"aria-expanded",B)})},u=(T,D,B)=>A.from(B[0]).bind(M=>D.lookupMenu(M).bind(M=>{if("notbuilt"===M.type)return A.none();{let er=M.menu,ec=l(D,B.slice(1));return L(ec,T=>{La(T.element,E.markers.backgroundMenu)}),yt(er.element)||s1.append(T,Sa(er)),ja(er.element,[E.markers.backgroundMenu]),i(T,er),c(T,D,B),A.some(er)}}));(D=B||(B={}))[D.HighlightSubmenu=0]="HighlightSubmenu",D[D.HighlightParent=1]="HighlightParent";let g=(T,D,M=B.HighlightSubmenu)=>{if(D.hasConfigured(aq)&&aq.isDisabled(D))return A.some(D);{let ec=s(D);return er.expand(ec).bind(ec=>(d(T,ec),A.from(ec[0]).bind(eu=>er.lookupMenu(eu).bind(eg=>{let ep=((E,T,D)=>{if("notbuilt"===D.type){let B=E.getSystem().build(D.nbMenu());return er.setMenuBuilt(T,B),B}return D.menu})(T,eu,eg);return yt(ep.element)||s1.append(T,Sa(ep)),E.onOpenSubmenu(T,D,ep,K(ec)),M===B.HighlightSubmenu?(aZ.highlightFirst(ep),u(T,er,ec)):(aZ.dehighlightAll(ep),A.some(D))}))))}},p=(T,D)=>{let B=s(D);return er.collapse(B).bind(B=>(d(T,B),u(T,er,B).map(B=>(E.onCollapseMenu(T,D,B),B))))},h=T=>(D,B)=>hi(B.getSource(),`.${E.markers.item}`).bind(E=>D.getSystem().getByDom(E).toOptional().bind(E=>T(D,E).map(eh))),eu=Hr([Ur(iI(),(E,T)=>{let D=T.event.item;er.lookupItem(s(D)).each(()=>{let D=T.event.menu;aZ.highlight(E,D);let B=s(T.event.item);er.refresh(B).each(T=>c(E,er,T))})}),o1((T,D)=>{let M=D.event.target;T.getSystem().getByDom(M).each(D=>{0===s(D).indexOf("collapse-item")&&p(T,D),g(T,D,B.HighlightSubmenu).fold(()=>{E.onExecute(T,D)},b)})}),oZ((T,D)=>{(T=>{var D;let B=(D=E.data.primary,ce(E.data.menus,(B,M)=>{let r=()=>iH.sketch({...B,value:M,markers:E.markers,fakeFocus:E.fakeFocus,onHighlight:(E,T)=>{Ir(E,iR,{menuComp:E,itemComp:T})},onDehighlight:(E,T)=>{Ir(E,iN,{menuComp:E,itemComp:T})},focusManager:E.fakeFocus?gg():mg()});return M===D?{type:"prepared",menu:T.getSystem().build(r())}:{type:"notbuilt",nbMenu:r}})),M=r();return er.setContents(E.data.primary,B,E.data.expansions,M),er.getPrimary()})(T).each(D=>{s1.append(T,Sa(D)),E.onOpenMenu(T,D),E.highlightOnOpen===i8.HighlightMenuAndItem?i(T,D):E.highlightOnOpen===i8.HighlightJustMenu&&ec(T,D)})}),Ur(iR,(T,D)=>{E.onHighlightItem(T,D.event.menuComp,D.event.itemComp)}),Ur(iN,(T,D)=>{E.onDehighlightItem(T,D.event.menuComp,D.event.itemComp)}),...E.navigateOnHover?[Ur(ia(),(T,D)=>{let M=D.event.item;((E,T)=>{let D=s(T);er.refresh(D).bind(T=>(d(E,T),u(E,er,T)))})(T,M),g(T,M,B.HighlightParent),E.onHover(T,M)})]:[]]),v=E=>aZ.getHighlighted(E).bind(aZ.getHighlighted);return{uid:E.uid,dom:E.dom,markers:E.markers,behaviours:bu(E.tmenuBehaviours,[sQ.config({mode:"special",onRight:h((E,T)=>vm(T.element)?A.none():g(E,T,B.HighlightSubmenu)),onLeft:h((E,T)=>vm(T.element)?A.none():p(E,T)),onEscape:h((T,D)=>p(T,D).orThunk(()=>E.onEscape(T,D).map(()=>T))),focusIn:(E,T)=>{er.getPrimary().each(T=>{Nr(E,T.element,oO())})}}),aZ.config({highlightClass:E.markers.selectedMenu,itemClass:E.markers.menu}),aW.config({find:E=>aZ.getHighlighted(E)}),s1.config({})]),eventOrder:E.eventOrder,apis:{collapseMenu:E=>{v(E).each(T=>{p(E,T)})},highlightPrimary:E=>{er.getPrimary().each(T=>{i(E,T)})},repositionMenus:T=>{let D=er.getPrimary().bind(E=>v(T).bind(E=>{let T=s(E),D=fe(er.getMenus()),B=we(H(D,Fh));return er.getTriggeringPath(T,E=>re(B,T=>{if(!T.getSystem().isConnected())return A.none();let D=aZ.getCandidates(T);return G(D,T=>s(T)===E)}))}).map(T=>({primary:E,triggeringPath:T})));D.fold(()=>{A.from(T.components()[0]).filter(E=>"menu"===Ot(E.element,"role")).each(D=>{E.onRepositionMenu(T,D,[])})},({primary:D,triggeringPath:B})=>{E.onRepositionMenu(T,D,B)})}},events:eu}},extraApis:{tieredData:(E,T,D)=>({primary:E,menus:T,expansions:D}),singleData:(E,T)=>({primary:E,menus:Ms(E,T),expansions:{}}),collapseItem:E=>({value:la(iU()),meta:{text:E}})}}),iz=fm({name:"InlineView",configFields:[os("lazySink"),Di("onShow"),Di("onHide"),fs("onEscape"),hu("inlineBehaviours",[rq,r6,nQ]),vs("fireDismissalEventInstead",[ys("event",oG())]),vs("fireRepositionEventInstead",[ys("event",oW())]),ys("getRelated",A.none),ys("isExtraPart",ep),ys("eventOrder",A.none)],factory:(E,T)=>{let o=(T,D,B,M)=>{let er=E.lazySink(T).getOrDie();rq.openWhileCloaked(T,D,()=>rW.positionWithinBounds(er,T,B,M())),r6.setValue(T,A.some({mode:"position",config:B,getBounds:M}))},n=(T,D,B,M)=>{let er=((E,T,D,B,M)=>{let r=()=>E.lazySink(T),er="horizontal"===B.type?{layouts:{onLtr:()=>fl(),onRtl:()=>bl()}}:{},i=E=>2===E.length?er:{};return iL.sketch({dom:{tag:"div"},data:B.data,markers:B.menu.markers,highlightOnOpen:B.menu.highlightOnOpen,fakeFocus:B.menu.fakeFocus,onEscape:()=>(rq.close(T),E.onEscape.map(E=>E(T)),A.some(!0)),onExecute:()=>A.some(!0),onOpenMenu:(E,T)=>{rW.positionWithinBounds(r().getOrDie(),T,D,M())},onOpenSubmenu:(E,T,D,B)=>{let M=r().getOrDie();rW.position(M,D,{anchor:{type:"submenu",item:T,...i(B)}})},onRepositionMenu:(E,T,B)=>{let er=r().getOrDie();rW.positionWithinBounds(er,T,D,M()),L(B,E=>{let T=i(E.triggeringPath);rW.position(er,E.triggeredMenu,{anchor:{type:"submenu",item:E.triggeringItem,...T}})})}})})(E,T,D,B,M);rq.open(T,er),r6.setValue(T,A.some({mode:"menu",menu:er}))},s=T=>{rq.isOpen(T)&&r6.getValue(T).each(D=>{switch(D.mode){case"menu":rq.getState(T).each(iL.repositionMenus);break;case"position":let B=E.lazySink(T).getOrDie();rW.positionWithinBounds(B,T,D.config,D.getBounds())}})},D={setContent:(E,T)=>{rq.setContent(E,T)},showAt:(E,T,D)=>{let B=A.none;o(E,T,D,B)},showWithinBounds:o,showMenuAt:(E,T,D)=>{n(E,T,D,A.none)},showMenuWithinBounds:n,hide:E=>{rq.isOpen(E)&&(r6.setValue(E,A.none()),rq.close(E))},getContent:E=>rq.getState(E),reposition:s,isOpen:rq.isOpen};return{uid:E.uid,dom:E.dom,behaviours:bu(E.inlineBehaviours,[rq.config({isPartOf:(T,D,B)=>vi(D,B)||E.getRelated(T).exists(E=>vi(E,B)),getAttachPoint:T=>E.lazySink(T).getOrDie(),onOpen:T=>{E.onShow(T)},onClose:T=>{E.onHide(T)}}),r6.config({store:{mode:"memory",initialValue:A.none()}}),nQ.config({channels:{...Qd({isExtraPart:T.isExtraPart,...E.fireDismissalEventInstead.map(E=>({fireEventInstead:{event:E.event}})).getOr({})}),...tu({...E.fireRepositionEventInstead.map(E=>({fireEventInstead:{event:E.event}})).getOr({}),doReposition:s})}})]),eventOrder:E.eventOrder,apis:D}},apis:{showAt:(E,T,D,B)=>{E.showAt(T,D,B)},showWithinBounds:(E,T,D,B,M)=>{E.showWithinBounds(T,D,B,M)},showMenuAt:(E,T,D,B)=>{E.showMenuAt(T,D,B)},showMenuWithinBounds:(E,T,D,B,M)=>{E.showMenuWithinBounds(T,D,B,M)},hide:(E,T)=>{E.hide(T)},isOpen:(E,T)=>E.isOpen(T),getContent:(E,T)=>E.getContent(T),setContent:(E,T,D)=>{E.setContent(T,D)},reposition:(E,T)=>{E.reposition(T)}}});var iP=tinymce.util.Tools.resolve("tinymce.util.Delay");let iG=fm({name:"Button",factory:E=>{let T=mh(E.action),D=E.dom.tag,n=T=>be(E.dom,"attributes").bind(E=>be(E,T));return{uid:E.uid,dom:E.dom,components:E.components,events:T,behaviours:bu(E.buttonBehaviours,[s9.config({}),sQ.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:"button"===D?{type:n("type").getOr("button"),...n("role").map(E=>({role:E})).getOr({})}:{role:E.role.getOr(n("role").getOr("button"))}},eventOrder:E.eventOrder}},configFields:[ys("uid",void 0),os("dom"),ys("components",[]),hu("buttonBehaviours",[s9,sQ]),us("action"),us("role"),ys("eventOrder",{})]}),jh=E=>{let T=Ie(E),D=it(T),B=(E=>{let T=void 0!==E.dom.attributes?E.dom.attributes:[];return j(T,(E,T)=>"class"===T.name?E:{...E,[T.name]:T.value},{})})(T),M=Array.prototype.slice.call(T.dom.classList,0),er=0===D.length?{}:{innerHtml:ea(T)};return{tag:Ue(T),classes:M,attributes:B,...er}},Gh=E=>{let T=void 0!==E.uid&&ye(E,"uid")?E.uid:ha("memento");return{get:E=>E.getSystem().getByUid(T).getOrDie(),getOpt:E=>E.getSystem().getByUid(T).toOptional(),asSpec:()=>({...E,uid:T})}};function $h(E){return($h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(E){return typeof E}:function(E){return E&&"function"==typeof Symbol&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E})(E)}function qh(E,T){return(qh=Object.setPrototypeOf||function(E,T){return E.__proto__=T,E})(E,T)}function Xh(E,T,D){return(Xh=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(E){return!1}}()?function(E,T,D){var B=[null];B.push.apply(B,T);var M=new(Function.bind.apply(E,B));return D&&qh(M,D.prototype),M}:Reflect.construct).apply(null,arguments)}function Yh(E){return function(E){if(Array.isArray(E))return Kh(E)}(E)||function(E){if("undefined"!=typeof Symbol&&null!=E[Symbol.iterator]||null!=E["@@iterator"])return Array.from(E)}(E)||function(E,T){if(E){if("string"==typeof E)return Kh(E,T);var D=Object.prototype.toString.call(E).slice(8,-1);return"Object"===D&&E.constructor&&(D=E.constructor.name),"Map"===D||"Set"===D?Array.from(E):"Arguments"===D||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D)?Kh(E,T):void 0}}(E)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kh(E,T){(null==T||T>E.length)&&(T=E.length);for(var D=0,B=Array(T);D<T;D++)B[D]=E[D];return B}var iW=Object.hasOwnProperty,ij=Object.setPrototypeOf,iJ=Object.isFrozen,i$=Object.getPrototypeOf,iX=Object.getOwnPropertyDescriptor,iq=Object.freeze,iK=Object.seal,iY=Object.create,iZ="undefined"!=typeof Reflect&&Reflect,iQ=iZ.apply,i0=iZ.construct;iQ||(iQ=function(E,T,D){return E.apply(T,D)}),iq||(iq=function(E){return E}),iK||(iK=function(E){return E}),i0||(i0=function(E,T){return Xh(E,Yh(T))});var i1,i2,i3,i5,i9,i4,i6,i8,i7,lo=xf(Array.prototype.forEach),lr=xf(Array.prototype.pop),lc=xf(Array.prototype.push),lu=xf(String.prototype.toLowerCase),lf=xf(String.prototype.match),lb=xf(String.prototype.replace),ly=xf(String.prototype.indexOf),lA=xf(String.prototype.trim),lk=xf(RegExp.prototype.test),lS=(i7=TypeError,function(){for(var E=arguments.length,T=Array(E),D=0;D<E;D++)T[D]=arguments[D];return i0(i7,T)});function xf(E){return function(T){for(var D=arguments.length,B=Array(D>1?D-1:0),M=1;M<D;M++)B[M-1]=arguments[M];return iQ(E,T,B)}}function wf(E,T){ij&&ij(E,null);for(var D=T.length;D--;){var B=T[D];if("string"==typeof B){var M=lu(B);M!==B&&(iJ(T)||(T[D]=M),B=M)}E[B]=!0}return E}function Sf(E){var T,D=iY(null);for(T in E)iQ(iW,E,[T])&&(D[T]=E[T]);return D}function kf(E,T){for(;null!==E;){var D=iX(E,T);if(D){if(D.get)return xf(D.get);if("function"==typeof D.value)return xf(D.value)}E=i$(E)}return function(E){return console.warn("fallback value for",E),null}}var lD=iq(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),lM=iq(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),lI=iq(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),lH=iq(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),lR=iq(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),lN=iq(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),lU=iq(["#text"]),lL=iq(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),lz=iq(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),lP=iq(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),lG=iq(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),lW=iK(/\{\{[\w\W]*|[\w\W]*\}\}/gm),lj=iK(/<%[\w\W]*|[\w\W]*%>/gm),lJ=iK(/^data-[\-\w.\u00B7-\uFFFF]/),l$=iK(/^aria-[\-\w]+$/),lX=iK(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),lq=iK(/^(?:\w+script|data):/i),lK=iK(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),lY=iK(/^html$/i),lZ=function e(){var E=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,o=function(E){return e(E)};if(o.version="2.3.8",o.removed=[],!E||!E.document||9!==E.document.nodeType)return o.isSupported=!1,o;var T=E.document,D=E.document,B=E.DocumentFragment,M=E.HTMLTemplateElement,er=E.Node,ec=E.Element,eu=E.NodeFilter,eg=E.NamedNodeMap,ep=void 0===eg?E.NamedNodeMap||E.MozNamedAttrMap:eg,eh=E.HTMLFormElement,ef=E.DOMParser,ex=E.trustedTypes,ew=ec.prototype,e_=kf(ew,"cloneNode"),eD=kf(ew,"nextSibling"),eH=kf(ew,"childNodes"),eR=kf(ew,"parentNode");if("function"==typeof M){var eN=D.createElement("template");eN.content&&eN.content.ownerDocument&&(D=eN.content.ownerDocument)}var eU=function(E,T){if("object"!==$h(E)||"function"!=typeof E.createPolicy)return null;var D=null,B="data-tt-policy-suffix";T.currentScript&&T.currentScript.hasAttribute(B)&&(D=T.currentScript.getAttribute(B));var M="dompurify"+(D?"#"+D:"");try{return E.createPolicy(M,{createHTML:function(E){return E}})}catch(E){return console.warn("TrustedTypes policy "+M+" could not be created."),null}}(ex,T),eL=eU?eU.createHTML(""):"",ez=D,eP=ez.implementation,eG=ez.createNodeIterator,eW=ez.createDocumentFragment,ej=ez.getElementsByTagName,eJ=T.importNode,e$={};try{e$=Sf(D).documentMode?D.documentMode:{}}catch(E){}var eX={};o.isSupported="function"==typeof eR&&eP&&void 0!==eP.createHTMLDocument&&9!==e$;var eq,eK,eY=lX,eZ=null,eQ=wf({},[].concat(Yh(lD),Yh(lM),Yh(lI),Yh(lR),Yh(lU))),e0=null,e1=wf({},[].concat(Yh(lL),Yh(lz),Yh(lP),Yh(lG))),e2=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),e3=null,e5=null,e9=!0,e4=!0,e6=!1,e8=!1,e7=!1,tn=!1,tr=!1,th=!1,tf=!1,tx=!1,ty=!0,tw=!0,tS=!1,tO={},t_=null,tH=wf({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),tR=null,tN=wf({},["audio","video","img","source","image","track"]),tU=null,tL=wf({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),tz="http://www.w3.org/1998/Math/MathML",tP="http://www.w3.org/2000/svg",tG="http://www.w3.org/1999/xhtml",tW=tG,tj=!1,tJ=["application/xhtml+xml","text/html"],t$=null,tX=D.createElement("form"),we=function(E){return E instanceof RegExp||E instanceof Function},Se=function(E){t$&&t$===E||(E&&"object"===$h(E)||(E={}),eZ="ALLOWED_TAGS"in(E=Sf(E))?wf({},E.ALLOWED_TAGS):eQ,e0="ALLOWED_ATTR"in E?wf({},E.ALLOWED_ATTR):e1,tU="ADD_URI_SAFE_ATTR"in E?wf(Sf(tL),E.ADD_URI_SAFE_ATTR):tL,tR="ADD_DATA_URI_TAGS"in E?wf(Sf(tN),E.ADD_DATA_URI_TAGS):tN,t_="FORBID_CONTENTS"in E?wf({},E.FORBID_CONTENTS):tH,e3="FORBID_TAGS"in E?wf({},E.FORBID_TAGS):{},e5="FORBID_ATTR"in E?wf({},E.FORBID_ATTR):{},tO="USE_PROFILES"in E&&E.USE_PROFILES,e9=!1!==E.ALLOW_ARIA_ATTR,e4=!1!==E.ALLOW_DATA_ATTR,e6=E.ALLOW_UNKNOWN_PROTOCOLS||!1,e8=E.SAFE_FOR_TEMPLATES||!1,e7=E.WHOLE_DOCUMENT||!1,th=E.RETURN_DOM||!1,tf=E.RETURN_DOM_FRAGMENT||!1,tx=E.RETURN_TRUSTED_TYPE||!1,tr=E.FORCE_BODY||!1,ty=!1!==E.SANITIZE_DOM,tw=!1!==E.KEEP_CONTENT,tS=E.IN_PLACE||!1,eY=E.ALLOWED_URI_REGEXP||eY,tW=E.NAMESPACE||tG,E.CUSTOM_ELEMENT_HANDLING&&we(E.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(e2.tagNameCheck=E.CUSTOM_ELEMENT_HANDLING.tagNameCheck),E.CUSTOM_ELEMENT_HANDLING&&we(E.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(e2.attributeNameCheck=E.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),E.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof E.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(e2.allowCustomizedBuiltInElements=E.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),eK="application/xhtml+xml"===(eq=eq=-1===tJ.indexOf(E.PARSER_MEDIA_TYPE)?"text/html":E.PARSER_MEDIA_TYPE)?function(E){return E}:lu,e8&&(e4=!1),tf&&(th=!0),tO&&(eZ=wf({},Yh(lU)),e0=[],!0===tO.html&&(wf(eZ,lD),wf(e0,lL)),!0===tO.svg&&(wf(eZ,lM),wf(e0,lz),wf(e0,lG)),!0===tO.svgFilters&&(wf(eZ,lI),wf(e0,lz),wf(e0,lG)),!0===tO.mathMl&&(wf(eZ,lR),wf(e0,lP),wf(e0,lG))),E.ADD_TAGS&&(eZ===eQ&&(eZ=Sf(eZ)),wf(eZ,E.ADD_TAGS)),E.ADD_ATTR&&(e0===e1&&(e0=Sf(e0)),wf(e0,E.ADD_ATTR)),E.ADD_URI_SAFE_ATTR&&wf(tU,E.ADD_URI_SAFE_ATTR),E.FORBID_CONTENTS&&(t_===tH&&(t_=Sf(t_)),wf(t_,E.FORBID_CONTENTS)),tw&&(eZ["#text"]=!0),e7&&wf(eZ,["html","head","body"]),eZ.table&&(wf(eZ,["tbody"]),delete e3.tbody),iq&&iq(E),t$=E)},tq=wf({},["mi","mo","mn","ms","mtext"]),tK=wf({},["foreignobject","desc","title","annotation-xml"]),tY=wf({},["title","style","font","a","script"]),tZ=wf({},lM);wf(tZ,lI),wf(tZ,lH);var tQ=wf({},lR);wf(tQ,lN);var Ee=function(E){lc(o.removed,{element:E});try{E.parentNode.removeChild(E)}catch(T){try{E.outerHTML=eL}catch(T){E.remove()}}},Ae=function(E,T){try{lc(o.removed,{attribute:T.getAttributeNode(E),from:T})}catch(E){lc(o.removed,{attribute:null,from:T})}if(T.removeAttribute(E),"is"===E&&!e0[E]){if(th||tf)try{Ee(T)}catch(E){}else try{T.setAttribute(E,"")}catch(E){}}},Me=function(E){if(tr)E="<remove></remove>"+E;else{var T,B,M=lf(E,/^[\r\n\t ]+/);B=M&&M[0]}"application/xhtml+xml"===eq&&(E='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+E+"</body></html>");var er=eU?eU.createHTML(E):E;if(tW===tG)try{T=(new ef).parseFromString(er,eq)}catch(E){}if(!T||!T.documentElement){T=eP.createDocument(tW,"template",null);try{T.documentElement.innerHTML=tj?"":er}catch(E){}}var ec=T.body||T.documentElement;return E&&B&&ec.insertBefore(D.createTextNode(B),ec.childNodes[0]||null),tW===tG?ej.call(T,e7?"html":"body")[0]:e7?T.documentElement:ec},De=function(E){return eG.call(E.ownerDocument||E,E,eu.SHOW_ELEMENT|eu.SHOW_COMMENT|eu.SHOW_TEXT,null,!1)},Be=function(E){return"object"===$h(er)?E instanceof er:E&&"object"===$h(E)&&"number"==typeof E.nodeType&&"string"==typeof E.nodeName},Fe=function(E,T,D){eX[E]&&lo(eX[E],function(E){E.call(o,T,D,t$)})},Ie=function(E){if(Fe("beforeSanitizeElements",E,null),E instanceof eh&&("string"!=typeof E.nodeName||"string"!=typeof E.textContent||"function"!=typeof E.removeChild||!(E.attributes instanceof ep)||"function"!=typeof E.removeAttribute||"function"!=typeof E.setAttribute||"string"!=typeof E.namespaceURI||"function"!=typeof E.insertBefore)||lk(/[\u0080-\uFFFF]/,E.nodeName))return Ee(E),!0;var T,D,B,M,er=eK(E.nodeName);if(Fe("uponSanitizeElement",E,{tagName:er,allowedTags:eZ}),E.hasChildNodes()&&!Be(E.firstElementChild)&&(!Be(E.content)||!Be(E.content.firstElementChild))&&lk(/<[/\w]/g,E.innerHTML)&&lk(/<[/\w]/g,E.textContent)||"select"===er&&lk(/<template/i,E.innerHTML))return Ee(E),!0;if(!eZ[er]||e3[er]){if(!e3[er]&&Ne(er)&&(e2.tagNameCheck instanceof RegExp&&lk(e2.tagNameCheck,er)||e2.tagNameCheck instanceof Function&&e2.tagNameCheck(er)))return!1;if(tw&&!t_[er]){var eu=eR(E)||E.parentNode,eg=eH(E)||E.childNodes;if(eg&&eu)for(var ef=eg.length-1;ef>=0;--ef)eu.insertBefore(e_(eg[ef],!0),eD(E))}return Ee(E),!0}return!(E instanceof ec)||((T=eR(E))&&T.tagName||(T={namespaceURI:tG,tagName:"template"}),D=lu(E.tagName),B=lu(T.tagName),E.namespaceURI===tP?T.namespaceURI===tG?"svg"===D:T.namespaceURI===tz?"svg"===D&&("annotation-xml"===B||tq[B]):tZ[D]:E.namespaceURI===tz?T.namespaceURI===tG?"math"===D:T.namespaceURI===tP?"math"===D&&tK[B]:tQ[D]:E.namespaceURI===tG&&(T.namespaceURI!==tP||tK[B])&&(T.namespaceURI!==tz||tq[B])&&!tQ[D]&&(tY[D]||!tZ[D]))?("noscript"===er||"noembed"===er)&&lk(/<\/no(script|embed)/i,E.innerHTML)?(Ee(E),!0):(e8&&3===E.nodeType&&(M=lb(M=E.textContent,lW," "),M=lb(M,lj," "),E.textContent!==M&&(lc(o.removed,{element:E.cloneNode()}),E.textContent=M)),Fe("afterSanitizeElements",E,null),!1):(Ee(E),!0)},Re=function(E,T,B){if(ty&&("id"===T||"name"===T)&&(B in D||B in tX))return!1;if(e4&&!e5[T]&&lk(lJ,T));else if(e9&&lk(l$,T));else if(!e0[T]||e5[T]){if(!(Ne(E)&&(e2.tagNameCheck instanceof RegExp&&lk(e2.tagNameCheck,E)||e2.tagNameCheck instanceof Function&&e2.tagNameCheck(E))&&(e2.attributeNameCheck instanceof RegExp&&lk(e2.attributeNameCheck,T)||e2.attributeNameCheck instanceof Function&&e2.attributeNameCheck(T))||"is"===T&&e2.allowCustomizedBuiltInElements&&(e2.tagNameCheck instanceof RegExp&&lk(e2.tagNameCheck,B)||e2.tagNameCheck instanceof Function&&e2.tagNameCheck(B))))return!1}else if(tU[T]);else if(lk(eY,lb(B,lK,"")));else if("src"!==T&&"xlink:href"!==T&&"href"!==T||"script"===E||0!==ly(B,"data:")||!tR[E]){if(e6&&!lk(lq,lb(B,lK,"")));else if(B)return!1}return!0},Ne=function(E){return E.indexOf("-")>0},Ve=function(E){Fe("beforeSanitizeAttributes",E,null);var T,D,B,M,er=E.attributes;if(er){var ec={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:e0};for(M=er.length;M--;){var eu=T=er[M],eg=eu.name,ep=eu.namespaceURI;D="value"===eg?T.value:lA(T.value),B=eK(eg);var eh=D;if(ec.attrName=B,ec.attrValue=D,ec.keepAttr=!0,ec.forceKeepAttr=void 0,Fe("uponSanitizeAttribute",E,ec),D=ec.attrValue,!ec.forceKeepAttr){if(ec.keepAttr){if(lk(/\/>/i,D))Ae(eg,E);else if(e8&&(D=lb(D,lW," "),D=lb(D,lj," ")),Re(eK(E.nodeName),B,D)){if(D!==eh)try{ep?E.setAttributeNS(ep,eg,D):E.setAttribute(eg,D)}catch(T){Ae(eg,E)}}else Ae(eg,E)}else Ae(eg,E)}}Fe("afterSanitizeAttributes",E,null)}},ze=function e(E){var T,D=De(E);for(Fe("beforeSanitizeShadowDOM",E,null);T=D.nextNode();)Fe("uponSanitizeShadowNode",T,null),Ie(T)||(T.content instanceof B&&e(T.content),Ve(T));Fe("afterSanitizeShadowDOM",E,null)};return o.sanitize=function(D,M){if((tj=!D)&&(D="<!-->"),"string"!=typeof D&&!Be(D)){if("function"!=typeof D.toString)throw lS("toString is not a function");if("string"!=typeof(D=D.toString()))throw lS("dirty is not a string, aborting")}if(!o.isSupported){if("object"===$h(E.toStaticHTML)||"function"==typeof E.toStaticHTML){if("string"==typeof D)return E.toStaticHTML(D);if(Be(D))return E.toStaticHTML(D.outerHTML)}return D}if(tn||Se(M),o.removed=[],"string"==typeof D&&(tS=!1),tS){if(D.nodeName){var ec,eu,eg,ep,eh,ef=eK(D.nodeName);if(!eZ[ef]||e3[ef])throw lS("root node is forbidden and cannot be sanitized in-place")}}else if(D instanceof er)1===(eu=(ec=Me("<!---->")).ownerDocument.importNode(D,!0)).nodeType&&"BODY"===eu.nodeName||"HTML"===eu.nodeName?ec=eu:ec.appendChild(eu);else{if(!th&&!e8&&!e7&&-1===D.indexOf("<"))return eU&&tx?eU.createHTML(D):D;if(!(ec=Me(D)))return th?null:tx?eL:""}ec&&tr&&Ee(ec.firstChild);for(var ex=De(tS?D:ec);eg=ex.nextNode();)3===eg.nodeType&&eg===ep||Ie(eg)||(eg.content instanceof B&&ze(eg.content),Ve(eg),ep=eg);if(ep=null,tS)return D;if(th){if(tf)for(eh=eW.call(ec.ownerDocument);ec.firstChild;)eh.appendChild(ec.firstChild);else eh=ec;return e0.shadowroot&&(eh=eJ.call(T,eh,!0)),eh}var ew=e7?ec.outerHTML:ec.innerHTML;return e7&&eZ["!doctype"]&&ec.ownerDocument&&ec.ownerDocument.doctype&&ec.ownerDocument.doctype.name&&lk(lY,ec.ownerDocument.doctype.name)&&(ew="<!DOCTYPE "+ec.ownerDocument.doctype.name+">\n"+ew),e8&&(ew=lb(ew,lW," "),ew=lb(ew,lj," ")),eU&&tx?eU.createHTML(ew):ew},o.setConfig=function(E){Se(E),tn=!0},o.clearConfig=function(){t$=null,tn=!1},o.isValidAttribute=function(E,T,D){return t$||Se({}),Re(eK(E),eK(T),D)},o.addHook=function(E,T){"function"==typeof T&&(eX[E]=eX[E]||[],lc(eX[E],T))},o.removeHook=function(E){if(eX[E])return lr(eX[E])},o.removeHooks=function(E){eX[E]&&(eX[E]=[])},o.removeAllHooks=function(){eX={}},o}();let Gf=E=>lZ().sanitize(E);var lQ=tinymce.util.Tools.resolve("tinymce.util.I18n");let l0={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},l1="temporary-placeholder",Yf=E=>()=>be(E,l1).getOr("!not found!"),Kf=(E,T)=>{let D=E.toLowerCase();if(lQ.isRtl()){var B;let E=Ae(D,B="-rtl")?D:D+B;return ve(T,E)?E:D}return D},Jf=(E,T)=>be(T,Kf(E,T)),Zf=(E,T)=>{let D=T();return Jf(E,D).getOrThunk(Yf(D))},Qf=()=>Jp("add-focusable",[oZ(E=>{gi(E.element,"svg").each(E=>kt(E,"focusable","false"))})]),eb=(E,T,D,B)=>{var M,er;let ec=lQ.isRtl()&&ve(l0,T)?["tox-icon--flip"]:[],eu=be(D,Kf(T,D)).or(B).getOrThunk(Yf(D));return{dom:{tag:E.tag,attributes:null!==(M=E.attributes)&&void 0!==M?M:{},classes:E.classes.concat(ec),innerHtml:eu},behaviours:kl([...null!==(er=E.behaviours)&&void 0!==er?er:[],Qf()])}},tb=(E,T,D,B=A.none())=>eb(T,E,D(),B),l2={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},l3=fm({name:"Notification",factory:E=>{let T=Gh({dom:jh(`<p>${Gf(E.translationProvider(E.text))}</p>`),behaviours:kl([s1.config({})])}),o=E=>({dom:{tag:"div",classes:["tox-bar"],styles:{width:`${E}%`}}}),n=E=>({dom:{tag:"div",classes:["tox-text"],innerHtml:`${E}%`}}),D=Gh({dom:{tag:"div",classes:E.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[o(0)]},n(0)],behaviours:kl([s1.config({})])}),B=q([E.icon.toArray(),E.level.toArray(),E.level.bind(E=>A.from(l2[E])).toArray()]),M=Gh(iG.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[tb("close",{tag:"span",classes:["tox-icon"],attributes:{"aria-label":E.translationProvider("Close")}},E.iconProvider)],action:T=>{E.onAction(T)}})),er=((E,T,D)=>{let B=D(),M=G(E,E=>ve(B,Kf(E,B)));return eb({tag:"div",classes:["tox-notification__icon"]},M.getOr(l1),B,A.none())})(B,0,E.iconProvider),ec=[er,{dom:{tag:"div",classes:["tox-notification__body"]},components:[T.asSpec()],behaviours:kl([s1.config({})])}];return{uid:E.uid,dom:{tag:"div",attributes:{role:"alert"},classes:E.level.map(E=>["tox-notification","tox-notification--in",`tox-notification--${E}`]).getOr(["tox-notification","tox-notification--in"])},behaviours:kl([s9.config({}),Jp("notification-events",[Ur(t3(),E=>{M.getOpt(E).each(s9.focus)})])]),components:ec.concat(E.progress?[D.asSpec()]:[]).concat(E.closeButton?[M.asSpec()]:[]),apis:{updateProgress:(E,T)=>{E.getSystem().isConnected()&&D.getOpt(E).each(E=>{s1.set(E,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[o(T)]},n(T)])})},updateText:(E,D)=>{if(E.getSystem().isConnected()){let B=T.get(E);s1.set(B,[ti(D)])}}}}},configFields:[us("level"),os("progress"),us("icon"),os("onAction"),os("text"),os("iconProvider"),os("translationProvider"),Cs("closeButton",!0)],apis:{updateProgress:(E,T,D)=>{E.updateProgress(T,D)},updateText:(E,T,D)=>{E.updateText(T,D)}}});var l5,l9,l4=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),l6=tinymce.util.Tools.resolve("tinymce.EditorManager"),l8=tinymce.util.Tools.resolve("tinymce.Env");(hN=l5||(l5={})).default="wrap",hN.floating="floating",hN.sliding="sliding",hN.scrolling="scrolling",(hU=l9||(l9={})).auto="auto",hU.top="top",hU.bottom="bottom";let cb=E=>T=>T.options.get(E),db=E=>T=>A.from(E(T)),ub=E=>{let D=l8.deviceType.isPhone(),M=l8.deviceType.isTablet()||D,ec=E.options.register,s=E=>T(E)||!1===E,a=E=>T(E)||eg(E);ec("skin",{processor:E=>T(E)||!1===E,default:"oxide"}),ec("skin_url",{processor:"string"}),ec("height",{processor:a,default:Math.max(E.getElement().offsetHeight,400)}),ec("width",{processor:a,default:l4.DOM.getStyle(E.getElement(),"width")}),ec("min_height",{processor:"number",default:100}),ec("min_width",{processor:"number"}),ec("max_height",{processor:"number"}),ec("max_width",{processor:"number"}),ec("style_formats",{processor:"object[]"}),ec("style_formats_merge",{processor:"boolean",default:!1}),ec("style_formats_autohide",{processor:"boolean",default:!1}),ec("line_height_formats",{processor:"string",default:"1 1.1 1.2 1.3 1.4 1.5 2"}),ec("font_family_formats",{processor:"string",default:"Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats"}),ec("font_size_formats",{processor:"string",default:"8pt 10pt 12pt 14pt 18pt 24pt 36pt"}),ec("font_size_input_default_unit",{processor:"string",default:"pt"}),ec("block_formats",{processor:"string",default:"Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre"}),ec("content_langs",{processor:"object[]"}),ec("removed_menuitems",{processor:"string",default:""}),ec("menubar",{processor:E=>T(E)||er(E),default:!D}),ec("menu",{processor:"object",default:{}}),ec("toolbar",{processor:E=>er(E)||T(E)||B(E)?{value:E,valid:!0}:{valid:!1,message:"Must be a boolean, string or array."},default:!0}),V(9,E=>{ec("toolbar"+(E+1),{processor:"string"})}),ec("toolbar_mode",{processor:"string",default:M?"scrolling":"floating"}),ec("toolbar_groups",{processor:"object",default:{}}),ec("toolbar_location",{processor:"string",default:l9.auto}),ec("toolbar_persist",{processor:"boolean",default:!1}),ec("toolbar_sticky",{processor:"boolean",default:E.inline}),ec("toolbar_sticky_offset",{processor:"number",default:0}),ec("fixed_toolbar_container",{processor:"string",default:""}),ec("fixed_toolbar_container_target",{processor:"object"}),ec("ui_mode",{processor:"string",default:"combined"}),ec("file_picker_callback",{processor:"function"}),ec("file_picker_validator_handler",{processor:"function"}),ec("file_picker_types",{processor:"string"}),ec("typeahead_urls",{processor:"boolean",default:!0}),ec("anchor_top",{processor:s,default:"#top"}),ec("anchor_bottom",{processor:s,default:"#bottom"}),ec("draggable_modal",{processor:"boolean",default:!1}),ec("statusbar",{processor:"boolean",default:!0}),ec("elementpath",{processor:"boolean",default:!0}),ec("branding",{processor:"boolean",default:!0}),ec("promotion",{processor:"boolean",default:!0}),ec("resize",{processor:E=>"both"===E||er(E),default:!l8.deviceType.isTouch()}),ec("sidebar_show",{processor:"string"}),ec("help_accessibility",{processor:"boolean",default:E.hasPlugin("help")})},l7=cb("readonly"),co=cb("height"),cr=cb("width"),ca=db(cb("min_width")),cc=db(cb("min_height")),cg=db(cb("max_width")),ch=db(cb("max_height")),cf=db(cb("style_formats")),cx=cb("style_formats_merge"),cy=cb("style_formats_autohide"),cA=cb("content_langs"),ck=cb("removed_menuitems"),cS=cb("toolbar_mode"),c_=cb("toolbar_groups"),cT=cb("toolbar_location"),cD=cb("fixed_toolbar_container"),cM=cb("fixed_toolbar_container_target"),cH=cb("toolbar_persist"),cR=cb("toolbar_sticky_offset"),cN=cb("menubar"),cU=cb("toolbar"),cL=cb("file_picker_callback"),cz=cb("file_picker_validator_handler"),cP=cb("font_size_input_default_unit"),cG=cb("file_picker_types"),cW=cb("typeahead_urls"),cj=cb("anchor_top"),cJ=cb("anchor_bottom"),c$=cb("draggable_modal"),cX=cb("statusbar"),cq=cb("elementpath"),cK=cb("branding"),cY=cb("resize"),cZ=cb("paste_as_text"),cQ=cb("sidebar_show"),c0=cb("promotion"),c1=cb("help_accessibility"),Yb=E=>!1===E.options.get("skin"),Kb=E=>!1!==E.options.get("menubar"),Jb=E=>{let T=E.options.get("skin_url");if(Yb(E))return T;if(T)return E.documentBaseURI.toAbsolute(T);{let T=E.options.get("skin");return l6.baseURL+"/skins/ui/"+T}},Zb=E=>E.options.get("line_height_formats").split(" "),Qb=E=>{let D=cU(E),M=T(D),er=B(D)&&D.length>0;return!tv(E)&&(er||M||!0===D)},ev=E=>{let D=V(9,T=>E.options.get("toolbar"+(T+1))),B=U(D,T);return Ce(B.length>0,B)},tv=E=>ev(E).fold(()=>{let D=cU(E);return f(D,T)&&D.length>0},eh),ov=E=>cT(E)===l9.bottom,nv=E=>{var T;if(!E.inline)return A.none();let D=null!==(T=cD(E))&&void 0!==T?T:"";if(D.length>0)return pi(xt(),D);let B=cM(E);return g(B)?A.some(Fe(B)):A.none()},sv=E=>E.inline&&nv(E).isSome(),rv=E=>nv(E).getOrThunk(()=>ft(eJ(Fe(E.getElement())))),av=E=>E.inline&&!Kb(E)&&!Qb(E)&&!tv(E),iv=E=>(E.options.get("toolbar_sticky")||E.inline)&&!sv(E)&&!av(E),lv=E=>!sv(E)&&"split"===E.options.get("ui_mode"),cv=E=>{let T=E.options.get("menu");return ce(T,E=>({...E,items:E.items}))};var c2=Object.freeze({__proto__:null,get ToolbarMode(){return l5},get ToolbarLocation(){return l9},register:ub,getSkinUrl:Jb,isReadOnly:l7,isSkinDisabled:Yb,getHeightOption:co,getWidthOption:cr,getMinWidthOption:ca,getMinHeightOption:cc,getMaxWidthOption:cg,getMaxHeightOption:ch,getUserStyleFormats:cf,shouldMergeStyleFormats:cx,shouldAutoHideStyleFormats:cy,getLineHeightFormats:Zb,getContentLanguages:cA,getRemovedMenuItems:ck,isMenubarEnabled:Kb,isMultipleToolbars:tv,isToolbarEnabled:Qb,isToolbarPersist:cH,getMultipleToolbarsOption:ev,getUiContainer:rv,useFixedContainer:sv,isSplitUiMode:lv,getToolbarMode:cS,isDraggableModal:c$,isDistractionFree:av,isStickyToolbar:iv,getStickyToolbarOffset:cR,getToolbarLocation:cT,isToolbarLocationBottom:ov,getToolbarGroups:c_,getMenus:cv,getMenubar:cN,getToolbar:cU,getFilePickerCallback:cL,getFilePickerTypes:cG,useTypeaheadUrls:cW,getAnchorTop:cj,getAnchorBottom:cJ,getFilePickerValidatorHandler:cz,getFontSizeInputDefaultUnit:cP,useStatusBar:cX,useElementPath:cq,promotionEnabled:c0,useBranding:cK,getResize:cY,getPasteAsText:cZ,getSidebarShow:cQ,useHelpAccessibility:c1});let c3="[data-mce-autocompleter]",mv=E=>hi(E,c3);(hL=hP||(hP={}))[hL.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",hL[hL.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var c5=hP;let c9="tox-menu-nav__js",c4="tox-collection__item",c6="tox-swatch",c8={normal:c9,color:c6},c7="tox-collection__item--enabled",dn="tox-collection__item-icon",dr="tox-collection__item-label",da="tox-collection__item-caret",du="tox-collection__item--active",dm="tox-collection__item-container",dh="tox-collection__item-container--row",_v=E=>be(c8,E).getOr(c9),Tv=E=>"color"===E?"tox-swatches":"tox-menu",Ev=E=>({backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:Tv(E),tieredMenu:"tox-tiered-menu"}),Av=E=>{let T=Ev(E);return{backgroundMenu:T.backgroundMenu,selectedMenu:T.selectedMenu,menu:T.menu,selectedItem:T.selectedItem,item:_v(E)}},Mv=(E,T,D)=>{let B=Ev(D);return{tag:"div",classes:q([[B.menu,`tox-menu-${T}-column`],E?[B.hasIcons]:[]])}},df=[iH.parts.items({})],Bv=(E,T,D)=>{let B=Ev(D);return{dom:{tag:"div",classes:q([[B.tieredMenu]])},markers:Av(D)}},dv=x([us("data"),ys("inputAttributes",{}),ys("inputStyles",{}),ys("tag","input"),ys("inputClasses",[]),Di("onSetValue"),ys("styles",{}),ys("eventOrder",{}),hu("inputBehaviours",[r6,s9]),ys("selectOnFocus",!0)]),Iv=E=>kl([s9.config({onFocus:E.selectOnFocus?E=>{let T=E.element,D=$a(T);T.dom.setSelectionRange(0,D.length)}:b})]),Rv=E=>({...Iv(E),...bu(E.inputBehaviours,[r6.config({store:{mode:"manual",...E.data.map(E=>({initialValue:E})).getOr({}),getValue:E=>$a(E.element),setValue:(E,T)=>{$a(E.element)!==T&&qa(E.element,T)}},onSetValue:E.onSetValue})])}),Nv=E=>({tag:E.tag,attributes:{type:"text",...E.inputAttributes},styles:E.inputStyles,classes:E.inputClasses}),dx=fm({name:"Input",configFields:dv(),factory:(E,T)=>({uid:E.uid,dom:Nv(E),components:[],behaviours:Rv(E),eventOrder:E.eventOrder})}),dy=la("refetch-trigger-event"),dA=la("redirect-menu-item-interaction"),dk="tox-menu__searcher",Pv=E=>pi(E.element,`.${dk}`).bind(T=>E.getSystem().getByDom(T).toOptional()),Wv=E=>({fetchPattern:r6.getValue(E),selectionStart:E.element.dom.selectionStart,selectionEnd:E.element.dom.selectionEnd}),jv=E=>{let t=(E,T)=>(T.cut(),A.none()),o=(E,T)=>{let D={interactionEvent:T.event,eventType:T.event.raw.type};return Ir(E,dA,D),A.some(!0)},T="searcher-events";return{dom:{tag:"div",classes:[c4]},components:[dx.sketch({inputClasses:[dk,"tox-textfield"],inputAttributes:{...E.placeholder.map(T=>({placeholder:E.i18n(T)})).getOr({}),type:"search","aria-autocomplete":"list"},inputBehaviours:kl([Jp(T,[Ur(t6(),E=>{Fr(E,dy)}),Ur(t9(),(E,T)=>{"Escape"===T.event.raw.key&&T.stop()})]),sQ.config({mode:"special",onLeft:t,onRight:t,onSpace:t,onEnter:o,onEscape:o,onUp:o,onDown:o})]),eventOrder:{keydown:[T,sQ.name()]}})]}},dS="tox-collection--results__js",$v=E=>{var T;return E.dom?{...E,dom:{...E.dom,attributes:{...null!==(T=E.dom.attributes)&&void 0!==T?T:{},id:la("aria-item-search-result-id"),"aria-selected":"false"}}}:E},qv=(E,T)=>D=>{let B=z(D,T);return H(B,T=>({dom:E,components:T}))},Xv=(E,T)=>{let D=[],B=[];return L(E,(E,M)=>{T(E,M)?(B.length>0&&D.push(B),B=[],(ve(E.dom,"innerHtml")||E.components&&E.components.length>0)&&B.push(E)):B.push(E)}),B.length>0&&D.push(B),H(D,E=>({dom:{tag:"div",classes:["tox-collection__group"]},components:E}))},Yv=(E,T,D)=>iH.parts.items({preprocess:B=>{let M=H(B,D);return"auto"!==E&&E>1?qv({tag:"div",classes:["tox-collection__group"]},E)(M):Xv(M,(E,D)=>"separator"===T[D].type)}}),Kv=(E,T,D=!0)=>({dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===E?["tox-collection--list"]:["tox-collection--grid"])},components:[Yv(E,T,w)]}),Jv=E=>N(E,E=>"icon"in E&&void 0!==E.icon),Zv=E=>(console.error(Kn(E)),console.log(E),A.none()),Qv=(E,T,D,B,M)=>{let er={dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[iH.parts.items({preprocess:E=>Xv(E,(E,T)=>"separator"===D[T].type)})]};return{value:E,dom:er.dom,components:er.components,items:D}},ey=(E,T,D,B,M)=>{if("color"===M.menuType){let T={dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[iH.parts.items({preprocess:"auto"!==B?qv({tag:"div",classes:["tox-swatches__row"]},B):w})]}]};return{value:E,dom:T.dom,components:T.components,items:D}}if("normal"===M.menuType&&"auto"===B){let T=Kv(B,D);return{value:E,dom:T.dom,components:T.components,items:D}}if("normal"===M.menuType||"searchable"===M.menuType){let T="searchable"!==M.menuType?Kv(B,D):"search-with-field"===M.searchMode.searchMode?((E,T,D)=>{let B=la("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===E?["tox-collection--list"]:["tox-collection--grid"])},components:[jv({i18n:lQ.translate,placeholder:D.placeholder}),{dom:{tag:"div",classes:[...1===E?["tox-collection--list"]:["tox-collection--grid"],dS],attributes:{id:B}},components:[Yv(E,T,$v)]}]}})(B,D,M.searchMode):((E,T,D=!0)=>{let B=la("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection",dS].concat(1===E?["tox-collection--list"]:["tox-collection--grid"]),attributes:{id:B}},components:[Yv(E,T,$v)]}})(B,D);return{value:E,dom:T.dom,components:T.components,items:D}}if("listpreview"===M.menuType&&"auto"!==B){let T={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[iH.parts.items({preprocess:qv({tag:"div",classes:["tox-collection__group"]},B)})]};return{value:E,dom:T.dom,components:T.components,items:D}}return{value:E,dom:Mv(T,B,M.menuType),components:df,items:D}},dO=rs("type"),d_=rs("name"),dD=rs("label"),dM=rs("text"),dH=rs("title"),dR=rs("icon"),dN=rs("value"),dU=is("fetch"),dL=is("getSubmenuItems"),dz=is("onAction"),dP=is("onItemAction"),dG=Os("onSetup",()=>b),dW=ps("name"),dj=ps("text"),dJ=ps("icon"),d$=ps("tooltip"),dX=ps("label"),dq=ps("shortcut"),dK=fs("select"),dY=Cs("active",!1),dZ=Cs("borderless",!1),dQ=Cs("enabled",!0),d0=Cs("primary",!1),Cy=E=>ys("columns",E),d1=ys("meta",{}),d2=Os("onAction",b),Ty=E=>Ss("type",E),Ey=E=>gn("name","name",vn(()=>la(`${E}-name`)),tG),d3=Dn([dO,dj]),d5=Dn([Ty("autocompleteitem"),dY,dQ,d1,dN,dj,dJ]),d9=[dQ,d$,dJ,dj,dG],d4=Dn([dO,dz].concat(d9)),Fy=E=>qn("toolbarbutton",d4,E),d6=[dY].concat(d9),d8=Dn(d6.concat([dO,dz])),Ny=E=>qn("ToggleButton",d8,E),d7=[Os("predicate",ep),ks("scope","node",["node","editor"]),ks("position","selection",["node","selection","line"])],uo=d9.concat([Ty("contextformbutton"),d0,dz,es("original",w)]),un=d6.concat([Ty("contextformbutton"),d0,dz,es("original",w)]),ur=d9.concat([Ty("contextformbutton")]),ua=d6.concat([Ty("contextformtogglebutton")]),uu=Jn("type",{contextformbutton:uo,contextformtogglebutton:un}),uf=Dn([Ty("contextform"),Os("initValue",x("")),dX,ds("commands",uu),ms("launch",Jn("type",{contextformbutton:ur,contextformtogglebutton:ua}))].concat(d7)),uv=Dn([Ty("contexttoolbar"),rs("items")].concat(d7)),ux=[dO,rs("src"),ps("alt"),_s("classes",[],tG)],uy=Dn(ux),uA=[dO,dM,dW,_s("classes",["tox-collection__item-label"],tG)],uS=Dn(uA),uO=En(()=>jn("type",{cardimage:uy,cardtext:uS,cardcontainer:u_})),u_=Dn([dO,Ss("direction","horizontal"),Ss("align","left"),Ss("valign","middle"),ds("items",uO)]),uT=[dQ,dj,dq,gn("value","value",vn(()=>la("menuitem-value")),tz()),d1],uD=Dn([dO,dX,ds("items",uO),dG,d2].concat(uT)),uH=Dn([dO,dY,dJ].concat(uT)),uR=[dO,rs("fancytype"),d2],uN=[ys("initData",{})].concat(uR),uU=[fs("select"),Ts("initData",{},[Cs("allowCustomColors",!0),Ss("storageKey","default"),bs("colors",tz())])].concat(uR),uL=Jn("fancytype",{inserttable:uN,colorswatch:uU}),uz=Dn([dO,dG,d2,dJ].concat(uT)),uP=Dn([dO,dL,dG,dJ].concat(uT)),uG=Dn([dO,dJ,dY,dG,dz].concat(uT)),ix=(E,T,D)=>{let B=Xc(E.element,"."+D);if(B.length>0){let E=$(B,E=>{let D=E.dom.getBoundingClientRect().top,M=B[0].dom.getBoundingClientRect().top;return Math.abs(D-M)>T}).getOr(B.length);return A.some({numColumns:E,numRows:Math.ceil(B.length/E)})}return A.none()},lx=E=>kl([Jp(la("unnamed-events"),E)]),uW=la("tooltip.exclusive"),uj=la("tooltip.show"),uJ=la("tooltip.hide"),mx=(E,T,D)=>{E.getSystem().broadcastOn([uW],{})};var u$=Object.freeze({__proto__:null,hideAllExclusive:mx,setComponents:(E,T,D,B)=>{D.getTooltip().each(E=>{E.getSystem().isConnected()&&s1.set(E,B)})}}),uX=Object.freeze({__proto__:null,events:(E,T)=>{let o=D=>{T.getTooltip().each(B=>{Bd(B),E.onHide(D,B),T.clearTooltip()}),T.clearTimer()};return Hr(q([[Ur(uj,D=>{T.resetTimer(()=>{(D=>{if(!T.isShowing()){mx(D);let B=E.lazySink(D).getOrDie(),M=D.getSystem().build({dom:E.tooltipDom,components:E.tooltipComponents,events:Hr("normal"===E.mode?[Ur(t2(),E=>{Fr(D,uj)}),Ur(t0(),E=>{Fr(D,uJ)})]:[]),behaviours:kl([s1.config({})])});T.setTooltip(M),Ad(B,M),E.onShow(D,M),rW.position(B,M,{anchor:E.anchor(D)})}})(D)},E.delay)}),Ur(uJ,D=>{T.resetTimer(()=>{o(D)},E.delay)}),Ur(ok(),(E,T)=>{T.universal||R(T.channels,uW)&&o(E)}),oQ(E=>{o(E)})],"normal"===E.mode?[Ur(t3(),E=>{Fr(E,uj)}),Ur(oy(),E=>{Fr(E,uJ)}),Ur(t2(),E=>{Fr(E,uj)}),Ur(t0(),E=>{Fr(E,uJ)})]:[Ur(oK(),(E,T)=>{Fr(E,uj)}),Ur(oY(),E=>{Fr(E,uJ)})]]))}}),uq=[os("lazySink"),os("tooltipDom"),ys("exclusive",!0),ys("tooltipComponents",[]),ys("delay",300),ks("mode","normal",["normal","follow-highlight"]),ys("anchor",E=>({type:"hotspot",hotspot:E,layouts:{onLtr:x([cl,ll,sl,al,rl,il]),onRtl:x([cl,ll,sl,al,rl,il])}})),Di("onHide"),Di("onShow")],uK=Object.freeze({__proto__:null,init:()=>{let E=Ql(),T=Ql(),o=()=>{E.on(clearTimeout)},D=x("not-implemented");return _a({getTooltip:T.get,isShowing:T.isSet,setTooltip:T.set,clearTooltip:T.clear,clearTimer:o,resetTimer:(T,D)=>{o(),E.set(setTimeout(T,D))},readState:D})}});let uY=Ol({fields:uq,name:"tooltipping",active:uX,state:uK,apis:u$}),uZ="silver.readonly",uQ=Dn([ns("readonly",tW)]),xx=(E,T)=>{let D=E.mainUi.outerContainer.element,B=[E.mainUi.mothership,...E.uiMotherships];T&&L(B,E=>{E.broadcastOn([rK()],{target:D})}),L(B,E=>{E.broadcastOn([uZ],{readonly:T})})},wx=(E,T)=>{E.on("init",()=>{E.mode.isReadOnly()&&xx(T,!0)}),E.on("SwitchMode",()=>xx(T,E.mode.isReadOnly())),l7(E)&&E.mode.set("readonly")},Sx=()=>nQ.config({channels:{[uZ]:{schema:uQ,onReceive:(E,T)=>{aq.set(E,T.readonly)}}}}),kx=E=>aq.config({disabled:E}),Cx=E=>aq.config({disabled:E,disableClass:"tox-tbtn--disabled"}),Ox=E=>aq.config({disabled:E,disableClass:"tox-tbtn--disabled",useNative:!1}),_x=(E,T)=>{let D=E.getApi(T);return E=>{E(D)}},Tx=(E,T)=>oZ(D=>{_x(E,D)(D=>{let B=E.onSetup(D);eu(B)&&T.set(B)})}),Ex=(E,T)=>oQ(D=>_x(E,D)(T.get())),Ax=(E,T)=>o1((D,B)=>{_x(E,D)(E.onAction),E.triggersSubmenu||T!==c5.CLOSE_ON_EXECUTE||(D.getSystem().isConnected()&&Fr(D,oM()),B.stop())}),u0={[oS()]:["disabling","alloy.base.behaviour","toggling","item-events"]},Bx=(E,T,D,B)=>{let M=Es(b);return{type:"item",dom:T.dom,components:we(T.optComponents),data:E.data,eventOrder:u0,hasSubmenu:E.triggersSubmenu,itemBehaviours:kl([Jp("item-events",[Ax(E,D),Tx(E,M),Ex(E,M)]),aq.config({disabled:()=>!E.enabled||B.isDisabled(),disableClass:"tox-collection__item--state-disabled"}),Sx(),s1.config({})].concat(E.itemBehaviours))}},Fx=E=>({value:E.value,meta:{text:E.text.getOr(""),...E.meta}}),Ix=E=>{let T=l8.os.isMacOS()||l8.os.isiOS(),D=T?{alt:"⌥",ctrl:"⌃",shift:"⇧",meta:"⌘",access:"⌃⌥"}:{meta:"Ctrl",access:"Shift+Alt"},B=E.split("+"),M=H(B,E=>{let T=E.toLowerCase().trim();return ve(D,T)?D[T]:E});return T?M.join(""):M.join("+")},Rx=(E,T,D=[dn])=>tb(E,{tag:"div",classes:D},T),Nx=E=>({dom:{tag:"div",classes:[dr]},components:[ti(lQ.translate(E))]}),Vx=(E,T)=>({dom:{tag:"div",classes:T,innerHtml:E}}),zx=(E,T)=>({dom:{tag:"div",classes:[dr]},components:[{dom:{tag:E.tag,styles:E.styles},components:[ti(lQ.translate(T))]}]}),Hx=E=>({dom:{tag:"div",classes:["tox-collection__item-accessory"]},components:[ti(Ix(E))]}),Lx=E=>Rx("checkmark",E,["tox-collection__item-checkmark"]),Px=E=>{let T=E.map(E=>({attributes:{title:lQ.translate(E),id:la("menu-item")}})).getOr({});return{tag:"div",classes:[c9,c4],...T}},Ux=(E,T,D,B=A.none())=>"color"===E.presets?((E,T,D)=>{let B=E.ariaLabel,M=E.value,er=E.iconContent.map(E=>((E,T,D)=>{let B=T();return Jf(E,B).or(D).getOrThunk(Yf(B))})(E,T.icons,D));return{dom:(()=>{let E=er.getOr(""),D=B.map(E=>({title:T.translate(E)})).getOr({}),ec={tag:"div",attributes:D,classes:[c6]};return"custom"===M?{...ec,tag:"button",classes:[...ec.classes,"tox-swatches__picker-btn"],innerHtml:E}:"remove"===M?{...ec,classes:[...ec.classes,"tox-swatch--remove"],innerHtml:E}:g(M)?{...ec,attributes:{...ec.attributes,"data-mce-color":M},styles:{"background-color":M},innerHtml:E}:ec})(),optComponents:[]}})(E,T,B):((E,T,D,B)=>{let M={tag:"div",classes:[dn]},er=D?E.iconContent.map(E=>tb(E,M,T.icons,B)).orThunk(()=>A.some({dom:M})):A.none(),ec=E.checkMark,eu=A.from(E.meta).fold(()=>Nx,E=>ve(E,"style")?k(zx,E.style):Nx),eg=E.htmlContent.fold(()=>E.textContent.map(eu),E=>A.some(Vx(E,[dr])));return{dom:Px(E.ariaLabel),optComponents:[er,eg,E.shortcutContent.map(Hx),ec,E.caret]}})(E,T,D,B),Wx=(E,T)=>be(E,"tooltipWorker").map(E=>[uY.config({lazySink:T.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:E=>({type:"submenu",item:E,overrides:{maxHeightFunction:n7}}),mode:"follow-highlight",onShow:(T,D)=>{E(E=>{uY.setComponents(T,[oi({element:Fe(E)})])})}})]).getOr([]),jx=(E,T)=>{var D;let B=(D=lQ.translate(E),l4.DOM.encode(D));if(T.length>0){let E=RegExp(T.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");return B.replace(E,E=>`<span class="tox-autocompleter-highlight">${E}</span>`)}return B},Gx=(E,T)=>H(E,E=>{switch(E.type){case"cardcontainer":return((E,T)=>{let D="vertical"===E.direction?"tox-collection__item-container--column":dh,B="left"===E.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right";return{dom:{tag:"div",classes:[dm,D,B,(()=>{switch(E.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}})()]},components:T}})(E,Gx(E.items,T));case"cardimage":var D;return D=E.src,{dom:{tag:"img",classes:E.classes,attributes:{src:D,alt:E.alt.getOr("")}}};case"cardtext":let B=E.name.exists(E=>R(T.cardText.highlightOn,E)),M=B?A.from(T.cardText.matchText).getOr(""):"";return Vx(jx(E.text,M),E.classes)}}),u1=Yu(iy(),iA()),qx=E=>({value:Jx(E)}),u2=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,u3=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Kx=E=>u2.test(E)||u3.test(E),Jx=E=>_e(E,"#").toUpperCase(),Zx=E=>{let T=E.toString(16);return(1===T.length?"0"+T:T).toUpperCase()},Qx=E=>{let T=Zx(E.red)+Zx(E.green)+Zx(E.blue);return qx(T)},u5=Math.min,u9=Math.max,u4=Math.round,u6=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,u8=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,rw=(E,T,D,B)=>({red:E,green:T,blue:D,alpha:B}),aw=E=>{let T=parseInt(E,10);return T.toString()===E&&T>=0&&T<=255},iw=E=>{let T,D,B;let M=(E.hue||0)%360,er=E.saturation/100,ec=E.value/100;if(er=u9(0,u5(er,1)),ec=u9(0,u5(ec,1)),0===er)return rw(T=D=B=u4(255*ec),D,B,1);let eu=M/60,eg=ec*er,ep=eg*(1-Math.abs(eu%2-1)),eh=ec-eg;switch(Math.floor(eu)){case 0:T=eg,D=ep,B=0;break;case 1:T=ep,D=eg,B=0;break;case 2:T=0,D=eg,B=ep;break;case 3:T=0,D=ep,B=eg;break;case 4:T=ep,D=0,B=eg;break;case 5:T=eg,D=0,B=ep;break;default:T=D=B=0}return rw(T=u4(255*(T+eh)),D=u4(255*(D+eh)),B=u4(255*(B+eh)),1)},lw=E=>{let T=(E=>{let T=(E=>{let T=E.value.replace(u2,(E,T,D,B)=>T+T+D+D+B+B);return{value:T}})(E),D=u3.exec(T.value);return null===D?["FFFFFF","FF","FF","FF"]:D})(E),D=parseInt(T[1],16),B=parseInt(T[2],16),M=parseInt(T[3],16);return rw(D,B,M,1)},cw=(E,T,D,B)=>{let M=parseInt(E,10),er=parseInt(T,10),ec=parseInt(D,10),eu=parseFloat(B);return rw(M,er,ec,eu)},dw=E=>{if("transparent"===E)return A.some(rw(0,0,0,0));let T=u6.exec(E);if(null!==T)return A.some(cw(T[1],T[2],T[3],"1"));let D=u8.exec(E);return null!==D?A.some(cw(D[1],D[2],D[3],D[4])):A.none()},uw=E=>`rgba(${E.red},${E.green},${E.blue},${E.alpha})`,u7=rw(255,0,0,1),gw=(E,T)=>{E.dispatch("ResizeContent",T)},pw=(E,T)=>{E.dispatch("TextColorChange",T)},hw=(E,T)=>E.dispatch("ResolveName",{name:T.nodeName.toLowerCase(),target:T}),fw=(E,T)=>()=>{E(),T()},bw=E=>yw(E,"NodeChange",T=>{T.setEnabled(E.selection.isEditable())}),vw=(E,T)=>D=>{let B=bw(E)(D),M=(D=>{let B=Zl(),s=()=>{D.setActive(E.formatter.match(T));let M=E.formatter.formatChanged(T,D.setActive);B.set(M)};return E.initialized?s():E.once("init",s),()=>{E.off("init",s),B.clear()}})(D);return()=>{B(),M()}},yw=(E,T,D)=>B=>{let s=()=>D(B),r=()=>{D(B),E.on(T,s)};return E.initialized?r():E.once("init",r),()=>{E.off("init",r),E.off(T,s)}},xw=E=>T=>()=>{E.undoManager.transact(()=>{E.focus(),E.execCommand("mceToggleFormat",!1,T.format)})},ww=(E,T)=>()=>E.execCommand(T);var mo=tinymce.util.Tools.resolve("tinymce.util.LocalStorage");let mn={},Cw=E=>be(mn,E).getOrThunk(()=>{let D=`tinymce-custom-colors-${E}`,B=mo.getItem(D);if(m(B)){let E=mo.getItem("tinymce-custom-colors");mo.setItem(D,g(E)?E:"[]")}let M=((E,D=10)=>{let B=mo.getItem(E),M=T(B)?JSON.parse(B):[],er=D-M.length<0?M.slice(0,D):M,i=E=>{er.splice(E,1)};return{add:T=>{I(er,T).each(i),er.unshift(T),er.length>D&&er.pop(),mo.setItem(E,JSON.stringify(er))},state:()=>er.slice(0)}})(D,10);return mn[E]=M,M}),Ow=(E,T)=>{Cw(E).add(T)},_w=(E,T,D)=>({hue:E,saturation:T,value:D}),Tw=E=>{let T=0,D=E.red/255,B=E.green/255,M=E.blue/255,er=Math.min(D,Math.min(B,M)),ec=Math.max(D,Math.max(B,M));return er===ec?_w(0,0,100*er):_w(Math.round(60*((D===er?3:M===er?1:5)-(D===er?B-M:M===er?D-B:M-D)/(ec-er))),Math.round(100*((ec-er)/ec)),Math.round(100*ec))},Ew=E=>Qx(iw(E)),Aw=E=>(Kx(E)?A.some({value:Jx(E)}):A.none()).orThunk(()=>dw(E).map(Qx)).getOrThunk(()=>{let T=document.createElement("canvas");T.height=1,T.width=1;let D=T.getContext("2d");D.clearRect(0,0,T.width,T.height),D.fillStyle="#FFFFFF",D.fillStyle=E,D.fillRect(0,0,1,1);let B=D.getImageData(0,0,1,1).data,M=B[0],er=B[1],ec=B[2],eu=B[3];return Qx(rw(M,er,ec,eu))}),mr="forecolor",ma="hilitecolor",Bw=E=>{let T=[];for(let D=0;D<E.length;D+=2)T.push({text:E[D+1],value:"#"+Aw(E[D]).value,icon:"checkmark",type:"choiceitem"});return T},Fw=E=>T=>T.options.get(E),mc="#000000",Rw=(E,T)=>T===mr&&E.options.isSet("color_map_foreground")?Fw("color_map_foreground")(E):T===ma&&E.options.isSet("color_map_background")?Fw("color_map_background")(E):Fw("color_map")(E),Nw=(E,T="default")=>Math.max(5,Math.ceil(Math.sqrt(Rw(E,T).length))),Vw=(E,T)=>{let D=Fw("color_cols")(E),B=Nw(E,T);return D===Nw(E)?B:D},zw=(E,T="default")=>Math.round(T===mr?Fw("color_cols_foreground")(E):T===ma?Fw("color_cols_background")(E):Fw("color_cols")(E)),mu=Fw("custom_colors"),mf=Fw("color_default_foreground"),mb=Fw("color_default_background"),Uw=(E,T)=>{let D=Fe(E.selection.getStart()),B="hilitecolor"===T?Is(D,E=>{if(eL(E)){let T=It(E,"background-color");return Ce(dw(T).exists(E=>0!==E.alpha),T)}return A.none()}).getOr("rgba(0, 0, 0, 0)"):It(D,"color");return dw(B).map(E=>"#"+Qx(E).value)},Ww=E=>{let T="choiceitem",D={type:T,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return E?[D,{type:T,text:"Custom color",icon:"color-picker",value:"custom"}]:[D]},jw=(E,T,D,B)=>{"custom"===D?Jw(E)(D=>{D.each(D=>{Ow(T,D),E.execCommand("mceApplyTextcolor",T,D),B(D)})},Uw(E,T).getOr(mc)):"remove"===D?(B(""),E.execCommand("mceRemoveTextcolor",T)):(B(D),E.execCommand("mceApplyTextcolor",T,D))},Gw=(E,T,D)=>E.concat(H(Cw(T).state(),E=>({type:"choiceitem",text:E,icon:"checkmark",value:E})).concat(Ww(D))),$w=(E,T,D)=>B=>{B(Gw(E,T,D))},qw=(E,T,D)=>{E.setIconFill("forecolor"===T?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",D)},Xw=(E,T)=>D=>{let B=Uw(E,T);return xe(B,D.toUpperCase())},Yw=(E,T,D,B,M)=>{E.ui.registry.addSplitButton(T,{tooltip:B,presets:"color",icon:"forecolor"===T?"text-color":"highlight-bg-color",select:Xw(E,D),columns:zw(E,D),fetch:$w(Rw(E,D),D,mu(E)),onAction:T=>{jw(E,D,M.get(),b)},onItemAction:(B,er)=>{jw(E,D,er,D=>{M.set(D),pw(E,{name:T,color:D})})},onSetup:D=>{qw(D,T,M.get());let n=E=>{E.name===T&&qw(D,E.name,E.color)};return E.on("TextColorChange",n),fw(bw(E)(D),()=>{E.off("TextColorChange",n)})}})},Kw=(E,T,D,B,M)=>{E.ui.registry.addNestedMenuItem(T,{text:B,icon:"forecolor"===T?"text-color":"highlight-bg-color",onSetup:D=>(qw(D,T,M.get()),bw(E)(D)),getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"colorswatch",select:Xw(E,D),initData:{storageKey:D},onAction:B=>{jw(E,D,B.value,D=>{M.set(D),pw(E,{name:T,color:D})})}}]})},Jw=E=>(T,D)=>{let B=!1;E.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{colorpicker:D},onAction:(E,T)=>{"hex-valid"===T.name&&(B=T.value)},onSubmit:D=>{let M=D.getData().colorpicker;B?(T(A.from(M)),D.close()):E.windowManager.alert(E.translate(["Invalid hex color code: {0}",M]))},onClose:b,onCancel:()=>{T(A.none())}})},Zw=(E,T,D,B,M,er,ec,eu)=>{let eg=Jv(T),ep=Qw(T,D,B,"color"!==M?"normal":"color",er,ec,eu);return ey(E,eg,ep,B,{menuType:M})},Qw=(E,T,D,B,M,er,ec)=>we(H(E,eu=>"choiceitem"===eu.type?qn("choicemenuitem",uH,eu).fold(Zv,eu=>A.some(((E,T,D,B,M,er,ec,eu=!0)=>{let eg=Ux({presets:D,textContent:T?E.text:A.none(),htmlContent:A.none(),ariaLabel:E.text,iconContent:E.icon,shortcutContent:T?E.shortcut:A.none(),checkMark:T?A.some(Lx(ec.icons)):A.none(),caret:A.none(),value:E.value},ec,eu);return tR(Bx({data:Fx(E),enabled:E.enabled,getApi:E=>({setActive:T=>{s7.set(E,T)},isActive:()=>s7.isOn(E),isEnabled:()=>!aq.isDisabled(E),setEnabled:T=>aq.set(E,!T)}),onAction:T=>B(E.value),onSetup:E=>(E.setActive(M),b),triggersSubmenu:!1,itemBehaviours:[]},eg,er,ec),{toggling:{toggleClass:c7,toggleOnExecute:!1,selected:E.active,exclusive:!0}})})(eu,1===D,B,T,er(eu.value),M,ec,Jv(E)))):A.none())),eS=(E,T)=>{let D=Av(T);return 1===E?{mode:"menu",moveOnTab:!0}:"auto"===E?{mode:"grid",selector:"."+D.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===T?"tox-swatches__row":"tox-collection__group"),previousSelector:E=>"color"===T?pi(E.element,"[aria-checked=true]"):A.none()}},my=la("cell-over"),mw=la("cell-execute"),nS=(E,T,D)=>{let n=D=>Ir(D,mw,{row:E,col:T}),s=(E,T)=>{T.stop(),n(E)};return ri({dom:{tag:"div",attributes:{role:"button","aria-label":D}},behaviours:kl([Jp("insert-table-picker-cell",[Ur(t2(),s9.focus),Ur(oS(),n),Ur(t7(),s),Ur(o_(),s)]),s7.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),s9.config({onFocus:D=>Ir(D,my,{row:E,col:T})})])})},sS=E=>X(E,E=>H(E,Sa)),rS=(E,T)=>ti(`${T}x${E}`),mA={inserttable:(E,T)=>{let D=((E,T,D)=>{let B=[];for(let T=0;T<10;T++){let D=[];for(let B=0;B<10;B++){let M=E(T+1,B+1);D.push(nS(T,B,M))}B.push(D)}return B})((E,D)=>T.shared.providers.translate(`${D} columns, ${E} rows`)),B=rS(0,0),M=Gh({dom:{tag:"span",classes:["tox-insert-table-picker__label"]},components:[B],behaviours:kl([s1.config({})])});return{type:"widget",data:{value:la("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[u1.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:sS(D).concat(M.asSpec()),behaviours:kl([Jp("insert-table-picker",[oZ(E=>{s1.set(M.get(E),[B])}),$r(my,(E,T,B)=>{let{row:er,col:ec}=B.event;((E,T,D,B,M)=>{for(let B=0;B<10;B++)for(let M=0;M<10;M++)s7.set(E[B][M],B<=T&&M<=D)})(D,er,ec),s1.set(M.get(E),[rS(er+1,ec+1)])}),$r(mw,(T,D,B)=>{let{row:M,col:er}=B.event;E.onAction({numRows:M+1,numColumns:er+1}),Fr(T,oM())})]),sQ.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:(E,T)=>{let D=((E,T)=>{let D=E.initData.allowCustomColors&&T.colorinput.hasCustomColors();return E.initData.colors.fold(()=>Gw(T.colorinput.getColors(E.initData.storageKey),E.initData.storageKey,D),E=>E.concat(Ww(D)))})(E,T),B=T.colorinput.getColorCols(E.initData.storageKey),M="color",er={...Zw(la("menu-value"),D,T=>{E.onAction({value:T})},B,M,c5.CLOSE_ON_EXECUTE,E.select.getOr(ep),T.shared.providers),markers:Av(M),movement:eS(B,M)};return{type:"widget",data:{value:la("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[u1.widget(iH.sketch(er))]}}},iS=E=>({type:"separator",dom:{tag:"div",classes:[c4,"tox-collection__group-heading"]},components:E.text.map(ti).toArray()});var mO=Object.freeze({__proto__:null,getCoupled:(E,T,D,B)=>D.getOrCreate(E,T,B),getExistingCoupled:(E,T,D,B)=>D.getExisting(E,T,B)}),m_=[ns("others",$n(tH.value,tz()))],mT=Object.freeze({__proto__:null,init:()=>{let E={},t=(T,D)=>{if(0===eD(T.others).length)throw Error("Cannot find any known coupled components");return be(E,D)},T=x({});return _a({readState:T,getExisting:(E,T,D)=>t(T,D).orThunk(()=>(be(T.others,D).getOrDie("No information found for coupled component: "+D),A.none())),getOrCreate:(T,D,B)=>t(D,B).getOrThunk(()=>{let M=be(D.others,B).getOrDie("No information found for coupled component: "+B)(T),er=T.getSystem().build(M);return E[B]=er,er})})}});let mD=Ol({fields:m_,name:"coupling",apis:mO,state:mT}),mS=E=>{let T=A.none(),D=[],n=E=>{s()?r(E):D.push(E)},s=()=>T.isSome(),r=E=>{T.each(T=>{setTimeout(()=>{E(T)},0)})};return E(E=>{s()||(T=A.some(E),L(D,r),D=[])}),{get:n,map:E=>mS(T=>{n(D=>{T(E(D))})}),isReady:s}},mB={nu:mS,pure:E=>mS(T=>{T(E)})},pS=E=>{setTimeout(()=>{throw E},0)},hS=E=>{let t=T=>{E().then(T,pS)};return{map:T=>hS(()=>E().then(T)),bind:T=>hS(()=>E().then(E=>T(E).toPromise())),anonBind:T=>hS(()=>E().then(()=>T.toPromise())),toLazy:()=>mB.nu(t),toCached:()=>{let T=null;return hS(()=>(null===T&&(T=E()),T))},toPromise:E,get:t}},fS=E=>hS(()=>new Promise(E)),bS=E=>hS(()=>Promise.resolve(E)),mH=x("sink"),mR=x(aB({name:mH(),overrides:x({dom:{tag:"div"},behaviours:kl([rW.config({useFixed:eh})]),events:Hr([qr(t9()),qr(tZ()),qr(t7())])})})),xS=(E,T)=>{let D=E.getHotspot(T).getOr(T),B="hotspot",M=E.getAnchorOverrides();return E.layouts.fold(()=>({type:B,hotspot:D,overrides:M}),E=>({type:B,hotspot:D,overrides:M,layouts:E}))},wS=(E,T,D,B,M,er,ec)=>{let eu=((E,T,D,B,M,er,ec)=>{let eu=(0,E.fetch)(B).map(T),eg=CS(B,E);return eu.map(E=>E.bind(E=>A.from(iL.sketch({...er.menu(),uid:ha(""),data:E,highlightOnOpen:ec,onOpenMenu:(E,T)=>{let B=eg().getOrDie();rW.position(B,T,{anchor:D}),rq.decloak(M)},onOpenSubmenu:(E,T,D)=>{let B=eg().getOrDie();rW.position(B,D,{anchor:{type:"submenu",item:T}}),rq.decloak(M)},onRepositionMenu:(E,T,B)=>{let M=eg().getOrDie();rW.position(M,T,{anchor:D}),L(B,E=>{rW.position(M,E.triggeredMenu,{anchor:{type:"submenu",item:E.triggeringItem}})})},onEscape:()=>(s9.focus(B),rq.close(M),A.some(!0))}))))})(E,T,xS(E,D),D,B,M,ec);return eu.map(E=>(E.fold(()=>{rq.isOpen(B)&&rq.close(B)},E=>{rq.cloak(B),rq.open(B,E),er(B)}),B))},SS=(E,T,D,B,M,er,ec)=>(rq.close(B),bS(B)),kS=(E,T,D,B,M,er)=>{let ec=mD.getCoupled(D,"sandbox");return(rq.isOpen(ec)?SS:wS)(E,T,D,ec,B,M,er)},CS=(E,T)=>E.getSystem().getByUid(T.uid+"-"+mH()).map(E=>()=>tH.value(E)).getOrThunk(()=>T.lazySink.fold(()=>()=>tH.error(Error("No internal sink is specified, nor could an external sink be found")),T=>()=>T(E))),OS=E=>{rq.getState(E).each(E=>{iL.repositionMenus(E)})},_S=(E,T,D)=>{let B=bi(),M=CS(T,E);return{dom:{tag:"div",classes:E.sandboxClasses,attributes:{id:B.id,role:"listbox"}},behaviours:bu(E.sandboxBehaviours,[r6.config({store:{mode:"memory",initialValue:T}}),rq.config({onOpen:(M,er)=>{let ec=xS(E,T);B.link(T.element),E.matchWidth&&((E,T,D)=>{var B;let M=aW.getCurrent(T).getOr(T),er=Jt(E.element);D?Dt(M.element,"min-width",er+"px"):(B=M.element,eX.set(B,er))})(ec.hotspot,er,E.useMinWidth),E.onOpen(ec,M,er),void 0!==D&&void 0!==D.onOpen&&D.onOpen(M,er)},onClose:(E,M)=>{B.unlink(T.element),void 0!==D&&void 0!==D.onClose&&D.onClose(E,M)},isPartOf:(E,D,B)=>vi(D,B)||vi(T,B),getAttachPoint:()=>M().getOrDie()}),aW.config({find:E=>rq.getState(E).bind(E=>aW.getCurrent(E))}),nQ.config({channels:{...Qd({isExtraPart:ep}),...tu({doReposition:OS})}})])}},TS=E=>{let T=mD.getCoupled(E,"sandbox");OS(T)},ES=()=>[ys("sandboxClasses",[]),hu("sandboxBehaviours",[aW,nQ,rq,r6])],mN=x([os("dom"),os("fetch"),Di("onOpen"),Bi("onExecute"),ys("getHotspot",A.some),ys("getAnchorOverrides",x({})),wc(),hu("dropdownBehaviours",[s7,mD,sQ,s9]),os("toggleClass"),ys("eventOrder",{}),us("lazySink"),ys("matchWidth",!1),ys("useMinWidth",!1),us("role")].concat(ES())),mU=x([aF({schema:[Ei(),ys("fakeFocus",!1)],name:"menu",defaults:E=>({onExecute:E.onExecute})}),mR()]),mL=bm({name:"Dropdown",configFields:mN(),partFields:mU(),factory:(E,T,D,B)=>{let s=E=>{rq.getState(E).each(E=>{iL.highlightPrimary(E)})},r=(T,D,M)=>kS(E,w,T,B,D,M),M={expand:E=>{s7.isOn(E)||r(E,b,i8.HighlightNone).get(b)},open:E=>{s7.isOn(E)||r(E,b,i8.HighlightMenuAndItem).get(b)},refetch:T=>mD.getExistingCoupled(T,"sandbox").fold(()=>r(T,b,i8.HighlightMenuAndItem).map(b),D=>wS(E,w,T,D,B,b,i8.HighlightMenuAndItem).map(b)),isOpen:s7.isOn,close:E=>{s7.isOn(E)&&r(E,b,i8.HighlightMenuAndItem).get(b)},repositionMenus:E=>{s7.isOn(E)&&TS(E)}},i=(E,T)=>(Rr(E),A.some(!0));return{uid:E.uid,dom:E.dom,components:T,behaviours:bu(E.dropdownBehaviours,[s7.config({toggleClass:E.toggleClass,aria:{mode:"expanded"}}),mD.config({others:{sandbox:T=>_S(E,T,{onOpen:()=>s7.on(T),onClose:()=>s7.off(T)})}}),sQ.config({mode:"special",onSpace:i,onEnter:i,onDown:(E,T)=>{if(mL.isOpen(E)){let T=mD.getCoupled(E,"sandbox");s(T)}else mL.open(E);return A.some(!0)},onEscape:(E,T)=>mL.isOpen(E)?(mL.close(E),A.some(!0)):A.none()}),s9.config({})]),events:mh(A.some(E=>{r(E,s,i8.HighlightMenuAndItem).get(b)})),eventOrder:{...E.eventOrder,[oS()]:["disabling","toggling","alloy.base.behaviour"]},apis:M,domModification:{attributes:{"aria-haspopup":"true",...E.role.fold(()=>({}),E=>({role:E})),..."button"===E.dom.tag?{type:be(E.dom,"attributes").bind(E=>be(E,"type")).getOr("button")}:{}}}}},apis:{open:(E,T)=>E.open(T),refetch:(E,T)=>E.refetch(T),expand:(E,T)=>E.expand(T),close:(E,T)=>E.close(T),isOpen:(E,T)=>E.isOpen(T),repositionMenus:(E,T)=>E.repositionMenus(T)}}),BS=(E,T,D)=>{Pv(E).each(E=>{((E,T)=>{_t(T.element,"id").each(T=>kt(E.element,"aria-activedescendant",T))})(E,D),(Ua(T.element,dS)?A.some(T.element):pi(T.element,"."+dS)).each(T=>{_t(T,"id").each(T=>kt(E.element,"aria-controls",T))})}),kt(D.element,"aria-selected","true")},FS=(E,T,D)=>{kt(D.element,"aria-selected","false")},IS=E=>mD.getExistingCoupled(E,"sandbox").bind(Pv).map(Wv).map(E=>E.fetchPattern).getOr("");(hz=hG||(hG={}))[hz.ContentFocus=0]="ContentFocus",hz[hz.UiFocus=1]="UiFocus";let NS=(E,T,D,B,M)=>{let er=D.shared.providers,a=E=>M?{...E,shortcut:A.none(),icon:E.text.isSome()?A.none():E.icon}:E;switch(E.type){case"menuitem":return qn("menuitem",uz,E).fold(Zv,E=>A.some(((E,T,D,B=!0)=>{let M=Ux({presets:"normal",iconContent:E.icon,textContent:E.text,htmlContent:A.none(),ariaLabel:E.text,caret:A.none(),checkMark:A.none(),shortcutContent:E.shortcut},D,B);return Bx({data:Fx(E),getApi:E=>({isEnabled:()=>!aq.isDisabled(E),setEnabled:T=>aq.set(E,!T)}),enabled:E.enabled,onAction:E.onAction,onSetup:E.onSetup,triggersSubmenu:!1,itemBehaviours:[]},M,T,D)})(a(E),T,er,B)));case"nestedmenuitem":return qn("nestedmenuitem",uP,E).fold(Zv,E=>A.some(((E,T,D,B=!0,M=!1)=>{let er=M?Rx("chevron-down",D.icons,[da]):Rx("chevron-right",D.icons,[da]),ec=Ux({presets:"normal",iconContent:E.icon,textContent:E.text,htmlContent:A.none(),ariaLabel:E.text,caret:A.some(er),checkMark:A.none(),shortcutContent:E.shortcut},D,B);return Bx({data:Fx(E),getApi:E=>({isEnabled:()=>!aq.isDisabled(E),setEnabled:T=>aq.set(E,!T),setIconFill:(T,D)=>{pi(E.element,`svg path[class="${T}"], rect[class="${T}"]`).each(E=>{kt(E,"fill",D)})}}),enabled:E.enabled,onAction:b,onSetup:E.onSetup,triggersSubmenu:!0,itemBehaviours:[]},ec,T,D)})(a(E),T,er,B,M)));case"togglemenuitem":return qn("togglemenuitem",uG,E).fold(Zv,E=>A.some(((E,T,D,B=!0)=>{let M=Ux({iconContent:E.icon,textContent:E.text,htmlContent:A.none(),ariaLabel:E.text,checkMark:A.some(Lx(D.icons)),caret:A.none(),shortcutContent:E.shortcut,presets:"normal",meta:E.meta},D,B);return tR(Bx({data:Fx(E),enabled:E.enabled,getApi:E=>({setActive:T=>{s7.set(E,T)},isActive:()=>s7.isOn(E),isEnabled:()=>!aq.isDisabled(E),setEnabled:T=>aq.set(E,!T)}),onAction:E.onAction,onSetup:E.onSetup,triggersSubmenu:!1,itemBehaviours:[]},M,T,D),{toggling:{toggleClass:c7,toggleOnExecute:!1,selected:E.active}})})(a(E),T,er,B)));case"separator":return qn("separatormenuitem",d3,E).fold(Zv,E=>A.some(iS(E)));case"fancymenuitem":return qn("fancymenuitem",uL,E).fold(Zv,E=>be(mA,E.fancytype).map(T=>T(E,D)));default:return console.error("Unknown item in general menu",E),A.none()}},VS=(E,T,D,B,M,er,ec)=>{let eu=1===B,eg=!eu||Jv(E);return we(H(E,E=>{switch(E.type){case"separator":return qn("Autocompleter.Separator",d3,E).fold(Zv,E=>A.some(iS(E)));case"cardmenuitem":return qn("cardmenuitem",uD,E).fold(Zv,E=>A.some(((E,T,D,B)=>{let M={dom:Px(E.label),optComponents:[A.some({dom:{tag:"div",classes:[dm,dh]},components:Gx(E.items,B)})]};return Bx({data:Fx({text:A.none(),...E}),enabled:E.enabled,getApi:E=>({isEnabled:()=>!aq.isDisabled(E),setEnabled:T=>{aq.set(E,!T),L(Xc(E.element,"*"),D=>{E.getSystem().getByDom(D).each(E=>{E.hasConfigured(aq)&&aq.set(E,!T)})})}}),onAction:E.onAction,onSetup:E.onSetup,triggersSubmenu:!1,itemBehaviours:A.from(B.itemBehaviours).getOr([])},M,T,D.providers)})({...E,onAction:T=>{E.onAction(T),D(E.value,E.meta)}},M,er,{itemBehaviours:Wx(E.meta,er),cardText:{matchText:T,highlightOn:ec}})));default:return qn("Autocompleter.Item",d5,E).fold(Zv,E=>A.some(((E,T,D,B,M,er,ec,eu=!0)=>{let eg=Ux({presets:B,textContent:A.none(),htmlContent:D?E.text.map(E=>jx(E,T)):A.none(),ariaLabel:E.text,iconContent:E.icon,shortcutContent:A.none(),checkMark:A.none(),caret:A.none(),value:E.value},ec.providers,eu,E.icon);return Bx({data:Fx(E),enabled:E.enabled,getApi:x({}),onAction:T=>M(E.value,E.meta),onSetup:x(b),triggersSubmenu:!1,itemBehaviours:Wx(E.meta,ec)},eg,er,ec.providers)})(E,T,eu,"normal",D,M,er,eg)))}}))},zS=(E,T,D,B,M,er)=>{let ec=Jv(T),eu=we(H(T,E=>{var T;return T="nestedmenuitem"===E.type&&E.getSubmenuItems().length<=0?{...E,enabled:!1}:E,NS(T,D,B,M?!ve(T,"text"):ec,M)})),eg="no-search"===er.searchMode?{menuType:"normal"}:{menuType:"searchable",searchMode:er};return(M?Qv:ey)(E,ec,eu,1,eg)},HS=E=>iL.singleData(E.value,E),LS=(E,T)=>{let D=Es(!1),B=Es(!1),M=ri(iz.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:kl([Jp("dismissAutocompleter",[Ur(oG(),()=>c())])]),lazySink:T.getSink})),r=()=>iz.isOpen(M),er=B.get,i=()=>{r()&&iz.hide(M)},l=()=>iz.getContent(M).bind(E=>te(E.components(),0)),c=()=>E.execCommand("mceAutocompleterClose"),d=B=>{let er=(B=>{let M=re(B,E=>A.from(E.columns)).getOr(1);return X(B,B=>{let er=B.items;return VS(er,B.matchText,(T,M)=>{var er;let ec=E.selection.getRng();(er=E.dom,mv(Fe(ec.startContainer)).map(E=>{let T=er.createRng();return T.selectNode(E.dom),T})).each(er=>{D.set(!0),B.onAction({hide:()=>c(),reload:T=>{i(),E.execCommand("mceAutocompleterReload",!1,{fetchOptions:T})}},er,T,M),D.set(!1)})},M,c5.BUBBLE_TO_SANDBOX,T,B.highlightOn)})})(B);er.length>0?(pi(Fe(E.getBody()),c3).each(T=>{let D=re(B,E=>A.from(E.columns)).getOr(1);iz.showMenuAt(M,{anchor:{type:"node",root:Fe(E.getBody()),node:A.from(T)}},((E,T,D,B)=>{let M=eS(T,B),er=Av(B);return{data:HS({...E,movement:M,menuBehaviours:lx("auto"!==T?[]:[oZ((E,T)=>{ix(E,4,er.item).each(({numColumns:T,numRows:D})=>{sQ.setGridSize(E,D,T)})})])}),menu:{markers:Av(B),fakeFocus:D===hG.ContentFocus}}})(ey("autocompleter-value",!0,er,D,{menuType:"normal"}),D,hG.ContentFocus,"normal"))}),l().each(aZ.highlightFirst)):i()};E.on("AutocompleterStart",({lookupData:E})=>{B.set(!0),D.set(!1),d(E)}),E.on("AutocompleterUpdate",({lookupData:E})=>d(E)),E.on("AutocompleterEnd",()=>{i(),B.set(!1),D.set(!1)}),((E,T)=>{let o=(E,T)=>{Ir(E,t9(),{raw:T})},n=()=>E.getMenu().bind(aZ.getHighlighted);T.on("keydown",T=>{let D=T.which;E.isActive()&&(E.isMenuOpen()?13===D?(n().each(Rr),T.preventDefault()):40===D?(n().fold(()=>{E.getMenu().each(aZ.highlightFirst)},E=>{o(E,T)}),T.preventDefault(),T.stopImmediatePropagation()):37!==D&&38!==D&&39!==D||n().each(E=>{o(E,T),T.preventDefault(),T.stopImmediatePropagation()}):13!==D&&38!==D&&40!==D||E.cancelIfNecessary())}),T.on("NodeChange",T=>{E.isActive()&&!E.isProcessingAction()&&mv(Fe(T.element)).isNone()&&E.cancelIfNecessary()})})({cancelIfNecessary:c,isMenuOpen:r,isActive:er,isProcessingAction:D.get,getMenu:l},E)},mz=["visible","hidden","clip"],US=E=>eR(E).length>0&&!R(mz,E),WS=E=>{if(je(E)){let T=It(E,"overflow-x"),D=It(E,"overflow-y");return US(T)||US(D)}return!1},jS=(E,T)=>lv(E)?(E=>{let T=qc(E,WS),D=0===T.length?bt(E).map(vt).map(E=>qc(E,WS)).getOr([]):T;return oe(D).map(E=>({element:E,others:D.slice(1)}))})(T):A.none(),GS=E=>{let T=[...H(E.others,Jo),en()];return j(T,(E,T)=>Qo(E,T),Jo(E.element))},$S=(E,T,D)=>hi(E,T,D).isSome(),qS=(E,T)=>{let D=null;return{cancel:()=>{null!==D&&(clearTimeout(D),D=null)},schedule:(...B)=>{D=setTimeout(()=>{E.apply(null,B),D=null},T)}}},XS=E=>{let T=E.raw;return void 0===T.touches||1!==T.touches.length?A.none():A.some(T.touches[0])},YS=(E,T)=>{let D={stopBackspace:!0,...T},B=(E=>{let T=Ql(),D=Es(!1),B=qS(T=>{E.triggerEvent(oB(),T),D.set(!0)},400),M=Ds([{key:tX(),value:E=>(XS(E).each(M=>{B.cancel();let er={x:M.clientX,y:M.clientY,target:E.target};B.schedule(E),D.set(!1),T.set(er)}),A.none())},{key:tq(),value:E=>(B.cancel(),XS(E).each(E=>{T.on(D=>{((E,T)=>{let D=Math.abs(E.clientX-T.x),B=Math.abs(E.clientY-T.y);return D>5||B>5})(E,D)&&T.clear()})}),A.none())},{key:tK(),value:M=>(B.cancel(),T.get().filter(E=>Ze(E.target,M.target)).map(T=>D.get()?(M.prevent(),!1):E.triggerEvent(o_(),M)))}]);return{fireIfReady:(E,T)=>be(M,T).bind(T=>T(E))}})(D),M=H(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),T=>tc(E,T,E=>{B.fireIfReady(E,T).each(T=>{T&&E.kill()}),D.triggerEvent(T,E)&&E.kill()})),er=Ql(),ec=tc(E,"paste",E=>{B.fireIfReady(E,"paste").each(T=>{T&&E.kill()}),D.triggerEvent("paste",E)&&E.kill(),er.set(setTimeout(()=>{D.triggerEvent(ow(),E)},0))}),eu=tc(E,"keydown",E=>{D.triggerEvent("keydown",E)?E.kill():!D.stopBackspace||8!==E.raw.which||R(["input","textarea"],Ue(E.target))||$S(E.target,'[contenteditable="true"]')||E.prevent()}),eg=tc(E,"focusin",E=>{D.triggerEvent("focusin",E)&&E.kill()}),ep=Ql(),eh=tc(E,"focusout",E=>{D.triggerEvent("focusout",E)&&E.kill(),ep.set(setTimeout(()=>{D.triggerEvent(oy(),E)},0))});return{unbind:()=>{L(M,E=>{E.unbind()}),eu.unbind(),eg.unbind(),eh.unbind(),ec.unbind(),er.on(clearTimeout),ep.on(clearTimeout)}}},KS=(E,T)=>{let D=be(E,"target").getOr(T);return Es(D)},mP=As([{stopped:[]},{resume:["element"]},{complete:[]}]),ZS=(E,T,D,B,M,er)=>{let ec=E(T,B),eu=((E,T)=>{let D=Es(!1),B=Es(!1);return{stop:()=>{D.set(!0)},cut:()=>{B.set(!0)},isStopped:D.get,isCut:B.get,event:E,setSource:T.set,getSource:T.get}})(D,M);return ec.fold(()=>(er.logEventNoHandlers(T,B),mP.complete()),E=>{let D=E.descHandler;return Aa(D)(eu),eu.isStopped()?(er.logEventStopped(T,E.element,D.purpose),mP.stopped()):eu.isCut()?(er.logEventCut(T,E.element,D.purpose),mP.complete()):st(E.element).fold(()=>(er.logNoParent(T,E.element,D.purpose),mP.complete()),B=>(er.logEventResponse(T,E.element,D.purpose),mP.resume(B)))})},QS=(E,T,D,B,M,er)=>ZS(E,T,D,B,M,er).fold(eh,B=>QS(E,T,D,B,M,er),ep),ek=(E,T,D,B,M)=>{let er=KS(D,B);return QS(E,T,D,B,er,M)},tk=()=>{let E=(()=>{let E={};return{registerId:(T,D,B)=>{le(B,(B,M)=>{let er=void 0!==E[M]?E[M]:{};er[D]={cHandler:k.apply(void 0,[B.handler].concat(T)),purpose:B.purpose},E[M]=er})},unregisterId:T=>{le(E,(E,D)=>{ve(E,T)&&delete E[T]})},filterByType:T=>be(E,T).map(E=>pe(E,(E,T)=>({id:T,descHandler:E}))).getOr([]),find:(T,D,B)=>be(E,D).bind(E=>Is(B,T=>pa(T).bind(T=>be(E,T)).map(E=>({element:T,descHandler:E})),T))}})(),T={},o=D=>{pa(D.element).each(D=>{delete T[D],E.unregisterId(D)})};return{find:(T,D,B)=>E.find(T,D,B),filter:T=>E.filterByType(T),register:D=>{let B=(E=>{let T=E.element;return pa(T).getOrThunk(()=>((E,T)=>{let D=la(ni+"uid-");return ga(T,D),D})(0,E.element))})(D);ye(T,B)&&((E,D)=>{let B=T[D];if(B!==E)throw Error('The tagId "'+D+'" is already used by: '+na(B.element)+"\nCannot use it for: "+na(E.element)+"\nThe conflicting element is"+(yt(B.element)?" ":" not ")+"already in the DOM");o(E)})(D,B);let M=[D];E.registerId(M,B,D.events),T[B]=D},unregister:o,getById:E=>be(T,E)}},mG=fm({name:"Container",factory:E=>{let{attributes:T,...D}=E.dom;return{uid:E.uid,dom:{tag:"div",attributes:{role:"presentation",...T},...D},components:E.components,behaviours:fu(E.containerBehaviours),events:E.events,domModification:E.domModification,eventOrder:E.eventOrder}},configFields:[ys("components",[]),hu("containerBehaviours",[]),ys("events",{}),ys("domModification",{}),ys("eventOrder",{})]}),nk=E=>{let t=T=>st(E.element).fold(eh,E=>Ze(T,E)),T=tk(),n=(E,D)=>T.find(t,E,D),D=YS(E.element,{triggerEvent:(E,T)=>Si(E,T.target,D=>ek(n,E,T,T.target,D))}),B={debugInfo:x("real"),triggerEvent:(E,T,D)=>{Si(E,T,B=>ek(n,E,D,T,B))},triggerFocus:(E,T)=>{pa(E).fold(()=>{Dl(E)},D=>{Si(ox(),E,D=>(((E,T,D,B,M)=>{let er=KS(D,B);ZS(E,T,D,B,er,M)})(n,ox(),{originator:T,kill:b,prevent:b,target:E},E,D),!1))})},triggerEscape:(E,T)=>{B.triggerEvent("keydown",E.element,T.event)},getByUid:E=>p(E),getByDom:E=>h(E),build:ri,buildOrPatch:si,addToGui:E=>{l(E)},removeFromGui:E=>{c(E)},addToWorld:E=>{a(E)},removeFromWorld:E=>{i(E)},broadcast:E=>{u(E)},broadcastOn:(E,T)=>{m(E,T)},broadcastEvent:(E,T)=>{g(E,T)},isConnected:eh},a=E=>{E.connect(B),ez(E.element)||(T.register(E),L(E.components(),a),B.triggerEvent(oH(),E.element,{target:E.element}))},i=E=>{ez(E.element)||(L(E.components(),i),T.unregister(E)),E.disconnect()},l=T=>{Ad(E,T)},c=E=>{Bd(E)},d=E=>{let D=T.filter(ok());L(D,T=>{let D=T.descHandler;Aa(D)(E)})},u=E=>{d({universal:!0,data:E})},m=(E,T)=>{d({universal:!1,channels:E,data:T})},g=(E,D)=>((E,T,D)=>{let B=(E=>{let T=Es(!1);return{stop:()=>{T.set(!0)},cut:b,isStopped:T.get,isCut:ep,event:E,setSource:O("Cannot set source of a broadcasted event"),getSource:O("Cannot get source of a broadcasted event")}})(T);return L(E,E=>{let T=E.descHandler;Aa(T)(B)}),B.isStopped()})(T.filter(E),D),p=E=>T.getById(E).fold(()=>tH.error(Error('Could not find component with uid: "'+E+'" in system.')),tH.value),h=E=>{let T=pa(E).getOr("not found");return p(T)};return a(E),{root:E,element:E.element,destroy:()=>{D.unbind(),Po(E.element)},add:l,remove:c,getByUid:p,getByDom:h,addToWorld:a,removeFromWorld:i,broadcast:u,broadcastOn:m,broadcastEvent:g}},mW=x([ys("prefix","form-field"),hu("fieldBehaviours",[aW,r6])]),mj=x([aB({schema:[os("dom")],name:"label"}),aB({factory:{sketch:E=>({uid:E.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:E.text}})},schema:[os("text")],name:"aria-descriptor"}),aT({factory:{sketch:E=>{let T=((E,T)=>{let D={};return le(E,(E,B)=>{R(T,B)||(D[B]=E)}),D})(E,["factory"]);return E.factory.sketch(T)}},schema:[os("factory")],name:"field"})]),mJ=bm({name:"FormField",configFields:mW(),partFields:mj(),factory:(E,T,D,B)=>{let M=bu(E.fieldBehaviours,[aW.config({find:T=>om(T,E,"field")}),r6.config({store:{mode:"manual",getValue:E=>aW.getCurrent(E).bind(r6.getValue),setValue:(E,T)=>{aW.getCurrent(E).each(E=>{r6.setValue(E,T)})}}})]),er=Hr([oZ((T,D)=>{let B=sm(T,E,["label","field","aria-descriptor"]);B.field().each(T=>{let D=la(E.prefix);B.label().each(E=>{kt(E.element,"for",D),kt(T.element,"id",D)}),B["aria-descriptor"]().each(D=>{let B=la(E.prefix);kt(D.element,"id",B),kt(T.element,"aria-describedby",B)})})})]);return{uid:E.uid,dom:E.dom,components:T,behaviours:M,events:er,apis:{getField:T=>om(T,E,"field"),getLabel:T=>om(T,E,"label")}}},apis:{getField:(E,T)=>E.getField(T),getLabel:(E,T)=>E.getLabel(T)}});var m$=Object.freeze({__proto__:null,exhibit:(E,T)=>Ea({attributes:Ds([{key:T.tabAttr,value:"true"}])})}),mX=[ys("tabAttr","data-alloy-tabstop")];let mq=Ol({fields:mX,name:"tabstopping",active:m$});var mK=tinymce.util.Tools.resolve("tinymce.html.Entities");let uk=(E,T,D,B)=>{let M=mk(E,T,D,B);return mJ.sketch(M)},mk=(E,T,D,B)=>({dom:gk(D),components:E.toArray().concat([T]),fieldBehaviours:kl(B)}),gk=E=>({tag:"div",classes:["tox-form__group"].concat(E)}),pk=(E,T)=>mJ.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[ti(T.translate(E))]}),mY=la("form-component-change"),mZ=la("form-close"),mQ=la("form-cancel"),m0=la("form-action"),m1=la("form-submit"),m2=la("form-block"),m3=la("form-unblock"),m5=la("form-tabchange"),m9=la("form-resize"),m4=["input","textarea"],Ok=E=>{let T=Ue(E);return R(m4,T)},_k=(E,T)=>{let D=T.getRoot(E).getOr(E.element);Pa(D,T.invalidClass),T.notify.each(T=>{Ok(E.element)&&kt(E.element,"aria-invalid",!1),T.getContainer(E).each(E=>{ta(E,T.validHtml)}),T.onValid(E)})},Tk=(E,T,D,B)=>{let M=T.getRoot(E).getOr(E.element);La(M,T.invalidClass),T.notify.each(T=>{Ok(E.element)&&kt(E.element,"aria-invalid",!0),T.getContainer(E).each(E=>{ta(E,B)}),T.onInvalid(E,B)})},Ek=(E,T,D)=>T.validator.fold(()=>bS(tH.value(!0)),T=>T.validate(E)),Ak=(E,T,D)=>(T.notify.each(T=>{T.onValidate(E)}),Ek(E,T).map(D=>E.getSystem().isConnected()?D.fold(D=>(Tk(E,T,0,D),tH.error(D)),D=>(_k(E,T),tH.value(D))):tH.error("No longer in system")));var m6=Object.freeze({__proto__:null,markValid:_k,markInvalid:Tk,query:Ek,run:Ak,isInvalid:(E,T)=>{let D=T.getRoot(E).getOr(E.element);return Ua(D,T.invalidClass)}}),m8=Object.freeze({__proto__:null,events:(E,T)=>E.validator.map(T=>Hr([Ur(T.onEvent,T=>{Ak(T,E).get(w)})].concat(T.validateOnLoad?[oZ(T=>{Ak(T,E).get(b)})]:[]))).getOr({})}),m7=[os("invalidClass"),ys("getRoot",A.none),vs("notify",[ys("aria","alert"),ys("getContainer",A.none),ys("validHtml",""),Di("onValid"),Di("onInvalid"),Di("onValidate")]),vs("validator",[os("validate"),ys("onEvent","input"),ys("validateOnLoad",!0)])];let gt=Ol({fields:m7,name:"invalidating",active:m8,apis:m6,extra:{validation:E=>T=>{let D=r6.getValue(T);return bS(E(D))}}}),go=Ol({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:()=>Hr([Lr(of(),eh)]),exhibit:()=>Ea({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})})}),gr=la("color-input-change"),gu=la("color-swatch-change"),gp=la("color-picker-cancel"),gh=aB({schema:[os("dom")],name:"label"}),Hk=E=>aB({name:E+"-edge",overrides:T=>T.model.manager.edgeActions[E].fold(()=>({}),E=>({events:Hr([Wr(tX(),(T,D,B)=>E(T,B),[T]),Wr(tZ(),(T,D,B)=>E(T,B),[T]),Wr(tQ(),(T,D,B)=>{B.mouseIsDown.get()&&E(T,B)},[T])])}))}),gf=Hk("top-left"),gb=Hk("top"),gv=Hk("top-right"),gx=Hk("right"),gy=Hk("bottom-right"),gA=Hk("bottom"),gS=Hk("bottom-left");var gO=[gh,Hk("left"),gx,gb,gA,gf,gv,gS,gy,aT({name:"thumb",defaults:x({dom:{styles:{position:"absolute"}}}),overrides:E=>({events:Hr([Gr(tX(),E,"spectrum"),Gr(tq(),E,"spectrum"),Gr(tK(),E,"spectrum"),Gr(tZ(),E,"spectrum"),Gr(tQ(),E,"spectrum"),Gr(t1(),E,"spectrum")])})}),aT({schema:[es("mouseIsDown",()=>Es(!1))],name:"spectrum",overrides:E=>{let T=E.model.manager,o=(D,B)=>T.getValueFromEvent(B).map(B=>T.setValueFrom(D,E,B));return{behaviours:kl([sQ.config({mode:"special",onLeft:D=>T.onLeft(D,E),onRight:D=>T.onRight(D,E),onUp:D=>T.onUp(D,E),onDown:D=>T.onDown(D,E)}),s9.config({})]),events:Hr([Ur(tX(),o),Ur(tq(),o),Ur(tZ(),o),Ur(tQ(),(T,D)=>{E.mouseIsDown.get()&&o(T,D)})])}}})];let gB=x("slider.change.value"),Yk=E=>{let T=E.event.raw;return -1!==T.type.indexOf("touch")?void 0!==T.touches&&1===T.touches.length?A.some(T.touches[0]).map(E=>Gt(E.clientX,E.clientY)):A.none():void 0!==T.clientX?A.some(T).map(E=>Gt(E.clientX,E.clientY)):A.none()},Kk=E=>E.model.minX,Jk=E=>E.model.minY,Zk=E=>E.model.minX-1,Qk=E=>E.model.minY-1,eC=E=>E.model.maxX,tC=E=>E.model.maxY,oC=E=>E.model.maxX+1,nC=E=>E.model.maxY+1,sC=(E,T,D)=>T(E)-D(E),rC=E=>sC(E,eC,Kk),aC=E=>sC(E,tC,Jk),iC=E=>rC(E)/2,lC=E=>aC(E)/2,cC=E=>E.stepSize,dC=E=>E.snapToGrid,uC=E=>E.snapStart,mC=E=>E.rounded,gC=(E,T)=>void 0!==E[T+"-edge"],pC=E=>gC(E,"left"),hC=E=>gC(E,"right"),fC=E=>gC(E,"top"),bC=E=>gC(E,"bottom"),vC=E=>E.model.value.get(),yC=(E,T)=>({x:E,y:T}),xC=(E,T)=>{Ir(E,gB(),{value:T})},wC=(E,T,D,B)=>E<T?E:E>D?D:E===T?T-1:Math.max(T,E-B),SC=(E,T,D,B)=>E>D?E:E<T?T:E===D?D+1:Math.min(D,E+B),kC=(E,T,D)=>Math.max(T,Math.min(D,E)),CC=E=>{let{min:T,max:D,range:B,value:M,step:er,snap:ec,snapStart:eu,rounded:eg,hasMinEdge:ep,hasMaxEdge:eh,minBound:ef,maxBound:ex,screenRange:ew}=E,e_=ep?T-1:T,eD=eh?D+1:D;if(M<ef)return e_;if(M>ex)return eD;{let E=kC((Math.min(ex,Math.max(M,ef))-ef)/ew*B+T,e_,eD);return ec&&E>=T&&E<=D?eu.fold(()=>kC(T+Math.round((E-T)/er)*er,T-1,D+1),T=>Math.max(T,T+Math.min(Math.floor((D-T)/er),Math.floor((E-T)/er)+Math.round((E-T)%er/er))*er)):eg?Math.round(E):E}},OC=E=>{let{min:T,max:D,range:B,value:M,hasMinEdge:er,hasMaxEdge:ec,maxBound:eu,maxOffset:eg,centerMinEdge:ep,centerMaxEdge:eh}=E;return M<T?er?0:ep:M>D?ec?eu:eh:(M-T)/B*eg},gM="right",gH="bottom",gR="left",MC=E=>E.element.dom.getBoundingClientRect(),DC=(E,T)=>E[T],BC=E=>{let T=MC(E);return DC(T,gR)},FC=E=>{let T=MC(E);return DC(T,gM)},IC=E=>{let T=MC(E);return DC(T,"top")},RC=E=>{let T=MC(E);return DC(T,gH)},NC=E=>{let T=MC(E);return DC(T,"width")},VC=E=>{let T=MC(E);return DC(T,"height")},zC=(E,T,D)=>(E+T)/2-D,HC=(E,T)=>{let D=MC(E),B=MC(T),M=DC(D,gR),er=DC(D,gM),ec=DC(B,gR);return zC(M,er,ec)},LC=(E,T)=>{let D=MC(E),B=MC(T),M=DC(D,"top"),er=DC(D,gH),ec=DC(B,"top");return zC(M,er,ec)},PC=(E,T)=>{Ir(E,gB(),{value:T})},UC=(E,T,D)=>{let B={min:Kk(T),max:eC(T),range:rC(T),value:D,step:cC(T),snap:dC(T),snapStart:uC(T),rounded:mC(T),hasMinEdge:pC(T),hasMaxEdge:hC(T),minBound:BC(E),maxBound:FC(E),screenRange:NC(E)};return CC(B)},WC=E=>(T,D)=>((E,T,D)=>{let B=(E>0?SC:wC)(vC(D),Kk(D),eC(D),cC(D));return PC(T,B),A.some(B)})(E,T,D).map(eh),jC=(E,T,D,B,M,er)=>{let ec=((E,T,D,B,M)=>{let er=NC(E),ec=B.bind(T=>A.some(HC(T,E))).getOr(0),eu=M.bind(T=>A.some(HC(T,E))).getOr(er),eg={min:Kk(T),max:eC(T),range:rC(T),value:D,hasMinEdge:pC(T),hasMaxEdge:hC(T),minBound:BC(E),minOffset:0,maxBound:FC(E),maxOffset:er,centerMinEdge:ec,centerMaxEdge:eu};return OC(eg)})(T,er,D,B,M);return BC(T)-BC(E)+ec},gN=WC(-1),gU=WC(1),gL=A.none,gz=A.none,gP={"top-left":A.none(),top:A.none(),"top-right":A.none(),right:A.some((E,T)=>{xC(E,oC(T))}),"bottom-right":A.none(),bottom:A.none(),"bottom-left":A.none(),left:A.some((E,T)=>{xC(E,Zk(T))})};var gG=Object.freeze({__proto__:null,setValueFrom:(E,T,D)=>{let B=UC(E,T,D);return PC(E,B),B},setToMin:(E,T)=>{let D=Kk(T);PC(E,D)},setToMax:(E,T)=>{let D=eC(T);PC(E,D)},findValueOfOffset:UC,getValueFromEvent:E=>Yk(E).map(E=>E.left),findPositionOfValue:jC,setPositionFromValue:(E,T,D,B)=>{let M=vC(D),er=jC(E,B.getSpectrum(E),M,B.getLeftEdge(E),B.getRightEdge(E),D),ec=Jt(T.element)/2;Dt(T.element,"left",er-ec+"px")},onLeft:gN,onRight:gU,onUp:gL,onDown:gz,edgeActions:gP});let JC=(E,T)=>{Ir(E,gB(),{value:T})},ZC=(E,T,D)=>{let B={min:Jk(T),max:tC(T),range:aC(T),value:D,step:cC(T),snap:dC(T),snapStart:uC(T),rounded:mC(T),hasMinEdge:fC(T),hasMaxEdge:bC(T),minBound:IC(E),maxBound:RC(E),screenRange:VC(E)};return CC(B)},QC=E=>(T,D)=>((E,T,D)=>{let B=(E>0?SC:wC)(vC(D),Jk(D),tC(D),cC(D));return JC(T,B),A.some(B)})(E,T,D).map(eh),eO=(E,T,D,B,M,er)=>{let ec=((E,T,D,B,M)=>{let er=VC(E),ec=B.bind(T=>A.some(LC(T,E))).getOr(0),eu=M.bind(T=>A.some(LC(T,E))).getOr(er),eg={min:Jk(T),max:tC(T),range:aC(T),value:D,hasMinEdge:fC(T),hasMaxEdge:bC(T),minBound:IC(E),minOffset:0,maxBound:RC(E),maxOffset:er,centerMinEdge:ec,centerMaxEdge:eu};return OC(eg)})(T,er,D,B,M);return IC(T)-IC(E)+ec},gW=A.none,gj=A.none,gJ=QC(-1),g$=QC(1),gX={"top-left":A.none(),top:A.some((E,T)=>{xC(E,Qk(T))}),"top-right":A.none(),right:A.none(),"bottom-right":A.none(),bottom:A.some((E,T)=>{xC(E,nC(T))}),"bottom-left":A.none(),left:A.none()};var gq=Object.freeze({__proto__:null,setValueFrom:(E,T,D)=>{let B=ZC(E,T,D);return JC(E,B),B},setToMin:(E,T)=>{let D=Jk(T);JC(E,D)},setToMax:(E,T)=>{let D=tC(T);JC(E,D)},findValueOfOffset:ZC,getValueFromEvent:E=>Yk(E).map(E=>E.top),findPositionOfValue:eO,setPositionFromValue:(E,T,D,B)=>{let M=vC(D),er=eO(E,B.getSpectrum(E),M,B.getTopEdge(E),B.getBottomEdge(E),D),ec=Wt(T.element)/2;Dt(T.element,"top",er-ec+"px")},onLeft:gW,onRight:gj,onUp:gJ,onDown:g$,edgeActions:gX});let iO=(E,T)=>{Ir(E,gB(),{value:T})},lO=(E,T)=>({x:E,y:T}),cO=(E,T)=>(D,B)=>((E,T,D,B)=>{let M=E>0?SC:wC,er=T?vC(B).x:M(vC(B).x,Kk(B),eC(B),cC(B)),ec=T?M(vC(B).y,Jk(B),tC(B),cC(B)):vC(B).y;return iO(D,lO(er,ec)),A.some(er)})(E,T,D,B).map(eh),gK=cO(-1,!1),gY=cO(1,!1),gZ=cO(-1,!0),gQ=cO(1,!0),g0={"top-left":A.some((E,T)=>{xC(E,yC(Zk(T),Qk(T)))}),top:A.some((E,T)=>{xC(E,yC(iC(T),Qk(T)))}),"top-right":A.some((E,T)=>{xC(E,yC(oC(T),Qk(T)))}),right:A.some((E,T)=>{xC(E,yC(oC(T),lC(T)))}),"bottom-right":A.some((E,T)=>{xC(E,yC(oC(T),nC(T)))}),bottom:A.some((E,T)=>{xC(E,yC(iC(T),nC(T)))}),"bottom-left":A.some((E,T)=>{xC(E,yC(Zk(T),nC(T)))}),left:A.some((E,T)=>{xC(E,yC(Zk(T),lC(T)))})};var g1=Object.freeze({__proto__:null,setValueFrom:(E,T,D)=>{let B=UC(E,T,D.left),M=ZC(E,T,D.top),er=lO(B,M);return iO(E,er),er},setToMin:(E,T)=>{let D=Kk(T),B=Jk(T);iO(E,lO(D,B))},setToMax:(E,T)=>{let D=eC(T),B=tC(T);iO(E,lO(D,B))},getValueFromEvent:E=>Yk(E),setPositionFromValue:(E,T,D,B)=>{let M=vC(D),er=jC(E,B.getSpectrum(E),M.x,B.getLeftEdge(E),B.getRightEdge(E),D),ec=eO(E,B.getSpectrum(E),M.y,B.getTopEdge(E),B.getBottomEdge(E),D),eu=Jt(T.element)/2,eg=Wt(T.element)/2;Dt(T.element,"left",er-eu+"px"),Dt(T.element,"top",ec-eg+"px")},onLeft:gK,onRight:gY,onUp:gZ,onDown:gQ,edgeActions:g0});let g2=bm({name:"Slider",configFields:[ys("stepSize",1),ys("onChange",b),ys("onChoose",b),ys("onInit",b),ys("onDragStart",b),ys("onDragEnd",b),ys("snapToGrid",!1),ys("rounded",!0),us("snapStart"),ns("model",Jn("mode",{x:[ys("minX",0),ys("maxX",100),es("value",E=>Es(E.mode.minX)),os("getInitialValue"),Ri("manager",gG)],y:[ys("minY",0),ys("maxY",100),es("value",E=>Es(E.mode.minY)),os("getInitialValue"),Ri("manager",gq)],xy:[ys("minX",0),ys("maxX",100),ys("minY",0),ys("maxY",100),es("value",E=>Es({x:E.mode.minX,y:E.mode.minY})),os("getInitialValue"),Ri("manager",g1)]})),hu("sliderBehaviours",[sQ,r6]),es("mouseIsDown",()=>Es(!1))],partFields:gO,factory:(E,T,D,B)=>{let s=T=>nm(T,E,"thumb"),r=T=>nm(T,E,"spectrum"),a=T=>om(T,E,"left-edge"),i=T=>om(T,E,"right-edge"),l=T=>om(T,E,"top-edge"),c=T=>om(T,E,"bottom-edge"),M=E.model,er=M.manager,m=(T,D)=>{er.setPositionFromValue(T,D,E,{getLeftEdge:a,getRightEdge:i,getTopEdge:l,getBottomEdge:c,getSpectrum:r})},g=(E,T)=>{M.value.set(T);let D=s(E);m(E,D)},p=T=>{let D=E.mouseIsDown.get();E.mouseIsDown.set(!1),D&&om(T,E,"thumb").each(D=>{let B=M.value.get();E.onChoose(T,D,B)})},h=(T,D)=>{D.stop(),E.mouseIsDown.set(!0),E.onDragStart(T,s(T))},f=(T,D)=>{D.stop(),E.onDragEnd(T,s(T)),p(T)};return{uid:E.uid,dom:E.dom,components:T,behaviours:bu(E.sliderBehaviours,[sQ.config({mode:"special",focusIn:T=>om(T,E,"spectrum").map(sQ.focusIn).map(eh)}),r6.config({store:{mode:"manual",getValue:E=>M.value.get(),setValue:g}}),nQ.config({channels:{[rZ()]:{onReceive:p}}})]),events:Hr([Ur(gB(),(T,D)=>{((T,D)=>{g(T,D);let B=s(T);E.onChange(T,B,D),A.some(!0)})(T,D.event.value)}),oZ((T,D)=>{let B=M.getInitialValue();M.value.set(B);let er=s(T);m(T,er);let ec=r(T);E.onInit(T,er,ec,M.value.get())}),Ur(tX(),h),Ur(tK(),f),Ur(tZ(),h),Ur(t1(),f)]),apis:{resetToMin:T=>{er.setToMin(T,E)},resetToMax:T=>{er.setToMax(T,E)},setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},apis:{setValue:(E,T,D)=>{E.setValue(T,D)},resetToMin:(E,T)=>{E.resetToMin(T)},resetToMax:(E,T)=>{E.resetToMax(T)},refresh:(E,T)=>{E.refresh(T)}}}),g3=la("rgb-hex-update"),g5=la("slider-update"),g9=la("palette-update"),g4="form",g6=[hu("formBehaviours",[r6])],SO=E=>"<alloy.field."+E+">",kO=(E,T)=>({uid:E.uid,dom:E.dom,components:T,behaviours:bu(E.formBehaviours,[r6.config({store:{mode:"manual",getValue:T=>{let D=rm(T,E);return ce(D,(E,T)=>E().bind(E=>{var D,B;return D=aW.getCurrent(E),B=Error(`Cannot find a current component to extract the value from for form part '${T}': `+na(E.element)),D.fold(()=>tH.error(B),tH.value)}).map(r6.getValue))},setValue:(T,D)=>{le(D,(D,B)=>{om(T,E,B).each(E=>{aW.getCurrent(E).each(E=>{r6.setValue(E,D)})})})}}})]),apis:{getField:(T,D)=>om(T,E,D).bind(aW.getCurrent)}}),g8={getField:Ca((E,T,D)=>E.getField(T,D)),sketch:E=>{let T=(()=>{let E=[];return{field:(T,D)=>(E.push(T),Ju(g4,SO(T),D)),record:x(E)}})(),D=E(T),B=T.record(),M=H(B,E=>aT({name:E,pname:SO(E)}));return mm(g4,g6,M,kO,D)}},g7=la("valid-input"),pt=la("invalid-input"),po=la("validating-input"),pr="colorcustom.rgb.",AO=(E,T,D,B)=>{let s=(D,B)=>gt.config({invalidClass:T("invalid"),notify:{onValidate:E=>{Ir(E,po,{type:D})},onValid:E=>{Ir(E,g7,{type:D,value:r6.getValue(E)})},onInvalid:E=>{Ir(E,pt,{type:D,value:r6.getValue(E)})}},validator:{validate:T=>{let D=r6.getValue(T),M=B(D)?tH.value(!0):tH.error(E("aria.input.invalid"));return bS(M)},validateOnLoad:!1}}),r=(D,B,M,er,ec)=>{let eu=E(pr+"range"),eg=mJ.parts.label({dom:{tag:"label",attributes:{"aria-label":er}},components:[ti(M)]}),ep=mJ.parts.field({data:ec,factory:dx,inputAttributes:{type:"text",..."hex"===B?{"aria-live":"polite"}:{}},inputClasses:[T("textfield")],inputBehaviours:kl([s(B,D),mq.config({})]),onSetValue:E=>{gt.isInvalid(E)&&gt.run(E).get(b)}}),eh="hex"!==B?[mJ.parts["aria-descriptor"]({text:eu})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:[eg,ep].concat(eh)}},a=(E,T)=>{let D=T.red,B=T.green,M=T.blue;r6.setValue(E,{red:D,green:B,blue:M})},M=Gh({dom:{tag:"div",classes:[T("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),l=(E,T)=>{M.getOpt(E).each(E=>{Dt(E.element,"background-color","#"+T.value)})},er=fm({factory:()=>{let er={red:Es(A.some(255)),green:Es(A.some(255)),blue:Es(A.some(255)),hex:Es(A.some("ffffff"))},c=E=>er[E].get(),d=(E,T)=>{er[E].set(T)},u=E=>{let T=E.red,D=E.green,B=E.blue;d("red",A.some(T)),d("green",A.some(D)),d("blue",A.some(B))},m=(E,T)=>{let D=T.event;"hex"!==D.type?d(D.type,A.none()):B(E)},g=(E,T)=>{let B=T.event;"hex"===B.type?((E,T)=>{D(E);let B=qx(T);d("hex",A.some(B.value));let M=lw(B);a(E,M),u(M),Ir(E,g3,{hex:B}),l(E,B)})(E,B.value):((E,T,D)=>{let B=parseInt(D,10);d(T,A.some(B)),c("red").bind(E=>c("green").bind(T=>c("blue").map(D=>rw(E,T,D,1)))).each(T=>{let D=((E,T)=>{let D=Qx(T);return g8.getField(E,"hex").each(T=>{s9.isFocused(T)||r6.setValue(E,{hex:D.value})}),D})(E,T);Ir(E,g3,{hex:D}),l(E,D)})})(E,B.type,B.value)},p=T=>({label:E(pr+T+".label"),description:E(pr+T+".description")}),ec=p("red"),eu=p("green"),eg=p("blue"),ep=p("hex");return tR(g8.sketch(D=>({dom:{tag:"form",classes:[T("rgb-form")],attributes:{"aria-label":E("aria.color.picker")}},components:[D.field("red",mJ.sketch(r(aw,"red",ec.label,ec.description,255))),D.field("green",mJ.sketch(r(aw,"green",eu.label,eu.description,255))),D.field("blue",mJ.sketch(r(aw,"blue",eg.label,eg.description,255))),D.field("hex",mJ.sketch(r(Kx,"hex",ep.label,ep.description,"ffffff"))),M.asSpec()],formBehaviours:kl([gt.config({invalidClass:T("form-invalid")}),Jp("rgb-form-events",[Ur(g7,g),Ur(pt,m),Ur(po,m)])])})),{apis:{updateHex:(E,T)=>{r6.setValue(E,{hex:T.value}),((E,T)=>{let D=lw(T);a(E,D),u(D)})(E,T),l(E,T)}}})},name:"RgbForm",configFields:[],apis:{updateHex:(E,T,D)=>{E.updateHex(T,D)}},extraApis:{}});return er},MO=(E,T)=>{let D=fm({name:"ColourPicker",configFields:[os("dom"),ys("onValidHex",b),ys("onInvalidHex",b)],factory:D=>{let B=AO(E,T,D.onValidHex,D.onInvalidHex),M=((E,T)=>{let D=g2.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[T("sv-palette-spectrum")]}}),B=g2.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[T("sv-palette-thumb")],innerHtml:`<div class=${T("sv-palette-inner-thumb")} role="presentation"></div>`}}),s=(E,T)=>{let{width:D,height:B}=E,M=E.getContext("2d");if(null===M)return;M.fillStyle=T,M.fillRect(0,0,D,B);let er=M.createLinearGradient(0,0,D,0);er.addColorStop(0,"rgba(255,255,255,1)"),er.addColorStop(1,"rgba(255,255,255,0)"),M.fillStyle=er,M.fillRect(0,0,D,B);let ec=M.createLinearGradient(0,0,0,B);ec.addColorStop(0,"rgba(0,0,0,0)"),ec.addColorStop(1,"rgba(0,0,0,1)"),M.fillStyle=ec,M.fillRect(0,0,D,B)};return fm({factory:E=>{let M=x({x:0,y:0}),er=kl([aW.config({find:A.some}),s9.config({})]);return g2.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[T("sv-palette")]},model:{mode:"xy",getInitialValue:M},rounded:!1,components:[D,B],onChange:(E,T,D)=>{Ir(E,g9,{value:D})},onInit:(E,T,D,B)=>{s(D.element.dom,uw(u7))},sliderBehaviours:er})},name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:(E,T,D)=>{((E,T)=>{let D=E.components()[0].element.dom,B=_w(T,100,100),M=iw(B);s(D,uw(M))})(T,D)},setThumb:(E,T,D)=>{((E,T)=>{let D=Tw(lw(T));g2.setValue(E,{x:D.saturation,y:100-D.value})})(T,D)}},extraApis:{}})})(0,T),er={paletteRgba:Es(u7),paletteHue:Es(0)},ec=Gh(((E,T)=>{let D=g2.parts.spectrum({dom:{tag:"div",classes:[T("hue-slider-spectrum")],attributes:{role:"presentation"}}}),B=g2.parts.thumb({dom:{tag:"div",classes:[T("hue-slider-thumb")],attributes:{role:"presentation"}}});return g2.sketch({dom:{tag:"div",classes:[T("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:x(0)},components:[D,B],sliderBehaviours:kl([s9.config({})]),onChange:(E,T,D)=>{Ir(E,g5,{value:D})}})})(0,T)),eu=Gh(M.sketch({})),eg=Gh(B.sketch({})),c=(E,T,D)=>{eu.getOpt(E).each(E=>{M.setHue(E,D)})},d=(E,T)=>{eg.getOpt(E).each(E=>{B.updateHex(E,T)})},u=(E,T,D)=>{ec.getOpt(E).each(E=>{g2.setValue(E,100-D/360*100)})},m=(E,T)=>{eu.getOpt(E).each(E=>{M.setThumb(E,T)})},g=(E,T,D,B)=>{((E,T)=>{let D=lw(E);er.paletteRgba.set(D),er.paletteHue.set(T)})(T,D),L(B,B=>{B(E,T,D)})};return{uid:D.uid,dom:D.dom,components:[eu.asSpec(),ec.asSpec(),eg.asSpec()],behaviours:kl([Jp("colour-picker-events",[Ur(g3,(()=>{let E=[c,u,m];return(T,D)=>{let B=D.event.hex,M=Tw(lw(B));g(T,B,M.hue,E)}})()),Ur(g9,(()=>{let E=[d];return(T,D)=>{let B=D.event.value,M=er.paletteHue.get(),ec=_w(M,B.x,100-B.y),eu=Ew(ec);g(T,eu,M,E)}})()),Ur(g5,(()=>{let E=[c,d];return(T,D)=>{let B=(100-D.event.value)/100*360,M=er.paletteRgba.get(),ec=Tw(M),eu=_w(B,ec.saturation,ec.value),eg=Ew(eu);g(T,eg,B,E)}})())]),aW.config({find:E=>eg.getOpt(E)}),sQ.config({mode:"acyclic"})])}}});return D},DO=()=>aW.config({find:A.some}),BO=E=>aW.config({find:T=>lt(T.element,E).bind(E=>T.getSystem().getByDom(E).toOptional())}),pu=Dn([ys("preprocess",w),ys("postprocess",w)]),IO=(E,T)=>{let D=Yn("RepresentingConfigs.memento processors",pu,T);return r6.config({store:{mode:"manual",getValue:T=>{let B=E.get(T),M=r6.getValue(B);return D.postprocess(M)},setValue:(T,B)=>{let M=D.preprocess(B),er=E.get(T);r6.setValue(er,M)}}})},RO=(E,T,D)=>r6.config({store:{mode:"manual",...E.map(E=>({initialValue:E})).getOr({}),getValue:T,setValue:D}}),NO=(E,T,D)=>RO(E,E=>T(E.element),(E,T)=>D(E.element,T)),VO=E=>r6.config({store:{mode:"memory",initialValue:E}}),pm={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"};var pg=tinymce.util.Tools.resolve("tinymce.Resource"),ph=tinymce.util.Tools.resolve("tinymce.util.Tools");let PO=(E,T)=>{let D=null,n=()=>{M(D)||(clearTimeout(D),D=null)};return{cancel:n,throttle:(...B)=>{n(),D=setTimeout(()=>{D=null,E.apply(null,B)},T)}}},pf=la("alloy-fake-before-tabstop"),pb=la("alloy-fake-after-tabstop"),jO=E=>({dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:E},behaviours:kl([s9.config({ignore:!0}),mq.config({})])}),GO=(E,T)=>({dom:{tag:"div",classes:["tox-navobj",...E.getOr([])]},components:[jO([pf]),T,jO([pb])],behaviours:kl([BO(1)])}),$O=(E,T)=>{Ir(E,t9(),{raw:{which:9,shiftKey:T}})},qO=(E,T)=>{let D=T.element;Ua(D,pf)?$O(E,!0):Ua(D,pb)&&$O(E,!1)},XO=E=>$S(E,["."+pf,"."+pb].join(","),ep),pv=la("update-dialog"),px=la("update-title"),py=la("update-body"),pA=la("update-footer"),pO=la("body-send-message"),pT=la("dialog-focus-shifted"),pD=Do().browser,pB=pD.isSafari(),pM=pD.isFirefox(),pI=pB||pM,pH=pD.isChromium(),a_=({scrollTop:E,scrollHeight:T,clientHeight:D})=>Math.ceil(E)+D>=T,i_=(E,T)=>E.scrollTo(0,"bottom"===T?99999999:T),l_=(E,T,D)=>{let B=E.dom;A.from(B.contentDocument).fold(D,E=>{let D=0,M=((E,T)=>{let D=E.body;return A.from(!/^<!DOCTYPE (html|HTML)/.test(T)&&(!pH&&!pB||g(D)&&(0!==D.scrollTop||Math.abs(D.scrollHeight-D.clientHeight)>1))?D:E.documentElement)})(E,T).map(E=>(D=E.scrollTop,E)).forall(a_),r=()=>{let E=B.contentWindow;g(E)&&(M?i_(E,"bottom"):!M&&pI&&0!==D&&i_(E,D))};pB&&B.addEventListener("load",r,{once:!0}),E.open(),E.write(T),E.close(),pB||r()})},pR=Ce(pI,pB?500:200).map(E=>{let T,D;return T=null,D=null,{cancel:()=>{M(T)||(clearTimeout(T),T=null,D=null)},throttle:(...B)=>{D=B,M(T)&&(T=setTimeout(()=>{let E=D;T=null,D=null,l_.apply(null,E)},E))}}}),pN=la("toolbar.button.execute"),pU=la("common-button-display-events"),pL={[oS()]:["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],[oz()]:["toolbar-button-events",pU],[tZ()]:["focusing","alloy.base.behaviour",pU]},g_=E=>Dt(E.element,"width",It(E.element,"width")),p_=(E,T,D)=>tb(E,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:D},T),h_=(E,T)=>p_(E,T,[]),f_=(E,T)=>p_(E,T,[s1.config({})]),b_=(E,T,D)=>({dom:{tag:"span",classes:[`${T}__select-label`]},components:[ti(D.translate(E))],behaviours:kl([s1.config({})])}),pz=la("update-menu-text"),pP=la("update-menu-icon"),x_=(E,T,D)=>{let B=Es(b),M=E.text.map(E=>Gh(b_(E,T,D.providers))),er=E.icon.map(E=>Gh(f_(E,D.providers.icons))),a=(E,T)=>{let D=r6.getValue(E);return s9.focus(D),Ir(D,"keydown",{raw:T.event.raw}),mL.close(D),A.some(!0)},ec=E.role.fold(()=>({}),E=>({role:E})),eu=E.tooltip.fold(()=>({}),E=>{let T=D.providers.translate(E);return{title:T,"aria-label":T}}),eg=tb("chevron-down",{tag:"div",classes:[`${T}__select-chevron`]},D.providers.icons),ep=la("common-button-display-events"),eh=Gh(mL.sketch({...E.uid?{uid:E.uid}:{},...ec,dom:{tag:"button",classes:[T,`${T}--select`].concat(H(E.classes,E=>`${T}--${E}`)),attributes:{...eu}},components:we([er.map(E=>E.asSpec()),M.map(E=>E.asSpec()),A.some(eg)]),matchWidth:!0,useMinWidth:!0,onOpen:(T,D,B)=>{E.searchable&&(E=>{Pv(E).each(E=>s9.focus(E))})(B)},dropdownBehaviours:kl([...E.dropdownBehaviours,kx(()=>E.disabled||D.providers.isDisabled()),Sx(),go.config({}),s1.config({}),Jp("dropdown-events",[Tx(E,B),Ex(E,B)]),Jp(ep,[oZ((E,T)=>g_(E))]),Jp("menubutton-update-display-text",[Ur(pz,(E,T)=>{M.bind(T=>T.getOpt(E)).each(E=>{s1.set(E,[ti(D.providers.translate(T.event.text))])})}),Ur(pP,(E,T)=>{er.bind(T=>T.getOpt(E)).each(E=>{s1.set(E,[f_(T.event.icon,D.providers.icons)])})})])]),eventOrder:tR(pL,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"],[oz()]:["toolbar-button-events","dropdown-events",ep]}),sandboxBehaviours:kl([sQ.config({mode:"special",onLeft:a,onRight:a}),Jp("dropdown-sandbox-events",[Ur(dy,(E,T)=>{(E=>{let T=r6.getValue(E),D=Pv(E).map(Wv);mL.refetch(T).get(()=>{let E=mD.getCoupled(T,"sandbox");D.each(T=>Pv(E).each(E=>{r6.setValue(E,T.fetchPattern),E.element.dom.selectionStart=T.selectionStart,E.element.dom.selectionEnd=T.selectionEnd}))})})(E),T.stop()}),Ur(dA,(E,T)=>{((E,T)=>{rq.getState(E).bind(aZ.getHighlighted).bind(aZ.getHighlighted).each(D=>{((E,T,D,B)=>{let M={...B,target:T};E.getSystem().triggerEvent(D,T,M)})(E,D.element,T.event.eventType,T.event.interactionEvent)})})(E,T),T.stop()})])]),lazySink:D.getSink,toggleClass:`${T}--active`,parts:{menu:{...Bv(0,E.columns,E.presets),fakeFocus:E.searchable,onHighlightItem:BS,onCollapseMenu:(E,T,D)=>{aZ.getHighlighted(D).each(T=>{BS(E,D,T)})},onDehighlightItem:FS}},getAnchorOverrides:()=>({maxHeightFunction:(E,T)=>{n8()(E,T-10)}}),fetch:T=>fS(k(E.fetch,T))}));return eh.asSpec()},w_=E=>"separator"===E.type,pG={type:"separator"},k_=(E,D)=>{let B=((E,D)=>{let B=j(E,(E,B)=>T(B)?""===B?E:"|"===B?E.length>0&&!w_(E[E.length-1])?E.concat([pG]):E:ve(D,B.toLowerCase())?E.concat([D[B.toLowerCase()]]):E:E.concat([B]),[]);return B.length>0&&w_(B[B.length-1])&&B.pop(),B})(T(E)?E.split(" "):E,D);return W(B,(E,T)=>{if(ve(T,"getSubmenuItems")){let B=(E=>{let T=be(E,"value").getOrThunk(()=>la("generated-menu-item"));return tR({value:T},E)})(T),M=((E,T)=>{let D=E.getSubmenuItems(),B=k_(D,T);return{item:E,menus:tR(B.menus,{[E.value]:B.items}),expansions:tR(B.expansions,{[E.value]:E.value})}})(B,D);return{menus:tR(E.menus,M.menus),items:[M.item,...E.items],expansions:tR(E.expansions,M.expansions)}}return{...E,items:[T,...E.items]}},{menus:{},expansions:{},items:[]})},C_=(E,T,D,B)=>{let M=la("primary-menu"),er=k_(E,D.shared.providers.menuItems());if(0===er.items.length)return A.none();let ec=B.search.fold(()=>({searchMode:"no-search"}),E=>({searchMode:"search-with-field",placeholder:E.placeholder})),eu=zS(M,er.items,T,D,B.isHorizontalMenu,ec),eg=B.search.fold(()=>({searchMode:"no-search"}),E=>({searchMode:"search-with-results"})),ep=ce(er.menus,(E,B)=>zS(B,E,T,D,!1,eg)),eh=tR(ep,Ms(M,eu));return A.from(iL.tieredData(M,eh,er.expansions))},O_=E=>!ve(E,"items"),pW="data-value",T_=(E,T,D,B)=>H(D,D=>O_(D)?{type:"togglemenuitem",text:D.text,value:D.value,active:D.value===B,onAction:()=>{r6.setValue(E,D.value),Ir(E,mY,{name:T}),s9.focus(E)}}:{type:"nestedmenuitem",text:D.text,getSubmenuItems:()=>T_(E,T,D.items,B)}),E_=(E,T)=>re(E,E=>O_(E)?Ce(E.value===T,E):E_(E.items,T)),pj=fm({name:"HtmlSelect",configFields:[os("options"),hu("selectBehaviours",[s9,r6]),ys("selectClasses",[]),ys("selectAttributes",{}),us("data")],factory:(E,T)=>{let D=H(E.options,E=>({dom:{tag:"option",value:E.value,innerHtml:E.text}})),B=E.data.map(E=>Ms("initialValue",E)).getOr({});return{uid:E.uid,dom:{tag:"select",classes:E.selectClasses,attributes:E.selectAttributes},components:D,behaviours:bu(E.selectBehaviours,[s9.config({}),r6.config({store:{mode:"manual",getValue:E=>$a(E.element),setValue:(T,D)=>{let B=oe(E.options);G(E.options,E=>E.value===D).isSome()?qa(T.element,D):-1===T.element.dom.selectedIndex&&""===D&&B.each(E=>qa(T.element,E.value))},...B}})])}}}),pJ=x([ys("field1Name","field1"),ys("field2Name","field2"),Fi("onLockedChange"),Ai(["lockClass"]),ys("locked",!1),hu("coupledFieldBehaviours",[aW,r6])]),D_=(E,T)=>aT({factory:mJ,name:E,overrides:E=>({fieldBehaviours:kl([Jp("coupled-input-behaviour",[Ur(t6(),D=>{om(D,E,T).bind(aW.getCurrent).each(T=>{om(D,E,"lock").each(B=>{s7.isOn(B)&&E.onLockedChange(D,T,B)})})})])])})}),p$=x([D_("field1","field2"),D_("field2","field1"),aT({factory:iG,schema:[os("dom")],name:"lock",overrides:E=>({buttonBehaviours:kl([s7.config({selected:E.locked,toggleClass:E.markers.lockClass,aria:{mode:"pressed"}})])})})]),pX=bm({name:"FormCoupledInputs",configFields:pJ(),partFields:p$(),factory:(E,T,D,B)=>({uid:E.uid,dom:E.dom,components:T,behaviours:bu(E.coupledFieldBehaviours,[aW.config({find:A.some}),r6.config({store:{mode:"manual",getValue:T=>{let D=im(T,E,["field1","field2"]);return{[E.field1Name]:r6.getValue(D.field1()),[E.field2Name]:r6.getValue(D.field2())}},setValue:(T,D)=>{let B=im(T,E,["field1","field2"]);ye(D,E.field1Name)&&r6.setValue(B.field1(),D[E.field1Name]),ye(D,E.field2Name)&&r6.setValue(B.field2(),D[E.field2Name])}}})]),apis:{getField1:T=>om(T,E,"field1"),getField2:T=>om(T,E,"field2"),getLock:T=>om(T,E,"lock")}}),apis:{getField1:(E,T)=>E.getField1(T),getField2:(E,T)=>E.getField2(T),getLock:(E,T)=>E.getLock(T)}}),I_=E=>{let T=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(E);if(null!==T){let E=parseFloat(T[1]),D=T[2];return tH.value({value:E,unit:D})}return tH.error(E)},R_=(E,T)=>{let D={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},n=E=>ve(D,E);return E.unit===T?A.some(E.value):n(E.unit)&&n(T)?D[E.unit]===D[T]?A.some(E.value):A.some(E.value/D[E.unit]*D[T]):A.none()},N_=E=>A.none(),V_=(E,T)=>{let D=E.label.map(E=>pk(E,T)),B=[aq.config({disabled:()=>E.disabled||T.isDisabled()}),Sx(),sQ.config({mode:"execution",useEnter:!0!==E.multiline,useControlEnter:!0===E.multiline,execute:E=>(Fr(E,m1),A.some(!0))}),Jp("textfield-change",[Ur(t6(),(T,D)=>{Ir(T,mY,{name:E.name})}),Ur(ow(),(T,D)=>{Ir(T,mY,{name:E.name})})]),mq.config({})],M=E.validation.map(E=>gt.config({getRoot:E=>rt(E.element),invalidClass:"tox-invalid",validator:{validate:T=>{let D=r6.getValue(T),B=E.validator(D);return bS(!0===B?tH.value(D):tH.error(B))},validateOnLoad:E.validateOnLoad}})).toArray(),er={...E.placeholder.fold(x({}),E=>({placeholder:T.translate(E)})),...E.inputMode.fold(x({}),E=>({inputmode:E}))},ec=mJ.parts.field({tag:!0===E.multiline?"textarea":"input",...E.data.map(E=>({data:E})).getOr({}),inputAttributes:er,inputClasses:[E.classname],inputBehaviours:kl(q([B,M])),selectOnFocus:!1,factory:dx}),eu=E.multiline?{dom:{tag:"div",classes:["tox-textarea-wrap"]},components:[ec]}:ec,eg=(E.flex?["tox-form__group--stretched"]:[]).concat(E.maximized?["tox-form-group--maximize"]:[]),ep=[aq.config({disabled:()=>E.disabled||T.isDisabled(),onDisabled:E=>{mJ.getField(E).each(aq.disable)},onEnabled:E=>{mJ.getField(E).each(aq.enable)}}),Sx()];return uk(D,eu,eg,ep)},z_=(E,T)=>T.getAnimationRoot.fold(()=>E.element,T=>T(E)),H_=E=>E.dimension.property,L_=(E,T)=>E.dimension.getDimension(T),P_=(E,T)=>{let D=z_(E,T);ja(D,[T.shrinkingClass,T.growingClass])},U_=(E,T)=>{Pa(E.element,T.openClass),La(E.element,T.closedClass),Dt(E.element,H_(T),"0px"),Lt(E.element)},W_=(E,T)=>{Pa(E.element,T.closedClass),La(E.element,T.openClass),Ht(E.element,H_(T))},j_=(E,T,D,B)=>{D.setCollapsed(),Dt(E.element,H_(T),L_(T,E.element)),P_(E,T),U_(E,T),T.onStartShrink(E),T.onShrunk(E)},G_=(E,T,D,B)=>{let M=B.getOrThunk(()=>L_(T,E.element));D.setCollapsed(),Dt(E.element,H_(T),M),Lt(E.element);let er=z_(E,T);Pa(er,T.growingClass),La(er,T.shrinkingClass),U_(E,T),T.onStartShrink(E)},$_=(E,T,D)=>{let B=L_(T,E.element);("0px"===B?j_:G_)(E,T,D,A.some(B))},q_=(E,T,D)=>{let B=z_(E,T),M=Ua(B,T.shrinkingClass),er=L_(T,E.element);W_(E,T);let ec=L_(T,E.element);(M?()=>{Dt(E.element,H_(T),er),Lt(E.element)}:()=>{U_(E,T)})(),Pa(B,T.shrinkingClass),La(B,T.growingClass),W_(E,T),Dt(E.element,H_(T),ec),D.setExpanded(),T.onStartGrow(E)},X_=(E,T,D)=>{let B=z_(E,T);return!0===Ua(B,T.growingClass)},Y_=(E,T,D)=>{let B=z_(E,T);return!0===Ua(B,T.shrinkingClass)};var pq=Object.freeze({__proto__:null,refresh:(E,T,D)=>{if(D.isExpanded()){Ht(E.element,H_(T));let D=L_(T,E.element);Dt(E.element,H_(T),D)}},grow:(E,T,D)=>{D.isExpanded()||q_(E,T,D)},shrink:(E,T,D)=>{D.isExpanded()&&$_(E,T,D)},immediateShrink:(E,T,D)=>{D.isExpanded()&&j_(E,T,D)},hasGrown:(E,T,D)=>D.isExpanded(),hasShrunk:(E,T,D)=>D.isCollapsed(),isGrowing:X_,isShrinking:Y_,isTransitioning:(E,T,D)=>X_(E,T)||Y_(E,T),toggleGrow:(E,T,D)=>{(D.isExpanded()?$_:q_)(E,T,D)},disableTransitions:P_,immediateGrow:(E,T,D)=>{D.isExpanded()||(W_(E,T),Dt(E.element,H_(T),L_(T,E.element)),P_(E,T),D.setExpanded(),T.onStartGrow(E),T.onGrown(E))}}),pK=Object.freeze({__proto__:null,exhibit:(E,T,D)=>{let B=T.expanded;return Ea(B?{classes:[T.openClass],styles:{}}:{classes:[T.closedClass],styles:Ms(T.dimension.property,"0px")})},events:(E,T)=>Hr([Yr(or(),(D,B)=>{B.event.raw.propertyName===E.dimension.property&&(P_(D,E),T.isExpanded()&&Ht(D.element,E.dimension.property),(T.isExpanded()?E.onGrown:E.onShrunk)(D))})])}),pY=[os("closedClass"),os("openClass"),os("shrinkingClass"),os("growingClass"),us("getAnimationRoot"),Di("onShrunk"),Di("onStartShrink"),Di("onGrown"),Di("onStartGrow"),ys("expanded",!1),ns("dimension",Jn("property",{width:[Ri("property","width"),Ri("getDimension",E=>Jt(E)+"px")],height:[Ri("property","height"),Ri("getDimension",E=>Wt(E)+"px")]}))];let pZ=Ol({fields:pY,name:"sliding",active:pK,apis:pq,state:Object.freeze({__proto__:null,init:E=>{let T=Es(E.expanded);return _a({isExpanded:()=>!0===T.get(),isCollapsed:()=>!1===T.get(),setCollapsed:k(T.set,!1),setExpanded:k(T.set,!0),readState:()=>"expanded: "+T.get()})}})}),eT=E=>({isEnabled:()=>!aq.isDisabled(E),setEnabled:T=>aq.set(E,!T),setActive:T=>{let D=E.element;T?(La(D,"tox-tbtn--enabled"),kt(D,"aria-pressed",!0)):(Pa(D,"tox-tbtn--enabled"),Et(D,"aria-pressed"))},isActive:()=>Ua(E.element,"tox-tbtn--enabled"),setText:T=>{Ir(E,pz,{text:T})},setIcon:T=>Ir(E,pP,{icon:T})}),tT=(E,T,D,B,M=!0)=>x_({text:E.text,icon:E.icon,tooltip:E.tooltip,searchable:E.search.isSome(),role:B,fetch:(T,B)=>{let M={pattern:E.search.isSome()?IS(T):""};E.fetch(T=>{B(C_(T,c5.CLOSE_ON_EXECUTE,D,{isHorizontalMenu:!1,search:E.search}))},M,eT(T))},onSetup:E.onSetup,getApi:eT,columns:1,presets:"normal",classes:[],dropdownBehaviours:[...M?[mq.config({})]:[]]},T,D.shared),oT=(E,T,D)=>{let n=E=>B=>{let M=!B.isActive();B.setActive(M),E.storage.set(M),D.shared.getSink().each(D=>{T().getOpt(D).each(T=>{Dl(T.element),Ir(T,m0,{name:E.name,value:E.storage.get()})})})},s=E=>T=>{T.setActive(E.storage.get())};return T=>{T(H(E,E=>{let T=E.text.fold(()=>({}),E=>({text:E}));return{type:E.type,active:!1,...T,onAction:n(E),onSetup:s(E)}}))}},nT=E=>({dom:{tag:"span",classes:["tox-tree__label"],attributes:{title:E,"aria-label":E}},components:[ti(E)]}),pQ=la("leaf-label-event-id"),rT=({leaf:E,onLeafAction:T,visible:D,treeId:B,selectedId:M,backstage:er})=>{let ec=E.menu.map(E=>tT(E,"tox-mbtn",er,A.none(),D)),eu=[nT(E.title)];return ec.each(E=>eu.push(E)),iG.sketch({dom:{tag:"div",classes:["tox-tree--leaf__label","tox-trbtn"].concat(D?["tox-tree--leaf__label--visible"]:[])},components:eu,role:"treeitem",action:D=>{T(E.id),D.getSystem().broadcastOn([`update-active-item-${B}`],{value:E.id})},eventOrder:{[t9()]:[pQ,"keying"]},buttonBehaviours:kl([...D?[mq.config({})]:[],s7.config({toggleClass:"tox-trbtn--enabled",toggleOnExecute:!1,aria:{mode:"selected"}}),nQ.config({channels:{[`update-active-item-${B}`]:{onReceive:(T,D)=>{(D.value===E.id?s7.on:s7.off)(T)}}}}),Jp(pQ,[oZ((T,D)=>{M.each(D=>{(D===E.id?s7.on:s7.off)(T)})}),Ur(t9(),(E,T)=>{let D="ArrowLeft"===T.event.raw.code,B="ArrowRight"===T.event.raw.code;D?(mi(E.element,".tox-tree--directory").each(T=>{E.getSystem().getByDom(T).each(E=>{gi(T,".tox-tree--directory__label").each(T=>{E.getSystem().getByDom(T).each(s9.focus)})})}),T.stop()):B&&T.stop()})])])})},p0=la("directory-label-event-id"),iT=({directory:E,visible:T,noChildren:D,backstage:B})=>{var M;let er=E.menu.map(E=>tT(E,"tox-mbtn",B,A.none())),ec=[{dom:{tag:"div",classes:["tox-chevron"]},components:[tb("chevron-right",{tag:"span",classes:["tox-tree__icon-wrap","tox-icon"],behaviours:[]},B.shared.providers.icons)]},nT(E.title)];er.each(E=>{ec.push(E)});let l=T=>{mi(T.element,".tox-tree--directory").each(D=>{T.getSystem().getByDom(D).each(D=>{let B=!s7.isOn(D);s7.toggle(D),Ir(T,"expand-tree-node",{expanded:B,node:E.id})})})};return iG.sketch({dom:{tag:"div",classes:["tox-tree--directory__label","tox-trbtn"].concat(T?["tox-tree--directory__label--visible"]:[])},components:ec,action:l,eventOrder:{[t9()]:[p0,"keying"]},buttonBehaviours:kl([...T?[mq.config({})]:[],Jp(p0,[Ur(t9(),(E,T)=>{let B="ArrowRight"===T.event.raw.code,M="ArrowLeft"===T.event.raw.code;B&&D&&T.stop(),(B||M)&&mi(E.element,".tox-tree--directory").each(D=>{E.getSystem().getByDom(D).each(D=>{!s7.isOn(D)&&B||s7.isOn(D)&&M?(l(E),T.stop()):M&&!s7.isOn(D)&&(mi(D.element,".tox-tree--directory").each(E=>{gi(E,".tox-tree--directory__label").each(E=>{D.getSystem().getByDom(E).each(s9.focus)})}),T.stop())})})})])])})},lT=({children:E,onLeafAction:T,visible:D,treeId:B,expandedIds:M,selectedId:er,backstage:ec})=>({dom:{tag:"div",classes:["tox-tree--directory__children"]},components:E.map(E=>"leaf"===E.type?rT({leaf:E,selectedId:er,onLeafAction:T,visible:D,treeId:B,backstage:ec}):dT({directory:E,expandedIds:M,selectedId:er,onLeafAction:T,labelTabstopping:D,treeId:B,backstage:ec})),behaviours:kl([pZ.config({dimension:{property:"height"},closedClass:"tox-tree--directory__children--closed",openClass:"tox-tree--directory__children--open",growingClass:"tox-tree--directory__children--growing",shrinkingClass:"tox-tree--directory__children--shrinking",expanded:D}),s1.config({})])}),p1=la("directory-event-id"),dT=({directory:E,onLeafAction:T,labelTabstopping:D,treeId:B,backstage:M,expandedIds:er,selectedId:ec})=>{let{children:eu}=E,eg=Es(er),ep=er.includes(E.id);return{dom:{tag:"div",classes:["tox-tree--directory"],attributes:{role:"treeitem"}},components:[iT({directory:E,visible:D,noChildren:0===E.children.length,backstage:M}),lT({children:eu,expandedIds:er,selectedId:ec,onLeafAction:T,visible:ep,treeId:B,backstage:M})],behaviours:kl([Jp(p1,[oZ((E,T)=>{s7.set(E,ep)}),Ur("expand-tree-node",(E,T)=>{let{expanded:D,node:B}=T.event;eg.set(D?[...eg.get(),B]:eg.get().filter(E=>E!==B))})]),s7.config({...E.children.length>0?{aria:{mode:"expanded"}}:{},toggleClass:"tox-tree--directory--expanded",onToggled:(E,D)=>{let er=E.components()[1],ep=eu.map(E=>"leaf"===E.type?rT({leaf:E,selectedId:ec,onLeafAction:T,visible:D,treeId:B,backstage:M}):dT({directory:E,expandedIds:eg.get(),selectedId:ec,onLeafAction:T,labelTabstopping:D,treeId:B,backstage:M}));D?pZ.grow(er):pZ.shrink(er),s1.set(er,ep)}})])}},p2=la("tree-event-id");var p3=Object.freeze({__proto__:null,events:(E,T)=>{let D=E.stream.streams.setup(E,T);return Hr([Ur(E.event,D),oQ(()=>T.cancel())].concat(E.cancelEvent.map(E=>[Ur(E,()=>T.cancel())]).getOr([])))}});let gT=E=>{let T=Es(null);return _a({readState:()=>({timer:null!==T.get()?"set":"unset"}),setTimer:E=>{T.set(E)},cancel:()=>{let E=T.get();null!==E&&E.cancel()}})};var p5=Object.freeze({__proto__:null,throttle:gT,init:E=>E.stream.streams.state(E)}),p9=[ns("stream",Jn("mode",{throttle:[os("delay"),ys("stopEvent",!0),Ri("streams",{setup:(E,T)=>{let D=E.stream,B=PO(E.onStream,D.delay);return T.setTimer(B),(E,T)=>{B.throttle(E,T),D.stopEvent&&T.stop()}},state:gT})]})),ys("event","input"),us("cancelEvent"),Fi("onStream")];let p4=Ol({fields:p9,name:"streaming",active:p3,state:p5}),bT=(E,T,D)=>{let B=r6.getValue(D);r6.setValue(T,B),yT(T)},vT=(E,T)=>{let D=E.element,B=$a(D),M=D.dom;"number"!==Ot(D,"type")&&T(M,B)},yT=E=>{vT(E,(E,T)=>E.setSelectionRange(T.length,T.length))},p6=x("alloy.typeahead.itemexecute"),p8=x([us("lazySink"),os("fetch"),ys("minChars",5),ys("responseTime",1e3),Di("onOpen"),ys("getHotspot",A.some),ys("getAnchorOverrides",x({})),ys("layouts",A.none()),ys("eventOrder",{}),Ts("model",{},[ys("getDisplayText",E=>void 0!==E.meta&&void 0!==E.meta.text?E.meta.text:E.value),ys("selectsOver",!0),ys("populateFromBrowse",!0)]),Di("onSetValue"),Bi("onExecute"),Di("onItemExecute"),ys("inputClasses",[]),ys("inputAttributes",{}),ys("inputStyles",{}),ys("matchWidth",!0),ys("useMinWidth",!1),ys("dismissOnBlur",!0),Ai(["openClass"]),us("initialData"),hu("typeaheadBehaviours",[s9,r6,p4,sQ,s7,mD]),es("lazyTypeaheadComp",()=>Es(A.none)),es("previewing",()=>Es(!0))].concat(dv()).concat(ES())),p7=x([aF({schema:[Ei()],name:"menu",overrides:E=>({fakeFocus:!0,onHighlightItem:(T,D,B)=>{E.previewing.get()?E.lazyTypeaheadComp.get().each(T=>{((E,T,D)=>{if(E.selectsOver){let B=r6.getValue(T),M=E.getDisplayText(B),er=r6.getValue(D);return 0===E.getDisplayText(er).indexOf(M)?A.some(()=>{var E;bT(0,T,D),E=M.length,vT(T,(T,D)=>T.setSelectionRange(E,D.length))}):A.none()}return A.none()})(E.model,T,B).fold(()=>{E.model.selectsOver?(aZ.dehighlight(D,B),E.previewing.set(!0)):E.previewing.set(!1)},T=>{T(),E.previewing.set(!1)})}):E.lazyTypeaheadComp.get().each(T=>{E.model.populateFromBrowse&&bT(E.model,T,B),_t(B.element,"id").each(E=>kt(T.element,"aria-activedescendant",E))})},onExecute:(T,D)=>E.lazyTypeaheadComp.get().map(E=>(Ir(E,p6(),{item:D}),!0)),onHover:(T,D)=>{E.previewing.set(!1),E.lazyTypeaheadComp.get().each(T=>{E.model.populateFromBrowse&&bT(E.model,T,D)})}})})]),ht=bm({name:"Typeahead",configFields:p8(),partFields:p7(),factory:(E,T,D,B)=>{let s=(T,D,M)=>{E.previewing.set(!1);let er=mD.getCoupled(T,"sandbox");rq.isOpen(er)?aW.getCurrent(er).each(E=>{aZ.getHighlighted(E).fold(()=>{M(E)},()=>{zr(er,E.element,"keydown",D)})}):wS(E,a(T),T,er,B,E=>{aW.getCurrent(E).each(M)},i8.HighlightMenuAndItem).get(b)},M=Iv(E),a=E=>T=>T.map(T=>{let D=fe(T.menus),B=X(D,E=>U(E.items,E=>"item"===E.type));return r6.getState(E).update(H(B,E=>E.data)),T}),i=E=>aW.getCurrent(E),er="typeaheadevents",ec=[s9.config({}),r6.config({onSetValue:E.onSetValue,store:{mode:"dataset",getDataKey:E=>$a(E.element),getFallbackEntry:E=>({value:E,meta:{}}),setValue:(T,D)=>{qa(T.element,E.model.getDisplayText(D))},...E.initialData.map(E=>Ms("initialValue",E)).getOr({})}}),p4.config({stream:{mode:"throttle",delay:E.responseTime,stopEvent:!1},onStream:(T,D)=>{let M=mD.getCoupled(T,"sandbox");if(s9.isFocused(T)&&$a(T.element).length>=E.minChars){let D=i(M).bind(E=>aZ.getHighlighted(E).map(r6.getValue));E.previewing.set(!0),wS(E,a(T),T,M,B,T=>{i(M).each(T=>{D.fold(()=>{E.model.selectsOver&&aZ.highlightFirst(T)},E=>{aZ.highlightBy(T,T=>r6.getValue(T).value===E.value),aZ.getHighlighted(T).orThunk(()=>(aZ.highlightFirst(T),A.none()))})})},i8.HighlightJustMenu).get(b)}},cancelEvent:oI()}),sQ.config({mode:"special",onDown:(E,T)=>(s(E,T,aZ.highlightFirst),A.some(!0)),onEscape:E=>{let T=mD.getCoupled(E,"sandbox");return rq.isOpen(T)?(rq.close(T),A.some(!0)):A.none()},onUp:(E,T)=>(s(E,T,aZ.highlightLast),A.some(!0)),onEnter:T=>{let D=mD.getCoupled(T,"sandbox"),B=rq.isOpen(D);if(B&&!E.previewing.get())return i(D).bind(E=>aZ.getHighlighted(E)).map(E=>(Ir(T,p6(),{item:E}),!0));{let M=r6.getValue(T);return Fr(T,oI()),E.onExecute(D,T,M),B&&rq.close(D),A.some(!0)}}}),s7.config({toggleClass:E.markers.openClass,aria:{mode:"expanded"}}),mD.config({others:{sandbox:T=>_S(E,T,{onOpen:()=>s7.on(T),onClose:()=>{E.lazyTypeaheadComp.get().each(E=>Et(E.element,"aria-activedescendant")),s7.off(T)}})}}),Jp(er,[oZ(T=>{E.lazyTypeaheadComp.set(A.some(T))}),oQ(T=>{E.lazyTypeaheadComp.set(A.none())}),o1(T=>{kS(E,a(T),T,B,b,i8.HighlightMenuAndItem).get(b)}),Ur(p6(),(T,D)=>{let B=mD.getCoupled(T,"sandbox");bT(E.model,T,D.event.item),Fr(T,oI()),E.onItemExecute(T,B,D.event.item,r6.getValue(T)),rq.close(B),yT(T)})].concat(E.dismissOnBlur?[Ur(oy(),E=>{let T=mD.getCoupled(E,"sandbox");Rl(T.element).isNone()&&rq.close(T)})]:[]))],eu={[oP()]:[r6.name(),p4.name(),er],...E.eventOrder};return{uid:E.uid,dom:Nv(tR(E,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:{...M,...bu(E.typeaheadBehaviours,ec)},eventOrder:eu}}}),CT=E=>({...E,toCached:()=>CT(E.toCached()),bindFuture:T=>CT(E.bind(E=>E.fold(E=>bS(tH.error(E)),E=>T(E)))),bindResult:T=>CT(E.map(E=>E.bind(T))),mapResult:T=>CT(E.map(E=>E.map(T))),mapError:T=>CT(E.map(E=>E.mapError(T))),foldResult:(T,D)=>E.map(E=>E.fold(T,D)),withTimeout:(T,D)=>CT(fS(B=>{let M=!1,er=setTimeout(()=>{M=!0,B(tH.error(D()))},T);E.get(E=>{M||(clearTimeout(er),B(E))})}))}),OT=E=>CT(fS(E)),_T=(E,T,D=[],B,M,er)=>{let ec=T.fold(()=>({}),E=>({action:E})),eu={buttonBehaviours:kl([kx(()=>!E.enabled||er.isDisabled()),Sx(),mq.config({}),Jp("button press",[Pr("click"),Pr("mousedown")])].concat(D)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]},...ec},eg=tR(eu,{dom:B});return tR(eg,{components:M})},TT=(E,T,D,B=[])=>{let M={tag:"button",classes:["tox-tbtn"],attributes:E.tooltip.map(E=>({"aria-label":D.translate(E),title:D.translate(E)})).getOr({})},er=E.icon.map(E=>h_(E,D.icons)),ec=we([er]);return _T(E,T,B,M,ec,D)},ET=E=>{switch(E){case"primary":return["tox-button"];case"toolbar":return["tox-tbtn"];default:return["tox-button","tox-button--secondary"]}},AT=(E,T,D,B=[],M=[])=>{let er=D.translate(E.text),ec=E.icon.map(E=>h_(E,D.icons)),eu=[ec.getOrThunk(()=>ti(er))],eg=E.buttonType.getOr(E.primary||E.borderless?"primary":"secondary"),ep=[...ET(eg),...ec.isSome()?["tox-button--icon"]:[],...E.borderless?["tox-button--naked"]:[],...M];return _T(E,T,B,{tag:"button",classes:ep,attributes:{title:er}},eu,D)},MT=(E,T,D,B=[],M=[])=>{let er=AT(E,A.some(T),D,B,M);return iG.sketch(er)},DT=(E,T)=>D=>{"custom"===T?Ir(D,m0,{name:E,value:{}}):"submit"===T?Fr(D,m1):"cancel"===T?Fr(D,mQ):console.error("Unknown button type: ",T)},BT=(E,T,D)=>{if("menu"===T){let T={...E,type:"menubutton",search:A.none(),onSetup:T=>(T.setEnabled(E.enabled),b),fetch:oT(E.items,()=>B,D)},B=Gh(tT(T,"tox-tbtn",D,A.none()));return B.asSpec()}if("custom"===T||"cancel"===T||"submit"===T){let B=DT(E.name,T),M={...E,borderless:!1};return MT(M,B,D.shared.providers,[])}if("togglebutton"===T)return((E,T)=>{var D,B;let M=E.icon.map(E=>f_(E,T.icons)).map(Gh),er=E.buttonType.getOr(E.primary?"primary":"secondary"),ec={...E,name:null!==(D=E.name)&&void 0!==D?D:"",primary:"primary"===er,tooltip:A.from(E.tooltip),enabled:null!==(B=E.enabled)&&void 0!==B&&B,borderless:!1},eu=ec.tooltip.map(E=>({"aria-label":T.translate(E),title:T.translate(E)})).getOr({}),eg=ET(null!=er?er:"secondary"),ep=E.icon.isSome()&&E.text.isSome(),eh={tag:"button",classes:[...eg.concat(E.icon.isSome()?["tox-button--icon"]:[]),...E.active?["tox-button--enabled"]:[],...ep?["tox-button--icon-and-text"]:[]],attributes:eu},ef=T.translate(E.text.getOr("")),ex=ti(ef),ew=[...we([M.map(E=>E.asSpec())]),...E.text.isSome()?[ex]:[]],e_=_T(ec,A.some(D=>{Ir(D,m0,{name:E.name,value:{setIcon:E=>{M.map(B=>B.getOpt(D).each(D=>{s1.set(D,[f_(E,T.icons)])}))}}})}),[],eh,ew,T);return iG.sketch(e_)})(E,D.shared.providers);throw console.error("Unknown footer button type: ",T),Error("Unknown footer button type")},hr={type:"separator"},IT=E=>({type:"menuitem",value:E.url,text:E.title,meta:{attach:E.attach},onAction:b}),RT=(E,T)=>({type:"menuitem",value:T,text:E,meta:{attach:void 0},onAction:b}),NT=(E,T)=>H(U(T,T=>T.type===E),IT),VT=E=>NT("header",E.targets),zT=E=>NT("anchor",E.targets),HT=E=>A.from(E.anchorTop).map(E=>RT("<top>",E)).toArray(),LT=E=>A.from(E.anchorBottom).map(E=>RT("<bottom>",E)).toArray(),PT=(E,T)=>{let D=E.toLowerCase();return U(T,E=>{var T;let B=void 0!==E.meta&&void 0!==E.meta.text?E.meta.text:E.text,M=null!==(T=E.value)&&void 0!==T?T:"";return Te(B.toLowerCase(),D)||Te(M.toLowerCase(),D)})},hc=la("aria-invalid"),WT=(E,T)=>{E.dom.checked=T},jT=E=>E.dom.checked,GT=E=>(T,D,B,M)=>be(D,"name").fold(()=>E(D,M,A.none()),er=>T.field(er,E(D,M,be(B,er)))),hd={bar:GT((E,T)=>{var D;return D=T.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:H(E.items,D.interpreter)}}),collection:GT((E,T,D)=>((E,T,D)=>{var B;let M=E.label.map(E=>pk(E,T)),s=E=>(T,D)=>{hi(D.event.target,"[data-collection-item-value]").each(B=>{E(T,D,B,Ot(B,"data-collection-item-value"))})},er=s((D,B,M,er)=>{B.stop(),T.isDisabled()||Ir(D,m0,{name:E.name,value:er})}),ec=[Ur(t2(),s((E,T,D)=>{Dl(D)})),Ur(t7(),er),Ur(o_(),er),Ur(t3(),s((E,T,D)=>{pi(E.element,"."+du).each(E=>{Pa(E,du)}),La(D,du)})),Ur(t5(),s(E=>{pi(E.element,"."+du).each(E=>{Pa(E,du)})})),o1(s((T,D,B,M)=>{Ir(T,m0,{name:E.name,value:M})}))],i=(E,T)=>H(Xc(E.element,".tox-collection__item"),T),eu=mJ.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==E.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:w},behaviours:kl([aq.config({disabled:T.isDisabled,onDisabled:E=>{i(E,E=>{La(E,"tox-collection__item--state-disabled"),kt(E,"aria-disabled",!0)})},onEnabled:E=>{i(E,E=>{Pa(E,"tox-collection__item--state-disabled"),Et(E,"aria-disabled")})}}),Sx(),s1.config({}),r6.config({store:{mode:"memory",initialValue:D.getOr([])},onSetValue:(D,B)=>{((D,B)=>{let M=H(B,D=>{let B=lQ.translate(D.text),M=1===E.columns?`<div class="tox-collection__item-label">${B}</div>`:"",er=`<div class="tox-collection__item-icon">${D.icon}</div>`,ec={_:" "," - ":" ","-":" "},eu=B.replace(/\_| \- |\-/g,E=>ec[E]);return`<div class="tox-collection__item${T.isDisabled()?" tox-collection__item--state-disabled":""}" tabindex="-1" data-collection-item-value="${mK.encodeAllRaw(D.value)}" title="${eu}" aria-label="${eu}">${er}${M}</div>`}),er="auto"!==E.columns&&E.columns>1?z(M,E.columns):[M],ec=H(er,E=>`<div class="tox-collection__group">${E.join("")}</div>`);ta(D.element,ec.join(""))})(D,B),"auto"===E.columns&&ix(D,5,"tox-collection__item").each(({numRows:E,numColumns:T})=>{sQ.setGridSize(D,E,T)}),Fr(D,m9)}}),mq.config({}),sQ.config(1===(B=E.columns)?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===B?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:".tox-collection__group",cell:`.${c4}`}}),Jp("collection-events",ec)]),eventOrder:{[oS()]:["disabling","alloy.base.behaviour","collection-events"]}});return uk(M,eu,["tox-form__group--collection"],[])})(E,T.shared.providers,D)),alertbanner:GT((E,T)=>((E,T)=>{let D=Zf(E.icon,T.icons);return mG.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in",`tox-notification--${E.level}`]},components:[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:E.url?void 0:D},components:E.url?[iG.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:D,attributes:{title:T.translate(E.iconTooltip)}},action:T=>Ir(T,m0,{name:"alert-banner",value:E.url}),buttonBehaviours:kl([Qf()])})]:void 0},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:T.translate(E.text)}}]})})(E,T.shared.providers)),input:GT((E,T,D)=>{var B;return B=T.shared.providers,V_({name:E.name,multiline:!1,label:E.label,inputMode:E.inputMode,placeholder:E.placeholder,flex:!1,disabled:!E.enabled,classname:"tox-textfield",validation:A.none(),maximized:E.maximized,data:D},B)}),textarea:GT((E,T,D)=>{var B;return B=T.shared.providers,V_({name:E.name,multiline:!0,label:E.label,inputMode:A.none(),placeholder:E.placeholder,flex:!0,disabled:!E.enabled,classname:"tox-textarea",validation:A.none(),maximized:E.maximized,data:D},B)}),label:GT((E,T)=>((E,T)=>{let D="tox-label";return{dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"label",classes:[D,..."center"===E.align?[`${D}--center`]:[],..."end"===E.align?[`${D}--end`]:[]]},components:[ti(T.providers.translate(E.label))]},...H(E.items,T.interpreter)],behaviours:kl([DO(),s1.config({}),NO(A.none(),ea,ta),sQ.config({mode:"acyclic"})])}})(E,T.shared)),iframe:(hW=(E,T,D)=>((E,T,D)=>{let B="tox-dialog__iframe",M=E.transparent?[]:[`${B}--opaque`],er=E.border?["tox-navobj-bordered"]:[],ec={...E.label.map(E=>({title:E})).getOr({}),...D.map(E=>({srcdoc:E})).getOr({}),...E.sandboxed?{sandbox:"allow-scripts allow-same-origin"}:{}},eu=((E,T)=>{let D=Es(E.getOr(""));return{getValue:E=>D.get(),setValue:(E,B)=>{if(D.get()!==B){let D=E.element,s=()=>kt(D,"srcdoc",B);T?pR.fold(x(l_),E=>E.throttle)(D,B,s):s()}D.set(B)}}})(D,E.streamContent),eg=E.label.map(E=>pk(E,T)),ep=mJ.parts.field({factory:{sketch:E=>GO(A.from(er),{uid:E.uid,dom:{tag:"iframe",attributes:ec,classes:[B,...M]},behaviours:kl([mq.config({}),s9.config({}),RO(D,eu.getValue,eu.setValue),nQ.config({channels:{[pT]:{onReceive:(E,T)=>{T.newFocus.each(T=>{rt(E.element).each(D=>{(Ze(E.element,T)?La:Pa)(D,"tox-navobj-bordered-focus")})})}}}})])})}});return uk(eg,ep,["tox-form__group--stretched"],[])})(E,T.shared.providers,D),(E,T,D,B)=>{let M=tR(T,{source:"dynamic"});return GT(hW)(E,M,D,B)}),button:GT((E,T)=>((E,T)=>{let D=DT(E.name,"custom");return uk(A.none(),mJ.parts.field({factory:iG,...AT(E,A.some(D),T,[VO(""),DO()])}),[],[])})(E,T.shared.providers)),checkbox:GT((E,T,D)=>((E,T,D)=>{let n=E=>(E.element.dom.click(),A.some(!0)),B=mJ.parts.field({factory:{sketch:w},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:kl([DO(),aq.config({disabled:()=>!E.enabled||T.isDisabled(),onDisabled:E=>{rt(E.element).each(E=>La(E,"tox-checkbox--disabled"))},onEnabled:E=>{rt(E.element).each(E=>Pa(E,"tox-checkbox--disabled"))}}),mq.config({}),s9.config({}),NO(D,jT,WT),sQ.config({mode:"special",onEnter:n,onSpace:n,stopSpaceKeyup:!0}),Jp("checkbox-events",[Ur(t8(),(T,D)=>{Ir(T,mY,{name:E.name})})])])}),M=mJ.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"]},components:[ti(T.translate(E.label))],behaviours:kl([go.config({})])}),a=E=>tb("checked"===E?"selected":"unselected",{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+E]},T.icons),er=Gh({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[a("checked"),a("unchecked")]});return mJ.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[B,er.asSpec(),M],fieldBehaviours:kl([aq.config({disabled:()=>!E.enabled||T.isDisabled()}),Sx()])})})(E,T.shared.providers,D)),colorinput:GT((E,T,D)=>((E,T,D,B)=>{var M;let er=mJ.parts.field({factory:dx,inputClasses:["tox-textfield"],data:B,onSetValue:E=>gt.run(E).get(b),inputBehaviours:kl([aq.config({disabled:T.providers.isDisabled}),Sx(),mq.config({}),gt.config({invalidClass:"tox-textbox-field-invalid",getRoot:E=>rt(E.element),notify:{onValid:E=>{let T=r6.getValue(E);Ir(E,gr,{color:T})}},validator:{validateOnLoad:!1,validate:E=>{let T=r6.getValue(E);if(0===T.length)return bS(tH.value(!0));{let E=Re("span");Dt(E,"background-color",T);let D=Nt(E,"background-color").fold(()=>tH.error("blah"),E=>tH.value(T));return bS(D)}}}})]),selectOnFocus:!1}),ec=E.label.map(E=>pk(E,T.providers)),a=(E,T)=>{Ir(E,gu,{value:T})},eu=Gh((M={dom:{tag:"span",attributes:{"aria-label":T.providers.translate("Color swatch")}},layouts:{onRtl:()=>[rl,sl,cl],onLtr:()=>[sl,rl,cl]},components:[],fetch:$w(D.getColors(E.storageKey),E.storageKey,D.hasCustomColors()),columns:D.getColorCols(E.storageKey),presets:"color",onItemAction:(T,B)=>{eu.getOpt(T).each(T=>{"custom"===B?D.colorPicker(D=>{D.fold(()=>Fr(T,gp),D=>{a(T,D),Ow(E.storageKey,D)})},"#ffffff"):a(T,"remove"===B?"":B)})}},mL.sketch({dom:M.dom,components:M.components,toggleClass:"mce-active",dropdownBehaviours:kl([kx(T.providers.isDisabled),Sx(),go.config({}),mq.config({})]),layouts:M.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:T.getSink,fetch:E=>fS(E=>M.fetch(E)).map(D=>A.from(HS(tR(Zw(la("menu-value"),D,T=>{M.onItemAction(E,T)},M.columns,M.presets,c5.CLOSE_ON_EXECUTE,ep,T.providers),{movement:eS(M.columns,M.presets)})))),parts:{menu:Bv(0,0,M.presets)}})));return mJ.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:ec.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[er,eu.asSpec()]}]),fieldBehaviours:kl([Jp("form-field-events",[Ur(gr,(T,D)=>{eu.getOpt(T).each(E=>{Dt(E.element,"background-color",D.event.color)}),Ir(T,mY,{name:E.name})}),Ur(gu,(E,T)=>{mJ.getField(E).each(D=>{r6.setValue(D,T.event.value),aW.getCurrent(E).each(s9.focus)})}),Ur(gp,(E,T)=>{mJ.getField(E).each(T=>{aW.getCurrent(E).each(s9.focus)})})])])})})(E,T.shared,T.colorinput,D)),colorpicker:GT((E,T,D)=>((E,T,D)=>{let n=E=>"tox-"+E,B=MO(E=>T.translate(pm[E]),n),M=Gh(B.sketch({dom:{tag:"div",classes:[n("color-picker-container")],attributes:{role:"presentation"}},onValidHex:E=>{Ir(E,m0,{name:"hex-valid",value:!0})},onInvalidHex:E=>{Ir(E,m0,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[M.asSpec()],behaviours:kl([RO(D,E=>{let T=M.get(E);return aW.getCurrent(T).bind(E=>r6.getValue(E).hex).map(E=>"#"+_e(E,"#")).getOr("")},(E,T)=>{let D=A.from(/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(T)).bind(E=>te(E,1)),B=M.get(E);aW.getCurrent(B).fold(()=>{console.log("Can not find form")},E=>{r6.setValue(E,{hex:D.getOr("")}),g8.getField(E,"hex").each(E=>{Fr(E,t6())})})}),DO()])}})(0,T.shared.providers,D)),dropzone:GT((E,T,D)=>((E,T,D)=>{let n=(E,T)=>{T.stop()},s=E=>(T,D)=>{L(E,E=>{E(T,D)})},r=(E,T)=>{var D;if(!aq.isDisabled(E)){let B=T.event.raw;i(E,null===(D=B.dataTransfer)||void 0===D?void 0:D.files)}},a=(E,T)=>{let D=T.event.raw.target;i(E,D.files)},i=(D,B)=>{B&&(r6.setValue(D,((E,T)=>{let D=ph.explode(T.getOption("images_file_types"));return U(e_(E),E=>N(D,T=>Ae(E.name.toLowerCase(),`.${T.toLowerCase()}`)))})(B,T)),Ir(D,mY,{name:E.name}))},B=Gh({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:kl([Jp("input-file-events",[qr(t7()),qr(o_())])])}),M=E.label.map(E=>pk(E,T)),er=mJ.parts.field({factory:{sketch:E=>({uid:E.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:kl([VO(D.getOr([])),DO(),aq.config({}),s7.config({toggleClass:"dragenter",toggleOnExecute:!1}),Jp("dropzone-events",[Ur("dragenter",s([n,s7.toggle])),Ur("dragleave",s([n,s7.toggle])),Ur("dragover",n),Ur("drop",s([n,r])),Ur(t8(),a)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p"},components:[ti(T.translate("Drop an image here"))]},iG.sketch({dom:{tag:"button",styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[ti(T.translate("Browse for an image")),B.asSpec()],action:E=>{B.get(E).element.dom.click()},buttonBehaviours:kl([mq.config({}),kx(T.isDisabled),Sx()])})]}]})}});return uk(M,er,["tox-form__group--stretched"],[])})(E,T.shared.providers,D)),grid:GT((E,T)=>{var D;return D=T.shared,{dom:{tag:"div",classes:["tox-form__grid",`tox-form__grid--${E.columns}col`]},components:H(E.items,D.interpreter)}}),listbox:GT((E,T,D)=>((E,T,D)=>{let B=T.shared.providers,M=D.bind(T=>E_(E.items,T)).orThunk(()=>oe(E.items).filter(O_)),er=E.label.map(E=>pk(E,B)),ec=mJ.parts.field({dom:{},factory:{sketch:D=>x_({uid:D.uid,text:M.map(E=>E.text),icon:A.none(),tooltip:E.label,role:A.none(),fetch:(D,B)=>{let M=T_(D,E.name,E.items,r6.getValue(D));B(C_(M,c5.CLOSE_ON_EXECUTE,T,{isHorizontalMenu:!1,search:A.none()}))},onSetup:x(b),getApi:x({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[mq.config({}),RO(M.map(E=>E.value),E=>Ot(E.element,pW),(T,D)=>{E_(E.items,D).each(E=>{kt(T.element,pW,E.value),Ir(T,pz,{text:E.text})})})]},"tox-listbox",T.shared)}});return mJ.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:q([er.toArray(),[{dom:{tag:"div",classes:["tox-listboxfield"]},components:[ec]}]]),fieldBehaviours:kl([aq.config({disabled:x(!E.enabled),onDisabled:E=>{mJ.getField(E).each(aq.disable)},onEnabled:E=>{mJ.getField(E).each(aq.enable)}})])})})(E,T,D)),selectbox:GT((E,T,D)=>((E,T,D)=>{let B=H(E.items,E=>({text:T.translate(E.text),value:E.value})),M=E.label.map(E=>pk(E,T)),er=mJ.parts.field({dom:{},...D.map(E=>({data:E})).getOr({}),selectAttributes:{size:E.size},options:B,factory:pj,selectBehaviours:kl([aq.config({disabled:()=>!E.enabled||T.isDisabled()}),mq.config({}),Jp("selectbox-change",[Ur(t8(),(T,D)=>{Ir(T,mY,{name:E.name})})])])}),ec=E.size>1?A.none():A.some(tb("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},T.icons)),eu={dom:{tag:"div",classes:["tox-selectfield"]},components:q([[er],ec.toArray()])};return mJ.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:q([M.toArray(),[eu]]),fieldBehaviours:kl([aq.config({disabled:()=>!E.enabled||T.isDisabled(),onDisabled:E=>{mJ.getField(E).each(aq.disable)},onEnabled:E=>{mJ.getField(E).each(aq.enable)}}),Sx()])})})(E,T.shared.providers,D)),sizeinput:GT((E,T)=>((E,T)=>{let D=N_,B=la("ratio-event"),s=E=>tb(E,{tag:"span",classes:["tox-icon","tox-lock-icon__"+E]},T.icons),M=pX.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:T.translate(E.label.getOr("Constrain proportions"))}},components:[s("lock"),s("unlock")],buttonBehaviours:kl([aq.config({disabled:()=>!E.enabled||T.isDisabled()}),Sx(),mq.config({})])}),a=E=>({dom:{tag:"div",classes:["tox-form__group"]},components:E}),i=D=>mJ.parts.field({factory:dx,inputClasses:["tox-textfield"],inputBehaviours:kl([aq.config({disabled:()=>!E.enabled||T.isDisabled()}),Sx(),mq.config({}),Jp("size-input-events",[Ur(t3(),(E,T)=>{Ir(E,B,{isField1:D})}),Ur(t8(),(T,D)=>{Ir(T,mY,{name:E.name})})])]),selectOnFocus:!1}),l=E=>({dom:{tag:"label",classes:["tox-label"]},components:[ti(T.translate(E))]}),er=pX.parts.field1(a([mJ.parts.label(l("Width")),i(!0)])),ec=pX.parts.field2(a([mJ.parts.label(l("Height")),i(!1)]));return pX.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[er,ec,a([l("\xa0"),M])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:(E,T,B)=>{I_(r6.getValue(E)).each(E=>{D(E).each(E=>{r6.setValue(T,(E=>{var T;let D={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},B=E.value.toFixed((T=E.unit)in D?D[T]:1);return -1!==B.indexOf(".")&&(B=B.replace(/\.?0*$/,"")),B+E.unit})(E))})})},coupledFieldBehaviours:kl([aq.config({disabled:()=>!E.enabled||T.isDisabled(),onDisabled:E=>{pX.getField1(E).bind(mJ.getField).each(aq.disable),pX.getField2(E).bind(mJ.getField).each(aq.disable),pX.getLock(E).each(aq.disable)},onEnabled:E=>{pX.getField1(E).bind(mJ.getField).each(aq.enable),pX.getField2(E).bind(mJ.getField).each(aq.enable),pX.getLock(E).each(aq.enable)}}),Sx(),Jp("size-input-events2",[Ur(B,(E,T)=>{let B=T.event.isField1,M=B?pX.getField1(E):pX.getField2(E),er=B?pX.getField2(E):pX.getField1(E),ec=M.map(r6.getValue).getOr(""),eu=er.map(r6.getValue).getOr("");D=((E,T)=>{let D=I_(E).toOptional(),B=I_(T).toOptional();return Se(D,B,(E,T)=>R_(E,T.unit).map(E=>T.value/E).map(E=>{var D;return D=T.unit,T=>R_(T,D).map(T=>({value:T*E,unit:D}))}).getOr(N_)).getOr(N_)})(ec,eu)})])])})})(E,T.shared.providers)),slider:GT((E,T,D)=>((E,T,D)=>{let B=g2.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[ti(T.translate(E.label))]}),M=g2.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),er=g2.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return g2.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:E.min,maxX:E.max,getInitialValue:x(D.getOrThunk(()=>(Math.abs(E.max)-Math.abs(E.min))/2))},components:[B,M,er],sliderBehaviours:kl([DO(),s9.config({})]),onChoose:(T,D,B)=>{Ir(T,mY,{name:E.name,value:B})}})})(E,T.shared.providers,D)),urlinput:GT((E,T,D)=>((E,T,D,B)=>{let M=T.shared.providers,r=T=>{let B=r6.getValue(T);D.addToHistory(B.value,E.filetype)},er={...B.map(E=>({initialData:E})).getOr({}),dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":hc,type:"url"},minChars:0,responseTime:0,fetch:B=>{let M=((E,T,D)=>{var B,M;let er=r6.getValue(T),ec=null!==(M=null===(B=null==er?void 0:er.meta)||void 0===B?void 0:B.text)&&void 0!==M?M:er.value;return D.getLinkInformation().fold(()=>[],T=>{let B=PT(ec,H(D.getHistory(E),E=>RT(E,E)));return"file"===E?j([B,PT(ec,VT(T)),PT(ec,q([HT(T),zT(T),LT(T)]))],(E,T)=>0===E.length||0===T.length?E.concat(T):E.concat(hr,T),[]):B})})(E.filetype,B,D),er=C_(M,c5.BUBBLE_TO_SANDBOX,T,{isHorizontalMenu:!1,search:A.none()});return bS(er)},getHotspot:E=>ex.getOpt(E),onSetValue:(E,T)=>{E.hasConfigured(gt)&&gt.run(E).get(b)},typeaheadBehaviours:kl([...D.getValidationHandler().map(T=>gt.config({getRoot:E=>rt(E.element),invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:(E,T)=>{eg.getOpt(E).each(E=>{kt(E.element,"title",M.translate(T))})}},validator:{validate:D=>{let B=r6.getValue(D);return OT(D=>{T({type:E.filetype,url:B.value},E=>{if("invalid"===E.status){let T=tH.error(E.message);D(T)}else{let T=tH.value(E.message);D(T)}})})},validateOnLoad:!1}})).toArray(),aq.config({disabled:()=>!E.enabled||M.isDisabled()}),mq.config({}),Jp("urlinput-events",[Ur(t6(),T=>{let D=$a(T.element),B=D.trim();B!==D&&qa(T.element,B),"file"===E.filetype&&Ir(T,mY,{name:E.name})}),Ur(t8(),T=>{Ir(T,mY,{name:E.name}),r(T)}),Ur(ow(),T=>{Ir(T,mY,{name:E.name}),r(T)})])]),eventOrder:{[t6()]:["streaming","urlinput-events","invalidating"]},model:{getDisplayText:E=>E.value,selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:T.shared.getSink,parts:{menu:Bv(0,0,"normal")},onExecute:(E,T,D)=>{Ir(T,m1,{})},onItemExecute:(T,D,B,M)=>{r(T),Ir(T,mY,{name:E.name})}},ec=mJ.parts.field({...er,factory:ht}),eu=E.label.map(E=>pk(E,M)),eg=Gh(((E,T,D=E,B=E)=>tb(D,{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+E],attributes:{title:M.translate(B),"aria-live":"polite",...T.fold(()=>({}),E=>({id:E}))}},M.icons))("invalid",A.some(hc),"warning")),ep=Gh({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[eg.asSpec()]}),eh=D.getUrlPicker(E.filetype),ef=la("browser.url.event"),ex=Gh({dom:{tag:"div",classes:["tox-control-wrap"]},components:[ec,ep.asSpec()],behaviours:kl([aq.config({disabled:()=>!E.enabled||M.isDisabled()})])}),ew=Gh(MT({name:E.name,icon:A.some("browse"),text:E.label.getOr(""),enabled:E.enabled,primary:!1,buttonType:A.none(),borderless:!0},E=>Fr(E,ef),M,[],["tox-browse-url"]));return mJ.sketch({dom:gk([]),components:eu.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:q([[ex.asSpec()],eh.map(()=>ew.asSpec()).toArray()])}]),fieldBehaviours:kl([aq.config({disabled:()=>!E.enabled||M.isDisabled(),onDisabled:E=>{mJ.getField(E).each(aq.disable),ew.getOpt(E).each(aq.disable)},onEnabled:E=>{mJ.getField(E).each(aq.enable),ew.getOpt(E).each(aq.enable)}}),Sx(),Jp("url-input-events",[Ur(ef,T=>{aW.getCurrent(T).each(D=>{let B=r6.getValue(D),M={fieldname:E.name,...B};eh.each(B=>{B(M).get(B=>{r6.setValue(D,B),Ir(T,mY,{name:E.name})})})})})])])})})(E,T,T.urlinput,D)),customeditor:GT(E=>{let T=Ql(),D=Gh({dom:{tag:E.tag}}),B=Ql();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:kl([Jp("custom-editor-events",[oZ(M=>{D.getOpt(M).each(D=>{(ve(E,"init")?E.init(D.element.dom):pg.load(E.scriptId,E.scriptUrl).then(T=>T(D.element.dom,E.settings))).then(E=>{B.on(T=>{E.setValue(T)}),B.clear(),T.set(E)})})})]),RO(A.none(),()=>T.get().fold(()=>B.get().getOr(""),E=>E.getValue()),(E,D)=>{T.get().fold(()=>B.set(D),E=>E.setValue(D))}),DO()]),components:[D.asSpec()]}}),htmlpanel:GT(E=>"presentation"===E.presets?mG.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:E.html}}):mG.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:E.html,attributes:{role:"document"}},containerBehaviours:kl([mq.config({}),s9.config({})])})),imagepreview:GT((E,T,D)=>((E,T)=>{let D=Es(T.getOr({url:""})),B=Gh({dom:{tag:"img",classes:["tox-imagepreview__image"],attributes:T.map(E=>({src:E.url})).getOr({})}}),M=Gh({dom:{tag:"div",classes:["tox-imagepreview__container"],attributes:{role:"presentation"}},components:[B.asSpec()]}),er={};E.height.each(E=>er.height=E);let eu=T.map(E=>({url:E.url,zoom:A.from(E.zoom),cachedWidth:A.from(E.cachedWidth),cachedHeight:A.from(E.cachedHeight)}));return{dom:{tag:"div",classes:["tox-imagepreview"],styles:er,attributes:{role:"presentation"}},components:[M.asSpec()],behaviours:kl([DO(),RO(eu,()=>D.get(),(E,T)=>{let er={url:T.url};T.zoom.each(E=>er.zoom=E),T.cachedWidth.each(E=>er.cachedWidth=E),T.cachedHeight.each(E=>er.cachedHeight=E),D.set(er);let a=()=>{let{cachedWidth:T,cachedHeight:D,zoom:B}=er;if(!ec(T)&&!ec(D)){if(ec(B)){let B=((E,T,D)=>{let B=Jt(E),M=Wt(E);return Math.min(B/T,M/D,1)})(E.element,T,D);er.zoom=B}let eu=((E,T,D,B,M)=>{let er=D*M,ec=B*M;return{left:Math.max(0,E/2-er/2).toString()+"px",top:Math.max(0,T/2-ec/2).toString()+"px",width:er.toString()+"px",height:ec.toString()+"px"}})(Jt(E.element),Wt(E.element),T,D,er.zoom);M.getOpt(E).each(E=>{Bt(E.element,eu)})}};B.getOpt(E).each(D=>{let B=D.element;T.url!==Ot(B,"src")&&(kt(B,"src",T.url),Pa(E.element,"tox-imagepreview__loaded")),a(),new Promise((E,T)=>{let o=()=>{r(),E(B)},D=[tc(B,"load",o),tc(B,"error",()=>{r(),T("Unable to load data from image: "+B.dom.src)})],r=()=>L(D,E=>E.unbind());B.dom.complete&&o()}).then(T=>{E.getSystem().isConnected()&&(La(E.element,"tox-imagepreview__loaded"),er.cachedWidth=T.dom.naturalWidth,er.cachedHeight=T.dom.naturalHeight,a())})})})])}})(E,D)),table:GT((E,T)=>((E,T)=>{let o=E=>({dom:{tag:"td",innerHtml:T.translate(E)}});return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:H(E.header,E=>({dom:{tag:"th",innerHtml:T.translate(E)}}))}]},{dom:{tag:"tbody"},components:H(E.cells,E=>({dom:{tag:"tr"},components:H(E,o)}))}],behaviours:kl([mq.config({}),s9.config({})])}})(E,T.shared.providers)),tree:GT((E,T)=>((E,T)=>{let D=E.onLeafAction.getOr(b),B=E.onToggleExpand.getOr(b),M=E.defaultExpandedIds,er=Es(M),ec=Es(E.defaultSelectedId),eu=la("tree-id"),l=(B,M)=>E.items.map(E=>"leaf"===E.type?rT({leaf:E,selectedId:B,onLeafAction:D,visible:!0,treeId:eu,backstage:T}):dT({directory:E,selectedId:B,onLeafAction:D,expandedIds:M,labelTabstopping:!0,treeId:eu,backstage:T}));return{dom:{tag:"div",classes:["tox-tree"],attributes:{role:"tree"}},components:l(ec.get(),er.get()),behaviours:kl([sQ.config({mode:"flow",selector:".tox-tree--leaf__label--visible, .tox-tree--directory__label--visible",cycles:!1}),Jp(p2,[Ur("expand-tree-node",(E,T)=>{let{expanded:D,node:M}=T.event;er.set(D?[...er.get(),M]:er.get().filter(E=>E!==M)),B(er.get(),{expanded:D,node:M})})]),nQ.config({channels:{[`update-active-item-${eu}`]:{onReceive:(E,T)=>{ec.set(A.some(T.value)),s1.set(E,l(A.some(T.value),er.get()))}}}}),s1.config({})])}})(E,T)),panel:GT((E,T)=>({dom:{tag:"div",classes:E.classes},components:H(E.items,T.shared.interpreter)}))},hm={field:(E,T)=>T,record:x([])},XT=(E,T,D,B)=>{let M=tR(B,{shared:{interpreter:T=>YT(E,T,D,M)}});return YT(E,T,D,M)},YT=(E,T,D,B)=>be(hd,T.type).fold(()=>(console.error(`Unknown factory type "${T.type}", defaulting to container: `,T),T),M=>M(E,T,D,B)),KT=(E,T,D)=>YT(hm,E,T,D),hh="layout-inset",ZT=E=>E.x,QT=(E,T)=>E.x+E.width/2-T.width/2,eE=(E,T)=>E.x+E.width-T.width,tE=E=>E.y,oE=(E,T)=>E.y+E.height-T.height,nE=(E,T)=>E.y+E.height/2-T.height/2,sE=(E,T,D)=>zi(eE(E,T),oE(E,T),D.insetSouthwest(),nP(),"southwest",Ki(E,{right:0,bottom:3}),hh),rE=(E,T,D)=>zi(ZT(E),oE(E,T),D.insetSoutheast(),nz(),"southeast",Ki(E,{left:1,bottom:3}),hh),aE=(E,T,D)=>zi(eE(E,T),tE(E),D.insetNorthwest(),nL(),"northwest",Ki(E,{right:0,top:2}),hh),iE=(E,T,D)=>zi(ZT(E),tE(E),D.insetNortheast(),nU(),"northeast",Ki(E,{left:1,top:2}),hh),lE=(E,T,D)=>zi(QT(E,T),tE(E),D.insetNorth(),nG(),"north",Ki(E,{top:2}),hh),cE=(E,T,D)=>zi(QT(E,T),oE(E,T),D.insetSouth(),nW(),"south",Ki(E,{bottom:3}),hh),dE=(E,T,D)=>zi(eE(E,T),nE(E,T),D.insetEast(),nJ(),"east",Ki(E,{right:0}),hh),uE=(E,T,D)=>zi(ZT(E),nE(E,T),D.insetWest(),nj(),"west",Ki(E,{left:1}),hh),mE=E=>{switch(E){case"north":return lE;case"northeast":return iE;case"northwest":return aE;case"south":return cE;case"southeast":return rE;case"southwest":return sE;case"east":return dE;case"west":return uE}},gE=(E,T,D,B,M)=>Xl(B).map(mE).getOr(lE)(E,T,D,B,M),pE=E=>{switch(E){case"north":return cE;case"northeast":return rE;case"northwest":return sE;case"south":return lE;case"southeast":return iE;case"southwest":return aE;case"east":return uE;case"west":return dE}},hE=(E,T,D,B,M)=>Xl(B).map(pE).getOr(lE)(E,T,D,B,M),hf={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},bE=(E,T,D)=>{let B={maxHeightFunction:n7()};return()=>D()?{type:"node",root:ft(eJ(E())),node:A.from(E()),bubble:gc(12,12,hf),layouts:{onRtl:()=>[iE],onLtr:()=>[aE]},overrides:B}:{type:"hotspot",hotspot:T(),bubble:gc(-12,12,hf),layouts:{onRtl:()=>[sl,rl,cl],onLtr:()=>[rl,sl,cl]},overrides:B}},vE=(E,T,D,B)=>{let M={maxHeightFunction:n7()};return()=>B()?{type:"node",root:ft(eJ(T())),node:A.from(T()),bubble:gc(12,12,hf),layouts:{onRtl:()=>[lE],onLtr:()=>[lE]},overrides:M}:E?{type:"node",root:ft(eJ(T())),node:A.from(T()),bubble:gc(0,-jt(T()),hf),layouts:{onRtl:()=>[ll],onLtr:()=>[ll]},overrides:M}:{type:"hotspot",hotspot:D(),bubble:gc(0,0,hf),layouts:{onRtl:()=>[ll],onLtr:()=>[ll]},overrides:M}},yE=(E,T,D)=>()=>D()?{type:"node",root:ft(eJ(E())),node:A.from(E()),layouts:{onRtl:()=>[lE],onLtr:()=>[lE]}}:{type:"hotspot",hotspot:T(),layouts:{onRtl:()=>[cl],onLtr:()=>[cl]}},xE=(E,T)=>()=>({type:"selection",root:T(),getSelection:()=>{let T=E.selection.getRng(),D=E.model.table.getSelectedCells();if(D.length>1){let E=D[0],T=D[D.length-1],B={firstCell:Fe(E),lastCell:Fe(T)};return A.some(B)}return A.some(rF.range(Fe(T.startContainer),T.startOffset,Fe(T.endContainer),T.endOffset))}}),wE=E=>T=>({type:"node",root:E(),node:T}),SE=(E,T,D,B)=>{let M=sv(E),r=()=>Fe(E.getBody()),a=()=>Fe(E.getContentAreaContainer()),i=()=>M||!B();return{inlineDialog:bE(a,T,i),inlineBottomDialog:vE(E.inline,a,D,i),banner:yE(a,T,i),cursor:xE(E,r),node:wE(r)}},kE=E=>(T,D)=>{Jw(E)(T,D)},CE=E=>()=>mu(E),OE=E=>T=>Rw(E,T),_E=E=>T=>zw(E,T),TE=E=>()=>c$(E),EE=E=>ye(E,"items"),AE=E=>ye(E,"format"),hb=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],DE=E=>j(E,(E,D)=>{if(ve(D,"items")){let T=DE(D.items);return{customFormats:E.customFormats.concat(T.customFormats),formats:E.formats.concat([{title:D.title,items:T.formats}])}}if(ve(D,"inline")||ve(D,"block")||ve(D,"selector")){let B=`custom-${T(D.name)?D.name:D.title.toLowerCase()}`;return{customFormats:E.customFormats.concat([{name:B,format:D}]),formats:E.formats.concat([{title:D.title,format:B,icon:D.icon}])}}return{...E,formats:E.formats.concat(D)}},{customFormats:[],formats:[]}),BE=E=>cf(E).map(T=>{let D=((E,T)=>{let D=DE(T),n=T=>{L(T,T=>{E.formatter.has(T.name)||E.formatter.register(T.name,T.format)})};return E.formatter?n(D.customFormats):E.on("init",()=>{n(D.customFormats)}),D.formats})(E,T);return cx(E)?hb.concat(D):D}).getOr(hb),FE=(E,T,D)=>({...E,type:"formatter",isSelected:T(E.format),getStylePreview:D(E.format)}),IE=(E,D,B,M)=>{let s=D=>H(D,D=>EE(D)?(E=>{let T=s(E.items);return{...E,type:"submenu",getStyleItems:x(T)}})(D):AE(D)?FE(D,B,M):(E=>{let T=eD(E);return 1===T.length&&R(T,"title")})(D)?{...D,type:"separator"}:(D=>{let er=T(D.name)?D.name:la(D.title),ec=`custom-${er}`,eu={...D,type:"formatter",format:ec,isSelected:B(ec),getStylePreview:M(ec)};return E.formatter.register(er,eu),eu})(D));return s(D)},hv=ph.trim,NE=E=>T=>!!g(T)&&1===T.nodeType&&(T.contentEditable===E||T.getAttribute("data-mce-contenteditable")===E),hx=NE("true"),hy=NE("false"),HE=(E,T,D,B,M)=>({type:E,title:T,url:D,level:B,attach:M}),LE=E=>E.innerText||E.textContent,PE=E=>E&&"A"===E.nodeName&&void 0!==(E.id||E.name)&&WE(E),UE=E=>E&&/^(H[1-6])$/.test(E.nodeName),WE=E=>(E=>{let T=E;for(;T=T.parentNode;){let E=T.contentEditable;if(E&&"inherit"!==E)return hx(T)}return!1})(E)&&!hy(E),jE=E=>UE(E)&&WE(E),GE=E=>{var T;let D=E.id?E.id:la("h");return HE("header",null!==(T=LE(E))&&void 0!==T?T:"","#"+D,UE(E)?parseInt(E.nodeName.substr(1),10):0,()=>{E.id=D})},$E=E=>{let T=E.id||E.name,D=LE(E);return HE("anchor",D||"#"+T,"#"+T,0,b)},qE=E=>hv(E.title).length>0,XE=E=>{let T=(E=>{let T=H(Xc(Fe(E),"h1,h2,h3,h4,h5,h6,a:not([href])"),E=>E.dom);return T})(E);return U(H(U(T,jE),GE).concat(H(U(T,PE),$E)),qE)},hA="tinymce-url-history",KE=E=>T(E)&&/^https?/.test(E),JE=E=>D(E)&&he(E,E=>!(B(E)&&E.length<=5&&Y(E,KE))).isNone(),ZE=()=>{let E;let T=mo.getItem(hA);if(null===T)return{};try{E=JSON.parse(T)}catch(E){if(E instanceof SyntaxError)return console.log("Local storage "+hA+" was not valid JSON",E),{};throw E}return JE(E)?E:(console.log("Local storage "+hA+" was not valid format",E),{})},QE=E=>{let T=ZE();return be(T,E).getOr([])},eA=(E,T)=>{if(!KE(E))return;let D=ZE(),B=be(D,T).getOr([]),M=U(B,T=>T!==E);D[T]=[E].concat(M).slice(0,5),(E=>{if(!JE(E))throw Error("Bad format for history:\n"+JSON.stringify(E));mo.setItem(hA,JSON.stringify(E))})(D)},tA=E=>!!E,oA=E=>ce(ph.makeMap(E,/[, ]/),tA),nA=E=>A.from(cL(E)),sA=E=>A.from(E).filter(T).getOrUndefined(),rA=E=>({getHistory:QE,addToHistory:eA,getLinkInformation:()=>cW(E)?A.some({targets:XE(E.getBody()),anchorTop:sA(cj(E)),anchorBottom:sA(cJ(E))}):A.none(),getValidationHandler:()=>A.from(cz(E)),getUrlPicker:B=>((E,T)=>{let D=(E=>{let T=A.from(cG(E)).filter(tA).map(oA);return nA(E).fold(ep,E=>T.fold(eh,E=>eD(E).length>0&&E))})(E);return er(D)?D?nA(E):A.none():D[T]?nA(E):A.none()})(E,B).map(M=>er=>fS(ec=>{let eu={filetype:B,fieldname:er.fieldname,...A.from(er.meta).getOr({})};M.call(E,(E,B)=>{if(!T(E))throw Error("Expected value to be string");if(void 0!==B&&!D(B))throw Error("Expected meta to be a object");ec({value:E,meta:B})},er.value,eu)}))}),hk=x([ys("shell",!1),os("makeItem"),ys("setupItem",b),hu("listBehaviours",[s1])]),hO=aB({name:"items",overrides:()=>({behaviours:kl([s1.config({})])})}),hT=x([hO]),hD=bm({name:x("CustomList")(),configFields:hk(),partFields:hT(),factory:(E,T,D,B)=>{let M=E.shell?{behaviours:[s1.config({})],components:[]}:{behaviours:[],components:T};return{uid:E.uid,dom:E.dom,components:M.components,behaviours:bu(E.listBehaviours,M.behaviours),apis:{setItems:(T,D)=>{(E.shell?A.some(T):om(T,E,"items")).fold(()=>{throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),Error("Custom List was defined to not be a shell, but no item container was specified in components")},B=>{let M=s1.contents(B),er=D.length,ec=er-M.length,eu=ec>0?V(ec,()=>E.makeItem()):[],eg=M.slice(er);L(eg,E=>s1.remove(B,E)),L(eu,E=>s1.append(B,E));let ep=s1.contents(B);L(ep,(B,M)=>{E.setupItem(T,B,D[M],M)})})}}}},apis:{setItems:(E,T,D)=>{E.setItems(T,D)}}}),hB=x([os("dom"),ys("shell",!0),hu("toolbarBehaviours",[s1])]),hM=x([aB({name:"groups",overrides:()=>({behaviours:kl([s1.config({})])})})]),hH=bm({name:"Toolbar",configFields:hB(),partFields:hM(),factory:(E,T,D,B)=>{let M=E.shell?{behaviours:[s1.config({})],components:[]}:{behaviours:[],components:T};return{uid:E.uid,dom:E.dom,components:M.components,behaviours:bu(E.toolbarBehaviours,M.behaviours),apis:{setGroups:(T,D)=>{(E.shell?A.some(T):om(T,E,"groups")).fold(()=>{throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},E=>{s1.set(E,D)})},refresh:b},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(E,T,D)=>{E.setGroups(T,D)}}}),hR=x([]);var hN,hU,hL,hz,hP,hG,hW,hj=Object.freeze({__proto__:null,setup:b,isDocked:ep,getBehaviours:hR});let xA=E=>(xe(Nt(E,"position"),"fixed")?A.none():at(E)).orThunk(()=>{let T=Re("span");return st(E).bind(E=>{zo(E,T);let D=at(T);return Po(T),D})}),wA=E=>xA(E).map(Xt).getOrThunk(()=>Gt(0,0)),SA=(E,T)=>{let D=E.element;La(D,T.transitionClass),Pa(D,T.fadeOutClass),La(D,T.fadeInClass),T.onShow(E)},kA=(E,T)=>{let D=E.element;La(D,T.transitionClass),Pa(D,T.fadeInClass),La(D,T.fadeOutClass),T.onHide(E)},CA=(E,T)=>E.y>=T.y,OA=(E,T)=>E.bottom<=T.bottom,_A=(E,T,D)=>({location:"top",leftX:T,topY:D.bounds.y-E.y}),TA=(E,T,D)=>({location:"bottom",leftX:T,bottomY:E.bottom-D.bounds.bottom}),EA=E=>E.box.x-E.win.x,AA=(E,T,D)=>D.getInitialPos().map(D=>{let B=((E,T)=>{let D=T.optScrollEnv.fold(x(E.bounds.y),T=>T.scrollElmTop+(E.bounds.y-T.currentScrollTop));return Gt(E.bounds.x,D)})(D,T);return{box:Ko(B.left,B.top,Jt(E),Wt(E)),location:D.location}}),MA=(E,T,D,B,M)=>{let er=((E,T)=>{let D=T.optScrollEnv.fold(x(E.y),T=>E.y+T.currentScrollTop-T.scrollElmTop);return Gt(E.x,D)})(T,D),ec=Ko(er.left,er.top,T.width,T.height);B.setInitialPos({style:Vt(E),position:It(E,"position")||"static",bounds:ec,location:M.location})},DA=(E,T,D)=>D.getInitialPos().bind(B=>{var M;switch(D.clearInitialPos(),B.position){case"static":return A.some({morph:"static"});case"absolute":let er=xA(E).getOr(xt()),ec=Jo(er),eu=null!==(M=er.dom.scrollTop)&&void 0!==M?M:0;return A.some({morph:"absolute",positionCss:Vl("absolute",be(B.style,"left").map(E=>T.x-ec.x),be(B.style,"top").map(E=>T.y-ec.y+eu),be(B.style,"right").map(E=>ec.right-T.right),be(B.style,"bottom").map(E=>ec.bottom-T.bottom))});default:return A.none()}}),BA=E=>{switch(E.location){case"top":return A.some({morph:"fixed",positionCss:Vl("fixed",A.some(E.leftX),A.some(E.topY),A.none(),A.none())});case"bottom":return A.some({morph:"fixed",positionCss:Vl("fixed",A.some(E.leftX),A.none(),A.none(),A.some(E.bottomY))});default:return A.none()}},FA=(E,T,D)=>{let B=E.element;return xe(Nt(B,"position"),"fixed")?AA(B,T,D).filter(({box:E})=>Y(D.getModes(),D=>{switch(D){case"bottom":return OA(E,T.bounds);case"top":return CA(E,T.bounds)}})).bind(({box:E})=>DA(B,E,D)).orThunk(()=>T.optScrollEnv.bind(E=>AA(B,T,D)).bind(({box:E,location:D})=>{let B=en(),M=EA({win:B,box:E}),er="top"===D?_A(B,M,T):TA(B,M,T);return BA(er)})):((E,T,D)=>{let B=Jo(E),M=en(),er=((E,T,D)=>{let B=T.win,M=T.box,er=EA(T);return re(E,E=>{switch(E){case"bottom":return OA(M,D.bounds)?A.none():A.some(TA(B,er,D));case"top":return CA(M,D.bounds)?A.none():A.some(_A(B,er,D));default:return A.none()}}).getOr({location:"no-dock"})})(D.getModes(),{win:M,box:B},T);return"top"===er.location||"bottom"===er.location?(MA(E,B,T,D,er),BA(er)):A.none()})(B,T,D)},IA=(E,T,D)=>{D.setDocked(!1),L(["left","right","top","bottom","position"],T=>Ht(E.element,T)),T.onUndocked(E)},RA=(E,T,D,B)=>{let M="fixed"===B.position;D.setDocked(M),zl(E.element,B),(M?T.onDocked:T.onUndocked)(E)},NA=(E,T,D,B,M=!1)=>{T.contextual.each(T=>{T.lazyContext(E).each(er=>{var ec;let eu=(ec=B.bounds,er.y<ec.bottom&&er.bottom>ec.y);eu!==D.isVisible()&&(D.setVisible(eu),M&&!eu?(Wa(E.element,[T.fadeOutClass]),T.onHide(E)):(eu?SA:kA)(E,T))})})},VA=(E,T,D,B,M)=>{NA(E,T,D,B,!0),RA(E,T,D,M.positionCss)},zA=(E,T,D)=>{E.getSystem().isConnected()&&((E,T,D)=>{let B=T.lazyViewport(E);NA(E,T,D,B),FA(E,B,D).each(M=>{((E,T,D,B,M)=>{switch(M.morph){case"static":return IA(E,T,D);case"absolute":return RA(E,T,D,M.positionCss);case"fixed":VA(E,T,D,B,M)}})(E,T,D,B,M)})})(E,T,D)},HA=(E,T,D)=>{D.isDocked()&&((E,T,D)=>{let B=E.element;D.setDocked(!1);let M=T.lazyViewport(E);((E,T,D)=>{let B=E.element;return AA(B,T,D).bind(({box:E})=>DA(B,E,D))})(E,M,D).each(B=>{switch(B.morph){case"static":IA(E,T,D);break;case"absolute":RA(E,T,D,B.positionCss)}}),D.setVisible(!0),T.contextual.each(T=>{ja(B,[T.fadeInClass,T.fadeOutClass,T.transitionClass]),T.onShow(E)}),zA(E,T,D)})(E,T,D)},LA=E=>(T,D,B)=>{let M=D.lazyViewport(T);((E,T,D,B)=>{let M=Jo(E),er=en(),ec=B(er,EA({win:er,box:M}),T);return"bottom"===ec.location||"top"===ec.location?(((E,T,D,B,M)=>{B.getInitialPos().fold(()=>MA(E,T,D,B,M),()=>b)})(E,M,T,D,ec),BA(ec)):A.none()})(T.element,M,B,E).each(E=>{VA(T,D,B,M,E)})},hJ=LA(_A),h$=LA(TA);var hX=Object.freeze({__proto__:null,refresh:zA,reset:HA,isDocked:(E,T,D)=>D.isDocked(),getModes:(E,T,D)=>D.getModes(),setModes:(E,T,D,B)=>D.setModes(B),forceDockToTop:hJ,forceDockToBottom:h$}),hq=Object.freeze({__proto__:null,events:(E,T)=>Hr([Yr(or(),(D,B)=>{E.contextual.each(E=>{Ua(D.element,E.transitionClass)&&(ja(D.element,[E.transitionClass,E.fadeInClass]),(T.isVisible()?E.onShown:E.onHidden)(D)),B.stop()})}),Ur(oU(),(D,B)=>{zA(D,E,T)}),Ur(o$(),(D,B)=>{zA(D,E,T)}),Ur(oL(),(D,B)=>{HA(D,E,T)})])}),hK=[vs("contextual",[rs("fadeInClass"),rs("fadeOutClass"),rs("transitionClass"),is("lazyContext"),Di("onShow"),Di("onShown"),Di("onHide"),Di("onHidden")]),Os("lazyViewport",()=>({bounds:en(),optScrollEnv:A.none()})),_s("modes",["top","bottom"],tG),Di("onDocked"),Di("onUndocked")];let hY=Ol({fields:hK,name:"docking",active:hq,apis:hX,state:Object.freeze({__proto__:null,init:E=>{let T=Es(!1),D=Es(!0),B=Ql(),M=Es(E.modes);return _a({isDocked:T.get,setDocked:T.set,getInitialPos:B.get,setInitialPos:B.set,clearInitialPos:B.clear,isVisible:D.get,setVisible:D.set,getModes:M.get,setModes:M.set,readState:()=>`docked:  ${T.get()}, visible: ${D.get()}, modes: ${M.get().join(",")}`})}})}),hZ=x(la("toolbar-height-change")),hQ={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},h0="tox-tinymce--toolbar-sticky-on",h1="tox-tinymce--toolbar-sticky-off",JA=(E,T)=>R(hY.getModes(E),T),ZA=E=>{let T=E.element;rt(T).each(D=>{let B="padding-"+hY.getModes(E)[0];if(hY.isDocked(E)){let E=Jt(D);Dt(T,"width",E+"px"),Dt(D,B,jt(T)+(parseInt(It(T,"margin-top"),10)||0)+(parseInt(It(T,"margin-bottom"),10)||0)+"px")}else Ht(T,"width"),Ht(D,B)})},QA=(E,T)=>{T?(Pa(E,hQ.fadeOutClass),Wa(E,[hQ.transitionClass,hQ.fadeInClass])):(Pa(E,hQ.fadeInClass),Wa(E,[hQ.fadeOutClass,hQ.transitionClass]))},eM=(E,T)=>{let D=Fe(E.getContainer());T?(La(D,h0),Pa(D,h1)):(La(D,h1),Pa(D,h0))},tM=(E,T)=>{let D=Ql(),B=T.getSink,s=E=>{B().each(T=>E(T.element))},r=T=>{E.inline||ZA(T),eM(E,hY.isDocked(T)),T.getSystem().broadcastOn([rY()],{}),B().each(E=>E.getSystem().broadcastOn([rY()],{}))},M=E.inline?[]:[nQ.config({channels:{[hZ()]:{onReceive:ZA}}})];return[s9.config({}),hY.config({contextual:{lazyContext:T=>{let D=jt(T.element),B=E.inline?E.getContentAreaContainer():E.getContainer();return A.from(B).map(B=>{let M=Jo(Fe(B));return jS(E,T.element).fold(()=>{let E=M.height-D,B=M.y+(JA(T,"top")?0:D);return Ko(M.x,B,M.width,E)},E=>{let B=Qo(M,GS(E)),er=JA(T,"top")?B.y:B.y+D;return Ko(B.x,er,B.width,B.height-D)})})},onShow:()=>{s(E=>QA(E,!0))},onShown:E=>{s(E=>ja(E,[hQ.transitionClass,hQ.fadeInClass])),D.get().each(T=>{((E,T)=>{let D=et(T);Il(D).filter(E=>!Ze(T,E)).filter(T=>Ze(T,Fe(D.dom.body))||Qe(E,T)).each(()=>Dl(T))})(E.element,T),D.clear()})},onHide:E=>{Rl(E.element).orThunk(()=>B().toOptional().bind(E=>Rl(E.element))).fold(D.clear,D.set),s(E=>QA(E,!1))},onHidden:()=>{s(E=>ja(E,[hQ.transitionClass]))},...hQ},lazyViewport:T=>jS(E,T.element).fold(()=>{let D=en(),B=cR(E),M=D.y+(JA(T,"top")?B:0),er=D.height-(JA(T,"bottom")?B:0);return{bounds:Ko(D.x,M,D.width,er),optScrollEnv:A.none()}},E=>({bounds:GS(E),optScrollEnv:A.some({currentScrollTop:E.element.dom.scrollTop,scrollElmTop:Xt(E.element).top})})),modes:[T.header.getDockingMode()],onDocked:r,onUndocked:r}),...M]};var h2=Object.freeze({__proto__:null,setup:(E,T,D)=>{E.inline||(T.header.isPositionedAtTop()||E.on("ResizeEditor",()=>{D().each(hY.reset)}),E.on("ResizeWindow ResizeEditor",()=>{D().each(ZA)}),E.on("SkinLoaded",()=>{D().each(E=>{hY.isDocked(E)?hY.reset(E):hY.refresh(E)})}),E.on("FullscreenStateChanged",()=>{D().each(hY.reset)})),E.on("AfterScrollIntoView",E=>{D().each(T=>{hY.refresh(T);let D=T.element;Ig(D)&&((E,T)=>{let D=et(T),B=nt(T).dom.innerHeight,M=Uo(D),er=Fe(E.elm),ec=Zo(er),eu=Wt(er),eg=ec.y,ep=eg+eu,eh=Xt(T),ef=Wt(T),ex=eh.top,ew=ex+ef,e_=2>Math.abs(ex-M.top),eD=2>Math.abs(ew-(M.top+B));if(e_&&eg<ew)Wo(M.left,eg-ef,D);else if(eD&&ep>ex){let E=eg-B+eu+ef;Wo(M.left,E,D)}})(E,D)})}),E.on("PostRender",()=>{eM(E,!1)})},isDocked:E=>E().map(hY.isDocked).getOr(!1),getBehaviours:tM});let h3=Dn([dO,ns("items",Fn([tL([d_,ds("items",tG)]),tG]))].concat(d9)),h5=[ps("text"),ps("tooltip"),ps("icon"),xs("search",!1,Fn([tW,Dn([ps("placeholder")])],E=>er(E)?E?A.some({placeholder:A.none()}):A.none():A.some(E))),is("fetch"),Os("onSetup",()=>b)],h9=Dn([dO,...h5]),aM=E=>qn("menubutton",h9,E),h4=Dn([dO,d$,dJ,dj,dK,dU,dG,ks("presets","normal",["normal","color","listpreview"]),Cy(1),dz,dP]);var h6=fm({factory:(E,T)=>{let D={focus:sQ.focusIn,setMenus:(E,D)=>{let B=H(D,E=>{let D={type:"menubutton",text:E.text,fetch:T=>{T(E.getItems())}},B=aM(D).mapError(E=>Kn(E)).getOrDie();return tT(B,"tox-mbtn",T.backstage,A.some("menuitem"))});s1.set(E,B)}};return{uid:E.uid,dom:E.dom,components:[],behaviours:kl([s1.config({}),Jp("menubar-events",[oZ(T=>{E.onSetup(T)}),Ur(t2(),(E,T)=>{pi(E.element,".tox-mbtn--active").each(D=>{hi(T.event.target,".tox-mbtn").each(T=>{Ze(D,T)||E.getSystem().getByDom(D).each(D=>{E.getSystem().getByDom(T).each(E=>{mL.expand(E),mL.close(D),s9.focus(E)})})})})}),Ur(oj(),(E,T)=>{T.event.prevFocus.bind(T=>E.getSystem().getByDom(T).toOptional()).each(D=>{T.event.newFocus.bind(T=>E.getSystem().getByDom(T).toOptional()).each(E=>{mL.isOpen(D)&&(mL.expand(E),mL.close(D))})})})]),sQ.config({mode:"flow",selector:".tox-mbtn",onEscape:T=>(E.onEscape(T),A.some(!0))}),mq.config({})]),apis:D,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[os("dom"),os("uid"),os("onEscape"),os("backstage"),ys("onSetup",b)],apis:{focus:(E,T)=>{E.focus(T)},setMenus:(E,T,D)=>{E.setMenus(T,D)}}});let h8="container",h7=[hu("slotBehaviours",[])],uM=E=>"<alloy.field."+E+">",mM=(E,T)=>{let o=T=>am(E),n=(T,D)=>(B,M)=>om(B,E,M).map(E=>T(E,M)).getOr(D),s=(E,T)=>"true"!==Ot(E.element,"aria-hidden"),D=n(s,!1),B=n((E,T)=>{if(s(E)){let D=E.element;Dt(D,"display","none"),kt(D,"aria-hidden","true"),Ir(E,oJ(),{name:T,visible:!1})}}),i=(E,T)=>{L(T,T=>B(E,T))},M=n((E,T)=>{if(!s(E)){let D=E.element;Ht(D,"display"),Et(D,"aria-hidden"),Ir(E,oJ(),{name:T,visible:!0})}});return{uid:E.uid,dom:E.dom,components:T,behaviours:fu(E.slotBehaviours),apis:{getSlotNames:o,getSlot:(T,D)=>om(T,E,D),isShowing:D,hideSlot:B,hideAllSlots:E=>i(E,o()),showSlot:M}}},fn=ce({getSlotNames:(E,T)=>E.getSlotNames(T),getSlot:(E,T,D)=>E.getSlot(T,D),isShowing:(E,T,D)=>E.isShowing(T,D),hideSlot:(E,T,D)=>E.hideSlot(T,D),hideAllSlots:(E,T)=>E.hideAllSlots(T),showSlot:(E,T,D)=>E.showSlot(T,D)},E=>Ca(E)),fr={...fn,sketch:E=>{let T=(()=>{let E=[];return{slot:(T,D)=>(E.push(T),Ju(h8,uM(T),D)),record:x(E)}})(),D=E(T),B=T.record(),M=H(B,E=>aT({name:E,pname:uM(E)}));return mm(h8,h7,M,mM,D)}},fa=Dn([dJ,d$,Os("onShow",b),Os("onHide",b),dG]),fM=E=>({element:()=>E.element.dom}),bM=(E,T)=>{let D=H(eD(T),E=>{let D=T[E],B=Xn(qn("sidebar",fa,D));return{name:E,getApi:fM,onSetup:B.onSetup,onShow:B.onShow,onHide:B.onHide}});return H(D,T=>{let B=Es(b);return E.slot(T.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:lx([Tx(T,B),Ex(T,B),Ur(oJ(),(E,T)=>{let B=T.event,M=G(D,E=>E.name===B.name);M.each(T=>{(B.visible?T.onShow:T.onHide)(T.getApi(E))})})])})})},vM=E=>fr.sketch(T=>({dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:bM(T,E),slotBehaviours:lx([oZ(E=>fr.hideAllSlots(E))])})),yM=(E,T)=>{kt(E,"role",T)},xM=E=>aW.getCurrent(E).bind(E=>pZ.isGrowing(E)||pZ.hasGrown(E)?aW.getCurrent(E).bind(E=>G(fr.getSlotNames(E),T=>fr.isShowing(E,T))):A.none()),fi=la("FixSizeEvent"),fd=la("AutoSizeEvent");var fp=Object.freeze({__proto__:null,block:(E,T,D,B)=>{kt(E.element,"aria-busy",!0);let M=T.getRoot(E).getOr(E),er=kl([sQ.config({mode:"special",onTab:()=>A.some(!0),onShiftTab:()=>A.some(!0)}),s9.config({})]),ec=B(M,er),eu=M.getSystem().build(ec);s1.append(M,Sa(eu)),eu.hasConfigured(sQ)&&T.focus&&sQ.focusIn(eu),D.isBlocked()||T.onBlock(E),D.blockWith(()=>s1.remove(M,eu))},unblock:(E,T,D)=>{Et(E.element,"aria-busy"),D.isBlocked()&&T.onUnblock(E),D.clear()},isBlocked:(E,T,D)=>D.isBlocked()}),ff=[Os("getRoot",A.none),Cs("focus",!0),Di("onBlock"),Di("onUnblock")];let fb=Ol({fields:ff,name:"blocking",apis:fp,state:Object.freeze({__proto__:null,init:()=>{let E=Jl(E=>E.destroy());return _a({readState:E.isSet,blockWith:T=>{E.set({destroy:T})},clear:E.clear,isBlocked:E.isSet})}})}),_M=E=>aW.getCurrent(E).each(E=>Dl(E.element)),TM=(E,T,D)=>{let B=Es(!1),M=Ql(),r=D=>{!B.get()||"focusin"===D.type&&(D.composed?oe(D.composedPath()):A.from(D.target)).map(Fe).filter(eL).exists(E=>Ua(E,"mce-pastebin"))||(D.preventDefault(),_M(T()),E.editorManager.setActive(E))};E.inline||E.on("PreInit",()=>{E.dom.bind(E.getWin(),"focusin",r),E.on("BeforeExecCommand",E=>{"mcefocus"===E.command.toLowerCase()&&!0!==E.value&&r(E)})});let a=M=>{M!==B.get()&&(B.set(M),((E,T,D,B)=>{let M=T.element;if(((E,T)=>{let D="tabindex",B=`data-mce-${D}`;A.from(E.iframeElement).map(Fe).each(E=>{T?(_t(E,D).each(T=>kt(E,B,T)),kt(E,D,-1)):(Et(E,D),_t(E,B).each(T=>{kt(E,D,T),Et(E,B)}))})})(E,D),D)fb.block(T,(E,T)=>({dom:{tag:"div",attributes:{"aria-label":B.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:jh('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]})),Ht(M,"display"),Et(M,"aria-hidden"),E.hasFocus()&&_M(T);else{let D=aW.getCurrent(T).exists(E=>Fl(E.element));fb.unblock(T),Dt(M,"display","none"),kt(M,"aria-hidden","true"),D&&E.focus()}})(E,T(),M,D.providers),((E,T)=>{E.dispatch("AfterProgressState",{state:T})})(E,M))};E.on("ProgressState",T=>{if(M.on(clearTimeout),eg(T.time)){let D=iP.setEditorTimeout(E,()=>a(T.state),T.time);M.set(D)}else a(T.state),M.clear()})},EM=(E,T,D)=>({within:E,extra:T,withinWidth:D}),AM=(E,T,D)=>{let B=j(E,(E,T)=>((E,T)=>{let B=D(E);return A.some({element:E,start:T,finish:T+B,width:B})})(T,E.len).fold(x(E),T=>({len:T.finish,list:E.list.concat([T])})),{len:0,list:[]}).list,M=U(B,E=>E.finish<=T),er=W(M,(E,T)=>E+T.width,0);return{within:M,extra:B.slice(M.length),withinWidth:er}},MM=E=>H(E,E=>E.element),DM=(E,T)=>{let D=H(T,E=>Sa(E));hH.setGroups(E,D)},BM=(E,T,D)=>{let B=T.builtGroups.get();if(0===B.length)return;let M=nm(E,T,"primary"),er=mD.getCoupled(E,"overflowGroup");Dt(M.element,"visibility","hidden");let ec=B.concat([er]),eu=re(ec,E=>Rl(E.element).bind(T=>E.getSystem().getByDom(T).toOptional()));D([]),DM(M,ec);let eg=((E,T,D,B)=>{let M=((E,T,D)=>{let B=AM(T,E,D);return 0===B.extra.length?A.some(B):A.none()})(E,T,D).getOrThunk(()=>AM(T,E-D(B),D)),er=M.within,ec=M.extra,eu=M.withinWidth;return 1===ec.length&&ec[0].width<=D(B)?((E,T,D)=>{let B=MM(E.concat(T));return EM(B,[],D)})(er,ec,eu):ec.length>=1?((E,T,D,B)=>{let M=MM(E).concat([D]);return EM(M,MM(T),B)})(er,ec,B,eu):EM(MM(er),[],eu)})(Jt(M.element),T.builtGroups.get(),E=>Jt(E.element),er);0===eg.extra.length?(s1.remove(M,er),D([])):(DM(M,eg.within),D(eg.extra)),Ht(M.element,"visibility"),Lt(M.element),eu.each(s9.focus)},fv=x([hu("splitToolbarBehaviours",[mD]),es("builtGroups",()=>Es([]))]),fx=x([Ai(["overflowToggledClass"]),fs("getOverflowBounds"),os("lazySink"),es("overflowGroups",()=>Es([])),Di("onOpened"),Di("onClosed")].concat(fv())),fy=x([aT({factory:hH,schema:hB(),name:"primary"}),aF({schema:hB(),name:"overflow"}),aF({name:"overflow-button"}),aF({name:"overflow-group"})]),fA=x((E,T)=>{((E,T)=>{let D=eX.max(E,T,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);Dt(E,"max-width",D+"px")})(E,Math.floor(T))}),fk=x([Ai(["toggledClass"]),os("lazySink"),is("fetch"),fs("getBounds"),vs("fireDismissalEventInstead",[ys("event",oG())]),wc(),Di("onToggled")]),fO=x([aF({name:"button",overrides:E=>({dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:kl([s7.config({toggleClass:E.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1,onToggled:E.onToggled})])})}),aF({factory:hH,schema:hB(),name:"toolbar",overrides:E=>({toolbarBehaviours:kl([sQ.config({mode:"cyclic",onEscape:T=>(om(T,E,"button").each(s9.focus),A.none())})])})})]),fE=Ql(),LM=(E,T)=>{let D=mD.getCoupled(E,"toolbarSandbox");rq.isOpen(D)?rq.close(D):rq.open(D,T.toolbar())},PM=(E,T,D,B)=>{let M=D.getBounds.map(E=>E()),er=D.lazySink(E).getOrDie();rW.positionWithinBounds(er,T,{anchor:{type:"hotspot",hotspot:E,layouts:B,overrides:{maxWidthFunction:fA()}}},M)},UM=(E,T,D,B,M)=>{hH.setGroups(T,M),PM(E,T,D,B),s7.on(E)},fT=bm({name:"FloatingToolbarButton",factory:(E,T,D,B)=>({...iG.sketch({...B.button(),action:E=>{LM(E,B)},buttonBehaviours:bu({dump:B.button().buttonBehaviours},[mD.config({others:{toolbarSandbox:T=>((E,T,D)=>{let B=bi();return{dom:{tag:"div",attributes:{id:B.id}},behaviours:kl([sQ.config({mode:"special",onEscape:E=>(rq.close(E),A.some(!0))}),rq.config({onOpen:(M,er)=>{let ec=fE.get().getOr(!1);D.fetch().get(M=>{UM(E,er,D,T.layouts,M),B.link(E.element),ec||sQ.focusIn(er)})},onClose:()=>{s7.off(E),fE.get().getOr(!1)||s9.focus(E),B.unlink(E.element)},isPartOf:(T,D,B)=>vi(D,B)||vi(E,B),getAttachPoint:()=>D.lazySink(E).getOrDie()}),nQ.config({channels:{...Qd({isExtraPart:ep,...D.fireDismissalEventInstead.map(E=>({fireEventInstead:{event:E.event}})).getOr({})}),...tu({doReposition:()=>{rq.getState(mD.getCoupled(E,"toolbarSandbox")).each(B=>{PM(E,B,D,T.layouts)})}})}})])}})(T,D,E)}})])}),apis:{setGroups:(T,B)=>{rq.getState(mD.getCoupled(T,"toolbarSandbox")).each(M=>{UM(T,M,E,D.layouts,B)})},reposition:T=>{rq.getState(mD.getCoupled(T,"toolbarSandbox")).each(B=>{PM(T,B,E,D.layouts)})},toggle:E=>{LM(E,B)},toggleWithoutFocusing:E=>{fE.set(!0),LM(E,B),fE.clear()},getToolbar:E=>rq.getState(mD.getCoupled(E,"toolbarSandbox")),isOpen:E=>rq.isOpen(mD.getCoupled(E,"toolbarSandbox"))}}),configFields:fk(),partFields:fO(),apis:{setGroups:(E,T,D)=>{E.setGroups(T,D)},reposition:(E,T)=>{E.reposition(T)},toggle:(E,T)=>{E.toggle(T)},toggleWithoutFocusing:(E,T)=>{E.toggleWithoutFocusing(T)},getToolbar:(E,T)=>E.getToolbar(T),isOpen:(E,T)=>E.isOpen(T)}}),fD=x([os("items"),Ai(["itemSelector"]),hu("tgroupBehaviours",[sQ])]),fB=x([aH({name:"items",unit:"item"})]),fI=bm({name:"ToolbarGroup",configFields:fD(),partFields:fB(),factory:(E,T,D,B)=>({uid:E.uid,dom:E.dom,components:T,behaviours:bu(E.tgroupBehaviours,[sQ.config({mode:"flow",selector:E.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}})}),qM=E=>H(E,E=>Sa(E)),XM=(E,T,D)=>{BM(E,D,B=>{D.overflowGroups.set(B),T.getOpt(E).each(E=>{fT.setGroups(E,qM(B))})})},fH=bm({name:"SplitFloatingToolbar",configFields:fx(),partFields:fy(),factory:(E,T,D,B)=>{let M=Gh(fT.sketch({fetch:()=>fS(T=>{T(qM(E.overflowGroups.get()))}),layouts:{onLtr:()=>[rl,sl],onRtl:()=>[sl,rl],onBottomLtr:()=>[il,al],onBottomRtl:()=>[al,il]},getBounds:D.getOverflowBounds,lazySink:E.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:E.markers.overflowToggledClass},parts:{button:B["overflow-button"](),toolbar:B.overflow()},onToggled:(T,D)=>E[D?"onOpened":"onClosed"](T)}));return{uid:E.uid,dom:E.dom,components:T,behaviours:bu(E.splitToolbarBehaviours,[mD.config({others:{overflowGroup:()=>fI.sketch({...B["overflow-group"](),items:[M.asSpec()]})}})]),apis:{setGroups:(T,D)=>{E.builtGroups.set(H(D,T.getSystem().build)),XM(T,M,E)},refresh:T=>XM(T,M,E),toggle:E=>{M.getOpt(E).each(E=>{fT.toggle(E)})},toggleWithoutFocusing:E=>{M.getOpt(E).each(fT.toggleWithoutFocusing)},isOpen:E=>M.getOpt(E).map(fT.isOpen).getOr(!1),reposition:E=>{M.getOpt(E).each(E=>{fT.reposition(E)})},getOverflow:E=>M.getOpt(E).bind(fT.getToolbar)},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(E,T,D)=>{E.setGroups(T,D)},refresh:(E,T)=>{E.refresh(T)},reposition:(E,T)=>{E.reposition(T)},toggle:(E,T)=>{E.toggle(T)},toggleWithoutFocusing:(E,T)=>{E.toggle(T)},isOpen:(E,T)=>E.isOpen(T),getOverflow:(E,T)=>E.getOverflow(T)}}),fR=x([Ai(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),Di("onOpened"),Di("onClosed")].concat(fv())),fN=x([aT({factory:hH,schema:hB(),name:"primary"}),aT({factory:hH,schema:hB(),name:"overflow",overrides:E=>({toolbarBehaviours:kl([pZ.config({dimension:{property:"height"},closedClass:E.markers.closedClass,openClass:E.markers.openClass,shrinkingClass:E.markers.shrinkingClass,growingClass:E.markers.growingClass,onShrunk:T=>{om(T,E,"overflow-button").each(E=>{s7.off(E),s9.focus(E)}),E.onClosed(T)},onGrown:T=>{sQ.focusIn(T),E.onOpened(T)},onStartGrow:T=>{om(T,E,"overflow-button").each(s7.on)}}),sQ.config({mode:"acyclic",onEscape:T=>(om(T,E,"overflow-button").each(s9.focus),A.some(!0))})])})}),aF({name:"overflow-button",overrides:E=>({buttonBehaviours:kl([s7.config({toggleClass:E.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])})}),aF({name:"overflow-group"})]),ZM=(E,T)=>{om(E,T,"overflow-button").bind(()=>om(E,T,"overflow")).each(D=>{QM(E,T),pZ.toggleGrow(D)})},QM=(E,T)=>{om(E,T,"overflow").each(D=>{BM(E,T,E=>{let T=H(E,E=>Sa(E));hH.setGroups(D,T)}),om(E,T,"overflow-button").each(E=>{pZ.hasGrown(D)&&s7.on(E)}),pZ.refresh(D)})},fU=bm({name:"SplitSlidingToolbar",configFields:fR(),partFields:fN(),factory:(E,T,D,B)=>{let M="alloy.toolbar.toggle";return{uid:E.uid,dom:E.dom,components:T,behaviours:bu(E.splitToolbarBehaviours,[mD.config({others:{overflowGroup:E=>fI.sketch({...B["overflow-group"](),items:[iG.sketch({...B["overflow-button"](),action:T=>{Fr(E,M)}})]})}}),Jp("toolbar-toggle-events",[Ur(M,T=>{ZM(T,E)})])]),apis:{setGroups:(T,D)=>{((T,D)=>{let B=H(D,T.getSystem().build);E.builtGroups.set(B)})(T,D),QM(T,E)},refresh:T=>QM(T,E),toggle:T=>ZM(T,E),isOpen:T=>om(T,E,"overflow").map(pZ.hasGrown).getOr(!1)},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(E,T,D)=>{E.setGroups(T,D)},refresh:(E,T)=>{E.refresh(T)},toggle:(E,T)=>{E.toggle(T)},isOpen:(E,T)=>E.isOpen(T)}}),tD=E=>{let T=E.title.fold(()=>({}),E=>({attributes:{title:E}}));return{dom:{tag:"div",classes:["tox-toolbar__group"],...T},components:[fI.parts.items({})],items:E.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled]), .tox-number-input:not([disabled])"},tgroupBehaviours:kl([mq.config({}),s9.config({})])}},oD=E=>fI.sketch(tD(E)),nD=(E,T)=>{let D=oZ(T=>{let D=H(E.initGroups,oD);hH.setGroups(T,D)});return kl([Ox(E.providers.isDisabled),Sx(),sQ.config({mode:T,onEscape:E.onEscape,selector:".tox-toolbar__group"}),Jp("toolbar-events",[D])])},sD=E=>{let T=E.cyclicKeying?"cyclic":"acyclic";return{uid:E.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":tD({title:A.none(),items:[]}),"overflow-button":TT({name:"more",icon:A.some("more-drawer"),enabled:!0,tooltip:A.some("Reveal or hide additional toolbar items"),primary:!1,buttonType:A.none(),borderless:!1},A.none(),E.providers)},splitToolbarBehaviours:nD(E,T)}},rD=E=>{let T=sD(E),D=fH.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return fH.sketch({...T,lazySink:E.getSink,getOverflowBounds:()=>{let T=E.moreDrawerData.lazyHeader().element,D=Zo(T),B=ot(T),M=Zo(B),er=Math.max(B.dom.scrollHeight,M.height);return Ko(D.x+4,M.y,D.width-8,er)},parts:{...T.parts,overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:E.attributes}}},components:[D],markers:{overflowToggledClass:"tox-tbtn--enabled"},onOpened:T=>E.onToggled(T,!0),onClosed:T=>E.onToggled(T,!1)})},aD=E=>{let T=fU.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),D=fU.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),B=sD(E);return fU.sketch({...B,components:[T,D],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:T=>{T.getSystem().broadcastOn([hZ()],{type:"opened"}),E.onToggled(T,!0)},onClosed:T=>{T.getSystem().broadcastOn([hZ()],{type:"closed"}),E.onToggled(T,!1)}})},iD=E=>{let T=E.cyclicKeying?"cyclic":"acyclic";return hH.sketch({uid:E.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(E.type===l5.scrolling?["tox-toolbar--scrolling"]:[])},components:[hH.parts.groups({})],toolbarBehaviours:nD(E,T)})},fL=[dj,dJ,ps("tooltip"),ks("buttonType","secondary",["primary","secondary"]),Cs("borderless",!1),is("onAction")],fz={button:[...fL,dM,as("type",["button"])],togglebutton:[...fL,Cs("active",!1),as("type",["togglebutton"])]},fP=[as("type",["group"]),_s("buttons",[],Jn("type",fz))],fG=Jn("type",{...fz,group:fP}),fW=Dn([_s("buttons",[],fG),is("onShow"),is("onHide")]),gD=(E,T)=>((E,T)=>{var D,B;let M="togglebutton"===E.type,er=E.icon.map(E=>f_(E,T.icons)).map(Gh),ec={...E,name:M?E.text.getOr(E.icon.getOr("")):null!==(D=E.text)&&void 0!==D?D:E.icon.getOr(""),primary:"primary"===E.buttonType,buttonType:A.from(E.buttonType),tooltip:E.tooltip,icon:E.icon,enabled:!0,borderless:E.borderless},eu=ET(null!==(B=E.buttonType)&&void 0!==B?B:"secondary"),eg=M?E.text.map(T.translate):A.some(T.translate(E.text)),ep=eg.map(ti),eh=ec.tooltip.or(eg).map(E=>({"aria-label":T.translate(E),title:T.translate(E)})).getOr({}),ef=er.map(E=>E.asSpec()),ex=we([ef,ep]),ew=E.icon.isSome()&&ep.isSome(),e_={tag:"button",classes:eu.concat(...E.icon.isSome()&&!ew?["tox-button--icon"]:[]).concat(...ew?["tox-button--icon-and-text"]:[]).concat(...E.borderless?["tox-button--naked"]:[]).concat(..."togglebutton"===E.type&&E.active?["tox-button--enabled"]:[]),attributes:eh},eD=_T(ec,A.some(D=>{let n=E=>{er.map(B=>B.getOpt(D).each(D=>{s1.set(D,[f_(E,T.icons)])}))};return M?E.onAction({setIcon:n,setActive:E=>{let T=D.element;E?(La(T,"tox-button--enabled"),kt(T,"aria-pressed",!0)):(Pa(T,"tox-button--enabled"),Et(T,"aria-pressed"))},isActive:()=>Ua(D.element,"tox-button--enabled")}):"button"===E.type?E.onAction({setIcon:n}):void 0}),[],e_,ex,T);return iG.sketch(eD)})(E,T),fj=Do().deviceType,fJ=fj.isPhone(),f$=fj.isTablet();var fX=bm({name:"silver.View",configFields:[os("viewConfig")],partFields:[aB({factory:{sketch:E=>{let T=!1,D=H(E.buttons,D=>{var B;return"group"===D.type?(T=!0,B=E.providers,{dom:{tag:"div",classes:["tox-view__toolbar__group"]},components:H(D.buttons,E=>gD(E,B))}):gD(D,E.providers)});return{uid:E.uid,dom:{tag:"div",classes:[T?"tox-view__toolbar":"tox-view__header",...fJ||f$?["tox-view--mobile","tox-view--scrolling"]:[]]},behaviours:kl([s9.config({}),sQ.config({mode:"flow",selector:"button, .tox-button",focusInside:i6.OnEnterOrSpaceMode})]),components:T?D:[mG.sketch({dom:{tag:"div",classes:["tox-view__header-start"]},components:[]}),mG.sketch({dom:{tag:"div",classes:["tox-view__header-end"]},components:D})]}}},schema:[os("buttons"),os("providers")],name:"header"}),aB({factory:{sketch:E=>({uid:E.uid,dom:{tag:"div",classes:["tox-view__pane"]}})},schema:[],name:"pane"})],factory:(E,T,D,B)=>({uid:E.uid,dom:E.dom,components:T,apis:{getPane:T=>aU.getPart(T,E,"pane"),getOnShow:T=>E.viewConfig.onShow,getOnHide:T=>E.viewConfig.onHide}}),apis:{getPane:(E,T)=>E.getPane(T),getOnShow:(E,T)=>E.getOnShow(T),getOnHide:(E,T)=>E.getOnHide(T)}});let vD=(E,T,D)=>pe(T,(T,B)=>{let M=Xn(qn("view",fW,T));return E.slot(B,fX.sketch({dom:{tag:"div",classes:["tox-view"]},viewConfig:M,components:[...M.buttons.length>0?[fX.parts.header({buttons:M.buttons,providers:D})]:[],fX.parts.pane({})]}))}),yD=(E,T)=>fr.sketch(D=>({dom:{tag:"div",classes:["tox-view-wrap__slot-container"]},components:vD(D,E,T),slotBehaviours:lx([oZ(E=>fr.hideAllSlots(E))])})),xD=E=>G(fr.getSlotNames(E),T=>fr.isShowing(E,T)),wD=(E,T,D)=>{fr.getSlot(E,T).each(E=>{fX.getPane(E).each(T=>{D(E)({getContainer:x(T.element.dom)})})})};var fq=fm({factory:(E,T)=>({uid:E.uid,dom:{tag:"div",classes:["tox-view-wrap"],attributes:{"aria-hidden":"true"},styles:{display:"none"}},components:[],behaviours:kl([s1.config({}),aW.config({find:E=>{let T=s1.contents(E);return oe(T)}})]),apis:{setViews:(E,D)=>{s1.set(E,[yD(D,T.backstage.shared.providers)])},whichView:E=>aW.getCurrent(E).bind(xD),toggleView:(E,T,D,B)=>aW.getCurrent(E).exists(M=>{let er=xD(M),ec=er.exists(E=>B===E),eu=fr.getSlot(M,B).isSome();return eu&&(fr.hideAllSlots(M),ec?((E=>{let T=E.element;Dt(T,"display","none"),kt(T,"aria-hidden","true")})(E),T()):(D(),(E=>{let T=E.element;Ht(T,"display"),Et(T,"aria-hidden")})(E),fr.showSlot(M,B),wD(M,B,fX.getOnShow)),er.each(E=>wD(M,E,fX.getOnHide))),eu})}}),name:"silver.ViewWrapper",configFields:[os("backstage")],apis:{setViews:(E,T,D)=>E.setViews(T,D),toggleView:(E,T,D,B,M)=>E.toggleView(T,D,B,M),whichView:(E,T)=>E.whichView(T)}});let fK=aN.optional({factory:h6,name:"menubar",schema:[os("backstage")]}),fY=aN.optional({factory:{sketch:E=>hD.sketch({uid:E.uid,dom:E.dom,listBehaviours:kl([sQ.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:()=>iD({type:E.type,uid:la("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:E.providers,onEscape:()=>(E.onEscape(),A.some(!0))}),setupItem:(E,T,D,B)=>{hH.setGroups(T,D)},shell:!0})},name:"multiple-toolbar",schema:[os("dom"),os("onEscape")]}),fZ=aN.optional({factory:{sketch:E=>{let T=E.type===l5.sliding?aD:E.type===l5.floating?rD:iD;return T({type:E.type,uid:E.uid,onEscape:()=>(E.onEscape(),A.some(!0)),onToggled:(T,D)=>E.onToolbarToggled(D),cyclicKeying:!1,initGroups:[],getSink:E.getSink,providers:E.providers,moreDrawerData:{lazyToolbar:E.lazyToolbar,lazyMoreButton:E.lazyMoreButton,lazyHeader:E.lazyHeader},attributes:E.attributes})}},name:"toolbar",schema:[os("dom"),os("onEscape"),os("getSink")]}),fQ=aN.optional({factory:{sketch:E=>{let T=E.editor,D=E.sticky?tM:hR;return{uid:E.uid,dom:E.dom,components:E.components,behaviours:kl(D(T,E.sharedBackstage))}}},name:"header",schema:[os("dom")]}),f0=aN.optional({factory:{sketch:E=>({uid:E.uid,dom:E.dom,components:[{dom:{tag:"a",attributes:{href:"https://www.tiny.cloud/tinymce-self-hosted-premium-features/?utm_source=TinyMCE&utm_medium=SPAP&utm_campaign=SPAP&utm_id=editorreferral",rel:"noopener",target:"_blank","aria-hidden":"true"},classes:["tox-promotion-link"],innerHtml:"⚡️Upgrade"}}]})},name:"promotion",schema:[os("dom")]}),f1=aN.optional({name:"socket",schema:[os("dom")]}),f2=aN.optional({factory:{sketch:E=>({uid:E.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"presentation"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:kl([mq.config({}),s9.config({}),pZ.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:E=>{aW.getCurrent(E).each(fr.hideAllSlots),Fr(E,fd)},onGrown:E=>{Fr(E,fd)},onStartGrow:E=>{Ir(E,fi,{width:Nt(E.element,"width").getOr("")})},onStartShrink:E=>{Ir(E,fi,{width:Jt(E.element)+"px"})}}),s1.config({}),aW.config({find:E=>{let T=s1.contents(E);return oe(T)}})])}],behaviours:kl([BO(0),Jp("sidebar-sliding-events",[Ur(fi,(E,T)=>{Dt(E.element,"width",T.event.width)}),Ur(fd,(E,T)=>{Ht(E.element,"width")})])])})},name:"sidebar",schema:[os("dom")]}),f3=aN.optional({factory:{sketch:E=>({uid:E.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:kl([s1.config({}),fb.config({focus:!1}),aW.config({find:E=>oe(E.components())})]),components:[]})},name:"throbber",schema:[os("dom")]}),f5=aN.optional({factory:fq,name:"viewWrapper",schema:[os("backstage")]}),f9=aN.optional({factory:{sketch:E=>({uid:E.uid,dom:{tag:"div",classes:["tox-editor-container"]},components:E.components})},name:"editorContainer",schema:[]});var f4=bm({name:"OuterContainer",factory:(E,D,B)=>{let M=!1,er={getSocket:T=>aU.getPart(T,E,"socket"),setSidebar:(D,B,M)=>{aU.getPart(D,E,"sidebar").each(E=>((E,D,B)=>{aW.getCurrent(E).each(M=>{s1.set(M,[vM(D)]);let er=null==B?void 0:B.toLowerCase();T(er)&&ve(D,er)&&aW.getCurrent(M).each(T=>{fr.showSlot(T,er),pZ.immediateGrow(M),Ht(M.element,"width"),yM(E.element,"region")})})})(E,B,M))},toggleSidebar:(T,D)=>{aU.getPart(T,E,"sidebar").each(E=>((E,T)=>{aW.getCurrent(E).each(D=>{aW.getCurrent(D).each(B=>{pZ.hasGrown(D)?fr.isShowing(B,T)?(pZ.shrink(D),yM(E.element,"presentation")):(fr.hideAllSlots(B),fr.showSlot(B,T),yM(E.element,"region")):(fr.hideAllSlots(B),fr.showSlot(B,T),pZ.grow(D),yM(E.element,"region"))})})})(E,D))},whichSidebar:T=>aU.getPart(T,E,"sidebar").bind(xM).getOrNull(),getHeader:T=>aU.getPart(T,E,"header"),getToolbar:T=>aU.getPart(T,E,"toolbar"),setToolbar:(T,D)=>{aU.getPart(T,E,"toolbar").each(E=>{let T=H(D,oD);E.getApis().setGroups(E,T)})},setToolbars:(T,D)=>{aU.getPart(T,E,"multiple-toolbar").each(E=>{let T=H(D,E=>H(E,oD));hD.setItems(E,T)})},refreshToolbar:T=>{aU.getPart(T,E,"toolbar").each(E=>E.getApis().refresh(E))},toggleToolbarDrawer:T=>{aU.getPart(T,E,"toolbar").each(E=>{ke(E.getApis().toggle,T=>T(E))})},toggleToolbarDrawerWithoutFocusing:T=>{aU.getPart(T,E,"toolbar").each(E=>{ke(E.getApis().toggleWithoutFocusing,T=>T(E))})},isToolbarDrawerToggled:T=>aU.getPart(T,E,"toolbar").bind(E=>A.from(E.getApis().isOpen).map(T=>T(E))).getOr(!1),getThrobber:T=>aU.getPart(T,E,"throbber"),focusToolbar:T=>{aU.getPart(T,E,"toolbar").orThunk(()=>aU.getPart(T,E,"multiple-toolbar")).each(E=>{sQ.focusIn(E)})},setMenubar:(T,D)=>{aU.getPart(T,E,"menubar").each(E=>{h6.setMenus(E,D)})},focusMenubar:T=>{aU.getPart(T,E,"menubar").each(E=>{h6.focus(E)})},setViews:(T,D)=>{aU.getPart(T,E,"viewWrapper").each(E=>{fq.setViews(E,D)})},toggleView:(T,D)=>aU.getPart(T,E,"viewWrapper").exists(E=>fq.toggleView(E,()=>er.showMainView(T),()=>er.hideMainView(T),D)),whichView:T=>aU.getPart(T,E,"viewWrapper").bind(fq.whichView).getOrNull(),hideMainView:T=>{(M=er.isToolbarDrawerToggled(T))&&er.toggleToolbarDrawer(T),aU.getPart(T,E,"editorContainer").each(E=>{let T=E.element;Dt(T,"display","none"),kt(T,"aria-hidden","true")})},showMainView:T=>{M&&er.toggleToolbarDrawer(T),aU.getPart(T,E,"editorContainer").each(E=>{let T=E.element;Ht(T,"display"),Et(T,"aria-hidden")})}};return{uid:E.uid,dom:E.dom,components:D,apis:er,behaviours:E.behaviours}},configFields:[os("dom"),os("behaviours")],partFields:[fQ,fK,fZ,fY,f1,f2,f0,f3,f5,f9],apis:{getSocket:(E,T)=>E.getSocket(T),setSidebar:(E,T,D,B)=>{E.setSidebar(T,D,B)},toggleSidebar:(E,T,D)=>{E.toggleSidebar(T,D)},whichSidebar:(E,T)=>E.whichSidebar(T),getHeader:(E,T)=>E.getHeader(T),getToolbar:(E,T)=>E.getToolbar(T),setToolbar:(E,T,D)=>{E.setToolbar(T,D)},setToolbars:(E,T,D)=>{E.setToolbars(T,D)},refreshToolbar:(E,T)=>E.refreshToolbar(T),toggleToolbarDrawer:(E,T)=>{E.toggleToolbarDrawer(T)},toggleToolbarDrawerWithoutFocusing:(E,T)=>{E.toggleToolbarDrawerWithoutFocusing(T)},isToolbarDrawerToggled:(E,T)=>E.isToolbarDrawerToggled(T),getThrobber:(E,T)=>E.getThrobber(T),setMenubar:(E,T,D)=>{E.setMenubar(T,D)},focusMenubar:(E,T)=>{E.focusMenubar(T)},focusToolbar:(E,T)=>{E.focusToolbar(T)},setViews:(E,T,D)=>{E.setViews(T,D)},toggleView:(E,T,D)=>E.toggleView(T,D),whichView:(E,T)=>E.whichView(T)}});let f6={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template inserttemplate codesample inserttable accordion | charmap emoticons hr | pagebreak nonbreaking anchor tableofcontents footnotes | mergetags | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | styles blocks fontfamily fontsize align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"aidialog aishortcuts | spellchecker spellcheckerlanguage | autocorrect capitalization | a11ycheck code typography wordcount addtemplate"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},RD=E=>E.split(" "),ND=(E,D)=>{let B={...f6,...D.menus},M=eD(D.menus).length>0,er=void 0===D.menubar||!0===D.menubar?RD("file edit view insert format tools table help"):RD(!1===D.menubar?"":D.menubar),ec=U(er,E=>{let T=ve(f6,E);return M?T||be(D.menus,E).exists(E=>ve(E,"items")):T}),eu=H(ec,T=>{let M=B[T];return((E,T,D)=>{let B=ck(D).split(/[ ,]/);return{text:E.title,getItems:()=>X(E.items,E=>{let D=E.toLowerCase();return 0===D.trim().length||N(B,E=>E===D)?[]:"separator"===D||"|"===D?[{type:"separator"}]:T.menuItems[D]?[T.menuItems[D]]:[]})}})({title:M.title,items:RD(M.items)},D,E)});return U(eu,E=>E.getItems().length>0&&N(E.getItems(),E=>T(E)||"separator"!==E.type))},VD=E=>{let t=()=>{E._skinLoaded=!0,(E=>{E.dispatch("SkinLoaded")})(E)};return()=>{E.initialized?t():E.on("init",t)}},zD=(E,T,D)=>(E.on("remove",()=>D.unload(T)),D.load(T)),HD=(E,T)=>zD(E,T+"/skin.min.css",E.ui.styleSheetLoader),LD=(E,T)=>bt(Fe(E.getElement())).isSome()?zD(E,T+"/skin.shadowdom.min.css",l4.DOM.styleSheetLoader):Promise.resolve(),PD=(E,D)=>{let B=Jb(D);return B&&D.contentCSS.push(B+(E?"/content.inline":"/content")+".min.css"),!Yb(D)&&T(B)?Promise.all([HD(D,B),LD(D,B)]).then(VD(D),()=>((E,T)=>{E.dispatch("SkinLoadError",T)})(D,{message:"Skin could not be loaded"})):Promise.resolve(VD(D)())},f8=k(PD,!1),f7=k(PD,!0),jD=(E,T,D)=>{let n=(E,B,M,er)=>{let ec=T.shared.providers.translate(E.title);if("separator"===E.type)return A.some({type:"separator",text:ec});if("submenu"===E.type){let T=X(E.getStyleItems(),E=>s(E,B,er));return 0===B&&T.length<=0?A.none():A.some({type:"nestedmenuitem",text:ec,enabled:T.length>0,getSubmenuItems:()=>X(E.getStyleItems(),E=>s(E,B,er))})}return A.some({type:"togglemenuitem",text:ec,icon:E.icon,active:E.isSelected(er),enabled:!M,onAction:D.onAction(E),...E.getStylePreview().fold(()=>({}),E=>({meta:{style:E}}))})},s=(E,T,B)=>{let M="formatter"===E.type&&D.isInvalid(E);return 0===T?M?[]:n(E,T,!1,B).toArray():n(E,T,M,B).toArray()},r=E=>{let T=D.getCurrentValue(),B=D.shouldHide?0:1;return X(E,E=>s(E,B,T))};return{validateItems:r,getFetch:(E,T)=>(D,B)=>{let M=T(),er=r(M);B(C_(er,c5.CLOSE_ON_EXECUTE,E,{isHorizontalMenu:!1,search:A.none()}))}}},GD=(E,T,D)=>{let B=D.dataset,M="basic"===B.type?()=>H(B.data,E=>FE(E,D.isSelectedFor,D.getPreviewFor)):B.getData;return{items:jD(0,T,D),getStyleItems:M}},$D=(E,T,D)=>{let{items:B,getStyleItems:M}=GD(0,T,D),er=yw(E,"NodeChange",T=>{let B=T.getComponent();D.updateText(B),aq.set(T.getComponent(),!E.selection.isEditable())});return x_({text:D.icon.isSome()?A.none():D.text,icon:D.icon,tooltip:A.from(D.tooltip),role:A.none(),fetch:B.getFetch(T,M),onSetup:er,getApi:E=>({getComponent:x(E)}),columns:1,presets:"normal",classes:D.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",T.shared)};(tx=tw||(tw={}))[tx.SemiColon=0]="SemiColon",tx[tx.Space=1]="Space";let XD=(E,T,D)=>{var B;let M=(B=E.options.get(T),H(D===tw.SemiColon?B.replace(/;$/,"").split(";"):B.split(" "),E=>{let T=E,D=E,B=E.split("=");return B.length>1&&(T=B[0],D=B[1]),{title:T,format:D}}));return{type:"basic",data:M}},bo=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],KD=E=>({tooltip:"Align",text:A.none(),icon:A.some("align-left"),isSelectedFor:T=>()=>E.formatter.match(T),getCurrentValue:A.none,getPreviewFor:E=>A.none,onAction:T=>()=>G(bo,E=>E.format===T.format).each(T=>E.execCommand(T.command)),updateText:T=>{let D=G(bo,T=>E.formatter.match(T.format)).fold(x("left"),E=>E.title.toLowerCase());Ir(T,pP,{icon:`align-${D}`})},dataset:{type:"basic",data:bo},shouldHide:!1,isInvalid:T=>!E.formatter.canApply(T.format)}),JD=(E,T)=>{let D=T(),B=H(D,E=>E.format);return A.from(E.formatter.closest(B)).bind(E=>G(D,T=>T.format===E)).orThunk(()=>Ce(E.formatter.match("p"),{title:"Paragraph",format:"p"}))},ZD=E=>{let T="Paragraph",D=XD(E,"block_formats",tw.SemiColon);return{tooltip:"Blocks",text:A.some(T),icon:A.none(),isSelectedFor:T=>()=>E.formatter.match(T),getCurrentValue:A.none,getPreviewFor:T=>()=>{let D=E.formatter.get(T);return D?A.some({tag:D.length>0&&(D[0].inline||D[0].block)||"div",styles:E.dom.parseStyle(E.formatter.getCssText(T))}):A.none()},onAction:xw(E),updateText:B=>{let M=JD(E,()=>D.data).fold(x(T),E=>E.title);Ir(B,pz,{text:M})},dataset:D,shouldHide:!1,isInvalid:T=>!E.formatter.canApply(T.format)}},bn=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],eB=E=>{let T=E.split(/\s*,\s*/);return H(T,E=>E.replace(/^['"]+|['"]+$/g,""))},tB=E=>{let T="System Font",o=()=>{let o=E=>E?eB(E)[0]:"",B=E.queryCommandValue("FontName"),M=D.data,er=B?B.toLowerCase():"",ec=G(M,E=>{let T=E.format;return T.toLowerCase()===er||o(T).toLowerCase()===o(er).toLowerCase()}).orThunk(()=>Ce(0===er.indexOf("-apple-system")&&(()=>{let E=eB(er.toLowerCase());return Y(bn,T=>E.indexOf(T.toLowerCase())>-1)})(),{title:T,format:er}));return{matchOpt:ec,font:B}},D=XD(E,"font_family_formats",tw.SemiColon);return{tooltip:"Fonts",text:A.some(T),icon:A.none(),isSelectedFor:E=>T=>T.exists(T=>T.format===E),getCurrentValue:()=>{let{matchOpt:E}=o();return E},getPreviewFor:E=>()=>A.some({tag:"div",styles:-1===E.indexOf("dings")?{"font-family":E}:{}}),onAction:T=>()=>{E.undoManager.transact(()=>{E.focus(),E.execCommand("FontName",!1,T.format)})},updateText:E=>{let{matchOpt:T,font:D}=o(),B=T.fold(x(D),E=>E.title);Ir(E,pz,{text:B})},dataset:D,shouldHide:!1,isInvalid:ep}},br={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},bd=(()=>{let E="[0-9]+",T="[eE][+-]?"+E,o=E=>`(?:${E})?`,D=["Infinity",E+"\\."+o(E)+o(T),"\\."+E+o(T),E+o(T)].join("|");return RegExp(`^([+-]?(?:${D}))(.*)$`)})(),sB=(E,T)=>A.from(bd.exec(E)).bind(E=>{let D=Number(E[1]),B=E[2];return N(T,E=>N(br[E],E=>B===E))?A.some({value:D,unit:B}):A.none()}),bg={tab:x(9),escape:x(27),enter:x(13),backspace:x(8),delete:x(46),left:x(37),up:x(38),right:x(39),down:x(40),space:x(32),home:x(36),end:x(35),pageUp:x(33),pageDown:x(34)},bp={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},bf={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},lB=(E,T)=>/[0-9.]+px$/.test(E)?((E,T)=>{let D=Math.pow(10,T);return Math.round(E*D)/D})(72*parseInt(E,10)/96,T||0)+"pt":be(bf,E).getOr(E),cB=E=>be(bp,E).getOr(""),dB=E=>{let t=()=>{let T=A.none(),B=D.data,M=E.queryCommandValue("FontSize");if(M)for(let E=3;T.isNone()&&E>=0;E--){let D=lB(M,E),er=cB(D);T=G(B,E=>E.format===M||E.format===D||E.format===er)}return{matchOpt:T,size:M}},T=x(A.none),D=XD(E,"font_size_formats",tw.Space);return{tooltip:"Font sizes",text:A.some("12pt"),icon:A.none(),isSelectedFor:E=>T=>T.exists(T=>T.format===E),getPreviewFor:T,getCurrentValue:()=>{let{matchOpt:E}=t();return E},onAction:T=>()=>{E.undoManager.transact(()=>{E.focus(),E.execCommand("FontSize",!1,T.format)})},updateText:E=>{let{matchOpt:T,size:D}=t(),B=T.fold(x(D),E=>E.title);Ir(E,pz,{text:B})},dataset:D,shouldHide:!1,isInvalid:ep}},uB=(E,T)=>{let D="Paragraph";return{tooltip:"Formats",text:A.some(D),icon:A.none(),isSelectedFor:T=>()=>E.formatter.match(T),getCurrentValue:A.none,getPreviewFor:T=>()=>{let D=E.formatter.get(T);return void 0!==D?A.some({tag:D.length>0&&(D[0].inline||D[0].block)||"div",styles:E.dom.parseStyle(E.formatter.getCssText(T))}):A.none()},onAction:xw(E),updateText:T=>{let n=E=>EE(E)?X(E.items,n):AE(E)?[{title:E.title,format:E.format}]:[],B=X(BE(E),n),M=JD(E,x(B)).fold(x(D),E=>E.title);Ir(T,pz,{text:M})},shouldHide:cy(E),isInvalid:T=>!E.formatter.canApply(T.format),dataset:T}},bb=x([os("toggleClass"),os("fetch"),Fi("onExecute"),ys("getHotspot",A.some),ys("getAnchorOverrides",x({})),wc(),Fi("onItemExecute"),us("lazySink"),os("dom"),Di("onOpen"),hu("splitDropdownBehaviours",[mD,sQ,s9]),ys("matchWidth",!1),ys("useMinWidth",!1),ys("eventOrder",{}),us("role")].concat(ES())),bv=aT({factory:iG,schema:[os("dom")],name:"arrow",defaults:()=>({buttonBehaviours:kl([s9.revoke()])}),overrides:E=>({dom:{tag:"span",attributes:{role:"presentation"}},action:T=>{T.getSystem().getByUid(E.uid).each(Rr)},buttonBehaviours:kl([s7.config({toggleOnExecute:!1,toggleClass:E.toggleClass})])})}),bx=aT({factory:iG,schema:[os("dom")],name:"button",defaults:()=>({buttonBehaviours:kl([s9.revoke()])}),overrides:E=>({dom:{tag:"span",attributes:{role:"presentation"}},action:T=>{T.getSystem().getByUid(E.uid).each(D=>{E.onExecute(D,T)})}})}),by=x([bv,bx,aB({factory:{sketch:E=>({uid:E.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:E.text}})},schema:[os("text")],name:"aria-descriptor"}),aF({schema:[Ei()],name:"menu",defaults:E=>({onExecute:(T,D)=>{T.getSystem().getByUid(E.uid).each(B=>{E.onItemExecute(B,T,D)})}})}),mR()]),bA=bm({name:"SplitDropdown",configFields:bb(),partFields:by(),factory:(E,T,D,B)=>{let s=E=>{aW.getCurrent(E).each(E=>{aZ.highlightFirst(E),sQ.focusIn(E)})},r=T=>{kS(E,w,T,B,s,i8.HighlightMenuAndItem).get(b)},a=T=>{let D=nm(T,E,"button");return Rr(D),A.some(!0)},M={...Hr([oZ((T,D)=>{om(T,E,"aria-descriptor").each(E=>{let D=la("aria");kt(E.element,"id",D),kt(T.element,"aria-describedby",D)})})]),...mh(A.some(r))};return{uid:E.uid,dom:E.dom,components:T,apis:{repositionMenus:E=>{s7.isOn(E)&&TS(E)}},eventOrder:{...E.eventOrder,[oS()]:["disabling","toggling","alloy.base.behaviour"]},events:M,behaviours:bu(E.splitDropdownBehaviours,[mD.config({others:{sandbox:T=>{let D=nm(T,E,"arrow");return _S(E,T,{onOpen:()=>{s7.on(D),s7.on(T)},onClose:()=>{s7.off(D),s7.off(T)}})}}}),sQ.config({mode:"special",onSpace:a,onEnter:a,onDown:E=>(r(E),A.some(!0))}),s9.config({}),s7.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:E.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:(E,T)=>E.repositionMenus(T)}}),bB=E=>({isEnabled:()=>!aq.isDisabled(E),setEnabled:T=>aq.set(E,!T),setText:T=>Ir(E,pz,{text:T}),setIcon:T=>Ir(E,pP,{icon:T})}),vB=E=>({setActive:T=>{s7.set(E,T)},isActive:()=>s7.isOn(E),isEnabled:()=>!aq.isDisabled(E),setEnabled:T=>aq.set(E,!T),setText:T=>Ir(E,pz,{text:T}),setIcon:T=>Ir(E,pP,{icon:T})}),yB=(E,T)=>E.map(E=>({"aria-label":T.translate(E),title:T.translate(E)})).getOr({}),bk=la("focus-button"),wB=(E,T,D,B,M)=>{let er=T.map(E=>Gh(b_(E,"tox-tbtn",M))),ec=E.map(E=>Gh(f_(E,M.icons)));return{dom:{tag:"button",classes:["tox-tbtn"].concat(T.isSome()?["tox-tbtn--select"]:[]),attributes:yB(D,M)},components:we([ec.map(E=>E.asSpec()),er.map(E=>E.asSpec())]),eventOrder:{[tZ()]:["focusing","alloy.base.behaviour",pU],[oz()]:[pU,"toolbar-group-button-events"]},buttonBehaviours:kl([Ox(M.isDisabled),Sx(),Jp(pU,[oZ((E,T)=>g_(E)),Ur(pz,(E,T)=>{er.bind(T=>T.getOpt(E)).each(E=>{s1.set(E,[ti(M.translate(T.event.text))])})}),Ur(pP,(E,T)=>{ec.bind(T=>T.getOpt(E)).each(E=>{s1.set(E,[f_(T.event.icon,M.icons)])})}),Ur(tZ(),(E,T)=>{T.event.prevent(),Fr(E,bk)})])].concat(B.getOr([])))}},SB=(E,T,D)=>{var B,M;let er=Es(b),ec=wB(E.icon,E.text,E.tooltip,A.none(),D);return iG.sketch({dom:ec.dom,components:ec.components,eventOrder:pL,buttonBehaviours:{...kl([Jp("toolbar-button-events",[(B={onAction:E.onAction,getApi:T.getApi},o1((E,T)=>{_x(B,E)(T=>{Ir(E,pN,{buttonApi:T}),B.onAction(T)})})),Tx(T,er),Ex(T,er)]),Ox(()=>!E.enabled||D.isDisabled()),Sx()].concat(T.toolbarButtonBehaviours)),[pU]:null===(M=ec.buttonBehaviours)||void 0===M?void 0:M[pU]}})},kB=(E,T,D)=>SB(E,{toolbarButtonBehaviours:D.length>0?[Jp("toolbarButtonWith",D)]:[],getApi:bB,onSetup:E.onSetup},T),CB=(E,T,D)=>SB(E,{toolbarButtonBehaviours:[s1.config({}),s7.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(D.length>0?[Jp("toolbarToggleButtonWith",D)]:[]),getApi:vB,onSetup:E.onSetup},T),OB=(E,T,D)=>B=>fS(E=>T.fetch(E)).map(M=>A.from(HS(tR(Zw(la("menu-value"),M,D=>{T.onItemAction(E(B),D)},T.columns,T.presets,c5.CLOSE_ON_EXECUTE,T.select.getOr(ep),D),{movement:eS(T.columns,T.presets),menuBehaviours:lx("auto"!==T.columns?[]:[oZ((E,D)=>{ix(E,4,_v(T.presets)).each(({numRows:T,numColumns:D})=>{sQ.setGridSize(E,T,D)})})])})))),bO=[{name:"history",items:["undo","redo"]},{name:"ai",items:["aidialog","aishortcuts"]},{name:"styles",items:["styles"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],TB=(E,T)=>(D,B,M)=>{let er=E(D).mapError(E=>Kn(E)).getOrDie();return T(er,B,M)},bD={button:TB(Fy,(E,T)=>kB(E,T.shared.providers,[])),togglebutton:TB(Ny,(E,T)=>CB(E,T.shared.providers,[])),menubutton:TB(aM,(E,T)=>tT(E,"tox-tbtn",T,A.none(),!1)),splitbutton:TB(E=>qn("SplitButton",h4,E),(E,T)=>((E,T)=>{let o=E=>({isEnabled:()=>!aq.isDisabled(E),setEnabled:T=>aq.set(E,!T),setIconFill:(T,D)=>{pi(E.element,`svg path[class="${T}"], rect[class="${T}"]`).each(E=>{kt(E,"fill",D)})},setActive:T=>{kt(E.element,"aria-pressed",T),pi(E.element,"span").each(D=>{E.getSystem().getByDom(D).each(E=>s7.set(E,T))})},isActive:()=>pi(E.element,"span").exists(T=>E.getSystem().getByDom(T).exists(s7.isOn)),setText:T=>pi(E.element,"span").each(D=>E.getSystem().getByDom(D).each(E=>Ir(E,pz,{text:T}))),setIcon:T=>pi(E.element,"span").each(D=>E.getSystem().getByDom(D).each(E=>Ir(E,pP,{icon:T})))}),D=Es(b),B={getApi:o,onSetup:E.onSetup};return bA.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:{"aria-pressed":!1,...yB(E.tooltip,T.providers)}},onExecute:T=>{let D=o(T);D.isEnabled()&&E.onAction(D)},onItemExecute:(E,T,D)=>{},splitDropdownBehaviours:kl([Cx(T.providers.isDisabled),Sx(),Jp("split-dropdown-events",[oZ((E,T)=>g_(E)),Ur(bk,s9.focus),Tx(B,D),Ex(B,D)]),go.config({})]),eventOrder:{[oz()]:["alloy.base.behaviour","split-dropdown-events"]},toggleClass:"tox-tbtn--enabled",lazySink:T.getSink,fetch:OB(o,E,T.providers),parts:{menu:Bv(0,E.columns,E.presets)},components:[bA.parts.button(wB(E.icon,E.text,A.none(),A.some([s7.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),T.providers)),bA.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:Zf("chevron-down",T.providers.icons)},buttonBehaviours:kl([Cx(T.providers.isDisabled),Sx(),Qf()])}),bA.parts["aria-descriptor"]({text:T.providers.translate("To open the popup, press Shift+Enter")})]})})(E,T.shared)),grouptoolbarbutton:TB(E=>qn("GroupToolbarButton",h3,E),(E,T,D)=>{let B=D.ui.registry.getAll().buttons,M={[ra]:T.shared.header.isPositionedAtTop()?i4.TopToBottom:i4.BottomToTop};if(cS(D)===l5.floating)return((E,T,D,B)=>{let M=T.shared,er=Es(b),ec={toolbarButtonBehaviours:[],getApi:bB,onSetup:E.onSetup},eu=[Jp("toolbar-group-button-events",[Tx(ec,er),Ex(ec,er)])];return fT.sketch({lazySink:M.getSink,fetch:()=>fS(T=>{T(H(D(E.items),oD))}),markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:wB(E.icon,E.text,E.tooltip,A.some(eu),M.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:B}}}})})(E,T,E=>MB(D,{buttons:B,toolbar:E,allowToolbarGroups:!1},T,A.none()),M);throw Error("Toolbar groups are only supported when using floating toolbar mode")})},bI={styles:(E,T)=>{let D={type:"advanced",...T.styles};return $D(E,T,uB(E,D))},fontsize:(E,T)=>$D(E,T,dB(E)),fontsizeinput:(E,T)=>((E,T,D)=>{let B=A.none(),M=yw(E,"NodeChange SwitchMode",T=>{let M=T.getComponent();B=A.some(M),D.updateInputValue(M),aq.set(M,!E.selection.isEditable())}),r=E=>({getComponent:x(E)}),er=Es(b),ec=la("custom-number-input-events"),l=(E,T,M)=>{let er=B.map(E=>r6.getValue(E)).getOr(""),ec=D.getNewValue(er,E),eu=er.length-`${ec}`.length,eg=B.map(E=>E.element.dom.selectionStart-eu),ep=B.map(E=>E.element.dom.selectionEnd-eu);D.onAction(ec,M),B.each(E=>{r6.setValue(E,ec),T&&(eg.each(T=>E.element.dom.selectionStart=T),ep.each(T=>E.element.dom.selectionEnd=T))})},c=(E,T)=>l((E,T)=>E-T,E,T),d=(E,T)=>l((E,T)=>E+T,E,T),u=E=>rt(E.element).fold(A.none,E=>(Dl(E),A.some(!0))),m=E=>Fl(E.element)?(ct(E.element).each(E=>Dl(E)),A.some(!0)):A.none(),g=(D,B,M,ec)=>{let eu=T.shared.providers.translate(M),eg=la("altExecuting"),ep=yw(E,"NodeChange SwitchMode",T=>{aq.set(T.getComponent(),!E.selection.isEditable())}),u=E=>{aq.isDisabled(E)||D(!0)};return iG.sketch({dom:{tag:"button",attributes:{title:eu,"aria-label":eu},classes:ec.concat(B)},components:[h_(B,T.shared.providers.icons)],buttonBehaviours:kl([aq.config({}),Jp(eg,[Tx({onSetup:ep,getApi:r},er),Ex({getApi:r},er),Ur(t9(),(E,T)=>{T.event.raw.keyCode!==bg.space()&&T.event.raw.keyCode!==bg.enter()||aq.isDisabled(E)||D(!1)}),Ur(t7(),u),Ur(tK(),u)])]),eventOrder:{[t9()]:[eg,"keying"],[t7()]:[eg,"alloy.base.behaviour"],[tK()]:[eg,"alloy.base.behaviour"]}})},eu=Gh(g(E=>c(!1,E),"minus","Decrease font size",["highlight-on-focus"])),eg=Gh(g(E=>d(!1,E),"plus","Increase font size",["highlight-on-focus"])),ep=Gh({dom:{tag:"div",classes:["tox-input-wrapper","highlight-on-focus"]},components:[dx.sketch({inputBehaviours:kl([aq.config({}),Jp(ec,[Tx({onSetup:M,getApi:r},er),Ex({getApi:r},er)]),Jp("input-update-display-text",[Ur(pz,(E,T)=>{r6.setValue(E,T.event.text)}),Ur(t5(),E=>{D.onAction(r6.getValue(E))}),Ur(t8(),E=>{D.onAction(r6.getValue(E))})]),sQ.config({mode:"special",onEnter:E=>(l(w,!0,!0),A.some(!0)),onEscape:u,onUp:E=>(d(!0,!1),A.some(!0)),onDown:E=>(c(!0,!1),A.some(!0)),onLeft:(E,T)=>(T.cut(),A.none()),onRight:(E,T)=>(T.cut(),A.none())})])})],behaviours:kl([s9.config({}),sQ.config({mode:"special",onEnter:m,onSpace:m,onEscape:u}),Jp("input-wrapper-events",[Ur(t2(),E=>{L([eu,eg],T=>{let D=Fe(T.get(E).element.dom);Fl(D)&&Bl(D)})})])])});return{dom:{tag:"div",classes:["tox-number-input"]},components:[eu.asSpec(),ep.asSpec(),eg.asSpec()],behaviours:kl([s9.config({}),sQ.config({mode:"flow",focusInside:i6.OnEnterOrSpaceMode,cycles:!1,selector:"button, .tox-input-wrapper",onEscape:E=>Fl(E.element)?A.none():(Dl(E.element),A.some(!0))})])}})(E,T,(E=>{let t=()=>E.queryCommandValue("FontSize");return{updateInputValue:E=>Ir(E,pz,{text:t()}),onAction:(T,D)=>E.execCommand("FontSize",!1,T,{skip_focus:!D}),getNewValue:(T,D)=>{var B;sB(T,["unsupportedLength","empty"]);let M=sB(T,["unsupportedLength","empty"]).or(sB(t(),["unsupportedLength","empty"])),er=M.map(E=>E.value).getOr(16),ec=cP(E),eu=M.map(E=>E.unit).filter(E=>""!==E).getOr(ec),eg=D(er,(null!==(B=({em:{step:.1},cm:{step:.1},in:{step:.1},pc:{step:.1},ch:{step:.1},rem:{step:.1}})[eu])&&void 0!==B?B:{step:1}).step);return`${eg>=0?eg:er}${eu}`}}})(E)),fontfamily:(E,T)=>$D(E,T,tB(E)),blocks:(E,T)=>$D(E,T,ZD(E)),align:(E,T)=>$D(E,T,KD(E))},MB=(E,D,B,M)=>{let er=(E=>{let D=E.toolbar,B=E.buttons;return!1===D?[]:void 0===D||!0===D?(E=>{let T=H(bO,T=>{let D=U(T.items,T=>ve(E,T)||ve(bI,T));return{name:T.name,items:D}});return U(T,E=>E.items.length>0)})(B):T(D)?(E=>{let T=E.split("|");return H(T,E=>({items:E.trim().split(" ")}))})(D):f(D,E=>ve(E,"name")&&ve(E,"items"))?D:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])})(D),ec=H(er,T=>{let er=X(T.items,T=>{var er,ec;return 0===T.trim().length?[]:(er=D.buttons,ec=D.allowToolbarGroups,be(er,T.toLowerCase()).orThunk(()=>M.bind(E=>re(E,E=>be(er,E+T.toLowerCase())))).fold(()=>be(bI,T.toLowerCase()).map(T=>T(E,B)),D=>"grouptoolbarbutton"!==D.type||ec?be(bD,D.type).fold(()=>(console.error("skipping button defined by",D),A.none()),T=>A.some(T(D,B,E))):(console.warn(`Ignoring the '${T}' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested.`),A.none()))).toArray()});return{title:A.from(E.translate(T.name)),items:er}});return U(ec,E=>E.items.length>0)},DB=(E,D,B,M)=>{let er=D.mainUi.outerContainer,ec=B.toolbar,eu=B.buttons;if(f(ec,T)){let T=ec.map(T=>{let D={toolbar:T,buttons:eu,allowToolbarGroups:B.allowToolbarGroups};return MB(E,D,M,A.none())});f4.setToolbars(er,T)}else f4.setToolbar(er,MB(E,B,M,A.none()))},bH=Do(),bU=bH.os.isiOS()&&bH.os.version.major<=12;var bL=Object.freeze({__proto__:null,render:(E,T,D,B,er)=>{var ec;let{mainUi:eu,uiMotherships:eg}=T,ep=Es(0),eh=eu.outerContainer;E.on("SkinLoaded",()=>{DB(E,T,D,B)}),f8(E);let ef=Fe(er.targetNode),ex=ft(eJ(ef));Rd(ef,eu.mothership),lv(E)&&Rd(T.mainUi.mothership.element,T.popupUi.mothership),Id(ex,T.dialogUi.mothership),E.on("PostRender",()=>{f4.setSidebar(eh,D.sidebar,cQ(E)),DB(E,T,D,B),ep.set(E.getWin().innerWidth),f4.setMenubar(eh,ND(E,D)),f4.setViews(eh,D.views),((E,T)=>{let{uiMotherships:D}=T,B=E.dom,M=E.getWin(),er=E.getDoc().documentElement,ec=Es(Gt(M.innerWidth,M.innerHeight)),eu=Es(Gt(er.offsetWidth,er.offsetHeight)),l=()=>{let T=ec.get();T.left===M.innerWidth&&T.top===M.innerHeight||(ec.set(Gt(M.innerWidth,M.innerHeight)),gw(E))},c=()=>{let T=E.getDoc().documentElement,D=eu.get();D.left===T.offsetWidth&&D.top===T.offsetHeight||(eu.set(Gt(T.offsetWidth,T.offsetHeight)),gw(E))},d=T=>{((E,T)=>{E.dispatch("ScrollContent",T)})(E,T)};B.bind(M,"resize",l),B.bind(M,"scroll",d);let eg=oc(Fe(E.getBody()),"load",c);E.on("hide",()=>{L(D,E=>{Dt(E.element,"display","none")})}),E.on("show",()=>{L(D,E=>{Ht(E.element,"display")})}),E.on("NodeChange",c),E.on("remove",()=>{eg.unbind(),B.unbind(M,"resize",l),B.unbind(M,"scroll",d),M=null})})(E,T)});let ew=f4.getSocket(eh).getOrDie("Could not find expected socket element");if(bU){let T;Bt(ew.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});let D=(ec=()=>{E.dispatch("ScrollContent")},T=null,{cancel:()=>{M(T)||(clearTimeout(T),T=null)},throttle:(...E)=>{M(T)&&(T=setTimeout(()=>{T=null,ec.apply(null,E)},20))}}),B=tc(ew.element,"scroll",D.throttle);E.on("remove",B.unbind)}wx(E,T),E.addCommand("ToggleSidebar",(T,D)=>{f4.toggleSidebar(eh,D),E.dispatch("ToggleSidebar")}),E.addQueryValueHandler("ToggleSidebar",()=>{var E;return null!==(E=f4.whichSidebar(eh))&&void 0!==E?E:""}),E.addCommand("ToggleView",(T,D)=>{if(f4.toggleView(eh,D)){let T=eh.element;eu.mothership.broadcastOn([rK()],{target:T}),L(eg,E=>{E.broadcastOn([rK()],{target:T})}),M(f4.whichView(eh))&&(E.focus(),E.nodeChanged(),f4.refreshToolbar(eh))}}),E.addQueryValueHandler("ToggleView",()=>{var E;return null!==(E=f4.whichView(eh))&&void 0!==E?E:""});let e_=cS(E);return e_!==l5.sliding&&e_!==l5.floating||E.on("ResizeWindow ResizeEditor ResizeContent",()=>{let D=E.getWin().innerWidth;D!==ep.get()&&(f4.refreshToolbar(T.mainUi.outerContainer),ep.set(D))}),{iframeContainer:ew.element.dom,editorContainer:eh.element.dom,api:{setEnabled:E=>{xx(T,!E)},isEnabled:()=>!aq.isDisabled(eh)}}}});let RB=E=>/^[0-9\.]+(|px)$/i.test(""+E)?A.some(parseInt(""+E,10)):A.none(),NB=E=>eg(E)?E+"px":E,VB=(E,T,D)=>{let B=T.filter(T=>E<T),M=D.filter(T=>E>T);return B.or(M).getOr(E)},zB=E=>{let T=cr(E),D=ca(E),B=cg(E);return RB(T).map(E=>VB(E,D,B))},{ToolbarLocation:bz,ToolbarMode:bP}=c2,PB=(E,T,D,B,M)=>{let{mainUi:er,uiMotherships:ec}=D,eu=l4.DOM,eg=sv(E),ep=iv(E),eh=cg(E).or(zB(E)),ef=B.shared.header,ex=ef.isPositionedAtTop,ew=cS(E),e_=ew===bP.sliding||ew===bP.floating,eD=Es(!1),f=()=>eD.get()&&!E.removed,b=E=>e_?E.fold(x(0),E=>E.components().length>1?Wt(E.components()[1].element):0):0,v=()=>{L(ec,E=>{E.broadcastOn([rY()],{})})},y=D=>{if(!f())return;eg||M.on(E=>{let D=eh.getOrThunk(()=>{let E=RB(It(xt(),"margin-left")).getOr(0);return Jt(xt())-Xt(T).left+E});Dt(E.element,"max-width",D+"px")});let B=eg?A.none():(()=>{if(eg)return A.none();if(Xt(er.outerContainer.element).left+Zt(er.outerContainer.element)>=window.innerWidth-40||Nt(er.outerContainer.element,"width").isSome()){Dt(er.outerContainer.element,"position","absolute"),Dt(er.outerContainer.element,"left","0px"),Ht(er.outerContainer.element,"width");let E=Zt(er.outerContainer.element);return A.some(E)}return A.none()})();e_&&f4.refreshToolbar(er.outerContainer),eg||M.on(D=>{var M;let ec=f4.getToolbar(er.outerContainer),eu=b(ec),eg=Jo(T),{top:ep,left:eh}=(M=er.outerContainer.element,lv(E)?xA(M):A.none()).fold(()=>({top:ex()?Math.max(eg.y-Wt(D.element)+eu,0):eg.bottom,left:eg.x}),E=>{var T;let B=Jo(E),M=null!==(T=E.dom.scrollTop)&&void 0!==T?T:0,er=Ze(E,xt()),ec=er?Math.max(eg.y-Wt(D.element)+eu,0):eg.y-B.y+M-Wt(D.element)+eu;return{top:ex()?ec:eg.bottom,left:er?eg.x:eg.x-B.x}}),ef=B.map(E=>{let T=Uo(),D=window.innerWidth-(eh-T.left);return{width:Math.max(Math.min(E,D),150)+"px"}}).getOr({});Bt(er.outerContainer.element,{position:"absolute",left:Math.round(eh)+"px",top:Math.round(ep)+"px",...ef})}),ep&&M.on(D),v()},w=()=>!(eg||!ep||!f())&&M.get().exists(D=>{let B=ef.getDockingMode(),ec=(D=>{switch(cT(E)){case bz.auto:let B=f4.getToolbar(er.outerContainer),M=b(B),ec=Wt(D.element)-M,eu=Jo(T);if(eu.y>ec)return"top";{let E=ot(T),D=Math.max(E.dom.scrollHeight,Wt(E));return eu.bottom<D-ec||en().bottom<eu.bottom-ec?"bottom":"top"}case bz.bottom:return"bottom";case bz.top:default:return"top"}})(D);return ec!==B&&(M.on(E=>{hY.setModes(E,[ec]),ef.setDockingMode(ec);let T=ex()?i4.TopToBottom:i4.BottomToTop;kt(E.element,ra,T)}),!0)});return{isVisible:f,isPositionedAtTop:ex,show:()=>{eD.set(!0),Dt(er.outerContainer.element,"display","flex"),eu.addClass(E.getBody(),"mce-edit-focus"),L(ec,E=>{Ht(E.element,"display")}),w(),lv(E)?y(E=>hY.isDocked(E)?hY.reset(E):hY.refresh(E)):y(hY.refresh)},hide:()=>{eD.set(!1),Dt(er.outerContainer.element,"display","none"),eu.removeClass(E.getBody(),"mce-edit-focus"),L(ec,E=>{Dt(E.element,"display","none")})},update:y,updateMode:()=>{w()&&y(hY.reset)},repositionPopups:v}},UB=(E,T)=>{let D=Jo(E);return{pos:T?D.y:D.bottom,bounds:D}};var bG=Object.freeze({__proto__:null,render:(E,T,D,B,M)=>{let{mainUi:er}=T,ec=Ql(),eu=Fe(M.targetNode),eg=PB(E,eu,T,B,ec),ep=cH(E);f7(E);let d=()=>{if(ec.isSet())return void eg.show();ec.set(f4.getHeader(er.outerContainer).getOrDie());let M=rv(E);lv(E)?(Rd(eu,er.mothership),Rd(eu,T.popupUi.mothership)):Id(M,er.mothership),Id(M,T.dialogUi.mothership),DB(E,T,D,B),f4.setMenubar(er.outerContainer,ND(E,D)),eg.show(),((E,T,D,B)=>{let M=Es(UB(T,D.isPositionedAtTop())),r=B=>{let{pos:er,bounds:ec}=UB(T,D.isPositionedAtTop()),{pos:eu,bounds:eg}=M.get(),ep=ec.height!==eg.height||ec.width!==eg.width;M.set({pos:er,bounds:ec}),ep&&gw(E,B),D.isVisible()&&(eu!==er?D.update(hY.reset):ep&&(D.updateMode(),D.repositionPopups()))};B||(E.on("activate",D.show),E.on("deactivate",D.hide)),E.on("SkinLoaded ResizeWindow",()=>D.update(hY.reset)),E.on("NodeChange keydown",E=>{requestAnimationFrame(()=>r(E))});let er=0,ec=PO(()=>D.update(hY.refresh),33);E.on("ScrollWindow",()=>{let E=Uo().left;E!==er&&(er=E,ec.throttle()),D.updateMode()}),lv(E)&&E.on("ElementScroll",E=>{D.update(hY.refresh)});let eu=Zl();eu.set(oc(Fe(E.getBody()),"load",E=>r(E.raw))),E.on("remove",()=>{eu.clear()})})(E,eu,eg,ep),E.nodeChanged()};E.on("show",d),E.on("hide",eg.hide),ep||(E.on("focus",d),E.on("blur",eg.hide)),E.on("init",()=>{(E.hasFocus()||ep)&&d()}),wx(E,T);let eh={show:d,hide:eg.hide,setEnabled:E=>{xx(T,!E)},isEnabled:()=>!aq.isDisabled(er.outerContainer)};return{editorContainer:er.outerContainer.element.dom,api:eh}}});let bW="contexttoolbar-hide",GB=(E,T)=>Ur(pN,(D,B)=>{var M;let er=(M=E.get(D),{hide:()=>Fr(M,oM()),getValue:()=>r6.getValue(M)});T.onAction(er,B.event.buttonApi)}),$B=(E,T)=>{let D=E.label.fold(()=>({}),E=>({"aria-label":E})),B=Gh(dx.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:E.initValue(),inputAttributes:D,selectOnFocus:!0,inputBehaviours:kl([sQ.config({mode:"special",onEnter:E=>M.findPrimary(E).map(E=>(Rr(E),!0)),onLeft:(E,T)=>(T.cut(),A.none()),onRight:(E,T)=>(T.cut(),A.none())})])})),M=((E,T,D)=>{let B=H(T,T=>Gh("contextformtogglebutton"===T.type?((E,T,D)=>{let{primary:B,...M}=T.original,er=Xn(Ny({...M,type:"togglebutton",onAction:b}));return CB(er,D,[GB(E,T)])})(E,T,D):((E,T,D)=>{let{primary:B,...M}=T.original,er=Xn(Fy({...M,type:"button",onAction:b}));return kB(er,D,[GB(E,T)])})(E,T,D)));return{asSpecs:()=>H(B,E=>E.asSpec()),findPrimary:E=>re(T,(T,D)=>T.primary?A.from(B[D]).bind(T=>T.getOpt(E)).filter(C(aq.isDisabled)):A.none())}})(B,E.commands,T);return[{title:A.none(),items:[B.asSpec()]},{title:A.none(),items:M.asSpecs()}]},qB=(E,T,D)=>T.bottom-E.y>=D&&E.bottom-T.y>=D,XB=E=>{let T=(E=>{let T=E.getBoundingClientRect();if(T.height<=0&&T.width<=0){let D=ut(Fe(E.startContainer),E.startOffset).element;return(ez(D)?st(D):A.some(D)).filter(eL).map(E=>E.dom.getBoundingClientRect()).getOr(T)}return T})(E.selection.getRng());if(E.inline){let E=Uo();return Ko(E.left+T.left,E.top+T.top,T.width,T.height)}{let D=Zo(Fe(E.getBody()));return Ko(D.x+T.left,D.y+T.top,T.width,T.height)}},YB=(E,T,D,B=0)=>{let M=Go(window),er=Jo(Fe(E.getContentAreaContainer())),ec=Kb(E)||Qb(E)||tv(E),{x:eu,width:eg}=((E,T,D)=>{let B=Math.max(E.x+D,T.x);return{x:B,width:Math.min(E.right-D,T.right)-B}})(er,M,B);if(E.inline&&!ec)return Ko(eu,M.y,eg,M.height);{let ec=T.header.isPositionedAtTop(),{y:ep,bottom:eh}=((E,T,D,B,M,er)=>{let ec=Fe(E.getContainer()),eu=pi(ec,".tox-editor-header").getOr(ec),eg=Jo(eu),ep=eg.y>=T.bottom,eh=B&&!ep;if(E.inline&&eh)return{y:Math.max(eg.bottom+er,D.y),bottom:D.bottom};if(E.inline&&!eh)return{y:D.y,bottom:Math.min(eg.y-er,D.bottom)};let ef="line"===M?Jo(ec):T;return eh?{y:Math.max(eg.bottom+er,D.y),bottom:Math.min(ef.bottom-er,D.bottom)}:{y:Math.max(ef.y+er,D.y),bottom:Math.min(eg.y-er,D.bottom)}})(E,er,M,ec,D,B);return Ko(eu,ep,eg,eh-ep)}},bj={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},bJ={maxHeightFunction:n7(),maxWidthFunction:fA()},ZB=E=>"node"===E,QB=(E,T,D,B,M)=>{let er=XB(E),ec=B.lastElement().exists(E=>Ze(D,E));return((E,T)=>{let D=E.selection.getRng(),B=ut(Fe(D.startContainer),D.startOffset);return D.startContainer===D.endContainer&&D.startOffset===D.endOffset-1&&Ze(B.element,T)})(E,D)?ec?gE:lE:ec?((E,D,M)=>{let ec=Nt(E,"position");Dt(E,"position",D);let eu=qB(er,Jo(T),-20)&&!B.isReposition()?hE:gE;return ec.each(T=>Dt(E,"position",T)),eu})(T,B.getMode()):("fixed"===B.getMode()?M.y+Uo().top:M.y)+(Wt(T)+12)<=er.y?lE:cE},eF=(E,T,D,B)=>{let s=T=>(B,M,er,ec,eu)=>({...QB(E,ec,T,D,eu)({...B,y:eu.y,height:eu.height},M,er,ec,eu),alwaysFit:!0}),r=E=>ZB(B)?[s(E)]:[];return T?{onLtr:E=>[cl,sl,rl,al,il,ll].concat(r(E)),onRtl:E=>[cl,rl,sl,il,al,ll].concat(r(E))}:{onLtr:E=>[ll,cl,al,sl,il,rl].concat(r(E)),onRtl:E=>[ll,cl,il,rl,al,sl].concat(r(E))}},tF=(E,T)=>{let D=U(T,T=>T.predicate(E.dom)),{pass:B,fail:M}=P(D,E=>"contexttoolbar"===E.type);return{contextToolbars:B,contextForms:M}},oF=(E,T)=>{let D={},B=[],M=[],er={},ec={},eu=eD(E);return L(eu,eu=>{let eg=E[eu];"contextform"===eg.type?((E,eu)=>{let eg=Xn(qn("ContextForm",uf,eu));D[E]=eg,eg.launch.map(D=>{er["form:"+E]={...eu.launch,type:"contextformtogglebutton"===D.type?"togglebutton":"button",onAction:()=>{T(eg)}}}),"editor"===eg.scope?M.push(eg):B.push(eg),ec[E]=eg})(eu,eg):"contexttoolbar"===eg.type&&((E,T)=>{qn("ContextToolbar",uv,T).each(D=>{"editor"===T.scope?M.push(D):B.push(D),ec[E]=D})})(eu,eg)}),{forms:D,inNodeScope:B,inEditorScope:M,lookupTable:ec,formNavigators:er}},b$=la("forward-slide"),bX=la("backward-slide"),bq=la("change-slide-event"),bK="tox-pop--resizing",bY="tox-pop--transition",lF=(E,T,D,B)=>{let M=B.backstage,er=M.shared,ec=Do().deviceType.isTouch,eu=Ql(),eg=Ql(),ep=Ql(),eh=ri((E=>{let T=Es([]);return iz.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:E=>{T.set([]),iz.getContent(E).each(E=>{Ht(E.element,"visibility")}),Pa(E.element,bK),Ht(E.element,"width")},inlineBehaviours:kl([Jp("context-toolbar-events",[Yr(or(),(E,T)=>{"width"===T.event.raw.propertyName&&(Pa(E.element,bK),Ht(E.element,"width"))}),Ur(bq,(E,T)=>{let D=E.element;Ht(D,"width");let B=Jt(D);iz.setContent(E,T.event.contents),La(D,bK);let M=Jt(D);Dt(D,"width",B+"px"),iz.getContent(E).each(E=>{T.event.focus.bind(E=>(Dl(E),Rl(D))).orThunk(()=>(sQ.focusIn(E),Il(eJ(D))))}),setTimeout(()=>{Dt(E.element,"width",M+"px")},0)}),Ur(b$,(E,D)=>{iz.getContent(E).each(D=>{T.set(T.get().concat([{bar:D,focus:Il(eJ(E.element))}]))}),Ir(E,bq,{contents:D.event.forwardContents,focus:A.none()})}),Ur(bX,(E,D)=>{ne(T.get()).each(D=>{T.set(T.get().slice(0,T.get().length-1)),Ir(E,bq,{contents:Sa(D.bar),focus:D.focus})})})]),sQ.config({mode:"special",onEscape:D=>ne(T.get()).fold(()=>E.onEscape(),E=>(Fr(D,bX),A.some(!0)))})]),lazySink:()=>tH.value(E.sink)})})({sink:D,onEscape:()=>(E.focus(),A.some(!0))})),u=()=>{let T=ep.get().getOr("node"),D=ZB(T)?1:0;return YB(E,er,T,D)},m=()=>!(E.removed||ec()&&M.isContextMenuOpen()),g=()=>{if(m()){let T=u(),D=xe(ep.get(),"node")?eu.get().filter(E=>yt(E)&&je(E)).map(Zo).getOrThunk(()=>XB(E)):XB(E);return T.height<=0||!qB(D,T,.01)}return!0},p=()=>{eu.clear(),eg.clear(),ep.clear(),iz.hide(eh)},h=()=>{if(iz.isOpen(eh)){let E=eh.element;Ht(E,"display"),g()?Dt(E,"display","none"):(eg.set(0),iz.reposition(eh))}},f=T=>({dom:{tag:"div",classes:["tox-pop__dialog"]},components:[T],behaviours:kl([sQ.config({mode:"acyclic"}),Jp("pop-dialog-wrap-events",[oZ(T=>{E.shortcuts.add("ctrl+F9","focus statusbar",()=>sQ.focusIn(T))}),oQ(T=>{E.shortcuts.remove("ctrl+F9")})])])}),ef=Qt(()=>oF(T,E=>{let T=y([E]);Ir(eh,b$,{forwardContents:f(T)})})),y=T=>{let{buttons:D}=E.ui.registry.getAll(),M={...D,...ef().formNavigators},ec=cS(E)===l5.scrolling?l5.scrolling:l5.default,eu=q(H(T,T=>"contexttoolbar"===T.type?MB(E,{buttons:M,toolbar:T.items,allowToolbarGroups:!1},B.backstage,A.some(["form:"])):$B(T,er.providers)));return iD({type:ec,uid:la("context-toolbar"),initGroups:eu,onEscape:A.none,cyclicKeying:!0,providers:er.providers})},x=(T,B)=>{if(ew.cancel(),!m())return;let M=y(T),ef=T[0].position,ex=((T,B)=>{var M,ep;let eh="node"===T?er.anchors.node(B):er.anchors.cursor(),ef=(M=ec(),ep={lastElement:eu.get,isReposition:()=>xe(eg.get(),0),getMode:()=>rW.getMode(D)},"line"===T?{bubble:gc(12,0,bj),layouts:{onLtr:()=>[dl],onRtl:()=>[ul]},overrides:bJ}:{bubble:gc(0,12,bj,1/12),layouts:eF(E,M,ep,T),overrides:bJ});return tR(eh,ef)})(ef,B);ep.set(ef),eg.set(1);let e_=eh.element;Ht(e_,"display"),xe(Se(B,eu.get(),Ze),!0)||(Pa(e_,bY),rW.reset(D,eh)),iz.showWithinBounds(eh,f(M),{anchor:ex,transition:{classes:[bY],mode:"placement"}},()=>A.some(u())),B.fold(eu.clear,eu.set),g()&&Dt(e_,"display","none")},ex=!1,ew=PO(()=>{!E.hasFocus()||E.removed||ex||(Ua(eh.element,bY)?ew.throttle():((E,T)=>{let D=Fe(T.getBody()),n=E=>Ze(E,D),B=Fe(T.selection.getNode());return n(B)||Qe(D,B)?((E,T,D)=>{let B=tF(E,T);if(B.contextForms.length>0)return A.some({elem:E,toolbars:[B.contextForms[0]]});{let T=tF(E,D);if(T.contextForms.length>0)return A.some({elem:E,toolbars:[T.contextForms[0]]});if(B.contextToolbars.length>0||T.contextToolbars.length>0){let D=(E=>{if(E.length<=1)return E;{let t=T=>N(E,E=>E.position===T),o=T=>U(E,E=>E.position===T),T=t("selection"),D=t("node");if(T||D){if(D&&T){let E=o("node"),T=H(o("selection"),E=>({...E,position:"node"}));return E.concat(T)}return o(T?"selection":"node")}return o("line")}})(B.contextToolbars.concat(T.contextToolbars));return A.some({elem:E,toolbars:D})}return A.none()}})(B,E.inNodeScope,E.inEditorScope).orThunk(()=>n(B)?A.none():Fs(B,T=>{if(eL(T)){let{contextToolbars:D,contextForms:B}=tF(T,E.inNodeScope),M=B.length>0?B:(E=>{if(E.length<=1)return E;{let t=T=>G(E,E=>E.position===T);return t("selection").orThunk(()=>t("node")).orThunk(()=>t("line")).map(E=>E.position).fold(()=>[],T=>U(E,E=>E.position===T))}})(D);return M.length>0?A.some({elem:T,toolbars:M}):A.none()}return A.none()},n)):A.none()})(ef(),E).fold(p,E=>{x(E.toolbars,A.some(E.elem))}))},17);E.on("init",()=>{E.on("remove",p),E.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",h),E.on("click keyup focus SetContent",ew.throttle),E.on(bW,p),E.on("contexttoolbar-show",T=>{let D=ef();be(D.lookupTable,T.toolbarKey).each(D=>{x([D],Ce(T.target!==E,T.target)),iz.getContent(eh).each(sQ.focusIn)})}),E.on("focusout",T=>{iP.setEditorTimeout(E,()=>{Rl(D.element).isNone()&&Rl(eh.element).isNone()&&p()},0)}),E.on("SwitchMode",()=>{E.mode.isReadOnly()&&p()}),E.on("AfterProgressState",T=>{T.state?p():E.hasFocus()&&ew.throttle()}),E.on("dragstart",()=>{ex=!0}),E.on("dragend drop",()=>{ex=!1}),E.on("NodeChange",E=>{Rl(eh.element).fold(ew.throttle,b)})})},cF=(E,T)=>{let o=()=>{let D=T.getOptions(E),B=T.getCurrent(E).map(T.hash),M=Ql();return H(D,D=>({type:"togglemenuitem",text:T.display(D),onSetup:er=>{let a=E=>{E&&(M.on(E=>E.setActive(!1)),M.set(er)),er.setActive(E)};a(xe(B,T.hash(D)));let ec=T.watcher(E,D,a);return()=>{M.clear(),ec()}},onAction:()=>T.setCurrent(E,D)}))};E.ui.registry.addMenuButton(T.name,{tooltip:T.text,icon:T.icon,fetch:E=>E(o()),onSetup:T.onToolbarSetup}),E.ui.registry.addNestedMenuItem(T.name,{type:"nestedmenuitem",text:T.text,getSubmenuItems:o,onSetup:T.onMenuSetup})},dF=E=>{cF(E,{name:"lineheight",text:"Line height",icon:"line-height",getOptions:Zb,hash:E=>sB(E,["fixed","relative","empty"]).map(({value:E,unit:T})=>E+T).getOr(E),display:w,watcher:(E,T,D)=>E.formatter.formatChanged("lineheight",D,!1,{value:T}).unbind,getCurrent:E=>A.from(E.queryCommandValue("LineHeight")),setCurrent:(E,T)=>E.execCommand("LineHeight",!1,T),onToolbarSetup:bw(E),onMenuSetup:bw(E)}),A.from(cA(E)).map(T=>({name:"language",text:"Language",icon:"language",getOptions:x(T),hash:E=>ec(E.customCode)?E.code:`${E.code}/${E.customCode}`,display:E=>E.title,watcher:(E,T,D)=>{var B;return E.formatter.formatChanged("lang",D,!1,{value:T.code,customValue:null!==(B=T.customCode)&&void 0!==B?B:null}).unbind},getCurrent:E=>{let T=Fe(E.selection.getNode());return Is(T,E=>A.some(E).filter(eL).bind(E=>_t(E,"lang").map(T=>({code:T,customCode:_t(E,"data-mce-lang").getOrUndefined(),title:""}))))},setCurrent:(E,T)=>E.execCommand("Lang",!1,T),onToolbarSetup:T=>{let D=Zl();return T.setActive(E.formatter.match("lang",{},void 0,!0)),D.set(E.formatter.formatChanged("lang",T.setActive,!0)),fw(D.clear,bw(E)(T))},onMenuSetup:bw(E)})).each(T=>cF(E,T))},uF=E=>yw(E,"NodeChange",T=>{T.setEnabled(E.queryCommandState("outdent")&&E.selection.isEditable())}),mF=(E,T)=>D=>{D.setActive(T.get());let n=E=>{T.set(E.state),D.setActive(E.state)};return E.on("PastePlainTextToggle",n),fw(()=>E.off("PastePlainTextToggle",n),bw(E)(D))},gF=(E,T)=>()=>{E.execCommand("mceToggleFormat",!1,T)},pF=E=>{(E=>{ph.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(T,D)=>{E.ui.registry.addToggleButton(T.name,{tooltip:T.text,icon:T.icon,onSetup:vw(E,T.name),onAction:gF(E,T.name)})});for(let T=1;T<=6;T++){let D="h"+T;E.ui.registry.addToggleButton(D,{text:D.toUpperCase(),tooltip:"Heading "+T,onSetup:vw(E,D),onAction:gF(E,D)})}})(E),ph.each([{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"print",text:"Print",action:"mcePrint",icon:"print"}],T=>{E.ui.registry.addButton(T.name,{tooltip:T.text,icon:T.icon,onAction:ww(E,T.action)})}),ph.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],T=>{E.ui.registry.addButton(T.name,{tooltip:T.text,icon:T.icon,onSetup:bw(E),onAction:ww(E,T.action)})}),ph.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],T=>{E.ui.registry.addToggleButton(T.name,{tooltip:T.text,icon:T.icon,onAction:ww(E,T.action),onSetup:vw(E,T.name)})}),ph.each([{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"},{name:"print",text:"Print...",action:"mcePrint",icon:"print",shortcut:"Meta+P"}],T=>{E.ui.registry.addMenuItem(T.name,{text:T.text,icon:T.icon,shortcut:T.shortcut,onAction:ww(E,T.action)})}),ph.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],T=>{E.ui.registry.addMenuItem(T.name,{text:T.text,icon:T.icon,shortcut:T.shortcut,onSetup:bw(E),onAction:ww(E,T.action)})}),E.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onSetup:bw(E),onAction:gF(E,"code")})},hF=(E,T)=>yw(E,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",D=>{D.setEnabled(!E.mode.isReadOnly()&&E.undoManager[T]())}),fF=E=>yw(E,"VisualAid",T=>{T.setActive(E.hasVisual)}),bF=(E,T)=>{L([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],T=>{E.ui.registry.addToggleButton(T.name,{tooltip:T.text,icon:T.icon,onAction:ww(E,T.cmd),onSetup:vw(E,T.name)})}),E.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onSetup:bw(E),onAction:ww(E,"JustifyNone")}),pF(E),((E,T)=>{let D=GD(0,T,KD(E));E.ui.registry.addNestedMenuItem("align",{text:T.shared.providers.translate("Align"),onSetup:bw(E),getSubmenuItems:()=>D.items.validateItems(D.getStyleItems())})})(E,T),((E,T)=>{let D=GD(0,T,tB(E));E.ui.registry.addNestedMenuItem("fontfamily",{text:T.shared.providers.translate("Fonts"),onSetup:bw(E),getSubmenuItems:()=>D.items.validateItems(D.getStyleItems())})})(E,T),((E,T)=>{let D={type:"advanced",...T.styles},B=GD(0,T,uB(E,D));E.ui.registry.addNestedMenuItem("styles",{text:"Formats",onSetup:bw(E),getSubmenuItems:()=>B.items.validateItems(B.getStyleItems())})})(E,T),((E,T)=>{let D=GD(0,T,ZD(E));E.ui.registry.addNestedMenuItem("blocks",{text:"Blocks",onSetup:bw(E),getSubmenuItems:()=>D.items.validateItems(D.getStyleItems())})})(E,T),((E,T)=>{let D=GD(0,T,dB(E));E.ui.registry.addNestedMenuItem("fontsize",{text:"Font sizes",onSetup:bw(E),getSubmenuItems:()=>D.items.validateItems(D.getStyleItems())})})(E,T),E.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:hF(E,"hasUndo"),onAction:ww(E,"undo")}),E.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:hF(E,"hasRedo"),onAction:ww(E,"redo")}),E.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",enabled:!1,onSetup:hF(E,"hasUndo"),onAction:ww(E,"undo")}),E.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",enabled:!1,onSetup:hF(E,"hasRedo"),onAction:ww(E,"redo")}),(E=>{E.addCommand("mceApplyTextcolor",(T,D)=>{((E,T,D)=>{E.undoManager.transact(()=>{E.focus(),E.formatter.apply(T,{value:D}),E.nodeChanged()})})(E,T,D)}),E.addCommand("mceRemoveTextcolor",T=>{((E,T)=>{E.undoManager.transact(()=>{E.focus(),E.formatter.remove(T,{value:null},void 0,!0),E.nodeChanged()})})(E,T)});let T=mf(E),D=mb(E),B=Es(T),M=Es(D);Yw(E,"forecolor","forecolor","Text color",B),Yw(E,"backcolor","hilitecolor","Background color",M),Kw(E,"forecolor","forecolor","Text color",B),Kw(E,"backcolor","hilitecolor","Background color",M)})(E),(E=>{E.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:ww(E,"mceToggleVisualAid")})})(E),(E=>{E.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:fF(E),onAction:ww(E,"mceToggleVisualAid")})})(E),E.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:uF(E),onAction:ww(E,"outdent")}),E.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onSetup:bw(E),onAction:ww(E,"indent")}),dF(E),(E=>{let T=Es(cZ(E)),o=()=>E.execCommand("mceTogglePlainTextPaste");E.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:o,onSetup:mF(E,T)}),E.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:o,onSetup:mF(E,T)})})(E)},vF=E=>T(E)?E.split(/[ ,]/):E,yF=E=>T=>T.options.get(E),bZ=yF("contextmenu_never_use_native"),bQ=yF("contextmenu_avoid_overlap"),SF=E=>{let T=E.ui.registry.getAll().contextMenus,D=E.options.get("contextmenu");return E.options.isSet("contextmenu")?D:U(D,E=>ve(T,E))},kF=(E,T)=>({type:"makeshift",x:E,y:T}),CF=E=>"longpress"===E.type||0===E.type.indexOf("touch"),OF=(E,T)=>"contextmenu"===T.type||"longpress"===T.type?E.inline?(E=>{if(CF(E)){let T=E.touches[0];return kF(T.pageX,T.pageY)}return kF(E.pageX,E.pageY)})(T):((E,T)=>{var D,B;let M=l4.DOM.getPos(E);return D=M.x,B=M.y,kF(T.x+D,T.y+B)})(E.getContentAreaContainer(),(E=>{if(CF(E)){let T=E.touches[0];return kF(T.clientX,T.clientY)}return kF(E.clientX,E.clientY)})(T)):_F(E),_F=E=>({type:"selection",root:Fe(E.selection.getNode())}),TF=(E,T,D)=>{switch(D){case"node":return{type:"node",node:A.some(Fe(E.selection.getNode())),root:Fe(E.getBody())};case"point":return OF(E,T);case"selection":return _F(E)}},EF=(E,T,D,B,M,er)=>{let ec=D(),eu=TF(E,T,er);C_(ec,c5.CLOSE_ON_EXECUTE,B,{isHorizontalMenu:!1,search:A.none()}).map(E=>{T.preventDefault(),iz.showMenuAt(M,{anchor:eu},{menu:{markers:Av("normal")},data:E})})},b0={onLtr:()=>[cl,sl,rl,al,il,ll,lE,cE,iE,rE,aE,sE],onRtl:()=>[cl,rl,sl,il,al,ll,lE,cE,aE,sE,iE,rE]},b1={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},DF=(E,T,D,B,M,er)=>{let ec=Do(),eu=ec.os.isiOS(),eg=ec.os.isMacOS(),ep=ec.os.isAndroid(),eh=ec.deviceType.isTouch(),u=()=>{let ec=D();((E,T,D,B,M,er,ec)=>{let eu=((E,T,D)=>{let B=TF(E,T,D);return{bubble:gc(0,"point"===D?12:0,b1),layouts:b0,overrides:{maxWidthFunction:fA(),maxHeightFunction:n7()},...B}})(E,T,er);C_(D,c5.CLOSE_ON_EXECUTE,B,{isHorizontalMenu:!0,search:A.none()}).map(D=>{T.preventDefault();let eg=ec?i8.HighlightMenuAndItem:i8.HighlightNone;iz.showMenuWithinBounds(M,{anchor:eu},{menu:{markers:Av("normal"),highlightOnOpen:eg},data:D,type:"horizontal"},()=>A.some(YB(E,B.shared,"node"===er?"node":"selection"))),E.dispatch(bW)})})(E,T,ec,B,M,er,!(ep||eu||eg&&eh))};if((eg||eu)&&"node"!==er){let o=()=>{(E=>{let T=E.selection.getRng(),o=()=>{iP.setEditorTimeout(E,()=>{E.selection.setRng(T)},10),r()};E.once("touchend",o);let n=E=>{E.preventDefault(),E.stopImmediatePropagation()};E.on("mousedown",n,!0);let s=()=>r();E.once("longpresscancel",s);let r=()=>{E.off("touchend",o),E.off("longpresscancel",s),E.off("mousedown",n)}})(E),u()};((E,T)=>{let D=E.selection;if(D.isCollapsed()||T.touches.length<1)return!1;{let B=T.touches[0],M=D.getRng();return Jc(E.getWin(),rF.domRange(M)).exists(E=>E.left<=B.clientX&&E.right>=B.clientX&&E.top<=B.clientY&&E.bottom>=B.clientY)}})(E,T)?o():(E.once("selectionchange",o),E.once("touchend",()=>E.off("selectionchange",o)))}else u()},BF=E=>T(E)?"|"===E:"separator"===E.type,b2={type:"separator"},IF=E=>{let t=E=>({text:E.text,icon:E.icon,enabled:E.enabled,shortcut:E.shortcut});if(T(E))return E;switch(E.type){case"separator":return b2;case"submenu":return{type:"nestedmenuitem",...t(E),getSubmenuItems:()=>{let D=E.getSubmenuItems();return T(D)?D:H(D,IF)}};default:return{type:"menuitem",...t(E),onAction:v(E.onAction)}}},RF=(E,T)=>{if(0===T.length)return E;let D=ne(E).filter(E=>!BF(E)).fold(()=>[],E=>[b2]);return E.concat(D).concat(T).concat([b2])},NF=(E,T)=>!("longpress"===T.type||ve(T,"touches"))&&(2!==T.button||T.target===E.getBody()&&""===T.pointerType),VF=(E,T)=>NF(E,T)?E.selection.getStart(!0):T.target,zF=(E,D,M)=>{let er=Do().deviceType.isTouch,ec=ri(iz.sketch({dom:{tag:"div"},lazySink:D,onEscape:()=>E.focus(),onShow:()=>M.setContextMenuState(!0),onHide:()=>M.setContextMenuState(!1),fireDismissalEventInstead:{},inlineBehaviours:kl([Jp("dismissContextMenu",[Ur(oG(),(T,D)=>{rq.close(T),E.focus()})])])})),a=()=>iz.hide(ec),i=D=>{if(bZ(E)&&D.preventDefault(),D.ctrlKey&&!bZ(E)||0===SF(E).length)return;let eu=((E,T)=>{let D=bQ(E),B=NF(E,T)?"selection":"point";if(De(D)){let M=VF(E,T);return $S(Fe(M),D)?"node":B}return B})(E,D);(er()?DF:EF)(E,D,()=>{let M=VF(E,D),er=E.ui.registry.getAll(),ec=SF(E);return((E,D,M)=>{let er=j(D,(D,er)=>be(E,er.toLowerCase()).map(E=>{let er=E.update(M);if(T(er)&&De(eR(er)))return RF(D,er.split(" "));if(B(er)&&er.length>0){let E=H(er,IF);return RF(D,E)}return D}).getOrThunk(()=>D.concat([er])),[]);return er.length>0&&BF(er[er.length-1])&&er.pop(),er})(er.contextMenus,ec,M)},M,ec,eu)};E.on("init",()=>{let T="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(er()?"":" ResizeWindow");E.on(T,a),E.on("longpress contextmenu",i)})},b3=As([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),LF=E=>T=>T.translate(-E.left,-E.top),PF=E=>T=>T.translate(E.left,E.top),UF=E=>(T,D)=>j(E,(E,T)=>T(E),Gt(T,D)),WF=(E,T,D)=>E.fold(UF([PF(D),LF(T)]),UF([LF(T)]),UF([])),jF=(E,T,D)=>E.fold(UF([PF(D)]),UF([]),UF([PF(T)])),GF=(E,T,D)=>E.fold(UF([]),UF([LF(D)]),UF([PF(T),LF(D)])),$F=(E,T,D)=>{let B=E.fold((E,T)=>({position:A.some("absolute"),left:A.some(E+"px"),top:A.some(T+"px")}),(E,T)=>({position:A.some("absolute"),left:A.some(E-D.left+"px"),top:A.some(T-D.top+"px")}),(E,T)=>({position:A.some("fixed"),left:A.some(E+"px"),top:A.some(T+"px")}));return{right:A.none(),bottom:A.none(),...B}},qF=(E,T,D,B)=>{let s=(E,M)=>(er,ec)=>{let eu=E(T,D,B);return M(er.getOr(eu.left),ec.getOr(eu.top))};return E.fold(s(GF,b5),s(jF,b9),s(WF,b4))},b5=b3.offset,b9=b3.absolute,b4=b3.fixed,JF=(E,T)=>{let D=Ot(E,T);return ec(D)?NaN:parseInt(D,10)},ZF=(E,T,D,B,M,er)=>{let ec=((E,T)=>{let D=E.element,B=JF(D,T.leftAttr),M=JF(D,T.topAttr);return isNaN(B)||isNaN(M)?A.none():A.some(Gt(B,M))})(E,T).fold(()=>D,E=>b4(E.left+B.left,E.top+B.top)),eu=T.mustSnap?eI(E,T,ec,M,er):tI(E,T,ec,M,er),eg=WF(ec,M,er);return((E,T,D)=>{let B=E.element;kt(B,T.leftAttr,D.left+"px"),kt(B,T.topAttr,D.top+"px")})(E,T,eg),eu.fold(()=>({coord:b4(eg.left,eg.top),extra:A.none()}),E=>({coord:E.output,extra:E.extra}))},QF=(E,T,D,B)=>re(E,E=>{let M=E.sensor,er=((E,T,D,B,M,er)=>{let ec=jF(E,M,er),eu=jF(T,M,er);return Math.abs(ec.left-eu.left)<=D&&Math.abs(ec.top-eu.top)<=B})(T,M,E.range.left,E.range.top,D,B);return er?A.some({output:qF(E.output,T,D,B),extra:E.extra}):A.none()}),eI=(E,T,D,B,M)=>{let er=T.getSnapPoints(E);return QF(er,D,B,M).orThunk(()=>{let E=j(er,(E,T)=>{let er=T.sensor,ec=((E,T,D,B,M,er)=>{let ec=jF(E,M,er),eu=jF(T,M,er),eg=Math.abs(ec.left-eu.left),ep=Math.abs(ec.top-eu.top);return Gt(eg,ep)})(D,er,T.range.left,T.range.top,B,M);return E.deltas.fold(()=>({deltas:A.some(ec),snap:A.some(T)}),D=>(ec.left+ec.top)/2<=(D.left+D.top)/2?{deltas:A.some(ec),snap:A.some(T)}:E)},{deltas:A.none(),snap:A.none()});return E.snap.map(E=>({output:qF(E.output,D,B,M),extra:E.extra}))})},tI=(E,T,D,B,M)=>{let er=T.getSnapPoints(E);return QF(er,D,B,M)};var b6=Object.freeze({__proto__:null,snapTo:(E,T,D,B)=>{let M=T.getTarget(E.element);if(T.repositionTarget){let T=et(E.element),D=Uo(T),er=wA(M),ec={coord:qF(B.output,B.output,D,er),extra:B.extra},eu=$F(ec.coord,0,er);Ft(M,eu)}}});let b8="data-initial-z-index",sI=(E,T)=>{E.getSystem().addToGui(T),(E=>{st(E.element).filter(eL).each(T=>{Nt(T,"z-index").each(E=>{kt(T,b8,E)}),Dt(T,"z-index",It(E.element,"z-index"))})})(T)},rI=E=>{(E=>{st(E.element).filter(eL).each(E=>{_t(E,b8).fold(()=>Ht(E,"z-index"),T=>Dt(E,"z-index",T)),Et(E,b8)})})(E),E.getSystem().removeFromGui(E)},aI=(E,T,D)=>E.getSystem().build(mG.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[T]},events:D}));var b7=vs("snaps",[os("getSnapPoints"),Di("onSensor"),os("leftAttr"),os("topAttr"),ys("lazyViewport",en),ys("mustSnap",!1)]);let vo=[ys("useFixed",ep),os("blockerClass"),ys("getTarget",w),ys("onDrag",b),ys("repositionTarget",!0),ys("onDrop",b),Os("getBounds",en),b7],cI=E=>{var T,D,B,M,er;return(T=Nt(E,"left"),D=Nt(E,"top"),B=Nt(E,"position"),T.isSome()&&D.isSome()&&B.isSome()?A.some((M=T.getOrDie(),er=D.getOrDie(),("fixed"===B.getOrDie()?b4:b5)(parseInt(M,10),parseInt(er,10)))):A.none()).getOrThunk(()=>{let T=Xt(E);return b9(T.left,T.top)})},dI=(E,T)=>({bounds:E.getBounds(),height:jt(T.element),width:Zt(T.element)}),uI=(E,T,D,B,M)=>{let er=D.update(B,M),ec=D.getStartData().getOrThunk(()=>dI(T,E));er.each(D=>{((E,T,D,B)=>{let M=T.getTarget(E.element);if(T.repositionTarget){let er=et(E.element),ec=Uo(er),eu=wA(M),eg=cI(M),ep=((E,T,D,B,M)=>{let er=M.bounds,ec=jF(T,D,B),eu=Yi(ec.left,er.x,er.x+er.width-M.width),eg=Yi(ec.top,er.y,er.y+er.height-M.height),ep=b9(eu,eg);return T.fold(()=>{let E=GF(ep,D,B);return b5(E.left,E.top)},x(ep),()=>{let E=WF(ep,D,B);return b4(E.left,E.top)})})(0,T.snaps.fold(()=>{var E,T;let D=(E=B.left,T=B.top,eg.fold((D,B)=>b5(D+E,B+T),(D,B)=>b9(D+E,B+T),(D,B)=>b4(D+E,B+T))),M=WF(D,ec,eu);return b4(M.left,M.top)},T=>{let D=ZF(E,T,eg,B,ec,eu);return D.extra.each(D=>{T.onSensor(E,D)}),D.coord}),ec,eu,D),eh=$F(ep,0,eu);Ft(M,eh)}T.onDrag(E,M,B)})(E,T,ec,D)})},mI=(E,T,D,B)=>{T.each(rI),D.snaps.each(T=>{((E,T)=>{let D=E.element;Et(D,T.leftAttr),Et(D,T.topAttr)})(E,T)});let M=D.getTarget(E.element);B.reset(),D.onDrop(E,M)},gI=E=>(T,D)=>{let n=E=>{D.setStartData(dI(T,E))};return Hr([Ur(oU(),E=>{D.getStartData().each(()=>n(E))}),...E(T,D,n)])};var vr=Object.freeze({__proto__:null,getData:E=>A.from(Gt(E.x,E.y)),getDelta:(E,T)=>Gt(T.left-E.left,T.top-E.top)});let hI=(E,T,D)=>[Ur(tZ(),(B,M)=>{if(0!==M.event.raw.button)return;M.stop();let r=()=>mI(B,A.some(eu),E,T),er=qS(r,200),ec={drop:r,delayDrop:er.schedule,forceDrop:r,move:D=>{er.cancel(),uI(B,E,T,vr,D)}},eu=aI(B,E.blockerClass,Hr([Ur(tZ(),ec.forceDrop),Ur(t1(),ec.drop),Ur(tQ(),(E,T)=>{ec.move(T.event)}),Ur(t0(),ec.delayDrop)]));D(B),sI(B,eu)})],va=[...vo,Ri("dragger",{handlers:gI(hI)})];var vl=Object.freeze({__proto__:null,getData:E=>{let T=E.raw.touches;return 1===T.length?(E=>{let T=E[0];return A.some(Gt(T.clientX,T.clientY))})(T):A.none()},getDelta:(E,T)=>Gt(T.left-E.left,T.top-E.top)});let vI=(E,T,D)=>{let B=Ql(),s=D=>{mI(D,B.get(),E,T),B.clear()};return[Ur(tX(),(M,er)=>{var ec;er.stop();let i=()=>s(M),eu=aI(M,E.blockerClass,(ec={drop:i,delayDrop:b,forceDrop:i,move:D=>{uI(M,E,T,vl,D)}},Hr([Ur(tX(),ec.forceDrop),Ur(tK(),ec.drop),Ur(tY(),ec.drop),Ur(tq(),(E,T)=>{ec.move(T.event)})])));B.set(eu),D(M),sI(M,eu)}),Ur(tq(),(D,B)=>{B.stop(),uI(D,E,T,vl,B.event)}),Ur(tK(),(E,T)=>{T.stop(),s(E)}),Ur(tY(),s)]},vc=[...vo,Ri("dragger",{handlers:gI(vI)})],vd=[...vo,Ri("dragger",{handlers:gI((E,T,D)=>[...hI(E,T,D),...vI(E,T,D)])})];var vu=Object.freeze({__proto__:null,mouse:va,touch:vc,mouseOrTouch:vd}),vg=Object.freeze({__proto__:null,init:()=>{let E=A.none(),T=A.none(),D=x({});return _a({readState:D,reset:()=>{E=A.none(),T=A.none()},update:(T,D)=>T.getData(D).bind(D=>((T,D)=>{let B=E.map(E=>T.getDelta(E,D));return E=A.some(D),B})(T,D)),getStartData:()=>T,setStartData:E=>{T=A.some(E)}})}});let vp=Tl({branchKey:"mode",branches:vu,name:"dragging",active:{events:(E,T)=>E.dragger.handlers(E,T)},extra:{snap:E=>({sensor:E.sensor,range:E.range,output:E.output,extra:A.from(E.extra)})},state:vg,apis:b6}),OI=(E,T,D,B,M,er)=>E.fold(()=>vp.snap({sensor:b9(D-20,B-20),range:Gt(M,er),output:b9(A.some(D),A.some(B)),extra:{td:T}}),E=>{let M=D-20,er=B-20,ec=E.element.dom.getBoundingClientRect();return vp.snap({sensor:b9(M,er),range:Gt(40,40),output:b9(A.some(D-ec.width/2),A.some(B-ec.height/2)),extra:{td:T}})}),_I=(E,T,D)=>({getSnapPoints:E,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:(E,B)=>{let M=B.td;T.get().exists(E=>Ze(E,M))||(T.set(M),D(M))},mustSnap:!0}),TI=E=>Gh(iG.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:kl([vp.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:E}),go.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}})),EI=(E,T)=>{let D=Es([]),B=Es([]),M=Es(!1),er=Ql(),ec=Ql(),i=E=>{let D=Zo(E);return OI(ep.getOpt(T),E,D.x,D.y,D.width,D.height)},l=E=>{let D=Zo(E);return OI(eh.getOpt(T),E,D.right,D.bottom,D.width,D.height)},eu=_I(()=>H(D.get(),E=>i(E)),er,T=>{ec.get().each(D=>{E.dispatch("TableSelectorChange",{start:T,finish:D})})}),eg=_I(()=>H(B.get(),E=>l(E)),ec,T=>{er.get().each(D=>{E.dispatch("TableSelectorChange",{start:D,finish:T})})}),ep=TI(eu),eh=TI(eg),ef=ri(ep.asSpec()),ex=ri(eh.asSpec()),h=(T,D,B,M)=>{let er=B(D);vp.snapTo(T,er),((T,D,B,er)=>{let ec=D.dom.getBoundingClientRect();Ht(T.element,"display");let eu=nt(Fe(E.getBody())).dom.innerHeight,eg=ec[M]<0,ep=ec[M]>eu;(eg||ep)&&Dt(T.element,"display","none")})(T,D)},f=E=>h(ef,E,i,"top"),b=E=>h(ex,E,l,"bottom");Do().deviceType.isTouch()&&(E.on("TableSelectionChange",E=>{M.get()||(Ad(T,ef),Ad(T,ex),M.set(!0)),er.set(E.start),ec.set(E.finish),E.otherCells.each(T=>{D.set(T.upOrLeftCells),B.set(T.downOrRightCells),f(E.start),b(E.finish)})}),E.on("ResizeEditor ResizeWindow ScrollContent",()=>{er.get().each(f),ec.get().each(b)}),E.on("TableSelectionClear",()=>{M.get()&&(Bd(ef),Bd(ex),M.set(!1)),er.clear(),ec.clear()}))},AI=(E,T,D)=>{var B;let M=null!==(B=T.delimiter)&&void 0!==B?B:"›";return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:kl([sQ.config({mode:"flow",selector:"div[role=button]"}),aq.config({disabled:D.isDisabled}),Sx(),mq.config({}),s1.config({}),Jp("elementPathEvents",[oZ((T,B)=>{E.shortcuts.add("alt+F11","focus statusbar elementpath",()=>sQ.focusIn(T)),E.on("NodeChange",B=>{let er=(T=>{var D;let B=[],M=T.length;for(;M-- >0;){let er=T[M];if(1===er.nodeType&&"BR"!==(D=er).nodeName&&!D.getAttribute("data-mce-bogus")&&"bookmark"!==D.getAttribute("data-mce-type")){let T=hw(E,er);if(T.isDefaultPrevented()||B.push({name:T.name,element:er}),T.isPropagationStopped())break}}return B})(B.parents),ec=er.length>0?j(er,(T,B,er)=>{var ec,eu;let eg=(ec=B.name,eu=B.element,iG.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{"data-index":er,"aria-level":er+1}},components:[ti(ec)],action:T=>{E.focus(),E.selection.select(eu),E.nodeChanged()},buttonBehaviours:kl([kx(D.isDisabled),Sx()])}));return 0===er?T.concat([eg]):T.concat([{dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0}},components:[ti(` ${M} `)]},eg])},[]):[];s1.set(T,ec)})})])]),components:[]}};(ty=tS||(tS={}))[ty.None=0]="None",ty[ty.Both=1]="Both",ty[ty.Vertical=2]="Vertical";let DI=(E,T,D)=>{let B=Fe(E.getContainer()),M=((E,T,D,B,M)=>{let er={height:VB(B+T.top,cc(E),ch(E))};return D===tS.Both&&(er.width=VB(M+T.left,ca(E),cg(E))),er})(E,T,D,Wt(B),Jt(B));le(M,(E,T)=>{eg(E)&&Dt(B,T,NB(E))}),(E=>{E.dispatch("ResizeEditor")})(E)},BI=(E,T,D,B)=>{let M=Gt(20*D,20*B);return DI(E,M,T),A.some(!0)},FI=(E,T)=>{let o=()=>{let D=[],B=c1(E),M=cq(E),er=cK(E)||E.hasPlugin("wordcount");return M&&D.push(AI(E,{},T)),B&&D.push((()=>{let E=Ix("Alt+0");return{dom:{tag:"div",classes:["tox-statusbar__help-text"]},components:[ti(lQ.translate(["Press {0} for help",E]))]}})()),er&&D.push((()=>{let D=[];return E.hasPlugin("wordcount")&&D.push(((E,T)=>{let o=(E,D,B)=>s1.set(E,[ti(T.translate(["{0} "+B,D[B]]))]);return iG.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:kl([kx(T.isDisabled),Sx(),mq.config({}),s1.config({}),r6.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),Jp("wordcount-events",[o1(E=>{let T=r6.getValue(E),D="words"===T.mode?"characters":"words";r6.setValue(E,{mode:D,count:T.count}),o(E,T.count,D)}),oZ(T=>{E.on("wordCountUpdate",E=>{let{mode:D}=r6.getValue(T);r6.setValue(T,{mode:D,count:E.wordCount}),o(T,E.wordCount,D)})})])]),eventOrder:{[oS()]:["disabling","alloy.base.behaviour","wordcount-events"]}})})(E,T)),cK(E)&&D.push({dom:{tag:"span",classes:["tox-statusbar__branding"]},components:[{dom:{tag:"a",attributes:{href:"https://www.tiny.cloud/powered-by-tiny?utm_campaign=editor_referral&utm_medium=poweredby&utm_source=tinymce&utm_content=v6",rel:"noopener",target:"_blank","aria-label":lQ.translate(["Powered by {0}","Tiny"])},innerHtml:'<svg width="50px" height="16px" viewBox="0 0 50 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.143 0c2.608.015 5.186 2.178 5.186 5.331 0 0 .077 3.812-.084 4.87-.361 2.41-2.164 4.074-4.65 4.496-1.453.284-2.523.49-3.212.623-.373.071-.634.122-.785.152-.184.038-.997.145-1.35.145-2.732 0-5.21-2.04-5.248-5.33 0 0 0-3.514.03-4.442.093-2.4 1.758-4.342 4.926-4.963 0 0 3.875-.752 4.036-.782.368-.07.775-.1 1.15-.1Zm1.826 2.8L5.83 3.989v2.393l-2.455.475v5.968l6.137-1.189V9.243l2.456-.476V2.8ZM5.83 6.382l3.682-.713v3.574l-3.682.713V6.382Zm27.173-1.64-.084-1.066h-2.226v9.132h2.456V7.743c-.008-1.151.998-2.064 2.149-2.072 1.15-.008 1.987.92 1.995 2.072v5.065h2.455V7.359c-.015-2.18-1.657-3.929-3.837-3.913a3.993 3.993 0 0 0-2.908 1.296Zm-6.3-4.266L29.16 0v2.387l-2.456.475V.476Zm0 3.2v9.132h2.456V3.676h-2.456Zm18.179 11.787L49.11 3.676H46.58l-1.612 4.527-.46 1.382-.384-1.382-1.611-4.527H39.98l3.3 9.132L42.15 16l2.732-.537ZM22.867 9.738c0 .752.568 1.075.921 1.075.353 0 .668-.047.998-.154l.537 1.765c-.23.154-.92.537-2.225.537-1.305 0-2.655-.997-2.686-2.686a136.877 136.877 0 0 1 0-4.374H18.8V3.676h1.612v-1.98l2.455-.476v2.456h2.302V5.9h-2.302v3.837Z"/>\n</svg>\n'.trim()},behaviours:kl([s9.config({})])}]}),{dom:{tag:"div",classes:["tox-statusbar__right-container"]},components:D}})()),D.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container",...(()=>{let E="tox-statusbar__text-container--flex-start",T="tox-statusbar__text-container--flex-end";if(B){let D="tox-statusbar__text-container-3-cols";return er||M?er&&!M?[D,T]:[D,E]:[D,"tox-statusbar__text-container--space-around"]}return[er&&!M?T:E]})()]},components:D}]:[]};return{dom:{tag:"div",classes:["tox-statusbar"]},components:(()=>{let D=o(),B=((E,T)=>{let D=(E=>{let T=cY(E);return!1===T?tS.None:"both"===T?tS.Both:tS.Vertical})(E);if(D===tS.None)return A.none();let B=D===tS.Both?"Press the arrow keys to resize the editor.":"Press the Up and Down arrow keys to resize the editor.";return A.some(tb("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:T.translate("Resize"),"aria-label":T.translate(B)},behaviours:[vp.config({mode:"mouse",repositionTarget:!1,onDrag:(T,B,M)=>DI(E,M,D),blockerClass:"tox-blocker"}),sQ.config({mode:"special",onLeft:()=>BI(E,D,-1,0),onRight:()=>BI(E,D,1,0),onUp:()=>BI(E,D,0,-1),onDown:()=>BI(E,D,0,1)}),mq.config({}),s9.config({})]},T.icons))})(E,T);return D.concat(B.toArray())})()}},II=(E,T)=>T.get().getOrDie(`UI for ${E} has not been rendered`),RI=(E,T)=>{let D=E.inline,B=D?bG:bL,M=iv(E)?h2:hj,er=(()=>{let E=Ql(),T=Ql(),D=Ql();return{dialogUi:E,popupUi:T,mainUi:D,getUiMotherships:()=>{let D=E.get().map(E=>E.mothership),B=T.get().map(E=>E.mothership);return D.fold(()=>B.toArray(),E=>B.fold(()=>[E],T=>Ze(E.element,T.element)?[E]:[E,T]))},lazyGetInOuterOrDie:(E,T)=>()=>D.get().bind(E=>T(E.outerContainer)).getOrDie(`Could not find ${E} element in OuterContainer`)}})(),ec=Ql(),eu=Ql(),eg=Ql(),ep=Do().deviceType.isTouch()?["tox-platform-touch"]:[],eh=ov(E),ef=cS(E),ex=Gh({dom:{tag:"div",classes:["tox-anchorbar"]}}),ew=Gh({dom:{tag:"div",classes:["tox-bottom-anchorbar"]}}),p=()=>er.mainUi.get().map(E=>E.outerContainer).bind(f4.getHeader),e_=er.lazyGetInOuterOrDie("anchor bar",ex.getOpt),eH=er.lazyGetInOuterOrDie("bottom anchor bar",ew.getOpt),eR=er.lazyGetInOuterOrDie("toolbar",f4.getToolbar),eN=er.lazyGetInOuterOrDie("throbber",f4.getThrobber),eU=((E,T,D,B)=>{let M=Es(!1),er=(E=>{let T=Es(ov(E)?"bottom":"top");return{isPositionedAtTop:()=>"top"===T.get(),getDockingMode:T.get,setDockingMode:T.set}})(T),ec={icons:()=>T.ui.registry.getAll().icons,menuItems:()=>T.ui.registry.getAll().menuItems,translate:lQ.translate,isDisabled:()=>T.mode.isReadOnly()||!T.ui.isEnabled(),getOption:T.options.get},eu=rA(T),eg=(E=>{let t=T=>()=>E.formatter.match(T),o=T=>()=>{let D=E.formatter.get(T);return void 0!==D?A.some({tag:D.length>0&&(D[0].inline||D[0].block)||"div",styles:E.dom.parseStyle(E.formatter.getCssText(T))}):A.none()},T=Es([]),D=Es([]),B=Es(!1);return E.on("PreInit",D=>{let B=BE(E),M=IE(E,B,t,o);T.set(M)}),E.on("addStyleModifications",T=>{let M=IE(E,T.items,t,o);D.set(M),B.set(T.replace)}),{getData:()=>{let E=B.get()?[]:T.get(),M=D.get();return E.concat(M)}}})(T),ep={colorPicker:kE(T),hasCustomColors:CE(T),getColors:OE(T),getColorCols:_E(T)},eh={isDraggableModal:TE(T)},ef={shared:{providers:ec,anchors:SE(T,D,B,er.isPositionedAtTop),header:er},urlinput:eu,styles:eg,colorinput:ep,dialog:eh,isContextMenuOpen:()=>M.get(),setContextMenuState:E=>M.set(E)},ex={...ef,shared:{...ef.shared,interpreter:E=>KT(E,{},ex),getSink:E.popup}},ew={...ef,shared:{...ef.shared,interpreter:E=>KT(E,{},ew),getSink:E.dialog}};return{popup:ex,dialog:ew}})({popup:()=>tH.fromOption(er.popupUi.get().map(E=>E.sink),"(popup) UI has not been rendered"),dialog:()=>tH.fromOption(er.dialogUi.get().map(E=>E.sink),"UI has not been rendered")},E,e_,eH),x=()=>{let T=(()=>{let T={attributes:{[ra]:eh?i4.BottomToTop:i4.TopToBottom}},D=f4.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:eU.popup,onEscape:()=>{E.focus()}}),B=f4.parts.toolbar({dom:{tag:"div",classes:["tox-toolbar"]},getSink:eU.popup.shared.getSink,providers:eU.popup.shared.providers,onEscape:()=>{E.focus()},onToolbarToggled:T=>{((E,T)=>{E.dispatch("ToggleToolbarDrawer",{state:T})})(E,T)},type:ef,lazyToolbar:eR,lazyHeader:()=>p().getOrDie("Could not find header element"),...T}),M=f4.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:eU.popup.shared.providers,onEscape:()=>{E.focus()},type:ef}),er=tv(E),ec=Qb(E),eu=Kb(E),eg=c0(E),ep=f4.parts.promotion({dom:{tag:"div",classes:["tox-promotion"]}}),ew=er||ec||eu,e_=eg?[ep,D]:[D];return f4.parts.header({dom:{tag:"div",classes:["tox-editor-header"].concat(ew?[]:["tox-editor-header--empty"]),...T},components:q([eu?e_:[],er?[M]:ec?[B]:[],sv(E)?[]:[ex.asSpec()]]),sticky:iv(E),editor:E,sharedBackstage:eU.popup.shared})})(),B={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[f4.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),f4.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}})]},M=f4.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:eU.popup}),er=f4.parts.viewWrapper({backstage:eU.popup}),eu=cX(E)&&!D?A.some(FI(E,eU.popup.shared.providers)):A.none(),eg=q([eh?[]:[T],D?[]:[B],eh?[T]:[]]),e_=f4.parts.editorContainer({components:q([eg,D?[]:[ew.asSpec(),...eu.toArray()]])}),eD=av(E),eH={role:"application",...lQ.isRtl()?{dir:"rtl"}:{},...eD?{"aria-hidden":"true"}:{}},eN=ri(f4.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(D?["tox-tinymce-inline"]:[]).concat(eh?["tox-tinymce--toolbar-bottom"]:[]).concat(ep),styles:{visibility:"hidden",...eD?{opacity:"0",border:"0"}:{}},attributes:eH},components:[e_,...D?[]:[er],M],behaviours:kl([Sx(),aq.config({disableClass:"tox-tinymce--disabled"}),sQ.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])})),eL=nk(eN);return ec.set(eL),{mothership:eL,outerContainer:eN}},w=T=>{let D=NB((E=>{let T=(E=>{let T=co(E),D=cc(E),B=ch(E);return RB(T).map(E=>VB(E,D,B))})(E);return T.getOr(co(E))})(E)),B=NB(zB(E).getOr(cr(E)));return E.inline||(zt("div","width",B)&&Dt(T.element,"width",B),zt("div","height",D)?Dt(T.element,"height",D):Dt(T.element,"height","400px")),D};return{popups:{backstage:eU.popup,getMothership:()=>II("popups",eg)},dialogs:{backstage:eU.dialog,getMothership:()=>II("dialogs",eu)},renderUI:()=>{let D=x(),ec=(()=>{let T=rv(E),D=Ze(xt(),T)&&"grid"===It(T,"display"),B={dom:{tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(ep),attributes:{...lQ.isRtl()?{dir:"rtl"}:{}}},behaviours:kl([rW.config({useFixed:()=>M.isDocked(p)})])},er={dom:{styles:{width:document.body.clientWidth+"px"}},events:Hr([Ur(oL(),E=>{Dt(E.element,"width",document.body.clientWidth+"px")})])},ec=ri(tR(B,D?er:{})),eg=nk(ec);return eu.set(eg),{sink:ec,mothership:eg}})(),eh=lv(E)?(()=>{let E={dom:{tag:"div",classes:["tox","tox-silver-sink","tox-silver-popup-sink","tox-tinymce-aux"].concat(ep),attributes:{...lQ.isRtl()?{dir:"rtl"}:{}}},behaviours:kl([rW.config({useFixed:()=>M.isDocked(p),getBounds:()=>T.getPopupSinkBounds()})])},D=ri(E),B=nk(D);return eg.set(B),{sink:D,mothership:B}})():(eg.set(ec.mothership),ec);return er.dialogUi.set(ec),er.popupUi.set(eh),er.mainUi.set(D),(T=>{var D;let{mainUi:er,popupUi:ec,uiMotherships:eu}=T;ce(c_(E),(T,D)=>{E.ui.registry.addGroupToolbarButton(D,T)});let{buttons:eg,menuItems:ep,contextToolbars:eh,sidebars:ex,views:ew}=E.ui.registry.getAll(),e_=ev(E),eH={menuItems:ep,menus:cv(E),menubar:cN(E),toolbar:e_.getOrThunk(()=>cU(E)),allowToolbarGroups:ef===l5.floating,buttons:eg,sidebar:ex,views:ew};D=er.outerContainer,E.addShortcut("alt+F9","focus menubar",()=>{f4.focusMenubar(D)}),E.addShortcut("alt+F10","focus toolbar",()=>{f4.focusToolbar(D)}),E.addCommand("ToggleToolbarDrawer",(E,T)=>{(null==T?void 0:T.skipFocus)?f4.toggleToolbarDrawerWithoutFocusing(D):f4.toggleToolbarDrawer(D)}),E.addQueryStateHandler("ToggleToolbarDrawer",()=>f4.isToolbarDrawerToggled(D)),((E,T,D)=>{let n=(E,B)=>{L([T,...D],T=>{T.broadcastEvent(E,B)})},s=(E,B)=>{L([T,...D],T=>{T.broadcastOn([E],B)})},r=E=>s(rK(),{target:E.target}),B=$o(),M=tc(B,"touchstart",r),er=tc(B,"touchmove",E=>n(oR(),E)),ec=tc(B,"touchend",E=>n(oN(),E)),eu=tc(B,"mousedown",r),eg=tc(B,"mouseup",E=>{0===E.raw.button&&s(rZ(),{target:E.target})}),m=E=>s(rK(),{target:Fe(E.target)}),g=E=>{0===E.button&&s(rZ(),{target:Fe(E.target)})},p=()=>{L(E.editorManager.get(),T=>{E!==T&&T.dispatch("DismissPopups",{relatedTarget:E})})},h=E=>n(oU(),Bo(E)),f=E=>{s(rY(),{}),n(oL(),Bo(E))},ep=eJ(Fe(E.getElement())),eh=oc(ep,"scroll",D=>{requestAnimationFrame(()=>{if(null!=E.getContainer()){let B=jS(E,T.element).map(E=>[E.element,...E.others]).getOr([]);N(B,E=>Ze(E,D.target))&&(E.dispatch("ElementScroll",{target:D.target.dom}),n(o$(),D))}})}),y=()=>s(rY(),{}),x=T=>{T.state&&s(rK(),{target:Fe(E.getContainer())})},w=E=>{s(rK(),{target:Fe(E.relatedTarget.getContainer())})};E.on("PostRender",()=>{E.on("click",m),E.on("tap",m),E.on("mouseup",g),E.on("mousedown",p),E.on("ScrollWindow",h),E.on("ResizeWindow",f),E.on("ResizeEditor",y),E.on("AfterProgressState",x),E.on("DismissPopups",w)}),E.on("remove",()=>{E.off("click",m),E.off("tap",m),E.off("mouseup",g),E.off("mousedown",p),E.off("ScrollWindow",h),E.off("ResizeWindow",f),E.off("ResizeEditor",y),E.off("AfterProgressState",x),E.off("DismissPopups",w),eu.unbind(),M.unbind(),er.unbind(),ec.unbind(),eg.unbind(),eh.unbind()}),E.on("detach",()=>{L([T,...D],Vd),L([T,...D],E=>E.destroy())})})(E,er.mothership,eu),M.setup(E,eU.popup.shared,p),bF(E,eU.popup),zF(E,eU.popup.shared.getSink,eU.popup),(E=>{let{sidebars:T}=E.ui.registry.getAll();L(eD(T),D=>{let B=T[D],s=()=>xe(A.from(E.queryCommandValue("ToggleSidebar")),D);E.ui.registry.addToggleButton(D,{icon:B.icon,tooltip:B.tooltip,onAction:T=>{E.execCommand("ToggleSidebar",!1,D),T.setActive(s())},onSetup:T=>{T.setActive(s());let o=()=>T.setActive(s());return E.on("ToggleSidebar",o),()=>{E.off("ToggleSidebar",o)}}})})})(E),TM(E,eN,eU.popup.shared),lF(E,eh,ec.sink,{backstage:eU.popup}),EI(E,ec.sink);let eR={targetNode:E.getElement(),height:w(er.outerContainer)};return B.render(E,T,eH,eU.popup,eR)})({popupUi:eh,dialogUi:ec,mainUi:D,uiMotherships:er.getUiMotherships()})}}},vh=x([os("lazySink"),us("dragBlockClass"),Os("getBounds",en),ys("useTabstopAt",eh),ys("firstTabstop",0),ys("eventOrder",{}),hu("modalBehaviours",[sQ]),Bi("onExecute"),Ii("onEscape")]),vf={sketch:w},vb=x([aB({name:"draghandle",overrides:(E,T)=>({behaviours:kl([vp.config({mode:"mouse",getTarget:E=>mi(E,'[role="dialog"]').getOr(E),blockerClass:E.dragBlockClass.getOrDie(Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(T,null,2)).message),getBounds:E.getDragBounds})])})}),aT({schema:[os("dom")],name:"title"}),aT({factory:vf,schema:[os("dom")],name:"close"}),aT({factory:vf,schema:[os("dom")],name:"body"}),aB({factory:vf,schema:[os("dom")],name:"footer"}),aF({factory:{sketch:(E,T)=>({...E,dom:T.dom,components:T.components})},schema:[ys("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),ys("components",[])],name:"blocker"})]),vv=bm({name:"ModalDialog",configFields:vh(),partFields:vb(),factory:(E,T,D,B)=>{let M=Ql(),er=la("modal-events"),ec={...E.eventOrder,[oz()]:[er].concat(E.eventOrder["alloy.system.attached"]||[])};return{uid:E.uid,dom:E.dom,components:T,apis:{show:T=>{M.set(T);let D=E.lazySink(T).getOrDie(),er=B.blocker(),ec=D.getSystem().build({...er,components:er.components.concat([Sa(T)]),behaviours:kl([s9.config({}),Jp("dialog-blocker-events",[Yr(t3(),()=>{fb.isBlocked(T)||sQ.focusIn(T)})])])});Ad(D,ec),sQ.focusIn(T)},hide:E=>{M.clear(),st(E.element).each(T=>{E.getSystem().getByDom(T).each(E=>{Bd(E)})})},getBody:T=>nm(T,E,"body"),getFooter:T=>om(T,E,"footer"),setIdle:E=>{fb.unblock(E)},setBusy:(E,T)=>{fb.block(E,T)}},eventOrder:ec,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:bu(E.modalBehaviours,[s1.config({}),sQ.config({mode:"cyclic",onEnter:E.onExecute,onEscape:E.onEscape,useTabstopAt:E.useTabstopAt,firstTabstop:E.firstTabstop}),fb.config({getRoot:M.get}),Jp(er,[oZ(T=>{((E,T)=>{let D=_t(E,"id").fold(()=>{let E=la("dialog-label");return kt(T,"id",E),E},w);kt(E,"aria-labelledby",D)})(T.element,nm(T,E,"title").element)})])])}},apis:{show:(E,T)=>{E.show(T)},hide:(E,T)=>{E.hide(T)},getBody:(E,T)=>E.getBody(T),getFooter:(E,T)=>E.getFooter(T),setBusy:(E,T,D)=>{E.setBusy(T,D)},setIdle:(E,T)=>{E.setIdle(T)}}}),vx=Dn([dO,d_].concat(uT)),vy=[Ey("button"),dJ,ks("align","end",["start","end"]),d0,dQ,hs("buttonType",["primary","secondary"])],vA=[...vy,dM],vk=[as("type",["submit","cancel","custom"]),...vA],vS=[as("type",["menu"]),dj,d$,dJ,ds("items",vx),...vy],vO=[...vy,as("type",["togglebutton"]),rs("tooltip"),dJ,dj,Cs("active",!1)],v_=Jn("type",{submit:vk,cancel:vk,custom:vk,menu:vS,togglebutton:vO}),vH=[dO,dM,as("level",["info","warn","error","success"]),dR,ys("url","")],vR=Dn(vH),vV=[dO,dM,dQ,Ey("button"),dJ,dZ,hs("buttonType",["primary","secondary","toolbar"]),d0],vU=Dn(vV),vL=[dO,d_],vz=vL.concat([dX]),vP=vL.concat([dD,dQ]),vG=Dn(vP),vW=vz.concat([Cy("auto")]),vj=Dn(vW),vJ=tL([dN,dM,dR]),v$=vz.concat([Ss("storageKey","default")]),vX=Dn(v$),vq=Dn(vz),vK=vL.concat([Ss("tag","textarea"),rs("scriptId"),rs("scriptUrl"),xs("settings",void 0,tJ)]),vY=vL.concat([Ss("tag","textarea"),is("init")]),vZ=Gn(E=>qn("customeditor.old",Mn(vY),E).orThunk(()=>qn("customeditor.new",Mn(vK),E))),vQ=Dn(vz),v0=Bn(tU),bR=E=>[dO,ss("columns"),E],v1=[dO,rs("html"),ks("presets","presentation",["presentation","document"])],v2=Dn(v1),v3=vz.concat([Cs("border",!1),Cs("sandboxed",!0),Cs("streamContent",!1),Cs("transparent",!0)]),v5=Dn(v3),v9=Dn(vL.concat([ps("height")])),v4=Dn([rs("url"),gs("zoom"),gs("cachedWidth"),gs("cachedHeight")]),v6=vz.concat([ps("inputMode"),ps("placeholder"),Cs("maximized",!1),dQ]),v8=Dn(v6),ER=E=>[dO,dD,E,ks("align","start",["start","center","end"])],v7=[dM,dN],xo=[dM,ds("items",Zn(0,()=>xr))],xr=Fn([Dn(v7),Dn(xo)]),xi=vz.concat([ds("items",xr),dQ]),xu=Dn(xi),xm=vz.concat([cs("items",[dM,dN]),ws("size",1),dQ]),xp=Dn(xm),xh=vz.concat([Cs("constrain",!0),dQ]),xb=Dn(xh),xv=Dn([rs("width"),rs("height")]),xy=vL.concat([dD,ws("min",0),ws("max",0)]),xk=Dn(xy),xO=[dO,ds("header",tG),ds("cells",Bn(tG))],xT=Dn(xO),xF=vz.concat([ps("placeholder"),Cs("maximized",!1),dQ]),xB=Dn(xF),xI=[as("type",["directory","leaf"]),dH,rs("id"),ms("menu",h9)],xH=Dn(xI),xR=xI.concat([ds("children",Zn(0,()=>jn("type",{directory:xU,leaf:xH})))]),xU=Dn(xR),xL=jn("type",{directory:xU,leaf:xH}),xz=[dO,ds("items",xL),fs("onLeafAction"),fs("onToggleExpand"),_s("defaultExpandedIds",[],tG),ps("defaultSelectedId")],xP=Dn(xz),xG=vz.concat([ks("filetype","file",["image","media","file"]),dQ]),xW=Dn(xG),xj=Dn([dN,d1]),rN=E=>gn("items","items",{tag:"required",process:{}},Bn(Gn(T=>qn(`Checking item of ${E}`,xJ,T).fold(E=>tH.error(Kn(E)),E=>tH.value(E))))),xJ=En(()=>jn("type",{alertbanner:vR,bar:Dn([dO,rN("bar")]),button:vU,checkbox:vG,colorinput:vX,colorpicker:vq,dropzone:vQ,grid:Dn(bR(rN("grid"))),iframe:v5,input:v8,listbox:xu,selectbox:xp,sizeinput:xb,slider:xk,textarea:xB,urlinput:xW,customeditor:vZ,htmlpanel:v2,imagepreview:v9,collection:vj,label:Dn(ER(rN("label"))),table:xT,tree:xP,panel:xX})),x$=[dO,ys("classes",[]),ds("items",xJ)],xX=Dn(x$),xq=[Ey("tab"),dH,ds("items",xJ)],xK=[dO,cs("tabs",xq)],xY=Dn(xK),xZ=Dn([rs("title"),ns("body",jn("type",{panel:xX,tabpanel:xY})),Ss("size","normal"),_s("buttons",[],v_),ys("initialData",{}),Os("onAction",b),Os("onChange",b),Os("onSubmit",b),Os("onClose",b),Os("onCancel",b),Os("onTabChange",b)]),xQ=Dn([as("type",["cancel","custom"]),...vA]),x0=Dn([rs("title"),rs("url"),gs("height"),gs("width"),bs("buttons",xQ),Os("onAction",b),Os("onCancel",b),Os("onClose",b),Os("onMessage",b)]),bN=E=>D(E)?[E].concat(X(fe(E),bN)):B(E)?X(E,bN):[],vN=E=>T(E.type)&&T(E.name),x1={checkbox:tW,colorinput:tG,colorpicker:tG,dropzone:v0,input:tG,iframe:tG,imagepreview:v4,selectbox:tG,sizeinput:xv,slider:tP,listbox:tG,size:xv,textarea:tG,urlinput:xj,customeditor:tG,collection:vJ,togglemenuitem:tW},xN=E=>{let T=U(bN(E),vN),D=X(T,E=>A.from(x1[E.type]).fold(()=>[],T=>[ns(E.name,T)]));return Dn(D)},wN=E=>{var T;return{internalDialog:Xn(qn("dialog",xZ,E)),dataValidator:xN(E),initialData:null!==(T=E.initialData)&&void 0!==T?T:{}}},x2={open:(E,T)=>{let D=wN(T);return E(D.internalDialog,D.initialData,D.dataValidator)},openUrl:(E,T)=>E(Xn(qn("dialog",x0,T))),redial:E=>wN(E)};var x3=Object.freeze({__proto__:null,events:(E,T)=>{let o=(D,B)=>{E.updateState.each(E=>{let M=E(D,B);T.set(M)}),E.renderComponents.each(M=>{let er=M(B,T.get());(E.reuseDom?Wp:Up)(D,er)})};return Hr([Ur(ok(),(T,D)=>{if(!D.universal){let B=E.channel;R(D.channels,B)&&o(T,D.data)}}),oZ((T,D)=>{E.initialData.each(E=>{o(T,E)})})])}}),x5=Object.freeze({__proto__:null,getState:(E,T,D)=>D}),x9=[os("channel"),us("renderComponents"),us("updateState"),us("initialData"),Cs("reuseDom",!0)];let x4=Ol({fields:x9,name:"reflecting",active:x3,apis:x5,state:Object.freeze({__proto__:null,init:()=>{let E=Es(A.none());return{readState:()=>E.get().getOr("none"),get:E.get,set:E.set,clear:()=>E.set(A.none())}}})}),TN=E=>{let T=[],D={};return le(E,(E,B)=>{E.fold(()=>{T.push(B)},E=>{D[B]=E})}),T.length>0?tH.error(T):tH.value(D)},EN=(E,T,D)=>{let B=Gh(g8.sketch(B=>({dom:{tag:"div",classes:["tox-form"].concat(E.classes)},components:H(E.items,E=>XT(B,E,T,D))})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[B.asSpec()]}],behaviours:kl([sQ.config({mode:"acyclic",useTabstopAt:C(XO)}),aW.config({find:B.getOpt}),IO(B,{postprocess:E=>TN(E).fold(E=>(console.error(E),{}),w)}),Jp("dialog-body-panel",[Ur(t3(),(E,T)=>{E.getSystem().broadcastOn([pT],{newFocus:A.some(T.event.target)})})])])}},x6=fm({name:"TabButton",configFields:[ys("uid",void 0),os("value"),gn("dom","dom",xn(()=>({attributes:{role:"tab",id:la("aria"),"aria-selected":"false"}})),tz()),us("action"),ys("domModification",{}),hu("tabButtonBehaviours",[s9,sQ,r6]),os("view")],factory:(E,T)=>({uid:E.uid,dom:E.dom,components:E.components,events:mh(E.action),behaviours:bu(E.tabButtonBehaviours,[s9.config({}),sQ.config({mode:"execution",useSpace:!0,useEnter:!0}),r6.config({store:{mode:"memory",initialValue:E.value}})]),domModification:E.domModification})}),x8=x([os("tabs"),os("dom"),ys("clickToDismiss",!1),hu("tabbarBehaviours",[aZ,sQ]),Ai(["tabClass","selectedClass"])]),x7=aH({factory:x6,name:"tabs",unit:"tab",overrides:E=>{let t=(E,T)=>{aZ.dehighlight(E,T),Ir(E,oq(),{tabbar:E,button:T})},o=(E,T)=>{aZ.highlight(E,T),Ir(E,oX(),{tabbar:E,button:T})};return{action:T=>{let D=T.getSystem().getByUid(E.uid).getOrDie(),B=aZ.isHighlighted(D,T);(B&&E.clickToDismiss?t:B?b:o)(D,T)},domModification:{classes:[E.markers.tabClass]}}}}),yo=x([x7]),yr=bm({name:"Tabbar",configFields:x8(),partFields:yo(),factory:(E,T,D,B)=>({uid:E.uid,dom:E.dom,components:T,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:bu(E.tabbarBehaviours,[aZ.config({highlightClass:E.markers.selectedClass,itemClass:E.markers.tabClass,onHighlight:(E,T)=>{kt(T.element,"aria-selected","true")},onDehighlight:(E,T)=>{kt(T.element,"aria-selected","false")}}),sQ.config({mode:"flow",getInitial:E=>aZ.getHighlighted(E).map(E=>E.element),selector:"."+E.markers.tabClass,executeOnMove:!0})])})}),yi=fm({name:"Tabview",configFields:[hu("tabviewBehaviours",[s1])],factory:(E,T)=>({uid:E.uid,dom:E.dom,behaviours:bu(E.tabviewBehaviours,[s1.config({})]),domModification:{attributes:{role:"tabpanel"}}})}),yl=x([ys("selectFirst",!0),Di("onChangeTab"),Di("onDismissTab"),ys("tabs",[]),hu("tabSectionBehaviours",[])]),yc=aT({factory:yr,schema:[os("dom"),ls("markers",[os("tabClass"),os("selectedClass")])],name:"tabbar",defaults:E=>({tabs:E.tabs})}),yd=aT({factory:yi,name:"tabview"}),yu=x([yc,yd]),ym=bm({name:"TabSection",configFields:yl(),partFields:yu(),factory:(E,T,D,B)=>{let s=(T,D)=>{om(T,E,"tabbar").each(E=>{D(E).each(Rr)})};return{uid:E.uid,dom:E.dom,components:T,behaviours:fu(E.tabSectionBehaviours),events:Hr(q([E.selectFirst?[oZ((E,T)=>{s(E,aZ.getFirst)})]:[],[Ur(oX(),(T,D)=>{(T=>{let D=r6.getValue(T);om(T,E,"tabview").each(B=>{G(E.tabs,E=>E.value===D).each(D=>{let M=D.view();_t(T.element,"id").each(E=>{kt(B.element,"aria-labelledby",E)}),s1.set(B,M),E.onChangeTab(B,T,M)})})})(D.event.button)}),Ur(oq(),(T,D)=>{let B=D.event.button;E.onDismissTab(T,B)})]])),apis:{getViewItems:T=>om(T,E,"tabview").map(E=>s1.contents(E)).getOr([]),showTab:(E,T)=>{s(E,E=>{let D=aZ.getCandidates(E);return G(D,E=>r6.getValue(E)===T).filter(T=>!aZ.isHighlighted(E,T))})}}}},apis:{getViewItems:(E,T)=>E.getViewItems(T),showTab:(E,T,D)=>{E.showTab(T,D)}}}),LN=(E,T)=>{Dt(E,"height",T+"px"),Dt(E,"flex-basis",T+"px")},PN=(E,T,D)=>{mi(E,'[role="dialog"]').each(E=>{pi(E,'[role="tablist"]').each(B=>{D.get().map(D=>(Dt(T,"height","0"),Dt(T,"flex-basis","0"),Math.min(D,((E,T,D)=>{let B;let M=ot(E).dom,er=mi(E,".tox-dialog-wrap").getOr(E);B="fixed"===It(er,"position")?Math.max(M.clientHeight,window.innerHeight):Math.max(M.offsetHeight,M.scrollHeight);let ec=Wt(T),eu=T.dom.offsetLeft>=D.dom.offsetLeft+Jt(D)?Math.max(Wt(D),ec):ec,eg=parseInt(It(E,"margin-top"),10)||0,ep=parseInt(It(E,"margin-bottom"),10)||0;return B-(Wt(E)+eg+ep-eu)})(E,T,B)))).each(E=>{LN(T,E)})})})},UN=E=>pi(E,'[role="tabpanel"]'),yp="send-data-to-section",yh="send-data-to-view",GN=(E,T,D)=>{let B=Es({}),s=E=>{let T=r6.getValue(E),D=TN(T).getOr({}),M=B.get(),er=tR(M,D);B.set(er)},r=E=>{let T=B.get();r6.setValue(E,T)},M=Es(null),er=H(E.tabs,E=>({value:E.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"]},components:[ti(D.shared.providers.translate(E.title))],view:()=>[g8.sketch(B=>({dom:{tag:"div",classes:["tox-form"]},components:H(E.items,E=>XT(B,E,T,D)),formBehaviours:kl([sQ.config({mode:"acyclic",useTabstopAt:C(XO)}),Jp("TabView.form.events",[oZ(r),oQ(s)]),nQ.config({channels:Ds([{key:yp,value:{onReceive:s}},{key:yh,value:{onReceive:r}}])})])}))]})),ec=(E=>{let T=Ql(),D=[oZ(D=>{let B=D.element;UN(B).each(M=>{Dt(M,"visibility","hidden"),D.getSystem().getByDom(M).toOptional().each(D=>{let B=H(E,(T,B)=>{s1.set(D,E[B].view());let er=M.dom.getBoundingClientRect();return s1.set(D,[]),er.height}),er=oe(ee(B,(E,T)=>E>T?-1:E<T?1:0));er.fold(T.clear,T.set)}),PN(B,M,T),Ht(M,"visibility"),((E,T)=>{oe(E).each(E=>ym.showTab(T,E.value))})(E,D),requestAnimationFrame(()=>{PN(B,M,T)})})}),Ur(oL(),E=>{let D=E.element;UN(D).each(E=>{PN(D,E,T)})}),Ur(m9,(E,D)=>{let B=E.element;UN(B).each(E=>{let D=Il(eJ(E));Dt(E,"visibility","hidden");let M=Nt(E,"height").map(E=>parseInt(E,10));Ht(E,"height"),Ht(E,"flex-basis");let er=E.dom.getBoundingClientRect().height;M.forall(E=>er>E)?(T.set(er),PN(B,E,T)):M.each(T=>{LN(E,T)}),Ht(E,"visibility"),D.each(Dl)})})];return{extraEvents:D,selectFirst:!1}})(er);return ym.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:(E,T,D)=>{let B=r6.getValue(T);Ir(E,m5,{name:B,oldName:M.get()}),M.set(B)},tabs:er,components:[ym.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[yr.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:kl([mq.config({})])}),ym.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:ec.selectFirst,tabSectionBehaviours:kl([Jp("tabpanel",ec.extraEvents),sQ.config({mode:"acyclic"}),aW.config({find:E=>oe(ym.getViewItems(E))}),RO(A.none(),E=>(E.getSystem().broadcastOn([yp],{}),B.get()),(E,T)=>{B.set(T),E.getSystem().broadcastOn([yh],{})})])})},$N=(E,T,D,B,M)=>({dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:{...D.map(E=>({id:E})).getOr({}),...M?{"aria-live":"polite"}:{}}},components:[],behaviours:kl([BO(0),x4.config({channel:`${py}-${T}`,updateState:(E,T)=>A.some({isTabPanel:()=>"tabpanel"===T.body.type}),renderComponents:E=>{let T=E.body;return"tabpanel"===T.type?[GN(T,E.initialData,B)]:[EN(T,E.initialData,B)]},initialData:E})])}),yf=l8.deviceType.isTouch(),XN=(E,T)=>({dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[E,T]}),YN=(E,T)=>vv.parts.close(iG.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":T.translate("Close")}},action:E,buttonBehaviours:kl([mq.config({})])})),KN=()=>vv.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}}),JN=(E,T)=>vv.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:jh(`<p>${Gf(T.translate(E))}</p>`)}]}]}),ZN=E=>vv.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:E}),QN=(E,T)=>[mG.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:E}),mG.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:T})],eV=E=>{let T="tox-dialog",D=T+"-wrap",B=D+"__backdrop",M=T+"__disable-scroll";return vv.sketch({lazySink:E.lazySink,onEscape:T=>(E.onEscape(T),A.some(!0)),useTabstopAt:E=>!XO(E),firstTabstop:E.firstTabstop,dom:{tag:"div",classes:[T].concat(E.extraClasses),styles:{position:"relative",...E.extraStyles}},components:[E.header,E.body,...E.footer.toArray()],parts:{blocker:{dom:jh(`<div class="${D}"></div>`),components:[{dom:{tag:"div",classes:yf?[B,B+"--opaque"]:[B]}}]}},dragBlockClass:D,modalBehaviours:kl([s9.config({}),Jp("dialog-events",E.dialogEvents.concat([Yr(t3(),(E,T)=>{fb.isBlocked(E)||sQ.focusIn(E)}),Ur(oj(),(E,T)=>{E.getSystem().broadcastOn([pT],{newFocus:T.event.newFocus})})])),Jp("scroll-lock",[oZ(()=>{La(xt(),M)}),oQ(()=>{Pa(xt(),M)})]),...E.extraBehaviours]),eventOrder:{[oS()]:["dialog-events"],[oz()]:["scroll-lock","dialog-events","alloy.base.behaviour"],[oP()]:["alloy.base.behaviour","dialog-events","scroll-lock"],...E.eventOrder}})},tV=E=>iG.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":E.translate("Close"),title:E.translate("Close")}},buttonBehaviours:kl([mq.config({})]),components:[tb("close",{tag:"span",classes:["tox-icon"]},E.icons)],action:E=>{Fr(E,mQ)}}),oV=(E,T,D,B)=>({dom:{tag:"div",classes:["tox-dialog__title"],attributes:{...D.map(E=>({id:E})).getOr({})}},components:[],behaviours:kl([x4.config({channel:`${px}-${T}`,initialData:E,renderComponents:E=>[ti(B.translate(E.title))]})])}),nV=()=>({dom:jh('<div class="tox-dialog__draghandle"></div>')}),sV=(E,T,D)=>((E,T,D)=>{let B=vv.parts.title(oV(E,T,A.none(),D)),M=vv.parts.draghandle(nV()),er=vv.parts.close(tV(D)),ec=[B].concat(E.draggable?[M]:[]).concat([er]);return mG.sketch({dom:jh('<div class="tox-dialog__header"></div>'),components:ec})})({title:D.shared.providers.translate(E),draggable:D.dialog.isDraggableModal()},T,D.shared.providers),rV=(E,T,D,B)=>({dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":D.translate(E)},styles:{left:"0px",right:"0px",bottom:"0px",top:`${B.getOr(0)}px`,position:"absolute"}},behaviours:T,components:[{dom:jh('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}),aV=(E,T,D)=>({onClose:()=>D.closeWindow(),onBlock:D=>{let B=pi(E().element,".tox-dialog__header").map(E=>Wt(E));vv.setBusy(E(),(E,M)=>rV(D.message,M,T,B))},onUnblock:()=>{vv.setIdle(E())}}),iV=(E,T,D,B)=>ri(eV({...E,firstTabstop:1,lazySink:B.shared.getSink,extraBehaviours:[x4.config({channel:`${pv}-${E.id}`,updateState:(E,T)=>A.some(T),initialData:T}),VO({}),...E.extraBehaviours],onEscape:E=>{Fr(E,mQ)},dialogEvents:D,eventOrder:{[ok()]:[x4.name(),nQ.name()],[oz()]:["scroll-lock",x4.name(),"messages","dialog-events","alloy.base.behaviour"],[oP()]:["alloy.base.behaviour","dialog-events","messages",x4.name(),"scroll-lock"]}})),lV=(E,T={})=>H(E,E=>"menu"===E.type?(E=>{let D=H(E.items,E=>{let D=be(T,E.name).getOr(Es(!1));return{...E,storage:D}});return{...E,items:D}})(E):E),cV=E=>j(E,(E,T)=>"menu"===T.type?j(T.items,(E,T)=>(E[T.name]=T.storage,E),E):E,{}),dV=(E,T)=>[$r(t3(),qO),E(mZ,(E,D,B,M)=>{Il(eJ(M.element)).fold(b,Bl),T.onClose(),D.onClose()}),E(mQ,(E,T,D,B)=>{T.onCancel(E),Fr(B,mZ)}),Ur(m3,(E,D)=>T.onUnblock()),Ur(m2,(E,D)=>T.onBlock(D.event))],uV=(E,T,D)=>{let n=(T,D)=>Ur(T,(T,B)=>{s(T,(M,er)=>{D(E(),M,B.event,T)})}),s=(E,T)=>{x4.getState(E).get().each(D=>{T(D.internalDialog,E)})};return[...dV(n,T),n(m1,(E,T)=>T.onSubmit(E)),n(mY,(E,T,D)=>{T.onChange(E,{name:D.name})}),n(m0,(E,T,B,M)=>{let r=()=>M.getSystem().isConnected()?sQ.focusIn(M):void 0,a=E=>Tt(E,"disabled")||_t(E,"aria-disabled").exists(E=>"true"===E),er=eJ(M.element),ec=Il(er);T.onAction(E,{name:B.name,value:B.value}),Il(er).fold(r,E=>{a(E)||ec.exists(T=>Qe(E,T)&&a(T))?r():D().toOptional().filter(T=>!Qe(T.element,E)).each(r)})}),n(m5,(E,T,D)=>{T.onTabChange(E,{newTabName:D.name,oldTabName:D.oldName})}),oQ(T=>{let D=E();r6.setValue(T,D.getData())})]},mV=(E,T)=>{let D=T.map(E=>E.footerButtons).getOr([]),B=P(D,E=>"start"===E.align),s=(E,T)=>mG.sketch({dom:{tag:"div",classes:[`tox-dialog__footer-${E}`]},components:H(T,E=>E.memento.asSpec())});return[s("start",B.pass),s("end",B.fail)]},gV=(E,T,D)=>({dom:jh('<div class="tox-dialog__footer"></div>'),components:[],behaviours:kl([x4.config({channel:`${pA}-${T}`,initialData:E,updateState:(E,T)=>{let B=H(T.buttons,E=>{let T=Gh(BT(E,E.type,D));return{name:E.name,align:E.align,memento:T}});return A.some({lookupByName:T=>G(B,E=>E.name===T).bind(T=>T.memento.getOpt(E)),footerButtons:B})},renderComponents:mV})])}),pV=(E,T,D)=>vv.parts.footer(gV(E,T,D)),hV=(E,T)=>{if(E.getRoot().getSystem().isConnected()){let D=aW.getCurrent(E.getFormWrapper()).getOr(E.getFormWrapper());return g8.getField(D,T).orThunk(()=>{let D=E.getFooter().bind(E=>x4.getState(E).get());return D.bind(E=>E.lookupByName(T))})}return A.none()},fV=(E,D,B)=>{let n=T=>{let D=E.getRoot();D.getSystem().isConnected()&&T(D)},M={getData:()=>{let T=E.getRoot(),D=T.getSystem().isConnected()?E.getFormWrapper():T;return{...r6.getValue(D),...ce(B,E=>E.get())}},setData:T=>{n(D=>{let er=M.getData(),ec=tR(er,T),eu=((E,T)=>{let D=E.getRoot();return x4.getState(D).get().map(E=>Xn(qn("data",E.dataValidator,T))).getOr(T)})(E,ec),eg=E.getFormWrapper();r6.setValue(eg,eu),le(B,(E,T)=>{ve(ec,T)&&E.set(ec[T])})})},setEnabled:(T,D)=>{hV(E,T).each(D?aq.enable:aq.disable)},focus:T=>{hV(E,T).each(s9.focus)},block:E=>{if(!T(E))throw Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");n(T=>{Ir(T,m2,{message:E})})},unblock:()=>{n(E=>{Fr(E,m3)})},showTab:T=>{n(D=>{let B=E.getBody();x4.getState(B).get().exists(E=>E.isTabPanel())&&aW.getCurrent(B).each(E=>{ym.showTab(E,T)})})},redial:T=>{n(er=>{let ec=E.getId(),eu=D(T),eg=lV(eu.internalDialog.buttons,B);er.getSystem().broadcastOn([`${pv}-${ec}`],eu),er.getSystem().broadcastOn([`${px}-${ec}`],eu.internalDialog),er.getSystem().broadcastOn([`${py}-${ec}`],eu.internalDialog),er.getSystem().broadcastOn([`${pA}-${ec}`],{...eu.internalDialog,buttons:eg}),M.setData(eu.initialData)})},close:()=>{n(E=>{Fr(E,mZ)})},toggleFullscreen:E.toggleFullscreen};return M},bV=(E,T,D,B=!1)=>{var M,er;let ec=la("dialog"),eu=la("dialog-label"),eg=la("dialog-content"),ep=E.internalDialog,eh="medium"===ep.size?A.some("tox-dialog--width-md"):A.none(),ef=Gh((M={title:ep.title,draggable:!0},er=D.shared.providers,mG.sketch({dom:jh('<div class="tox-dialog__header"></div>'),components:[oV(M,ec,A.some(eu),er),nV(),tV(er)],containerBehaviours:kl([vp.config({mode:"mouse",blockerClass:"blocker",getTarget:E=>hi(E,'[role="dialog"]').getOrDie(),snaps:{getSnapPoints:()=>[],leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),ex=Gh($N({body:ep.body,initialData:ep.initialData},ec,A.some(eg),D,B)),ew=lV(ep.buttons),e_=cV(ew),eD=Ce(0!==ew.length,Gh(gV({buttons:ew},ec,D))),eH=uV(()=>eU,{onBlock:E=>{fb.block(eN,(T,B)=>{let M=ef.getOpt(eN).map(E=>Wt(E.element));return rV(E.message,B,D.shared.providers,M)})},onUnblock:()=>{fb.unblock(eN)},onClose:()=>T.closeWindow()},D.shared.getSink),eR="tox-dialog-inline",eN=ri({dom:{tag:"div",classes:["tox-dialog",eR,...eh.toArray()],attributes:{role:"dialog","aria-labelledby":eu}},eventOrder:{[ok()]:[x4.name(),nQ.name()],[oS()]:["execute-on-form"],[oz()]:["reflecting","execute-on-form"]},behaviours:kl([sQ.config({mode:"cyclic",onEscape:E=>(Fr(E,mZ),A.some(!0)),useTabstopAt:E=>!XO(E)&&("button"!==Ue(E)||"disabled"!==Ot(E,"disabled")),firstTabstop:1}),x4.config({channel:`${pv}-${ec}`,updateState:(E,T)=>A.some(T),initialData:E}),s9.config({}),Jp("execute-on-form",eH.concat([Yr(t3(),(E,T)=>{sQ.focusIn(E)}),Ur(oj(),(E,T)=>{E.getSystem().broadcastOn([pT],{newFocus:T.event.newFocus})})])),fb.config({getRoot:()=>A.some(eN)}),s1.config({}),VO({})]),components:[ef.asSpec(),ex.asSpec(),...eD.map(E=>E.asSpec()).toArray()]}),eU=fV({getId:x(ec),getRoot:x(eN),getFooter:()=>eD.map(E=>E.get(eN)),getBody:()=>ex.get(eN),getFormWrapper:()=>{let E=ex.get(eN);return aW.getCurrent(E).getOr(E)},toggleFullscreen:()=>{let E="tox-dialog--fullscreen",T=Fe(eN.element.dom);Ga(T,[E])?(ja(T,[E]),Wa(T,[eR])):(ja(T,[eR]),Wa(T,[E]))}},T.redial,e_);return{dialog:eN,instanceApi:eU}};var yb=tinymce.util.Tools.resolve("tinymce.util.URI");let yv=["insertContent","setContent","execCommand","close","block","unblock"],xV=E=>D(E)&&-1!==yv.indexOf(E.mceAction),wV=(E,B,M,ec)=>{let eu=la("dialog"),eg=sV(E.title,eu,ec),ep=(E=>{let T={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[GO(A.none(),{dom:{tag:"iframe",attributes:{src:E.url}},behaviours:kl([mq.config({}),s9.config({})])})]}],behaviours:kl([sQ.config({mode:"acyclic",useTabstopAt:C(XO)})])};return vv.parts.body(T)})(E),eh=E.buttons.bind(E=>0===E.length?A.none():A.some(pV({buttons:E},eu,ec))),ef=((E,T)=>{let o=(E,T)=>Ur(E,(E,D)=>{n(E,(B,M)=>{T(eU,B,D.event,E)})}),n=(E,T)=>{x4.getState(E).get().each(D=>{T(D,E)})};return[...dV(o,T),o(m0,(E,T,D)=>{T.onAction(E,{name:D.name})})]})(0,aV(()=>eN,ec.shared.providers,B)),ex={...E.height.fold(()=>({}),E=>({height:E+"px","max-height":E+"px"})),...E.width.fold(()=>({}),E=>({width:E+"px","max-width":E+"px"}))},ew=E.width.isNone()&&E.height.isNone()?["tox-dialog--width-lg"]:[],e_=new yb(E.url,{base_uri:new yb(window.location.href)}),eD=`${e_.protocol}://${e_.host}${e_.port?":"+e_.port:""}`,eH=Zl(),eR=[Jp("messages",[oZ(()=>{let T=tc(Fe(window),"message",T=>{if(e_.isSameOrigin(new yb(T.raw.origin))){let B=T.raw.data;xV(B)?((E,T,D)=>{switch(D.mceAction){case"insertContent":E.insertContent(D.content);break;case"setContent":E.setContent(D.content);break;case"execCommand":let B=!!er(D.ui)&&D.ui;E.execCommand(D.cmd,B,D.value);break;case"close":T.close();break;case"block":T.block(D.message);break;case"unblock":T.unblock()}})(M,eU,B):!xV(B)&&D(B)&&ve(B,"mceAction")&&E.onMessage(eU,B)}});eH.set(T)}),oQ(eH.clear)]),nQ.config({channels:{[pO]:{onReceive:(E,T)=>{pi(E.element,"iframe").each(E=>{let D=E.dom.contentWindow;g(D)&&D.postMessage(T,eD)})}}}})],eN=iV({id:eu,header:eg,body:ep,footer:eh,extraClasses:ew,extraBehaviours:eR,extraStyles:ex},E,ef,ec),eU=(E=>{let t=T=>{E.getSystem().isConnected()&&T(E)};return{block:E=>{if(!T(E))throw Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t(T=>{Ir(T,m2,{message:E})})},unblock:()=>{t(E=>{Fr(E,m3)})},close:()=>{t(E=>{Fr(E,mZ)})},sendMessage:E=>{t(T=>{T.getSystem().broadcastOn([pO],E)})}}})(eN);return{dialog:eN,instanceApi:eU}},SV=(E,T)=>Xn(qn("data",T,E)),kV=E=>$S(E,".tox-alert-dialog")||$S(E,".tox-confirm-dialog"),CV=(E,T,D)=>T&&D?[]:[hY.config({contextual:{lazyContext:()=>A.some(Jo(Fe(E.getContentAreaContainer()))),fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"],lazyViewport:T=>jS(E,T.element).map(E=>({bounds:GS(E),optScrollEnv:A.some({currentScrollTop:E.element.dom.scrollTop,scrollElmTop:Xt(E.element).top})})).getOrThunk(()=>({bounds:en(),optScrollEnv:A.none()}))})],OV=E=>{let T=E.editor,D=iv(T),B=(E=>{let T=E.shared;return{open:(D,B)=>{let s=()=>{vv.hide(eu),B()},M=Gh(BT({name:"close-alert",text:"OK",primary:!0,buttonType:A.some("primary"),align:"end",enabled:!0,icon:A.none()},"cancel",E)),er=KN(),ec=YN(s,T.providers),eu=ri(eV({lazySink:()=>T.getSink(),header:XN(er,ec),body:JN(D,T.providers),footer:A.some(ZN(QN([],[M.asSpec()]))),onEscape:s,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Ur(mQ,s)],eventOrder:{}}));vv.show(eu);let eg=M.get(eu);s9.focus(eg)}}})(E.backstages.dialog),M=(E=>{let T=E.shared;return{open:(D,B)=>{let s=E=>{vv.hide(eg),B(E)},M=Gh(BT({name:"yes",text:"Yes",primary:!0,buttonType:A.some("primary"),align:"end",enabled:!0,icon:A.none()},"submit",E)),er=BT({name:"no",text:"No",primary:!1,buttonType:A.some("secondary"),align:"end",enabled:!0,icon:A.none()},"cancel",E),ec=KN(),eu=YN(()=>s(!1),T.providers),eg=ri(eV({lazySink:()=>T.getSink(),header:XN(ec,eu),body:JN(D,T.providers),footer:A.some(ZN(QN([],[er,M.asSpec()]))),onEscape:()=>s(!1),extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Ur(mQ,()=>s(!1)),Ur(m1,()=>s(!0))],eventOrder:{}}));vv.show(eg);let ep=M.get(eg);s9.focus(ep)}}})(E.backstages.dialog),r=(T,D)=>x2.open((T,B,M)=>{let er=((E,T,D)=>{let B=la("dialog"),M=E.internalDialog,er=sV(M.title,B,D),ec=((E,T,D)=>{let B=$N(E,T,A.none(),D,!1);return vv.parts.body(B)})({body:M.body,initialData:M.initialData},B,D),eu=lV(M.buttons),eg=cV(eu),ep=Ce(0!==eu.length,pV({buttons:eu},B,D)),eh=uV(()=>e_,aV(()=>ex,D.shared.providers,T),D.shared.getSink),ef=(E=>{switch(E){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}})(M.size),ex=iV({id:B,header:er,body:ec,footer:ep,extraClasses:ef,extraBehaviours:[],extraStyles:{}},E,eh,D),ew={getId:x(B),getRoot:x(ex),getBody:()=>vv.getBody(ex),getFooter:()=>vv.getFooter(ex),getFormWrapper:()=>{let E=vv.getBody(ex);return aW.getCurrent(E).getOr(E)},toggleFullscreen:()=>{let E="tox-dialog--fullscreen",T=Fe(ex.element.dom);Ua(T,E)?(Pa(T,E),Wa(T,ef)):(ja(T,ef),La(T,E))}},e_=fV(ew,T.redial,eg);return{dialog:ex,instanceApi:e_}})({dataValidator:M,initialData:B,internalDialog:T},{redial:x2.redial,closeWindow:()=>{vv.hide(er.dialog),D(er.instanceApi)}},E.backstages.dialog);return vv.show(er.dialog),er.instanceApi.setData(B),er.instanceApi},T),a=(B,M,er,ec)=>x2.open((B,eu,eg)=>{let ep=SV(eu,eg),eh=Ql(),ef=E.backstages.popup.shared.header.isPositionedAtTop(),m=()=>eh.on(E=>{iz.reposition(E),hY.refresh(E)}),ex=bV({dataValidator:eg,initialData:ep,internalDialog:B},{redial:x2.redial,closeWindow:()=>{eh.on(iz.hide),T.off("ResizeEditor",m),eh.clear(),er(ex.instanceApi)}},E.backstages.popup,ec.ariaAttrs),ew=ri(iz.sketch({lazySink:E.backstages.popup.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:ec.persistent?{event:"doNotDismissYet"}:{},...ef?{}:{fireRepositionEventInstead:{}},inlineBehaviours:kl([Jp("window-manager-inline-events",[Ur(oG(),(E,T)=>{Fr(ex.dialog,mQ)})]),...CV(T,D,ef)]),isExtraPart:(E,T)=>kV(T)}));return eh.set(ew),iz.showWithinBounds(ew,Sa(ex.dialog),{anchor:M},()=>{let E=T.inline?xt():Fe(T.getContainer()),D=Jo(E);return A.some(D)}),D&&ef||(hY.refresh(ew),T.on("ResizeEditor",m)),ex.instanceApi.setData(ep),sQ.focusIn(ex.dialog),ex.instanceApi},B),i=(D,B,M,er)=>x2.open((D,ec,eu)=>{let eg=SV(ec,eu),ep=Ql(),eh=E.backstages.popup.shared.header.isPositionedAtTop(),u=()=>ep.on(E=>{iz.reposition(E),hY.refresh(E)}),ef=bV({dataValidator:eu,initialData:eg,internalDialog:D},{redial:x2.redial,closeWindow:()=>{ep.on(iz.hide),T.off("ResizeEditor ScrollWindow ElementScroll",u),ep.clear(),M(ef.instanceApi)}},E.backstages.popup,er.ariaAttrs),ex=ri(iz.sketch({lazySink:E.backstages.popup.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:er.persistent?{event:"doNotDismissYet"}:{},...eh?{}:{fireRepositionEventInstead:{}},inlineBehaviours:kl([Jp("window-manager-inline-events",[Ur(oG(),(E,T)=>{Fr(ef.dialog,mQ)})]),hY.config({contextual:{lazyContext:()=>A.some(Jo(Fe(T.getContentAreaContainer()))),fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top","bottom"],lazyViewport:E=>jS(T,E.element).map(E=>({bounds:GS(E),optScrollEnv:A.some({currentScrollTop:E.element.dom.scrollTop,scrollElmTop:Xt(E.element).top})})).getOrThunk(()=>({bounds:en(),optScrollEnv:A.none()}))})]),isExtraPart:(E,T)=>kV(T)}));return ep.set(ex),iz.showWithinBounds(ex,Sa(ef.dialog),{anchor:B},()=>E.backstages.popup.shared.getSink().toOptional().bind(E=>{let D=jS(T,E.element).map(E=>GS(E)).getOr(en()),B=Jo(Fe(T.getContentAreaContainer())),M=Qo(B,D);return A.some(Ko(M.x,M.y,M.width,M.height-15))})),hY.refresh(ex),T.on("ResizeEditor ScrollWindow ElementScroll",u),ef.instanceApi.setData(eg),sQ.focusIn(ef.dialog),ef.instanceApi},D);return{open:(T,D,B)=>{if(!ec(D)){if("toolbar"===D.inline)return a(T,E.backstages.popup.shared.anchors.inlineDialog(),B,D);if("bottom"===D.inline)return i(T,E.backstages.popup.shared.anchors.inlineBottomDialog(),B,D);if("cursor"===D.inline)return a(T,E.backstages.popup.shared.anchors.cursor(),B,D)}return r(T,B)},openUrl:(D,B)=>x2.openUrl(D=>{let M=wV(D,{closeWindow:()=>{vv.hide(M.dialog),B(M.instanceApi)}},T,E.backstages.dialog);return vv.show(M.dialog),M.instanceApi},D),alert:(E,T)=>{B.open(E,T)},close:E=>{E.close()},confirm:(E,T)=>{M.open(E,T)}}};t_.add("silver",E=>{ub(E),(E=>{let D=E.options.register,o=E=>f(E,T)?{value:Bw(E),valid:!0}:{valid:!1,message:"Must be an array of strings."},n=E=>eg(E)&&E>0?{value:E,valid:!0}:{valid:!1,message:"Must be a positive number."};D("color_map",{processor:o,default:["#BFEDD2","Light Green","#FBEEB8","Light Yellow","#F8CAC6","Light Red","#ECCAFA","Light Purple","#C2E0F4","Light Blue","#2DC26B","Green","#F1C40F","Yellow","#E03E2D","Red","#B96AD9","Purple","#3598DB","Blue","#169179","Dark Turquoise","#E67E23","Orange","#BA372A","Dark Red","#843FA1","Dark Purple","#236FA1","Dark Blue","#ECF0F1","Light Gray","#CED4D9","Medium Gray","#95A5A6","Gray","#7E8C8D","Dark Gray","#34495E","Navy Blue","#000000","Black","#ffffff","White"]}),D("color_map_background",{processor:o}),D("color_map_foreground",{processor:o}),D("color_cols",{processor:n,default:Nw(E)}),D("color_cols_foreground",{processor:n,default:Vw(E,mr)}),D("color_cols_background",{processor:n,default:Vw(E,ma)}),D("custom_colors",{processor:"boolean",default:!0}),D("color_default_foreground",{processor:"string",default:mc}),D("color_default_background",{processor:"string",default:mc})})(E),(E=>{let D=E.options.register;D("contextmenu_avoid_overlap",{processor:"string",default:""}),D("contextmenu_never_use_native",{processor:"boolean",default:!1}),D("contextmenu",{processor:E=>!1===E?{value:[],valid:!0}:T(E)||f(E,T)?{value:vF(E),valid:!0}:{valid:!1,message:"Must be false or a string."},default:"link linkchecker image editimage table spellchecker configurepermanentpen"})})(E);let t=()=>en(),{dialogs:D,popups:B,renderUI:M}=RI(E,{getPopupSinkBounds:()=>t()});LS(E,B.backstage.shared);let er=OV({editor:E,backstages:{popup:B.backstage,dialog:D.backstage}});return{renderUI:()=>{let T=M();return jS(E,B.getMothership().element).each(E=>{t=()=>GS(E)}),T},getWindowManagerImpl:x(er),getNotificationManagerImpl:()=>((E,T,D)=>{let B=T.backstage.shared,s=()=>{let T=Jo(Fe(E.getContentAreaContainer())),D=en(),B=Yi(D.x,T.x,T.right),M=Yi(D.y,T.y,T.bottom),er=Math.max(T.right,D.right),ec=Math.max(T.bottom,D.bottom);return A.some(Ko(B,M,er-B,ec-M))};return{open:(T,M)=>{let a=()=>{M(),iz.hide(ec)},er=ri(l3.sketch({text:T.text,level:R(["success","error","warning","warn","info"],T.type)?T.type:void 0,progress:!0===T.progressBar,icon:T.icon,closeButton:T.closeButton,onAction:a,iconProvider:B.providers.icons,translationProvider:B.providers.translate})),ec=ri(iz.sketch({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:B.getSink,fireDismissalEventInstead:{},...B.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}}}));D.add(ec),eg(T.timeout)&&T.timeout>0&&iP.setEditorTimeout(E,()=>{a()},T.timeout);let eu={close:a,reposition:()=>{let T=Sa(er),D={maxHeightFunction:n7()},M=E.notificationManager.getNotifications();if(M[0]===eu){let E={...B.anchors.banner(),overrides:D};iz.showWithinBounds(ec,T,{anchor:E},s)}else I(M,eu).each(E=>{let B=M[E-1].getEl(),er={type:"node",root:xt(),node:A.some(Fe(B)),overrides:D,layouts:{onRtl:()=>[cl],onLtr:()=>[cl]}};iz.showWithinBounds(ec,T,{anchor:er},s)})},text:E=>{l3.updateText(er,E)},settings:T,getEl:()=>er.element.dom,progressBar:{value:E=>{l3.updateProgress(er,E)}}};return eu},close:E=>{E.close()},getArgs:E=>E.settings}})(E,{backstage:B.backstage},B.getMothership())}})}();