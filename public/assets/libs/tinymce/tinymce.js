!function(){"use strict";let e,t,r,n,o,a,l,i;var s,d,c,m,u,f,g,p,h,b,v,y,C=function(e){if(null===e)return"null";if(void 0===e)return"undefined";var t=typeof e;return"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t},x=function(e){return{eq:e}},w=x(function(e,t){return e===t}),E=function(e){return x(function(t,r){if(t.length!==r.length)return!1;for(var n=t.length,o=0;o<n;o++)if(!e.eq(t[o],r[o]))return!1;return!0})},k=function(e,t){var r,n;return r=E(e),n=function(e){return Array.prototype.slice.call(e).sort(t)},x(function(e,t){return r.eq(n(e),n(t))})},S=function(e){return x(function(t,r){var n=Object.keys(t),o=Object.keys(r);if(!k(w).eq(n,o))return!1;for(var a=n.length,l=0;l<a;l++){var i=n[l];if(!e.eq(t[i],r[i]))return!1}return!0})},_=x(function(e,t){if(e===t)return!0;var r=C(e);return r===C(t)&&(-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(r)?e===t:"array"===r?E(_).eq(e,t):"object"===r&&S(_).eq(e,t))});let N=Object.getPrototypeOf,D=(e,t,r)=>{var n;return!!r(e,t.prototype)||(null===(n=e.constructor)||void 0===n?void 0:n.name)===t.name},R=e=>{let t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&D(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},A=e=>t=>R(t)===e,O=e=>t=>typeof t===e,T=e=>t=>e===t,B=(e,t)=>L(e)&&D(e,t,(e,t)=>N(e)===t),P=A("string"),L=A("object"),F=e=>B(e,Object),M=A("array"),I=T(null),U=O("boolean"),z=T(void 0),j=e=>null==e,H=e=>!j(e),$=O("function"),q=O("number"),V=(e,t)=>{if(M(e)){for(let r=0,n=e.length;r<n;++r)if(!t(e[r]))return!1;return!0}return!1},W=()=>{},K=(e,t)=>(...r)=>e(t.apply(null,r)),G=(e,t)=>r=>e(t(r)),Y=e=>()=>e,X=e=>e,Q=(e,t)=>e===t;function J(e,...t){return(...r)=>{let n=t.concat(r);return e.apply(null,n)}}let Z=e=>t=>!e(t),ee=e=>()=>{throw Error(e)},et=e=>e(),er=e=>{e()},en=Y(!1),eo=Y(!0);class ea{constructor(e,t){this.tag=e,this.value=t}static some(e){return new ea(!0,e)}static none(){return ea.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?ea.some(e(this.value)):ea.none()}bind(e){return this.tag?e(this.value):ea.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:ea.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return H(e)?ea.some(e):ea.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}ea.singletonNone=new ea(!1);let el=Array.prototype.slice,ei=Array.prototype.indexOf,es=Array.prototype.push,ed=(e,t)=>ei.call(e,t),ec=(e,t)=>{let r=ed(e,t);return -1===r?ea.none():ea.some(r)},em=(e,t)=>ed(e,t)>-1,eu=(e,t)=>{for(let r=0,n=e.length;r<n;r++)if(t(e[r],r))return!0;return!1},ef=(e,t)=>{let r=e.length,n=Array(r);for(let o=0;o<r;o++){let r=e[o];n[o]=t(r,o)}return n},eg=(e,t)=>{for(let r=0,n=e.length;r<n;r++)t(e[r],r)},ep=(e,t)=>{for(let r=e.length-1;r>=0;r--)t(e[r],r)},eh=(e,t)=>{let r=[],n=[];for(let o=0,a=e.length;o<a;o++){let a=e[o];(t(a,o)?r:n).push(a)}return{pass:r,fail:n}},eb=(e,t)=>{let r=[];for(let n=0,o=e.length;n<o;n++){let o=e[n];t(o,n)&&r.push(o)}return r},ev=(e,t,r)=>(ep(e,(e,n)=>{r=t(r,e,n)}),r),ey=(e,t,r)=>(eg(e,(e,n)=>{r=t(r,e,n)}),r),eC=(e,t,r)=>{for(let n=0,o=e.length;n<o;n++){let o=e[n];if(t(o,n))return ea.some(o);if(r(o,n))break}return ea.none()},ex=(e,t)=>eC(e,t,en),ew=(e,t)=>{for(let r=0,n=e.length;r<n;r++)if(t(e[r],r))return ea.some(r);return ea.none()},eE=e=>{let t=[];for(let r=0,n=e.length;r<n;++r){if(!M(e[r]))throw Error("Arr.flatten item "+r+" was not an array, input: "+e);es.apply(t,e[r])}return t},ek=(e,t)=>eE(ef(e,t)),eS=(e,t)=>{for(let r=0,n=e.length;r<n;++r)if(!0!==t(e[r],r))return!1;return!0},e_=e=>{let t=el.call(e,0);return t.reverse(),t},eN=(e,t)=>eb(e,e=>!em(t,e)),eD=(e,t)=>{let r={};for(let n=0,o=e.length;n<o;n++){let o=e[n];r[String(o)]=t(o,n)}return r},eR=(e,t)=>{let r=el.call(e,0);return r.sort(t),r},eA=(e,t)=>t>=0&&t<e.length?ea.some(e[t]):ea.none(),eO=e=>eA(e,0),eT=e=>eA(e,e.length-1),eB=$(Array.from)?Array.from:e=>el.call(e),eP=(e,t)=>{for(let r=0;r<e.length;r++){let n=t(e[r],r);if(n.isSome())return n}return ea.none()},eL=(e,t)=>{let r=[],n=$(t)?e=>eu(r,r=>t(r,e)):e=>em(r,e);for(let t=0,o=e.length;t<o;t++){let o=e[t];n(o)||r.push(o)}return r},eF=Object.keys,eM=Object.hasOwnProperty,eI=(e,t)=>{let r=eF(e);for(let n=0,o=r.length;n<o;n++){let o=r[n];t(e[o],o)}},eU=(e,t)=>ez(e,(e,r)=>({k:r,v:t(e,r)})),ez=(e,t)=>{let r={};return eI(e,(e,n)=>{let o=t(e,n);r[o.k]=o.v}),r},ej=e=>(t,r)=>{e[r]=t},eH=(e,t,r,n)=>{eI(e,(e,o)=>{(t(e,o)?r:n)(e,o)})},e$=(e,t)=>{let r={},n={};return eH(e,t,ej(r),ej(n)),{t:r,f:n}},eq=(e,t)=>{let r={};return eH(e,t,ej(r),W),r},eV=(e,t)=>{let r=[];return eI(e,(e,n)=>{r.push(t(e,n))}),r},eW=e=>eV(e,X),eK=(e,t)=>eG(e,t)?ea.from(e[t]):ea.none(),eG=(e,t)=>eM.call(e,t),eY=(e,t)=>eG(e,t)&&void 0!==e[t]&&null!==e[t],eX=(e,t,r=_)=>S(r).eq(e,t),eQ=e=>{let t={};return eg(e,e=>{t[e]={}}),eF(t)},eJ=e=>void 0!==e.length,eZ=Array.isArray,e0=(e,t,r)=>{if(!e)return!1;if(r=r||e,eJ(e)){for(let n=0,o=e.length;n<o;n++)if(!1===t.call(r,e[n],n,e))return!1}else for(let n in e)if(eG(e,n)&&!1===t.call(r,e[n],n,e))return!1;return!0},e1=(e,t)=>{let r=[];return e0(e,(n,o)=>{r.push(t(n,o,e))}),r},e2=(e,t)=>{let r=[];return e0(e,(n,o)=>{(!t||t(n,o,e))&&r.push(n)}),r},e3=(e,t,r,n)=>{let o=z(r)?e[0]:r;for(let r=0;r<e.length;r++)o=t.call(n,o,e[r],r);return o},e8=(e,t,r)=>{for(let n=0,o=e.length;n<o;n++)if(t.call(r,e[n],n,e))return n;return -1},e5=e=>e[e.length-1],e6=e=>{let t,r=!1;return(...n)=>(r||(r=!0,t=e.apply(null,n)),t)},e9=(e,t,r,n)=>{let o=e.isiOS()&&!0===/ipad/i.test(r),a=e.isiOS()&&!o,l=e.isiOS()||e.isAndroid(),i=l||n("(pointer:coarse)"),s=o||!a&&l&&n("(min-device-width:768px)"),d=a||l&&!s,c=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(r);return{isiPad:Y(o),isiPhone:Y(a),isTablet:Y(s),isPhone:Y(d),isTouch:Y(i),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:Y(c),isDesktop:Y(!d&&!s&&!c)}},e4=(e,t)=>{for(let r=0;r<e.length;r++){let n=e[r];if(n.test(t))return n}},e7=(e,t)=>{let r=e4(e,t);if(!r)return{major:0,minor:0};let n=e=>Number(t.replace(r,"$"+e));return tt(n(1),n(2))},te=()=>tt(0,0),tt=(e,t)=>({major:e,minor:t}),tr=(e,t)=>{let r=String(t).toLowerCase();return 0===e.length?te():e7(e,r)},tn=(e,t)=>eP(t.brands,t=>{let r=t.brand.toLowerCase();return ex(e,e=>{var t;return r===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())}).map(e=>({current:e.name,version:tt(parseInt(t.version,10),0)}))}),to=(e,t)=>{let r=String(t).toLowerCase();return ex(e,e=>e.search(r))},ta=(e,t)=>to(e,t).map(e=>{let r=tr(e.versionRegexes,t);return{current:e.name,version:r}}),tl=(e,t)=>to(e,t).map(e=>{let r=tr(e.versionRegexes,t);return{current:e.name,version:r}}),ti=(e,t)=>e.substring(t),ts=(e,t,r)=>""===t||e.length>=t.length&&e.substr(r,r+t.length)===t,td=(e,t)=>tm(e,t)?ti(e,t.length):e,tc=(e,t,r=0,n)=>{let o=e.indexOf(t,r);return -1!==o&&(!!z(n)||o+t.length<=n)},tm=(e,t)=>ts(e,t,0),tu=(e,t)=>ts(e,t,e.length-t.length),tf=e=>t=>t.replace(e,""),tg=tf(/^\s+|\s+$/g),tp=tf(/^\s+/g),th=tf(/\s+$/g),tb=e=>e.length>0,tv=e=>!tb(e),ty=(e,t)=>t<=0?"":Array(t+1).join(e),tC=(e,t=10)=>{let r=parseInt(e,t);return isNaN(r)?ea.none():ea.some(r)},tx=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,tw=e=>t=>tc(t,e),tE=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>tc(e,"edge/")&&tc(e,"chrome")&&tc(e,"safari")&&tc(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,tx],search:e=>tc(e,"chrome")&&!tc(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>tc(e,"msie")||tc(e,"trident")},{name:"Opera",versionRegexes:[tx,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:tw("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:tw("firefox")},{name:"Safari",versionRegexes:[tx,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(tc(e,"safari")||tc(e,"mobile/"))&&tc(e,"applewebkit")}],tk=[{name:"Windows",search:tw("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>tc(e,"iphone")||tc(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:tw("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:tw("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:tw("linux"),versionRegexes:[]},{name:"Solaris",search:tw("sunos"),versionRegexes:[]},{name:"FreeBSD",search:tw("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:tw("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],tS={browsers:Y(tE),oses:Y(tk)},t_="Edge",tN="Chromium",tD="Opera",tR="Firefox",tA="Safari",tO=e=>{let t=e.current,r=e.version,n=e=>()=>t===e;return{current:t,version:r,isEdge:n(t_),isChromium:n(tN),isIE:n("IE"),isOpera:n(tD),isFirefox:n(tR),isSafari:n(tA)}},tT={unknown:()=>tO({current:void 0,version:te()}),nu:tO,edge:Y(t_),chromium:Y(tN),ie:Y("IE"),opera:Y(tD),firefox:Y(tR),safari:Y(tA)},tB="Windows",tP="Android",tL="Linux",tF="macOS",tM="Solaris",tI="FreeBSD",tU="ChromeOS",tz=e=>{let t=e.current,r=e.version,n=e=>()=>t===e;return{current:t,version:r,isWindows:n(tB),isiOS:n("iOS"),isAndroid:n(tP),isMacOS:n(tF),isLinux:n(tL),isSolaris:n(tM),isFreeBSD:n(tI),isChromeOS:n(tU)}},tj={unknown:()=>tz({current:void 0,version:te()}),nu:tz,windows:Y(tB),ios:Y("iOS"),android:Y(tP),linux:Y(tL),macos:Y(tF),solaris:Y(tM),freebsd:Y(tI),chromeos:Y(tU)},tH=(e,t,r)=>{let n=tS.browsers(),o=tS.oses(),a=t.bind(e=>tn(n,e)).orThunk(()=>ta(n,e)).fold(tT.unknown,tT.nu),l=tl(o,e).fold(tj.unknown,tj.nu),i=e9(l,a,e,r);return{browser:a,os:l,deviceType:i}},t$=e=>window.matchMedia(e).matches,tq=e6(()=>tH(navigator.userAgent,ea.from(navigator.userAgentData),t$)),tV=()=>tq(),tW=navigator.userAgent,tK=tV(),tG=tK.browser,tY=tK.os,tX=tK.deviceType,tQ=-1!==tW.indexOf("Windows Phone"),tJ={transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",documentMode:tG.isIE()?document.documentMode||7:10,cacheSuffix:null,container:null,canHaveCSP:!tG.isIE(),windowsPhone:tQ,browser:{current:tG.current,version:tG.version,isChromium:tG.isChromium,isEdge:tG.isEdge,isFirefox:tG.isFirefox,isIE:tG.isIE,isOpera:tG.isOpera,isSafari:tG.isSafari},os:{current:tY.current,version:tY.version,isAndroid:tY.isAndroid,isChromeOS:tY.isChromeOS,isFreeBSD:tY.isFreeBSD,isiOS:tY.isiOS,isLinux:tY.isLinux,isMacOS:tY.isMacOS,isSolaris:tY.isSolaris,isWindows:tY.isWindows},deviceType:{isDesktop:tX.isDesktop,isiPad:tX.isiPad,isiPhone:tX.isiPhone,isPhone:tX.isPhone,isTablet:tX.isTablet,isTouch:tX.isTouch,isWebView:tX.isWebView}},tZ=/^\s*|\s*$/g,t0=e=>j(e)?"":(""+e).replace(tZ,""),t1=function(e,t,r,n){n=n||this,e&&(r&&(e=e[r]),e0(e,(e,o)=>!1!==t.call(n,e,o,r)&&(t1(e,t,r,n),!0)))},t2={trim:t0,isArray:eZ,is:(e,t)=>t?!!("array"===t&&eZ(e))||typeof e===t:void 0!==e,toArray:e=>{if(eZ(e))return e;{let t=[];for(let r=0,n=e.length;r<n;r++)t[r]=e[r];return t}},makeMap:(e,t,r={})=>{let n=P(e)?e.split(t||","):e||[],o=n.length;for(;o--;)r[n[o]]={};return r},each:e0,map:e1,grep:e2,inArray:(e,t)=>{if(e){for(let r=0,n=e.length;r<n;r++)if(e[r]===t)return r}return -1},hasOwn:eG,extend:(e,...t)=>{for(let r=0;r<t.length;r++){let n=t[r];for(let t in n)if(eG(n,t)){let r=n[t];void 0!==r&&(e[t]=r)}}return e},walk:t1,resolve:(e,t=window)=>{let r=e.split(".");for(let e=0,n=r.length;e<n&&(t=t[r[e]]);e++);return t},explode:(e,t)=>M(e)?e:""===e?[]:e1(e.split(t||","),t0),_addCacheSuffix:e=>{let t=tJ.cacheSuffix;return t&&(e+=(-1===e.indexOf("?")?"?":"&")+t),e}},t3=(e,t,r=Q)=>e.exists(e=>r(e,t)),t8=(e,t,r=Q)=>t6(e,t,r).getOr(e.isNone()&&t.isNone()),t5=e=>{let t=[],r=e=>{t.push(e)};for(let t=0;t<e.length;t++)e[t].each(r);return t},t6=(e,t,r)=>e.isSome()&&t.isSome()?ea.some(r(e.getOrDie(),t.getOrDie())):ea.none(),t9=(e,t,r,n)=>e.isSome()&&t.isSome()&&r.isSome()?ea.some(n(e.getOrDie(),t.getOrDie(),r.getOrDie())):ea.none(),t4=(e,t)=>e?ea.some(t):ea.none(),t7="undefined"!=typeof window?window:Function("return this;")(),re=(e,t)=>{let r=null!=t?t:t7;for(let t=0;t<e.length&&null!=r;++t)r=r[e[t]];return r},rt=(e,t)=>re(e.split("."),t),rr=(e,t)=>rt(e,t),rn=(e,t)=>{let r=rr(e,t);if(null==r)throw Error(e+" not available on this browser");return r},ro=Object.getPrototypeOf,ra=e=>rn("HTMLElement",e),rl=e=>{let t=rt("ownerDocument.defaultView",e);return L(e)&&(ra(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(ro(e).constructor.name))},ri=e=>e.dom.nodeName.toLowerCase(),rs=e=>e.dom.nodeType,rd=e=>t=>rs(t)===e,rc=e=>8===rs(e)||"#comment"===ri(e),rm=e=>ru(e)&&rl(e.dom),ru=rd(1),rf=rd(3),rg=rd(9),rp=rd(11),rh=e=>t=>ru(t)&&ri(t)===e,rb=(e,t,r)=>{if(P(r)||U(r)||q(r))e.setAttribute(t,r+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",r,":: Element ",e),Error("Attribute value was not simple")},rv=(e,t,r)=>{rb(e.dom,t,r)},ry=(e,t)=>{let r=e.dom;eI(t,(e,t)=>{rb(r,t,e)})},rC=(e,t)=>{let r=e.dom.getAttribute(t);return null===r?void 0:r},rx=(e,t)=>ea.from(rC(e,t)),rw=(e,t)=>{let r=e.dom;return!!r&&!!r.hasAttribute&&r.hasAttribute(t)},rE=(e,t)=>{e.dom.removeAttribute(t)},rk=e=>{let t=e.dom.attributes;return null==t||0===t.length},rS=e=>ey(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),r_=(e,t)=>{let r=rC(e,t);return void 0===r||""===r?[]:r.split(" ")},rN=(e,t,r)=>{let n=r_(e,t).concat([r]);return rv(e,t,n.join(" ")),!0},rD=(e,t,r)=>{let n=eb(r_(e,t),e=>e!==r);return n.length>0?rv(e,t,n.join(" ")):rE(e,t),!1},rR=e=>void 0!==e.dom.classList,rA=e=>r_(e,"class"),rO=(e,t)=>rN(e,"class",t),rT=(e,t)=>rD(e,"class",t),rB=(e,t)=>em(rA(e),t)?rT(e,t):rO(e,t),rP=(e,t)=>{rR(e)?e.dom.classList.add(t):rO(e,t)},rL=e=>{0===(rR(e)?e.dom.classList:rA(e)).length&&rE(e,"class")},rF=(e,t)=>{rR(e)?e.dom.classList.remove(t):rT(e,t),rL(e)},rM=(e,t)=>{let r=rR(e)?e.dom.classList.toggle(t):rB(e,t);return rL(e),r},rI=(e,t)=>rR(e)&&e.dom.classList.contains(t),rU=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},rz={fromHtml:(e,t)=>{let r=(t||document).createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||r.childNodes.length>1){let t="HTML does not have a single root node";throw console.error(t,e),Error(t)}return rU(r.childNodes[0])},fromTag:(e,t)=>rU((t||document).createElement(e)),fromText:(e,t)=>rU((t||document).createTextNode(e)),fromDom:rU,fromPoint:(e,t,r)=>ea.from(e.dom.elementFromPoint(t,r)).map(rU)},rj=(e,t)=>{let r=[],n=e=>(r.push(e),t(e)),o=t(e);do o=o.bind(n);while(o.isSome());return r},rH=(e,t)=>{let r=e.dom;if(1!==r.nodeType)return!1;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw Error("Browser lacks native selectors")},r$=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,rq=(e,t)=>{let r=void 0===t?document:t.dom;return r$(r)?[]:ef(r.querySelectorAll(e),rz.fromDom)},rV=(e,t)=>{let r=void 0===t?document:t.dom;return r$(r)?ea.none():ea.from(r.querySelector(e)).map(rz.fromDom)},rW=(e,t)=>e.dom===t.dom,rK=(e,t)=>{let r=e.dom,n=t.dom;return r!==n&&r.contains(n)},rG=e=>rz.fromDom(e.dom.ownerDocument),rY=e=>rg(e)?e:rG(e),rX=e=>rz.fromDom(rY(e).dom.documentElement),rQ=e=>rz.fromDom(rY(e).dom.defaultView),rJ=e=>ea.from(e.dom.parentNode).map(rz.fromDom),rZ=e=>ea.from(e.dom.parentElement).map(rz.fromDom),r0=(e,t)=>{let r=$(t)?t:en,n=e.dom,o=[];for(;null!==n.parentNode&&void 0!==n.parentNode;){let e=n.parentNode,t=rz.fromDom(e);if(o.push(t),!0===r(t))break;n=e}return o},r1=e=>rJ(e).map(r6).map(t=>eb(t,t=>!rW(e,t))).getOr([]),r2=e=>ea.from(e.dom.previousSibling).map(rz.fromDom),r3=e=>ea.from(e.dom.nextSibling).map(rz.fromDom),r8=e=>e_(rj(e,r2)),r5=e=>rj(e,r3),r6=e=>ef(e.dom.childNodes,rz.fromDom),r9=(e,t)=>{let r=e.dom.childNodes;return ea.from(r[t]).map(rz.fromDom)},r4=e=>r9(e,0),r7=e=>r9(e,e.dom.childNodes.length-1),ne=e=>e.dom.childNodes.length,nt=e=>e.dom.hasChildNodes(),nr=e=>{let t=e.dom.head;if(null==t)throw Error("Head is not available yet");return rz.fromDom(t)},nn=e=>rp(e)&&H(e.dom.host),no=$(Element.prototype.attachShadow)&&$(Node.prototype.getRootNode),na=Y(no),nl=no?e=>rz.fromDom(e.dom.getRootNode()):rY,ni=e=>nn(e)?e:nr(rY(e)),ns=e=>nn(e)?e:rz.fromDom(rY(e).dom.body),nd=e=>{let t=nl(e);return nn(t)?ea.some(t):ea.none()},nc=e=>rz.fromDom(e.dom.host),nm=e=>{if(na()&&H(e.target)){let t=rz.fromDom(e.target);if(ru(t)&&nu(t)&&e.composed&&e.composedPath){let t=e.composedPath();if(t)return eO(t)}}return ea.from(e.target)},nu=e=>H(e.dom.shadowRoot),nf=e=>{let t=rf(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;let r=t.ownerDocument;return nd(rz.fromDom(t)).fold(()=>r.body.contains(t),G(nf,nc))};var ng=(e,t,r,n,o)=>e(r,n)?ea.some(r):$(o)&&o(r)?ea.none():t(r,n,o);let np=(e,t,r)=>{let n=e.dom,o=$(r)?r:en;for(;n.parentNode;){n=n.parentNode;let e=rz.fromDom(n);if(t(e))return ea.some(e);if(o(e))break}return ea.none()},nh=(e,t,r)=>ng((e,t)=>t(e),np,e,t,r),nb=(e,t)=>{let r=e.dom;return r.parentNode?nv(rz.fromDom(r.parentNode),r=>!rW(e,r)&&t(r)):ea.none()},nv=(e,t)=>ex(e.dom.childNodes,e=>t(rz.fromDom(e))).map(rz.fromDom),ny=(e,t)=>{let r=e=>{for(let n=0;n<e.childNodes.length;n++){let o=rz.fromDom(e.childNodes[n]);if(t(o))return ea.some(o);let a=r(e.childNodes[n]);if(a.isSome())return a}return ea.none()};return r(e.dom)},nC=(e,t,r)=>np(e,e=>rH(e,t),r),nx=(e,t)=>rV(t,e),nw=(e,t,r)=>ng((e,t)=>rH(e,t),nC,e,t,r),nE=e=>nw(e,"[contenteditable]"),nk=(e,t=!1)=>nf(e)?e.dom.isContentEditable:nE(e).fold(Y(t),e=>"true"===nS(e)),nS=e=>e.dom.contentEditable,n_=e=>void 0!==e.style&&$(e.style.getPropertyValue),nN=(e,t,r)=>{if(!P(r))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",r,":: Element ",e),Error("CSS value must be a string: "+r);n_(e)&&e.style.setProperty(t,r)},nD=(e,t)=>{n_(e)&&e.style.removeProperty(t)},nR=(e,t,r)=>{nN(e.dom,t,r)},nA=(e,t)=>{let r=e.dom;eI(t,(e,t)=>{nN(r,t,e)})},nO=(e,t)=>{let r=e.dom,n=window.getComputedStyle(r).getPropertyValue(t);return""!==n||nf(e)?n:nT(r,t)},nT=(e,t)=>n_(e)?e.style.getPropertyValue(t):"",nB=(e,t)=>{let r=nT(e.dom,t);return ea.from(r).filter(e=>e.length>0)},nP=e=>{let t={},r=e.dom;if(n_(r))for(let e=0;e<r.style.length;e++){let n=r.style.item(e);t[n]=r.style[n]}return t},nL=(e,t)=>{nD(e.dom,t),t3(rx(e,"style").map(tg),"")&&rE(e,"style")},nF=e=>e.dom.offsetWidth,nM=(e,t)=>{rJ(e).each(r=>{r.dom.insertBefore(t.dom,e.dom)})},nI=(e,t)=>{r3(e).fold(()=>{rJ(e).each(e=>{nz(e,t)})},e=>{nM(e,t)})},nU=(e,t)=>{r4(e).fold(()=>{nz(e,t)},r=>{e.dom.insertBefore(t.dom,r.dom)})},nz=(e,t)=>{e.dom.appendChild(t.dom)},nj=(e,t)=>{nM(e,t),nz(t,e)},nH=(e,t)=>{eg(t,(r,n)=>{nI(0===n?e:t[n-1],r)})},n$=(e,t)=>{eg(t,t=>{nz(e,t)})},nq=e=>{e.dom.textContent="",eg(r6(e),e=>{nV(e)})},nV=e=>{let t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},nW=e=>{let t=r6(e);t.length>0&&nH(e,t),nV(e)},nK=(e,t)=>{let r=(t||document).createElement("div");return r.innerHTML=e,r6(rz.fromDom(r))},nG=e=>ef(e,rz.fromDom),nY=e=>e.dom.innerHTML,nX=(e,t)=>{let r=rG(e).dom,n=rz.fromDom(r.createDocumentFragment());n$(n,nK(t,r)),nq(e),nz(e,n)},nQ=e=>{let t=rz.fromTag("div");return nz(t,rz.fromDom(e.dom.cloneNode(!0))),nY(t)},nJ=(e,t,r,n,o,a,l)=>({target:e,x:t,y:r,stop:n,prevent:o,kill:a,raw:l}),nZ=e=>{let t=rz.fromDom(nm(e).getOr(e.target)),r=()=>e.stopPropagation(),n=()=>e.preventDefault(),o=K(n,r);return nJ(t,e.clientX,e.clientY,r,n,o,e)},n0=(e,t)=>r=>{e(r)&&t(nZ(r))},n1=(e,t,r,n,o)=>{let a=n0(r,n);return e.dom.addEventListener(t,a,o),{unbind:J(n3,e,t,a,o)}},n2=(e,t,r,n)=>n1(e,t,r,n,!1),n3=(e,t,r,n)=>{e.dom.removeEventListener(t,r,n)},n8=(e,t)=>({left:e,top:t,translate:(r,n)=>n8(e+r,t+n)}),n5=e=>{let t=e.getBoundingClientRect();return n8(t.left,t.top)},n6=(e,t)=>void 0!==e?e:void 0!==t?t:0,n9=e=>{let t=e.dom.ownerDocument,r=t.body,n=t.defaultView,o=t.documentElement;if(r===e.dom)return n8(r.offsetLeft,r.offsetTop);let a=n6(null==n?void 0:n.pageYOffset,o.scrollTop),l=n6(null==n?void 0:n.pageXOffset,o.scrollLeft),i=n6(o.clientTop,r.clientTop),s=n6(o.clientLeft,r.clientLeft);return n4(e).translate(l-s,a-i)},n4=e=>{let t=e.dom,r=t.ownerDocument.body;return r===t?n8(r.offsetLeft,r.offsetTop):nf(e)?n5(t):n8(0,0)},n7=e=>{let t=void 0!==e?e.dom:document;return n8(t.body.scrollLeft||t.documentElement.scrollLeft,t.body.scrollTop||t.documentElement.scrollTop)},oe=(e,t,r)=>{let n=(void 0!==r?r.dom:document).defaultView;n&&n.scrollTo(e,t)},ot=(e,t)=>{tV().browser.isSafari()&&$(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(!1):e.dom.scrollIntoView(t)},or=e=>{let t=void 0===e?window:e;return tV().browser.isFirefox()?ea.none():ea.from(t.visualViewport)},on=(e,t,r,n)=>({x:e,y:t,width:r,height:n,right:e+r,bottom:t+n}),oo=e=>{let t=void 0===e?window:e,r=t.document,n=n7(rz.fromDom(r));return or(t).fold(()=>{let e=t.document.documentElement,r=e.clientWidth,o=e.clientHeight;return on(n.left,n.top,r,o)},e=>on(Math.max(e.pageLeft,n.left),Math.max(e.pageTop,n.top),e.width,e.height))},oa=(e,t)=>eb(r6(e),t),ol=(e,t)=>{let r=[];return eg(r6(e),e=>{t(e)&&(r=r.concat([e])),r=r.concat(ol(e,t))}),r},oi=(e,t)=>rq(t,e),os=(e,t,r)=>nC(e,t,r).isSome();class od{constructor(e,t){this.node=e,this.rootNode=t,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}current(){return this.node}next(e){return this.node=this.findSibling(this.node,"firstChild","nextSibling",e),this.node}prev(e){return this.node=this.findSibling(this.node,"lastChild","previousSibling",e),this.node}prev2(e){return this.node=this.findPreviousNode(this.node,e),this.node}findSibling(e,t,r,n){if(e){if(!n&&e[t])return e[t];if(e!==this.rootNode){let t=e[r];if(t)return t;for(let n=e.parentNode;n&&n!==this.rootNode;n=n.parentNode)if(t=n[r])return t}}}findPreviousNode(e,t){if(e){let r=e.previousSibling;if(this.rootNode&&r===this.rootNode)return;if(r){if(!t){for(let e=r.lastChild;e;e=e.lastChild)if(!e.lastChild)return e}return r}let n=e.parentNode;if(n&&n!==this.rootNode)return n}}}let oc=e=>t=>!!t&&t.nodeType===e,om=e=>!!e&&!Object.getPrototypeOf(e),ou=oc(1),of=e=>{let t=e.toLowerCase();return e=>H(e)&&e.nodeName.toLowerCase()===t},og=e=>{let t=e.map(e=>e.toLowerCase());return e=>!!e&&!!e.nodeName&&em(t,e.nodeName.toLowerCase())},op=(e,t)=>{let r=t.toLowerCase().split(" ");return t=>{if(ou(t)){let n=t.ownerDocument.defaultView;if(n)for(let o=0;o<r.length;o++){let a=n.getComputedStyle(t,null);if((a?a.getPropertyValue(e):null)===r[o])return!0}}return!1}},oh=e=>t=>ou(t)&&t.hasAttribute(e),ob=e=>ou(e)&&e.hasAttribute("data-mce-bogus"),ov=e=>ou(e)&&"all"===e.getAttribute("data-mce-bogus"),oy=e=>ou(e)&&"TABLE"===e.tagName,oC=e=>t=>!!ou(t)&&(t.contentEditable===e||t.getAttribute("data-mce-contenteditable")===e),ox=og(["textarea","input"]),ow=oc(3),oE=oc(4),ok=oc(7),oS=oc(8),o_=oc(9),oN=oc(11),oD=of("br"),oR=of("img"),oA=oC("true"),oO=oC("false"),oT=og(["td","th"]),oB=og(["td","th","caption"]),oP=og(["video","audio","object","embed"]),oL=of("li"),oF=of("details"),oM=of("summary"),oI=e=>"\uFEFF"===e,oU=((e,t)=>{let r=t=>e(t)?ea.from(t.dom.nodeValue):ea.none();return{get:n=>{if(!e(n))throw Error("Can only get "+t+" value of a "+t+" node");return r(n).getOr("")},getOption:r,set:(r,n)=>{if(!e(r))throw Error("Can only set raw "+t+" value of a "+t+" node");r.dom.nodeValue=n}}})(rf,"text"),oz=e=>oU.get(e),oj=e=>oU.getOption(e),oH=(e,t)=>oU.set(e,t),o$=["pre"].concat(["h1","h2","h3","h4","h5","h6"]),oq=e=>{let t;return r=>eG(t=t||eD(e,eo),ri(r))},oV=oq(["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"]),oW=e=>"table"===ri(e),oK=e=>ru(e)&&!oV(e),oG=e=>ru(e)&&"br"===ri(e),oY=oq(["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"]),oX=oq(["ul","ol","dl"]),oQ=oq(["li","dd","dt"]),oJ=oq(["thead","tbody","tfoot"]),oZ=oq(["td","th"]),o0=oq(["pre","script","textarea","style"]),o1=oq(o$),o2=e=>o1(e)||oK(e),o3=e=>{let t=[],r=e.dom;for(;r;)t.push(rz.fromDom(r)),r=r.lastChild;return t},o8=e=>{let t=oi(e,"br"),r=eb(o3(e).slice(-1),oG);t.length===r.length&&eg(r,nV)},o5=()=>{let e=rz.fromTag("br");return rv(e,"data-mce-bogus","1"),e},o6=e=>{nq(e),nz(e,o5())},o9=e=>{r7(e).each(t=>{r2(t).each(r=>{oV(e)&&oG(t)&&oV(r)&&nV(t)})})},o4=e=>e.replace(/\uFEFF/g,""),o7=e=>(ow(e)&&(e=e.parentNode),ou(e)&&e.hasAttribute("data-mce-caret")),ae=e=>ow(e)&&oI(e.data),at=e=>o7(e)||ae(e),ar=e=>e.firstChild!==e.lastChild||!oD(e.firstChild),an=(e,t)=>{var r;let n=(null!==(r=e.ownerDocument)&&void 0!==r?r:document).createTextNode("\uFEFF"),o=e.parentNode;if(t){let t=e.previousSibling;if(ow(t)){if(at(t))return t;if(as(t))return t.splitText(t.data.length-1)}null==o||o.insertBefore(n,e)}else{let t=e.nextSibling;if(ow(t)){if(at(t))return t;if(ai(t))return t.splitText(1),t}e.nextSibling?null==o||o.insertBefore(n,e.nextSibling):null==o||o.appendChild(n)}return n},ao=e=>{let t=e.container();return!!ow(t)&&("\uFEFF"===t.data.charAt(e.offset())||e.isAtStart()&&ae(t.previousSibling))},aa=e=>{let t=e.container();return!!ow(t)&&("\uFEFF"===t.data.charAt(e.offset()-1)||e.isAtEnd()&&ae(t.nextSibling))},al=(e,t,r)=>{var n;let o=(null!==(n=t.ownerDocument)&&void 0!==n?n:document).createElement(e);o.setAttribute("data-mce-caret",r?"before":"after"),o.setAttribute("data-mce-bogus","all"),o.appendChild(o5().dom);let a=t.parentNode;return r?null==a||a.insertBefore(o,t):t.nextSibling?null==a||a.insertBefore(o,t.nextSibling):null==a||a.appendChild(o),o},ai=e=>ow(e)&&"\uFEFF"===e.data[0],as=e=>ow(e)&&"\uFEFF"===e.data[e.data.length-1],ad=e=>{var t;let r=e.getElementsByTagName("br"),n=r[r.length-1];ob(n)&&(null===(t=n.parentNode)||void 0===t||t.removeChild(n))},ac=e=>e&&e.hasAttribute("data-mce-caret")?(ad(e),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("data-mce-style"),e.removeAttribute("_moz_abspos"),e):null,am=e=>o7(e.startContainer),au=og(["script","style","textarea"]),af=og(["img","input","textarea","hr","iframe","video","audio","object","embed"]),ag=og(["table"]),ap=e=>!at(e)&&(ow(e)?!au(e.parentNode):af(e)||oD(e)||ag(e)||ab(e)),ah=e=>ou(e)&&"true"===e.getAttribute("unselectable"),ab=e=>!ah(e)&&oO(e),av=(e,t)=>{for(let r=e.parentNode;r&&r!==t;r=r.parentNode){if(ab(r))return!1;if(oA(r))break}return!0},ay=e=>!!ab(e)&&!ey(eB(e.getElementsByTagName("*")),(e,t)=>e||oA(t),!1),aC=(e,t)=>ap(e)&&av(e,t),ax=/^[ \t\r\n]*$/,aw=e=>ax.test(e),aE=e=>{for(let t of e)if(!oI(t))return!1;return!0},ak=e=>-1!==" \f	\v".indexOf(e),aS=e=>"\n"===e||"\r"===e,a_=(e,t)=>t<e.length&&t>=0&&aS(e[t]),aN=(e,t=4,r=!0,n=!0)=>{let o=ty(" ",t),a=e.replace(/\t/g,o);return ey(a,(e,t)=>ak(t)||"\xa0"===t?e.pcIsSpace||""===e.str&&r||e.str.length===a.length-1&&n||a_(a,e.str.length+1)?{pcIsSpace:!1,str:e.str+"\xa0"}:{pcIsSpace:!0,str:e.str+" "}:{pcIsSpace:aS(t),str:e.str+t},{pcIsSpace:!1,str:""}).str},aD=(e,t)=>{let r=rz.fromDom(t);return os(rz.fromDom(e),"pre,code",J(rW,r))},aR=(e,t)=>ow(e)&&aw(e.data)&&!aD(e,t),aA=e=>ou(e)&&"A"===e.nodeName&&!e.hasAttribute("href")&&(e.hasAttribute("name")||e.hasAttribute("id")),aO=(e,t)=>ap(e)&&!aR(e,t)||aA(e)||aT(e),aT=oh("data-mce-bookmark"),aB=oh("data-mce-bogus"),aP=(o="data-mce-bogus",e=>ou(e)&&"all"===e.getAttribute(o)),aL=(e,t)=>{let r=0;if(aO(e,e))return!1;{let n=e.firstChild;if(!n)return!0;let o=new od(n,e);do{if(t){if(aP(n)){n=o.next(!0);continue}if(aB(n)){n=o.next();continue}}if(oD(n)){r++,n=o.next();continue}if(aO(n,e))return!1;n=o.next()}while(n);return r<=1}},aF=(e,t=!0)=>aL(e.dom,t),aM="data-mce-block",aI=e=>eb(eF(e),e=>!/[A-Z]/.test(e)),aU=e=>aI(e).join(","),az=(e,t)=>H(t.querySelector(e))?(t.setAttribute(aM,"true"),"inline-boundary"===t.getAttribute("data-mce-selected")&&t.removeAttribute("data-mce-selected"),!0):(t.removeAttribute(aM),!1),aj=(e,t)=>{let r=aU(e.getTransparentElements()),n=aU(e.getBlockElements());return eb(t.querySelectorAll(r),e=>az(n,e))},aH=(e,t)=>{var r;let n=t?"lastChild":"firstChild";for(let t=e[n];t;t=t[n])if(aF(rz.fromDom(t))){null===(r=t.parentNode)||void 0===r||r.removeChild(t);return}},a$=(e,t)=>{let r=document.createRange(),n=e.parentNode;if(n){r.setStartBefore(e),r.setEndBefore(t);let o=r.extractContents();aH(o,!0),r.setStartAfter(t),r.setEndAfter(e);let a=r.extractContents();aH(a,!1),aF(rz.fromDom(o))||n.insertBefore(o,e),aF(rz.fromDom(t))||n.insertBefore(t,e),aF(rz.fromDom(a))||n.insertBefore(a,e),n.removeChild(e)}},aq=(e,t,r)=>{let n=e.getBlockElements(),o=rz.fromDom(t),a=e=>ri(e) in n,l=e=>rW(e,o);eg(nG(r),t=>{np(t,a,l).each(r=>{let n=oa(t,t=>a(t)&&!e.isValidChild(ri(r),ri(t)));if(n.length>0){let t=rZ(r);eg(n,e=>{np(e,a,l).each(t=>{a$(t.dom,e.dom)})}),t.each(t=>aj(e,t.dom))}})})},aV=(e,t,r)=>{eg([...r,...aJ(e,t)?[t]:[]],t=>eg(oi(rz.fromDom(t),t.nodeName.toLowerCase()),t=>{aZ(e,t.dom)&&nW(t)}))},aW=(e,t)=>{let r=aj(e,t);aq(e,t,r),aV(e,t,r)},aK=(e,t)=>{aQ(e,t)&&az(aU(e.getBlockElements()),t)},aG=(e,t,r)=>{let n=r0(rz.fromDom(r),e=>rW(e,rz.fromDom(t)));eA(n,n.length-2).filter(ru).fold(()=>aW(e,t),t=>aW(e,t.dom))},aY=e=>e.hasAttribute(aM),aX=(e,t)=>eG(e.getTransparentElements(),t),aQ=(e,t)=>ou(t)&&aX(e,t.nodeName),aJ=(e,t)=>aQ(e,t)&&aY(t),aZ=(e,t)=>aQ(e,t)&&!aY(t),a0=(e,t)=>1===t.type&&aX(e,t.name)&&P(t.attr(aM)),a1=tV().browser,a2=e=>ex(e,ru),a3=e=>a1.isFirefox()&&"table"===ri(e)?a2(r6(e)).filter(e=>"caption"===ri(e)).bind(e=>a2(r5(e)).map(t=>{let r=t.dom.offsetTop,n=e.dom.offsetTop,o=e.dom.offsetHeight;return r<=n?-o:0})).getOr(0):0,a8=(e,t)=>e.children&&em(e.children,t),a5=(e,t,r)=>{let n=0,o=0,a=e.ownerDocument;if(r=r||e,t){if(r===e&&t.getBoundingClientRect&&"static"===nO(rz.fromDom(e),"position")){let r=t.getBoundingClientRect();return{x:n=r.left+(a.documentElement.scrollLeft||e.scrollLeft)-a.documentElement.clientLeft,y:o=r.top+(a.documentElement.scrollTop||e.scrollTop)-a.documentElement.clientTop}}let l=t;for(;l&&l!==r&&l.nodeType&&!a8(l,r);){let e=l;n+=e.offsetLeft||0,o+=e.offsetTop||0,l=e.offsetParent}for(l=t.parentNode;l&&l!==r&&l.nodeType&&!a8(l,r);)n-=l.scrollLeft||0,o-=l.scrollTop||0,l=l.parentNode;o+=a3(rz.fromDom(t))}return{x:n,y:o}},a6=(e,t={})=>{let r=0,n={},o=rz.fromDom(e),a=rY(o),l=e=>{nz(ni(o),e)},i=e=>{nx(ni(o),"#"+e).each(nV)},s=e=>eK(n,e).getOrThunk(()=>({id:"mce-u"+r++,passed:[],failed:[],count:0})),d=e=>new Promise((r,o)=>{let i;let d=t2._addCacheSuffix(e),c=s(d);n[d]=c,c.count++;let m=(e,t)=>{eg(e,er),c.status=t,c.passed=[],c.failed=[],i&&(i.onload=null,i.onerror=null,i=null)},u=()=>m(c.passed,2),f=()=>m(c.failed,3);if(r&&c.passed.push(r),o&&c.failed.push(o),1===c.status)return;if(2===c.status){u();return}if(3===c.status){f();return}c.status=1;let g=rz.fromTag("link",a.dom);ry(g,{rel:"stylesheet",type:"text/css",id:c.id}),t.contentCssCors&&rv(g,"crossOrigin","anonymous"),t.referrerPolicy&&rv(g,"referrerpolicy",t.referrerPolicy),(i=g.dom).onload=u,i.onerror=f,l(g),rv(g,"href",d)}),c=e=>{let t=t2._addCacheSuffix(e);eK(n,t).each(e=>{0==--e.count&&(delete n[t],i(e.id))})};return{load:d,loadAll:e=>Promise.allSettled(ef(e,e=>d(e).then(Y(e)))).then(e=>{let t=eh(e,e=>"fulfilled"===e.status);return t.fail.length>0?Promise.reject(ef(t.fail,e=>e.reason)):ef(t.pass,e=>e.value)}),unload:c,unloadAll:e=>{eg(e,e=>{c(e)})},_setReferrerPolicy:e=>{t.referrerPolicy=e},_setContentCssCors:e=>{t.contentCssCors=e}}},a9=(()=>{let e=new WeakMap;return{forElement:(t,r)=>{let n=nl(t).dom;return ea.from(e.get(n)).getOrThunk(()=>{let t=a6(n,r);return e.set(n,t),t})}}})(),a4=e=>"span"===e.nodeName.toLowerCase(),a7=(e,t)=>H(e)&&(aO(e,t)||oK(rz.fromDom(e))),le=(e,t)=>{let r=new od(e,t).prev(!1),n=new od(e,t).next(!1),o=z(r)||a7(r,t),a=z(n)||a7(n,t);return o&&a},lt=e=>a4(e)&&"bookmark"===e.getAttribute("data-mce-type"),lr=(e,t)=>ow(e)&&e.data.length>0&&le(e,t),ln=e=>!!ou(e)&&e.childNodes.length>0,lo=e=>oN(e)||o_(e),la=(e,t,r)=>{var n;let o=r||t;if(ou(t)&&lt(t))return t;let a=t.childNodes;for(let t=a.length-1;t>=0;t--)la(e,a[t],o);if(ou(t)){let e=t.childNodes;1===e.length&&lt(e[0])&&(null===(n=t.parentNode)||void 0===n||n.insertBefore(e[0],t))}return lo(t)||aO(t,o)||ln(t)||lr(t,o)||e.remove(t),t},ll=t2.makeMap,li=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,ls=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,ld=/[<>&\"\']/g,lc=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,lm={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},lu={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},lf={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},lg=e=>{let t=rz.fromTag("div").dom;return t.innerHTML=e,t.textContent||t.innerText||e},lp=(e,t)=>{let r={};if(e){let n=e.split(",");t=t||10;for(let e=0;e<n.length;e+=2){let o=String.fromCharCode(parseInt(n[e],t));if(!lu[o]){let t="&"+n[e+1]+";";r[o]=t,r[t]=o}}return r}},lh=lp("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),lb=(e,t)=>e.replace(t?li:ls,e=>lu[e]||e),lv=(e,t)=>e.replace(t?li:ls,e=>e.length>1?"&#"+((e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320)+65536)+";":lu[e]||"&#"+e.charCodeAt(0)+";"),ly=(e,t,r)=>{let n=r||lh;return e.replace(t?li:ls,e=>lu[e]||n[e]||e)},lC={encodeRaw:lb,encodeAllRaw:e=>(""+e).replace(ld,e=>lu[e]||e),encodeNumeric:lv,encodeNamed:ly,getEncodeFunc:(e,t)=>{let r=lp(t)||lh,n=ll(e.replace(/\+/g,","));return n.named&&n.numeric?(e,t)=>e.replace(t?li:ls,e=>void 0!==lu[e]?lu[e]:void 0!==r[e]?r[e]:e.length>1?"&#"+((e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320)+65536)+";":"&#"+e.charCodeAt(0)+";"):n.named?t?(e,t)=>ly(e,t,r):ly:n.numeric?lv:lb},decode:e=>e.replace(lc,(e,t)=>t?(t="x"===t.charAt(0).toLowerCase()?parseInt(t.substr(1),16):parseInt(t,10))>65535?String.fromCharCode(55296+((t-=65536)>>10),56320+(1023&t)):lm[t]||String.fromCharCode(t):lf[e]||lh[e]||lg(e))},lx=(e,t)=>(e=t2.trim(e))?e.split(t||" "):[],lw=e=>RegExp("^"+e.replace(/([?+*])/g,".$1")+"$"),lE=e=>{let t=/^(~)?(.+)$/;return ek(lx(e,","),e=>{let r=t.exec(e);if(!r)return[];{let e="~"===r[1];return[{inline:e,cloneName:e?"span":"div",name:r[2]}]}})},lk=e=>{let t,r,n,o;return t="id accesskey class dir lang style tabindex title role",r="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",n="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==e&&(t+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",r+=" article aside details dialog figure main header footer hgroup section nav a ins del canvas map",n+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==e&&(t+=" xml:lang",n=[n,"acronym applet basefont big font strike tt"].join(" "),o=[r=[r,"center dir isindex noframes"].join(" "),n].join(" ")),o=o||[r,n].join(" "),{globalAttributes:t,blockContent:r,phrasingContent:n,flowContent:o}},lS=e=>{let{globalAttributes:t,phrasingContent:r,flowContent:n}=lk(e),o={},a=(e,r="",n="")=>{let a=lx(n),l=lx(e),i=l.length;for(;i--;){let e=lx([t,r].join(" "));o[l[i]]={attributes:eD(e,Y({})),attributesOrder:e,children:eD(a,Y({}))}}},l=(e,t)=>{let r=lx(e),n=lx(t),a=r.length;for(;a--;){let e=o[r[a]];for(let t=0,r=n.length;t<r;t++)e.attributes[n[t]]={},e.attributesOrder.push(n[t])}};return"html5-strict"!==e&&(eg(lx("acronym applet basefont big font strike tt"),e=>{a(e,"",r)}),eg(lx("center dir isindex noframes"),e=>{a(e,"",n)})),a("html","manifest","head body"),a("head","","base command link meta noscript script style title"),a("title hr noscript br"),a("base","href target"),a("link","href rel media hreflang type sizes hreflang"),a("meta","name http-equiv content charset"),a("style","media type scoped"),a("script","src async defer type charset"),a("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",n),a("dd div","",n),a("address dt caption","","html4"===e?r:n),a("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",r),a("blockquote","cite",n),a("ol","reversed start type","li"),a("ul","","li"),a("li","value",n),a("dl","","dt dd"),a("a","href target rel media hreflang type","html4"===e?r:n),a("q","cite",r),a("ins del","cite datetime",n),a("img","src sizes srcset alt usemap ismap width height"),a("iframe","src name width height",n),a("embed","src type width height"),a("object","data type typemustmatch name usemap form width height",[n,"param"].join(" ")),a("param","name value"),a("map","name",[n,"area"].join(" ")),a("area","alt coords shape href target rel media hreflang type"),a("table","border","caption colgroup thead tfoot tbody tr"+("html4"===e?" col":"")),a("colgroup","span","col"),a("col","span"),a("tbody thead tfoot","","tr"),a("tr","","td th"),a("td","colspan rowspan headers",n),a("th","colspan rowspan headers scope abbr",n),a("form","accept-charset action autocomplete enctype method name novalidate target",n),a("fieldset","disabled form name",[n,"legend"].join(" ")),a("label","form for",r),a("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),a("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===e?n:r),a("select","disabled form multiple name required size","option optgroup"),a("optgroup","disabled label","option"),a("option","disabled label selected value"),a("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),a("menu","type label",[n,"li"].join(" ")),a("noscript","",n),"html4"!==e&&(a("wbr"),a("ruby","",[r,"rt rp"].join(" ")),a("figcaption","",n),a("mark rt rp summary bdi","",r),a("canvas","width height",n),a("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[n,"track source"].join(" ")),a("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[n,"track source"].join(" ")),a("picture","","img source"),a("source","src srcset type media sizes"),a("track","kind src srclang label default"),a("datalist","",[r,"option"].join(" ")),a("article section nav aside main header footer","",n),a("hgroup","","h1 h2 h3 h4 h5 h6"),a("figure","",[n,"figcaption"].join(" ")),a("time","datetime",r),a("dialog","open",n),a("command","type label icon disabled checked radiogroup command"),a("output","for form name",r),a("progress","value max",r),a("meter","value min max low high optimum",r),a("details","open",[n,"summary"].join(" ")),a("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==e&&(l("script","language xml:space"),l("style","xml:space"),l("object","declare classid code codebase codetype archive standby align border hspace vspace"),l("embed","align name hspace vspace"),l("param","valuetype type"),l("a","charset name rev shape coords"),l("br","clear"),l("applet","codebase archive code object alt name width height align hspace vspace"),l("img","name longdesc align border hspace vspace"),l("iframe","longdesc frameborder marginwidth marginheight scrolling align"),l("font basefont","size color face"),l("input","usemap align"),l("select"),l("textarea"),l("h1 h2 h3 h4 h5 h6 div p legend caption","align"),l("ul","type compact"),l("li","type"),l("ol dl menu dir","compact"),l("pre","width xml:space"),l("hr","align noshade size width"),l("isindex","prompt"),l("table","summary width frame rules cellspacing cellpadding align bgcolor"),l("col","width align char charoff valign"),l("colgroup","width align char charoff valign"),l("thead","align char charoff valign"),l("tr","align char charoff valign bgcolor"),l("th","axis align char charoff valign nowrap bgcolor width height"),l("form","accept"),l("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),l("tfoot","align char charoff valign"),l("tbody","align char charoff valign"),l("area","nohref"),l("body","background bgcolor text link vlink alink")),"html4"!==e&&(l("input button select textarea","autofocus"),l("input textarea","placeholder"),l("a","download"),l("link script img","crossorigin"),l("img","loading"),l("iframe","sandbox seamless allow allowfullscreen loading")),"html4"!==e&&eg([o.video,o.audio],e=>{delete e.children.audio,delete e.children.video}),eg(lx("a form meter progress dfn"),e=>{o[e]&&delete o[e].children[e]}),delete o.caption.children.table,delete o.script,o},l_=e=>"-"===e?"remove":"add",lN=e=>{let t=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;return ek(lx(e,","),e=>{let r=t.exec(e);if(!r)return[];{let e=r[1];return[{operation:e?l_(e):"replace",name:r[2],validChildren:lx(r[3],"|")}]}})},lD=(e,t)=>{let r=/^([!\-])?(\w+[\\:]:\w+|[^=~<]+)?(?:([=~<])(.*))?$/,n=/[*?+]/,{attributes:o,attributesOrder:a}=t;return eg(lx(e,"|"),e=>{let l=r.exec(e);if(l){let e={},r=l[1],i=l[2].replace(/[\\:]:/g,":"),s=l[3],d=l[4];if("!"===r&&(t.attributesRequired=t.attributesRequired||[],t.attributesRequired.push(i),e.required=!0),"-"===r){delete o[i],a.splice(t2.inArray(a,i),1);return}s&&("="===s?(t.attributesDefault=t.attributesDefault||[],t.attributesDefault.push({name:i,value:d}),e.defaultValue=d):"~"===s?(t.attributesForced=t.attributesForced||[],t.attributesForced.push({name:i,value:d}),e.forcedValue=d):"<"===s&&(e.validValues=t2.makeMap(d,"?"))),n.test(i)?(t.attributePatterns=t.attributePatterns||[],e.pattern=lw(i),t.attributePatterns.push(e)):(o[i]||a.push(i),o[i]=e)}})},lR=(e,t)=>{eI(e.attributes,(e,r)=>{t.attributes[r]=e}),t.attributesOrder.push(...e.attributesOrder)},lA=(e,t)=>{let r=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/;return ek(lx(t,","),t=>{let n=r.exec(t);if(!n)return[];{let t=n[1],r=n[2],o=n[3],a=n[4],l=n[5],i={attributes:{},attributesOrder:[]};if(e.each(e=>lR(e,i)),"#"===t?i.paddEmpty=!0:"-"===t&&(i.removeEmpty=!0),"!"===a&&(i.removeEmptyAttrs=!0),l&&lD(l,i),o&&(i.outputName=r),"@"===r){if(!e.isNone())return[];e=ea.some(i)}return[o?{name:r,element:i,aliasName:o}:{name:r,element:i}]}})},lO={},lT=t2.makeMap,lB=t2.each,lP=t2.extend,lL=t2.explode,lF=(e,t={})=>lP(lT(e," ",lT(e.toUpperCase()," ")),t),lM=e=>lF("td th li dt dd figcaption caption details summary",e.getTextBlockElements()),lI=(e,t)=>{if(e){let r={};return P(e)&&(e={"*":e}),lB(e,(e,n)=>{r[n]=r[n.toUpperCase()]="map"===t?lT(e,/[, ]/):lL(e,/[, ]/)}),r}},lU=(e={})=>{var t;let r={},n={},o=[],a={},l={},i=(t,r,n)=>{let o=e[t];if(o)return lT(o,/[, ]/,lT(o.toUpperCase(),/[, ]/));{let e=lO[t];return e||(e=lF(r,n),lO[t]=e),e}},s=null!==(t=e.schema)&&void 0!==t?t:"html5",d=lS(s);!1===e.verify_html&&(e.valid_elements="*[*]");let c=lI(e.valid_styles),m=lI(e.invalid_styles,"map"),u=lI(e.valid_classes,"map"),f=i("whitespace_elements","pre script noscript style textarea video audio iframe object code"),g=i("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),p=i("void_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),h=i("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls allowfullscreen"),b="td th iframe video audio object script code",v=i("non_empty_elements",b+" pre",p),y=i("move_caret_before_on_enter_elements",b+" table",p),C=i("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),x=i("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",C),w=i("text_inline_elements","span strong b em i font s strike u var cite dfn code mark q sup sub samp"),E=i("transparent_elements","a ins del canvas map");lB("script noscript iframe noframes noembed title style textarea xmp plaintext".split(" "),e=>{l[e]=RegExp("</"+e+"[^>]*>","gi")});let k=e=>{let t=ea.from(r["@"]),n=/[*?+]/;eg(lA(t,null!=e?e:""),({name:e,element:t,aliasName:a})=>{a&&(r[a]=t),n.test(e)?(t.pattern=lw(e),o.push(t)):r[e]=t})},S=e=>{o=[],eg(eF(r),e=>{delete r[e]}),k(e)},_=e=>{delete lO.text_block_elements,delete lO.block_elements,eg(lE(null!=e?e:""),({inline:e,name:t,cloneName:o})=>{if(n[t]=n[o],a[t]=o,v[t.toUpperCase()]={},v[t]={},e||(x[t.toUpperCase()]={},x[t]={}),!r[t]){let e=r[o];e=lP({},e),delete e.removeEmptyAttrs,delete e.removeEmpty,r[t]=e}eI(n,(e,r)=>{e[o]&&(n[r]=e=lP({},n[r]),e[t]=e[o])})})},N=e=>{eg(lN(null!=e?e:""),({operation:e,name:t,validChildren:r})=>{let o="replace"===e?{"#comment":{}}:n[t];eg(r,t=>{"remove"===e?delete o[t]:o[t]={}}),n[t]=o})},D=e=>{let t=r[e];if(t)return t;let n=o.length;for(;n--;){let t=o[n];if(t.pattern.test(e))return t}};e.valid_elements?(S(e.valid_elements),lB(d,(e,t)=>{n[t]=e.children})):(lB(d,(e,t)=>{r[t]={attributes:e.attributes,attributesOrder:e.attributesOrder},n[t]=e.children}),lB(lx("strong/b em/i"),e=>{let t=lx(e,"/");r[t[1]].outputName=t[0]}),lB(w,(t,n)=>{r[n]&&(e.padd_empty_block_inline_children&&(r[n].paddInEmptyBlock=!0),r[n].removeEmpty=!0)}),lB(lx("ol ul blockquote a table tbody"),e=>{r[e]&&(r[e].removeEmpty=!0)}),lB(lx("p h1 h2 h3 h4 h5 h6 th td pre div address caption li summary"),e=>{r[e]&&(r[e].paddEmpty=!0)}),lB(lx("span"),e=>{r[e].removeEmptyAttrs=!0})),_(e.custom_elements),N(e.valid_children),k(e.extended_valid_elements),N("+ol[ul|ol],+ul[ul|ol]"),lB({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(e,t)=>{r[t]&&(r[t].parentsRequired=lx(e))}),e.invalid_elements&&lB(lL(e.invalid_elements),e=>{r[e]&&delete r[e]}),D("span")||k("span[!data-mce-type|*]");let R=Y(c),A=Y(m),O=Y(u),T=Y(h),B=Y(x),P=Y(C),L=Y(w),F=Y(Object.seal(p)),M=Y(g),I=Y(v),U=Y(y),z=Y(f);return{type:s,children:n,elements:r,getValidStyles:R,getValidClasses:O,getBlockElements:B,getInvalidStyles:A,getVoidElements:F,getTextBlockElements:P,getTextInlineElements:L,getBoolAttrs:T,getElementRule:D,getSelfClosingElements:M,getNonEmptyElements:I,getMoveCaretBeforeOnEnterElements:U,getWhitespaceElements:z,getTransparentElements:Y(E),getSpecialElements:Y(Object.seal(l)),isValidChild:(e,t)=>{let r=n[e.toLowerCase()];return!!(r&&r[t.toLowerCase()])},isValid:(e,t)=>{let r=D(e);if(r){if(!t)return!0;{if(r.attributes[t])return!0;let e=r.attributePatterns;if(e){let r=e.length;for(;r--;)if(e[r].pattern.test(t))return!0}}}return!1},getCustomElements:Y(a),addValidElements:k,setValidElements:S,addCustomElements:_,addValidChildren:N}},lz=(e={},t)=>{let r,n;let o=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,a=/\s*([^:]+):\s*([^;]+);?/g,l=/\s+$/,i={};t&&(r=t.getValidStyles(),n=t.getInvalidStyles());let s="\\\" \\' \\; \\: ; : \uFEFF".split(" ");for(let e=0;e<s.length;e++)i[s[e]]="\uFEFF"+e,i["\uFEFF"+e]=s[e];let d={parse:t=>{let r={},n=!1,s=e.url_converter,c=e.url_converter_scope||d,m=(e,t,n)=>{let o=r[e+"-top"+t];if(!o)return;let a=r[e+"-right"+t];if(!a)return;let l=r[e+"-bottom"+t];if(!l)return;let i=r[e+"-left"+t];if(!i)return;let s=[o,a,l,i],d=s.length-1;for(;d--&&s[d]===s[d+1];);d>-1&&n||(r[e+t]=-1===d?s[0]:s.join(" "),delete r[e+"-top"+t],delete r[e+"-right"+t],delete r[e+"-bottom"+t],delete r[e+"-left"+t])},u=e=>{let t=r[e];if(!t)return;let n=t.indexOf(",")>-1?[t]:t.split(" "),o=n.length;for(;o--;)if(n[o]!==n[0])return!1;return r[e]=n[0],!0},f=e=>(n=!0,i[e]),g=(e,t)=>(n&&(e=e.replace(/\uFEFF[0-9]/g,e=>i[e])),t||(e=e.replace(/\\([\'\";:])/g,"$1")),e),p=e=>String.fromCharCode(parseInt(e.slice(1),16)),h=e=>e.replace(/\\[0-9a-f]+/gi,p),b=(t,r,n,o,a,l)=>{if(a=a||l)return"'"+(a=g(a)).replace(/\'/g,"\\'")+"'";if(r=g(r||n||o||""),!e.allow_script_urls){let t=r.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(t)||!e.allow_svg_data_urls&&/^data:image\/svg/i.test(t))return""}return s&&(r=s.call(c,r,"style")),"url('"+r.replace(/\'/g,"\\'")+"')"};if(t){var v,y,C;let i;for(t=(t=t.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,f).replace(/\"[^\"]+\"|\'[^\']+\'/g,e=>e.replace(/[;:]/g,f));i=a.exec(t);){a.lastIndex=i.index+i[0].length;let t=i[1].replace(l,"").toLowerCase(),s=i[2].replace(l,"");if(t&&s){if(t=h(t),s=h(s),-1!==t.indexOf("\uFEFF")||-1!==t.indexOf('"')||!e.allow_script_urls&&("behavior"===t||/expression\s*\(|\/\*|\*\//.test(s)))continue;"font-weight"===t&&"700"===s?s="bold":("color"===t||"background-color"===t)&&(s=s.toLowerCase()),s=s.replace(o,b),r[t]=n?g(s,!0):s}}m("border","",!0),m("border","-width"),m("border","-color"),m("border","-style"),m("padding",""),m("margin",""),y="border-style",C="border-color",u(v="border-width")&&u(y)&&u(C)&&(r.border=r[v]+" "+r[y]+" "+r[C],delete r[v],delete r[y],delete r[C]),"medium none"===r.border&&delete r.border,"none"===r["border-image"]&&delete r["border-image"]}return r},serialize:(e,t)=>{let o="",a=(t,r)=>{let n=r[t];if(n)for(let t=0,r=n.length;t<r;t++){let r=n[t],a=e[r];a&&(o+=(o.length>0?" ":"")+r+": "+a+";")}},l=(e,t)=>{if(!n||!t)return!0;let r=n["*"];return(!r||!r[e])&&!((r=n[t])&&r[e])};return t&&r?(a("*",r),a(t,r)):eI(e,(e,r)=>{e&&l(r,t)&&(o+=(o.length>0?" ":"")+r+": "+e+";")}),o}};return d},lj={keyLocation:!0,layerX:!0,layerY:!0,returnValue:!0,webkitMovementX:!0,webkitMovementY:!0,keyIdentifier:!0,mozPressure:!0},lH=e=>e instanceof Event||$(e.initEvent),l$=e=>e.isDefaultPrevented===eo||e.isDefaultPrevented===en,lq=e=>j(e.preventDefault)||lH(e),lV=(e,t)=>{let r=null!=t?t:{};for(let t in e)eG(lj,t)||(r[t]=e[t]);return H(e.composedPath)&&(r.composedPath=()=>e.composedPath()),H(e.getModifierState)&&(r.getModifierState=t=>e.getModifierState(t)),r},lW=(e,t,r,n)=>{var o;let a=lV(t,n);return a.type=e,j(a.target)&&(a.target=null!==(o=a.srcElement)&&void 0!==o?o:r),lq(t)&&(a.preventDefault=()=>{a.defaultPrevented=!0,a.isDefaultPrevented=eo,$(t.preventDefault)&&t.preventDefault()},a.stopPropagation=()=>{a.cancelBubble=!0,a.isPropagationStopped=eo,$(t.stopPropagation)&&t.stopPropagation()},a.stopImmediatePropagation=()=>{a.isImmediatePropagationStopped=eo,a.stopPropagation()},l$(a)||(a.isDefaultPrevented=!0===a.defaultPrevented?eo:en,a.isPropagationStopped=!0===a.cancelBubble?eo:en,a.isImmediatePropagationStopped=en)),a},lK=/^(?:mouse|contextmenu)|click/,lG=(e,t,r,n)=>{e.addEventListener(t,r,n||!1)},lY=(e,t,r,n)=>{e.removeEventListener(t,r,n||!1)},lX=e=>H(e)&&lK.test(e.type),lQ=(e,t)=>{let r=lW(e.type,e,document,t);if(lX(e)&&z(e.pageX)&&!z(e.clientX)){let t=r.target.ownerDocument||document,n=t.documentElement,o=t.body;r.pageX=e.clientX+(n&&n.scrollLeft||o&&o.scrollLeft||0)-(n&&n.clientLeft||o&&o.clientLeft||0),r.pageY=e.clientY+(n&&n.scrollTop||o&&o.scrollTop||0)-(n&&n.clientTop||o&&o.clientTop||0)}return r},lJ=(e,t,r)=>{let n=e.document,o={type:"ready"};if(r.domLoaded){t(o);return}let a=()=>{lY(e,"DOMContentLoaded",a),lY(e,"load",a),r.domLoaded||(r.domLoaded=!0,t(o)),e=null};"complete"===n.readyState||"interactive"===n.readyState&&n.body?a():lG(e,"DOMContentLoaded",a),r.domLoaded||lG(e,"load",a)};class lZ{constructor(){this.domLoaded=!1,this.events={},this.count=1,this.expando="mce-data-"+(+new Date).toString(32),this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}bind(e,t,r,n){let o,a;let l=this,i=window,s=e=>{l.executeHandlers(lQ(e||i.event),a)};if(!e||ow(e)||oS(e))return r;e[l.expando]?a=e[l.expando]:(a=l.count++,e[l.expando]=a,l.events[a]={}),n=n||e;let d=t.split(" "),c=d.length;for(;c--;){let t=d[c],m=s,u=!1,f=!1;if("DOMContentLoaded"===t&&(t="ready"),l.domLoaded&&"ready"===t&&"complete"===e.readyState){r.call(n,lQ({type:t}));continue}l.hasFocusIn||"focusin"!==t&&"focusout"!==t||(u=!0,f="focusin"===t?"focus":"blur",m=e=>{let t=lQ(e||i.event);t.type="focus"===t.type?"focusin":"focusout",l.executeHandlers(t,a)}),(o=l.events[a][t])?"ready"===t&&l.domLoaded?r(lQ({type:t})):o.push({func:r,scope:n}):(l.events[a][t]=o=[{func:r,scope:n}],o.fakeName=f,o.capture=u,o.nativeHandler=m,"ready"===t?lJ(e,m,l):lG(e,f||t,m,u))}return e=o=null,r}unbind(e,t,r){if(!e||ow(e)||oS(e))return this;let n=e[this.expando];if(n){let o=this.events[n];if(t){let n=t.split(" "),a=n.length;for(;a--;){let t=n[a],l=o[t];if(l){if(r){let e=l.length;for(;e--;)if(l[e].func===r){let r=l.nativeHandler,n=l.fakeName,a=l.capture,i=l.slice(0,e).concat(l.slice(e+1));i.nativeHandler=r,i.fakeName=n,i.capture=a,o[t]=i}}r&&0!==l.length||(delete o[t],lY(e,l.fakeName||t,l.nativeHandler,l.capture))}}}else eI(o,(t,r)=>{lY(e,t.fakeName||r,t.nativeHandler,t.capture)}),o={};for(let e in o)if(eG(o,e))return this;delete this.events[n];try{delete e[this.expando]}catch(t){e[this.expando]=null}}return this}fire(e,t,r){return this.dispatch(e,t,r)}dispatch(e,t,r){if(!e||ow(e)||oS(e))return this;let n=lQ({type:t,target:e},r);do{let t=e[this.expando];t&&this.executeHandlers(n,t),e=e.parentNode||e.ownerDocument||e.defaultView||e.parentWindow}while(e&&!n.isPropagationStopped());return this}clean(e){if(!e||ow(e)||oS(e))return this;if(e[this.expando]&&this.unbind(e),e.getElementsByTagName||(e=e.document),e&&e.getElementsByTagName){this.unbind(e);let t=e.getElementsByTagName("*"),r=t.length;for(;r--;)(e=t[r])[this.expando]&&this.unbind(e)}return this}destroy(){this.events={}}cancel(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1}executeHandlers(e,t){let r=this.events[t],n=r&&r[e.type];if(n)for(let t=0,r=n.length;t<r;t++){let r=n[t];if(r&&!1===r.func.call(r.scope,e)&&e.preventDefault(),e.isImmediatePropagationStopped())return}}}lZ.Event=new lZ;let l0=t2.each,l1=t2.grep,l2="data-mce-style",l3=t2.makeMap("fill-opacity font-weight line-height opacity orphans widows z-index zoom"," "),l8=(e,t,r)=>{j(r)||""===r?rE(e,t):rv(e,t,r)},l5=e=>e.replace(/[A-Z]/g,e=>"-"+e.toLowerCase()),l6=(e,t)=>{let r=0;if(e)for(let n=e.nodeType,o=e.previousSibling;o;o=o.previousSibling){let e=o.nodeType;(!(t&&ow(o))||e!==n&&o.data.length)&&(r++,n=e)}return r},l9=(e,t)=>{let r=rC(t,"style"),n=e.serialize(e.parse(r),ri(t));l8(t,l2,n)},l4=(e,t)=>q(e)?eG(l3,t)?e+"":e+"px":e,l7=(e,t,r)=>{let n=l5(t);j(r)||""===r?nL(e,n):nR(e,n,l4(r,n))},ie=(e,t,r)=>{let n=t.keep_values,o={set:(e,n,o)=>{let a=rz.fromDom(e);$(t.url_converter)&&H(n)&&(n=t.url_converter.call(t.url_converter_scope||r(),String(n),o,e)),l8(a,"data-mce-"+o,n),l8(a,o,n)},get:(e,t)=>{let r=rz.fromDom(e);return rC(r,"data-mce-"+t)||rC(r,t)}},a={style:{set:(t,r)=>{let o=rz.fromDom(t);n&&l8(o,l2,r),rE(o,"style"),P(r)&&nA(o,e.parse(r))},get:t=>{let r=rz.fromDom(t),n=rC(r,l2)||rC(r,"style");return e.serialize(e.parse(n),ri(r))}}};return n&&(a.href=a.src=o),a},it=(e,t={})=>{let r={},n=window,o={},a=0,l=a9.forElement(rz.fromDom(e),{contentCssCors:t.contentCssCors,referrerPolicy:t.referrerPolicy}),i=[],s=t.schema?t.schema:lU({}),d=lz({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope},t.schema),c=t.ownEvents?new lZ:lZ.Event,m=s.getBlockElements(),u=t=>t&&e&&P(t)?e.getElementById(t):t,f=e=>{let t=u(e);return H(t)?rz.fromDom(t):null},g=(e,t,r="")=>{let n;let o=f(e);if(H(o)&&ru(o)){let e=K[t];n=e&&e.get?e.get(o.dom,t):rC(o,t)}return H(n)?n:r},p=e=>{let t=u(e);return j(t)?[]:t.attributes},h=(e,r,n)=>{S(e,e=>{if(ou(e)){let o=rz.fromDom(e),a=""===n?null:n,l=rC(o,r),i=K[r];i&&i.set?i.set(o.dom,a,r):l8(o,r,a),l!==a&&t.onSetAttrib&&t.onSetAttrib({attrElm:o.dom,attrName:r,attrValue:a})}})},b=()=>t.root_element||e.body,v=(t,r)=>a5(e.body,u(t),r),y=(e,t,r)=>{let n=u(e);return j(n)||!ou(n)?void 0:r?nO(rz.fromDom(n),l5(t)):("float"===(t=t.replace(/-(\D)/g,(e,t)=>t.toUpperCase()))&&(t="cssFloat"),n.style?n.style[t]:void 0)},C=e=>{let t=u(e);if(!t)return{w:0,h:0};let r=y(t,"width"),n=y(t,"height");return r&&-1!==r.indexOf("px")||(r="0"),n&&-1!==n.indexOf("px")||(n="0"),{w:parseInt(r,10)||t.offsetWidth||t.clientWidth,h:parseInt(n,10)||t.offsetHeight||t.clientHeight}},x=(e,t)=>!!e&&eu(M(e)?e:[e],e=>rH(rz.fromDom(e),t)),w=(e,t,r,n)=>{let o=[],a=u(e);n=void 0===n;let l=r||("BODY"!==b().nodeName?b().parentNode:null);if(P(t)){if("*"===t)t=ou;else{let e=t;t=t=>x(t,e)}}for(;a&&!(a===l||j(a.nodeType)||o_(a)||oN(a));){if(!t||t(a)){if(!n)return[a];o.push(a)}a=a.parentNode}return n?o:null},E=(e,t,r)=>{let n=t;if(e){P(t)&&(n=e=>x(e,t));for(let t=e[r];t;t=t[r])if($(n)&&n(t))return t}return null},k=e=>$(e.querySelectorAll),S=function(e,t,r){let n=null!=r?r:this;if(M(e)){let r=[];return l0(e,(e,o)=>{let a=u(e);a&&r.push(t.call(n,a,o))}),r}{let r=u(e);return!!r&&t.call(n,r)}},_=(e,t)=>{S(e,e=>{eI(t,(t,r)=>{h(e,r,t)})})},N=(e,t)=>{S(e,e=>{nX(rz.fromDom(e),t)})},D=(t,r,n,o,a)=>S(t,t=>{let l=P(r)?e.createElement(r):r;return H(n)&&_(l,n),o&&(!P(o)&&o.nodeType?l.appendChild(o):P(o)&&N(l,o)),a?l:t.appendChild(l)}),R=(t,r,n)=>D(e.createElement(t),t,r,n,!0),A=lC.decode,O=lC.encodeAllRaw,T=(e,t)=>S(e,e=>{let r=rz.fromDom(e);return t&&eg(r6(r),e=>{rf(e)&&0===e.dom.length?nV(e):nM(r,e)}),nV(r),r.dom}),B=(e,t,r)=>{S(e,e=>{if(ou(e)){let n=rz.fromDom(e);eg(t.split(" "),e=>{H(r)?(r?rP:rF)(n,e):rM(n,e)})}})},L=(e,t,r)=>S(t,n=>{var o;let a=M(t)?e.cloneNode(!0):e;return r&&l0(l1(n.childNodes),e=>{a.appendChild(e)}),null===(o=n.parentNode)||void 0===o||o.replaceChild(a,n),n}),F=e=>{if(ou(e)){let t="a"===e.nodeName.toLowerCase()&&!g(e,"href")&&g(e,"id");if(g(e,"name")||g(e,"data-mce-bookmark")||t)return!0}return!1},I=()=>e.createRange(),U=(r,o,a,l)=>{if(!M(r))return t.collect&&(r===e||r===n)&&i.push([r,o,a,l]),c.bind(r,o,a,l||V);{let e=r.length,t=[];for(;e--;)t[e]=U(r[e],o,a,l);return t}},z=(t,r,o)=>{if(M(t)){let e=t.length,n=[];for(;e--;)n[e]=z(t[e],r,o);return n}if(i.length>0&&(t===e||t===n)){let e=i.length;for(;e--;){let[n,a,l]=i[e];t!==n||r&&r!==a||o&&o!==l||c.unbind(n,a,l)}}return c.unbind(t,r,o)},q=e=>{if(!(e&&ou(e)))return null;{let t=e.getAttribute("data-mce-contenteditable");return t&&"inherit"!==t?t:"inherit"!==e.contentEditable?e.contentEditable:null}},V={doc:e,settings:t,win:n,files:o,stdMode:!0,boxModel:!0,styleSheetLoader:l,boundEvents:i,styles:d,schema:s,events:c,isBlock:e=>P(e)?eG(m,e):ou(e)&&(eG(m,e.nodeName)||aJ(s,e)),root:null,clone:(e,t)=>e.cloneNode(t),getRoot:b,getViewPort:e=>{let t=oo(e);return{x:t.x,y:t.y,w:t.width,h:t.height}},getRect:e=>{let t=u(e),r=v(t),n=C(t);return{x:r.x,y:r.y,w:n.w,h:n.h}},getSize:C,getParent:(e,t,r)=>{let n=w(e,t,r,!1);return n&&n.length>0?n[0]:null},getParents:w,get:u,getNext:(e,t)=>E(e,t,"nextSibling"),getPrev:(e,t)=>E(e,t,"previousSibling"),select:(r,n)=>{var o,a;let l=null!==(a=null!==(o=u(n))&&void 0!==o?o:t.root_element)&&void 0!==a?a:e;return k(l)?eB(l.querySelectorAll(r)):[]},is:x,add:D,create:R,createHTML:(e,t,r="")=>{let n="<"+e;for(let e in t)eY(t,e)&&(n+=" "+e+'="'+O(t[e])+'"');return tv(r)&&eG(s.getVoidElements(),e)?n+" />":n+">"+r+"</"+e+">"},createFragment:t=>{let r;let n=e.createElement("div"),o=e.createDocumentFragment();for(o.appendChild(n),t&&(n.innerHTML=t);r=n.firstChild;)o.appendChild(r);return o.removeChild(n),o},remove:T,setStyle:(e,r,n)=>{S(e,e=>{let o=rz.fromDom(e);l7(o,r,n),t.update_styles&&l9(d,o)})},getStyle:y,setStyles:(e,r)=>{S(e,e=>{let n=rz.fromDom(e);eI(r,(e,t)=>{l7(n,t,e)}),t.update_styles&&l9(d,n)})},removeAllAttribs:e=>S(e,e=>{let t=e.attributes;for(let r=t.length-1;r>=0;r--)e.removeAttributeNode(t.item(r))}),setAttrib:h,setAttribs:_,getAttrib:g,getPos:v,parseStyle:e=>d.parse(e),serializeStyle:(e,t)=>d.serialize(e,t),addStyle:t=>{if(V!==it.DOM&&e===document){if(r[t])return;r[t]=!0}let n=e.getElementById("mceDefaultStyles");if(!n){(n=e.createElement("style")).id="mceDefaultStyles",n.type="text/css";let t=e.head;t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)}n.styleSheet?n.styleSheet.cssText+=t:n.appendChild(e.createTextNode(t))},loadCSS:e=>{e||(e=""),eg(e.split(","),e=>{o[e]=!0,l.load(e).catch(W)})},addClass:(e,t)=>{B(e,t,!0)},removeClass:(e,t)=>{B(e,t,!1)},hasClass:(e,t)=>{let r=f(e),n=t.split(" ");return H(r)&&eS(n,e=>rI(r,e))},toggleClass:B,show:e=>{S(e,e=>nL(rz.fromDom(e),"display"))},hide:e=>{S(e,e=>nR(rz.fromDom(e),"display","none"))},isHidden:e=>{let t=f(e);return H(t)&&t3(nB(t,"display"),"none")},uniqueId:e=>(e||"mce_")+a++,setHTML:N,getOuterHTML:e=>{let t=f(e);return H(t)?ou(t.dom)?t.dom.outerHTML:nQ(t):""},setOuterHTML:(e,t)=>{S(e,e=>{ou(e)&&(e.outerHTML=t)})},decode:A,encode:O,insertAfter:(e,t)=>{let r=u(t);return S(e,e=>{let t=null==r?void 0:r.parentNode,n=null==r?void 0:r.nextSibling;return t&&(n?t.insertBefore(e,n):t.appendChild(e)),e})},replace:L,rename:(e,t)=>{if(e.nodeName===t.toUpperCase())return e;{let r=R(t);return l0(p(e),t=>{h(r,t.nodeName,g(e,t.nodeName))}),L(r,e,!0),r}},findCommonAncestor:(e,t)=>{let r=e;for(;r;){let e=t;for(;e&&r!==e;)e=e.parentNode;if(r===e)break;r=r.parentNode}return!r&&e.ownerDocument?e.ownerDocument.documentElement:r},run:S,getAttribs:p,isEmpty:(e,t,r)=>{let n=0;if(F(e))return!1;let o=e.firstChild;if(o){let a=new od(o,e),l=s?s.getWhitespaceElements():{},i=t||(s?s.getNonEmptyElements():null),d=o;do{if(ou(d)){let e=d.getAttribute("data-mce-bogus");if(e){d=a.next("all"===e);continue}let t=d.nodeName.toLowerCase();if(i&&i[t]){if("br"===t){n++,d=a.next();continue}return!1}if(F(d))return!1}if(oS(d)||ow(d)&&!aw(d.data)&&(!(null==r?void 0:r.includeZwsp)||!aE(d.data))||ow(d)&&d.parentNode&&l[d.parentNode.nodeName]&&aw(d.data))return!1;d=a.next()}while(d)}return n<=1},createRng:I,nodeIndex:l6,split:(e,t,r)=>{let n,o,a=I();if(e&&t&&e.parentNode&&t.parentNode){let l=e.parentNode;return a.setStart(l,l6(e)),a.setEnd(t.parentNode,l6(t)),n=a.extractContents(),(a=I()).setStart(t.parentNode,l6(t)+1),a.setEnd(l,l6(e)+1),o=a.extractContents(),l.insertBefore(la(V,n),e),r?l.insertBefore(r,e):l.insertBefore(t,e),l.insertBefore(la(V,o),e),T(e),r||t}},bind:U,unbind:z,fire:(e,t,r)=>c.dispatch(e,t,r),dispatch:(e,t,r)=>c.dispatch(e,t,r),getContentEditable:q,getContentEditableParent:e=>{let t=b(),r=null;for(let n=e;n&&n!==t&&null===(r=q(n));n=n.parentNode);return r},isEditable:e=>{if(!H(e))return!1;{let t=ou(e)?e:e.parentElement;return H(t)&&nk(rz.fromDom(t))}},destroy:()=>{if(i.length>0){let e=i.length;for(;e--;){let[t,r,n]=i[e];c.unbind(t,r,n)}}eI(o,(e,t)=>{l.unload(t),delete o[t]})},isChildOf:(e,t)=>e===t||t.contains(e),dumpRng:e=>"startContainer: "+e.startContainer.nodeName+", startOffset: "+e.startOffset+", endContainer: "+e.endContainer.nodeName+", endOffset: "+e.endOffset},K=ie(d,t,Y(V));return V};it.DOM=it(document),it.nodeIndex=l6;let ir=it.DOM;class io{constructor(e={}){this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=!1,this.settings=e}_setReferrerPolicy(e){this.settings.referrerPolicy=e}loadScript(e){return new Promise((t,r)=>{let n;let o=()=>{ir.remove(a),n&&(n.onerror=n.onload=n=null)},a=ir.uniqueId();(n=document.createElement("script")).id=a,n.type="text/javascript",n.src=t2._addCacheSuffix(e),this.settings.referrerPolicy&&ir.setAttrib(n,"referrerpolicy",this.settings.referrerPolicy),n.onload=()=>{o(),t()},n.onerror=()=>{o(),r("Failed to load script: "+e)},(document.getElementsByTagName("head")[0]||document.body).appendChild(n)})}isDone(e){return 2===this.states[e]}markDone(e){this.states[e]=2}add(e){let t=this;return t.queue.push(e),void 0===t.states[e]&&(t.states[e]=0),new Promise((r,n)=>{t.scriptLoadedCallbacks[e]||(t.scriptLoadedCallbacks[e]=[]),t.scriptLoadedCallbacks[e].push({resolve:r,reject:n})})}load(e){return this.add(e)}remove(e){delete this.states[e],delete this.scriptLoadedCallbacks[e]}loadQueue(){let e=this.queue;return this.queue=[],this.loadScripts(e)}loadScripts(e){let t=this,r=(e,r)=>{eK(t.scriptLoadedCallbacks,r).each(t=>{eg(t,t=>t[e](r))}),delete t.scriptLoadedCallbacks[r]},n=e=>{let t=eb(e,e=>"rejected"===e.status);return t.length>0?Promise.reject(ek(t,({reason:e})=>M(e)?e:[e])):Promise.resolve()},o=e=>Promise.allSettled(ef(e,e=>2===t.states[e]?(r("resolve",e),Promise.resolve()):3===t.states[e]?(r("reject",e),Promise.reject(e)):(t.states[e]=1,t.loadScript(e).then(()=>{t.states[e]=2,r("resolve",e);let a=t.queue;return a.length>0?(t.queue=[],o(a).then(n)):Promise.resolve()},()=>(t.states[e]=3,r("reject",e),Promise.reject(e)))))),a=e=>(t.loading=!0,o(e).then(e=>{t.loading=!1;let r=t.queueLoadedCallbacks.shift();return ea.from(r).each(er),n(e)})),l=eQ(e);return t.loading?new Promise((e,r)=>{t.queueLoadedCallbacks.push(()=>{a(l).then(e,r)})}):a(l)}}io.ScriptLoader=new io;let ia=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}},il=(e,t)=>{let r=e.indexOf(t);return -1!==r&&e.indexOf(t,r+1)>r},ii=e=>L(e)&&eG(e,"raw"),is=e=>M(e)&&e.length>1,id={},ic=ia("en"),im=()=>eK(id,ic.get()),iu={getData:()=>eU(id,e=>({...e})),setCode:e=>{e&&ic.set(e)},getCode:()=>ic.get(),add:(e,t)=>{let r=id[e];r||(id[e]=r={});let n=ef(eF(t),e=>e.toLowerCase());eI(t,(e,o)=>{let a=o.toLowerCase();a!==o&&il(n,a)?(eG(t,a)||(r[a]=e),r[o]=e):r[a]=e})},translate:e=>{let t=im().getOr({}),r=e=>$(e)?Object.prototype.toString.call(e):n(e)?"":""+e,n=e=>""===e||null==e,o=e=>{let n=r(e);return eG(t,n)?r(t[n]):eK(t,n.toLowerCase()).map(r).getOr(n)},a=e=>e.replace(/{context:\w+}$/,"");if(n(e))return"";if(ii(e))return r(e.raw);if(is(e)){let t=e.slice(1);return a(o(e[0]).replace(/\{([0-9]+)\}/g,(e,n)=>eG(t,n)?r(t[n]):e))}return a(o(e))},isRtl:()=>im().bind(e=>eK(e,"_dir")).exists(e=>"rtl"===e),hasCode:e=>eG(id,e)},ig=()=>{let e=[],t={},r={},n=[],o=(e,t)=>{eg(eb(n,r=>r.name===e&&r.state===t),e=>e.resolve())},a=e=>eG(t,e),l=e=>eG(r,e),i=(e,r)=>{let n=iu.getCode();n&&(!r||-1!==(","+(r||"")+",").indexOf(","+n+","))&&io.ScriptLoader.add(t[e]+"/langs/"+n+".js")},s=(e,t="added")=>"added"===t&&l(e)?Promise.resolve():"loaded"===t&&a(e)?Promise.resolve():new Promise(r=>{n.push({name:e,state:t,resolve:r})});return{items:e,urls:t,lookup:r,get:e=>{if(r[e])return r[e].instance},requireLangPack:(e,t)=>{!1!==ig.languageLoad&&(a(e)?i(e,t):s(e,"loaded").then(()=>i(e,t)))},add:(t,n)=>(e.push(n),r[t]={instance:n},o(t,"added"),n),remove:e=>{delete t[e],delete r[e]},createUrl:(e,t)=>P(t)?P(e)?{prefix:"",resource:t,suffix:""}:{prefix:e.prefix,resource:t,suffix:e.suffix}:t,load:(e,n)=>{if(t[e])return Promise.resolve();let a=P(n)?n:n.prefix+n.resource+n.suffix;0!==a.indexOf("/")&&-1===a.indexOf("://")&&(a=ig.baseURL+"/"+a),t[e]=a.substring(0,a.lastIndexOf("/"));let l=()=>(o(e,"loaded"),Promise.resolve());return r[e]?l():io.ScriptLoader.add(a).then(l)},waitFor:s}};ig.languageLoad=!0,ig.baseURL="",ig.PluginManager=ig(),ig.ThemeManager=ig(),ig.ModelManager=ig();let ip=e=>{let t=ia(ea.none()),r=()=>t.get().each(e);return{clear:()=>{r(),t.set(ea.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:e=>{r(),t.set(ea.some(e))}}},ih=e=>{let t=ia(ea.none()),r=()=>t.get().each(e=>clearInterval(e));return{clear:()=>{r(),t.set(ea.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:n=>{r(),t.set(ea.some(setInterval(n,e)))}}},ib=()=>{let e=ip(W);return{...e,on:t=>e.get().each(t)}},iv=(e,t)=>{let r=null;return{cancel:()=>{I(r)||(clearTimeout(r),r=null)},throttle:(...n)=>{I(r)&&(r=setTimeout(()=>{r=null,e.apply(null,n)},t))}}},iy=(e,t)=>{let r=null,n=()=>{I(r)||(clearTimeout(r),r=null)};return{cancel:n,throttle:(...o)=>{n(),r=setTimeout(()=>{r=null,e.apply(null,o)},t)}}},iC=Y("mce-annotation"),ix=Y("data-mce-annotation"),iw=Y("data-mce-annotation-uid"),iE=Y("data-mce-annotation-active"),ik=Y("data-mce-annotation-classes"),iS=Y("data-mce-annotation-attrs"),i_=e=>t=>rW(t,e),iN=(e,t)=>{let r=e.selection.getRng(),n=rz.fromDom(r.startContainer),o=rz.fromDom(e.getBody()),a=t.fold(()=>"."+iC(),e=>`[${ix()}="${e}"]`);return nw(r9(n,r.startOffset).getOr(n),a,i_(o)).bind(t=>rx(t,`${iw()}`).bind(r=>rx(t,`${ix()}`).map(t=>{let n=iA(e,r);return{uid:r,name:t,elements:n}})))},iD=e=>ru(e)&&rI(e,iC()),iR=(e,t)=>rw(e,"data-mce-bogus")||os(e,'[data-mce-bogus="all"]',i_(t)),iA=(e,t)=>{let r=rz.fromDom(e.getBody());return eb(oi(r,`[${iw()}="${t}"]`),e=>!iR(e,r))},iO=(e,t)=>{let r=rz.fromDom(e.getBody()),n=oi(r,`[${ix()}="${t}"]`),o={};return eg(n,e=>{if(!iR(e,r)){let t=rC(e,iw()),r=eK(o,t).getOr([]);o[t]=r.concat([e])}}),o},iT=(e,t)=>{let r=ia({}),n=()=>({listeners:[],previous:ib()}),o=(e,t)=>{a(e,e=>(t(e),e))},a=(e,t)=>{let o=r.get(),a=t(eK(o,e).getOrThunk(n));o[e]=a,r.set(o)},l=(e,t,r)=>{o(e,n=>{eg(n.listeners,n=>n(!0,e,{uid:t,nodes:ef(r,e=>e.dom)}))})},i=e=>{o(e,t=>{eg(t.listeners,t=>t(!1,e))})},s=(t,r)=>{eg(iA(e,t),e=>{r?rv(e,iE(),"true"):rE(e,iE())})},d=iy(()=>{eg(eR(t.getNames()),t=>{a(t,r=>{let n=r.previous.get();return iN(e,ea.some(t)).fold(()=>{n.each(e=>{i(t),r.previous.clear(),s(e,!1)})},({uid:e,name:t,elements:o})=>{t3(n,e)||(n.each(e=>s(e,!1)),l(t,e,o),r.previous.set(e),s(e,!0))}),{previous:r.previous,listeners:r.listeners}})})},30);return e.on("remove",()=>{d.cancel()}),e.on("NodeChange",()=>{d.throttle()}),{addListener:(e,t)=>{a(e,e=>({previous:e.previous,listeners:e.listeners.concat([t])}))}}},iB=(e,t)=>{let r=ix(),n=e=>ea.from(e.attr(r)).bind(t.lookup),o=e=>{var t,r;e.attr(iw(),null),e.attr(ix(),null),e.attr(iE(),null);let n=ea.from(e.attr(iS())).map(e=>e.split(",")).getOr([]),o=ea.from(e.attr(ik())).map(e=>e.split(",")).getOr([]);eg(n,t=>e.attr(t,null));let a=eN(null!==(r=null===(t=e.attr("class"))||void 0===t?void 0:t.split(" "))&&void 0!==r?r:[],[iC()].concat(o));e.attr("class",a.length>0?a.join(" "):null),e.attr(ik(),null),e.attr(iS(),null)};e.serializer.addTempAttr(iE()),e.serializer.addAttributeFilter(r,e=>{for(let t of e)n(t).each(e=>{!1===e.persistent&&("span"===t.name?t.unwrap():o(t))})})},iP=()=>{let e={};return{register:(t,r)=>{e[t]={name:t,settings:r}},lookup:t=>eK(e,t).map(e=>e.settings),getNames:()=>eF(e)}},iL=0,iF=e=>{let t=new Date().getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++iL+String(t)},iM=(e,t)=>{eg(t,t=>{rP(e,t)})},iI=(e,t)=>{eg(t,t=>{rF(e,t)})},iU=(e,t)=>rz.fromDom(e.dom.cloneNode(t)),iz=e=>iU(e,!1),ij=e=>iU(e,!0),iH=(e,t)=>{let r=rz.fromTag(t);return ry(r,rS(e)),r},i$=(e,t)=>{let r=iH(e,t);return nI(e,r),n$(r,r6(e)),nV(e),r},iq=(e,t,r=en)=>{let n=new od(e,t),o=e=>{let t;do t=n[e]();while(t&&!ow(t)&&!r(t));return ea.from(t).filter(ow)};return{current:()=>ea.from(n.current()).filter(ow),next:()=>o("next"),prev:()=>o("prev"),prev2:()=>o("prev2")}},iV=(e,t)=>{let r=t||(t=>e.isBlock(t)||oD(t)||oO(t)),n=(e,t,r,o)=>{if(ow(e)){let r=o(e,t,e.data);if(-1!==r)return ea.some({container:e,offset:r})}return r().bind(e=>n(e.container,e.offset,r,o))};return{backwards:(t,o,a,l)=>{let i=iq(t,null!=l?l:e.getRoot(),r);return n(t,o,()=>i.prev().map(e=>({container:e,offset:e.length})),a).getOrNull()},forwards:(t,o,a,l)=>{let i=iq(t,null!=l?l:e.getRoot(),r);return n(t,o,()=>i.next().map(e=>({container:e,offset:0})),a).getOrNull()}}},iW=Math.round,iK=e=>e?{left:iW(e.left),top:iW(e.top),bottom:iW(e.bottom),right:iW(e.right),width:iW(e.width),height:iW(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0},iG=(e,t)=>(e=iK(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e),iY=(e,t)=>e.left===t.left&&e.top===t.top&&e.bottom===t.bottom&&e.right===t.right,iX=(e,t,r)=>e>=0&&e<=Math.min(t.height,r.height)/2,iQ=(e,t)=>{let r=Math.min(t.height/2,e.height/2);return e.bottom-r<t.top||!(e.top>t.bottom)&&iX(t.top-e.bottom,e,t)},iJ=(e,t)=>e.top>t.bottom||!(e.bottom<t.top)&&iX(t.bottom-e.top,e,t),iZ=(e,t,r)=>t>=e.left&&t<=e.right&&r>=e.top&&r<=e.bottom,i0=e=>ey(e,(e,t)=>e.fold(()=>ea.some(t),e=>{let r=Math.min(t.left,e.left),n=Math.min(t.top,e.top),o=Math.max(t.right,e.right),a=Math.max(t.bottom,e.bottom);return ea.some({top:n,right:o,bottom:a,left:r,width:o-r,height:a-n})}),ea.none()),i1=(e,t,r)=>{let n=Math.max(Math.min(t,e.left+e.width),e.left),o=Math.max(Math.min(r,e.top+e.height),e.top);return Math.sqrt((t-n)*(t-n)+(r-o)*(r-o))},i2=(e,t)=>Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),i3=(e,t,r)=>Math.min(Math.max(e,t),r),i8=e=>{let t=e.startContainer,r=e.startOffset;return t===e.endContainer&&t.hasChildNodes()&&e.endOffset===r+1?t.childNodes[r]:null},i5=(e,t)=>{if(!(ou(e)&&e.hasChildNodes()))return e;{let r=e.childNodes,n=i3(t,0,r.length-1);return r[n]}},i6=RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]"),i9=e=>P(e)&&e.charCodeAt(0)>=768&&i6.test(e),i4=op("display","block table"),i7=((...e)=>t=>{for(let r=0;r<e.length;r++)if(!e[r](t))return!1;return!0})(ou,ap,Z(op("float","left right"))),se=Z(op("white-space","pre pre-line pre-wrap")),st=it.nodeIndex,sr=(e,t)=>{if(!(t<0&&ou(e)&&e.hasChildNodes()))return i5(e,t)},sn=e=>e?e.createRange():it.DOM.createRng(),so=e=>P(e)&&/[\r\n\t ]/.test(e),sa=e=>!!e.setStart&&!!e.setEnd,sl=e=>{let t=e.startContainer,r=e.startOffset;if(so(e.toString())&&se(t.parentNode)&&ow(t)){let e=t.data;if(so(e[r-1])||so(e[r+1]))return!0}return!1},si=e=>{let t=e.ownerDocument,r=sn(t),n=t.createTextNode("\xa0"),o=e.parentNode;o.insertBefore(n,e),r.setStart(n,0),r.setEnd(n,1);let a=iK(r.getBoundingClientRect());return o.removeChild(n),a},ss=e=>{let t=e.startContainer,r=e.endContainer,n=e.startOffset,o=e.endOffset;if(!(t===r&&ow(r))||0!==n||1!==o)return null;{let t=e.cloneRange();return t.setEndAfter(r),sc(t)}},sd=e=>0===e.left&&0===e.right&&0===e.top&&0===e.bottom,sc=e=>{var t;let r;let n=e.getClientRects();return(r=n.length>0?iK(n[0]):iK(e.getBoundingClientRect()),!sa(e)&&oD(e)&&sd(r))?si(e):sd(r)&&sa(e)&&null!==(t=ss(e))&&void 0!==t?t:r},sm=(e,t)=>{let r=iG(e,t);return r.width=1,r.right=r.left+1,r},su=e=>{let t=[],r=e=>{0===e.height||t.length>0&&iY(e,t[t.length-1])||t.push(e)},n=(e,t)=>{let n=sn(e.ownerDocument);if(t<e.data.length){if(i9(e.data[t]))return;if(i9(e.data[t-1])&&(n.setStart(e,t),n.setEnd(e,t+1),!sl(n))){r(sm(sc(n),!1));return}}t>0&&(n.setStart(e,t-1),n.setEnd(e,t),sl(n)||r(sm(sc(n),!1))),t<e.data.length&&(n.setStart(e,t),n.setEnd(e,t+1),sl(n)||r(sm(sc(n),!0)))},o=e.container(),a=e.offset();if(ow(o))return n(o,a),t;if(ou(o)){if(e.isAtEnd()){let e=sr(o,a);ow(e)&&n(e,e.data.length),i7(e)&&!oD(e)&&r(sm(sc(e),!1))}else{let l=sr(o,a);if(ow(l)&&n(l,0),i7(l)&&e.isAtEnd())return r(sm(sc(l),!1)),t;let i=sr(e.container(),e.offset()-1);i7(i)&&!oD(i)&&(i4(i)||i4(l)||!i7(l))&&r(sm(sc(i),!1)),i7(l)&&r(sm(sc(l),!0))}}return t},sf=(e,t,r)=>{let n=()=>(r||(r=su(sf(e,t))),r);return{container:Y(e),offset:Y(t),toRange:()=>{let r=sn(e.ownerDocument);return r.setStart(e,t),r.setEnd(e,t),r},getClientRects:n,isVisible:()=>n().length>0,isAtStart:()=>(ow(e),0===t),isAtEnd:()=>ow(e)?t>=e.data.length:t>=e.childNodes.length,isEqual:r=>r&&e===r.container()&&t===r.offset(),getNode:r=>sr(e,r?t-1:t)}};sf.fromRangeStart=e=>sf(e.startContainer,e.startOffset),sf.fromRangeEnd=e=>sf(e.endContainer,e.endOffset),sf.after=e=>sf(e.parentNode,st(e)+1),sf.before=e=>sf(e.parentNode,st(e)),sf.isAbove=(e,t)=>t6(eO(t.getClientRects()),eT(e.getClientRects()),iQ).getOr(!1),sf.isBelow=(e,t)=>t6(eT(t.getClientRects()),eO(e.getClientRects()),iJ).getOr(!1),sf.isAtStart=e=>!!e&&e.isAtStart(),sf.isAtEnd=e=>!!e&&e.isAtEnd(),sf.isTextPosition=e=>!!e&&ow(e.container()),sf.isElementPosition=e=>!sf.isTextPosition(e);let sg=(e,t)=>{ow(t)&&0===t.data.length&&e.remove(t)},sp=(e,t,r)=>{t.insertNode(r),sg(e,r.previousSibling),sg(e,r.nextSibling)},sh=(e,t,r)=>{let n=ea.from(r.firstChild),o=ea.from(r.lastChild);t.insertNode(r),n.each(t=>sg(e,t.previousSibling)),o.each(t=>sg(e,t.nextSibling))},sb=(e,t,r)=>{oN(r)?sh(e,t,r):sp(e,t,r)},sv=it.nodeIndex,sy=e=>{let t=e.parentNode;return ob(t)?sy(t):t},sC=e=>e?e3(e.childNodes,(e,t)=>(ob(t)&&"BR"!==t.nodeName?e=e.concat(sC(t)):e.push(t),e),[]):[],sx=(e,t)=>{let r=e;for(;(r=r.previousSibling)&&ow(r);)t+=r.data.length;return t},sw=e=>t=>e===t,sE=e=>{let t,r;r=e8(t=sC(sy(e)),sw(e),e);let n=e3(t=t.slice(0,r+1),(e,r,n)=>(ow(r)&&ow(t[n-1])&&e++,e),0);return(r=e8(t=e2(t,og([e.nodeName])),sw(e),e))-n},sk=e=>(ow(e)?"text()":e.nodeName.toLowerCase())+"["+sE(e)+"]",sS=(e,t,r)=>{let n=[];for(let o=t.parentNode;o&&o!==e&&!(r&&r(o));o=o.parentNode)n.push(o);return n},s_=(e,t)=>{let r,n=[],o=t.container(),a=t.offset();if(ow(o))r=sx(o,a);else{let e=o.childNodes;a>=e.length?(r="after",a=e.length-1):r="before",o=e[a]}n.push(sk(o));let l=sS(e,o);return l=e2(l,Z(ob)),(n=n.concat(e1(l,e=>sk(e)))).reverse().join("/")+","+r},sN=(e,t,r)=>{let n=sC(e);return n=e2(n,(e,t)=>!ow(e)||!ow(n[t-1])),(n=e2(n,og([t])))[r]},sD=(e,t)=>{let r=e,n=0;for(;ow(r);){let o=r.data.length;if(t>=n&&t<=n+o){e=r,t-=n;break}if(!ow(r.nextSibling)){e=r,t=o;break}n+=o,r=r.nextSibling}return ow(e)&&t>e.data.length&&(t=e.data.length),sf(e,t)},sR=(e,t)=>{if(!t)return null;let r=t.split(","),n=r[0].split("/"),o=r.length>1?r[1]:"before",a=e3(n,(e,t)=>{let r=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(t);return r?("text()"===r[1]&&(r[1]="#text"),sN(e,r[1],parseInt(r[2],10))):null},e);if(!a)return null;if(!ow(a)&&a.parentNode){let e;return e="after"===o?sv(a)+1:sv(a),sf(a.parentNode,e)}return sD(a,parseInt(o,10))},sA=(e,t,r)=>{let n=e(t.data.slice(0,r)).length;for(let r=t.previousSibling;r&&ow(r);r=r.previousSibling)n+=e(r.data).length;return n},sO=(e,t,r,n,o)=>{let a=o?n.startContainer:n.endContainer,l=o?n.startOffset:n.endOffset,i=[],s=e.getRoot();if(ow(a))i.push(r?sA(t,a,l):l);else{let t=0,n=a.childNodes;l>=n.length&&n.length&&(t=1,l=Math.max(0,n.length-1)),i.push(e.nodeIndex(n[l],r)+t)}for(let t=a;t&&t!==s;t=t.parentNode)i.push(e.nodeIndex(t,r));return i},sT=(e,t,r,n)=>{let o=t.dom,a=sO(o,e,r,n,!0),l=t.isForward(),i=am(n)?{isFakeCaret:!0}:{};return t.isCollapsed()?{start:a,forward:l,...i}:{start:a,end:sO(o,e,r,n,!1),forward:l,...i}},sB=(e,t,r)=>{let n=0;return t2.each(e.select(t),e=>{if("all"!==e.getAttribute("data-mce-bogus")){if(e===r)return!1;n++}}),n},sP=(e,t)=>{let r=t?e.startContainer:e.endContainer,n=t?e.startOffset:e.endOffset;if(ou(r)&&"TR"===r.nodeName){let o=r.childNodes;(r=o[Math.min(t?n:n-1,o.length-1)])&&(n=t?0:r.childNodes.length,t?e.setStart(r,n):e.setEnd(r,n))}},sL=e=>(sP(e,!0),sP(e,!1),e),sF=(e,t)=>{if(ou(e)&&oO(e=i5(e,t)))return e;if(at(e)){ow(e)&&o7(e)&&(e=e.parentNode);let t=e.previousSibling;if(oO(t)||oO(t=e.nextSibling))return t}},sM=e=>sF(e.startContainer,e.startOffset)||sF(e.endContainer,e.endOffset),sI=(e,t,r)=>{let n=r.getNode(),o=r.getRng();if("IMG"===n.nodeName||oO(n)){let e=n.nodeName;return{name:e,index:sB(r.dom,e,n)}}let a=sM(o);if(a){let e=a.tagName;return{name:e,index:sB(r.dom,e,a)}}return sT(e,r,t,o)},sU=e=>{let t=e.getRng();return{start:s_(e.dom.getRoot(),sf.fromRangeStart(t)),end:s_(e.dom.getRoot(),sf.fromRangeEnd(t)),forward:e.isForward()}},sz=e=>({rng:e.getRng(),forward:e.isForward()}),sj=(e,t,r)=>{let n={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return r?e.create("span",n,"&#xFEFF;"):e.create("span",n)},sH=(e,t)=>{let r=e.dom,n=e.getRng(),o=r.uniqueId(),a=e.isCollapsed(),l=e.getNode(),i=l.nodeName,s=e.isForward();if("IMG"===i)return{name:i,index:sB(r,i,l)};let d=sL(n.cloneRange());if(!a){d.collapse(!1);let e=sj(r,o+"_end",t);sb(r,d,e)}(n=sL(n)).collapse(!0);let c=sj(r,o+"_start",t);return sb(r,n,c),e.moveToBookmark({id:o,keep:!0,forward:s}),{id:o,forward:s}},s$=(e,t,r=!1)=>2===t?sI(o4,r,e):3===t?sU(e):t?sz(e):sH(e,!1),sq=J(sI,X,!0),sV={value:e=>{let t=t=>t(e),r=Y(e),n=()=>o,o={tag:!0,inner:e,fold:(t,r)=>r(e),isValue:eo,isError:en,map:t=>sV.value(t(e)),mapError:n,bind:t,exists:t,forall:t,getOr:r,or:n,getOrThunk:r,orThunk:n,getOrDie:r,each:t=>{t(e)},toOptional:()=>ea.some(e)};return o},error:e=>{let t=()=>r,r={tag:!1,inner:e,fold:(t,r)=>t(e),isValue:en,isError:eo,map:t,mapError:t=>sV.error(t(e)),bind:t,exists:en,forall:eo,getOr:X,or:X,getOrThunk:et,orThunk:et,getOrDie:ee(String(e)),each:W,toOptional:ea.none};return r}},sW=e=>{if(!M(e))throw Error("cases must be an array");if(0===e.length)throw Error("there must be at least one case");let t=[],r={};return eg(e,(n,o)=>{let a=eF(n);if(1!==a.length)throw Error("one and only one name per case");let l=a[0],i=n[l];if(void 0!==r[l])throw Error("duplicate key detected:"+l);if("cata"===l)throw Error("cannot have a case named cata (sorry)");if(!M(i))throw Error("case arguments must be an array");t.push(l),r[l]=(...r)=>{let n=r.length;if(n!==i.length)throw Error("Wrong number of arguments to case "+l+". Expected "+i.length+" ("+i+"), got "+n);return{fold:(...t)=>{if(t.length!==e.length)throw Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);return t[o].apply(null,r)},match:e=>{let n=eF(e);if(t.length!==n.length)throw Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+n.join(","));if(!eS(t,e=>em(n,e)))throw Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+t.join(", "));return e[l].apply(null,r)},log:e=>{console.log(e,{constructors:t,constructor:l,params:r})}}}}),r};sW([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);let sK=e=>{let t=[],r=[];return eg(e,e=>{e.fold(e=>{t.push(e)},e=>{r.push(e)})}),{errors:t,values:r}},sG=e=>"inline-command"===e.type||"inline-format"===e.type,sY=e=>"block-command"===e.type||"block-format"===e.type,sX=e=>{let t=t=>sV.error({message:t,pattern:e}),r=(r,n,o)=>{if(void 0!==e.format){let o;if(M(e.format)){if(!eS(e.format,P))return t(r+" pattern has non-string items in the `format` array");o=e.format}else{if(!P(e.format))return t(r+" pattern has non-string `format` parameter");o=[e.format]}return sV.value(n(o))}return void 0===e.cmd?t(r+" pattern is missing both `format` and `cmd` parameters"):P(e.cmd)?sV.value(o(e.cmd,e.value)):t(r+" pattern has non-string `cmd` parameter")};if(!L(e))return t("Raw pattern is not an object");if(!P(e.start))return t("Raw pattern is missing `start` parameter");if(void 0!==e.end){if(!P(e.end))return t("Inline pattern has non-string `end` parameter");if(0===e.start.length&&0===e.end.length)return t("Inline pattern has empty `start` and `end` parameters");let n=e.start,o=e.end;return 0===o.length&&(o=n,n=""),r("Inline",e=>({type:"inline-format",start:n,end:o,format:e}),(e,t)=>({type:"inline-command",start:n,end:o,cmd:e,value:t}))}return void 0!==e.replacement?P(e.replacement)?0===e.start.length?t("Replacement pattern has empty `start` parameter"):sV.value({type:"inline-command",start:"",end:e.start,cmd:"mceInsertContent",value:e.replacement}):t("Replacement pattern has non-string `replacement` parameter"):0===e.start.length?t("Block pattern has empty `start` parameter"):r("Block",t=>({type:"block-format",start:e.start,format:t[0]}),(t,r)=>({type:"block-command",start:e.start,cmd:t,value:r}))},sQ=e=>eb(e,sY),sJ=e=>eb(e,sG),sZ=(e,t)=>({inlinePatterns:sJ(e),blockPatterns:sQ(e),dynamicPatternsLookup:t}),s0=e=>{let t=sK(ef(e,sX));return eg(t.errors,e=>console.error(e.message,e.pattern)),t.values},s1=e=>t=>s0(e(t)),s2=tV().deviceType,s3=s2.isTouch(),s8=it.DOM,s5=e=>ey(e.indexOf("=")>0?e.split(/[;,](?![^=;,]*(?:[;,]|$))/):e.split(","),(e,t)=>{let r=t.split("="),n=r[0],o=r.length>1?r[1]:n;return e[tg(n)]=tg(o),e},{}),s6=e=>B(e,RegExp),s9=e=>t=>t.options.get(e),s4=e=>P(e)||L(e),s7=(e,t="")=>r=>{let n=P(r);return n?-1!==r.indexOf("=")?{value:eK(s5(r),e.id).getOr(t),valid:n}:{value:r,valid:n}:{valid:!1,message:"Must be a string."}},de=e=>{let t=e.options.register;t("id",{processor:"string",default:e.id}),t("selector",{processor:"string"}),t("target",{processor:"object"}),t("suffix",{processor:"string"}),t("cache_suffix",{processor:"string"}),t("base_url",{processor:"string"}),t("referrer_policy",{processor:"string",default:""}),t("language_load",{processor:"boolean",default:!0}),t("inline",{processor:"boolean",default:!1}),t("iframe_attrs",{processor:"object",default:{}}),t("doctype",{processor:"string",default:"<!DOCTYPE html>"}),t("document_base_url",{processor:"string",default:e.documentBaseUrl}),t("body_id",{processor:s7(e,"tinymce"),default:"tinymce"}),t("body_class",{processor:s7(e),default:""}),t("content_security_policy",{processor:"string",default:""}),t("br_in_pre",{processor:"boolean",default:!0}),t("forced_root_block",{processor:e=>{let t=P(e)&&tb(e);return t?{value:e,valid:t}:{valid:!1,message:"Must be a non-empty string."}},default:"p"}),t("forced_root_block_attrs",{processor:"object",default:{}}),t("newline_behavior",{processor:e=>{let t=em(["block","linebreak","invert","default"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be one of: block, linebreak, invert or default."}},default:"default"}),t("br_newline_selector",{processor:"string",default:".mce-toc h2,figcaption,caption"}),t("no_newline_selector",{processor:"string",default:""}),t("keep_styles",{processor:"boolean",default:!0}),t("end_container_on_empty_block",{processor:e=>U(e)?{valid:!0,value:e}:P(e)?{valid:!0,value:e}:{valid:!1,message:"Must be boolean or a string"},default:"blockquote"}),t("font_size_style_values",{processor:"string",default:"xx-small,x-small,small,medium,large,x-large,xx-large"}),t("font_size_legacy_values",{processor:"string",default:"xx-small,small,medium,large,x-large,xx-large,300%"}),t("font_size_classes",{processor:"string",default:""}),t("automatic_uploads",{processor:"boolean",default:!0}),t("images_reuse_filename",{processor:"boolean",default:!1}),t("images_replace_blob_uris",{processor:"boolean",default:!0}),t("icons",{processor:"string",default:""}),t("icons_url",{processor:"string",default:""}),t("images_upload_url",{processor:"string",default:""}),t("images_upload_base_path",{processor:"string",default:""}),t("images_upload_credentials",{processor:"boolean",default:!1}),t("images_upload_handler",{processor:"function"}),t("language",{processor:"string",default:"en"}),t("language_url",{processor:"string",default:""}),t("entity_encoding",{processor:"string",default:"named"}),t("indent",{processor:"boolean",default:!0}),t("indent_before",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_after",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_use_margin",{processor:"boolean",default:!1}),t("indentation",{processor:"string",default:"40px"}),t("content_css",{processor:e=>{let t=!1===e||P(e)||V(e,P);return t?P(e)?{value:ef(e.split(","),tg),valid:t}:M(e)?{value:e,valid:t}:!1===e?{value:[],valid:t}:{value:e,valid:t}:{valid:!1,message:"Must be false, a string or an array of strings."}},default:dQ(e)?[]:["default"]}),t("content_style",{processor:"string"}),t("content_css_cors",{processor:"boolean",default:!1}),t("font_css",{processor:e=>{let t=P(e)||V(e,P);return t?{value:M(e)?e:ef(e.split(","),tg),valid:t}:{valid:!1,message:"Must be a string or an array of strings."}},default:[]}),t("inline_boundaries",{processor:"boolean",default:!0}),t("inline_boundaries_selector",{processor:"string",default:"a[href],code,span.mce-annotation"}),t("object_resizing",{processor:e=>{let t=U(e)||P(e);return t?!1===e||s2.isiPhone()||s2.isiPad()?{value:"",valid:t}:{value:!0===e?"table,img,figure.image,div,video,iframe":e,valid:t}:{valid:!1,message:"Must be boolean or a string"}},default:!s3}),t("resize_img_proportional",{processor:"boolean",default:!0}),t("event_root",{processor:"object"}),t("service_message",{processor:"string"}),t("theme",{processor:e=>!1===e||P(e)||$(e),default:"silver"}),t("theme_url",{processor:"string"}),t("formats",{processor:"object"}),t("format_empty_lines",{processor:"boolean",default:!1}),t("format_noneditable_selector",{processor:"string",default:""}),t("preview_styles",{processor:e=>{let t=!1===e||P(e);return t?{value:!1===e?"":e,valid:t}:{valid:!1,message:"Must be false or a string"}},default:"font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"}),t("custom_ui_selector",{processor:"string",default:""}),t("hidden_input",{processor:"boolean",default:!0}),t("submit_patch",{processor:"boolean",default:!0}),t("encoding",{processor:"string"}),t("add_form_submit_trigger",{processor:"boolean",default:!0}),t("add_unload_trigger",{processor:"boolean",default:!0}),t("custom_undo_redo_levels",{processor:"number",default:0}),t("disable_nodechange",{processor:"boolean",default:!1}),t("readonly",{processor:"boolean",default:!1}),t("editable_root",{processor:"boolean",default:!0}),t("plugins",{processor:"string[]",default:[]}),t("external_plugins",{processor:"object"}),t("forced_plugins",{processor:"string[]"}),t("model",{processor:"string",default:e.hasPlugin("rtc")?"plugin":"dom"}),t("model_url",{processor:"string"}),t("block_unsupported_drop",{processor:"boolean",default:!0}),t("visual",{processor:"boolean",default:!0}),t("visual_table_class",{processor:"string",default:"mce-item-table"}),t("visual_anchor_class",{processor:"string",default:"mce-item-anchor"}),t("iframe_aria_text",{processor:"string",default:"Rich Text Area. Press ALT-0 for help."}),t("setup",{processor:"function"}),t("init_instance_callback",{processor:"function"}),t("url_converter",{processor:"function",default:e.convertURL}),t("url_converter_scope",{processor:"object",default:e}),t("urlconverter_callback",{processor:"function"}),t("allow_conditional_comments",{processor:"boolean",default:!1}),t("allow_html_data_urls",{processor:"boolean",default:!1}),t("allow_svg_data_urls",{processor:"boolean"}),t("allow_html_in_named_anchor",{processor:"boolean",default:!1}),t("allow_script_urls",{processor:"boolean",default:!1}),t("allow_unsafe_link_target",{processor:"boolean",default:!1}),t("convert_fonts_to_spans",{processor:"boolean",default:!0,deprecated:!0}),t("fix_list_elements",{processor:"boolean",default:!1}),t("preserve_cdata",{processor:"boolean",default:!1}),t("remove_trailing_brs",{processor:"boolean",default:!0}),t("pad_empty_with_br",{processor:"boolean",default:!1}),t("inline_styles",{processor:"boolean",default:!0,deprecated:!0}),t("element_format",{processor:"string",default:"html"}),t("entities",{processor:"string"}),t("schema",{processor:"string",default:"html5"}),t("convert_urls",{processor:"boolean",default:!0}),t("relative_urls",{processor:"boolean",default:!0}),t("remove_script_host",{processor:"boolean",default:!0}),t("custom_elements",{processor:"string"}),t("extended_valid_elements",{processor:"string"}),t("invalid_elements",{processor:"string"}),t("invalid_styles",{processor:s4}),t("valid_children",{processor:"string"}),t("valid_classes",{processor:s4}),t("valid_elements",{processor:"string"}),t("valid_styles",{processor:s4}),t("verify_html",{processor:"boolean",default:!0}),t("auto_focus",{processor:e=>P(e)||!0===e}),t("browser_spellcheck",{processor:"boolean",default:!1}),t("protect",{processor:"array"}),t("images_file_types",{processor:"string",default:"jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp"}),t("deprecation_warnings",{processor:"boolean",default:!0}),t("a11y_advanced_options",{processor:"boolean",default:!1}),t("api_key",{processor:"string"}),t("paste_block_drop",{processor:"boolean",default:!1}),t("paste_data_images",{processor:"boolean",default:!0}),t("paste_preprocess",{processor:"function"}),t("paste_postprocess",{processor:"function"}),t("paste_webkit_styles",{processor:"string",default:"none"}),t("paste_remove_styles_if_webkit",{processor:"boolean",default:!0}),t("paste_merge_formats",{processor:"boolean",default:!0}),t("smart_paste",{processor:"boolean",default:!0}),t("paste_as_text",{processor:"boolean",default:!1}),t("paste_tab_spaces",{processor:"number",default:4}),t("text_patterns",{processor:e=>V(e,L)||!1===e?{value:s0(!1===e?[]:e),valid:!0}:{valid:!1,message:"Must be an array of objects or false."},default:[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}]}),t("text_patterns_lookup",{processor:e=>$(e)?{value:s1(e),valid:!0}:{valid:!1,message:"Must be a single function"},default:e=>[]}),t("noneditable_class",{processor:"string",default:"mceNonEditable"}),t("editable_class",{processor:"string",default:"mceEditable"}),t("noneditable_regexp",{processor:e=>V(e,s6)?{value:e,valid:!0}:s6(e)?{value:[e],valid:!0}:{valid:!1,message:"Must be a RegExp or an array of RegExp."},default:[]}),t("table_tab_navigation",{processor:"boolean",default:!0}),t("highlight_on_focus",{processor:"boolean",default:!1}),t("xss_sanitization",{processor:"boolean",default:!0}),t("details_initial_state",{processor:e=>{let t=em(["inherited","collapsed","expanded"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),t("details_serialized_state",{processor:e=>{let t=em(["inherited","collapsed","expanded"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),t("init_content_sync",{processor:"boolean",default:!1}),t("newdocument_content",{processor:"string",default:""}),e.on("ScriptsLoaded",()=>{t("directionality",{processor:"string",default:iu.isRtl()?"rtl":void 0}),t("placeholder",{processor:"string",default:s8.getAttrib(e.getElement(),"placeholder")})})},dt=s9("iframe_attrs"),dr=s9("doctype"),dn=s9("document_base_url"),da=s9("body_id"),dl=s9("body_class"),di=s9("content_security_policy"),ds=s9("br_in_pre"),dd=s9("forced_root_block"),dc=s9("forced_root_block_attrs"),dm=s9("newline_behavior"),du=s9("br_newline_selector"),df=s9("no_newline_selector"),dg=s9("keep_styles"),dp=s9("end_container_on_empty_block"),dh=s9("automatic_uploads"),db=s9("images_reuse_filename"),dv=s9("images_replace_blob_uris"),dy=s9("icons"),dC=s9("icons_url"),dx=s9("images_upload_url"),dw=s9("images_upload_base_path"),dE=s9("images_upload_credentials"),dk=s9("images_upload_handler"),dS=s9("content_css_cors"),d_=s9("referrer_policy"),dN=s9("language"),dD=s9("language_url"),dR=s9("indent_use_margin"),dA=s9("indentation"),dO=s9("content_css"),dT=s9("content_style"),dB=s9("font_css"),dP=s9("directionality"),dL=s9("inline_boundaries_selector"),dF=s9("object_resizing"),dM=s9("resize_img_proportional"),dI=s9("placeholder"),dU=s9("event_root"),dz=s9("service_message"),dj=s9("theme"),dH=s9("theme_url"),d$=s9("model"),dq=s9("model_url"),dV=s9("inline_boundaries"),dW=s9("formats"),dK=s9("preview_styles"),dG=s9("format_empty_lines"),dY=s9("format_noneditable_selector"),dX=s9("custom_ui_selector"),dQ=s9("inline"),dJ=s9("hidden_input"),dZ=s9("submit_patch"),d0=s9("add_form_submit_trigger"),d1=s9("add_unload_trigger"),d2=s9("custom_undo_redo_levels"),d3=s9("disable_nodechange"),d8=s9("readonly"),d5=s9("editable_root"),d6=s9("content_css_cors"),d9=s9("plugins"),d4=s9("external_plugins"),d7=s9("block_unsupported_drop"),ce=s9("visual"),ct=s9("visual_table_class"),cr=s9("visual_anchor_class"),cn=s9("iframe_aria_text"),co=s9("setup"),ca=s9("init_instance_callback"),cl=s9("urlconverter_callback"),ci=s9("auto_focus"),cs=s9("browser_spellcheck"),cd=s9("protect"),cc=s9("paste_block_drop"),cm=s9("paste_data_images"),cu=s9("paste_preprocess"),cf=s9("paste_postprocess"),cg=s9("newdocument_content"),cp=s9("paste_webkit_styles"),ch=s9("paste_remove_styles_if_webkit"),cb=s9("paste_merge_formats"),cv=s9("smart_paste"),cy=s9("paste_as_text"),cC=s9("paste_tab_spaces"),cx=s9("allow_html_data_urls"),cw=s9("text_patterns"),cE=s9("text_patterns_lookup"),ck=s9("noneditable_class"),cS=s9("editable_class"),c_=s9("noneditable_regexp"),cN=s9("preserve_cdata"),cD=s9("highlight_on_focus"),cR=s9("xss_sanitization"),cA=s9("init_content_sync"),cO=e=>e.options.isSet("text_patterns_lookup"),cT=e=>t2.explode(e.options.get("font_size_style_values")),cB=e=>t2.explode(e.options.get("font_size_classes")),cP=e=>"xml"===e.options.get("encoding"),cL=e=>t2.explode(e.options.get("images_file_types")),cF=s9("table_tab_navigation"),cM=s9("details_initial_state"),cI=s9("details_serialized_state"),cU=e=>{let t=e.parentNode;t&&t.removeChild(e)},cz=e=>{let t=o4(e);return{count:e.length-t.length,text:t}},cj=e=>{let t;for(;-1!==(t=e.data.lastIndexOf("\uFEFF"));)e.deleteData(t,1)},cH=(e,t)=>(cG(e),t),c$=(e,t)=>{let r=cz(e.data.substr(0,t.offset())),n=cz(e.data.substr(t.offset()));return(r.text+n.text).length>0?(cj(e),sf(e,t.offset()-r.count)):t},cq=(e,t)=>{let r=t.container(),n=ec(eB(r.childNodes),e).map(e=>e<t.offset()?sf(r,t.offset()-1):t).getOr(t);return cG(e),n},cV=(e,t)=>ow(e)&&t.container()===e?c$(e,t):cH(e,t),cW=(e,t)=>t.container()===e.parentNode?cq(e,t):cH(e,t),cK=(e,t)=>sf.isTextPosition(t)?cV(e,t):cW(e,t),cG=e=>{ou(e)&&at(e)&&(ar(e)?e.removeAttribute("data-mce-caret"):cU(e)),ow(e)&&(cj(e),0===e.data.length&&cU(e))},cY=(e,t,r)=>{let n,o;let a=iG(t.getBoundingClientRect(),r);if("BODY"===e.tagName){let t=e.ownerDocument.documentElement;n=e.scrollLeft||t.scrollLeft,o=e.scrollTop||t.scrollTop}else{let t=e.getBoundingClientRect();n=e.scrollLeft-t.left,o=e.scrollTop-t.top}a.left+=n,a.right+=n,a.top+=o,a.bottom+=o,a.width=1;let l=t.offsetWidth-t.clientWidth;return l>0&&(r&&(l*=-1),a.left+=l,a.right+=l),a},cX=e=>{var t,r;let n=oi(rz.fromDom(e),"*[contentEditable=false],video,audio,embed,object");for(let e=0;e<n.length;e++){let o=n[e].dom,a=o.previousSibling;if(as(a)){let e=a.data;1===e.length?null===(t=a.parentNode)||void 0===t||t.removeChild(a):a.deleteData(e.length-1,1)}ai(a=o.nextSibling)&&(1===a.data.length?null===(r=a.parentNode)||void 0===r||r.removeChild(a):a.deleteData(0,1))}},cQ=(e,t,r,n)=>{let o,a;let l=ib(),i=dd(e),s=e.dom,d=()=>{cX(t),a&&(cG(a),a=null),l.on(e=>{s.remove(e.caret),l.clear()}),o&&(clearInterval(o),o=void 0)},c=()=>{o=setInterval(()=>{l.on(e=>{n()?s.toggleClass(e.caret,"mce-visual-caret-hidden"):s.addClass(e.caret,"mce-visual-caret-hidden")})},500)};return{show:(e,n)=>{let o;if(d(),oT(n))return null;if(r(n)){let r=al(i,n,e),d=cY(t,n,e);s.setStyle(r,"top",d.top),a=r;let m=s.create("div",{class:"mce-visual-caret","data-mce-bogus":"all"});s.setStyles(m,{...d}),s.add(t,m),l.set({caret:m,element:n,before:e}),e&&s.addClass(m,"mce-visual-caret-before"),c(),(o=n.ownerDocument.createRange()).setStart(r,0),o.setEnd(r,0)}else a=an(n,e),o=n.ownerDocument.createRange(),cZ(a.nextSibling)?(o.setStart(a,0),o.setEnd(a,0)):(o.setStart(a,1),o.setEnd(a,1));return o},hide:d,getCss:()=>".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}",reposition:()=>{l.on(e=>{let r=cY(t,e.element,e.before);s.setStyles(e.caret,{...r})})},destroy:()=>clearInterval(o)}},cJ=()=>tJ.browser.isFirefox(),cZ=e=>oO(e)||oP(e),c0=e=>(cZ(e)||oy(e)&&cJ())&&rZ(rz.fromDom(e)).exists(nk),c1=op("display","block table table-cell table-caption list-item"),c2=e=>e>0,c3=e=>e<0,c8=(e,t)=>{let r;for(;r=e(t);)if(!o7(r))return r;return null},c5=(e,t,r,n,o)=>{let a;let l=new od(e,n),i=oO(e)||o7(e);if(c3(t)){if(i&&r(a=c8(l.prev.bind(l),!0)))return a;for(;a=c8(l.prev.bind(l),o);)if(r(a))return a}if(c2(t)){if(i&&r(a=c8(l.next.bind(l),!0)))return a;for(;a=c8(l.next.bind(l),o);)if(r(a))return a}return null},c6=(e,t)=>np(rz.fromDom(e),e=>oA(e.dom),e=>e.dom===t).map(e=>e.dom).getOr(t),c9=(e,t)=>{for(;e&&e!==t;){if(c1(e))return e;e=e.parentNode}return null},c4=(e,t,r)=>c9(e.container(),r)===c9(t.container(),r),c7=(e,t)=>{if(!t)return ea.none();let r=t.container(),n=t.offset();return ou(r)?ea.from(r.childNodes[n+e]):ea.none()},me=(e,t)=>{var r;let n=(null!==(r=t.ownerDocument)&&void 0!==r?r:document).createRange();return e?(n.setStartBefore(t),n.setEndBefore(t)):(n.setStartAfter(t),n.setEndAfter(t)),n},mt=(e,t,r)=>c9(t,e)===c9(r,e),mr=(e,t,r)=>{let n=e?"previousSibling":"nextSibling",o=r;for(;o&&o!==t;){let e=o[n];if(e&&at(e)&&(e=e[n]),oO(e)||oP(e)){if(mt(t,e,o))return e;break}if(ap(e))break;o=o.parentNode}return null},mn=J(me,!0),mo=J(me,!1),ma=(e,t,r)=>{let n;let o=J(mr,!0,t),a=J(mr,!1,t),l=r.startContainer,i=r.startOffset;if(o7(l)){let e=ow(l)?l.parentNode:l,t=e.getAttribute("data-mce-caret");if("before"===t&&c0(n=e.nextSibling))return mn(n);if("after"===t&&c0(n=e.previousSibling))return mo(n)}if(!r.collapsed)return r;if(ow(l)){if(at(l)){if(1===e){if(n=a(l))return mn(n);if(n=o(l))return mo(n)}if(-1===e){if(n=o(l))return mo(n);if(n=a(l))return mn(n)}return r}if(as(l)&&i>=l.data.length-1)return 1===e&&(n=a(l))?mn(n):r;if(ai(l)&&i<=1)return -1===e&&(n=o(l))?mo(n):r;if(i===l.data.length)return(n=a(l))?mn(n):r;if(0===i&&(n=o(l)))return mo(n)}return r},ml=(e,t)=>c7(e?0:-1,t).filter(oO),mi=(e,t,r)=>{let n=ma(e,t,r);return -1===e?sf.fromRangeStart(n):sf.fromRangeEnd(n)},ms=e=>ea.from(e.getNode()).map(rz.fromDom),md=e=>ea.from(e.getNode(!0)).map(rz.fromDom),mc=(e,t)=>{let r=t;for(;(r=e(r))&&!r.isVisible(););return r},mm=(e,t)=>{let r=c4(e,t);return!!(!r&&oD(e.getNode()))||r};(d=p||(p={}))[d.Backwards=-1]="Backwards",d[d.Forwards=1]="Forwards";let mu=e=>af(e)||ay(e),mf=(e,t)=>{let r=[],n=e;for(;n&&n!==t;)r.push(n),n=n.parentNode;return r},mg=(e,t)=>e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null,mp=(e,t)=>{if(c2(e)){if(ap(t.previousSibling)&&!ow(t.previousSibling))return sf.before(t);if(ow(t))return sf(t,0)}if(c3(e)){if(ap(t.nextSibling)&&!ow(t.nextSibling))return sf.after(t);if(ow(t))return sf(t,t.data.length)}return c3(e)?oD(t)?sf.before(t):sf.after(t):sf.before(t)},mh=(e,t)=>{let r=t.nextSibling;return r&&ap(r)?ow(r)?sf(r,0):sf.before(r):mb(p.Forwards,sf.after(t),e)},mb=(e,t,r)=>{let n,o,a,l;if(!ou(r)||!t)return null;if(t.isEqual(sf.after(r))&&r.lastChild){if(l=sf.after(r.lastChild),c3(e)&&ap(r.lastChild)&&ou(r.lastChild))return oD(r.lastChild)?sf.before(r.lastChild):l}else l=t;let i=l.container(),s=l.offset();if(ow(i)){if(c3(e)&&s>0)return sf(i,--s);if(c2(e)&&s<i.length)return sf(i,++s);n=i}else{if(c3(e)&&s>0&&ap(o=mg(i,s-1)))return!mu(o)&&(a=c5(o,e,aC,o))?ow(a)?sf(a,a.data.length):sf.after(a):ow(o)?sf(o,o.data.length):sf.before(o);if(c2(e)&&s<i.childNodes.length&&ap(o=mg(i,s)))return oD(o)?mh(r,o):!mu(o)&&(a=c5(o,e,aC,o))?ow(a)?sf(a,0):sf.before(a):ow(o)?sf(o,0):sf.after(o);n=o||l.getNode()}if(n&&(c2(e)&&l.isAtEnd()||c3(e)&&l.isAtStart())&&aC(n=c5(n,e,eo,r,!0),r))return mp(e,n);o=n?c5(n,e,aC,r):n;let d=e5(eb(mf(i,r),oO));return!d||o&&d.contains(o)?o?mp(e,o):null:l=c2(e)?sf.after(d):sf.before(d)},mv=e=>({next:t=>mb(p.Forwards,t,e),prev:t=>mb(p.Backwards,t,e)}),my=(e,t,r)=>{let n=e?sf.before(r):sf.after(r);return m_(e,t,n)},mC=e=>oD(e)?sf.before(e):sf.after(e),mx=e=>sf.isTextPosition(e)?0===e.offset():ap(e.getNode()),mw=e=>{if(!sf.isTextPosition(e))return ap(e.getNode(!0));{let t=e.container();return e.offset()===t.data.length}},mE=(e,t)=>!sf.isTextPosition(e)&&!sf.isTextPosition(t)&&e.getNode()===t.getNode(!0),mk=e=>!sf.isTextPosition(e)&&oD(e.getNode()),mS=(e,t,r)=>e?!mE(t,r)&&!mk(t)&&mw(t)&&mx(r):!mE(r,t)&&mx(t)&&mw(r),m_=(e,t,r)=>{let n=mv(t);return ea.from(e?n.next(r):n.prev(r))},mN=(e,t,r)=>m_(e,t,r).bind(n=>c4(r,n,t)&&mS(e,r,n)?m_(e,t,n):ea.some(n)),mD=(e,t,r,n)=>mN(e,t,r).bind(r=>n(r)?mD(e,t,r,n):ea.some(r)),mR=(e,t)=>{let r=e?t.firstChild:t.lastChild;return ow(r)?ea.some(sf(r,e?0:r.data.length)):r?ap(r)?ea.some(e?sf.before(r):mC(r)):my(e,t,r):ea.none()},mA=J(m_,!0),mO=J(m_,!1),mT=J(mR,!0),mB=J(mR,!1),mP="_mce_caret",mL=e=>ou(e)&&e.id===mP,mF=(e,t)=>{let r=t;for(;r&&r!==e;){if(mL(r))return r;r=r.parentNode}return null},mM=e=>P(e.start),mI=e=>eG(e,"rng"),mU=e=>eG(e,"id"),mz=e=>eG(e,"name"),mj=e=>t2.isArray(e.start),mH=e=>!(!mz(e)&&U(e.forward))||e.forward,m$=(e,t)=>(ou(t)&&e.isBlock(t)&&!t.innerHTML&&(t.innerHTML='<br data-mce-bogus="1" />'),t),mq=(e,t)=>t6(ea.from(sR(e.getRoot(),t.start)),ea.from(sR(e.getRoot(),t.end)),(r,n)=>{let o=e.createRng();return o.setStart(r.container(),r.offset()),o.setEnd(n.container(),n.offset()),{range:o,forward:mH(t)}}),mV=(e,t)=>{var r;let n=(null!==(r=e.ownerDocument)&&void 0!==r?r:document).createTextNode("\uFEFF");e.appendChild(n),t.setStart(n,0),t.setEnd(n,0)},mW=e=>!e.hasChildNodes(),mK=(e,t)=>mB(e).fold(en,e=>(t.setStart(e.container(),e.offset()),t.setEnd(e.container(),e.offset()),!0)),mG=(e,t,r)=>!!(mW(t)&&mF(e,t))&&(mV(t,r),!0),mY=(e,t,r,n)=>{let o=r[t?"start":"end"],a=e.getRoot();if(o){let e=a,r=o[0];for(let t=o.length-1;e&&t>=1;t--){let r=e.childNodes;if(mG(a,e,n))return!0;if(o[t]>r.length-1){if(mG(a,e,n))return!0;return mK(e,n)}e=r[o[t]]}ow(e)&&(r=Math.min(o[0],e.data.length)),ou(e)&&(r=Math.min(o[0],e.childNodes.length)),t?n.setStart(e,r):n.setEnd(e,r)}return!0},mX=e=>ow(e)&&e.data.length>0,mQ=(e,t,r)=>{let n=e.get(r.id+"_"+t),o=null==n?void 0:n.parentNode,a=r.keep;if(!n||!o)return ea.none();{let l,i;if("start"===t?a?n.hasChildNodes()?(l=n.firstChild,i=1):mX(n.nextSibling)?(l=n.nextSibling,i=0):mX(n.previousSibling)?(l=n.previousSibling,i=n.previousSibling.data.length):(l=o,i=e.nodeIndex(n)+1):(l=o,i=e.nodeIndex(n)):a?n.hasChildNodes()?(l=n.firstChild,i=1):mX(n.previousSibling)?(l=n.previousSibling,i=n.previousSibling.data.length):(l=o,i=e.nodeIndex(n)):(l=o,i=e.nodeIndex(n)),!a){let o;let a=n.previousSibling,s=n.nextSibling;for(t2.each(t2.grep(n.childNodes),e=>{ow(e)&&(e.data=e.data.replace(/\uFEFF/g,""))});o=e.get(r.id+"_"+t);)e.remove(o,!0);if(ow(s)&&ow(a)&&!tJ.browser.isOpera()){let t=a.data.length;a.appendData(s.data),e.remove(s),l=a,i=t}}return ea.some(sf(l,i))}},mJ=(e,t)=>{let r=e.createRng();return mY(e,!0,t,r)&&mY(e,!1,t,r)?ea.some({range:r,forward:mH(t)}):ea.none()},mZ=(e,t)=>{let r=mQ(e,"start",t);return t6(r,mQ(e,"end",t).or(r),(r,n)=>{let o=e.createRng();return o.setStart(m$(e,r.container()),r.offset()),o.setEnd(m$(e,n.container()),n.offset()),{range:o,forward:mH(t)}})},m0=(e,t)=>ea.from(e.select(t.name)[t.index]).map(t=>{let r=e.createRng();return r.selectNode(t),{range:r,forward:!0}}),m1=(e,t)=>{let r=e.dom;if(t){if(mj(t))return mJ(r,t);if(mM(t))return mq(r,t);if(mU(t))return mZ(r,t);if(mz(t))return m0(r,t);else if(mI(t))return ea.some({range:t.rng,forward:mH(t)})}return ea.none()},m2=(e,t,r)=>s$(e,t,r),m3=(e,t)=>{m1(e,t).each(({range:t,forward:r})=>{e.setRng(t,r)})},m8=e=>ou(e)&&"SPAN"===e.tagName&&"bookmark"===e.getAttribute("data-mce-type"),m5=e=>"\xa0"===e,m6=e=>""!==e&&-1!==" \f\n\r	\v".indexOf(e),m9=e=>!m6(e)&&!m5(e)&&!oI(e),m4=e=>({value:m7(e)}),m7=e=>td(e,"#").toUpperCase(),ue=e=>{let t=e.toString(16);return(1===t.length?"0"+t:t).toUpperCase()},ut=e=>m4(ue(e.red)+ue(e.green)+ue(e.blue)),ur=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,un=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,uo=(e,t,r,n)=>({red:e,green:t,blue:r,alpha:n}),ua=(e,t,r,n)=>{let o=parseInt(e,10);return uo(o,parseInt(t,10),parseInt(r,10),parseFloat(n))},ul=e=>{if("transparent"===e)return ea.some(uo(0,0,0,0));let t=ur.exec(e);if(null!==t)return ea.some(ua(t[1],t[2],t[3],"1"));let r=un.exec(e);return null!==r?ea.some(ua(r[1],r[2],r[3],r[4])):ea.none()},ui=e=>ul(e).map(ut).map(e=>"#"+e.value).getOr(e),us=e=>{let t=[];if(e)for(let r=0;r<e.rangeCount;r++)t.push(e.getRangeAt(r));return t},ud=e=>ek(e,e=>{let t=i8(e);return t?[rz.fromDom(t)]:[]}),uc=e=>us(e).length>1,um=e=>eb(ud(e),oZ),uu=e=>oi(e,"td[data-mce-selected],th[data-mce-selected]"),uf=(e,t)=>{let r=uu(t);return r.length>0?r:um(e)},ug=e=>uf(us(e.selection.getSel()),rz.fromDom(e.getBody())),up=(e,t)=>nC(e,"table",t),uh=e=>{let t=e.startContainer,r=e.startOffset;return ow(t)?0===r?ea.some(rz.fromDom(t)):ea.none():ea.from(t.childNodes[r]).map(rz.fromDom)},ub=e=>{let t=e.endContainer,r=e.endOffset;return ow(t)?r===t.data.length?ea.some(rz.fromDom(t)):ea.none():ea.from(t.childNodes[r-1]).map(rz.fromDom)},uv=e=>r4(e).fold(Y([e]),t=>[e].concat(uv(t))),uy=e=>r7(e).fold(Y([e]),t=>"br"===ri(t)?r2(t).map(t=>[e].concat(uy(t))).getOr([]):[e].concat(uy(t))),uC=(e,t)=>t6(uh(t),ub(t),(t,r)=>{let n=ex(uv(e),J(rW,t)),o=ex(uy(e),J(rW,r));return n.isSome()&&o.isSome()}).getOr(!1),ux=(e,t,r,n)=>{let o=new od(r,r),a=eq(e.schema.getMoveCaretBeforeOnEnterElements(),(e,t)=>!em(["td","th","table"],t.toLowerCase())),l=r;do{if(ow(l)&&0!==t2.trim(l.data).length){n?t.setStart(l,0):t.setEnd(l,l.data.length);return}if(a[l.nodeName]){n?t.setStartBefore(l):"BR"===l.nodeName?t.setEndBefore(l):t.setEndAfter(l);return}}while(l=n?o.next():o.prev());"BODY"===r.nodeName&&(n?t.setStart(r,0):t.setEnd(r,r.childNodes.length))},uw=e=>{let t=e.selection.getSel();return H(t)&&t.rangeCount>0},uE=(e,t)=>{let r=ug(e);r.length>0?eg(r,r=>{let n=r.dom,o=e.dom.createRng();o.setStartBefore(n),o.setEndAfter(n),t(o,!0)}):t(e.selection.getRng(),!1)},uk=(e,t,r)=>{let n=sH(e,t);r(n),e.moveToBookmark(n)},uS=e=>q(null==e?void 0:e.nodeType),u_=e=>ou(e)&&!m8(e)&&!mL(e)&&!ob(e),uN=(e,t)=>{if(!u_(t)||/^(TD|TH)$/.test(t.nodeName))return!1;{let r=parseInt(e.getAttrib(t,"data-mce-selected"),10);return!isNaN(r)&&r>0}},uD=e=>!0===e.isContentEditable,uR=(e,t,r)=>{let{selection:n,dom:o}=e,a=n.getNode(),l=oO(a);uk(n,!0,()=>{t()}),l&&oO(a)&&o.isChildOf(a,e.getBody())?e.selection.select(a):r(n.getStart())&&uA(o,n)},uA=(e,t)=>{var r,n;let o=t.getRng(),{startContainer:a,startOffset:l}=o;if(!uN(e,t.getNode())&&ou(a)){let i;let s=a.childNodes,d=e.getRoot();if(l<s.length){let t=s[l];i=new od(t,null!==(r=e.getParent(t,e.isBlock))&&void 0!==r?r:d)}else{let t=s[s.length-1];(i=new od(t,null!==(n=e.getParent(t,e.isBlock))&&void 0!==n?n:d)).next(!0)}for(let r=i.current();r;r=i.next()){if("false"===e.getContentEditable(r))return;if(ow(r)&&!uP(r)){o.setStart(r,0),t.setRng(o);return}}}},uO=(e,t,r)=>{if(e){let n=t?"nextSibling":"previousSibling";for(e=r?e:e[n];e;e=e[n])if(ou(e)||!uP(e))return e}},uT=(e,t)=>!!e.getTextBlockElements()[t.nodeName.toLowerCase()]||aJ(e,t),uB=(e,t,r)=>e.schema.isValidChild(t,r),uP=(e,t=!1)=>!!(H(e)&&ow(e))&&aw(t?e.data.replace(/ /g,"\xa0"):e.data),uL=e=>H(e)&&ow(e)&&0===e.length,uF=(e,t)=>{let r="[data-mce-cef-wrappable]",n=dY(e),o=tv(n)?r:`${r},${n}`;return rH(rz.fromDom(t),o)},uM=(e,t)=>{let r=e.dom;return u_(t)&&"false"===r.getContentEditable(t)&&uF(e,t)&&0===r.select('[contenteditable="true"]',t).length},uI=(e,t)=>$(e)?e(t):(H(t)&&(e=e.replace(/%(\w+)/g,(e,r)=>t[r]||e)),e),uU=(e,t)=>(t=t||"",e=""+((e=e||"").nodeName||e),t=""+(t.nodeName||t),e.toLowerCase()===t.toLowerCase()),uz=(e,t)=>{if(j(e))return null;{let r=String(e);return("color"===t||"backgroundColor"===t)&&(r=ui(r)),"fontWeight"===t&&700===e&&(r="bold"),"fontFamily"===t&&(r=r.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),r}},uj=(e,t,r)=>uz(e.getStyle(t,r),r),uH=(e,t)=>{let r;return e.getParent(t,t=>!!ou(t)&&!!(r=e.getStyle(t,"text-decoration"))&&"none"!==r),r},u$=(e,t,r)=>e.getParents(t,r,e.getRoot()),uq=(e,t,r)=>{let n=e.formatter.get(t);return H(n)&&eu(n,r)},uV=(e,t)=>uq(e,t,e=>{let t=e=>$(e)||e.length>1&&"%"===e.charAt(0);return eu(["styles","attributes"],r=>eK(e,r).exists(e=>eu(M(e)?e:eW(e),t)))}),uW=(e,t,r)=>{let n=["inline","block","selector","attributes","styles","classes"],o=e=>eq(e,(e,t)=>eu(n,e=>e===t));return uq(e,t,t=>{let n=o(t);return uq(e,r,e=>eX(n,o(e)))})},uK=e=>eY(e,"block"),uG=e=>uK(e)&&!0===e.wrapper,uY=e=>uK(e)&&!0!==e.wrapper,uX=e=>eY(e,"selector"),uQ=e=>eY(e,"inline"),uJ=e=>uX(e)&&uQ(e)&&t3(eK(e,"mixed"),!0),uZ=e=>uX(e)&&!1!==e.expand&&!uQ(e),u0=e=>oD(e)&&e.getAttribute("data-mce-bogus")&&!e.nextSibling,u1=(e,t)=>{let r=t;for(;r;){if(ou(r)&&e.getContentEditable(r))return"false"===e.getContentEditable(r)?r:t;r=r.parentNode}return t},u2=(e,t,r,n)=>{let o=t.data;if(e){for(let e=r;e>0;e--)if(n(o.charAt(e-1)))return e}else for(let e=r;e<o.length;e++)if(n(o.charAt(e)))return e;return -1},u3=(e,t,r)=>u2(e,t,r,e=>m5(e)||m6(e)),u8=(e,t,r)=>u2(e,t,r,m9),u5=(e,t,r,n,o,a)=>{let l;let i=e.getParent(r,e.isBlock)||t,s=(t,r,n)=>{let a=iV(e),s=o?a.backwards:a.forwards;return ea.from(s(t,r,(e,t)=>m8(e.parentNode)?-1:(l=e,n(o,e,t)),i))};return s(r,n,u3).bind(e=>a?s(e.container,e.offset+(o?-1:0),u8):ea.some(e)).orThunk(()=>l?ea.some({container:l,offset:o?0:l.length}):ea.none())},u6=(e,t,r,n,o)=>{let a=n[o];ow(n)&&tv(n.data)&&a&&(n=a);let l=u$(e,n);for(let n=0;n<l.length;n++)for(let o=0;o<t.length;o++){let a=t[o];if((!H(a.collapsed)||a.collapsed===r.collapsed)&&uX(a)&&e.is(l[n],a.selector))return l[n]}return n},u9=(e,t,r,n)=>{var o;let a=r,l=e.getRoot(),i=t[0];if(uK(i)&&(a=i.wrapper?null:e.getParent(r,i.block,l)),!a){let t=null!==(o=e.getParent(r,"LI,TD,TH"))&&void 0!==o?o:l;a=e.getParent(ow(r)?r.parentNode:r,t=>t!==l&&uT(e.schema,t),t)}if(a&&uK(i)&&i.wrapper&&(a=u$(e,a,"ul,ol").reverse()[0]||a),!a)for(a=r;a&&a[n]&&!e.isBlock(a[n])&&!uU(a=a[n],"br"););return a||r},u4=(e,t,r,n)=>{let o=r.parentNode;return!H(r[n])&&(!!(o===t||j(o)||e.isBlock(o))||u4(e,t,o,n))},u7=(e,t,r,n,o)=>{let a=r,l=o?"previousSibling":"nextSibling",i=e.getRoot();if(ow(r)&&!uP(r)&&(o?n>0:n<r.data.length))return r;for(;a;){if(!t[0].block_expand&&e.isBlock(a))return a;for(let t=a[l];t;t=t[l]){let r=ow(t)&&!u4(e,i,t,l);if(!m8(t)&&!u0(t)&&!uP(t,r))return a}if(a===i||a.parentNode===i){r=a;break}a=a.parentNode}return r},fe=e=>m8(e.parentNode)||m8(e),ft=(e,t,r,n=!1)=>{let{startContainer:o,startOffset:a,endContainer:l,endOffset:i}=t,s=r[0];return ou(o)&&o.hasChildNodes()&&ow(o=i5(o,a))&&(a=0),ou(l)&&l.hasChildNodes()&&ow(l=i5(l,t.collapsed?i:i-1))&&(i=l.data.length),o=u1(e,o),l=u1(e,l),fe(o)&&(o=m8(o)?o:o.parentNode,ow(o=t.collapsed?o.previousSibling||o:o.nextSibling||o)&&(a=t.collapsed?o.length:0)),fe(l)&&(l=m8(l)?l:l.parentNode,ow(l=t.collapsed?l.nextSibling||l:l.previousSibling||l)&&(i=t.collapsed?0:l.length)),t.collapsed&&(u5(e,e.getRoot(),o,a,!0,n).each(({container:e,offset:t})=>{o=e,a=t}),u5(e,e.getRoot(),l,i,!1,n).each(({container:e,offset:t})=>{l=e,i=t})),(uQ(s)||s.block_expand)&&(uQ(s)&&ow(o)&&0!==a||(o=u7(e,r,o,a,!0)),uQ(s)&&ow(l)&&i!==l.data.length||(l=u7(e,r,l,i,!1))),uZ(s)&&(o=u6(e,r,t,o,"previousSibling"),l=u6(e,r,t,l,"nextSibling")),(uK(s)||uX(s))&&(o=u9(e,r,o,"previousSibling"),l=u9(e,r,l,"nextSibling"),uK(s)&&(e.isBlock(o)||(o=u7(e,r,o,a,!0)),e.isBlock(l)||(l=u7(e,r,l,i,!1)))),ou(o)&&o.parentNode&&(a=e.nodeIndex(o),o=o.parentNode),ou(l)&&l.parentNode&&(i=e.nodeIndex(l)+1,l=l.parentNode),{startContainer:o,startOffset:a,endContainer:l,endOffset:i}},fr=(e,t,r)=>{var n;let o=t.startOffset,a=i5(t.startContainer,o),l=t.endOffset,i=i5(t.endContainer,l-1),s=e=>{let t=e[0];ow(t)&&t===a&&o>=t.data.length&&e.splice(0,1);let r=e[e.length-1];return 0===l&&e.length>0&&r===i&&ow(r)&&e.splice(e.length-1,1),e},d=(e,t,r)=>{let n=[];for(;e&&e!==r;e=e[t])n.push(e);return n},c=(t,r)=>e.getParent(t,e=>e.parentNode===r,r),m=(e,t,n)=>{let o=n?"nextSibling":"previousSibling";for(let a=e,l=a.parentNode;a&&a!==t;a=l){l=a.parentNode;let t=d(a===e?a:a[o],o);t.length&&(n||t.reverse(),r(s(t)))}};if(a===i)return r(s([a]));let u=null!==(n=e.findCommonAncestor(a,i))&&void 0!==n?n:e.getRoot();if(e.isChildOf(a,i))return m(a,u,!0);if(e.isChildOf(i,a))return m(i,u);let f=c(a,u)||a,g=c(i,u)||i;m(a,f,!0);let p=d(f===a?f:f.nextSibling,"nextSibling",g===i?g.nextSibling:g);p.length&&r(s(p)),m(i,g)},fn=['pre[class*=language-][contenteditable="false"]',"figure.image","div[data-ephox-embed-iri]","div.tiny-pageembed","div.mce-toc","div[data-mce-toc]"],fo=e=>rf(e)&&"\uFEFF"===oz(e),fa=(e,t,r,n)=>rJ(t).fold(()=>"skipping",o=>"br"===n||fo(t)?"valid":iD(t)?"existing":mL(t.dom)?"caret":eu(fn,e=>rH(t,e))?"valid-block":uB(e,r,n)&&uB(e,ri(o),r)?"valid":"invalid-child"),fl=(e,t)=>{let r=ft(e.dom,t,[{inline:"span"}]);t.setStart(r.startContainer,r.startOffset),t.setEnd(r.endContainer,r.endOffset),e.selection.setRng(t)},fi=(e,t,r,n,o,a)=>{let{uid:l=t,...i}=r;rP(e,iC()),rv(e,`${iw()}`,l),rv(e,`${ix()}`,n);let{attributes:s={},classes:d=[]}=o(l,i);if(ry(e,s),iM(e,d),a){d.length>0&&rv(e,`${ik()}`,d.join(","));let t=eF(s);t.length>0&&rv(e,`${iS()}`,t.join(","))}},fs=e=>{rF(e,iC()),rE(e,`${iw()}`),rE(e,`${ix()}`),rE(e,`${iE()}`);let t=rx(e,`${iS()}`).map(e=>e.split(",")).getOr([]),r=rx(e,`${ik()}`).map(e=>e.split(",")).getOr([]);eg(t,t=>rE(e,t)),iI(e,r),rE(e,`${ik()}`),rE(e,`${iS()}`)},fd=(e,t,r,n,o)=>{let a=rz.fromTag("span",e);return fi(a,t,r,n,o,!1),a},fc=(e,t,r,n,o,a)=>{let l=[],i=fd(e.getDoc(),r,a,n,o),s=ib(),d=()=>{s.clear()},c=()=>s.get().getOrThunk(()=>{let e=iz(i);return l.push(e),s.set(e),e}),m=e=>{eg(e,u)},u=t=>{switch(fa(e,t,"span",ri(t))){case"invalid-child":d(),m(r6(t)),d();break;case"valid-block":d(),fi(t,r,a,n,o,!0);break;case"valid":nj(t,c())}},f=e=>{m(ef(e,rz.fromDom))};return fr(e.dom,t,e=>{d(),f(e)}),l},fm=(e,t,r,n)=>{e.undoManager.transact(()=>{let o=e.selection,a=o.getRng(),l=ug(e).length>0,i=iF("mce-annotation");if(a.collapsed&&!l&&fl(e,a),o.getRng().collapsed&&!l){let a=fd(e.getDoc(),i,n,t,r.decorate);nX(a,"\xa0"),o.getRng().insertNode(a.dom),o.select(a.dom)}else uk(o,!1,()=>{uE(e,o=>{fc(e,o,i,t,r.decorate,n)})})})},fu=e=>{let t=iP();iB(e,t);let r=iT(e,t),n=rh("span"),o=e=>{eg(e,e=>{n(e)?nW(e):fs(e)})};return{register:(e,r)=>{t.register(e,r)},annotate:(r,n)=>{t.lookup(r).each(t=>{fm(e,r,t,n)})},annotationChanged:(e,t)=>{r.addListener(e,t)},remove:t=>{iN(e,ea.some(t)).each(({elements:t})=>{let r=e.selection.getBookmark();o(t),e.selection.moveToBookmark(r)})},removeAll:t=>{let r=e.selection.getBookmark();eI(iO(e,t),(e,t)=>{o(e)}),e.selection.moveToBookmark(r)},getAll:t=>eU(iO(e,t),e=>ef(e,e=>e.dom))}},ff=e=>({getBookmark:J(m2,e),moveToBookmark:J(m3,e)});ff.isBookmarkNode=m8;let fg=(e,t,r)=>!r.collapsed&&eu(r.getClientRects(),r=>iZ(r,e,t)),fp=(e,t)=>e.dispatch("PreProcess",t),fh=(e,t)=>e.dispatch("PostProcess",t),fb=e=>{e.dispatch("remove")},fv=e=>{e.dispatch("detach")},fy=(e,t)=>{e.dispatch("SwitchMode",{mode:t})},fC=(e,t,r,n,o)=>{e.dispatch("ObjectResizeStart",{target:t,width:r,height:n,origin:o})},fx=(e,t,r,n,o)=>{e.dispatch("ObjectResized",{target:t,width:r,height:n,origin:o})},fw=e=>{e.dispatch("PreInit")},fE=e=>{e.dispatch("PostRender")},fk=e=>{e.dispatch("Init")},fS=(e,t)=>{e.dispatch("PlaceholderToggle",{state:t})},f_=(e,t,r)=>{e.dispatch(t,r)},fN=(e,t,r,n)=>{e.dispatch("FormatApply",{format:t,node:r,vars:n})},fD=(e,t,r,n)=>{e.dispatch("FormatRemove",{format:t,node:r,vars:n})},fR=(e,t)=>e.dispatch("BeforeSetContent",t),fA=(e,t)=>e.dispatch("SetContent",t),fO=(e,t)=>e.dispatch("BeforeGetContent",t),fT=(e,t)=>e.dispatch("GetContent",t),fB=(e,t)=>{e.dispatch("AutocompleterStart",t)},fP=(e,t)=>{e.dispatch("AutocompleterUpdate",t)},fL=e=>{e.dispatch("AutocompleterEnd")},fF=(e,t,r)=>e.dispatch("PastePreProcess",{content:t,internal:r}),fM=(e,t,r)=>e.dispatch("PastePostProcess",{node:t,internal:r}),fI=(e,t)=>e.dispatch("PastePlainTextToggle",{state:t}),fU=(e,t)=>e.dispatch("EditableRootStateChange",{state:t}),fz={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:e=>e.shiftKey||e.ctrlKey||e.altKey||fz.metaKeyPressed(e),metaKeyPressed:e=>tJ.os.isMacOS()||tJ.os.isiOS()?e.metaKey:e.ctrlKey&&!e.altKey},fj="data-mce-selected",fH=Math.abs,f$=Math.round,fq={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},fV=e=>"longpress"===e.type||0===e.type.indexOf("touch"),fW=(e,t)=>{let r,n,o,a,l,i,s,d,c,m,u,f,g,p,h,b,v;let y=t.dom,C=t.getDoc(),x=document,w=t.getBody(),E=e=>H(e)&&(oR(e)||y.is(e,"figure.image")),k=e=>oP(e)||y.hasClass(e,"mce-preview-object"),S=(e,t)=>{if(!fV(e))return E(e.target)&&!fg(e.clientX,e.clientY,t);{let r=e.touches[0];return E(e.target)&&!fg(r.clientX,r.clientY,t)}},_=e=>{let r=e.target;S(e,t.selection.getRng())&&!e.isDefaultPrevented()&&t.selection.select(r)},N=e=>y.hasClass(e,"mce-preview-object")&&H(e.firstElementChild)?[e,e.firstElementChild]:y.is(e,"figure.image")?[e.querySelector("img")]:[e],D=e=>{let r=dF(t);return!!r&&"false"!==e.getAttribute("data-mce-resize")&&e!==t.getBody()&&(y.hasClass(e,"mce-preview-object")&&H(e.firstElementChild)?rH(rz.fromDom(e.firstElementChild),r):rH(rz.fromDom(e),r))},R=e=>k(e)?y.create("img",{src:tJ.transparentSrc}):e.cloneNode(!0),A=(e,r,n)=>{H(n)&&eg(N(e),e=>{e.style[r]||!t.schema.isValid(e.nodeName.toLowerCase(),r)?y.setStyle(e,r,n):y.setAttrib(e,r,""+n)})},O=(e,t,r)=>{A(e,"width",t),A(e,"height",r)},T=e=>{let l,C,x,S;l=e.screenX-i,C=e.screenY-s,p=l*a[2]+m,h=C*a[3]+u,p=p<5?5:p,h=h<5?5:h,((E(r)||k(r))&&!1!==dM(t)?!fz.modifierPressed(e):fz.modifierPressed(e))&&(fH(l)>fH(C)?(h=f$(p*f),p=f$(h/f)):(p=f$(h/f),h=f$(p*f))),O(n,p,h),x=a.startPos.x+l,S=a.startPos.y+C,x=x>0?x:0,S=S>0?S:0,y.setStyles(o,{left:x,top:S,display:"block"}),o.innerHTML=p+" &times; "+h,a[2]<0&&n.clientWidth<=p&&y.setStyle(n,"left",d+(m-p)),a[3]<0&&n.clientHeight<=h&&y.setStyle(n,"top",c+(u-h)),(l=w.scrollWidth-b)+(C=w.scrollHeight-v)!=0&&y.setStyles(o,{left:x-l,top:S-C}),g||(fC(t,r,m,u,"corner-"+a.name),g=!0)},B=()=>{let e=g;g=!1,e&&(A(r,"width",p),A(r,"height",h)),y.unbind(C,"mousemove",T),y.unbind(C,"mouseup",B),x!==C&&(y.unbind(x,"mousemove",T),y.unbind(x,"mouseup",B)),y.remove(n),y.remove(o),y.remove(l),P(r),e&&(fx(t,r,p,h,"corner-"+a.name),y.setAttrib(r,"style",y.getAttrib(r,"style"))),t.nodeChanged()},P=e=>{U();let d=y.getPos(e,w),c=d.x,g=d.y,E=e.getBoundingClientRect(),k=E.width||E.right-E.left,S=E.height||E.bottom-E.top;r!==e&&(F(),r=e,p=h=0);let _=t.dispatch("ObjectSelected",{target:e});D(e)&&!_.isDefaultPrevented()?eI(fq,(e,t)=>{let d=d=>{let p=N(r)[0];i=d.screenX,s=d.screenY,m=p.clientWidth,f=(u=p.clientHeight)/m,(a=e).name=t,a.startPos={x:k*e[0]+c,y:S*e[1]+g},b=w.scrollWidth,v=w.scrollHeight,l=y.add(w,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"}),y.setStyles(l,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),n=R(r),y.addClass(n,"mce-clonedresizable"),y.setAttrib(n,"data-mce-bogus","all"),n.contentEditable="false",y.setStyles(n,{left:c,top:g,margin:0}),O(n,k,S),n.removeAttribute(fj),w.appendChild(n),y.bind(C,"mousemove",T),y.bind(C,"mouseup",B),x!==C&&(y.bind(x,"mousemove",T),y.bind(x,"mouseup",B)),o=y.add(w,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},m+" &times; "+u)},p=y.get("mceResizeHandle"+t);p&&y.remove(p),p=y.add(w,"div",{id:"mceResizeHandle"+t,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+t+"-resize; margin:0; padding:0"}),y.bind(p,"mousedown",e=>{e.stopImmediatePropagation(),e.preventDefault(),d(e)}),e.elm=p,y.setStyles(p,{left:k*e[0]+c-p.offsetWidth/2,top:S*e[1]+g-p.offsetHeight/2})}):F(!1)},L=iv(P,0),F=(e=!0)=>{L.cancel(),U(),r&&e&&r.removeAttribute(fj),eI(fq,(e,t)=>{let r=y.get("mceResizeHandle"+t);r&&(y.unbind(r),y.remove(r))})},M=(e,t)=>y.isChildOf(e,t),I=r=>{if(g||t.removed||t.composing)return;let n="mousedown"===r.type?r.target:e.getNode(),o=nw(rz.fromDom(n),"table,img,figure.image,hr,video,span.mce-preview-object,details").map(e=>e.dom).filter(e=>y.isEditable(e.parentElement)).getOrUndefined(),a=H(o)?y.getAttrib(o,fj,"1"):"1";if(eg(y.select(`img[${fj}],hr[${fj}]`),e=>{e.removeAttribute(fj)}),H(o)&&M(o,w)&&t.hasFocus()&&(z(),M(e.getStart(!0),o)&&M(e.getEnd(!0),o))){y.setAttrib(o,fj,a),L.throttle(o);return}F()},U=()=>{eI(fq,e=>{e.elm&&(y.unbind(e.elm),delete e.elm)})},z=()=>{try{t.getDoc().execCommand("enableObjectResizing",!1,"false")}catch(e){}};return t.on("init",()=>{z(),t.on("NodeChange ResizeEditor ResizeWindow ResizeContent drop",I),t.on("keyup compositionend",e=>{r&&"TABLE"===r.nodeName&&I(e)}),t.on("hide blur",F),t.on("contextmenu longpress",_,!0)}),t.on("remove",U),{isResizable:D,showResizeRect:P,hideResizeRect:F,updateResizeRect:I,destroy:()=>{L.cancel(),r=n=l=null}}},fK=(e,t)=>{t.fold(t=>{e.setStartBefore(t.dom)},(t,r)=>{e.setStart(t.dom,r)},t=>{e.setStartAfter(t.dom)})},fG=(e,t)=>{t.fold(t=>{e.setEndBefore(t.dom)},(t,r)=>{e.setEnd(t.dom,r)},t=>{e.setEndAfter(t.dom)})},fY=(e,t,r)=>{let n=e.document.createRange();return fK(n,t),fG(n,r),n},fX=(e,t,r,n,o)=>{let a=e.document.createRange();return a.setStart(t.dom,r),a.setEnd(n.dom,o),a},fQ=sW([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),fJ=(e,t,r)=>t(rz.fromDom(r.startContainer),r.startOffset,rz.fromDom(r.endContainer),r.endOffset),fZ=(e,t)=>t.match({domRange:e=>({ltr:Y(e),rtl:ea.none}),relative:(t,r)=>({ltr:e6(()=>fY(e,t,r)),rtl:e6(()=>ea.some(fY(e,r,t)))}),exact:(t,r,n,o)=>({ltr:e6(()=>fX(e,t,r,n,o)),rtl:e6(()=>ea.some(fX(e,n,o,t,r)))})}),f0=(e,t)=>{let r=t.ltr();return r.collapsed?t.rtl().filter(e=>!1===e.collapsed).map(e=>fQ.rtl(rz.fromDom(e.endContainer),e.endOffset,rz.fromDom(e.startContainer),e.startOffset)).getOrThunk(()=>fJ(e,fQ.ltr,r)):fJ(e,fQ.ltr,r)},f1=(e,t)=>{let r=fZ(e,t);return f0(e,r)};fQ.ltr,fQ.rtl;let f2=(e,t,r,n)=>({start:e,soffset:t,finish:r,foffset:n}),f3=document.caretPositionFromPoint?(e,t,r)=>{var n,o;return ea.from(null===(o=(n=e.dom).caretPositionFromPoint)||void 0===o?void 0:o.call(n,t,r)).bind(t=>{if(null===t.offsetNode)return ea.none();let r=e.dom.createRange();return r.setStart(t.offsetNode,t.offset),r.collapse(),ea.some(r)})}:document.caretRangeFromPoint?(e,t,r)=>{var n,o;return ea.from(null===(o=(n=e.dom).caretRangeFromPoint)||void 0===o?void 0:o.call(n,t,r))}:ea.none,f8=(e,t,r)=>f3(rz.fromDom(e.document),t,r).map(e=>f2(rz.fromDom(e.startContainer),e.startOffset,rz.fromDom(e.endContainer),e.endOffset)),f5=sW([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),f6={before:f5.before,on:f5.on,after:f5.after,getStart:e=>e.fold(X,X,X)},f9=sW([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),f4=e=>e.match({domRange:e=>rz.fromDom(e.startContainer),relative:(e,t)=>f6.getStart(e),exact:(e,t,r,n)=>e}),f7=(f9.domRange,f9.relative),ge=f9.exact,gt=e=>rQ(f4(e)),gr=(e,t)=>{let r=ri(e);return"input"===r?f6.after(e):em(["br","img"],r)?0===t?f6.before(e):f6.after(e):f6.on(e,t)},gn=(e,t)=>f7(e.fold(f6.before,gr,f6.after),t.fold(f6.before,gr,f6.after)),go=(e,t,r,n)=>f7(gr(e,t),gr(r,n)),ga=e=>e.match({domRange:e=>{let t=rz.fromDom(e.startContainer),r=rz.fromDom(e.endContainer);return go(t,e.startOffset,r,e.endOffset)},relative:gn,exact:go}),gl=(e,t)=>{let r=(t||document).createDocumentFragment();return eg(e,e=>{r.appendChild(e.dom)}),rz.fromDom(r)},gi=e=>{let t=gt(e).dom,r=(e,r,n,o)=>fX(t,e,r,n,o);return f1(t,ga(e)).match({ltr:r,rtl:r})},gs=(e,t,r)=>f8(e,t,r),gd=(e,t,r)=>gs(rQ(rz.fromDom(r)).dom,e,t).map(e=>{let t=r.createRange();return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),t}).getOrUndefined(),gc=(e,t)=>H(e)&&H(t)&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset,gm=(e,t,r)=>{let n=e;for(;n&&n!==t;){if(r(n))return n;n=n.parentNode}return null},gu=(e,t,r)=>null!==gm(e,t,r),gf=(e,t,r)=>gu(e,t,e=>e.nodeName===r),gg=(e,t)=>at(e)&&!gu(e,t,mL),gp=(e,t,r)=>{let n=t.parentNode;if(n){let o;let a=new od(t,e.getParent(n,e.isBlock)||e.getRoot());for(;o=a[r?"prev":"next"]();)if(oD(o))return!0}return!1},gh=(e,t)=>{var r;return(null===(r=e.previousSibling)||void 0===r?void 0:r.nodeName)===t},gb=(e,t)=>{let r=t;for(;r&&r!==e;){if(oO(r))return!0;r=r.parentNode}return!1},gv=(e,t,r,n,o)=>{let a,l;let i=e.getRoot(),s=e.schema.getNonEmptyElements(),d=o.parentNode;if(!d)return ea.none();let c=e.getParent(d,e.isBlock)||i;if(n&&oD(o)&&t&&e.isEmpty(c))return ea.some(sf(d,e.nodeIndex(o)));let m=new od(o,c);for(;l=m[n?"prev":"next"]();){if("false"===e.getContentEditableParent(l)||gg(l,i))return ea.none();if(ow(l)&&l.data.length>0){if(!gf(l,i,"A"))return ea.some(sf(l,n?l.data.length:0));return ea.none()}if(e.isBlock(l)||s[l.nodeName.toLowerCase()])return ea.none();a=l}return oS(a)?ea.none():r&&a?ea.some(sf(a,0)):ea.none()},gy=(e,t,r,n)=>{let o;let a=e.getRoot(),l=!1,i=r?n.startContainer:n.endContainer,s=r?n.startOffset:n.endOffset,d=ou(i)&&s===i.childNodes.length,c=e.schema.getNonEmptyElements(),m=r;if(at(i))return ea.none();if(ou(i)&&s>i.childNodes.length-1&&(m=!1),o_(i)&&(i=a,s=0),i===a){if(m&&(o=i.childNodes[s>0?s-1:0])&&(at(o)||c[o.nodeName]||oy(o)))return ea.none();if(i.hasChildNodes()){if(s=Math.min(!m&&s>0?s-1:s,i.childNodes.length-1),s=ow(i=i.childNodes[s])&&d?i.data.length:0,!t&&i===a.lastChild&&oy(i)||gb(a,i)||at(i))return ea.none();if(i.hasChildNodes()&&!oy(i)){o=i;let t=new od(i,a);do{if(oO(o)||at(o)){l=!1;break}if(ow(o)&&o.data.length>0){s=m?0:o.data.length,i=o,l=!0;break}if(c[o.nodeName.toLowerCase()]&&!oB(o)){s=e.nodeIndex(o),i=o.parentNode,!m&&s++,l=!0;break}}while(o=m?t.next():t.prev())}}}return t&&(ow(i)&&0===s&&gv(e,d,t,!0,i).each(e=>{i=e.container(),s=e.offset(),l=!0}),ou(i)&&((o=i.childNodes[s])||(o=i.childNodes[s-1]),o&&oD(o)&&!gh(o,"A")&&!gp(e,o,!1)&&!gp(e,o,!0)&&gv(e,d,t,!0,o).each(e=>{i=e.container(),s=e.offset(),l=!0}))),m&&!t&&ow(i)&&s===i.data.length&&gv(e,d,t,!1,i).each(e=>{i=e.container(),s=e.offset(),l=!0}),l&&i?ea.some(sf(i,s)):ea.none()},gC=(e,t)=>{let r=t.collapsed,n=t.cloneRange(),o=sf.fromRangeStart(t);return gy(e,r,!0,n).each(e=>{r&&sf.isAbove(o,e)||n.setStart(e.container(),e.offset())}),r||gy(e,r,!1,n).each(e=>{n.setEnd(e.container(),e.offset())}),r&&n.collapse(!0),gc(t,n)?ea.none():ea.some(n)},gx=(e,t)=>e.splitText(t),gw=e=>{let t=e.startContainer,r=e.startOffset,n=e.endContainer,o=e.endOffset;if(t===n&&ow(t)){if(r>0&&r<t.data.length){if(t=(n=gx(t,r)).previousSibling,o>r){let e=gx(n,o-=r).previousSibling;t=n=e,o=e.data.length,r=0}else o=0}}else if(ow(t)&&r>0&&r<t.data.length&&(t=gx(t,r),r=0),ow(n)&&o>0&&o<n.data.length){let e=gx(n,o).previousSibling;n=e,o=e.data.length}return{startContainer:t,startOffset:r,endContainer:n,endOffset:o}},gE=e=>({walk:(t,r)=>fr(e,t,r),split:gw,expand:(t,r={type:"word"})=>{if("word"===r.type){let r=ft(e,t,[{inline:"span"}]),n=e.createRng();return n.setStart(r.startContainer,r.startOffset),n.setEnd(r.endContainer,r.endOffset),n}return t},normalize:t=>gC(e,t).fold(en,e=>(t.setStart(e.startContainer,e.startOffset),t.setEnd(e.endContainer,e.endOffset),!0))});gE.compareRanges=gc,gE.getCaretRangeFromPoint=gd,gE.getSelectedNode=i8,gE.getNode=i5;let gk=((e,t)=>{let r=r=>{let n=t(r);return n<=0||null===n?parseFloat(nO(r,e))||0:n},n=(e,t)=>ey(t,(t,r)=>{let n=nO(e,r),o=void 0===n?0:parseInt(n,10);return isNaN(o)?t:t+o},0);return{set:(t,r)=>{if(!q(r)&&!r.match(/^[0-9]+$/))throw Error(e+".set accepts only positive integer values. Value was "+r);let n=t.dom;n_(n)&&(n.style[e]=r+"px")},get:r,getOuter:r,aggregate:n,max:(e,t,r)=>{let o=n(e,r);return t>o?t-o:0}}})("height",e=>{let t=e.dom;return nf(e)?t.getBoundingClientRect().height:t.offsetHeight}),gS=e=>gk.get(e),g_=()=>rz.fromDom(document),gN=(e,t)=>e.view(t).fold(Y([]),t=>{let r=e.owner(t);return[t].concat(gN(e,r))}),gD=(e,t)=>{let r=t.owner(e);return gN(t,r)};var gR=Object.freeze({__proto__:null,view:e=>{var t;return(e.dom===document?ea.none():ea.from(null===(t=e.dom.defaultView)||void 0===t?void 0:t.frameElement)).map(rz.fromDom)},owner:e=>rY(e)});let gA=e=>{let t=n7(g_()),r=gD(e,gR),n=n4(e),o=ev(r,(e,t)=>{let r=n4(t);return{left:e.left+r.left,top:e.top+r.top}},{left:0,top:0});return n8(o.left+n.left+t.left,o.top+n.top+t.top)},gO=e=>"textarea"===ri(e),gT=(e,t)=>e.dispatch("ScrollIntoView",t).isDefaultPrevented(),gB=(e,t)=>{e.dispatch("AfterScrollIntoView",t)},gP=(e,t)=>{let r=r6(e);if(0===r.length||gO(e))return{element:e,offset:t};if(t<r.length&&!gO(r[t]))return{element:r[t],offset:0};{let n=r[r.length-1];return gO(n)?{element:e,offset:t}:"img"===ri(n)?{element:n,offset:1}:rf(n)?{element:n,offset:oz(n).length}:{element:n,offset:r6(n).length}}},gL=(e,t)=>{let r=n9(e),n=gS(e);return{element:e,bottom:r.top+n,height:n,pos:r,cleanup:t}},gF=(e,t)=>{let r=gP(e,t),n=rz.fromHtml('<span data-mce-bogus="all" style="display: inline-block;">\uFEFF</span>');return nM(r.element,n),gL(n,()=>nV(n))},gM=e=>gL(rz.fromDom(e),W),gI=(e,t,r,n)=>{gH(e,(o,a)=>gz(e,t,r,n),r)},gU=(e,t,r,n,o)=>{let a={elm:n.element.dom,alignToTop:o};if(gT(e,a))return;let l=n7(t).top;r(e,t,l,n,o),gB(e,a)},gz=(e,t,r,n)=>{let o=rz.fromDom(e.getBody()),a=rz.fromDom(e.getDoc());nF(o);let l=gF(rz.fromDom(r.startContainer),r.startOffset);gU(e,a,t,l,n),l.cleanup()},gj=(e,t,r,n)=>{let o=rz.fromDom(e.getDoc());gU(e,o,r,gM(t),n)},gH=(e,t,r)=>{let n=r.startContainer,o=r.startOffset,a=r.endContainer,l=r.endOffset;t(rz.fromDom(n),rz.fromDom(a));let i=e.dom.createRng();i.setStart(n,o),i.setEnd(a,l),e.selection.setRng(r)},g$=(e,t,r,n,o)=>{let a=t.pos;if(n)oe(a.left,a.top,o);else{let n=a.top-r+t.height;oe(-e.getBody().getBoundingClientRect().left,n,o)}},gq=(e,t,r,n,o,a)=>{let l=n+r,i=o.pos.top,s=o.bottom,d=s-i>=n;i<r?g$(e,o,n,!1!==a,t):i>l?g$(e,o,n,d?!1!==a:!0===a,t):s>l&&!d&&g$(e,o,n,!0===a,t)},gV=(e,t,r,n,o)=>{let a=rQ(t).dom.innerHeight;gq(e,t,r,a,n,o)},gW=(e,t,r,n,o)=>{let a=rQ(t).dom.innerHeight;gq(e,t,r,a,n,o);let l=gA(n.element),i=oo(window);l.top<i.y?ot(n.element,!1!==o):l.top>i.bottom&&ot(n.element,!0===o)},gK=(e,t,r)=>gI(e,gV,t,r),gG=(e,t,r)=>gj(e,t,gV,r),gY=(e,t,r)=>gI(e,gW,t,r),gX=(e,t,r)=>gj(e,t,gW,r),gQ=(e,t,r)=>{(e.inline?gG:gX)(e,t,r)},gJ=(e,t,r)=>{(e.inline?gK:gY)(e,t,r)},gZ=e=>e.dom.focus(),g0=e=>{let t=nl(e).dom;return e.dom===t.activeElement},g1=(e=g_())=>ea.from(e.dom.activeElement).map(rz.fromDom),g2=e=>g1(nl(e)).filter(t=>e.dom.contains(t.dom)),g3=(e,t)=>{let r=rf(t)?oz(t).length:r6(t).length+1;return e>r?r:e<0?0:e},g8=e=>f2(e.start,g3(e.soffset,e.start),e.finish,g3(e.foffset,e.finish)),g5=(e,t)=>!om(t.dom)&&(rK(e,t)||rW(e,t)),g6=e=>t=>g5(e,t.start)&&g5(e,t.finish),g9=e=>e.inline||tJ.browser.isFirefox(),g4=e=>f2(rz.fromDom(e.startContainer),e.startOffset,rz.fromDom(e.endContainer),e.endOffset),g7=e=>{let t=e.getSelection();return(t&&0!==t.rangeCount?ea.from(t.getRangeAt(0)):ea.none()).map(g4)},pe=e=>g7(rQ(e).dom).filter(g6(e)),pt=(e,t)=>ea.from(t).filter(g6(e)).map(g8),pr=e=>{let t=document.createRange();try{return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),ea.some(t)}catch(e){return ea.none()}},pn=e=>{let t=g9(e)?pe(rz.fromDom(e.getBody())):ea.none();e.bookmark=t.isSome()?t:e.bookmark},po=e=>(e.bookmark?e.bookmark:ea.none()).bind(t=>pt(rz.fromDom(e.getBody()),t)).bind(pr),pa=e=>{po(e).each(t=>e.selection.setRng(t))},pl={isEditorUIElement:e=>{let t=e.className.toString();return -1!==t.indexOf("tox-")||-1!==t.indexOf("mce-")}},pi=(e,t)=>(q(t)||(t=0),setTimeout(e,t)),ps=(e,t)=>(q(t)||(t=0),setInterval(e,t)),pd={setEditorTimeout:(e,t,r)=>pi(()=>{e.removed||t()},r),setEditorInterval:(e,t,r)=>{let n=ps(()=>{e.removed?clearInterval(n):t()},r);return n}},pc=e=>"nodechange"===e.type&&e.selectionChange,pm=(e,t)=>{let r=()=>{t.throttle()};it.DOM.bind(document,"mouseup",r),e.on("remove",()=>{it.DOM.unbind(document,"mouseup",r)})},pu=(e,t)=>{e.on("mouseup touchend",e=>{t.throttle()})},pf=(e,t)=>{pu(e,t),e.on("keyup NodeChange AfterSetSelectionRange",t=>{pc(t)||pn(e)})},pg=e=>{let t=iv(()=>{pn(e)},0);e.on("init",()=>{e.inline&&pm(e,t),pf(e,t)}),e.on("remove",()=>{t.cancel()})},pp=it.DOM,ph=e=>ou(e)&&pl.isEditorUIElement(e),pb=e=>{let t=e.classList;return void 0!==t&&(t.contains("tox-edit-area")||t.contains("tox-edit-area__iframe")||t.contains("mce-content-body"))},pv=(e,t)=>{let r=dX(e);return null!==pp.getParent(t,t=>ph(t)||!!r&&e.dom.is(t,r))},py=e=>{try{let t=nl(rz.fromDom(e.getElement()));return g1(t).fold(()=>document.body,e=>e.dom)}catch(e){return document.body}},pC=(t,r)=>{let n=r.editor;pg(n);let o=(e,t)=>{cD(e)&&!0!==e.inline&&t(rz.fromDom(e.getContainer()),"tox-edit-focus")};n.on("focusin",()=>{let e=t.focusedEditor;pb(py(n))&&o(n,rP),e!==n&&(e&&e.dispatch("blur",{focusedEditor:n}),t.setActive(n),t.focusedEditor=n,n.dispatch("focus",{blurredEditor:e}),n.focus(!0))}),n.on("focusout",()=>{pd.setEditorTimeout(n,()=>{let e=t.focusedEditor;pb(py(n))&&e===n||o(n,rF),pv(n,py(n))||e!==n||(n.dispatch("blur",{focusedEditor:null}),t.focusedEditor=null)})}),e||(e=e=>{let r=t.activeEditor;r&&nm(e).each(e=>{e.ownerDocument!==document||e===document.body||pv(r,e)||t.focusedEditor!==r||(r.dispatch("blur",{focusedEditor:null}),t.focusedEditor=null)})},pp.bind(document,"focusin",e))},px=(t,r)=>{t.focusedEditor===r.editor&&(t.focusedEditor=null),!t.activeEditor&&e&&(pp.unbind(document,"focusin",e),e=null)},pw=e=>{e.on("AddEditor",J(pC,e)),e.on("RemoveEditor",J(px,e))},pE=(e,t)=>e.dom.getParent(t,t=>"true"===e.dom.getContentEditable(t)),pk=e=>e.collapsed?ea.from(i5(e.startContainer,e.startOffset)).map(rz.fromDom):ea.none(),pS=(e,t)=>pk(t).bind(t=>oJ(t)?ea.some(t):rK(e,t)?ea.none():ea.some(e)),p_=(e,t)=>{pS(rz.fromDom(e.getBody()),t).bind(e=>mT(e.dom)).fold(()=>{e.selection.normalize()},t=>e.selection.setRng(t.toRange()))},pN=e=>{if(e.setActive)try{e.setActive()}catch(t){e.focus()}else e.focus()},pD=e=>g0(e)||g2(e).isSome(),pR=e=>H(e.iframeElement)&&g0(rz.fromDom(e.iframeElement)),pA=e=>{let t=e.getBody();return t&&pD(rz.fromDom(t))},pO=e=>g1(nl(rz.fromDom(e.getElement()))).filter(t=>!pb(t.dom)&&pv(e,t.dom)).isSome(),pT=e=>e.inline?pA(e):pR(e),pB=e=>pT(e)||pO(e),pP=e=>{let t=e.selection,r=e.getBody(),n=t.getRng();e.quirks.refreshContentEditable(),H(e.bookmark)&&!pT(e)&&po(e).each(t=>{e.selection.setRng(t),n=t});let o=pE(e,t.getNode());if(o&&e.dom.isChildOf(o,r)){pN(o),p_(e,n),pL(e);return}e.inline||(tJ.browser.isOpera()||pN(r),e.getWin().focus()),(tJ.browser.isFirefox()||e.inline)&&(pN(r),p_(e,n)),pL(e)},pL=e=>e.editorManager.setActive(e),pF=(e,t)=>{e.removed||(t?pL(e):pP(e))},pM=(e,t,r,n,o)=>{let a=r?t.startContainer:t.endContainer,l=r?t.startOffset:t.endOffset;return ea.from(a).map(rz.fromDom).map(e=>n&&t.collapsed?e:r9(e,o(e,l)).getOr(e)).bind(e=>ru(e)?ea.some(e):rJ(e).filter(ru)).map(e=>e.dom).getOr(e)},pI=(e,t,r=!1)=>pM(e,t,!0,r,(e,t)=>Math.min(ne(e),t)),pU=(e,t,r=!1)=>pM(e,t,!1,r,(e,t)=>t>0?t-1:t),pz=(e,t)=>{let r=e;for(;e&&ow(e)&&0===e.length;)e=t?e.nextSibling:e.previousSibling;return e||r},pj=(e,t)=>{if(!t)return e;let r=t.startContainer,n=t.endContainer,o=t.startOffset,a=t.endOffset,l=t.commonAncestorContainer;!t.collapsed&&(r===n&&a-o<2&&r.hasChildNodes()&&(l=r.childNodes[o]),ow(r)&&ow(n)&&(r=r.length===o?pz(r.nextSibling,!0):r.parentNode,n=0===a?pz(n.previousSibling,!1):n.parentNode,r&&r===n&&(l=r)));let i=ow(l)?l.parentNode:l;return ou(i)?i:e},pH=(e,t,r,n)=>{let o=[],a=e.getRoot(),l=e.getParent(r||pI(a,t,t.collapsed),e.isBlock),i=e.getParent(n||pU(a,t,t.collapsed),e.isBlock);if(l&&l!==a&&o.push(l),l&&i&&l!==i){let t;let r=new od(l,a);for(;(t=r.next())&&t!==i;)e.isBlock(t)&&o.push(t)}return i&&l!==i&&i!==a&&o.push(i),o},p$=(e,t,r)=>ea.from(t).bind(t=>ea.from(t.parentNode).map(n=>{let o=e.nodeIndex(t),a=e.createRng();return a.setStart(n,o),a.setEnd(n,o+1),r&&(ux(e,a,t,!0),ux(e,a,t,!1)),a})),pq=(e,t)=>ef(t,t=>{let r=e.dispatch("GetSelectionRange",{range:t});return r.range!==t?r.range:t}),pV=e=>"img"===ri(e)?1:oj(e).fold(()=>r6(e).length,e=>e.length),pW=e=>oj(e).filter(e=>0!==e.trim().length||e.indexOf("\xa0")>-1).isSome(),pK=e=>rm(e)&&"false"===rC(e,"contenteditable"),pG=["img","br"],pY=e=>pW(e)||em(pG,ri(e))||pK(e),pX=e=>ny(e,pY),pQ=e=>pJ(e,pY),pJ=(e,t)=>{let r=e=>{let n=r6(e);for(let e=n.length-1;e>=0;e--){let o=n[e];if(t(o))return ea.some(o);let a=r(o);if(a.isSome())return a}return ea.none()};return r(e)},pZ="[data-mce-autocompleter]",p0=(e,t)=>{if(p2(rz.fromDom(e.getBody())).isNone()){let r=rz.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',e.getDoc());nz(r,rz.fromDom(t.extractContents())),t.insertNode(r.dom),rJ(r).each(e=>e.dom.normalize()),pQ(r).map(t=>{e.selection.setCursorLocation(t.dom,pV(t))})}},p1=e=>nw(e,pZ),p2=e=>nx(e,pZ),p3=(e,t)=>p2(t).each(t=>{let r=e.selection.getBookmark();nW(t),e.selection.moveToBookmark(r)}),p8={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},p5=(e,t,r)=>{let n=r?"lastChild":"firstChild",o=r?"prev":"next";if(e[n])return e[n];if(e!==t){let r=e[o];if(r)return r;for(let n=e.parent;n&&n!==t;n=n.parent)if(r=n[o])return r}},p6=e=>{var t;let r=null!==(t=e.value)&&void 0!==t?t:"";if(!aw(r))return!1;let n=e.parent;return!(n&&("span"!==n.name||n.attr("style"))&&/^[ ]+$/.test(r))},p9=e=>{let t="a"===e.name&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t};class p4{static create(e,t){let r=new p4(e,p8[e]||1);return t&&eI(t,(e,t)=>{r.attr(t,e)}),r}constructor(e,t){this.name=e,this.type=t,1===t&&(this.attributes=[],this.attributes.map={})}replace(e){return e.parent&&e.remove(),this.insert(e,this),this.remove(),this}attr(e,t){let r=this;if(!P(e))return H(e)&&eI(e,(e,t)=>{r.attr(t,e)}),r;let n=r.attributes;if(n){if(void 0!==t){if(null===t){if(e in n.map){delete n.map[e];let t=n.length;for(;t--;)if(n[t].name===e){n.splice(t,1);break}}return r}if(e in n.map){let r=n.length;for(;r--;)if(n[r].name===e){n[r].value=t;break}}else n.push({name:e,value:t});return n.map[e]=t,r}return n.map[e]}}clone(){let e=new p4(this.name,this.type),t=this.attributes;if(t){let r=[];r.map={};for(let e=0,n=t.length;e<n;e++){let n=t[e];"id"!==n.name&&(r[r.length]={name:n.name,value:n.value},r.map[n.name]=n.value)}e.attributes=r}return e.value=this.value,e}wrap(e){return this.parent&&(this.parent.insert(e,this),e.append(this)),this}unwrap(){for(let e=this.firstChild;e;){let t=e.next;this.insert(e,this,!0),e=t}this.remove()}remove(){let e=this.parent,t=this.next,r=this.prev;return e&&(e.firstChild===this?(e.firstChild=t,t&&(t.prev=null)):r&&(r.next=t),e.lastChild===this?(e.lastChild=r,r&&(r.next=null)):t&&(t.prev=r),this.parent=this.next=this.prev=null),this}append(e){e.parent&&e.remove();let t=this.lastChild;return t?(t.next=e,e.prev=t,this.lastChild=e):this.lastChild=this.firstChild=e,e.parent=this,e}insert(e,t,r){e.parent&&e.remove();let n=t.parent||this;return r?(t===n.firstChild?n.firstChild=e:t.prev&&(t.prev.next=e),e.prev=t.prev,e.next=t,t.prev=e):(t===n.lastChild?n.lastChild=e:t.next&&(t.next.prev=e),e.next=t.next,e.prev=t,t.next=e),e.parent=n,e}getAll(e){let t=[];for(let r=this.firstChild;r;r=p5(r,this))r.name===e&&t.push(r);return t}children(){let e=[];for(let t=this.firstChild;t;t=t.next)e.push(t);return e}empty(){if(this.firstChild){let e=[];for(let t=this.firstChild;t;t=p5(t,this))e.push(t);let t=e.length;for(;t--;){let r=e[t];r.parent=r.firstChild=r.lastChild=r.next=r.prev=null}}return this.firstChild=this.lastChild=null,this}isEmpty(e,t={},r){var n;let o=this.firstChild;if(p9(this))return!1;if(o)do{if(1===o.type){if(o.attr("data-mce-bogus"))continue;if(e[o.name]||p9(o))return!1}if(8===o.type||3===o.type&&!p6(o)||3===o.type&&o.parent&&t[o.parent.name]&&aw(null!==(n=o.value)&&void 0!==n?n:"")||r&&r(o))return!1}while(o=p5(o,this));return!0}walk(e){return p5(this,null,e)}}let p7=e=>`${0===e.length?"":`${ef(e,e=>`[${e}]`).join(",")},`}[data-mce-bogus="all"]`,he=(e,t)=>e.querySelectorAll(p7(t)),ht=e=>document.createTreeWalker(e,NodeFilter.SHOW_COMMENT,null),hr=e=>null!==ht(e).nextNode(),hn=(e,t)=>null!==e.querySelector(p7(t)),ho=(e,t)=>{eg(he(e,t),e=>{let r=rz.fromDom(e);"all"===rC(r,"data-mce-bogus")?nV(r):eg(t,e=>{rw(r,e)&&rE(r,e)})})},ha=e=>{let t=ht(e),r=t.nextNode();for(;null!==r;){let e=t.currentNode;r=t.nextNode(),P(e.nodeValue)&&e.nodeValue.includes("\uFEFF")&&nV(rz.fromDom(e))}},hl=e=>e.cloneNode(!0),hi=(e,t)=>{let r=e;return hr(e)?(ha(r=hl(e)),hn(r,t)&&ho(r,t)):hn(e,t)&&ho(r=hl(e),t),r},hs=e=>{eg(oi(e,"[data-mce-bogus]"),e=>{"all"===rC(e,"data-mce-bogus")?nV(e):oG(e)?(nM(e,rz.fromText("\uFEFF")),nV(e)):nW(e)})},hd=e=>{eg(oi(e,"input"),e=>{rE(e,"name")})},hc=(e,t)=>{let r=dd(e),n=RegExp(`^(<${r}[^>]*>(&nbsp;|&#160;|\\s|\u00a0|<br \\/>|)<\\/${r}>[\r
]*|<br \\/>[\r
]*)$`);return t.replace(n,"")},hm=(e,t)=>{let r=e.getDoc(),n=nl(rz.fromDom(e.getBody())),o=rz.fromTag("div",r);rv(o,"data-mce-bogus","all"),nA(o,{position:"fixed",left:"-9999999px",top:"0"}),nX(o,t.innerHTML),hs(o),hd(o),nz(ns(n),o);let a=o4(o.dom.innerText);return nV(o),a},hu=(e,t,r)=>{let n;return n="raw"===t.format?t2.trim(o4(hi(r,e.serializer.getTempAttrs()).innerHTML)):"text"===t.format?hm(e,r):"tree"===t.format?e.serializer.serialize(r,t):hc(e,e.serializer.serialize(r,t)),"text"!==t.format&&!o0(rz.fromDom(r))&&P(n)?t2.trim(n):n},hf=(e,t)=>ea.from(e.getBody()).fold(Y("tree"===t.format?new p4("body",11):""),r=>hu(e,t,r)),hg=t2.makeMap,hp=e=>{let t=[],r=(e=e||{}).indent,n=hg(e.indent_before||""),o=hg(e.indent_after||""),a=lC.getEncodeFunc(e.entity_encoding||"raw",e.entities),l="xhtml"!==e.element_format;return{start:(e,i,s)=>{if(r&&n[e]&&t.length>0){let e=t[t.length-1];e.length>0&&"\n"!==e&&t.push("\n")}if(t.push("<",e),i)for(let e=0,r=i.length;e<r;e++){let r=i[e];t.push(" ",r.name,'="',a(r.value,!0),'"')}if(!s||l?t[t.length]=">":t[t.length]=" />",s&&r&&o[e]&&t.length>0){let e=t[t.length-1];e.length>0&&"\n"!==e&&t.push("\n")}},end:e=>{let n;t.push("</",e,">"),r&&o[e]&&t.length>0&&(n=t[t.length-1]).length>0&&"\n"!==n&&t.push("\n")},text:(e,r)=>{e.length>0&&(t[t.length]=r?e:a(e))},cdata:e=>{t.push("<![CDATA[",e,"]]>")},comment:e=>{t.push("<!--",e,"-->")},pi:(e,n)=>{n?t.push("<?",e," ",a(n),"?>"):t.push("<?",e,"?>"),r&&t.push("\n")},doctype:e=>{t.push("<!DOCTYPE",e,">",r?"\n":"")},reset:()=>{t.length=0},getContent:()=>t.join("").replace(/\n$/,"")}},hh=(e={},t=lU())=>{let r=hp(e);return e.validate=!("validate"in e)||e.validate,{serialize:n=>{let o=e.validate,a={3:e=>{var t;r.text(null!==(t=e.value)&&void 0!==t?t:"",e.raw)},8:e=>{var t;r.comment(null!==(t=e.value)&&void 0!==t?t:"")},7:e=>{r.pi(e.name,e.value)},10:e=>{var t;r.doctype(null!==(t=e.value)&&void 0!==t?t:"")},4:e=>{var t;r.cdata(null!==(t=e.value)&&void 0!==t?t:"")},11:e=>{let t=e;if(t=t.firstChild)do l(t);while(t=t.next)}};r.reset();let l=e=>{var n;let i=a[e.type];if(i)i(e);else{let a=e.name,i=a in t.getVoidElements(),s=e.attributes;if(o&&s&&s.length>1){let r=[];r.map={};let n=t.getElementRule(e.name);if(n){for(let e=0,t=n.attributesOrder.length;e<t;e++){let t=n.attributesOrder[e];if(t in s.map){let e=s.map[t];r.map[t]=e,r.push({name:t,value:e})}}for(let e=0,t=s.length;e<t;e++){let t=s[e].name;if(!(t in r.map)){let e=s.map[t];r.map[t]=e,r.push({name:t,value:e})}}s=r}}if(r.start(a,s,i),!i){let t=e.firstChild;if(t){("pre"===a||"textarea"===a)&&3===t.type&&(null===(n=t.value)||void 0===n?void 0:n[0])==="\n"&&r.text("\n",!0);do l(t);while(t=t.next)}r.end(a)}}};return 1!==n.type||e.inner?3===n.type?a[3](n):a[11](n):l(n),r.getContent()}}},hb=new Set;eg(["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"],e=>{hb.add(e)});let hv=["font","text-decoration","text-emphasis"],hy=(e,t)=>eF(e.parseStyle(e.getAttrib(t,"style"))),hC=e=>hb.has(e),hx=(e,t)=>eS(hy(e,t),e=>!hC(e)),hw=e=>eb(e,e=>eu(hv,t=>tm(e,t))),hE=(e,t,r)=>{let n=hy(e,t),o=hy(e,r),a=n=>{var o,a;let l=null!==(o=e.getStyle(t,n))&&void 0!==o?o:"",i=null!==(a=e.getStyle(r,n))&&void 0!==a?a:"";return tb(l)&&tb(i)&&l!==i};return eu(n,e=>{let t=t=>eu(t,t=>t===e);return!t(o)&&t(hv)?eu(hw(o),a):a(e)})},hk=(e,t,r)=>ea.from(r.container()).filter(ow).exists(n=>t(n.data.charAt(r.offset()+(e?0:-1)))),hS=J(hk,!0,m6),h_=J(hk,!1,m6),hN=e=>{let t=e.container();return ow(t)&&(0===t.data.length||oI(t.data)&&ff.isBookmarkNode(t.parentNode))},hD=(e,t)=>r=>c7(e?0:-1,r).filter(t).isSome(),hR=e=>oR(e)&&"block"===nO(rz.fromDom(e),"display"),hA=e=>oO(e)&&!ov(e),hO=hD(!0,hR),hT=hD(!1,hR),hB=hD(!0,oP),hP=hD(!1,oP),hL=hD(!0,oy),hF=hD(!1,oy),hM=hD(!0,hA),hI=hD(!1,hA),hU=e=>e.slice(0,-1),hz=(e,t,r)=>rK(t,e)?hU(r0(e,e=>r(e)||rW(e,t))):[],hj=(e,t)=>hz(e,t,en),hH=(e,t)=>[e].concat(hj(e,t)),h$=(e,t,r)=>mD(e,t,r,hN),hq=(e,t)=>ex(hH(rz.fromDom(t.container()),e),oV),hV=(e,t,r)=>h$(e,t.dom,r).forall(e=>hq(t,r).fold(()=>!c4(e,r,t.dom),n=>!c4(e,r,t.dom)&&rK(n,rz.fromDom(e.container())))),hW=(e,t,r)=>hq(t,r).fold(()=>h$(e,t.dom,r).forall(e=>!c4(e,r,t.dom)),t=>h$(e,t.dom,r).isNone()),hK=J(hW,!1),hG=J(hW,!0),hY=J(hV,!1),hX=J(hV,!0),hQ=e=>ms(e).exists(oG),hJ=(e,t,r)=>m_(e,eO(eb(hH(rz.fromDom(r.container()),t),oV)).getOr(t).dom,r).filter(hQ),hZ=(e,t)=>ms(t).exists(oG)||hJ(!0,e,t).isSome(),h0=(e,t)=>md(t).exists(oG)||hJ(!1,e,t).isSome(),h1=J(hJ,!1),h2=J(hJ,!0),h3=e=>sf.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd(),h8=(e,t)=>eO(eb(hH(rz.fromDom(t.container()),e),oV)).getOr(e),h5=(e,t)=>h3(t)?h_(t):h_(t)||mO(h8(e,t).dom,t).exists(h_),h6=(e,t)=>h3(t)?hS(t):hS(t)||mA(h8(e,t).dom,t).exists(hS),h9=e=>em(["pre","pre-wrap"],e),h4=e=>ms(e).bind(e=>nh(e,ru)).exists(e=>h9(nO(e,"white-space"))),h7=(e,t)=>mO(e.dom,t).isNone(),be=(e,t)=>mA(e.dom,t).isNone(),bt=(e,t)=>h7(e,t)||be(e,t)||hK(e,t)||hG(e,t)||h0(e,t)||hZ(e,t),br=e=>H(e)&&oO(e)&&c1(e),bn=(e,t)=>r=>br(new od(r,e)[t]()),bo=(e,t)=>{let r=mA(e.dom,t).getOr(t),n=bn(e.dom,"next");return t.isAtEnd()&&(n(t.container())||n(r.container()))},ba=(e,t)=>{let r=mO(e.dom,t).getOr(t),n=bn(e.dom,"prev");return t.isAtStart()&&(n(t.container())||n(r.container()))},bl=(e,t)=>!h4(t)&&(bt(e,t)||h5(e,t)||h6(e,t)),bi=(e,t)=>!h4(t)&&(hK(e,t)||hY(e,t)||h0(e,t)||h5(e,t)||ba(e,t)),bs=e=>{let t=e.container(),r=e.offset();return ow(t)&&r<t.data.length?sf(t,r+1):e},bd=(e,t)=>!h4(t)&&(hG(e,t)||hX(e,t)||hZ(e,t)||h6(e,t)||bo(e,t)),bc=(e,t)=>bi(e,t)||bd(e,bs(t)),bm=(e,t)=>m5(e.charAt(t)),bu=(e,t)=>m6(e.charAt(t)),bf=e=>{let t=e.container();return ow(t)&&tc(t.data,"\xa0")},bg=e=>{let t=e.split("");return ef(t,(e,r)=>m5(e)&&r>0&&r<t.length-1&&m9(t[r-1])&&m9(t[r+1])?" ":e).join("")},bp=(e,t,r)=>{let n=t.data,o=sf(t,0);return!r&&bm(n,0)&&!bc(e,o)?(t.data=" "+n.slice(1),!0):!!(r&&bu(n,0)&&bi(e,o))&&(t.data="\xa0"+n.slice(1),!0)},bh=e=>{let t=e.data,r=bg(t);return r!==t&&(e.data=r,!0)},bb=(e,t,r)=>{let n=t.data,o=sf(t,n.length-1);return!r&&bm(n,n.length-1)&&!bc(e,o)?(t.data=n.slice(0,-1)+" ",!0):!!(r&&bu(n,n.length-1)&&bd(e,o))&&(t.data=n.slice(0,-1)+"\xa0",!0)},bv=(e,t)=>{let r=t.container();return ow(r)?bf(t)?t4(bp(e,r,!1)||bh(r)||bb(e,r,!1),t):bc(e,t)?t4(bp(e,r,!0)||bb(e,r,!0),t):ea.none():ea.none()},by=e=>{let t=rz.fromDom(e.getBody());e.selection.isCollapsed()&&bv(t,sf.fromRangeStart(e.selection.getRng())).each(t=>{e.selection.setRng(t.toRange())})},bC=(e,t,r)=>{if(0===r)return;let n=rz.fromDom(e),o=np(n,oV).getOr(n),a=e.data.slice(t,t+r),l=t+r>=e.data.length&&bd(o,sf(e,e.data.length)),i=0===t&&bi(o,sf(e,0));e.replaceData(t,r,aN(a,4,i,l))},bx=(e,t)=>{let r=e.data.slice(t);bC(e,t,r.length-tp(r).length)},bw=(e,t)=>{let r=e.data.slice(0,t),n=r.length-th(r).length;bC(e,t-n,n)},bE=(e,t,r,n=!0)=>{let o=th(e.data).length,a=n?e:t,l=n?t:e;return n?a.appendData(l.data):a.insertData(0,l.data),nV(rz.fromDom(l)),r&&bx(a,o),a},bk=(e,t)=>{let r=e.container(),n=e.offset();return!sf.isTextPosition(e)&&r===t.parentNode&&n>sf.before(t).offset()},bS=(e,t)=>bk(t,e)?sf(t.container(),t.offset()-1):t,b_=e=>ow(e)?sf(e,0):sf.before(e),bN=e=>ow(e)?sf(e,e.data.length):sf.after(e),bD=e=>ap(e.previousSibling)?ea.some(bN(e.previousSibling)):e.previousSibling?mB(e.previousSibling):ea.none(),bR=e=>ap(e.nextSibling)?ea.some(b_(e.nextSibling)):e.nextSibling?mT(e.nextSibling):ea.none(),bA=(e,t)=>ea.from(t.previousSibling?t.previousSibling:t.parentNode).bind(t=>mO(e,sf.before(t))).orThunk(()=>mA(e,sf.after(t))),bO=(e,t)=>mA(e,sf.after(t)).orThunk(()=>mO(e,sf.before(t))),bT=(e,t)=>bD(t).orThunk(()=>bR(t)).orThunk(()=>bA(e,t)),bB=(e,t)=>bR(t).orThunk(()=>bD(t)).orThunk(()=>bO(e,t)),bP=(e,t,r)=>e?bB(t,r):bT(t,r),bL=(e,t,r)=>bP(e,t,r).map(J(bS,r)),bF=(e,t,r)=>{r.fold(()=>{e.focus()},r=>{e.selection.setRng(r.toRange(),t)})},bM=e=>t=>t.dom===e,bI=(e,t)=>t&&eG(e.schema.getBlockElements(),ri(t)),bU=e=>{if(!aF(e))return ea.none();{let t=rz.fromHtml('<br data-mce-bogus="1">');return nq(e),nz(e,t),ea.some(sf.before(t.dom))}},bz=(e,t,r)=>{let n=r2(e).filter(rf),o=r3(e).filter(rf);return nV(e),t9(n,o,t,(e,t,n)=>{let o=e.dom,a=t.dom,l=o.data.length;return bE(o,a,r),n.container()===a?sf(o,l):n}).orThunk(()=>(r&&(n.each(e=>bw(e.dom,e.dom.length)),o.each(e=>bx(e.dom,0))),t))},bj=(e,t)=>eG(e.schema.getTextInlineElements(),ri(t)),bH=(e,t,r,n=!0)=>{let o=bL(t,e.getBody(),r.dom),a=np(r,J(bI,e),bM(e.getBody())),l=bz(r,o,bj(e,r));e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):a.bind(bU).fold(()=>{n&&bF(e,t,l)},r=>{n&&bF(e,t,ea.some(r))})},b$=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,bq=e=>b$.test(e),bV=(e,t)=>rH(rz.fromDom(t),dL(e))&&!aJ(e.schema,t)&&e.dom.isEditable(t),bW=e=>{var t;return"rtl"===it.DOM.getStyle(e,"direction",!0)||bq(null!==(t=e.textContent)&&void 0!==t?t:"")},bK=(e,t,r)=>eb(it.DOM.getParents(r.container(),"*",t),e),bG=(e,t,r)=>{let n=bK(e,t,r);return ea.from(n[n.length-1])},bY=(e,t,r)=>{let n=c9(t,e),o=c9(r,e);return H(n)&&n===o},bX=e=>ao(e)||aa(e),bQ=(e,t)=>{let r=t.container(),n=t.offset();return e?ae(r)?ow(r.nextSibling)?sf(r.nextSibling,0):sf.after(r):ao(t)?sf(r,n+1):t:ae(r)?ow(r.previousSibling)?sf(r.previousSibling,r.previousSibling.data.length):sf.before(r):aa(t)?sf(r,n-1):t},bJ=J(bQ,!0),bZ=J(bQ,!1),b0=(e,t)=>{let r=e=>e.stopImmediatePropagation();e.on("beforeinput input",r,!0),e.getDoc().execCommand(t),e.off("beforeinput input",r)},b1=e=>{e.execCommand("delete")},b2=e=>b0(e,"Delete"),b3=e=>b0(e,"ForwardDelete"),b8=e=>t=>t3(rJ(t),e,rW),b5=e=>oY(e)||oQ(e),b6=(e,t)=>rK(e,t)?nh(t,b5,b8(e)):ea.none(),b9=(e,t=!0)=>{e.dom.isEmpty(e.getBody())&&e.setContent("",{no_selection:!t})},b4=(e,t,r)=>t6(mT(r),mB(r),(n,o)=>{let a=bQ(!0,n),l=bQ(!1,o),i=bQ(!1,t);return e?mA(r,i).exists(e=>e.isEqual(l)&&t.isEqual(a)):mO(r,i).exists(e=>e.isEqual(a)&&t.isEqual(l))}).getOr(!0),b7=e=>(rc(e)?r2(e):r7(e)).bind(b7).orThunk(()=>ea.some(e)),ve=(e,t,r,n=!0)=>{var o;t.deleteContents();let a=b7(r).getOr(r),l=rz.fromDom(null!==(o=e.dom.getParent(a.dom,e.dom.isBlock))&&void 0!==o?o:r.dom);l.dom===e.getBody()?b9(e,n):aF(l)&&(o6(l),n&&e.selection.setCursorLocation(l.dom,0)),rW(r,l)||eg((t3(rJ(l),r)?[]:r1(l)).concat(r6(r)),e=>{!rW(e,l)&&!rK(e,l)&&aF(e)&&nV(e)})},vt=e=>t=>rW(e,t),vr=e=>oi(e,"td,th"),vn=(e,t)=>{let r=e=>up(rz.fromDom(e),t),n=r(e.startContainer),o=r(e.endContainer),a=n.isSome(),l=o.isSome(),i=t6(n,o,rW).getOr(!1);return{startTable:n,endTable:o,isStartInTable:a,isEndInTable:l,isSameTable:i,isMultiTable:!i&&a&&l}},vo=(e,t)=>({start:e,end:t}),va=(e,t,r)=>({rng:e,table:t,cells:r}),vl=sW([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]),vi=(e,t)=>nw(rz.fromDom(e),"td,th",t),vs=e=>!rW(e.start,e.end),vd=(e,t)=>up(e.start,t).bind(r=>up(e.end,t).bind(e=>t4(rW(r,e),r))),vc=(e,t)=>!vs(e)&&vd(e,t).exists(e=>{let t=e.dom.rows;return 1===t.length&&1===t[0].cells.length}),vm=(e,t)=>t6(vi(e.startContainer,t),vi(e.endContainer,t),vo),vu=e=>t=>up(t,e).bind(e=>eT(vr(e)).map(e=>vo(t,e))),vf=e=>t=>up(t,e).bind(e=>eO(vr(e)).map(e=>vo(e,t))),vg=e=>t=>vd(t,e).map(e=>va(t,e,vr(e))),vp=(e,t,r,n)=>{if(r.collapsed||!e.forall(vs))return ea.none();if(t.isSameTable){let t=e.bind(vg(n));return ea.some({start:t,end:t})}{let e=vi(r.startContainer,n),t=vi(r.endContainer,n),o=e.bind(vu(n)).bind(vg(n)),a=t.bind(vf(n)).bind(vg(n));return ea.some({start:o,end:a})}},vh=(e,t)=>ew(e,e=>rW(e,t)),vb=e=>t6(vh(e.cells,e.rng.start),vh(e.cells,e.rng.end),(t,r)=>e.cells.slice(t,r+1)),vv=(e,t,r)=>e.exists(e=>vc(e,r)&&uC(e.start,t)),vy=(e,t)=>{let{startTable:r,endTable:n}=t,o=e.cloneRange();return r.each(e=>o.setStartAfter(e.dom)),n.each(e=>o.setEndBefore(e.dom)),o},vC=(e,t,r,n)=>vp(e,t,r,n).bind(({start:e,end:t})=>e.or(t)).bind(e=>{let{isSameTable:n}=t,o=vb(e).getOr([]);if(n&&e.cells.length===o.length)return ea.some(vl.fullTable(e.table));if(!(o.length>0))return ea.none();if(n)return ea.some(vl.partialTable(o,ea.none()));{let e=vy(r,t);return ea.some(vl.partialTable(o,ea.some({...t,rng:e})))}}),vx=(e,t,r,n)=>vp(e,t,r,n).bind(({start:e,end:n})=>{let o=e.bind(vb).getOr([]),a=n.bind(vb).getOr([]);if(!(o.length>0)||!(a.length>0))return ea.none();{let e=vy(r,t);return ea.some(vl.multiTable(o,a,e))}}),vw=(e,t)=>{let r=vt(e),n=vm(t,r),o=vn(t,r);return vv(n,t,r)?n.map(e=>vl.singleCellTable(t,e.start)):o.isMultiTable?vx(n,o,t,r):vC(n,o,t,r)},vE=e=>eg(e,e=>{rE(e,"contenteditable"),o6(e)}),vk=(e,t)=>ea.from(e.dom.getParent(t,e.dom.isBlock)).map(rz.fromDom),vS=(e,t,r)=>{r.each(r=>{t?nV(r):(o6(r),e.selection.setCursorLocation(r.dom,0))})},v_=(e,t,r,n)=>{let o=r.cloneRange();n?(o.setStart(r.startContainer,r.startOffset),o.setEndAfter(t.dom.lastChild)):(o.setStartBefore(t.dom.firstChild),o.setEnd(r.endContainer,r.endOffset)),vA(e,o,t,!1).each(e=>e())},vN=e=>{let t=ug(e),r=rz.fromDom(e.selection.getNode());oT(r.dom)&&aF(r)?e.selection.setCursorLocation(r.dom,0):e.selection.collapse(!0),t.length>1&&eu(t,e=>rW(e,r))&&rv(r,"data-mce-selected","1")},vD=(e,t,r)=>ea.some(()=>{let n=e.selection.getRng();vE(r.bind(({rng:r,isStartInTable:o})=>{let a=vk(e,o?r.endContainer:r.startContainer);r.deleteContents(),vS(e,o,a.filter(aF));let l=o?t[0]:t[t.length-1];return(v_(e,l,n,o),aF(l))?ea.none():ea.some(o?t.slice(1):t.slice(0,-1))}).getOr(t)),vN(e)}),vR=(e,t,r,n)=>ea.some(()=>{let o=e.selection.getRng(),a=t[0],l=r[r.length-1];v_(e,a,o,!0),v_(e,l,o,!1);let i=aF(a)?t:t.slice(1),s=aF(l)?r:r.slice(0,-1);vE(i.concat(s)),n.deleteContents(),vN(e)}),vA=(e,t,r,n=!0)=>ea.some(()=>{ve(e,t,r,n)}),vO=(e,t)=>ea.some(()=>bH(e,!1,t)),vT=(e,t,r)=>vw(t,r).bind(t=>t.fold(J(vA,e),J(vO,e),J(vD,e),J(vR,e))),vB=(e,t)=>vU(e,t),vP=(e,t,r,n)=>vM(t,n).fold(()=>vT(e,t,r),t=>vB(e,t)),vL=(e,t,r)=>{let n=rz.fromDom(e.getBody()),o=e.selection.getRng();return 0!==r.length?vD(e,r,ea.none()):vP(e,n,o,t)},vF=(e,t)=>ex(hH(t,e),oZ),vM=(e,t)=>ex(hH(t,e),rh("caption")),vI=(e,t,r,n,o)=>mN(r,e.getBody(),o).bind(e=>vF(t,rz.fromDom(e.getNode())).bind(e=>rW(e,n)?ea.none():ea.some(W))),vU=(e,t)=>ea.some(()=>{o6(t),e.selection.setCursorLocation(t.dom,0)}),vz=(e,t,r,n)=>mT(e.dom).bind(o=>mB(e.dom).map(e=>t?r.isEqual(o)&&n.isEqual(e):r.isEqual(e)&&n.isEqual(o))).getOr(!0),vj=(e,t)=>vU(e,t),vH=(e,t,r)=>vM(e,rz.fromDom(r.getNode())).fold(()=>ea.some(W),e=>t4(!rW(e,t),W)),v$=(e,t,r,n,o)=>mN(r,e.getBody(),o).fold(()=>ea.some(W),a=>vz(n,r,o,a)?vj(e,n):vH(t,n,a)),vq=(e,t,r,n)=>{let o=sf.fromRangeStart(e.selection.getRng());return vF(r,n).bind(n=>aF(n)?vU(e,n):vI(e,r,t,n,o))},vV=(e,t,r,n)=>{let o=sf.fromRangeStart(e.selection.getRng());return aF(n)?vU(e,n):v$(e,r,t,n,o)},vW=(e,t)=>e?hL(t):hF(t),vK=(e,t)=>{let r=sf.fromRangeStart(e.selection.getRng());return vW(t,r)||m_(t,e.getBody(),r).exists(e=>vW(t,e))},vG=(e,t,r)=>{let n=rz.fromDom(e.getBody());return vM(n,r).fold(()=>vq(e,t,n,r).orThunk(()=>t4(vK(e,t),W)),r=>vV(e,t,n,r))},vY=(e,t)=>{let r=rz.fromDom(e.selection.getStart(!0)),n=ug(e);return e.selection.isCollapsed()&&0===n.length?vG(e,t,r):vL(e,r,n)},vX=(e,t)=>{let r=t;for(;r&&r!==e;){if(oA(r)||oO(r))return r;r=r.parentNode}return null},vQ=["data-ephox-","data-mce-","data-alloy-","data-snooker-","_"],vJ=t2.each,vZ=e=>{let t=e.dom,r=new Set(e.serializer.getTempAttrs()),n=e=>eu(vQ,t=>tm(e,t))||r.has(e);return{compare:(e,r)=>{if(e.nodeName!==r.nodeName||e.nodeType!==r.nodeType)return!1;let o=e=>{let r={};return vJ(t.getAttribs(e),o=>{let a=o.nodeName.toLowerCase();"style"===a||n(a)||(r[a]=t.getAttrib(e,a))}),r},a=(e,t)=>{for(let r in e)if(eG(e,r)){let n=t[r];if(z(n)||e[r]!==n)return!1;delete t[r]}for(let e in t)if(eG(t,e))return!1;return!0};return(!(ou(e)&&ou(r))||!!a(o(e),o(r))&&!!a(t.parseStyle(t.getAttrib(e,"style")),t.parseStyle(t.getAttrib(r,"style"))))&&!m8(e)&&!m8(r)},isAttributeInternal:n}},v0=(e,t)=>{let r=e;for(;r=r.walk();)t(r)},v1=(e,t,r,n)=>{let o=r.name;for(let t=0,a=e.length;t<a;t++){let a=e[t];if(a.name===o){let e=n.nodes[o];e?e.nodes.push(r):n.nodes[o]={filter:a,nodes:[r]}}}if(r.attributes)for(let e=0,o=t.length;e<o;e++){let o=t[e],a=o.name;if(a in r.attributes.map){let e=n.attributes[a];e?e.nodes.push(r):n.attributes[a]={filter:o,nodes:[r]}}}},v2=(e,t,r)=>{let n={nodes:{},attributes:{}};return r.firstChild&&v0(r,r=>{v1(e,t,r,n)}),n},v3=(e,t)=>{let r=(e,r)=>{eI(e,e=>{let n=eB(e.nodes);eg(e.filter.callbacks,o=>{for(let t=n.length-1;t>=0;t--){let o=n[t];(!(r?void 0!==o.attr(e.filter.name):o.name===e.filter.name)||j(o.parent))&&n.splice(t,1)}n.length>0&&o(n,e.filter.name,t)})})};r(e.nodes,!1),r(e.attributes,!0)},v8=(e,t,r,n={})=>{v3(v2(e,t,r),n)},v5=(e,t,r,n)=>{if((e.pad_empty_with_br||t.insert)&&r(n)){let e=new p4("br",1);t.insert&&e.attr("data-mce-bogus","1"),n.empty().append(e)}else n.empty().append(new p4("#text",3)).value="\xa0"},v6=e=>{var t;return v9(e,"#text")&&(null===(t=null==e?void 0:e.firstChild)||void 0===t?void 0:t.value)==="\xa0"},v9=(e,t)=>{let r=null==e?void 0:e.firstChild;return H(r)&&r===e.lastChild&&r.name===t},v4=(e,t)=>{let r=e.getElementRule(t.name);return(null==r?void 0:r.paddEmpty)===!0},v7=(e,t,r,n)=>n.isEmpty(t,r,t=>v4(e,t)),ye=(e,t)=>H(e)&&(t(e)||"br"===e.name),yt=e=>{let t;for(let r=e;r;r=r.parent){let e=r.attr("contenteditable");if("false"===e)break;"true"===e&&(t=r)}return ea.from(t)},yr=(e,t,r=e.parent)=>{if(t.getSpecialElements()[e.name])e.empty().remove();else{for(let n of e.children())r&&!t.isValidChild(r.name,n.name)&&yr(n,t,r);e.unwrap()}},yn=(e,t,r,n=W)=>{let o=t.getTextBlockElements(),a=t.getNonEmptyElements(),l=t.getWhitespaceElements(),i=t2.makeMap("tr,td,th,tbody,thead,tfoot,table,summary"),s=new Set,d=e=>e!==r&&!i[e.name];for(let r=0;r<e.length;r++){let i,c,m;let u=e[r];if(!u.parent||s.has(u))continue;if(o[u.name]&&"li"===u.parent.name){let e=u.next;for(;e&&o[e.name];)e.name="li",s.add(e),u.parent.insert(e,u.parent),e=e.next;u.unwrap();continue}let f=[u];for(i=u.parent;i&&!t.isValidChild(i.name,u.name)&&d(i);i=i.parent)f.push(i);if(i&&f.length>1){if(t.isValidChild(i.name,u.name)){f.reverse(),n(c=f[0].clone());let e=c;for(let r=0;r<f.length-1;r++){t.isValidChild(e.name,f[r].name)&&r>0?(n(m=f[r].clone()),e.append(m)):m=e;for(let e=f[r].firstChild;e&&e!==f[r+1];){let t=e.next;m.append(e),e=t}e=m}v7(t,a,l,c)?i.insert(u,f[0],!0):(i.insert(c,f[0],!0),i.insert(u,c)),(v7(t,a,l,i=f[0])||v9(i,"br"))&&i.empty().remove()}else yr(u,t)}else if(u.parent){if("li"===u.name){let e=u.prev;if(e&&("ul"===e.name||"ol"===e.name)){e.append(u);continue}if((e=u.next)&&("ul"===e.name||"ol"===e.name)&&e.firstChild){e.insert(u,e.firstChild,!0);continue}let t=new p4("ul",1);n(t),u.wrap(t);continue}if(t.isValidChild(u.parent.name,"div")&&t.isValidChild("div",u.name)){let e=new p4("div",1);n(e),u.wrap(e)}else yr(u,t)}}},yo=(e,t)=>{let r=e;for(;r;){if(r.name===t)return!0;r=r.parent}return!1},ya=(e,t,r=t.parent)=>!!r&&!!e.children[t.name]&&!e.isValidChild(r.name,t.name)||!!(r&&"a"===t.name&&yo(r,"a")),yl=(e,t,r,n)=>{let o=document.createRange();return o.setStart(e,t),o.setEnd(r,n),o},yi=e=>{let t=sf.fromRangeStart(e),r=sf.fromRangeEnd(e),n=e.commonAncestorContainer;return m_(!1,n,r).map(o=>!c4(t,r,n)&&c4(t,o,n)?yl(t.container(),t.offset(),o.container(),o.offset()):e).getOr(e)},ys=e=>e.collapsed?e:yi(e),yd=e=>H(e.firstChild)&&e.firstChild===e.lastChild,yc=e=>"br"===e.name||"\xa0"===e.value,ym=(e,t)=>e.getBlockElements()[t.name]&&yd(t)&&yc(t.firstChild),yu=(e,t)=>{let r=e.getNonEmptyElements();return H(t)&&(t.isEmpty(r)||ym(e,t))},yf=(e,t)=>{let r=t.firstChild,n=t.lastChild;return r&&"meta"===r.name&&(r=r.next),n&&"mce_marker"===n.attr("id")&&(n=n.prev),yu(e,n)&&(n=null==n?void 0:n.prev),!!r&&r===n&&("ul"===r.name||"ol"===r.name)},yg=e=>{var t,r;let n=e.firstChild,o=e.lastChild;return n&&"META"===n.nodeName&&(null===(t=n.parentNode)||void 0===t||t.removeChild(n)),o&&"mce_marker"===o.id&&(null===(r=o.parentNode)||void 0===r||r.removeChild(o)),e},yp=(e,t,r)=>{let n=t.serialize(r);return yg(e.createFragment(n))},yh=e=>{var t;return eb(null!==(t=null==e?void 0:e.childNodes)&&void 0!==t?t:[],e=>"LI"===e.nodeName)},yb=e=>"\xa0"===e.data||oD(e),yv=e=>H(null==e?void 0:e.firstChild)&&e.firstChild===e.lastChild&&yb(e.firstChild),yy=e=>!e.firstChild||yv(e),yC=e=>e.length>0&&yy(e[e.length-1])?e.slice(0,-1):e,yx=(e,t)=>{let r=e.getParent(t,e.isBlock);return r&&"LI"===r.nodeName?r:null},yw=(e,t)=>!!yx(e,t),yE=(e,t)=>{let r=t.cloneRange(),n=t.cloneRange();return r.setStartBefore(e),n.setEndAfter(e),[r.cloneContents(),n.cloneContents()]},yk=(e,t)=>{let r=sf.before(e),n=mv(t).next(r);return n?n.toRange():null},yS=(e,t)=>{let r=sf.after(e),n=mv(t).prev(r);return n?n.toRange():null},y_=(e,t,r,n)=>{let o=yE(e,n),a=e.parentNode;return a&&(a.insertBefore(o[0],e),t2.each(t,t=>{a.insertBefore(t,e)}),a.insertBefore(o[1],e),a.removeChild(e)),yS(t[t.length-1],r)},yN=(e,t,r)=>{let n=e.parentNode;return n&&t2.each(t,t=>{n.insertBefore(t,e)}),yk(e,r)},yD=(e,t,r,n)=>(n.insertAfter(t.reverse(),e),yS(t[0],r)),yR=(e,t,r,n)=>{let o=yp(t,e,n),a=yx(t,r.startContainer),l=yC(yh(o.firstChild)),i=t.getRoot(),s=e=>{let n=sf.fromRangeStart(r),o=mv(t.getRoot()),l=1===e?o.prev(n):o.next(n),i=null==l?void 0:l.getNode();return!i||yx(t,i)!==a};return a?s(1)?yN(a,l,i):s(2)?yD(a,l,i,t):y_(a,l,i,r):null},yA=["pre"],yO=(e,t,r,n)=>{var o;let a=t.firstChild,l=t.lastChild,i="bookmark"===l.attr("data-mce-type")?l.prev:l,s=em(yA,a.name);if(a!==i||!s)return!1;{let t="false"!==a.attr("contenteditable"),l=(null===(o=e.getParent(r,e.isBlock))||void 0===o?void 0:o.nodeName.toLowerCase())===a.name,i=ea.from(vX(n,r)).forall(oA);return t&&l&&i}},yT=(e,t,r)=>!!H(r)&&r===e.getParent(t.endContainer,oT)&&uC(rz.fromDom(r),t),yB=(e,t,r)=>{var n;if("all"===r.getAttribute("data-mce-bogus"))null===(n=r.parentNode)||void 0===n||n.insertBefore(e.dom.createFragment(t),r);else{let n=r.firstChild,o=r.lastChild;n&&(n!==o||"BR"!==n.nodeName)?e.selection.setContent(t,{no_events:!0}):e.dom.setHTML(r,t)}},yP=(e,t)=>{ea.from(e.getParent(t,"td,th")).map(rz.fromDom).each(o9)},yL=(e,t)=>{let r=e.schema.getTextInlineElements(),n=e.dom;if(t){let t=e.getBody(),o=vZ(e);t2.each(n.select("*[data-mce-fragment]"),e=>{if(H(r[e.nodeName.toLowerCase()])&&hx(n,e)){for(let r=e.parentElement;H(r)&&r!==t&&!hE(n,e,r);r=r.parentElement)if(o.compare(r,e)){n.remove(e,!0);break}}})}},yF=e=>{let t=e;for(;t=t.walk();)1===t.type&&t.attr("data-mce-fragment","1")},yM=e=>{t2.each(e.getElementsByTagName("*"),e=>{e.removeAttribute("data-mce-fragment")})},yI=e=>!!e.getAttribute("data-mce-fragment"),yU=(e,t)=>H(t)&&!e.schema.getVoidElements()[t.nodeName],yz=(e,t)=>{var r,n,o,a;let l;let i=e.dom,s=e.selection;if(!t)return;s.scrollIntoView(t);let d=vX(e.getBody(),t);if(d&&"false"===i.getContentEditable(d)){i.remove(t),s.select(d);return}let c=i.createRng(),m=t.previousSibling;if(ow(m)){c.setStart(m,null!==(n=null===(r=m.nodeValue)||void 0===r?void 0:r.length)&&void 0!==n?n:0);let e=t.nextSibling;ow(e)&&(m.appendData(e.data),null===(o=e.parentNode)||void 0===o||o.removeChild(e))}else c.setStartBefore(t),c.setEndBefore(t);let u=i.getParent(t,i.isBlock);if(i.remove(t),u&&i.isEmpty(u)){let t;let r=oT(u);nq(rz.fromDom(u)),c.setStart(u,0),c.setEnd(u,0),!r&&!yI(u)&&(a=c,t=sf.fromRangeStart(a),l=null==(t=mv(e.getBody()).next(t))?void 0:t.toRange())?(c=l,i.remove(u)):i.add(u,i.create("br",r?{}:{"data-mce-bogus":"1"}))}s.setRng(c)},yj=e=>{let t=e.dom,r=ys(e.selection.getRng());e.selection.setRng(r);let n=t.getParent(r.startContainer,oT);yT(t,r,n)?vA(e,r,rz.fromDom(n)):r.startContainer===r.endContainer&&r.endOffset-r.startOffset==1&&ow(r.startContainer.childNodes[r.startOffset])?r.deleteContents():e.getDoc().execCommand("Delete",!1)},yH=e=>{for(let t=e;t;t=t.walk())if("mce_marker"===t.attr("id"))return ea.some(t);return ea.none()},y$=(e,t,r)=>{var n,o;let a=e.selection,l=e.dom,i=e.parser,s=r.merge,d=hh({validate:!0},e.schema),c='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';-1===t.indexOf("{$caret}")&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,c);let m=a.getRng(),u=m.startContainer,f=e.getBody();u===f&&a.isCollapsed()&&l.isBlock(f.firstChild)&&yU(e,f.firstChild)&&l.isEmpty(f.firstChild)&&((m=l.createRng()).setStart(f.firstChild,0),m.setEnd(f.firstChild,0),a.setRng(m)),a.isCollapsed()||yj(e);let g=a.getNode(),p={context:g.nodeName.toLowerCase(),data:r.data,insert:!0},h=i.parse(t,p);if(!0===r.paste&&yf(e.schema,h)&&yw(l,g))return(m=yR(d,l,a.getRng(),h))&&a.setRng(m),t;!0===r.paste&&yO(l,h,g,e.getBody())&&(null===(n=h.firstChild)||void 0===n||n.unwrap()),yF(h);let b=h.lastChild;if(b&&"mce_marker"===b.attr("id")){let t=b;for(b=b.prev;b;b=b.walk(!0))if(3===b.type||!l.isBlock(b.name)){b.parent&&e.schema.isValidChild(b.parent.name,"span")&&b.parent.insert(t,b,"br"===b.name);break}}if(e._selectionOverrides.showBlockCaretContainer(g),p.invalid){let r;e.selection.setContent(c);let n=a.getNode(),s=e.getBody();for(o_(n)?n=r=s:r=n;r&&r!==s;)n=r,r=r.parentNode;t=n===s?s.innerHTML:l.getOuterHTML(n);let m=i.parse(t),u=yH(m),f=u.bind(yt).getOr(m);u.each(e=>e.replace(h));let g=h.children(),p=null!==(o=h.parent)&&void 0!==o?o:m;h.unwrap(),yn(eb(g,t=>ya(e.schema,t,p)),e.schema,f),v8(i.getNodeFilters(),i.getAttributeFilters(),m),t=d.serialize(m),n===s?l.setHTML(s,t):l.setOuterHTML(n,t)}else yB(e,t=d.serialize(h),g);return yL(e,s),yz(e,l.get("mce_marker")),yM(e.getBody()),yP(l,a.getStart()),aG(e.schema,e.getBody(),a.getStart()),t},yq=e=>e instanceof p4,yV=e=>{pT(e)&&mT(e.getBody()).each(t=>{let r=t.getNode(),n=oy(r)?mT(r).getOr(t):t;e.selection.setRng(n.toRange())})},yW=(e,t,r)=>{e.dom.setHTML(e.getBody(),t),!0!==r&&yV(e)},yK=(e,t,r,n)=>{if(0===r.length||/^\s+$/.test(r)){let o='<br data-mce-bogus="1">';"TABLE"===t.nodeName?r="<tr><td>"+o+"</td></tr>":/^(UL|OL)$/.test(t.nodeName)&&(r="<li>"+o+"</li>");let a=dd(e);return e.schema.isValidChild(t.nodeName.toLowerCase(),a.toLowerCase())?(r=o,r=e.dom.createHTML(a,dc(e),r)):r||(r=o),yW(e,r,n.no_selection),{content:r,html:r}}{"raw"!==n.format&&(r=hh({validate:!1},e.schema).serialize(e.parser.parse(r,{isRootContent:!0,insert:!0})));let o=o0(rz.fromDom(t))?r:t2.trim(r);return yW(e,o,n.no_selection),{content:o,html:o}}},yG=(e,t,r,n)=>{v8(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),r);let o=hh({validate:!1},e.schema).serialize(r),a=o0(rz.fromDom(t))?o:t2.trim(o);return yW(e,a,n.no_selection),{content:r,html:a}},yY=(e,t,r)=>ea.from(e.getBody()).map(n=>yq(t)?yG(e,n,t,r):yK(e,n,t,r)).getOr({content:t,html:yq(r.content)?"":r.content}),yX=(e,t,r)=>np(e,t,r).isSome(),yQ=(e,t)=>nb(e,t).isSome(),yJ=e=>$(e)?e:en,yZ=(e,t,r)=>{let n=e.dom,o=yJ(r);for(;n.parentNode;){n=n.parentNode;let e=rz.fromDom(n),r=t(e);if(r.isSome())return r;if(o(e))break}return ea.none()},y0=(e,t,r)=>{let n=t(e),o=yJ(r);return n.orThunk(()=>o(e)?ea.none():yZ(e,t,o))},y1=(e,t,r)=>{let n=e.formatter.get(r);if(n)for(let r=0;r<n.length;r++){let o=n[r];if(uX(o)&&!1===o.inherit&&e.dom.is(t,o.selector))return!0}return!1},y2=(e,t,r,n,o)=>{let a=e.dom.getRoot();if(t===a)return!1;let l=e.dom.getParent(t,t=>!!y1(e,t,r)||t.parentNode===a||!!y5(e,t,r,n,!0));return!!y5(e,l,r,n,o)},y3=(e,t,r)=>!!(uQ(r)&&uU(t,r.inline)||uK(r)&&uU(t,r.block))||!!uX(r)&&ou(t)&&e.is(t,r.selector),y8=(e,t,r,n,o,a)=>{let l=r[n],i="attributes"===n;if($(r.onmatch))return r.onmatch(t,r,n);if(l){if(eJ(l))for(let r=0;r<l.length&&(i?!e.getAttrib(t,l[r]):!uj(e,t,l[r]));r++);else for(let n in l)if(eG(l,n)){let s=i?e.getAttrib(t,n):uj(e,t,n),d=uI(l[n],a),c=j(s)||tv(s);if(c&&j(d))continue;if(o&&c&&!r.exact||(!o||r.exact)&&!uU(s,uz(d,n)))return!1}}return!0},y5=(e,t,r,n,o)=>{let a=e.formatter.get(r),l=e.dom;if(a&&ou(t))for(let r=0;r<a.length;r++){let i=a[r];if(y3(e.dom,t,i)&&y8(l,t,i,"attributes",o,n)&&y8(l,t,i,"styles",o,n)){let r=i.classes;if(r){for(let o=0;o<r.length;o++)if(!e.dom.hasClass(t,uI(r[o],n)))return}return i}}},y6=(e,t,r,n,o)=>{if(n)return y2(e,n,t,r,o);if(n=e.selection.getNode(),y2(e,n,t,r,o))return!0;let a=e.selection.getStart();return!!(a!==n&&y2(e,a,t,r,o))},y9=(e,t,r)=>{let n=[],o={},a=e.selection.getStart();return e.dom.getParent(a,a=>{for(let l=0;l<t.length;l++){let i=t[l];!o[i]&&y5(e,a,i,r)&&(o[i]=!0,n.push(i))}},e.dom.getRoot()),n},y4=(e,t)=>{let r=t=>rW(t,rz.fromDom(e.getBody())),n=(t,r)=>y5(e,t.dom,r)?ea.some(r):ea.none();return ea.from(e.selection.getStart(!0)).bind(e=>y0(rz.fromDom(e),e=>eP(t,t=>n(e,t)),r)).getOrNull()},y7=(e,t)=>{let r=e.formatter.get(t),n=e.dom;if(r&&e.selection.isEditable()){let t=u$(n,e.selection.getStart());for(let e=r.length-1;e>=0;e--){let o=r[e];if(!uX(o))return!0;for(let e=t.length-1;e>=0;e--)if(n.is(t[e],o.selector))return!0}}return!1},Ce=(e,t,r)=>ey(r,(r,n)=>{let o=uV(e,n);return e.formatter.matchNode(t,n,{},o)?r.concat([n]):r},[]),Ct=(e,t)=>e.importNode(t,!0),Cr=e=>{let t=[],r=e;for(;r;){if(ow(r)&&"\uFEFF"!==r.data||r.childNodes.length>1)return[];ou(r)&&t.push(r),r=r.firstChild}return t},Cn=e=>Cr(e).length>0,Co=e=>{if(e){let t=new od(e,e);for(let e=t.current();e;e=t.next())if(ow(e))return e}return null},Ca=e=>{let t=rz.fromTag("span");return ry(t,{id:mP,"data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&nz(t,rz.fromText("\uFEFF")),t},Cl=e=>{let t=Co(e);return t&&"\uFEFF"===t.data.charAt(0)&&t.deleteData(0,1),t},Ci=(e,t,r=!0)=>{let n=e.dom,o=e.selection;if(Cn(t))bH(e,!1,rz.fromDom(t),r);else{let e=o.getRng(),r=n.getParent(t,n.isBlock),a=e.startContainer,l=e.startOffset,i=e.endContainer,s=e.endOffset,d=Cl(t);n.remove(t,!0),a===d&&l>0&&e.setStart(d,l-1),i===d&&s>0&&e.setEnd(d,s-1),r&&n.isEmpty(r)&&o6(rz.fromDom(r)),o.setRng(e)}},Cs=(e,t,r=!0)=>{let n=e.dom,o=e.selection;if(t)Ci(e,t,r);else if(!(t=mF(e.getBody(),o.getStart())))for(;t=n.get(mP);)Ci(e,t,r)},Cd=(e,t,r)=>{var n,o;let a=e.dom,l=a.getParent(r,J(uT,e.schema));l&&a.isEmpty(l)?null===(n=r.parentNode)||void 0===n||n.replaceChild(t,r):(o8(rz.fromDom(r)),a.isEmpty(r)?null===(o=r.parentNode)||void 0===o||o.replaceChild(t,r):a.insertAfter(t,r))},Cc=(e,t)=>(e.appendChild(t),t),Cm=(e,t)=>{var r;let n=ev(e,(e,t)=>Cc(e,t.cloneNode(!1)),t),o=null!==(r=n.ownerDocument)&&void 0!==r?r:document;return Cc(n,o.createTextNode("\uFEFF"))},Cu=(e,t,r,n,o,a)=>{let l=e.formatter,i=e.dom,s=Ce(e,r,eb(eF(l.get()),e=>e!==n&&!tc(e,"removeformat")));if(!(eb(s,t=>!uW(e,t,n)).length>0))return ea.none();{let e=r.cloneNode(!1);return i.add(t,e),l.remove(n,o,e,a),i.remove(e),ea.some(e)}},Cf=(e,t,r)=>{let n;let o=e.selection,a=e.formatter.get(t);if(!a)return;let l=o.getRng(),i=l.startOffset,s=l.startContainer.nodeValue;n=mF(e.getBody(),o.getStart());let d=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(s&&i>0&&i<s.length&&d.test(s.charAt(i))&&d.test(s.charAt(i-1))){let n=o.getBookmark();l.collapse(!0);let i=ft(e.dom,l,a);i=gw(i),e.formatter.apply(t,r,i),o.moveToBookmark(n)}else{let a=n?Co(n):null;n&&(null==a?void 0:a.data)==="\uFEFF"||(a=(n=Ct(e.getDoc(),Ca(!0).dom)).firstChild,l.insertNode(n),i=1),e.formatter.apply(t,r,n),o.setCursorLocation(a,i)}},Cg=(e,t,r,n)=>{let o;let a=e.dom,l=e.selection,i=!1,s=e.formatter.get(t);if(!s)return;let d=l.getRng(),c=d.startContainer,m=d.startOffset,u=c;ow(c)&&(m!==c.data.length&&(i=!0),u=u.parentNode);let f=[];for(;u;){if(y5(e,u,t,r,n)){o=u;break}u.nextSibling&&(i=!0),f.push(u),u=u.parentNode}if(o){if(i){let o=l.getBookmark();d.collapse(!0);let i=ft(a,d,s,!0);i=gw(i),e.formatter.remove(t,r,i,n),l.moveToBookmark(o)}else{let i=mF(e.getBody(),o),s=Ca(!1).dom;Cd(e,s,null!=i?i:o);let d=Cu(e,s,o,t,r,n),c=Cm(f.concat(d.toArray()),s);i&&Ci(e,i,!1),l.setCursorLocation(c,1),a.isEmpty(o)&&a.remove(o)}}},Cp=(e,t,r)=>{let n=e.selection,o=e.getBody();Cs(e,null,r),(8===t||46===t)&&n.isCollapsed()&&"\uFEFF"===n.getStart().innerHTML&&Cs(e,mF(o,n.getStart())),(37===t||39===t)&&Cs(e,mF(o,n.getStart()))},Ch=e=>ow(e)&&tu(e.data,"\xa0"),Cb=e=>{e.on("mouseup keydown",t=>{Cp(e,t.keyCode,Ch(e.selection.getRng().endContainer))})},Cv=e=>{let t=Ca(!1),r=Cm(e,t.dom);return{caretContainer:t,caretPosition:sf(r,0)}},Cy=(e,t)=>{let{caretContainer:r,caretPosition:n}=Cv(t);return nM(rz.fromDom(e),r),nV(rz.fromDom(e)),n},CC=(e,t)=>{let{caretContainer:r,caretPosition:n}=Cv(t);return e.insertNode(r.dom),n},Cx=(e,t)=>eG(e.schema.getTextInlineElements(),ri(t))&&!mL(t.dom)&&!ob(t.dom),Cw=e=>mL(e.dom)&&Cn(e.dom),CE={},Ck=og(["pre"]),CS=(e,t)=>{eG(CE,e)&&eg(CE[e],e=>{e(t)})};c=e=>{let t=e.selection.getRng(),r=(e,t)=>{let r=rz.fromDom(t),n=rY(r).dom;nV(r),n$(rz.fromDom(e),[rz.fromTag("br",n),rz.fromTag("br",n),...r6(r)])};if(!t.collapsed){let t=e.selection.getSelectedBlocks();eg(eb(eb(t,Ck),e=>{let r=e.previousSibling;return Ck(r)&&em(t,r)}),e=>{r(e.previousSibling,e)})}},CE.pre||(CE.pre=[]),CE.pre.push(c);let C_=["fontWeight","fontStyle","color","fontSize","fontFamily"],CN=e=>L(e.styles)&&eu(eF(e.styles),e=>em(C_,e)),CD=e=>ex(e,e=>uQ(e)&&"span"===e.inline&&CN(e)),CR=(e,t)=>{let r=e.get(t);return M(r)?CD(r):ea.none()},CA=(e,t)=>mO(t,sf.fromRangeStart(e)).isNone(),CO=(e,t)=>!1===mA(t,sf.fromRangeEnd(e)).exists(e=>!oD(e.getNode())||mA(t,e).isSome()),CT=e=>t=>oL(t)&&e.isEditable(t),CB=e=>{let t=e.getSelectedBlocks(),r=e.getRng();if(e.isCollapsed())return[];if(1===t.length)return CA(r,t[0])&&CO(r,t[0])?t:[];{let e=eO(t).filter(e=>CA(r,e)).toArray(),n=eT(t).filter(e=>CO(r,e)).toArray(),o=t.slice(1,-1);return e.concat(o).concat(n)}},CP=e=>eb(CB(e),CT(e.dom)),CL=e=>eb(e.getSelectedBlocks(),CT(e.dom)),CF=t2.each,CM=e=>ou(e)&&!m8(e)&&!mL(e)&&!ob(e),CI=(e,t)=>{for(let r=e;r&&!(ow(r)&&tb(r.data));r=r[t])if(ou(r)&&!m8(r))return r;return e},CU=(e,t,r)=>{let n=vZ(e),o=ou(t)&&uD(t),a=ou(r)&&uD(r);if(o&&a){let o=CI(t,"previousSibling"),a=CI(r,"nextSibling");if(n.compare(o,a)){for(let e=o.nextSibling;e&&e!==a;){let t=e;e=e.nextSibling,o.appendChild(t)}return e.dom.remove(a),t2.each(t2.grep(a.childNodes),e=>{o.appendChild(e)}),o}}return r},Cz=(e,t,r,n)=>{var o;if(n&&!1!==t.merge_siblings){let t=null!==(o=CU(e,uO(n),n))&&void 0!==o?o:n;CU(e,t,uO(t,!0))}},Cj=(e,t,r)=>{if(t.clear_child_styles){let n=t.links?"*:not(a)":"*";CF(e.select(n,r),r=>{CM(r)&&uD(r)&&CF(t.styles,(t,n)=>{e.setStyle(r,n,"")})})}},CH=(e,t,r)=>{CF(e.childNodes,e=>{CM(e)&&(t(e)&&r(e),e.hasChildNodes()&&CH(e,t,r))})},C$=(e,t)=>{"SPAN"===t.nodeName&&0===e.getAttribs(t).length&&e.remove(t,!0)},Cq=(e,t)=>r=>!!(r&&uj(e,r,t)),CV=(e,t,r)=>n=>{e.setStyle(n,t,r),""===n.getAttribute("style")&&n.removeAttribute("style"),C$(e,n)},CW=sW([{keep:[]},{rename:["name"]},{removed:[]}]),CK=/^(src|href|style)$/,CG=t2.each,CY=e=>/^(TR|TH|TD)$/.test(e.nodeName),CX=(e,t,r)=>e.isChildOf(t,r)&&t!==r&&!e.isBlock(r),CQ=(e,t,r)=>{let n=t[r?"startContainer":"endContainer"],o=t[r?"startOffset":"endOffset"];if(ou(n)){let e=n.childNodes.length-1;!r&&o&&o--,n=n.childNodes[o>e?e:o]}return ow(n)&&r&&o>=n.data.length&&(n=new od(n,e.getBody()).next()||n),ow(n)&&!r&&0===o&&(n=new od(n,e.getBody()).prev()||n),n},CJ=(e,t)=>{let r=t?"firstChild":"lastChild",n=e[r];return CY(e)&&n?"TR"===e.nodeName&&n[r]||n:e},CZ=(e,t,r,n)=>{var o;let a=e.create(r,n);return null===(o=t.parentNode)||void 0===o||o.insertBefore(a,t),a.appendChild(t),a},C0=(e,t,r,n,o)=>{let a=rz.fromDom(t),l=rz.fromDom(e.create(n,o));return n$(l,r?r5(a):r8(a)),r?(nM(a,l),nU(l,a)):(nI(a,l),nz(l,a)),l.dom},C1=(e,t)=>t.links&&"A"===e.nodeName,C2=(e,t,r)=>{let n;let o=t.parentNode,a=e.dom,l=dd(e);!uK(r)||o!==a.getRoot()||r.list_block&&uU(t,r.list_block)||eg(eB(t.childNodes),t=>{uB(e,l,t.nodeName.toLowerCase())?n?n.appendChild(t):(n=CZ(a,t,l),a.setAttribs(n,dc(e))):n=null}),(!uJ(r)||uU(r.inline,t))&&a.remove(t,!0)},C3=(e,t,r)=>q(e)?{name:t,value:null}:{name:e,value:uI(t,r)},C8=(e,t)=>{""===e.getAttrib(t,"style")&&(t.removeAttribute("style"),t.removeAttribute("data-mce-style"))},C5=(e,t,r,n,o)=>{let a=!1;CG(r.styles,(l,i)=>{let{name:s,value:d}=C3(i,l,n),c=uz(d,s);(r.remove_similar||I(d)||!ou(o)||uU(uj(e,o,s),c))&&e.setStyle(t,s,""),a=!0}),a&&C8(e,t)},C6=(e,t,r)=>{"removeformat"===t?eg(CL(e.selection),t=>{eg(C_,r=>e.dom.setStyle(t,r,"")),C8(e.dom,t)}):CR(e.formatter,t).each(t=>{eg(CL(e.selection),n=>C5(e.dom,n,t,r,null))})},C9=(e,t,r,n,o)=>{let a=e.dom,l=vZ(e),i=e.schema;if(uQ(t)&&aX(i,t.inline)&&aJ(i,n)&&n.parentElement===e.getBody())return C2(e,n,t),CW.removed();if(!t.ceFalseOverride&&n&&"false"===a.getContentEditableParent(n)||n&&!y3(a,n,t)&&!C1(n,t))return CW.keep();let s=t.preserve_attributes;if(uQ(t)&&"all"===t.remove&&M(s)){let e=eb(a.getAttribs(n),e=>em(s,e.name.toLowerCase()));if(a.removeAllAttribs(n),eg(e,e=>a.setAttrib(n,e.name,e.value)),e.length>0)return CW.rename("span")}if("all"!==t.remove){C5(a,n,t,r,o),CG(t.attributes,(e,l)=>{let{name:i,value:s}=C3(l,e,r);if(t.remove_similar||I(s)||!ou(o)||uU(a.getAttrib(o,i),s)){if("class"===i){let e=a.getAttrib(n,i);if(e){let t="";if(eg(e.split(/\s+/),e=>{/mce\-\w+/.test(e)&&(t+=(t?" ":"")+e)}),t){a.setAttrib(n,i,t);return}}}if(CK.test(i)&&n.removeAttribute("data-mce-"+i),"style"===i&&og(["li"])(n)&&"none"===a.getStyle(n,"list-style-type")){n.removeAttribute(i),a.setStyle(n,"list-style-type","none");return}"class"===i&&n.removeAttribute("className"),n.removeAttribute(i)}}),CG(t.classes,e=>{e=uI(e,r),(!ou(o)||a.hasClass(o,e))&&a.removeClass(n,e)});let e=a.getAttribs(n);for(let t=0;t<e.length;t++){let r=e[t].nodeName;if(!l.isAttributeInternal(r))return CW.keep()}}return"none"!==t.remove?(C2(e,n,t),CW.removed()):CW.keep()},C4=(e,t,r,n,o)=>{let a;return t.parentNode&&eg(u$(e.dom,t.parentNode).reverse(),t=>{if(!a&&ou(t)&&"_start"!==t.id&&"_end"!==t.id){let l=y5(e,t,r,n,o);l&&!1!==l.split&&(a=t)}}),a},C7=(e,t,r,n)=>C9(e,t,r,n,n).fold(Y(n),t=>(e.dom.createFragment().appendChild(n),e.dom.rename(n,t)),Y(null)),xe=(e,t,r,n,o,a,l,i)=>{var s,d;let c,m;let u=e.dom;if(r){let f=r.parentNode;for(let r=n.parentNode;r&&r!==f;r=r.parentNode){let n=u.clone(r,!1);for(let r=0;r<t.length&&null!==(n=C7(e,t[r],i,n));r++);n&&(c&&n.appendChild(c),m||(m=n),c=n)}!a||l.mixed&&u.isBlock(r)||(n=null!==(s=u.split(r,n))&&void 0!==s?s:n),c&&m&&(null===(d=o.parentNode)||void 0===d||d.insertBefore(c,o),m.appendChild(o),uQ(l)&&Cz(e,l,i,c))}return n},xt=(e,t,r,n,o)=>{let a=e.formatter.get(t),l=a[0],i=e.dom,s=e.selection,d=n=>{let i=C4(e,n,t,r,o);return xe(e,a,i,n,n,!0,l,r)},c=e=>m8(e)&&ou(e)&&("_start"===e.id||"_end"===e.id),m=t=>eu(a,n=>xn(e,n,r,t,t)),u=t=>{let r=eB(t.childNodes),n=m(t)||eu(a,e=>y3(i,t,e)),o=t.parentNode;if(!n&&H(o)&&uZ(l)&&m(o),l.deep&&r.length)for(let e=0;e<r.length;e++)u(r[e]);eg(["underline","line-through","overline"],r=>{ou(t)&&e.dom.getStyle(t,"text-decoration")===r&&t.parentNode&&uH(i,t.parentNode)===r&&xn(e,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:r}},void 0,t)})},f=e=>{let t=i.get(e?"_start":"_end");if(!t)return null;{let r=t[e?"firstChild":"lastChild"];return c(r)&&(r=r[e?"firstChild":"lastChild"]),ow(r)&&0===r.data.length&&(r=e?t.previousSibling||t.nextSibling:t.nextSibling||t.previousSibling),i.remove(t,!0),r}},g=t=>{let r,n;let o=ft(i,t,a,t.collapsed);if(l.split){if((r=CQ(e,o=gw(o),!0))!==(n=CQ(e,o))){if(CX(i,r=CJ(r,!0),n=CJ(n,!1))){d(C0(i,ea.from(r.firstChild).getOr(r),!0,"span",{id:"_start","data-mce-type":"bookmark"})),f(!0);return}if(CX(i,n,r)){d(C0(i,ea.from(n.lastChild).getOr(n),!1,"span",{id:"_end","data-mce-type":"bookmark"})),f(!1);return}r=CZ(i,r,"span",{id:"_start","data-mce-type":"bookmark"}),n=CZ(i,n,"span",{id:"_end","data-mce-type":"bookmark"});let e=i.createRng();e.setStartAfter(r),e.setEndBefore(n),fr(i,e,e=>{eg(e,e=>{m8(e)||m8(e.parentNode)||d(e)})}),d(r),d(n),r=f(!0),n=f()}else r=n=d(r);o.startContainer=r.parentNode?r.parentNode:r,o.startOffset=i.nodeIndex(r),o.endContainer=n.parentNode?n.parentNode:n,o.endOffset=i.nodeIndex(n)+1}fr(i,o,e=>{eg(e,u)})};if(n){if(uS(n)){let e=i.createRng();e.setStartBefore(n),e.setEndAfter(n),g(e)}else g(n);fD(e,t,n,r);return}s.isCollapsed()&&uQ(l)&&!ug(e).length?Cg(e,t,r,o):(uR(e,()=>uE(e,g),n=>uQ(l)&&y6(e,t,r,n)),e.nodeChanged()),C6(e,t,r),fD(e,t,n,r)},xr=(e,t,r,n,o)=>{(n||e.selection.isEditable())&&xt(e,t,r,n,o)},xn=(e,t,r,n,o)=>C9(e,t,r,n,o).fold(en,t=>(e.dom.rename(n,t),!0),eo),xo=t2.each,xa=(e,t,r,n)=>{let o=t=>{if(ou(t)&&ou(t.parentNode)&&uD(t)){let r=uH(e,t.parentNode);e.getStyle(t,"color")&&r?e.setStyle(t,"text-decoration",r):e.getStyle(t,"text-decoration")===r&&e.setStyle(t,"text-decoration",null)}};t.styles&&(t.styles.color||t.styles.textDecoration)&&(t2.walk(n,o,"childNodes"),o(n))},xl=(e,t,r,n)=>{if(t.styles&&t.styles.backgroundColor){let o=Cq(e,"fontSize");CH(n,e=>o(e)&&uD(e),CV(e,"backgroundColor",uI(t.styles.backgroundColor,r)))}},xi=(e,t,r,n)=>{if(uQ(t)&&("sub"===t.inline||"sup"===t.inline)){let r=Cq(e,"fontSize");CH(n,e=>r(e)&&uD(e),CV(e,"fontSize",""));let o=eb(e.select("sup"===t.inline?"sub":"sup",n),uD);e.remove(o,!0)}},xs=(e,t,r,n)=>{xo(t,t=>{uQ(t)&&xo(e.dom.select(t.inline,n),n=>{CM(n)&&xn(e,t,r,n,t.exact?n:null)}),Cj(e.dom,t,n)})},xd=(e,t,r,n,o)=>{let a=o.parentNode;!(y5(e,a,r,n)&&xn(e,t,n,o))&&t.merge_with_parents&&a&&e.dom.getParent(a,a=>!!y5(e,a,r,n)&&(xn(e,t,n,o),!0))},xc=t2.each,xm=(e,t,r,n)=>{if(!(dG(e)&&uQ(t))||!r.parentNode)return!1;{let t=lM(e.schema),o=yQ(rz.fromDom(r),e=>mL(e.dom));return eY(t,n)&&aF(rz.fromDom(r.parentNode),!1)&&!o}},xu=(e,t,r,n)=>{if(xc(r.styles,(r,o)=>{e.setStyle(t,o,uI(r,n))}),r.styles){let r=e.getAttrib(t,"style");r&&e.setAttrib(t,"data-mce-style",r)}},xf=(e,t,r,n)=>{let o=e.formatter.get(t),a=o[0],l=!n&&e.selection.isCollapsed(),i=e.dom,s=e.selection,d=(e,t=a)=>{$(t.onformat)&&t.onformat(e,t,r,n),xu(i,e,t,r),xc(t.attributes,(t,n)=>{i.setAttrib(e,n,uI(t,r))}),xc(t.classes,t=>{let n=uI(t,r);i.hasClass(e,n)||i.addClass(e,n)})},c=(e,t)=>{let r=!1;return xc(e,e=>!!uX(e)&&(!!("false"===i.getContentEditable(t)&&!e.ceFalseOverride||H(e.collapsed)&&e.collapsed!==l)||!i.is(t,e.selector)||!!mL(t)||(d(t,e),r=!0,!1))),r},m=e=>{if(!P(e))return null;{let t=i.create(e);return d(t),t}},u=(n,l,i)=>{let s=[],u=!0,f=a.inline||a.block,g=m(f),p=n=>uG(a)&&y5(e,n,t,r),h=(t,r,n)=>{let o=uY(a)&&uT(e.schema,t)&&uB(e,r,f);return n&&o},b=(t,r,o,l)=>{let s=uB(e,f,t.nodeName.toLowerCase())&&uB(e,r,f),d=!i&&ow(t)&&oI(t.data),c=mL(t),m=!uQ(a)||!n.isBlock(t);return(o||l)&&s&&!d&&!c&&m};fr(n,l,t=>{let r;let l=t=>{let i=!1,m=u,v=!1,y=t.parentNode,C=y.nodeName.toLowerCase(),x=n.getContentEditable(t);H(x)&&(m=u,u="true"===x,i=!0,v=uM(e,t));let w=u&&!i;if(oD(t)&&!xm(e,a,t,C)){r=null,uK(a)&&n.remove(t);return}if(p(t)){r=null;return}if(h(t,C,w)){let e=n.rename(t,f);d(e),s.push(e),r=null;return}if(uX(a)){let e=c(o,t);if(!e&&H(y)&&uZ(a)&&(e=c(o,y)),!uQ(a)||e){r=null;return}}H(g)&&b(t,C,w,v)?(r||(r=n.clone(g,!1),y.insertBefore(r,t),s.push(r)),v&&i&&(u=m),r.appendChild(t)):(r=null,eg(eB(t.childNodes),l),i&&(u=m),r=null)};eg(t,l)}),!0===a.links&&eg(s,e=>{let t=e=>{"A"===e.nodeName&&d(e,a),eg(eB(e.childNodes),t)};t(e)}),eg(s,l=>{let i;let c=(i=0,eg(l.childNodes,e=>{!uL(e)&&!m8(e)&&i++}),i);if((s.length>1||!n.isBlock(l))&&0===c){n.remove(l,!0);return}if(uQ(a)||uK(a)&&a.wrapper){if(!a.exact&&1===c){var m;l=ex((m=l).childNodes,u_).filter(e=>"false"!==n.getContentEditable(e)&&y3(n,e,a)).map(e=>{let t=n.clone(e,!1);return d(t),n.replace(t,m,!0),n.remove(e,!0),t}).getOr(m)}xs(e,o,r,l),xd(e,a,t,r,l),xl(n,a,r,l),xa(n,a,r,l),xi(n,a,r,l),Cz(e,a,r,l)}})},f=uS(n)?n:s.getNode();if("false"===i.getContentEditable(f)&&!uM(e,f)){c(o,n=f),fN(e,t,n,r);return}if(a){if(n){if(uS(n)){if(!c(o,n)){let e=i.createRng();e.setStartBefore(n),e.setEndAfter(n),u(i,ft(i,e,o),!0)}}else u(i,n,!0)}else l&&uQ(a)&&!ug(e).length?Cf(e,t,r):(s.setRng(ys(s.getRng())),uR(e,()=>{uE(e,(e,t)=>{let r=t?e:ft(i,e,o);u(i,r,!1)})},eo),e.nodeChanged()),CR(e.formatter,t).each(t=>{eg(CP(e.selection),e=>xu(i,e,t,r))});CS(t,e)}fN(e,t,n,r)},xg=(e,t,r,n)=>{(n||e.selection.isEditable())&&xf(e,t,r,n)},xp=e=>eG(e,"vars"),xh=(e,t)=>{e.set({}),t.on("NodeChange",r=>{xC(t,r.element,e.get())}),t.on("FormatApply FormatRemove",r=>{let n=ea.from(r.node).map(e=>uS(e)?e:e.startContainer).bind(e=>ou(e)?ea.some(e):ea.from(e.parentElement)).getOrThunk(()=>xb(t));xC(t,n,e.get())})},xb=e=>e.selection.getStart(),xv=(e,t,r,n,o)=>eC(t,t=>!z(e.formatter.matchNode(t,r,null!=o?o:{},n)),t=>!!y1(e,t,r)||!n&&H(e.formatter.matchNode(t,r,o,!0))),xy=(e,t)=>{let r=null!=t?t:xb(e);return eb(u$(e.dom,r),e=>ou(e)&&!ob(e))},xC=(e,t,r)=>{let n=xy(e,t);eI(r,(r,o)=>{let a=r=>{let a=xv(e,n,o,r.similar,xp(r)?r.vars:void 0),l=a.isSome();if(r.state.get()!==l){r.state.set(l);let e=a.getOr(t);xp(r)?r.callback(l,{node:e,format:o,parents:n}):eg(r.callbacks,t=>t(l,{node:e,format:o,parents:n}))}};eg([r.withSimilar,r.withoutSimilar],a),eg(r.withVars,a)})},xx=(e,t,r,n,o,a)=>{let l=t.get();eg(r.split(","),t=>{let r=eK(l,t).getOrThunk(()=>{let e={withSimilar:{state:ia(!1),similar:!0,callbacks:[]},withoutSimilar:{state:ia(!1),similar:!1,callbacks:[]},withVars:[]};return l[t]=e,e}),i=()=>{let r=xy(e);return xv(e,r,t,o,a).isSome()};if(z(a)){let e=o?r.withSimilar:r.withoutSimilar;e.callbacks.push(n),1===e.callbacks.length&&e.state.set(i())}else r.withVars.push({state:ia(i()),similar:o,vars:a,callback:n})}),t.set(l)},xw=(e,t,r)=>{let n=e.get();eg(t.split(","),e=>eK(n,e).each(t=>{n[e]={withSimilar:{...t.withSimilar,callbacks:eb(t.withSimilar.callbacks,e=>e!==r)},withoutSimilar:{...t.withoutSimilar,callbacks:eb(t.withoutSimilar.callbacks,e=>e!==r)},withVars:eb(t.withVars,e=>e.callback!==r)}})),e.set(n)},xE=(e,t,r,n,o,a)=>(xx(e,t,r,n,o,a),{unbind:()=>xw(t,r,n)}),xk=(e,t,r,n)=>{let o=e.formatter.get(t);o&&(!y6(e,t,r,n)||"toggle"in o[0]&&!o[0].toggle?xg(e,t,r,n):xr(e,t,r,n))},xS=t2.explode,x_=()=>{let e={};return{addFilter:(t,r)=>{eg(xS(t),t=>{eG(e,t)||(e[t]={name:t,callbacks:[]}),e[t].callbacks.push(r)})},getFilters:()=>eW(e),removeFilter:(t,r)=>{eg(xS(t),t=>{if(eG(e,t)){if(H(r)){let n=e[t],o=eb(n.callbacks,e=>e!==r);o.length>0?n.callbacks=o:delete e[t]}else delete e[t]}})}}},xN=(e,t)=>{eg(t,t=>{e.attr(t,null)})},xD=(e,t,r)=>{e.addNodeFilter("font",e=>{eg(e,e=>{let n=t.parse(e.attr("style")),o=e.attr("color"),a=e.attr("face"),l=e.attr("size");o&&(n.color=o),a&&(n["font-family"]=a),l&&tC(l).each(e=>{n["font-size"]=r[e-1]}),e.name="span",e.attr("style",t.serialize(n)),xN(e,["color","face","size"])})})},xR=(e,t,r)=>{e.addNodeFilter("strike",e=>{let n="html4"!==t.type;eg(e,e=>{if(n)e.name="s";else{let t=r.parse(e.attr("style"));t["text-decoration"]="line-through",e.name="span",e.attr("style",r.serialize(t))}})})},xA=(e,t,r)=>{var n;let o=lz();t.convert_fonts_to_spans&&xD(e,o,t2.explode(null!==(n=t.font_size_legacy_values)&&void 0!==n?n:"")),xR(e,r,o)},xO=(e,t,r)=>{t.inline_styles&&xA(e,t,r)},xT=(e,t,r)=>{t.addNodeFilter("br",(t,n,o)=>{let a=t2.extend({},r.getBlockElements()),l=r.getNonEmptyElements(),i=r.getWhitespaceElements();a.body=1;let s=e=>e.name in a||a0(r,e);for(let n=0,d=t.length;n<d;n++){let d=t[n],c=d.parent;if(c&&s(c)&&d===c.lastChild){let t=d.prev;for(;t;){let e=t.name;if("span"!==e||"bookmark"!==t.attr("data-mce-type")){"br"===e&&(d=null);break}t=t.prev}if(d&&(d.remove(),v7(r,l,i,c))){let t=r.getElementRule(c.name);t&&(t.removeEmpty?c.remove():t.paddEmpty&&v5(e,o,s,c))}}else{let e=d;for(;c&&c.firstChild===e&&c.lastChild===e&&(e=c,!a[c.name]);)c=c.parent;if(e===c){let e=new p4("#text",3);e.value="\xa0",d.replace(e)}}}})},xB=e=>fetch(e).then(e=>e.ok?e.blob():Promise.reject()).catch(()=>Promise.reject({message:`Cannot convert ${e} to Blob. Resource might not exist or is inaccessible.`,uriType:"blob"})),xP=e=>{let t=/([a-z0-9+\/=\s]+)/i.exec(e);return t?t[1]:""},xL=e=>{let[t,...r]=e.split(","),n=r.join(","),o=/data:([^/]+\/[^;]+)(;.+)?/.exec(t);if(!o)return ea.none();{let e=";base64"===o[2],t=e?xP(n):decodeURIComponent(n);return ea.some({type:o[1],data:t,base64Encoded:e})}},xF=(e,t,r=!0)=>{let n=t;if(r)try{n=atob(t)}catch(e){return ea.none()}let o=new Uint8Array(n.length);for(let e=0;e<o.length;e++)o[e]=n.charCodeAt(e);return ea.some(new Blob([o],{type:e}))},xM=e=>new Promise((t,r)=>{xL(e).bind(({type:e,data:t,base64Encoded:r})=>xF(e,t,r)).fold(()=>r("Invalid data URI"),t)}),xI=e=>tm(e,"blob:")?xB(e):tm(e,"data:")?xM(e):Promise.reject("Unknown URI format"),xU=e=>new Promise((t,r)=>{let n=new FileReader;n.onloadend=()=>{t(n.result)},n.onerror=()=>{var e;r(null===(e=n.error)||void 0===e?void 0:e.message)},n.readAsDataURL(e)}),xz=0,xj=e=>(e||"blobid")+xz++,xH=(e,t,r)=>xL(e).bind(({data:e,type:n,base64Encoded:o})=>t&&!o?ea.none():r(o?e:btoa(e),n)),x$=(e,t,r)=>{let n=e.create(xj(),t,r);return e.add(n),n},xq=(e,t,r=!1)=>xH(t,r,(t,r)=>ea.from(e.getByData(t,r)).orThunk(()=>xF(r,t).map(r=>x$(e,r,t)))),xV=(e,t)=>{let r=()=>Promise.reject("Invalid data URI");if(tm(t,"blob:")){let n=e.getByUri(t);return H(n)?Promise.resolve(n):xI(t).then(t=>xU(t).then(n=>xH(n,!1,r=>ea.some(x$(e,t,r))).getOrThunk(r)))}return tm(t,"data:")?xq(e,t).fold(r,e=>Promise.resolve(e)):Promise.reject("Unknown image data format")},xW=e=>H(e.attr("data-mce-bogus")),xK=e=>e.attr("src")===tJ.transparentSrc||H(e.attr("data-mce-placeholder")),xG=(e,t)=>{let{blob_cache:r}=t;if(r){let t=e=>{let t=e.attr("src");xK(e)||xW(e)||j(t)||xq(r,t,!0).each(t=>{e.attr("src",t.blobUri())})};e.addAttributeFilter("src",e=>eg(e,t))}},xY=(e,t)=>{let r=e.schema;t.remove_trailing_brs&&xT(t,e,r),e.addAttributeFilter("href",e=>{let r=e.length,n=e=>e.split(" ").filter(e=>e.length>0).concat(["noopener"]).sort().join(" "),o=e=>{let t=e?t2.trim(e):"";return/\b(noopener)\b/g.test(t)?t:n(t)};if(!t.allow_unsafe_link_target)for(;r--;){let t=e[r];"a"===t.name&&"_blank"===t.attr("target")&&t.attr("rel",o(t.attr("rel")))}}),t.allow_html_in_named_anchor||e.addAttributeFilter("id,name",e=>{let t=e.length,r,n,o,a;for(;t--;)if("a"===(a=e[t]).name&&a.firstChild&&!a.attr("href"))for(o=a.parent,r=a.lastChild;r&&o;)n=r.prev,o.insert(r,a),r=n}),t.fix_list_elements&&e.addNodeFilter("ul,ol",e=>{let t=e.length,r,n;for(;t--;)if((n=(r=e[t]).parent)&&("ul"===n.name||"ol"===n.name)){if(r.prev&&"li"===r.prev.name)r.prev.append(r);else{let e=new p4("li",1);e.attr("style","list-style-type: none"),r.wrap(e)}}});let n=r.getValidClasses();t.validate&&n&&e.addAttributeFilter("class",e=>{var t;let r=e.length;for(;r--;){let o=e[r],a=null!==(t=o.attr("class"))&&void 0!==t?t:"",l=t2.explode(a," "),i="";for(let e=0;e<l.length;e++){let t=l[e],r=!1,a=n["*"];a&&a[t]&&(r=!0),a=n[o.name],!r&&a&&a[t]&&(r=!0),r&&(i&&(i+=" "),i+=t)}i.length||(i=null),o.attr("class",i)}}),xG(e,t)};function xX(e){return(xX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xQ(e,t){return(xQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xJ(e,t,r){return(xJ=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&xQ(o,r.prototype),o}:Reflect.construct).apply(null,arguments)}function xZ(e){return function(e){if(Array.isArray(e))return x0(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return x0(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x0(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x0(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var x1=Object.hasOwnProperty,x2=Object.setPrototypeOf,x3=Object.isFrozen,x8=Object.getPrototypeOf,x5=Object.getOwnPropertyDescriptor,x6=Object.freeze,x9=Object.seal,x4=Object.create,x7="undefined"!=typeof Reflect&&Reflect,we=x7.apply,wt=x7.construct;we||(we=function(e,t,r){return e.apply(t,r)}),x6||(x6=function(e){return e}),x9||(x9=function(e){return e}),wt||(wt=function(e,t){return xJ(e,xZ(t))});var wr=wu(Array.prototype.forEach),wn=wu(Array.prototype.pop),wo=wu(Array.prototype.push),wa=wu(String.prototype.toLowerCase),wl=wu(String.prototype.match),wi=wu(String.prototype.replace),ws=wu(String.prototype.indexOf),wd=wu(String.prototype.trim),wc=wu(RegExp.prototype.test),wm=(s=TypeError,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return wt(s,t)});function wu(e){return function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return we(e,t,n)}}function wf(e,t){x2&&x2(e,null);for(var r=t.length;r--;){var n=t[r];if("string"==typeof n){var o=wa(n);o!==n&&(x3(t)||(t[r]=o),n=o)}e[n]=!0}return e}function wg(e){var t,r=x4(null);for(t in e)we(x1,e,[t])&&(r[t]=e[t]);return r}function wp(e,t){for(;null!==e;){var r=x5(e,t);if(r){if(r.get)return wu(r.get);if("function"==typeof r.value)return wu(r.value)}e=x8(e)}return function(e){return console.warn("fallback value for",e),null}}var wh=x6(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),wb=x6(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),wv=x6(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),wy=x6(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),wC=x6(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),wx=x6(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ww=x6(["#text"]),wE=x6(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),wk=x6(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),wS=x6(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),w_=x6(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),wN=x9(/\{\{[\w\W]*|[\w\W]*\}\}/gm),wD=x9(/<%[\w\W]*|[\w\W]*%>/gm),wR=x9(/^data-[\-\w.\u00B7-\uFFFF]/),wA=x9(/^aria-[\-\w]+$/),wO=x9(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),wT=x9(/^(?:\w+script|data):/i),wB=x9(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),wP=x9(/^html$/i),wL=function(e,t){if("object"!==xX(e)||"function"!=typeof e.createPolicy)return null;var r=null,n="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(n)&&(r=t.currentScript.getAttribute(n));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}},wF=function e(){var t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,o=function(t){return e(t)};if(o.version="2.3.8",o.removed=[],!n||!n.document||9!==n.document.nodeType)return o.isSupported=!1,o;var a=n.document,l=n.document,i=n.DocumentFragment,s=n.HTMLTemplateElement,d=n.Node,c=n.Element,m=n.NodeFilter,u=n.NamedNodeMap,f=void 0===u?n.NamedNodeMap||n.MozNamedAttrMap:u,g=n.HTMLFormElement,p=n.DOMParser,h=n.trustedTypes,b=c.prototype,v=wp(b,"cloneNode"),y=wp(b,"nextSibling"),C=wp(b,"childNodes"),x=wp(b,"parentNode");if("function"==typeof s){var w=l.createElement("template");w.content&&w.content.ownerDocument&&(l=w.content.ownerDocument)}var E=wL(h,a),k=E?E.createHTML(""):"",S=l,_=S.implementation,N=S.createNodeIterator,D=S.createDocumentFragment,R=S.getElementsByTagName,A=a.importNode,O={};try{O=wg(l).documentMode?l.documentMode:{}}catch(e){}var T={};o.isSupported="function"==typeof x&&_&&void 0!==_.createHTMLDocument&&9!==O;var B=wO,P=null,L=wf({},[].concat(xZ(wh),xZ(wb),xZ(wv),xZ(wC),xZ(ww))),F=null,M=wf({},[].concat(xZ(wE),xZ(wk),xZ(wS),xZ(w_))),I=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),U=null,z=null,j=!0,H=!0,$=!1,q=!1,V=!1,W=!1,K=!1,G=!1,Y=!1,X=!1,Q=!0,J=!0,Z=!1,ee={},et=null,er=wf({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),en=null,eo=wf({},["audio","video","img","source","image","track"]),ea=null,el=wf({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ei="http://www.w3.org/1998/Math/MathML",es="http://www.w3.org/2000/svg",ed="http://www.w3.org/1999/xhtml",ec=ed,em=!1,eu=["application/xhtml+xml","text/html"],ef=null,eg=l.createElement("form"),ep=function(e){return e instanceof RegExp||e instanceof Function},eh=function(e){ef&&ef===e||(e&&"object"===xX(e)||(e={}),P="ALLOWED_TAGS"in(e=wg(e))?wf({},e.ALLOWED_TAGS):L,F="ALLOWED_ATTR"in e?wf({},e.ALLOWED_ATTR):M,ea="ADD_URI_SAFE_ATTR"in e?wf(wg(el),e.ADD_URI_SAFE_ATTR):el,en="ADD_DATA_URI_TAGS"in e?wf(wg(eo),e.ADD_DATA_URI_TAGS):eo,et="FORBID_CONTENTS"in e?wf({},e.FORBID_CONTENTS):er,U="FORBID_TAGS"in e?wf({},e.FORBID_TAGS):{},z="FORBID_ATTR"in e?wf({},e.FORBID_ATTR):{},ee="USE_PROFILES"in e&&e.USE_PROFILES,j=!1!==e.ALLOW_ARIA_ATTR,H=!1!==e.ALLOW_DATA_ATTR,$=e.ALLOW_UNKNOWN_PROTOCOLS||!1,q=e.SAFE_FOR_TEMPLATES||!1,V=e.WHOLE_DOCUMENT||!1,G=e.RETURN_DOM||!1,Y=e.RETURN_DOM_FRAGMENT||!1,X=e.RETURN_TRUSTED_TYPE||!1,K=e.FORCE_BODY||!1,Q=!1!==e.SANITIZE_DOM,J=!1!==e.KEEP_CONTENT,Z=e.IN_PLACE||!1,B=e.ALLOWED_URI_REGEXP||B,ec=e.NAMESPACE||ed,e.CUSTOM_ELEMENT_HANDLING&&ep(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(I.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&ep(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(I.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(I.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),r="application/xhtml+xml"===(t=t=-1===eu.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE)?function(e){return e}:wa,q&&(H=!1),Y&&(G=!0),ee&&(P=wf({},xZ(ww)),F=[],!0===ee.html&&(wf(P,wh),wf(F,wE)),!0===ee.svg&&(wf(P,wb),wf(F,wk),wf(F,w_)),!0===ee.svgFilters&&(wf(P,wv),wf(F,wk),wf(F,w_)),!0===ee.mathMl&&(wf(P,wC),wf(F,wS),wf(F,w_))),e.ADD_TAGS&&(P===L&&(P=wg(P)),wf(P,e.ADD_TAGS)),e.ADD_ATTR&&(F===M&&(F=wg(F)),wf(F,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&wf(ea,e.ADD_URI_SAFE_ATTR),e.FORBID_CONTENTS&&(et===er&&(et=wg(et)),wf(et,e.FORBID_CONTENTS)),J&&(P["#text"]=!0),V&&wf(P,["html","head","body"]),P.table&&(wf(P,["tbody"]),delete U.tbody),x6&&x6(e),ef=e)},eb=wf({},["mi","mo","mn","ms","mtext"]),ev=wf({},["foreignobject","desc","title","annotation-xml"]),ey=wf({},["title","style","font","a","script"]),eC=wf({},wb);wf(eC,wv),wf(eC,wy);var ex=wf({},wC);wf(ex,wx);var ew=function(e){var t=x(e);t&&t.tagName||(t={namespaceURI:ed,tagName:"template"});var r=wa(e.tagName),n=wa(t.tagName);return e.namespaceURI===es?t.namespaceURI===ed?"svg"===r:t.namespaceURI===ei?"svg"===r&&("annotation-xml"===n||eb[n]):!!eC[r]:e.namespaceURI===ei?t.namespaceURI===ed?"math"===r:t.namespaceURI===es?"math"===r&&ev[n]:!!ex[r]:e.namespaceURI===ed&&(t.namespaceURI!==es||!!ev[n])&&(t.namespaceURI!==ei||!!eb[n])&&!ex[r]&&(ey[r]||!eC[r])},eE=function(e){wo(o.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=k}catch(t){e.remove()}}},ek=function(e,t){try{wo(o.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){wo(o.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!F[e]){if(G||Y)try{eE(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}}},eS=function(e){if(K)e="<remove></remove>"+e;else{var r,n,o=wl(e,/^[\r\n\t ]+/);n=o&&o[0]}"application/xhtml+xml"===t&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var a=E?E.createHTML(e):e;if(ec===ed)try{r=new p().parseFromString(a,t)}catch(e){}if(!r||!r.documentElement){r=_.createDocument(ec,"template",null);try{r.documentElement.innerHTML=em?"":a}catch(e){}}var i=r.body||r.documentElement;return(e&&n&&i.insertBefore(l.createTextNode(n),i.childNodes[0]||null),ec===ed)?R.call(r,V?"html":"body")[0]:V?r.documentElement:i},e_=function(e){return N.call(e.ownerDocument||e,e,m.SHOW_ELEMENT|m.SHOW_COMMENT|m.SHOW_TEXT,null,!1)},eN=function(e){return"object"===xX(d)?e instanceof d:e&&"object"===xX(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},eD=function(e,t,r){T[e]&&wr(T[e],function(e){e.call(o,t,r,ef)})},eR=function(e){if(eD("beforeSanitizeElements",e,null),e instanceof g&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof f)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore)||wc(/[\u0080-\uFFFF]/,e.nodeName))return eE(e),!0;var t,n=r(e.nodeName);if(eD("uponSanitizeElement",e,{tagName:n,allowedTags:P}),e.hasChildNodes()&&!eN(e.firstElementChild)&&(!eN(e.content)||!eN(e.content.firstElementChild))&&wc(/<[/\w]/g,e.innerHTML)&&wc(/<[/\w]/g,e.textContent)||"select"===n&&wc(/<template/i,e.innerHTML))return eE(e),!0;if(!P[n]||U[n]){if(!U[n]&&eO(n)&&(I.tagNameCheck instanceof RegExp&&wc(I.tagNameCheck,n)||I.tagNameCheck instanceof Function&&I.tagNameCheck(n)))return!1;if(J&&!et[n]){var a=x(e)||e.parentNode,l=C(e)||e.childNodes;if(l&&a)for(var i=l.length,s=i-1;s>=0;--s)a.insertBefore(v(l[s],!0),y(e))}return eE(e),!0}return e instanceof c&&!ew(e)||("noscript"===n||"noembed"===n)&&wc(/<\/no(script|embed)/i,e.innerHTML)?(eE(e),!0):(q&&3===e.nodeType&&(t=wi(t=e.textContent,wN," "),t=wi(t,wD," "),e.textContent!==t&&(wo(o.removed,{element:e.cloneNode()}),e.textContent=t)),eD("afterSanitizeElements",e,null),!1)},eA=function(e,t,r){if(Q&&("id"===t||"name"===t)&&(r in l||r in eg))return!1;if(H&&!z[t]&&wc(wR,t));else if(j&&wc(wA,t));else if(!F[t]||z[t]){if(!(eO(e)&&(I.tagNameCheck instanceof RegExp&&wc(I.tagNameCheck,e)||I.tagNameCheck instanceof Function&&I.tagNameCheck(e))&&(I.attributeNameCheck instanceof RegExp&&wc(I.attributeNameCheck,t)||I.attributeNameCheck instanceof Function&&I.attributeNameCheck(t))||"is"===t&&I.allowCustomizedBuiltInElements&&(I.tagNameCheck instanceof RegExp&&wc(I.tagNameCheck,r)||I.tagNameCheck instanceof Function&&I.tagNameCheck(r))))return!1}else if(ea[t]);else if(wc(B,wi(r,wB,"")));else if(("src"===t||"xlink:href"===t||"href"===t)&&"script"!==e&&0===ws(r,"data:")&&en[e]);else if($&&!wc(wT,wi(r,wB,"")));else if(r)return!1;return!0},eO=function(e){return e.indexOf("-")>0},eT=function(e){eD("beforeSanitizeAttributes",e,null);var t,n,o,a,l=e.attributes;if(l){var i={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:F};for(a=l.length;a--;){var s=(t=l[a]).name,d=t.namespaceURI;n="value"===s?t.value:wd(t.value),o=r(s);var c=n;if(i.attrName=o,i.attrValue=n,i.keepAttr=!0,i.forceKeepAttr=void 0,eD("uponSanitizeAttribute",e,i),n=i.attrValue,!i.forceKeepAttr){if(!i.keepAttr||wc(/\/>/i,n)||(q&&(n=wi(n,wN," "),n=wi(n,wD," ")),!eA(r(e.nodeName),o,n))){ek(s,e);continue}if(n!==c)try{d?e.setAttributeNS(d,s,n):e.setAttribute(s,n)}catch(t){ek(s,e)}}}eD("afterSanitizeAttributes",e,null)}},eB=function e(t){var r,n=e_(t);for(eD("beforeSanitizeShadowDOM",t,null);r=n.nextNode();)eD("uponSanitizeShadowNode",r,null),eR(r)||(r.content instanceof i&&e(r.content),eT(r));eD("afterSanitizeShadowDOM",t,null)};return o.sanitize=function(e,t){if((em=!e)&&(e="<!-->"),"string"!=typeof e&&!eN(e)){if("function"!=typeof e.toString)throw wm("toString is not a function");if("string"!=typeof(e=e.toString()))throw wm("dirty is not a string, aborting")}if(!o.isSupported){if("object"===xX(n.toStaticHTML)||"function"==typeof n.toStaticHTML){if("string"==typeof e)return n.toStaticHTML(e);if(eN(e))return n.toStaticHTML(e.outerHTML)}return e}if(W||eh(t),o.removed=[],"string"==typeof e&&(Z=!1),Z){if(e.nodeName){var l,s,c,m,u,f=r(e.nodeName);if(!P[f]||U[f])throw wm("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof d)1===(s=(l=eS("<!---->")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===s.nodeName?l=s:"HTML"===s.nodeName?l=s:l.appendChild(s);else{if(!G&&!q&&!V&&-1===e.indexOf("<"))return E&&X?E.createHTML(e):e;if(!(l=eS(e)))return G?null:X?k:""}l&&K&&eE(l.firstChild);for(var g=e_(Z?e:l);c=g.nextNode();)3===c.nodeType&&c===m||eR(c)||(c.content instanceof i&&eB(c.content),eT(c),m=c);if(m=null,Z)return e;if(G){if(Y)for(u=D.call(l.ownerDocument);l.firstChild;)u.appendChild(l.firstChild);else u=l;return F.shadowroot&&(u=A.call(a,u,!0)),u}var p=V?l.outerHTML:l.innerHTML;return V&&P["!doctype"]&&l.ownerDocument&&l.ownerDocument.doctype&&l.ownerDocument.doctype.name&&wc(wP,l.ownerDocument.doctype.name)&&(p="<!DOCTYPE "+l.ownerDocument.doctype.name+">\n"+p),q&&(p=wi(p,wN," "),p=wi(p,wD," ")),E&&X?E.createHTML(p):p},o.setConfig=function(e){eh(e),W=!0},o.clearConfig=function(){ef=null,W=!1},o.isValidAttribute=function(e,t,n){return ef||eh({}),eA(r(e),r(t),n)},o.addHook=function(e,t){"function"==typeof t&&(T[e]=T[e]||[],wo(T[e],t))},o.removeHook=function(e){if(T[e])return wn(T[e])},o.removeHooks=function(e){T[e]&&(T[e]=[])},o.removeAllHooks=function(){T={}},o}();let wM=t2.each,wI=t2.trim,wU=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],wz={ftp:21,http:80,https:443,mailto:25},wj=["img","video"],wH=(e,t)=>H(e)?!e:!H(t)||!em(wj,t),w$=e=>{try{return decodeURIComponent(e)}catch(t){return unescape(e)}},wq=(e,t,r)=>{let n=w$(t).replace(/\s/g,"");return!e.allow_script_urls&&(!!/((java|vb)script|mhtml):/i.test(n)||!e.allow_html_data_urls&&(/^data:image\//i.test(n)?wH(e.allow_svg_data_urls,r)&&/^data:image\/svg\+xml/i.test(n):/^data:/i.test(n)))};class wV{static parseDataUri(e){let t;let r=decodeURIComponent(e).split(","),n=/data:([^;]+)/.exec(r[0]);return n&&(t=n[1]),{type:t,data:r[1]}}static isDomSafe(e,t,r={}){return!!r.allow_script_urls||!wq(r,lC.decode(e).replace(/[\s\u0000-\u001F]+/g,""),t)}static getDocumentBaseUrl(e){var t;let r;return r=0!==e.protocol.indexOf("http")&&"file:"!==e.protocol?null!==(t=e.href)&&void 0!==t?t:"":e.protocol+"//"+e.host+e.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(r)&&(r=r.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(r)||(r+="/")),r}constructor(e,t={}){this.path="",this.directory="",e=wI(e),this.settings=t;let r=t.base_uri,n=this;if(/^([\w\-]+):([^\/]{2})/i.test(e)||/^\s*#/.test(e)){n.source=e;return}let o=0===e.indexOf("//");if(0!==e.indexOf("/")||o||(e=(r&&r.protocol||"http")+"://mce_host"+e),!/^[\w\-]*:?\/\//.test(e)){let t=r?r.path:new wV(document.location.href).directory;if((null==r?void 0:r.protocol)==="")e="//mce_host"+n.toAbsPath(t,e);else{let o=/([^#?]*)([#?]?.*)/.exec(e);o&&(e=(r&&r.protocol||"http")+"://mce_host"+n.toAbsPath(t,o[1])+o[2])}}e=e.replace(/@@/g,"(mce_at)");let a=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(e);a&&wM(wU,(e,t)=>{let r=a[t];r&&(r=r.replace(/\(mce_at\)/g,"@@")),n[e]=r}),r&&(n.protocol||(n.protocol=r.protocol),n.userInfo||(n.userInfo=r.userInfo),n.port||"mce_host"!==n.host||(n.port=r.port),n.host&&"mce_host"!==n.host||(n.host=r.host),n.source=""),o&&(n.protocol="")}setPath(e){let t=/^(.*?)\/?(\w+)?$/.exec(e);t&&(this.path=t[0],this.directory=t[1],this.file=t[2]),this.source="",this.getURI()}toRelative(e){if("./"===e)return e;let t=new wV(e,{base_uri:this});if("mce_host"!==t.host&&this.host!==t.host&&t.host||this.port!==t.port||this.protocol!==t.protocol&&""!==t.protocol)return t.getURI();let r=this.getURI(),n=t.getURI();if(r===n||"/"===r.charAt(r.length-1)&&r.substr(0,r.length-1)===n)return r;let o=this.toRelPath(this.path,t.path);return t.query&&(o+="?"+t.query),t.anchor&&(o+="#"+t.anchor),o}toAbsolute(e,t){let r=new wV(e,{base_uri:this});return r.getURI(t&&this.isSameOrigin(r))}isSameOrigin(e){if(this.host==e.host&&this.protocol==e.protocol){if(this.port==e.port)return!0;let t=this.protocol?wz[this.protocol]:null;if(t&&(this.port||t)==(e.port||t))return!0}return!1}toRelPath(e,t){let r=0,n="",o,a,l=e.substring(0,e.lastIndexOf("/")).split("/"),i=t.split("/");if(l.length>=i.length){for(o=0,a=l.length;o<a;o++)if(o>=i.length||l[o]!==i[o]){r=o+1;break}}if(l.length<i.length){for(o=0,a=i.length;o<a;o++)if(o>=l.length||l[o]!==i[o]){r=o+1;break}}if(1===r)return t;for(o=0,a=l.length-(r-1);o<a;o++)n+="../";for(o=r-1,a=i.length;o<a;o++)o!==r-1?n+="/"+i[o]:n+=i[o];return n}toAbsPath(e,t){let r,n=0,o=/\/$/.test(t)?"/":"",a=e.split("/"),l=t.split("/"),i=[];wM(a,e=>{e&&i.push(e)});let s=[];for(let e=l.length-1;e>=0;e--)if(0!==l[e].length&&"."!==l[e]){if(".."===l[e]){n++;continue}if(n>0){n--;continue}s.push(l[e])}let d=i.length-n;return 0!==(r=d<=0?e_(s).join("/"):i.slice(0,d).join("/")+"/"+e_(s).join("/")).indexOf("/")&&(r="/"+r),o&&r.lastIndexOf("/")!==r.length-1&&(r+=o),r}getURI(e=!1){let t;return(!this.source||e)&&(t="",!e&&(this.protocol?t+=this.protocol+"://":t+="//",this.userInfo&&(t+=this.userInfo+"@"),this.host&&(t+=this.host),this.port&&(t+=":"+this.port)),this.path&&(t+=this.path),this.query&&(t+="?"+this.query),this.anchor&&(t+="#"+this.anchor),this.source=t),this.source}}let wW=t2.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),wK="data-mce-type",wG=0,wY=(e,t,r,n)=>{var o,a,l,i;let s=t.validate,d=r.getSpecialElements();8===e.nodeType&&!t.allow_conditional_comments&&/^\[if/i.test(null!==(o=e.nodeValue)&&void 0!==o?o:"")&&(e.nodeValue=" "+e.nodeValue);let c=null!==(a=null==n?void 0:n.tagName)&&void 0!==a?a:e.nodeName.toLowerCase();if(1!==e.nodeType||"body"===c)return;let m=rz.fromDom(e),u=rw(m,wK),f=rC(m,"data-mce-bogus");if(!u&&P(f)){"all"===f?nV(m):nW(m);return}let g=r.getElementRule(c);if(s&&!g){eG(d,c)?nV(m):nW(m);return}if(H(n)&&(n.allowedTags[c]=!0),s&&g&&!u){if(eg(null!==(l=g.attributesForced)&&void 0!==l?l:[],e=>{rv(m,e.name,"{$uid}"===e.value?`mce_${wG++}`:e.value)}),eg(null!==(i=g.attributesDefault)&&void 0!==i?i:[],e=>{rw(m,e.name)||rv(m,e.name,"{$uid}"===e.value?`mce_${wG++}`:e.value)}),g.attributesRequired&&!eu(g.attributesRequired,e=>rw(m,e))||g.removeEmptyAttrs&&rk(m)){nW(m);return}g.outputName&&g.outputName!==c&&i$(m,g.outputName)}},wX=(e,t,r,n,o)=>!(n in wW&&wq(e,o,r))&&(!e.validate||t.isValid(r,n)||tm(n,"data-")||tm(n,"aria-")),wQ=(e,t)=>e.hasAttribute(wK)&&("id"===t||"class"===t||"style"===t),wJ=(e,t)=>e in t.getBoolAttrs(),wZ=(e,t,r)=>{let{attributes:n}=e;for(let o=n.length-1;o>=0;o--){let a=n[o],l=a.name,i=a.value;wX(t,r,e.tagName.toLowerCase(),l,i)||wQ(e,l)?wJ(l,r)&&e.setAttribute(l,l):e.removeAttribute(l)}},w0=(e,t)=>{let r=wF();return r.addHook("uponSanitizeElement",(r,n)=>{wY(r,e,t,n)}),r.addHook("uponSanitizeAttribute",(r,n)=>{let o=r.tagName.toLowerCase(),{attrName:a,attrValue:l}=n;n.keepAttr=wX(e,t,o,a,l),n.keepAttr?(n.allowedAttributes[a]=!0,wJ(a,t)&&(n.attrValue=a),e.allow_svg_data_urls&&tm(l,"data:image/svg+xml")&&(n.forceKeepAttr=!0)):wQ(r,a)&&(n.forceKeepAttr=!0)}),r},w1=(e,t)=>{let r={IN_PLACE:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ALLOWED_TAGS:["#comment","#cdata-section","body"],ALLOWED_ATTR:[]};return r.PARSER_MEDIA_TYPE=t,e.allow_script_urls?r.ALLOWED_URI_REGEXP=/.*/:e.allow_html_data_urls&&(r.ALLOWED_URI_REGEXP=/^(?!(\w+script|mhtml):)/i),r},w2=(e,t)=>{if(!e.sanitize)return(r,n)=>{let o;let a=document.createNodeIterator(r,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT);for(;o=a.nextNode();)wY(o,e,t),ou(o)&&wZ(o,e,t)};{let r=w0(e,t);return(t,n)=>{r.sanitize(t,w1(e,n)),r.removed=[]}}},w3=t2.makeMap,w8=t2.extend,w5=(e,t,r)=>{let n=e.name,o=n in r&&"title"!==n&&"textarea"!==n,a=t.childNodes;for(let t=0,n=a.length;t<n;t++){let n=a[t],l=new p4(n.nodeName.toLowerCase(),n.nodeType);if(ou(n)){let e=n.attributes;for(let t=0,r=e.length;t<r;t++){let r=e[t];l.attr(r.name,r.value)}}else ow(n)?(l.value=n.data,o&&(l.raw=!0)):(oS(n)||oE(n)||ok(n))&&(l.value=n.data);w5(l,n,r),e.append(l)}},w6=(e,t,r)=>{let n=[];for(let r=e,o=r;r;o=r,r=r.walk()){let a=r;eg(t,e=>e(a)),j(a.parent)&&a!==e?r=o:n.push(a)}for(let e=n.length-1;e>=0;e--){let t=n[e];eg(r,e=>e(t))}},w9=(e,t,r,n)=>{let o=r.validate,a=t.getNonEmptyElements(),l=t.getWhitespaceElements(),i=w8(w3("script,style,head,html,body,title,meta,param"),t.getBlockElements()),s=lM(t),d=/[ \t\r\n]+/g,c=/^[ \t\r\n]+/,m=/[ \t\r\n]+$/,u=e=>{let t=e.parent;for(;H(t);){if(t.name in l)return!0;t=t.parent}return!1},f=e=>{let r=e;for(;H(r);){if(r.name in s)return v7(t,a,l,r);r=r.parent}return!1},g=e=>e.name in i||a0(t,e),p=(t,r)=>!(H(r?t.prev:t.next)||j(t.parent))&&g(t.parent)&&(t.parent!==e||!0===n.isRootContent);return[e=>{var t;if(3===e.type&&!u(e)){let r=null!==(t=e.value)&&void 0!==t?t:"";r=r.replace(d," "),(ye(e.prev,g)||p(e,!0))&&(r=r.replace(c,"")),0===r.length?e.remove():e.value=r}},e=>{var i;if(1===e.type){let i=t.getElementRule(e.name);if(o&&i){let o=v7(t,a,l,e);i.paddInEmptyBlock&&o&&f(e)?v5(r,n,g,e):i.removeEmpty&&o?g(e)?e.remove():e.unwrap():i.paddEmpty&&(o||v6(e))&&v5(r,n,g,e)}}else if(3===e.type&&!u(e)){let t=null!==(i=e.value)&&void 0!==i?i:"";(e.next&&g(e.next)||p(e,!1))&&(t=t.replace(m,"")),0===t.length?e.remove():e.value=t}}]},w4=(e,t)=>{var r;let n=null!==(r=t.forced_root_block)&&void 0!==r?r:e.forced_root_block;return!1===n?"":!0===n?"p":n},w7=(e={},t=lU())=>{let r=x_(),n=x_(),o={validate:!0,root_name:"body",sanitize:!0,...e},a=new DOMParser,l=w2(o,t),i=(e,r,n="html")=>{let o="xhtml"===n?"application/xhtml+xml":"text/html",i=eG(t.getSpecialElements(),r.toLowerCase()),s=i?`<${r}>${e}</${r}>`:e,d="xhtml"===n?`<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>${s}</body></html>`:`<body>${s}</body>`,c=a.parseFromString(d,o).body;return l(c,o),i?c.firstChild:c},s=r.addFilter,d=r.getFilters,c=r.removeFilter,m=n.addFilter,u=n.getFilters,f=n.removeFilter,g=(e,r)=>{ya(t,e)&&r.push(e)},p=(e,r)=>{let n=P(r.attr(wK)),o=1===r.type&&!eG(e,r.name)&&!a0(t,r);return 3===r.type||o&&!n},h=(e,r)=>{let n=w8(w3("script,style,head,html,body,title,meta,param"),t.getBlockElements()),a=/^[ \t\r\n]+/,l=/[ \t\r\n]+$/,i=e.firstChild,s=null,d=e=>{var t,r;e&&((i=e.firstChild)&&3===i.type&&(i.value=null===(t=i.value)||void 0===t?void 0:t.replace(a,"")),(i=e.lastChild)&&3===i.type&&(i.value=null===(r=i.value)||void 0===r?void 0:r.replace(l,"")))};if(t.isValidChild(e.name,r.toLowerCase())){for(;i;){let t=i.next;p(n,i)?(s||((s=new p4(r,1)).attr(o.forced_root_block_attrs),e.insert(s,i)),s.append(i)):(d(s),s=null),i=t}d(s)}},b={schema:t,addAttributeFilter:m,getAttributeFilters:u,removeAttributeFilter:f,addNodeFilter:s,getNodeFilters:d,removeNodeFilter:c,parse:(e,r={})=>{var n;let a=o.validate,l=null!==(n=r.context)&&void 0!==n?n:o.root_name,s=i(e,l,r.format);aW(t,s);let c=new p4(l,11);w5(c,s,t.getSpecialElements()),s.innerHTML="";let[m,f]=w9(c,t,o,r),p=[],b={nodes:{},attributes:{}},v=e=>v1(d(),u(),e,b);if(w6(c,[m,v],[f,a?e=>g(e,p):W]),p.reverse(),a&&p.length>0){if(r.context){let{pass:e,fail:n}=eh(p,e=>e.parent===c);yn(n,t,c,v),r.invalid=e.length>0}else yn(p,t,c,v)}let y=w4(o,r);return y&&("body"===c.name||r.isRootContent)&&h(c,y),r.invalid||v3(b,r),c}};return xY(b,o),xO(b,o,t),b},Ee=e=>yq(e)?hh({validate:!1}).serialize(e):e,Et=(e,t,r)=>{let n=Ee(e),o=t(n);if(o.isDefaultPrevented()||!yq(e))return o;if(o.content===n)return{...o,content:e};{let t=w7({validate:!1,forced_root_block:!1,sanitize:r}).parse(o.content,{context:e.name});return{...o,content:t}}},Er=(e,t)=>{if(t.no_events)return sV.value(t);{let r=fO(e,t);return r.isDefaultPrevented()?sV.error(fT(e,{content:"",...r}).content):sV.value(r)}},En=(e,t,r)=>r.no_events?t:Et(t,t=>fT(e,{...r,content:t}),cR(e)).content,Eo=(e,t)=>{if(t.no_events)return sV.value(t);{let r=Et(t.content,r=>fR(e,{...t,content:r}),cR(e));return r.isDefaultPrevented()?(fA(e,r),sV.error(void 0)):sV.value(r)}},Ea=(e,t,r)=>{r.no_events||fA(e,{...r,content:t})},El=(e,t,r)=>({element:e,width:t,rows:r}),Ei=(e,t)=>({element:e,cells:t}),Es=(e,t)=>({x:e,y:t}),Ed=(e,t)=>rx(e,t).bind(tC).getOr(1),Ec=(e,t,r,n,o)=>{let a=Ed(o,"rowspan"),l=Ed(o,"colspan"),i=e.rows;for(let e=r;e<r+a;e++){i[e]||(i[e]=Ei(ij(n),[]));for(let n=t;n<t+l;n++)i[e].cells[n]=e===r&&n===t?o:iz(o)}},Em=(e,t,r)=>{let n=e.rows;return!!(n[r]?n[r].cells:[])[t]},Eu=(e,t,r)=>{for(;Em(e,t,r);)t++;return t},Ef=e=>ey(e,(e,t)=>t.cells.length>e?t.cells.length:e,0),Eg=(e,t)=>{let r=e.rows;for(let e=0;e<r.length;e++){let n=r[e].cells;for(let r=0;r<n.length;r++)if(rW(n[r],t))return ea.some(Es(r,e))}return ea.none()},Ep=(e,t,r,n,o)=>{let a=[],l=e.rows;for(let e=r;e<=o;e++){let r=l[e].cells,o=t<n?r.slice(t,n+1):r.slice(n,t+1);a.push(Ei(l[e].element,o))}return a},Eh=(e,t,r)=>{let n=t.x,o=t.y,a=r.x,l=r.y,i=o<l?Ep(e,n,o,a,l):Ep(e,n,l,a,o);return El(e.element,Ef(i),i)},Eb=(e,t)=>{let r=iz(e.element),n=rz.fromTag("tbody");return n$(n,t),nz(r,n),r},Ev=e=>ef(e.rows,e=>{let t=ef(e.cells,e=>{let t=ij(e);return rE(t,"colspan"),rE(t,"rowspan"),t}),r=iz(e.element);return n$(r,t),r}),Ey=e=>{let t=El(iz(e),0,[]);return eg(oi(e,"tr"),(e,r)=>{eg(oi(e,"td,th"),(n,o)=>{Ec(t,Eu(t,o,r),r,e,n)})}),El(t.element,Ef(t.rows),t.rows)},EC=e=>Eb(e,Ev(e)),Ex=(e,t,r)=>Eg(e,t).bind(t=>Eg(e,r).map(r=>Eh(e,t,r))),Ew=e=>ex(e,e=>"ul"===ri(e)||"ol"===ri(e)),EE=(e,t)=>ex(e,e=>"li"===ri(e)&&uC(e,t)).fold(Y([]),t=>Ew(e).map(e=>{let t=rz.fromTag(ri(e));return nA(t,eq(nP(e),(e,t)=>tm(t,"list-style"))),[rz.fromTag("li"),t]}).getOr([])),Ek=(e,t)=>{let r=ey(t,(e,t)=>(nz(t,e),t),e);return t.length>0?gl([r]):r},ES=e=>oQ(e)?rJ(e).filter(oX).fold(Y([]),t=>[e,t]):oX(e)?[e]:[],E_=(e,t)=>{let r=rz.fromDom(t.commonAncestorContainer),n=hH(r,e),o=eb(n,o2),a=EE(n,t);return ef(o.concat(a.length?a:ES(r)),iz)},EN=()=>gl([]),ED=(e,t)=>Ek(rz.fromDom(t.cloneContents()),E_(e,t)),ER=(e,t)=>nC(t,"table",J(rW,e)),EA=(e,t)=>ER(e,t[0]).bind(e=>{let r=t[0],n=t[t.length-1];return Ex(Ey(e),r,n).map(e=>gl([EC(e)]))}).getOrThunk(EN),EO=(e,t)=>t.length>0&&t[0].collapsed?EN():ED(e,t[0]),ET=(e,t)=>{let r=uf(t,e);return r.length>0?EA(e,r):EO(e,t)},EB=(e,t)=>t>=0&&t<e.length&&m6(e.charAt(t)),EP=e=>o4(e.innerText),EL=e=>e.map(e=>e.nodeName).getOr("div").toLowerCase(),EF=e=>ea.from(e.selection.getRng()).map(t=>{var r;let n=ea.from(e.dom.getParent(t.commonAncestorContainer,e.dom.isBlock)),o=e.getBody(),a=EL(n),l=rz.fromDom(t.cloneContents());hs(l),hd(l);let i=e.dom.add(o,a,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},l.dom),s=EP(i),d=o4(null!==(r=i.textContent)&&void 0!==r?r:"");if(e.dom.remove(i),!(EB(d,0)||EB(d,d.length-1)))return s;{let e=EP(n.getOr(o)),t=e.indexOf(s);if(-1===t)return s;{let r=EB(e,t-1),n=EB(e,t+s.length);return(r?" ":"")+s+(n?" ":"")}}}).getOr(""),EM=(e,t)=>{let r=e.selection.getRng(),n=e.dom.create("body"),o=e.selection.getSel(),a=pq(e,us(o)),l=t.contextual?ET(rz.fromDom(e.getBody()),a).dom:r.cloneContents();return l&&n.appendChild(l),e.selection.serializer.serialize(n,t)},EI=(e,t)=>{if("text"===t.format)return EF(e);{let r=EM(e,t);return"tree"===t.format?r:e.selection.isCollapsed()?"":r}},EU=(e,t)=>({...e,format:t,get:!0,selection:!0,getInner:!0}),Ez=(e,t,r={})=>Er(e,EU(r,t)).fold(X,t=>{let r=EI(e,t);return En(e,r,t)}),Ej=(e,t)=>{let r=e.length+t.length+2,n=Array(r),o=Array(r),a=(e,t,r)=>({start:e,end:t,diag:r}),l=(r,n,o,a,i)=>{let d=s(r,n,o,a);if(null===d||d.start===n&&d.diag===n-a||d.end===r&&d.diag===r-o){let l=r,s=o;for(;l<n||s<a;)l<n&&s<a&&e[l]===t[s]?(i.push([0,e[l]]),++l,++s):n-r>a-o?(i.push([2,e[l]]),++l):(i.push([1,t[s]]),++s)}else{l(r,d.start,o,d.start-d.diag,i);for(let t=d.start;t<d.end;++t)i.push([0,e[t]]);l(d.end,n,d.end-d.diag,a,i)}},i=(r,n,o,l)=>{let i=r;for(;i-n<l&&i<o&&e[i]===t[i-n];)++i;return a(r,i,n)},s=(r,a,l,s)=>{let d,c,m,u,f;let g=a-r,p=s-l;if(0===g||0===p)return null;let h=g-p,b=p+g,v=(b%2==0?b:b+1)/2;for(d=0,n[1+v]=r,o[1+v]=a+1;d<=v;++d){for(c=-d;c<=d;c+=2){for(m=c+v,c===-d||c!==d&&n[m-1]<n[m+1]?n[m]=n[m+1]:n[m]=n[m-1]+1,f=(u=n[m])-r+l-c;u<a&&f<s&&e[u]===t[f];)n[m]=++u,++f;if(h%2!=0&&h-d<=c&&c<=h+d&&o[m-h]<=n[m])return i(o[m-h],c+r-l,a,s)}for(c=h-d;c<=h+d;c+=2){for(m=c+v-h,c===h-d||c!==h+d&&o[m+1]<=o[m-1]?o[m]=o[m+1]-1:o[m]=o[m-1],f=(u=o[m]-1)-r+l-c;u>=r&&f>=l&&e[u]===t[f];)o[m]=u--,f--;if(h%2==0&&-d<=c&&c<=d&&o[m]<=n[m+h])return i(o[m],c+r-l,a,s)}}return null},d=[];return l(0,e.length,0,t.length,d),d},EH=e=>ou(e)?e.outerHTML:ow(e)?lC.encodeRaw(e.data,!1):oS(e)?"<!--"+e.data+"-->":"",E$=e=>{let t;let r=document.createElement("div"),n=document.createDocumentFragment();for(e&&(r.innerHTML=e);t=r.firstChild;)n.appendChild(t);return n},Eq=(e,t,r)=>{let n=E$(t);if(e.hasChildNodes()&&r<e.childNodes.length){let t=e.childNodes[r];e.insertBefore(n,t)}else e.appendChild(n)},EV=(e,t)=>{if(e.hasChildNodes()&&t<e.childNodes.length){let r=e.childNodes[t];e.removeChild(r)}},EW=(e,t)=>{let r=0;eg(e,e=>{0===e[0]?r++:1===e[0]?(Eq(t,e[1],r),r++):2===e[0]&&EV(t,r)})},EK=(e,t)=>eb(ef(eB(e.childNodes),t?K(o4,EH):EH),e=>e.length>0),EG=(e,t)=>(EW(Ej(ef(eB(t.childNodes),EH),e),t),t),EY=e6(()=>document.implementation.createHTMLDocument("undo")),EX=e=>null!==e.querySelector("iframe"),EQ=e=>({type:"fragmented",fragments:e,content:"",bookmark:null,beforeBookmark:null}),EJ=e=>({type:"complete",fragments:null,content:e,bookmark:null,beforeBookmark:null}),EZ=e=>{let t=e.serializer.getTempAttrs(),r=hi(e.getBody(),t);return EX(r)?EQ(EK(r,!0)):EJ(o4(r.innerHTML))},E0=(e,t,r)=>{let n=r?t.beforeBookmark:t.bookmark;"fragmented"===t.type?EG(t.fragments,e.getBody()):e.setContent(t.content,{format:"raw",no_selection:!(H(n)&&mj(n))||!n.isFakeCaret}),n&&(e.selection.moveToBookmark(n),e.selection.scrollIntoView())},E1=e=>"fragmented"===e.type?e.fragments.join(""):e.content,E2=e=>{let t=rz.fromTag("body",EY());return nX(t,E1(e)),eg(oi(t,"*[data-mce-bogus]"),nW),nY(t)},E3=(e,t)=>E1(e)===E1(t),E8=(e,t)=>E2(e)===E2(t),E5=(e,t)=>!!e&&!!t&&(!!E3(e,t)||E8(e,t)),E6=e=>0===e.get(),E9=(e,t,r)=>{E6(r)&&(e.typing=t)},E4=(e,t)=>{e.typing&&(E9(e,!1,t),e.add())},E7=e=>{e.typing&&(e.typing=!1,e.add())},ke=(e,t,r)=>{E6(t)&&r.set(sq(e.selection))},kt=(e,t,r,n,o,a,l)=>{let i=EZ(e),s=t2.extend(a||{},i);if(!E6(n)||e.removed)return null;let d=t.data[r.get()];if(e.dispatch("BeforeAddUndo",{level:s,lastLevel:d,originalEvent:l}).isDefaultPrevented()||d&&E5(d,s))return null;t.data[r.get()]&&o.get().each(e=>{t.data[r.get()].beforeBookmark=e});let c=d2(e);if(c&&t.data.length>c){for(let e=0;e<t.data.length-1;e++)t.data[e]=t.data[e+1];t.data.length--,r.set(t.data.length)}s.bookmark=sq(e.selection),r.get()<t.data.length-1&&(t.data.length=r.get()+1),t.data.push(s),r.set(t.data.length-1);let m={level:s,lastLevel:d,originalEvent:l};return r.get()>0?(e.setDirty(!0),e.dispatch("AddUndo",m),e.dispatch("change",m)):e.dispatch("AddUndo",m),s},kr=(e,t,r)=>{t.data=[],r.set(0),t.typing=!1,e.dispatch("ClearUndos")},kn=(e,t,r,n,o)=>{if(t.transact(n)){let n=t.data[r.get()].bookmark;E0(e,t.data[r.get()-1],!0),t.transact(o)&&(t.data[r.get()-1].beforeBookmark=n)}},ko=(e,t,r)=>{let n;return t.get()<r.length-1&&(t.set(t.get()+1),E0(e,n=r[t.get()],!1),e.setDirty(!0),e.dispatch("Redo",{level:n})),n},ka=(e,t,r,n)=>{let o;return t.typing&&(t.add(),t.typing=!1,E9(t,!1,r)),n.get()>0&&(n.set(n.get()-1),E0(e,o=t.data[n.get()],!0),e.setDirty(!0),e.dispatch("Undo",{level:o})),o},kl=e=>{e.clear(),e.add()},ki=(e,t,r)=>r.get()>0||t.typing&&t.data[0]&&!E5(EZ(e),t.data[0]),ks=(e,t)=>t.get()<e.data.length-1&&!e.typing,kd=(e,t,r)=>(E4(e,t),e.beforeChange(),e.ignore(r),e.add()),kc=(e,t)=>{try{e.set(e.get()+1),t()}finally{e.set(e.get()-1)}},km=(e,t)=>{let r=e.dom,n=H(t)?t:e.getBody();eg(r.select("table,a",n),t=>{switch(t.nodeName){case"TABLE":let n=ct(e),o=r.getAttrib(t,"border");(!o||"0"===o)&&e.hasVisual?r.addClass(t,n):r.removeClass(t,n);break;case"A":if(!r.getAttrib(t,"href")){let n=r.getAttrib(t,"name")||t.id,o=cr(e);n&&e.hasVisual?r.addClass(t,o):r.removeClass(t,o)}}}),e.dispatch("VisualAid",{element:t,hasVisual:e.hasVisual})},ku=e=>({init:{bindEvents:W},undoManager:{beforeChange:(t,r)=>ke(e,t,r),add:(t,r,n,o,a,l)=>kt(e,t,r,n,o,a,l),undo:(t,r,n)=>ka(e,t,r,n),redo:(t,r)=>ko(e,t,r),clear:(t,r)=>kr(e,t,r),reset:e=>kl(e),hasUndo:(t,r)=>ki(e,t,r),hasRedo:(e,t)=>ks(e,t),transact:(e,t,r)=>kd(e,t,r),ignore:(e,t)=>kc(e,t),extra:(t,r,n,o)=>kn(e,t,r,n,o)},formatter:{match:(t,r,n,o)=>y6(e,t,r,n,o),matchAll:(t,r)=>y9(e,t,r),matchNode:(t,r,n,o)=>y5(e,t,r,n,o),canApply:t=>y7(e,t),closest:t=>y4(e,t),apply:(t,r,n)=>xg(e,t,r,n),remove:(t,r,n,o)=>xr(e,t,r,n,o),toggle:(t,r,n)=>xk(e,t,r,n),formatChanged:(t,r,n,o,a)=>xE(e,t,r,n,o,a)},editor:{getContent:t=>hf(e,t),setContent:(t,r)=>yY(e,t,r),insertContent:(t,r)=>y$(e,t,r),addVisual:t=>km(e,t)},selection:{getContent:(t,r)=>Ez(e,t,r)},autocompleter:{addDecoration:t=>p0(e,t),removeDecoration:()=>p3(e,rz.fromDom(e.getBody()))},raw:{getModel:()=>ea.none()}}),kf=e=>{let t=e=>L(e)?e:{},{init:r,undoManager:n,formatter:o,editor:a,selection:l,autocompleter:i,raw:s}=e;return{init:{bindEvents:r.bindEvents},undoManager:{beforeChange:n.beforeChange,add:n.add,undo:n.undo,redo:n.redo,clear:n.clear,reset:n.reset,hasUndo:n.hasUndo,hasRedo:n.hasRedo,transact:(e,t,r)=>n.transact(r),ignore:(e,t)=>n.ignore(t),extra:(e,t,r,o)=>n.extra(r,o)},formatter:{match:(e,r,n,a)=>o.match(e,t(r),a),matchAll:o.matchAll,matchNode:o.matchNode,canApply:e=>o.canApply(e),closest:e=>o.closest(e),apply:(e,r,n)=>o.apply(e,t(r)),remove:(e,r,n,a)=>o.remove(e,t(r)),toggle:(e,r,n)=>o.toggle(e,t(r)),formatChanged:(e,t,r,n,a)=>o.formatChanged(t,r,n,a)},editor:{getContent:e=>a.getContent(e),setContent:(e,t)=>({content:a.setContent(e,t),html:""}),insertContent:(e,t)=>(a.insertContent(e),""),addVisual:a.addVisual},selection:{getContent:(e,t)=>l.getContent(t)},autocompleter:{addDecoration:i.addDecoration,removeDecoration:i.removeDecoration},raw:{getModel:()=>ea.some(s.getRawModel())}}},kg=()=>{let e=Y(null),t=Y("");return{init:{bindEvents:W},undoManager:{beforeChange:W,add:e,undo:e,redo:e,clear:W,reset:W,hasUndo:en,hasRedo:en,transact:e,ignore:W,extra:W},formatter:{match:en,matchAll:Y([]),matchNode:Y(void 0),canApply:en,closest:t,apply:W,remove:W,toggle:W,formatChanged:Y({unbind:W})},editor:{getContent:t,setContent:Y({content:"",html:""}),insertContent:Y(""),addVisual:W},selection:{getContent:t},autocompleter:{addDecoration:W,removeDecoration:W},raw:{getModel:Y(ea.none())}}},kp=e=>eG(e.plugins,"rtc"),kh=e=>eK(e.plugins,"rtc").bind(e=>ea.from(e.setup)),kb=e=>kh(e).fold(()=>(e.rtcInstance=ku(e),ea.none()),t=>(e.rtcInstance=kg(),ea.some(()=>t().then(t=>(e.rtcInstance=kf(t),t.rtc.isRemote))))),kv=e=>e.rtcInstance?e.rtcInstance:ku(e),ky=e=>{let t=e.rtcInstance;if(t)return t;throw Error("Failed to get RTC instance not yet initialized.")},kC=(e,t,r)=>{ky(e).undoManager.beforeChange(t,r)},kx=(e,t,r,n,o,a,l)=>ky(e).undoManager.add(t,r,n,o,a,l),kw=(e,t,r,n)=>ky(e).undoManager.undo(t,r,n),kE=(e,t,r)=>ky(e).undoManager.redo(t,r),kk=(e,t,r)=>{ky(e).undoManager.clear(t,r)},kS=(e,t)=>{ky(e).undoManager.reset(t)},k_=(e,t,r)=>ky(e).undoManager.hasUndo(t,r),kN=(e,t,r)=>ky(e).undoManager.hasRedo(t,r),kD=(e,t,r,n)=>ky(e).undoManager.transact(t,r,n),kR=(e,t,r)=>{ky(e).undoManager.ignore(t,r)},kA=(e,t,r,n,o)=>{ky(e).undoManager.extra(t,r,n,o)},kO=(e,t,r,n,o)=>ky(e).formatter.match(t,r,n,o),kT=(e,t,r)=>ky(e).formatter.matchAll(t,r),kB=(e,t,r,n,o)=>ky(e).formatter.matchNode(t,r,n,o),kP=(e,t)=>ky(e).formatter.canApply(t),kL=(e,t)=>ky(e).formatter.closest(t),kF=(e,t,r,n)=>{ky(e).formatter.apply(t,r,n)},kM=(e,t,r,n,o)=>{ky(e).formatter.remove(t,r,n,o)},kI=(e,t,r,n)=>{ky(e).formatter.toggle(t,r,n)},kU=(e,t,r,n,o,a)=>ky(e).formatter.formatChanged(t,r,n,o,a),kz=(e,t)=>kv(e).editor.getContent(t),kj=(e,t,r)=>kv(e).editor.setContent(t,r),kH=(e,t,r)=>kv(e).editor.insertContent(t,r),k$=(e,t,r)=>ky(e).selection.getContent(t,r),kq=(e,t)=>ky(e).editor.addVisual(t),kV=e=>ky(e).init.bindEvents(),kW=(e,t)=>ky(e).autocompleter.addDecoration(t),kK=e=>ky(e).autocompleter.removeDecoration(),kG=(e,t={})=>k$(e,t.format?t.format:"html",t),kY=e=>0===e.dom.length?(nV(e),ea.none()):ea.some(e),kX=(e,t)=>e.filter(e=>ff.isBookmarkNode(e.dom)).bind(t?r3:r2),kQ=(e,t,r,n)=>{let o=e.dom,a=t.dom,l=n?o.length:a.length;n?(bE(o,a,!1,!n),r.setStart(a,l)):(bE(a,o,!1,!n),r.setEnd(a,l))},kJ=(e,t)=>{rJ(e).each(r=>{let n=e.dom;t&&bi(r,sf(n,0))?bx(n,0):!t&&bd(r,sf(n,n.length))&&bw(n,n.length)})},kZ=(e,t,r,n)=>{e.bind(e=>((n?bw:bx)(e.dom,n?e.dom.length:0),t.filter(rf).map(t=>kQ(e,t,r,n)))).orThunk(()=>kX(t,n).or(t).filter(rf).map(e=>kJ(e,n)))},k0=(e,t)=>{let r=ea.from(t.firstChild).map(rz.fromDom),n=ea.from(t.lastChild).map(rz.fromDom);e.deleteContents(),e.insertNode(t);let o=r.bind(r2).filter(rf).bind(kY),a=n.bind(r3).filter(rf).bind(kY);kZ(o,r,e,!0),kZ(a,n,e,!1),e.collapse(!1)},k1=(e,t)=>({format:"html",...e,set:!0,selection:!0,content:t}),k2=(e,t)=>{if("raw"===t.format)return t.content;{let r=e.selection.getRng(),n=e.dom.getParent(r.commonAncestorContainer,e.dom.isBlock),o=n?{context:n.nodeName.toLowerCase()}:{},a=e.parser.parse(t.content,{forced_root_block:!1,...o,...t});return hh({validate:!1},e.schema).serialize(a)}},k3=(e,t,r={})=>{Eo(e,k1(r,t)).each(t=>{let r=k2(e,t),n=e.selection.getRng();k0(n,n.createContextualFragment(r)),e.selection.setRng(n),gJ(e,n),Ea(e,r,t)})},k8=(e,t,r)=>{if(eG(e,t)){let n=eb(e[t],e=>e!==r);0===n.length?delete e[t]:e[t]=n}};var k5=(e,t)=>{let r,n;let o=(t,r)=>ex(r,r=>e.is(r,t)),a=t=>e.getParents(t,void 0,e.getRoot()),l=()=>{r={},n={},t.on("NodeChange",e=>{let t=e.element,l=a(t),i={};eI(r,(e,t)=>{o(t,l).each(r=>{n[t]||(eg(e,e=>{e(!0,{node:r,selector:t,parents:l})}),n[t]=e),i[t]=e})}),eI(n,(e,r)=>{i[r]||(delete n[r],eg(e,e=>{e(!1,{node:t,selector:r,parents:l})}))})})};return{selectorChangedWithUnbind:(e,i)=>(r||l(),r[e]||(r[e]=[]),r[e].push(i),o(e,a(t.selection.getStart())).each(()=>{n[e]=r[e]}),{unbind:()=>{k8(r,e,i),k8(n,e,i)}})}};let k6=e=>!!(e&&e.ownerDocument)&&rK(rz.fromDom(e.ownerDocument),rz.fromDom(e)),k9=e=>!!e&&k6(e.startContainer)&&k6(e.endContainer),k4=(e,t,r,n)=>{let o,a;let{selectorChangedWithUnbind:l}=k5(e,n),i=(e,t)=>k3(n,e,t),s=e=>{let t=c();t.collapse(!!e),m(t)},d=()=>t.getSelection?t.getSelection():t.document.selection,c=()=>{let r;let l=(e,t,r)=>{try{return t.compareBoundaryPoints(e,r)}catch(e){return -1}},i=t.document;if(H(n.bookmark)&&!pT(n)){let e=po(n);if(e.isSome())return e.map(e=>pq(n,[e])[0]).getOr(i.createRange())}try{let e=d();e&&!om(e.anchorNode)&&(r=e.rangeCount>0?e.getRangeAt(0):i.createRange(),r=pq(n,[r])[0])}catch(e){}if(r||(r=i.createRange()),o_(r.startContainer)&&r.collapsed){let t=e.getRoot();r.setStart(t,0),r.setEnd(t,0)}return o&&a&&(0===l(r.START_TO_START,r,o)&&0===l(r.END_TO_END,r,o)?r=a:(o=null,a=null)),r},m=(e,t)=>{if(!k9(e))return;let r=d();if(e=n.dispatch("SetSelectionRange",{range:e,forward:t}).range,r){a=e;try{r.removeAllRanges(),r.addRange(e)}catch(e){}!1===t&&r.extend&&(r.collapse(e.endContainer,e.endOffset),r.extend(e.startContainer,e.startOffset)),o=r.rangeCount>0?r.getRangeAt(0):null}if(!e.collapsed&&e.startContainer===e.endContainer&&(null==r?void 0:r.setBaseAndExtent)&&e.endOffset-e.startOffset<2&&e.startContainer.hasChildNodes()){let t=e.startContainer.childNodes[e.startOffset];t&&"IMG"===t.nodeName&&(r.setBaseAndExtent(e.startContainer,e.startOffset,e.endContainer,e.endOffset),(r.anchorNode!==e.startContainer||r.focusNode!==e.endContainer)&&r.setBaseAndExtent(t,0,t,1))}n.dispatch("AfterSetSelectionRange",{range:e,forward:t})},u=()=>{let t=d(),r=null==t?void 0:t.anchorNode,n=null==t?void 0:t.focusNode;if(!t||!r||!n||om(r)||om(n))return!0;let o=e.createRng(),a=e.createRng();try{o.setStart(r,t.anchorOffset),o.collapse(!0),a.setStart(n,t.focusOffset),a.collapse(!0)}catch(e){return!0}return 0>=o.compareBoundaryPoints(o.START_TO_START,a)},f={dom:e,win:t,serializer:r,editor:n,expand:(t={type:"word"})=>m(gE(e).expand(c(),t)),collapse:s,setCursorLocation:(t,r)=>{let o=e.createRng();H(t)&&H(r)?(o.setStart(t,r),o.setEnd(t,r),m(o),s(!1)):(ux(e,o,n.getBody(),!0),m(o))},getContent:e=>kG(n,e),setContent:i,getBookmark:(e,t)=>g.getBookmark(e,t),moveToBookmark:e=>g.moveToBookmark(e),select:(t,r)=>(p$(e,t,r).each(m),t),isCollapsed:()=>{let e=c(),t=d();return!!e&&!e.item&&(e.compareEndPoints?0===e.compareEndPoints("StartToEnd",e):!t||e.collapsed)},isEditable:()=>{let t=c(),r=n.getBody().querySelectorAll('[data-mce-selected="1"]');return r.length>0?eS(r,t=>e.isEditable(t.parentElement)):t.startContainer===t.endContainer?e.isEditable(t.startContainer):e.isEditable(t.startContainer)&&e.isEditable(t.endContainer)},isForward:u,setNode:t=>(i(e.getOuterHTML(t)),t),getNode:()=>pj(n.getBody(),c()),getSel:d,setRng:m,getRng:c,getStart:e=>pI(n.getBody(),c(),e),getEnd:e=>pU(n.getBody(),c(),e),getSelectedBlocks:(t,r)=>pH(e,c(),t,r),normalize:()=>{let t=c();if(!uc(d())&&uw(n)){let r=gC(e,t);return r.each(e=>{m(e,u())}),r.getOr(t)}return t},selectorChanged:(e,t)=>(l(e,t),f),selectorChangedWithUnbind:l,getScrollContainer:()=>{let t;let r=e.getRoot();for(;r&&"BODY"!==r.nodeName;){if(r.scrollHeight>r.clientHeight){t=r;break}r=r.parentNode}return t},scrollIntoView:(e,t)=>{H(e)?gQ(n,e,t):gJ(n,c(),t)},placeCaretAt:(e,t)=>m(gd(e,t,n.getDoc())),getBoundingClientRect:()=>{let e=c();return e.collapsed?sf.fromRangeStart(e).getClientRects()[0]:e.getBoundingClientRect()},destroy:()=>{t=o=a=null,p.destroy()}},g=ff(f),p=fW(f,n);return f.bookmarkManager=g,f.controlSelection=p,f},k7=(e,t,r)=>{e.addAttributeFilter("data-mce-tabindex",(e,t)=>{let r=e.length;for(;r--;){let n=e[r];n.attr("tabindex",n.attr("data-mce-tabindex")),n.attr(t,null)}}),e.addAttributeFilter("src,href,style",(e,n)=>{let o="data-mce-"+n,a=t.url_converter,l=t.url_converter_scope,i=e.length;for(;i--;){let t=e[i],s=t.attr(o);void 0!==s?(t.attr(n,s.length>0?s:null),t.attr(o,null)):(s=t.attr(n),"style"===n?s=r.serializeStyle(r.parseStyle(s),t.name):a&&(s=a.call(l,s,n,t.name)),t.attr(n,s.length>0?s:null))}}),e.addAttributeFilter("class",e=>{let t=e.length;for(;t--;){let r=e[t],n=r.attr("class");n&&(n=n.replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),r.attr("class",n.length>0?n:null))}}),e.addAttributeFilter("data-mce-type",(e,t,r)=>{let n=e.length;for(;n--;){let t=e[n];"bookmark"!==t.attr("data-mce-type")||r.cleanup||(ea.from(t.firstChild).exists(e=>{var t;return!oI(null!==(t=e.value)&&void 0!==t?t:"")})?t.unwrap():t.remove())}}),e.addNodeFilter("noscript",e=>{var t;let r=e.length;for(;r--;){let n=e[r].firstChild;n&&(n.value=lC.decode(null!==(t=n.value)&&void 0!==t?t:""))}}),e.addNodeFilter("script,style",(e,r)=>{var n;let o=e=>e.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,""),a=e.length;for(;a--;){let l=e[a],i=l.firstChild,s=null!==(n=null==i?void 0:i.value)&&void 0!==n?n:"";if("script"===r){let e=l.attr("type");e&&l.attr("type","mce-no/type"===e?null:e.replace(/^mce\-/,"")),"xhtml"===t.element_format&&i&&s.length>0&&(i.value="// <![CDATA[\n"+o(s)+"\n// ]]>")}else"xhtml"===t.element_format&&i&&s.length>0&&(i.value="<!--\n"+o(s)+"\n-->")}}),e.addNodeFilter("#comment",e=>{let n=e.length;for(;n--;){let o=e[n],a=o.value;t.preserve_cdata&&(null==a?void 0:a.indexOf("[CDATA["))===0?(o.name="#cdata",o.type=4,o.value=r.decode(a.replace(/^\[CDATA\[|\]\]$/g,""))):(null==a?void 0:a.indexOf("mce:protected "))===0&&(o.name="#text",o.type=3,o.raw=!0,o.value=unescape(a).substr(14))}}),e.addNodeFilter("xml:namespace,input",(e,t)=>{let r=e.length;for(;r--;){let n=e[r];7===n.type?n.remove():1!==n.type||"input"!==t||n.attr("type")||n.attr("type","text")}}),e.addAttributeFilter("data-mce-type",t=>{eg(t,t=>{"format-caret"===t.attr("data-mce-type")&&(t.isEmpty(e.schema.getNonEmptyElements())?t.remove():t.unwrap())})}),e.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-block,data-mce-type,data-mce-resize,data-mce-placeholder",(e,t)=>{let r=e.length;for(;r--;)e[r].attr(t,null)}),t.remove_trailing_brs&&xT(t,e,e.schema)},Se=e=>{let t=e=>(null==e?void 0:e.name)==="br",r=e.lastChild;if(t(r)){let e=r.prev;t(e)&&(r.remove(),e.remove())}},St=(e,t,r)=>{let n;let o=e.dom,a=t.cloneNode(!0),l=document.implementation;if(l.createHTMLDocument){let e=l.createHTMLDocument("");t2.each("BODY"===a.nodeName?a.childNodes:[a],t=>{e.body.appendChild(e.importNode(t,!0))}),a="BODY"!==a.nodeName?e.body.firstChild:e.body,n=o.doc,o.doc=e}return fp(e,{...r,node:a}),n&&(o.doc=n),a},Sr=(e,t)=>H(e)&&e.hasEventListeners("PreProcess")&&!t.no_events,Sn=(e,t,r)=>Sr(e,r)?St(e,t,r):t,So=(e,t,r)=>{-1===t2.inArray(t,r)&&(e.addAttributeFilter(r,(e,t)=>{let r=e.length;for(;r--;)e[r].attr(t,null)}),t.push(r))},Sa=(e,t,r)=>!t.no_events&&e?fh(e,{...t,content:r}).content:r,Sl=(e,t,r)=>{let n=o4(r.getInner?t.innerHTML:e.getOuterHTML(t));return r.selection||o0(rz.fromDom(t))?n:t2.trim(n)},Si=(e,t,r)=>{let n=r.selection?{forced_root_block:!1,...r}:r,o=e.parse(t,n);return Se(o),o},Ss=(e,t,r)=>hh(e,t).serialize(r),Sd=(e,t,r,n,o)=>Sa(e,o,Ss(t,r,n)),Sc=(e,t)=>{let r=["data-mce-selected"],n={entity_encoding:"named",remove_trailing_brs:!0,pad_empty_with_br:!1,...e},o=t&&t.dom?t.dom:it.DOM,a=t&&t.schema?t.schema:lU(n),l=w7(n,a);return k7(l,n,o),{schema:a,addNodeFilter:l.addNodeFilter,addAttributeFilter:l.addAttributeFilter,serialize:(e,r={})=>{let i={format:"html",...r},s=Si(l,Sl(o,Sn(t,e,i),i),i);return"tree"===i.format?s:Sd(t,n,a,s,i)},addRules:a.addValidElements,setRules:a.setValidElements,addTempAttr:J(So,l,r),getTempAttrs:Y(r),getNodeFilters:l.getNodeFilters,getAttributeFilters:l.getAttributeFilters,removeNodeFilter:l.removeNodeFilter,removeAttributeFilter:l.removeAttributeFilter}},Sm=(e,t)=>{let r=Sc(e,t);return{schema:r.schema,addNodeFilter:r.addNodeFilter,addAttributeFilter:r.addAttributeFilter,serialize:r.serialize,addRules:r.addRules,setRules:r.setRules,addTempAttr:r.addTempAttr,getTempAttrs:r.getTempAttrs,getNodeFilters:r.getNodeFilters,getAttributeFilters:r.getAttributeFilters,removeNodeFilter:r.removeNodeFilter,removeAttributeFilter:r.removeAttributeFilter}},Su=(e,t)=>({...e,format:t,get:!0,getInner:!0}),Sf=(e,t={})=>{let r=t.format?t.format:"html";return Er(e,Su(t,r)).fold(X,t=>{let r=kz(e,t);return En(e,r,t)})},Sg=(e,t)=>({format:"html",...e,set:!0,content:t}),Sp=(e,t,r={})=>Eo(e,Sg(r,t)).map(t=>{let r=kj(e,t.content,t);return Ea(e,r.html,t),r.content}).getOr(t),Sh="autoresize_on_init,content_editable_state,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,tabfocus_elements,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_enable_default_filters,paste_filter_drop,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists".split(","),Sb="template_cdate_classes,template_mdate_classes,template_selected_content_classes,template_preview_replace_values,template_replace_values,templates,template_cdate_format,template_mdate_format".split(","),Sv="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,textcolor".split(","),Sy=[{name:"template",replacedWith:"Advanced Template"},{name:"rtc"}],SC=(e,t)=>eR(eb(t,t=>eG(e,t))),Sx=e=>{let t=SC(e,Sh),r=e.forced_root_block;return(!1===r||""===r)&&t.push("forced_root_block (false only)"),eR(t)},Sw=e=>SC(e,Sb),SE=(e,t)=>{let r=t2.makeMap(e.plugins," ");return eR(eb(t,e=>eG(r,e)))},Sk=e=>SE(e,Sv),SS=e=>SE(e,Sy.map(e=>e.name)),S_=(e,t)=>{let r=Sx(e),n=Sk(t),o=n.length>0,a=r.length>0,l="mobile"===t.theme;(o||a||l)&&console.warn("The following deprecated features are currently enabled and have been removed in TinyMCE 6.0. These features will no longer work and should be removed from the TinyMCE configuration. See https://www.tiny.cloud/docs/tinymce/6/migration-from-5x/ for more information."+(l?`

Themes:
- mobile`:"")+(o?`

Plugins:
- ${n.join("\n- ")}`:"")+(a?`

Options:
- ${r.join("\n- ")}`:""))},SN=e=>ex(Sy,t=>t.name===e).fold(()=>e,t=>t.replacedWith?`${e}, replaced by ${t.replacedWith}`:e),SD=(e,t)=>{let r=Sw(e),n=SS(t),o=n.length>0,a=r.length>0;(o||a)&&console.warn("The following deprecated features are currently enabled but will be removed soon."+(o?`

Plugins:
- ${n.map(SN).join("\n- ")}`:"")+(a?`

Options:
- ${r.join("\n- ")}`:""))},SR=(e,t)=>{S_(e,t),SD(e,t)},SA=it.DOM,SO=e=>{SA.setStyle(e.id,"display",e.orgDisplay)},ST=e=>ea.from(e).each(e=>e.destroy()),SB=e=>{e.contentAreaContainer=e.formElement=e.container=e.editorContainer=null,e.bodyElement=e.contentDocument=e.contentWindow=null,e.iframeElement=e.targetElm=null;let t=e.selection;if(t){let r=t.dom;e.selection=t.win=t.dom=r.doc=null}},SP=e=>{let t=e.formElement;t&&(t._mceOldSubmit&&(t.submit=t._mceOldSubmit,delete t._mceOldSubmit),SA.unbind(t,"submit reset",e.formEventDelegate))},SL=e=>{if(!e.removed){let{_selectionOverrides:t,editorUpload:r}=e,n=e.getBody(),o=e.getElement();n&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&H(null==o?void 0:o.nextSibling)&&SA.remove(o.nextSibling),fb(e),e.editorManager.remove(e),!e.inline&&n&&SO(e),fv(e),SA.remove(e.getContainer()),ST(t),ST(r),e.destroy()}},SF=(e,t)=>{let{selection:r,dom:n}=e;if(!e.destroyed){if(!t&&!e.removed){e.remove();return}t||(e.editorManager.off("beforeunload",e._beforeUnload),e.theme&&e.theme.destroy&&e.theme.destroy(),ST(r),ST(n)),SP(e),SB(e),e.destroyed=!0}},SM=(()=>{let e={};return{add:(t,r)=>{e[t]=r},get:t=>e[t]?e[t]:{icons:{}},has:t=>eG(e,t)}})(),SI=ig.ModelManager,SU=(e,t)=>t.dom[e],Sz=(e,t)=>parseInt(nO(t,e),10),Sj=J(SU,"clientWidth"),SH=J(SU,"clientHeight"),S$=J(Sz,"margin-top"),Sq=J(Sz,"margin-left"),SV=e=>e.dom.getBoundingClientRect(),SW=(e,t,r)=>{let n=Sj(e),o=SH(e);return t>=0&&r>=0&&t<=n&&r<=o},SK=(e,t,r,n)=>{let o=SV(t);return{x:r-(e?o.left+t.dom.clientLeft+Sq(t):0),y:n-(e?o.top+t.dom.clientTop+S$(t):0)}},SG=(e,t,r)=>{let n=rz.fromDom(e.getBody()),o=e.inline?n:rX(n),a=SK(e.inline,o,t,r);return SW(o,a.x,a.y)},SY=e=>ea.from(e).map(rz.fromDom),SX=e=>SY(e.inline?e.getBody():e.getContentAreaContainer()).map(nf).getOr(!1);var SQ=()=>{let e=()=>{throw Error("Theme did not provide a NotificationManager implementation.")};return{open:e,close:e,getArgs:e}};let SJ=e=>{let t=[],r=()=>{let t=e.theme;return t&&t.getNotificationManagerImpl?t.getNotificationManagerImpl():SQ()},n=()=>ea.from(t[0]),o=(e,t)=>e.type===t.type&&e.text===t.text&&!e.progressBar&&!e.timeout&&!t.progressBar&&!t.timeout,a=()=>{eg(t,e=>{e.reposition()})},l=e=>{t.push(e)},i=e=>{ew(t,t=>t===e).each(e=>{t.splice(e,1)})},s=(s,d=!0)=>e.removed||!SX(e)?{}:(d&&e.dispatch("BeforeOpenNotification",{notification:s}),ex(t,e=>o(r().getArgs(e),s)).getOrThunk(()=>{e.editorManager.setActive(e);let t=r().open(s,()=>{i(t),a(),n().fold(()=>e.focus(),e=>gZ(rz.fromDom(e.getEl())))});return l(t),a(),e.dispatch("OpenNotification",{notification:{...t}}),t})),d=Y(t);return e.on("SkinLoaded",()=>{let t=dz(e);t&&s({text:t,type:"warning",timeout:0},!1),a()}),e.on("show ResizeEditor ResizeWindow NodeChange",()=>{requestAnimationFrame(a)}),e.on("remove",()=>{eg(t.slice(),e=>{r().close(e)})}),{open:s,close:()=>{n().each(e=>{r().close(e),i(e),a()})},getNotifications:d}},SZ=ig.PluginManager,S0=ig.ThemeManager;var S1=()=>{let e=()=>{throw Error("Theme did not provide a WindowManager implementation.")};return{open:e,openUrl:e,alert:e,confirm:e,close:e}};let S2=e=>{let t=[],r=()=>{let t=e.theme;return t&&t.getWindowManagerImpl?t.getWindowManagerImpl():S1()},n=(e,t)=>(...r)=>t?t.apply(e,r):void 0,o=t=>{e.dispatch("OpenWindow",{dialog:t})},a=t=>{e.dispatch("CloseWindow",{dialog:t})},l=e=>{t.push(e),o(e)},i=r=>{a(r),0===(t=eb(t,e=>e!==r)).length&&e.focus()},s=()=>ea.from(t[t.length-1]),d=t=>{e.editorManager.setActive(e),pn(e),e.ui.show();let r=t();return l(r),r};return e.on("remove",()=>{eg(t,e=>{r().close(e)})}),{open:(e,t)=>d(()=>r().open(e,t,i)),openUrl:e=>d(()=>r().openUrl(e,i)),alert:(e,t,o)=>{let a=r();a.alert(e,n(o||a,t))},confirm:(e,t,o)=>{let a=r();a.confirm(e,n(o||a,t))},close:()=>{s().each(e=>{r().close(e),i(e)})}}},S3=(e,t)=>{e.notificationManager.open({type:"error",text:t})},S8=(e,t)=>{e._skinLoaded?S3(e,t):e.on("SkinLoaded",()=>{S3(e,t)})},S5=(e,t)=>{S8(e,iu.translate(["Failed to upload image: {0}",t]))},S6=(e,t,r)=>{f_(e,t,{message:r}),console.error(r)},S9=(e,t,r)=>r?`Failed to load ${e}: ${r} from url ${t}`:`Failed to load ${e} url: ${t}`,S4=(e,t,r)=>{S6(e,"PluginLoadError",S9("plugin",t,r))},S7=(e,t,r)=>{S6(e,"IconsLoadError",S9("icons",t,r))},_e=(e,t,r)=>{S6(e,"LanguageLoadError",S9("language",t,r))},_t=(e,t,r)=>{S6(e,"ThemeLoadError",S9("theme",t,r))},_r=(e,t,r)=>{S6(e,"ModelLoadError",S9("model",t,r))},_n=(e,t,r)=>{let n=iu.translate(["Failed to initialize plugin: {0}",t]);f_(e,"PluginLoadError",{message:n}),_o(n,r),S8(e,n)},_o=(e,...t)=>{let r=window.console;r&&(r.error?r.error(e,...t):r.log(e,...t))},_a=e=>/^[a-z0-9\-]+$/i.test(e),_l=e=>_s(e,dO(e)),_i=e=>_s(e,dB(e)),_s=(e,t)=>{let r=e.editorManager.baseURL+"/skins/content",n=e.editorManager.suffix,o=`content${n}.css`;return ef(t,t=>_a(t)&&!e.inline?`${r}/${t}/${o}`:e.documentBaseURI.toAbsolute(t))},_d=e=>{e.contentCSS=e.contentCSS.concat(_l(e),_i(e))},_c=e=>e?eB(e.getElementsByTagName("img")):[],_m=(e,t)=>{let r={};return{findAll:(n,o=eo)=>Promise.all(ef(eb(_c(n),t=>{let r=t.src;return!(t.hasAttribute("data-mce-bogus")||t.hasAttribute("data-mce-placeholder"))&&!!r&&r!==tJ.transparentSrc&&(tm(r,"blob:")?!e.isUploaded(r)&&o(t):!!tm(r,"data:")&&o(t))}),e=>{let n=e.src;if(eG(r,n))return r[n].then(t=>P(t)?t:{image:e,blobInfo:t.blobInfo});{let o=xV(t,n).then(t=>(delete r[n],{image:e,blobInfo:t})).catch(e=>(delete r[n],e));return r[n]=o,o}}))}},_u=()=>{let e={},t=(e,t)=>({status:e,resultUri:t}),r=t=>t in e;return{hasBlobUri:r,getResultUri:t=>{let r=e[t];return r?r.resultUri:null},isPending:t=>!!r(t)&&1===e[t].status,isUploaded:t=>!!r(t)&&2===e[t].status,markPending:r=>{e[r]=t(1,null)},markUploaded:(r,n)=>{e[r]=t(2,n)},removeFailed:t=>{delete e[t]},destroy:()=>{e={}}}},_f=0,_g=()=>{let e=()=>Math.round(4294967295*Math.random()).toString(36);return"s"+new Date().getTime().toString(36)+e()+e()+e()},_p=e=>e+_f+++_g(),_h=()=>{let e=[],t=e=>({"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"})[e.toLowerCase()]||"dat",r=e=>{if(!e.blob||!e.base64)throw Error("blob and base64 representations of the image are required for BlobInfo to be created");let r=e.id||_p("blobid"),n=e.name||r,o=e.blob;return{id:Y(r),name:Y(n),filename:Y(e.filename||n+"."+t(o.type)),blob:Y(o),base64:Y(e.base64),blobUri:Y(e.blobUri||URL.createObjectURL(o)),uri:Y(e.uri)}},n=t=>ex(e,t).getOrUndefined(),o=e=>n(t=>t.id()===e);return{create:(e,t,n,o,a)=>{if(P(e))return r({id:e,name:o,filename:a,blob:t,base64:n});if(L(e))return r(e);throw Error("Unknown input type")},add:t=>{o(t.id())||e.push(t)},get:o,getByUri:e=>n(t=>t.blobUri()===e),getByData:(e,t)=>n(r=>r.base64()===e&&r.blob().type===t),findFirst:n,removeByUri:t=>{e=eb(e,e=>e.blobUri()!==t||(URL.revokeObjectURL(e.blobUri()),!1))},destroy:()=>{eg(e,e=>{URL.revokeObjectURL(e.blobUri())}),e=[]}}},_b=(e,t)=>{let r={},n=(e,t)=>e?e.replace(/\/$/,"")+"/"+t.replace(/^\//,""):t,o=(e,r)=>new Promise((o,a)=>{let l=new XMLHttpRequest;l.open("POST",t.url),l.withCredentials=t.credentials,l.upload.onprogress=e=>{r(e.loaded/e.total*100)},l.onerror=()=>{a("Image upload failed due to a XHR Transport error. Code: "+l.status)},l.onload=()=>{if(l.status<200||l.status>=300){a("HTTP Error: "+l.status);return}let e=JSON.parse(l.responseText);if(!e||!P(e.location)){a("Invalid JSON: "+l.responseText);return}o(n(t.basePath,e.location))};let i=new FormData;i.append("file",e.blob(),e.filename()),l.send(i)}),a=$(t.handler)?t.handler:o,l=()=>new Promise(e=>{e([])}),i=(e,t)=>({url:t,blobInfo:e,status:!0}),s=(e,t)=>({url:"",blobInfo:e,status:!1,error:t}),d=(e,t)=>{t2.each(r[e],e=>{e(t)}),delete r[e]},c=(t,r,n)=>(e.markPending(t.blobUri()),new Promise(o=>{let a,l;try{let c=()=>{a&&(a.close(),l=W)},m=r=>{c(),e.removeFailed(t.blobUri()),d(t.blobUri(),s(t,r)),o(s(t,r))};l=e=>{e<0||e>100||ea.from(a).orThunk(()=>ea.from(n).map(et)).each(t=>{a=t,t.progressBar.value(e)})},r(t,l).then(r=>{c(),e.markUploaded(t.blobUri(),r),d(t.blobUri(),i(t,r)),o(i(t,r))},e=>{m(P(e)?{message:e}:e)})}catch(e){o(s(t,e))}})),m=e=>e===o,u=e=>{let t=e.blobUri();return new Promise(e=>{r[t]=r[t]||[],r[t].push(e)})},f=(t,r)=>(t=t2.grep(t,t=>!e.isUploaded(t.blobUri())),Promise.all(t2.map(t,t=>e.isPending(t.blobUri())?u(t):c(t,a,r))));return{upload:(e,r)=>!t.url&&m(a)?l():f(e,r)}},_v=e=>()=>e.notificationManager.open({text:e.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0}),_y=(e,t)=>_b(t,{url:dx(e),basePath:dw(e),credentials:dE(e),handler:dk(e)}),_C=(e,t)=>e.dom.isEmpty(t.dom)&&H(e.schema.getTextBlockElements()[ri(t)]),_x=e=>t=>{_C(e,t)&&nz(t,rz.fromHtml('<br data-mce-bogus="1" />'))},_w=e=>{let t,r;let n=_h(),o=_u(),a=[],l=t=>r=>e.selection?t(r):[],i=e=>e+(-1===e.indexOf("?")?"?":"&")+new Date().getTime(),s=(e,t,r)=>{let n=0;do -1!==(n=e.indexOf(t,n))&&(e=e.substring(0,n)+r+e.substr(n+t.length),n+=r.length-t.length+1);while(-1!==n);return e},d=(e,t,r)=>(e=s(e,`src="${t}"`,`src="${r}"${r===tJ.transparentSrc?' data-mce-placeholder="1"':""}`),e=s(e,'data-mce-src="'+t+'"','data-mce-src="'+r+'"')),c=(t,r)=>{eg(e.undoManager.data,e=>{"fragmented"===e.type?e.fragments=ef(e.fragments,e=>d(e,t,r)):e.content=d(e.content,t,r)})},m=(t,r)=>{let n=e.convertURL(r,"src");c(t.src,r),ry(rz.fromDom(t),{src:db(e)?i(r):r,"data-mce-src":n})},u=()=>(t||(t=_y(e,o)),p().then(l(r=>{let o=ef(r,e=>e.blobInfo);return t.upload(o,_v(e)).then(l(t=>{let o=[],a=!1,l=ef(t,(t,l)=>{let{blobInfo:i,image:s}=r[l],d=!1;return t.status&&dv(e)?(t.url&&!tc(s.src,t.url)&&(a=!0),n.removeByUri(s.src),kp(e)||m(s,t.url)):t.error&&(t.error.remove&&(c(s.src,tJ.transparentSrc),o.push(s),d=!0),S5(e,t.error.message)),{element:s,status:t.status,uploadUri:t.url,blobInfo:i,removed:d}});return o.length>0&&!kp(e)?e.undoManager.transact(()=>{eg(nG(o),t=>{let r=rJ(t);nV(t),r.each(_x(e)),n.removeByUri(t.dom.src)})}):a&&e.undoManager.dispatchChange(),l}))}))),f=()=>dh(e)?u():Promise.resolve([]),g=e=>eS(a,t=>t(e)),p=()=>(r||(r=_m(o,n)),r.findAll(e.getBody(),g).then(l(t=>{let r=eb(t,t=>P(t)?(S8(e,t),!1):"blob"!==t.uriType);return kp(e)||eg(r,e=>{c(e.image.src,e.blobInfo.blobUri()),e.image.src=e.blobInfo.blobUri(),e.image.removeAttribute("data-mce-src")}),r}))),h=t=>t.replace(/src="(blob:[^"]+)"/g,(t,r)=>{let a=o.getResultUri(r);if(a)return'src="'+a+'"';let l=n.getByUri(r);return(l||(l=ey(e.editorManager.get(),(e,t)=>e||t.editorUpload&&t.editorUpload.blobCache.getByUri(r),void 0)),l)?'src="data:'+l.blob().type+";base64,"+l.base64()+'"':t});return e.on("SetContent",()=>{dh(e)?f():p()}),e.on("RawSaveContent",e=>{e.content=h(e.content)}),e.on("GetContent",e=>{e.source_view||"raw"===e.format||"tree"===e.format||(e.content=h(e.content))}),e.on("PostRender",()=>{e.parser.addNodeFilter("img",e=>{eg(e,e=>{let t=e.attr("src");if(!t||n.getByUri(t))return;let r=o.getResultUri(t);r&&e.attr("src",r)})})}),{blobCache:n,addFilter:e=>{a.push(e)},uploadImages:u,uploadImagesAuto:f,scanForImages:p,destroy:()=>{n.destroy(),o.destroy(),r=t=null}}},_E=e=>{let t=e.dom,r=e.schema.type,n={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"left"},inherit:!1,preview:!1},{selector:"img,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginLeft:"0px",marginRight:"auto"},onformat:e=>{t.setStyle(e,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"},{selector:".mce-preview-object",ceFalseOverride:!0,styles:{display:"table",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{marginLeft:"auto",marginRight:"auto"},preview:!1}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginRight:"0px",marginLeft:"auto"},onformat:e=>{t.setStyle(e,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"right"},preview:!1}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"justify"},inherit:!1,preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:(()=>{let e={inline:"span",styles:{textDecoration:"line-through"},exact:!0},t={inline:"strike",remove:"all",preserve_attributes:["class","style"]},n={inline:"s",remove:"all",preserve_attributes:["class","style"]};return"html4"!==r?[n,e,t]:[e,n,t]})(),forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:(e,t,r)=>ou(e)&&e.hasAttribute("href"),onformat:(e,r,n)=>{t2.each(n,(r,n)=>{t.setAttrib(e,n,r)})}},lang:{inline:"span",clear_child_styles:!0,remove_similar:!0,attributes:{lang:"%value","data-mce-lang":e=>{var t;return null!==(t=null==e?void 0:e.customValue)&&void 0!==t?t:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return t2.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd samp".split(/\s/),e=>{n[e]={block:e,remove:"all"}}),n},_k={remove_similar:!0,inherit:!1},_S={selector:"td,th",..._k},__=Y({tablecellbackgroundcolor:{styles:{backgroundColor:"%value"},..._S},tablecellverticalalign:{styles:{"vertical-align":"%value"},..._S},tablecellbordercolor:{styles:{borderColor:"%value"},..._S},tablecellclass:{classes:["%value"],..._S},tableclass:{selector:"table",classes:["%value"],..._k},tablecellborderstyle:{styles:{borderStyle:"%value"},..._S},tablecellborderwidth:{styles:{borderWidth:"%value"},..._S}}),_N=e=>{let t={},r=(e,n)=>{e&&(P(e)?(M(n)||(n=[n]),eg(n,e=>{z(e.deep)&&(e.deep=!uX(e)),z(e.split)&&(e.split=!uX(e)||uQ(e)),z(e.remove)&&uX(e)&&!uQ(e)&&(e.remove="none"),uX(e)&&uQ(e)&&(e.mixed=!0,e.block_expand=!0),P(e.classes)&&(e.classes=e.classes.split(/\s+/))}),t[e]=n):eI(e,(e,t)=>{r(t,e)}))};return r(_E(e)),r(__()),r(dW(e)),{get:e=>H(e)?t[e]:t,has:e=>eG(t,e),register:r,unregister:e=>(e&&t[e]&&delete t[e],t)}},_D=t2.each,_R=it.DOM,_A=e=>H(e)&&L(e),_O=(e,t)=>{let r=t&&t.schema||lU({}),n=(e,t)=>{t.classes.length>0&&_R.addClass(e,t.classes.join(" ")),_R.setAttribs(e,t.attrs)},o=e=>{let t=P(e)?{name:e,classes:[],attrs:{}}:e,r=_R.create(t.name);return n(r,t),r},a=(e,t)=>{let n=r.getElementRule(e.nodeName.toLowerCase()),o=null==n?void 0:n.parentsRequired;return!!o&&!!o.length&&(t&&em(o,t)?t:o[0])},l=(e,t,r)=>{let n;let i=t[0],s=_A(i)?i.name:void 0,d=a(e,s);if(d)s===d?(n=i,t=t.slice(1)):n=d;else if(i)n=i,t=t.slice(1);else if(!r)return e;let c=n?o(n):_R.create("div");return c.appendChild(e),r&&t2.each(r,t=>{let r=o(t);c.insertBefore(r,e)}),l(c,t,_A(n)?n.siblings:void 0)},i=_R.create("div");if(e.length>0){let t=e[0],r=o(t),n=_A(t)?t.siblings:void 0;i.appendChild(l(r,e.slice(1),n))}return i},_T=e=>{e=t2.trim(e);let t="div",r={name:t,classes:[],attrs:{},selector:e};return"*"!==e&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(e,t,n,o,a)=>{switch(t){case"#":r.attrs.id=n;break;case".":r.classes.push(n);break;case":":-1!==t2.inArray("checked disabled enabled read-only required".split(" "),n)&&(r.attrs[n]=n)}if("["===o){let e=a.match(/([\w\-]+)(?:\=\"([^\"]+))?/);e&&(r.attrs[e[1]]=e[2])}return""})),r.name=t||"div",r},_B=e=>P(e)?(e=(e=e.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),t2.map(e.split(/(?:>|\s+(?![^\[\]]+\]))/),e=>{let t=t2.map(e.split(/(?:~\+|~|\+)/),_T),r=t.pop();return t.length&&(r.siblings=t),r}).reverse()):[],_P=(e,t)=>{let r,n="",o=dK(e);if(""===o)return"";let a=e=>P(e)?e.replace(/%(\w+)/g,""):"",l=(t,r)=>_R.getStyle(null!=r?r:e.getBody(),t,!0);if(P(t)){let r=e.formatter.get(t);if(!r)return"";t=r[0]}if("preview"in t){let e=t.preview;if(!1===e)return"";o=e||o}let i=t.block||t.inline||"span",s=_B(t.selector);s.length>0?(s[0].name||(s[0].name=i),i=t.selector,r=_O(s,e)):r=_O([i],e);let d=_R.select(i,r)[0]||r.firstChild;_D(t.styles,(e,t)=>{let r=a(e);r&&_R.setStyle(d,t,r)}),_D(t.attributes,(e,t)=>{let r=a(e);r&&_R.setAttrib(d,t,r)}),_D(t.classes,e=>{let t=a(e);_R.hasClass(d,t)||_R.addClass(d,t)}),e.dispatch("PreviewFormats"),_R.setStyles(r,{position:"absolute",left:-65535}),e.getBody().appendChild(r);let c=l("fontSize"),m=/px$/.test(c)?parseInt(c,10):0;return _D(o.split(" "),e=>{let t=l(e,d);if((!("background-color"===e&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(t))||"#ffffff"!==ui(t=l(e)).toLowerCase())&&("color"!==e||"#000000"!==ui(t).toLowerCase())){if("font-size"===e&&/em|%$/.test(t)){if(0===m)return;t=parseFloat(t)/(/%$/.test(t)?100:1)*m+"px"}"border"===e&&t&&(n+="padding:0 2px;"),n+=e+":"+t+";"}}),e.dispatch("AfterPreviewFormats"),_R.remove(r),n},_L=e=>{e.addShortcut("meta+b","","Bold"),e.addShortcut("meta+i","","Italic"),e.addShortcut("meta+u","","Underline");for(let t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",!1,"h"+t]);e.addShortcut("access+7","",["FormatBlock",!1,"p"]),e.addShortcut("access+8","",["FormatBlock",!1,"div"]),e.addShortcut("access+9","",["FormatBlock",!1,"address"])},_F=e=>{let t=_N(e),r=ia({});return _L(e),Cb(e),kp(e)||xh(r,e),{get:t.get,has:t.has,register:t.register,unregister:t.unregister,apply:(t,r,n)=>{kF(e,t,r,n)},remove:(t,r,n,o)=>{kM(e,t,r,n,o)},toggle:(t,r,n)=>{kI(e,t,r,n)},match:(t,r,n,o)=>kO(e,t,r,n,o),closest:t=>kL(e,t),matchAll:(t,r)=>kT(e,t,r),matchNode:(t,r,n,o)=>kB(e,t,r,n,o),canApply:t=>kP(e,t),formatChanged:(t,n,o,a)=>kU(e,r,t,n,o,a),getCssText:J(_P,e)}},_M=e=>{switch(e.toLowerCase()){case"undo":case"redo":case"mcefocus":return!0;default:return!1}},_I=(e,t,r)=>{let n=ia(!1),o=e=>{E9(t,!1,r),t.add({},e)};e.on("init",()=>{t.add()}),e.on("BeforeExecCommand",e=>{_M(e.command)||(E4(t,r),t.beforeChange())}),e.on("ExecCommand",e=>{_M(e.command)||o(e)}),e.on("ObjectResizeStart cut",()=>{t.beforeChange()}),e.on("SaveContent ObjectResized blur",o),e.on("dragend",o),e.on("keyup",r=>{let a=r.keyCode;if(r.isDefaultPrevented())return;let l=tJ.os.isMacOS()&&"Meta"===r.key;(a>=33&&a<=36||a>=37&&a<=40||45===a||r.ctrlKey||l)&&(o(),e.nodeChanged()),(46===a||8===a)&&e.nodeChanged(),n.get()&&t.typing&&!E5(EZ(e),t.data[0])&&(e.isDirty()||e.setDirty(!0),e.dispatch("TypingUndo"),n.set(!1),e.nodeChanged())}),e.on("keydown",e=>{let a=e.keyCode;if(e.isDefaultPrevented())return;if(a>=33&&a<=36||a>=37&&a<=40||45===a){t.typing&&o(e);return}let l=e.ctrlKey&&!e.altKey||e.metaKey;if((a<16||a>20)&&224!==a&&91!==a&&!t.typing&&!l){t.beforeChange(),E9(t,!0,r),t.add({},e),n.set(!0);return}(tJ.os.isMacOS()?e.metaKey:e.ctrlKey&&!e.altKey)&&t.beforeChange()}),e.on("mousedown",e=>{t.typing&&o(e)});let a=e=>"insertReplacementText"===e.inputType,l=e=>"insertText"===e.inputType&&null===e.data,i=e=>"insertFromPaste"===e.inputType||"insertFromDrop"===e.inputType;e.on("input",e=>{e.inputType&&(a(e)||l(e)||i(e))&&o(e)}),e.on("AddUndo Undo Redo ClearUndos",t=>{t.isDefaultPrevented()||e.nodeChanged()})},_U=e=>{e.addShortcut("meta+z","","Undo"),e.addShortcut("meta+y,meta+shift+z","","Redo")},_z=e=>{let t=ib(),r=ia(0),n=ia(0),o={data:[],typing:!1,beforeChange:()=>{kC(e,r,t)},add:(a,l)=>kx(e,o,n,r,t,a,l),dispatchChange:()=>{e.setDirty(!0);let t=EZ(e);t.bookmark=sq(e.selection),e.dispatch("change",{level:t,lastLevel:eA(o.data,n.get()).getOrUndefined()})},undo:()=>kw(e,o,r,n),redo:()=>kE(e,n,o.data),clear:()=>{kk(e,o,n)},reset:()=>{kS(e,o)},hasUndo:()=>k_(e,o,n),hasRedo:()=>kN(e,o,n),transact:t=>kD(e,o,r,t),ignore:t=>{kR(e,r,t)},extra:(t,r)=>{kA(e,o,n,t,r)}};return kp(e)||_I(e,o,r),_U(e),o},_j=[9,27,fz.HOME,fz.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,fz.DOWN,fz.UP,fz.LEFT,fz.RIGHT].concat(tJ.browser.isFirefox()?[224]:[]),_H="data-mce-placeholder",_$=e=>"keydown"===e.type||"keyup"===e.type,_q=e=>{let t=e.keyCode;return t===fz.BACKSPACE||t===fz.DELETE},_V=e=>{if(!_$(e))return!1;{let t=e.keyCode;return!_q(e)&&(fz.metaKeyPressed(e)||e.altKey||t>=112&&t<=123||em(_j,t))}},_W=e=>_$(e)&&!(_q(e)||"keyup"===e.type&&229===e.keyCode),_K=(e,t,r)=>{if(!aF(rz.fromDom(t),!1))return!1;{let n=t.firstElementChild;return!n||!(e.getStyle(t.firstElementChild,"padding-left")||e.getStyle(t.firstElementChild,"padding-right"))&&r===n.nodeName.toLowerCase()}},_G=e=>{var t;let r=e.dom,n=dd(e),o=null!==(t=dI(e))&&void 0!==t?t:"",a=(t,l)=>{if(_V(t))return;let i=e.getBody(),s=!_W(t)&&_K(r,i,n);(""!==r.getAttrib(i,_H)!==s||l)&&(r.setAttrib(i,_H,s?o:null),r.setAttrib(i,"aria-placeholder",s?o:null),fS(e,s),e.on(s?"keydown":"keyup",a),e.off(s?"keyup":"keydown",a))};tb(o)&&e.on("init",t=>{a(t,!0),e.on("change SetContent ExecCommand",a),e.on("paste",t=>pd.setEditorTimeout(e,()=>a(t)))})},_Y=(e,t)=>({block:e,position:t}),_X=(e,t)=>({from:e,to:t}),_Q=(e,t)=>b6(rz.fromDom(e),rz.fromDom(t.container())).map(e=>_Y(e,t)),_J=e=>!rW(e.from.block,e.to.block),_Z=(e,t)=>nh(t,e=>oZ(e)||oA(e.dom),t=>rW(t,e)).filter(ru).getOr(e),_0=(e,t)=>{let r=rz.fromDom(e);return rW(_Z(r,t.from.block),_Z(r,t.to.block))},_1=e=>!1===oO(e.from.block.dom)&&!1===oO(e.to.block.dom),_2=e=>{let t=e=>oY(e)||aY(e.dom);return t(e.from.block)&&t(e.to.block)},_3=(e,t,r)=>oD(r.position.getNode())&&!aF(r.block)?mR(!1,r.block.dom).bind(n=>n.isEqual(r.position)?m_(t,e,n).bind(t=>_Q(e,t)):ea.some(r)).getOr(r):r,_8=(e,t,r)=>{let n=_Q(e,sf.fromRangeStart(r)),o=n.bind(r=>m_(t,e,r.position).bind(r=>_Q(e,r).map(r=>_3(e,t,r))));return t6(n,o,_X).filter(t=>_J(t)&&_0(e,t)&&_1(t)&&_2(t))},_5=(e,t,r)=>r.collapsed?_8(e,t,r):ea.none(),_6=e=>{let t=r6(e);return ew(t,oV).fold(Y(t),e=>t.slice(0,e))},_9=e=>{let t=_6(e);return eg(t,nV),t},_4=(e,t)=>ex(hH(t,e).reverse(),e=>aF(e)).each(nV),_7=e=>0===eb(r8(e),e=>!aF(e)).length,Ne=(e,t,r,n)=>{if(aF(r))return o6(r),mT(r.dom);_7(n)&&aF(t)&&nM(n,rz.fromTag("br"));let o=mO(r.dom,sf.before(n.dom));return eg(_9(t),e=>{nM(n,e)}),_4(e,t),o},Nt=(e,t,r)=>{if(aF(r)){if(aF(t)){let e=ev((e=>{let t=(e,r)=>r4(e).fold(()=>r,e=>oK(e)?t(e,r.concat(iz(e))):r);return t(e,[])})(r),(e,t)=>(nj(e,t),t),o5());nq(t),nz(t,e)}return nV(r),mT(t.dom)}let n=mB(r.dom);return eg(_9(t),e=>{nz(r,e)}),_4(e,t),n},Nr=(e,t)=>{let r=hH(t,e);return ea.from(r[r.length-1])},Nn=(e,t)=>rK(t,e)?Nr(t,e):ea.none(),No=(e,t)=>{mR(e,t.dom).bind(e=>ea.from(e.getNode())).map(rz.fromDom).filter(oG).each(nV)},Na=(e,t,r)=>(No(!0,t),No(!1,r),Nn(t,r).fold(J(Nt,e,t,r),J(Ne,e,t,r))),Nl=(e,t,r,n)=>t?Na(e,n,r):Na(e,r,n),Ni=(e,t)=>{let r=rz.fromDom(e.getBody());return _5(r.dom,t,e.selection.getRng()).map(n=>()=>{Nl(r,t,n.from.block,n.to.block).each(t=>{e.selection.setRng(t.toRange())})})},Ns=(e,t)=>{let r=t.getRng();return t6(b6(e,rz.fromDom(r.startContainer)),b6(e,rz.fromDom(r.endContainer)),(n,o)=>rW(n,o)?ea.none():ea.some(()=>{r.deleteContents(),Nl(e,!0,n,o).each(e=>{t.setRng(e.toRange())})})).getOr(ea.none())},Nd=(e,t)=>np(rz.fromDom(t),oZ,J(rW,e)).isSome(),Nc=(e,t)=>Nd(e,t.startContainer)||Nd(e,t.endContainer),Nm=(e,t)=>{let r=mO(e.dom,sf.fromRangeStart(t)).isNone(),n=mA(e.dom,sf.fromRangeEnd(t)).isNone();return!Nc(e,t)&&r&&n},Nu=e=>ea.some(()=>{e.setContent(""),e.selection.setCursorLocation()}),Nf=e=>{let t=rz.fromDom(e.getBody());return Nm(t,e.selection.getRng())?Nu(e):Ns(t,e.selection)},Ng=(e,t)=>e.selection.isCollapsed()?ea.none():Nf(e),Np=(e,t,r,n,o)=>ea.from(t._selectionOverrides.showCaret(e,r,n,o)),Nh=e=>{let t=e.ownerDocument.createRange();return t.selectNode(e),t},Nb=(e,t)=>e.dispatch("BeforeObjectSelected",{target:t}).isDefaultPrevented()?ea.none():ea.some(Nh(t)),Nv=(e,t,r)=>{let n=ma(1,e.getBody(),t),o=sf.fromRangeStart(n),a=o.getNode();if(cZ(a))return Np(1,e,a,!o.isAtEnd(),!1);let l=o.getNode(!0);if(cZ(l))return Np(1,e,l,!1,!1);let i=vX(e.dom.getRoot(),o.getNode());return cZ(i)?Np(1,e,i,!1,r):ea.none()},Ny=(e,t,r)=>t.collapsed?Nv(e,t,r).getOr(t):t,NC=e=>hM(e)||hB(e),Nx=e=>hI(e)||hP(e),Nw=(e,t)=>{ow(t)&&0===t.data.length&&e.remove(t)},NE=(e,t,r,n,o,a)=>{Np(n,e,a.getNode(!o),o,!0).each(r=>{if(t.collapsed){let e=t.cloneRange();o?e.setEnd(r.startContainer,r.startOffset):e.setStart(r.endContainer,r.endOffset),e.deleteContents()}else t.deleteContents();e.selection.setRng(r)}),Nw(e.dom,r)},Nk=(e,t)=>{let r=e.selection.getRng();if(!ow(r.commonAncestorContainer))return ea.none();let n=t?p.Forwards:p.Backwards,o=mv(e.getBody()),a=J(mc,t?o.next:o.prev),l=t?NC:Nx,i=mi(n,e.getBody(),r),s=a(i),d=s?bQ(t,s):s;if(!d||!mm(i,d))return ea.none();if(l(d))return ea.some(()=>NE(e,r,i.getNode(),n,t,d));let c=a(d);return c&&l(c)&&mm(d,c)?ea.some(()=>NE(e,r,i.getNode(),n,t,c)):ea.none()},NS=(e,t)=>Nk(e,t),N_=(e,t)=>{let r=e.getBody();return t?mT(r).filter(hM):mB(r).filter(hI)},NN=e=>{let t=e.selection.getRng();return!t.collapsed&&(N_(e,!0).exists(e=>e.isEqual(sf.fromRangeStart(t)))||N_(e,!1).exists(e=>e.isEqual(sf.fromRangeEnd(t))))},ND=e=>H(e)&&(oZ(rz.fromDom(e))||oQ(rz.fromDom(e))),NR=sW([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),NA=(e,t)=>{let r=t.getNode(!e);return ou(r)&&r.getAttribute("data-mce-caret")===(e?"after":"before")},NO=(e,t,r,n)=>{let o=t=>oK(rz.fromDom(t))&&!c4(r,n,e);return ml(!t,r).fold(()=>ml(t,n).fold(en,o),o)},NT=(e,t,r,n)=>{let o=n.getNode(!t);return b6(rz.fromDom(e),rz.fromDom(r.getNode())).map(e=>aF(e)?NR.remove(e.dom):NR.moveToElement(o)).orThunk(()=>ea.some(NR.moveToElement(o)))},NB=(e,t,r)=>m_(t,e,r).bind(n=>ND(n.getNode())||NO(e,t,r,n)?ea.none():t&&oO(n.getNode())||!t&&oO(n.getNode(!0))?NT(e,t,r,n):t&&hI(r)?ea.some(NR.moveToPosition(n)):!t&&hM(r)?ea.some(NR.moveToPosition(n)):ea.none()),NP=(e,t)=>j(t)?ea.none():e&&oO(t.nextSibling)?ea.some(NR.moveToElement(t.nextSibling)):!e&&oO(t.previousSibling)?ea.some(NR.moveToElement(t.previousSibling)):ea.none(),NL=(e,t,r)=>r.fold(e=>ea.some(NR.remove(e)),e=>ea.some(NR.moveToElement(e)),r=>c4(t,r,e)?ea.none():ea.some(NR.moveToPosition(r))),NF=(e,t,r)=>NA(t,r)?NP(t,r.getNode(!t)).orThunk(()=>NB(e,t,r)):NB(e,t,r).bind(t=>NL(e,r,t)),NM=(e,t,r)=>{let n=ma(t?1:-1,e,r),o=sf.fromRangeStart(n),a=rz.fromDom(e);return!t&&hI(o)?ea.some(NR.remove(o.getNode(!0))):t&&hM(o)?ea.some(NR.remove(o.getNode())):!t&&hM(o)&&h0(a,o)?h1(a,o).map(e=>NR.remove(e.getNode())):t&&hI(o)&&hZ(a,o)?h2(a,o).map(e=>NR.remove(e.getNode())):NF(e,t,o)},NI=(e,t)=>r=>(e._selectionOverrides.hideFakeCaret(),bH(e,t,rz.fromDom(r)),!0),NU=(e,t)=>r=>{let n=t?sf.before(r):sf.after(r);return e.selection.setRng(n.toRange()),!0},Nz=e=>t=>(e.selection.setRng(t.toRange()),!0),Nj=(e,t)=>ea.from(vX(e.getBody(),t)),NH=(e,t)=>{let r=e.selection.getNode();return Nj(e,r).filter(oO).fold(()=>NM(e.getBody(),t,e.selection.getRng()).map(r=>()=>r.fold(NI(e,t),NU(e,t),Nz(e))),()=>ea.some(W))},N$=e=>{eg(oi(e,".mce-offscreen-selection"),nV)},Nq=(e,t)=>{let r=e.selection.getNode();return oO(r)&&!oT(r)?Nj(e,r.parentNode).filter(oO).fold(()=>ea.some(()=>{N$(rz.fromDom(e.getBody())),bH(e,t,rz.fromDom(e.selection.getNode())),b9(e)}),()=>ea.some(W)):NN(e)?ea.some(()=>{ve(e,e.selection.getRng(),rz.fromDom(e.getBody()))}):ea.none()},NV=e=>{let t=e.dom,r=e.selection,n=vX(e.getBody(),r.getNode());if(oA(n)&&t.isBlock(n)&&t.isEmpty(n)){let e=t.create("br",{"data-mce-bogus":"1"});t.setHTML(n,""),n.appendChild(e),r.setRng(sf.before(e).toRange())}return!0},NW=(e,t)=>e.selection.isCollapsed()?NH(e,t):Nq(e,t),NK=(e,t)=>{let r=sf.fromRangeStart(e.selection.getRng());return m_(t,e.getBody(),r).filter(e=>t?hO(e):hT(e)).bind(e=>c7(t?0:-1,e)).map(t=>()=>e.selection.select(t))},NG=(e,t)=>e.selection.isCollapsed()?NK(e,t):ea.none(),NY=e=>ow(e)&&"\uFEFF"===e.data[0],NX=e=>ow(e)&&"\uFEFF"===e.data[e.data.length-1],NQ=e=>{var t;return(null!==(t=e.ownerDocument)&&void 0!==t?t:document).createTextNode("\uFEFF")},NJ=e=>{var t;if(ow(e.previousSibling))return NX(e.previousSibling)||e.previousSibling.appendData("\uFEFF"),e.previousSibling;if(ow(e))return NY(e)||e.insertData(0,"\uFEFF"),e;{let r=NQ(e);return null===(t=e.parentNode)||void 0===t||t.insertBefore(r,e),r}},NZ=e=>{var t,r;if(ow(e.nextSibling))return NY(e.nextSibling)||e.nextSibling.insertData(0,"\uFEFF"),e.nextSibling;if(ow(e))return NX(e)||e.appendData("\uFEFF"),e;{let n=NQ(e);return e.nextSibling?null===(t=e.parentNode)||void 0===t||t.insertBefore(n,e.nextSibling):null===(r=e.parentNode)||void 0===r||r.appendChild(n),n}},N0=(e,t)=>e?NJ(t):NZ(t),N1=J(N0,!0),N2=J(N0,!1),N3=(e,t)=>ow(e.container())?N0(t,e.container()):N0(t,e.getNode()),N8=(e,t)=>{let r=t.get();return r&&e.container()===r&&ae(r)},N5=(e,t)=>t.fold(t=>{cG(e.get());let r=N1(t);return e.set(r),ea.some(sf(r,r.length-1))},t=>mT(t).map(t=>{if(N8(t,e))return sf(e.get(),1);{cG(e.get());let r=N3(t,!0);return e.set(r),sf(r,1)}}),t=>mB(t).map(t=>{if(N8(t,e)){let t=e.get();return sf(t,t.length-1)}{cG(e.get());let r=N3(t,!1);return e.set(r),sf(r,r.length-1)}}),t=>{cG(e.get());let r=N2(t);return e.set(r),ea.some(sf(r,1))}),N6=(e,t)=>{for(let r=0;r<e.length;r++){let n=e[r].apply(null,t);if(n.isSome())return n}return ea.none()},N9=sW([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),N4=(e,t)=>c9(t,e)||e,N7=(e,t,r)=>{let n=bJ(r),o=N4(t,n.container());return bG(e,o,n).fold(()=>mA(o,n).bind(J(bG,e,o)).map(e=>N9.before(e)),ea.none)},De=(e,t)=>null===mF(e,t),Dt=(e,t,r)=>bG(e,t,r).filter(J(De,t)),Dr=(e,t,r)=>{let n=bZ(r);return Dt(e,t,n).bind(e=>mO(e,n).isNone()?ea.some(N9.start(e)):ea.none())},Dn=(e,t,r)=>{let n=bJ(r);return Dt(e,t,n).bind(e=>mA(e,n).isNone()?ea.some(N9.end(e)):ea.none())},Do=(e,t,r)=>{let n=bZ(r),o=N4(t,n.container());return bG(e,o,n).fold(()=>mO(o,n).bind(J(bG,e,o)).map(e=>N9.after(e)),ea.none)},Da=e=>!bW(Di(e)),Dl=(e,t,r)=>N6([N7,Dr,Dn,Do],[e,t,r]).filter(Da),Di=e=>e.fold(X,X,X,X),Ds=e=>e.fold(Y("before"),Y("start"),Y("end"),Y("after")),Dd=e=>e.fold(N9.before,N9.before,N9.after,N9.after),Dc=e=>e.fold(N9.start,N9.start,N9.end,N9.end),Dm=(e,t)=>Ds(e)===Ds(t)&&Di(e)===Di(t),Du=(e,t,r,n,o,a)=>t6(bG(t,r,n),bG(t,r,o),(t,n)=>t!==n&&bY(r,t,n)?N9.after(e?t:n):a).getOr(a),Df=(e,t)=>e.fold(eo,e=>!Dm(e,t)),Dg=(e,t,r,n,o)=>{let a=bQ(e,o);return m_(e,r,a).map(J(bQ,e)).fold(()=>n.map(Dd),o=>Dl(t,r,o).map(J(Du,e,t,r,a,o)).filter(J(Df,n))).filter(Da)},Dp=(e,t)=>e?t.fold(K(ea.some,N9.start),ea.none,K(ea.some,N9.after),ea.none):t.fold(ea.none,K(ea.some,N9.before),ea.none,K(ea.some,N9.end)),Dh=(e,t,r,n)=>{let o=bQ(e,n),a=Dl(t,r,o);return Dl(t,r,o).bind(J(Dp,e)).orThunk(()=>Dg(e,t,r,a,n))},Db=e=>$(e.selection.getSel().modify),Dv=(e,t,r)=>(t.setRng(sf(r.container(),r.offset()+(e?1:-1)).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0),Dy=(e,t)=>{let r=t.selection.getRng(),n=e?sf.fromRangeEnd(r):sf.fromRangeStart(r);return!!Db(t)&&(e&&ao(n)?Dv(!0,t.selection,n):!!(!e&&aa(n))&&Dv(!1,t.selection,n))};(m=h||(h={}))[m.Br=0]="Br",m[m.Block=1]="Block",m[m.Wrap=2]="Wrap",m[m.Eol=3]="Eol";let DC=(e,t)=>e===p.Backwards?e_(t):t,Dx=(e,t,r)=>e===p.Forwards?t.next(r):t.prev(r),Dw=(e,t,r,n)=>oD(n.getNode(t===p.Forwards))?h.Br:!1===c4(r,n)?h.Block:h.Wrap,DE=(e,t,r,n)=>{let o=mv(r),a=n,l=[];for(;a;){let n=Dx(t,o,a);if(!n)break;if(oD(n.getNode(!1))){if(t===p.Forwards)return{positions:DC(t,l).concat([n]),breakType:h.Br,breakAt:ea.some(n)};return{positions:DC(t,l),breakType:h.Br,breakAt:ea.some(n)}}if(!n.isVisible()){a=n;continue}if(e(a,n)){let e=Dw(r,t,a,n);return{positions:DC(t,l),breakType:e,breakAt:ea.some(n)}}l.push(n),a=n}return{positions:DC(t,l),breakType:h.Eol,breakAt:ea.none()}},Dk=(e,t,r,n)=>t(r,n).breakAt.map(n=>{let o=t(r,n).positions;return e===p.Backwards?o.concat(n):[n].concat(o)}).getOr([]),DS=(e,t)=>ey(e,(e,r)=>e.fold(()=>ea.some(r),n=>t6(eO(n.getClientRects()),eO(r.getClientRects()),(e,o)=>{let a=Math.abs(t-e.left);return Math.abs(t-o.left)<=a?r:n}).or(e)),ea.none()),D_=(e,t)=>eO(t.getClientRects()).bind(t=>DS(e,t.left)),DN=J(DE,sf.isAbove,-1),DD=J(DE,sf.isBelow,1),DR=J(Dk,-1,DN),DA=J(Dk,1,DD),DO=(e,t)=>DN(e,t).breakAt.isNone(),DT=(e,t)=>DD(e,t).breakAt.isNone(),DB=e=>mT(e).map(t=>[t].concat(DD(e,t).positions)).getOr([]),DP=e=>mB(e).map(t=>DN(e,t).positions.concat(t)).getOr([]),DL=(e,t)=>D_(DR(e,t),t),DF=(e,t)=>D_(DA(e,t),t),DM=(e,t)=>Math.abs(e.left-t),DI=(e,t)=>Math.abs(e.right-t),DU=e=>eY(e,"node"),Dz=(e,t)=>e3(e,(e,r)=>{let n=Math.min(DM(e,t),DI(e,t)),o=Math.min(DM(r,t),DI(r,t));return o===n&&DU(r)&&oO(r.node)||o<n?r:e}),Dj=e=>{let t=t=>ef(t,t=>{let r=iK(t);return r.node=e,r});if(ou(e))return t(e.getClientRects());if(!ow(e))return[];{let r=e.ownerDocument.createRange();return r.setStart(e,0),r.setEnd(e,e.data.length),t(r.getClientRects())}},DH=e=>ek(e,Dj);(u=b||(b={}))[u.Up=-1]="Up",u[u.Down=1]="Down";let D$=(e,t,r,n)=>{let o=n;for(;o=c5(o,e,aC,t);)if(r(o))return},Dq=(e,t,r,n,o,a)=>{let l=0,i=[],s=n=>{let a=DH([n]);-1===e&&(a=a.reverse());for(let e=0;e<a.length;e++){let n=a[e];if(!r(n,d)){if(i.length>0&&t(n,e5(i))&&l++,n.line=l,o(n))return!0;i.push(n)}}return!1},d=e5(a.getClientRects());if(!d)return i;let c=a.getNode();return c&&(s(c),D$(e,n,s,c)),i},DV=(e,t)=>t.line>e,DW=(e,t)=>t.line===e,DK=J(Dq,b.Up,iQ,iJ),DG=J(Dq,b.Down,iJ,iQ),DY=e=>e5(e.getClientRects()),DX=(e,t,r,n)=>{let o,a,l,i;let s=mv(t),d=[],c=0;1===e?(o=s.next,a=iJ,l=iQ,i=sf.after(n)):(o=s.prev,a=iQ,l=iJ,i=sf.before(n));let m=DY(i);do{if(!i.isVisible())continue;let e=DY(i);if(l(e,m))continue;d.length>0&&a(e,e5(d))&&c++;let t=iK(e);if(t.position=i,t.line=c,r(t))break;d.push(t)}while(i=o(i));return d},DQ=e=>t=>DV(e,t),DJ=e=>t=>DW(e,t),DZ=(e,t)=>{e.selection.setRng(t),gJ(e,e.selection.getRng())},D0=(e,t,r)=>ea.some(Ny(e,t,r)),D1=(e,t,r,n,o,a)=>{let l=t===p.Forwards,i=mv(e.getBody()),s=J(mc,l?i.next:i.prev),d=l?n:o;if(!r.collapsed){let n=i8(r);if(a(n))return Np(t,e,n,t===p.Backwards,!1);if(NN(e)){let e=r.cloneRange();return e.collapse(t===p.Backwards),ea.from(e)}}let c=mi(t,e.getBody(),r);if(d(c))return Nb(e,c.getNode(!l));let m=s(c),u=am(r);if(!m)return u?ea.some(r):ea.none();if(d(m=bQ(l,m)))return Np(t,e,m.getNode(!l),l,!1);let f=s(m);return f&&d(f)&&mm(m,f)?Np(t,e,f.getNode(!l),l,!1):u?D0(e,m.toRange(),!1):ea.none()},D2=(e,t,r,n,o,a)=>{let l;let i=mi(t,e.getBody(),r),s=e5(i.getClientRects()),d=t===b.Down,c=e.getBody();if(!s)return ea.none();if(NN(e)){let e=d?sf.fromRangeEnd(r):sf.fromRangeStart(r);return(d?DF:DL)(c,e).orThunk(()=>ea.from(e)).map(e=>e.toRange())}let m=eb((d?DG:DK)(c,DQ(1),i),DJ(1)),u=s.left,f=Dz(m,u);if(f&&a(f.node)){let r=Math.abs(u-f.left),n=Math.abs(u-f.right);return Np(t,e,f.node,r<n,!1)}if(l=n(i)?i.getNode():o(i)?i.getNode(!0):i8(r)){let r=DX(t,c,DQ(1),l),n=Dz(eb(r,DJ(1)),u);if(n||(n=e5(eb(r,DJ(0)))))return D0(e,n.position.toRange(),!1)}return 0===m.length?D3(e,d).filter(d?o:n).map(t=>Ny(e,t.toRange(),!1)):ea.none()},D3=(e,t)=>{let r=e.selection.getRng(),n=t?sf.fromRangeEnd(r):sf.fromRangeStart(r),o=c6(n.container(),e.getBody());return t?eT(DD(o,n).positions):eO(DN(o,n).positions)},D8=(e,t,r)=>D3(e,t).filter(r).exists(t=>(e.selection.setRng(t.toRange()),!0)),D5=(e,t)=>{let r=e.dom.createRng();r.setStart(t.container(),t.offset()),r.setEnd(t.container(),t.offset()),e.selection.setRng(r)},D6=(e,t)=>{e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")},D9=(e,t,r)=>N5(t,r).map(t=>(D5(e,t),r)),D4=(e,t,r)=>{let n=sf.fromRangeStart(e);if(e.collapsed)return n;{let o=sf.fromRangeEnd(e);return r?mO(t,o).getOr(o):mA(t,n).getOr(n)}},D7=(e,t,r)=>{let n=e.getBody(),o=D4(e.selection.getRng(),n,r);return Dh(r,J(bV,e),n,o).bind(r=>D9(e,t,r))},Re=(e,t,r)=>{let n=eb(ef(oi(rz.fromDom(t.getRoot()),'*[data-mce-selected="inline-boundary"]'),e=>e.dom),e),o=eb(r,e);eg(eN(n,o),J(D6,!1)),eg(eN(o,n),J(D6,!0))},Rt=(e,t)=>{let r=t.get();if(e.selection.isCollapsed()&&!e.composing&&r){let n=sf.fromRangeStart(e.selection.getRng());sf.isTextPosition(n)&&!bX(n)&&(D5(e,cK(r,n)),t.set(null))}},Rr=(e,t,r,n)=>{t.selection.isCollapsed()&&eg(eb(n,e),n=>{let o=sf.fromRangeStart(t.selection.getRng());Dl(e,t.getBody(),o).bind(e=>D9(t,r,e))})},Rn=(e,t,r)=>!!dV(e)&&D7(e,t,r).isSome(),Ro=(e,t,r)=>!!dV(t)&&Dy(e,t),Ra=e=>{let t=ia(null),r=J(bV,e);return e.on("NodeChange",n=>{dV(e)&&(Re(r,e.dom,n.parents),Rt(e,t),Rr(r,e,t,n.parents))}),t},Rl=J(Ro,!0),Ri=J(Ro,!1),Rs=(e,t,r)=>{if(!dV(e))return!1;{let n=D3(e,t).getOrThunk(()=>{let r=e.selection.getRng();return t?sf.fromRangeEnd(r):sf.fromRangeStart(r)});return Dl(J(bV,e),e.getBody(),n).exists(t=>N5(r,Dd(t)).exists(t=>(D5(e,t),!0)))}},Rd=(e,t)=>{let r=document.createRange();return r.setStart(e.container(),e.offset()),r.setEnd(t.container(),t.offset()),r},Rc=e=>t6(mT(e),mB(e),(t,r)=>{let n=bQ(!0,t),o=bQ(!1,r);return mA(e,n).forall(e=>e.isEqual(o))}).getOr(!0),Rm=(e,t)=>r=>N5(t,r).map(t=>()=>D5(e,t)),Ru=(e,t,r,n)=>{let o=e.getBody(),a=J(bV,e);e.undoManager.ignore(()=>{e.selection.setRng(Rd(r,n)),b2(e),Dl(a,o,sf.fromRangeStart(e.selection.getRng())).map(Dc).bind(Rm(e,t)).each(er)}),e.nodeChanged()},Rf=(e,t)=>c9(t,e)||e,Rg=(e,t,r,n)=>{let o=Rf(e.getBody(),n.container()),a=J(bV,e),l=Dl(a,o,n);return l.bind(e=>r?e.fold(Y(ea.some(Dc(e))),ea.none,Y(ea.some(Dd(e))),ea.none):e.fold(ea.none,Y(ea.some(Dd(e))),ea.none,Y(ea.some(Dc(e))))).map(Rm(e,t)).getOrThunk(()=>{let i=mN(r,o,n),s=i.bind(e=>Dl(a,o,e));return t6(l,s,()=>bG(a,o,n).bind(t=>Rc(t)?ea.some(()=>{bH(e,r,rz.fromDom(t))}):ea.none())).getOrThunk(()=>s.bind(()=>i.map(o=>()=>{r?Ru(e,t,n,o):Ru(e,t,o,n)})))})},Rp=(e,t,r)=>{if(e.selection.isCollapsed()&&dV(e)){let n=sf.fromRangeStart(e.selection.getRng());return Rg(e,t,r,n)}return ea.none()},Rh=e=>ne(e)>1,Rb=(e,t)=>{let r=rz.fromDom(e.getBody()),n=hH(rz.fromDom(e.selection.getStart()),r);return ew(n,t).fold(Y(n),e=>n.slice(0,e))},Rv=e=>1===ne(e),Ry=e=>Rb(e,e=>oV(e)||Rh(e)),RC=e=>Rb(e,oV),Rx=(e,t)=>{let r=J(Cx,e);return ek(t,e=>r(e)?[e.dom]:[])},Rw=e=>{let t=RC(e);return Rx(e,t)},RE=(e,t,r,n)=>{let o=Rx(t,n);if(0===o.length)bH(t,e,r);else{let e=Cy(r.dom,o);t.selection.setRng(e.toRange())}},Rk=(e,t)=>{let r=eb(Ry(e),Rv);return eT(r).bind(n=>b4(t,sf.fromRangeStart(e.selection.getRng()),n.dom)&&!Cw(n)?ea.some(()=>RE(t,e,n,r)):ea.none())},RS=(e,t)=>{let r=t.parentElement;return oD(t)&&!I(r)&&e.dom.isEmpty(r)},R_=e=>Cw(rz.fromDom(e)),RN=(e,t)=>{let r=e.selection.getStart(),n=RS(e,r)||R_(r)?Cy(r,t):CC(e.selection.getRng(),t);e.selection.setRng(n.toRange())},RD=(e,t)=>{let r=eN(t,Rw(e));r.length>0&&RN(e,r)},RR=e=>ow(e.startContainer),RA=e=>0===e.startOffset&&RR(e),RO=(e,t)=>{let r=t.startContainer.parentElement;return!I(r)&&Cx(e,rz.fromDom(r))},RT=e=>{let t=e.startContainer.parentNode,r=e.endContainer.parentNode;return!I(t)&&!I(r)&&t.isEqualNode(r)},RB=e=>{let t=e.endContainer;return e.endOffset===(ow(t)?t.length:t.childNodes.length)},RP=e=>RT(e)&&RB(e),RL=e=>!e.endContainer.isEqualNode(e.commonAncestorContainer),RF=e=>RP(e)||RL(e),RM=e=>{let t=e.selection.getRng();return RA(t)&&RO(e,t)&&RF(t)},RI=e=>{if(!RM(e))return ea.none();{let t=Rw(e);return ea.some(()=>{b2(e),RD(e,t)})}},RU=(e,t)=>e.selection.isCollapsed()?Rk(e,t):RI(e),Rz=e=>yX(e,e=>mL(e.dom),oV),Rj=e=>Rz(rz.fromDom(e.selection.getStart())),RH=e=>{let t=e.selection.getRng();return t.collapsed&&(RR(t)||e.dom.isEmpty(t.startContainer))&&!Rj(e)},R$=e=>(RH(e)&&RN(e,[]),!0),Rq=(e,t,r)=>H(r)?ea.some(()=>{e._selectionOverrides.hideFakeCaret(),bH(e,t,rz.fromDom(r))}):ea.none(),RV=(e,t)=>{let r=t?hB:hP,n=mi(t?p.Forwards:p.Backwards,e.getBody(),e.selection.getRng());return r(n)?Rq(e,t,n.getNode(!t)):ea.from(bQ(t,n)).filter(e=>r(e)&&mm(n,e)).bind(r=>Rq(e,t,r.getNode(!t)))},RW=(e,t)=>{let r=e.selection.getNode();return oP(r)?Rq(e,t,r):ea.none()},RK=(e,t)=>e.selection.isCollapsed()?RV(e,t):RW(e,t),RG=e=>nh(e,e=>oA(e.dom)||oO(e.dom)).exists(e=>oA(e.dom)),RY=e=>tC(null!=e?e:"").getOr(0),RX=(e,t)=>(e||oW(t)?"margin":"padding")+("rtl"===nO(t,"direction")?"-right":"-left"),RQ=(e,t,r,n,o,a)=>{let l=RX(r,rz.fromDom(a)),i=RY(e.getStyle(a,l));if("outdent"===t){let t=Math.max(0,i-n);e.setStyle(a,l,t?t+o:"")}else e.setStyle(a,l,i+n+o)},RJ=(e,t)=>eS(t,t=>{let r=RX(dR(e),t),n=nB(t,r).map(RY).getOr(0);return"false"!==e.dom.getContentEditable(t.dom)&&n>0}),RZ=e=>{let t=R2(e);return!e.mode.isReadOnly()&&(t.length>1||RJ(e,t))},R0=e=>oX(e)||oQ(e),R1=e=>rJ(e).exists(R0),R2=e=>eb(nG(e.selection.getSelectedBlocks()),e=>!R0(e)&&!R1(e)&&RG(e)),R3=(e,t)=>{var r,n;let{dom:o}=e,a=dA(e),l=null!==(n=null===(r=/[a-z%]+$/i.exec(a))||void 0===r?void 0:r[0])&&void 0!==n?n:"px",i=RY(a),s=dR(e);eg(R2(e),e=>{RQ(o,t,s,i,l,e.dom)})},R8=e=>R3(e,"indent"),R5=e=>R3(e,"outdent"),R6=e=>{if(e.selection.isCollapsed()&&RZ(e)){let t=e.dom,r=e.selection.getRng(),n=sf.fromRangeStart(r),o=t.getParent(r.startContainer,t.isBlock);if(null!==o&&hK(rz.fromDom(o),n))return ea.some(()=>R5(e))}return ea.none()},R9=(e,t,r)=>eP([R6,NW,NS,(e,r)=>Rp(e,t,r),Ni,vY,NG,RK,Ng,RU],t=>t(e,r)).filter(t=>e.selection.isEditable()),R4=(e,t)=>{R9(e,t,!1).fold(()=>{b2(e),b9(e)},er)},R7=(e,t)=>{R9(e,t,!0).fold(()=>b3(e),er)},Ae=(e,t)=>{e.addCommand("delete",()=>{R4(e,t)}),e.addCommand("forwardDelete",()=>{R7(e,t)})},At=e=>void 0===e.touches||1!==e.touches.length?ea.none():ea.some(e.touches[0]),Ar=(e,t)=>{let r=Math.abs(e.clientX-t.x),n=Math.abs(e.clientY-t.y);return r>5||n>5},An=e=>{let t=ib(),r=ia(!1),n=iy(t=>{e.dispatch("longpress",{...t,type:"longpress"}),r.set(!0)},400);e.on("touchstart",e=>{At(e).each(o=>{n.cancel();let a={x:o.clientX,y:o.clientY,target:e.target};n.throttle(e),r.set(!1),t.set(a)})},!0),e.on("touchmove",o=>{n.cancel(),At(o).each(n=>{t.on(o=>{Ar(n,o)&&(t.clear(),r.set(!1),e.dispatch("longpresscancel"))})})},!0),e.on("touchend touchcancel",o=>{n.cancel(),"touchcancel"!==o.type&&t.get().filter(e=>e.target.isEqualNode(o.target)).each(()=>{r.get()?o.preventDefault():e.dispatch("tap",{...o,type:"tap"})})},!0)},Ao=(e,t)=>eG(e,t.nodeName),Aa=(e,t)=>!!ow(t)||!!ou(t)&&!Ao(e.getBlockElements(),t)&&!m8(t)&&!aJ(e,t),Al=(e,t,r)=>eu(hj(rz.fromDom(r),rz.fromDom(t)),t=>Ao(e,t.dom)),Ai=(e,t)=>!!(ow(t)&&(0===t.data.length||/^\s+$/.test(t.data)&&(!t.nextSibling||Ao(e,t.nextSibling)))),As=e=>e.dom.create(dd(e),dc(e)),Ad=e=>{let t,r;let n=e.dom,o=e.selection,a=e.schema,l=a.getBlockElements(),i=o.getStart(),s=e.getBody(),d=!1,c=dd(e);if(!i||!ou(i))return;let m=s.nodeName.toLowerCase();if(!a.isValidChild(m,c.toLowerCase())||Al(l,s,i))return;let u=o.getRng(),{startContainer:f,startOffset:g,endContainer:p,endOffset:h}=u,b=pT(e),v=s.firstChild;for(;v;)if(ou(v)&&aK(a,v),Aa(a,v)){if(Ai(l,v)){r=v,v=v.nextSibling,n.remove(r);continue}t||(t=As(e),s.insertBefore(t,v),d=!0),r=v,v=v.nextSibling,t.appendChild(r)}else t=null,v=v.nextSibling;d&&b&&(u.setStart(f,g),u.setEnd(p,h),o.setRng(u),e.nodeChanged())},Ac=(e,t,r)=>{let n=rz.fromDom(As(e)),o=o5();nz(n,o),r(t,n);let a=document.createRange();return a.setStartBefore(o.dom),a.setEndBefore(o.dom),a},Am=e=>{e.on("NodeChange",J(Ad,e))},Au=e=>t=>-1!==(" "+t.attr("class")+" ").indexOf(e),Af=(e,t,r)=>function(n){let o=arguments,a=o[o.length-2],l=a>0?t.charAt(a-1):"";if('"'===l)return n;if(">"===l){let e=t.lastIndexOf("<",a);if(-1!==e&&-1!==t.substring(e,a).indexOf('contenteditable="false"'))return n}return'<span class="'+r+'" data-mce-content="'+e.dom.encode(o[0])+'">'+e.dom.encode("string"==typeof o[1]?o[1]:o[0])+"</span>"},Ag=(e,t,r)=>{let n=t.length,o=r.content;if("raw"!==r.format){for(;n--;)o=o.replace(t[n],Af(e,o,ck(e)));r.content=o}},Ap=e=>{let t="contenteditable",r=" "+t2.trim(cS(e))+" ",n=" "+t2.trim(ck(e))+" ",o=Au(r),a=Au(n),l=c_(e);l.length>0&&e.on("BeforeSetContent",t=>{Ag(e,l,t)}),e.parser.addAttributeFilter("class",e=>{let r=e.length;for(;r--;){let n=e[r];o(n)?n.attr(t,"true"):a(n)&&n.attr(t,"false")}}),e.serializer.addAttributeFilter(t,e=>{let r=e.length;for(;r--;){let n=e[r];(o(n)||a(n))&&(l.length>0&&n.attr("data-mce-content")?(n.name="#text",n.type=3,n.raw=!0,n.value=n.attr("data-mce-content")):n.attr(t,null))}})},Ah=e=>nx(rz.fromDom(e.getBody()),"*[data-mce-caret]").map(e=>e.dom).getOrNull(),Ab=(e,t)=>{t.hasAttribute("data-mce-caret")&&(ac(t),e.selection.setRng(e.selection.getRng()),e.selection.scrollIntoView(t))},Av=(e,t)=>{let r=Ah(e);if(r){if("compositionstart"===t.type){t.preventDefault(),t.stopPropagation(),Ab(e,r);return}ar(r)&&(Ab(e,r),e.undoManager.add())}},Ay=e=>{e.on("keyup compositionstart",J(Av,e))},AC=(e,t,r)=>D1(t,e,r,hM,hI,oO),Ax=(e,t,r)=>D2(t,e,r,e=>hM(e)||hL(e),e=>hI(e)||hF(e),oO),Aw=e=>{let t=e.dom.create(dd(e));return t.innerHTML='<br data-mce-bogus="1">',t},AE=(e,t,r)=>{let n=mv(e.getBody()),o=J(mc,1===t?n.next:n.prev);if(r.collapsed){let n=e.dom.getParent(r.startContainer,"PRE");if(!n)return;if(!o(sf.fromRangeStart(r))){let r=rz.fromDom(Aw(e));1===t?nI(rz.fromDom(n),r):nM(rz.fromDom(n),r),e.selection.select(r.dom,!0),e.selection.collapse()}}},Ak=(e,t)=>{let r=t?p.Forwards:p.Backwards,n=e.selection.getRng();return AC(r,e,n).orThunk(()=>(AE(e,r,n),ea.none()))},AS=(e,t)=>{let r=t?1:-1,n=e.selection.getRng();return Ax(r,e,n).orThunk(()=>(AE(e,r,n),ea.none()))},A_=(e,t)=>bW(t?e.getEnd(!0):e.getStart(!0))?!t:t,AN=(e,t)=>Ak(e,A_(e.selection,t)).exists(t=>(DZ(e,t),!0)),AD=(e,t)=>AS(e,t).exists(t=>(DZ(e,t),!0)),AR=(e,t)=>D8(e,t,t?hI:hM),AA=(e,t)=>N_(e,!t).map(r=>{let n=r.toRange(),o=e.selection.getRng();return t?n.setStart(o.startContainer,o.startOffset):n.setEnd(o.endContainer,o.endOffset),n}).exists(t=>(DZ(e,t),!0)),AO=e=>em(["figcaption"],ri(e)),AT=(e,t)=>{let r=J(rW,t);return nh(rz.fromDom(e.container()),oV,r).filter(AO)},AB=(e,t,r)=>t?DT(e.dom,r):DO(e.dom,r),AP=(e,t)=>{let r=rz.fromDom(e.getBody()),n=sf.fromRangeStart(e.selection.getRng());return AT(n,r).exists(()=>{if(!AB(r,t,n))return!1;{let n=Ac(e,r,t?nz:nU);return e.selection.setRng(n),!0}})},AL=(e,t)=>!!e.selection.isCollapsed()&&AP(e,t),AF=(e,t,r)=>{let n=e.selection.getRng(),o=sf.fromRangeStart(n);return!!(e.getBody().firstChild===t&&DO(r,o))&&(e.execCommand("InsertNewBlockBefore"),!0)},AM=(e,t)=>{let r=e.selection.getRng(),n=sf.fromRangeStart(r);return!!(e.getBody().lastChild===t&&DT(t,n))&&(e.execCommand("InsertNewBlockAfter"),!0)},AI=(e,t)=>t?ea.from(e.dom.getParent(e.selection.getNode(),"details")).map(t=>AM(e,t)).getOr(!1):ea.from(e.dom.getParent(e.selection.getNode(),"summary")).bind(t=>ea.from(e.dom.getParent(t,"details")).map(r=>AF(e,r,t))).getOr(!1),AU=(e,t)=>AI(e,t),Az={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0},Aj=e=>ef(e,e=>({...Az,...e})),AH=e=>ef(e,e=>({...Az,...e})),A$=(e,t)=>t.keyCode===e.keyCode&&t.shiftKey===e.shiftKey&&t.altKey===e.altKey&&t.ctrlKey===e.ctrlKey&&t.metaKey===e.metaKey,Aq=(e,t)=>ek(Aj(e),e=>A$(e,t)?[e]:[]),AV=(e,t)=>ek(AH(e),e=>A$(e,t)?[e]:[]),AW=(e,...t)=>()=>e.apply(null,t),AK=(e,t)=>ex(Aq(e,t),e=>e.action()),AG=(e,t)=>eP(AV(e,t),e=>e.action()),AY=(e,t)=>{let r=t?p.Forwards:p.Backwards,n=e.selection.getRng();return D1(e,r,n,hB,hP,oP).exists(t=>(DZ(e,t),!0))},AX=(e,t)=>{let r=e.selection.getRng();return D2(e,t?1:-1,r,hB,hP,oP).exists(t=>(DZ(e,t),!0))},AQ=(e,t)=>D8(e,t,t?hP:hB),AJ=sW([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),AZ={...AJ,none:e=>AJ.none(e)},A0=(e,t)=>A1(e,t,eo),A1=(e,t,r)=>ek(r6(e),e=>rH(e,t)?r(e)?[e]:[]:A1(e,t,r)),A2=(e,t,r=en)=>r(t)?ea.none():em(e,ri(t))?ea.some(t):nC(t,e.join(","),e=>rH(e,"table")||r(e)),A3=(e,t)=>A2(["td","th"],e,t),A8=e=>A0(e,"th,td"),A5=(e,t)=>nw(e,"table",t),A6=(e,t,r,n,o=eo)=>{let a=1===n;if(!a&&r<=0)return AZ.first(e[0]);if(a&&r>=e.length-1)return AZ.last(e[e.length-1]);{let a=r+n,l=e[a];return o(l)?AZ.middle(t,l):A6(e,t,a,n,o)}},A9=(e,t)=>A5(e,t).bind(t=>{let r=A8(t);return ew(r,t=>rW(e,t)).map(e=>({index:e,all:r}))}),A4=(e,t,r)=>A9(e,r).fold(()=>AZ.none(e),r=>A6(r.all,e,r.index,1,t)),A7=(e,t,r)=>A9(e,r).fold(()=>AZ.none(),r=>A6(r.all,e,r.index,-1,t)),Oe=(e,t)=>({left:e.left-t,top:e.top-t,right:e.right+2*t,bottom:e.bottom+2*t,width:e.width+t,height:e.height+t}),Ot=(e,t)=>ek(t,t=>{let r=Oe(iK(t.getBoundingClientRect()),-1);return[{x:r.left,y:e(r),cell:t},{x:r.right,y:e(r),cell:t}]}),Or=(e,t,r)=>ey(e,(e,n)=>e.fold(()=>ea.some(n),e=>{let o=Math.sqrt(Math.abs(e.x-t)+Math.abs(e.y-r)),a=Math.sqrt(Math.abs(n.x-t)+Math.abs(n.y-r));return ea.some(a<o?n:e)}),ea.none()),On=(e,t,r,n,o)=>Or(eb(Ot(e,oi(rz.fromDom(r),"td,th,caption").map(e=>e.dom)),e=>t(e,o)),n,o).map(e=>e.cell),Oo=J(On,e=>e.bottom,(e,t)=>e.y<t),Oa=J(On,e=>e.top,(e,t)=>e.y>t),Ol=(e,t)=>eO(t.getClientRects()).bind(t=>Oo(e,t.left,t.top)).bind(e=>D_(DP(e),t)),Oi=(e,t)=>eT(t.getClientRects()).bind(t=>Oa(e,t.left,t.top)).bind(e=>D_(DB(e),t)),Os=(e,t,r)=>r.breakAt.exists(r=>e(t,r).breakAt.isSome()),Od=e=>e.breakType===h.Wrap&&0===e.positions.length,Oc=e=>e.breakType===h.Br&&1===e.positions.length,Om=(e,t,r)=>{let n=e(t,r);return Od(n)||!oD(r.getNode())&&Oc(n)?!Os(e,t,n):n.breakAt.isNone()},Ou=J(Om,DN),Of=J(Om,DD),Og=(e,t,r)=>{let n=sf.fromRangeStart(t);return mR(!e,r).exists(e=>e.isEqual(n))},Op=(e,t,r,n)=>{let o=e.selection.getRng();return!!(cJ()&&Og(t,o,r))&&(Np(t?1:-1,e,r,!t,!1).each(t=>{DZ(e,t)}),!0)},Oh=(e,t,r)=>Ol(t,r).orThunk(()=>eO(r.getClientRects()).bind(r=>DS(DR(e,sf.before(t)),r.left))).getOr(sf.before(t)),Ob=(e,t,r)=>Oi(t,r).orThunk(()=>eO(r.getClientRects()).bind(r=>DS(DA(e,sf.after(t)),r.left))).getOr(sf.after(t)),Ov=(e,t)=>{let r=t.getNode(e);return oy(r)?ea.some(r):ea.none()},Oy=(e,t,r)=>{t.undoManager.transact(()=>{let n=Ac(t,rz.fromDom(r),e?nI:nM);DZ(t,n)})},OC=(e,t,r)=>{let n=t?Ov(!0,r):Ov(!1,r),o=!1===t;n.fold(()=>DZ(e,r.toRange()),n=>mR(o,e.getBody()).filter(e=>e.isEqual(r)).fold(()=>DZ(e,r.toRange()),r=>Oy(t,e,n)))},Ox=(e,t,r,n)=>{let o=e.selection.getRng(),a=sf.fromRangeStart(o),l=e.getBody();return!t&&Ou(n,a)?(OC(e,t,Oh(l,r,a)),!0):!!(t&&Of(n,a))&&(OC(e,t,Ob(l,r,a)),!0)},Ow=(e,t,r)=>ea.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind(n=>ea.from(e.dom.getParent(n,"table")).map(o=>r(e,t,o,n))).getOr(!1),OE=(e,t)=>Ow(e,t,Op),Ok=(e,t)=>Ow(e,t,Ox),OS=e=>gi(ge(e,0,e,0)),O_=(e,t,r)=>r.fold(ea.none,ea.none,(e,t)=>pX(t).map(e=>OS(e)),r=>(e.execCommand("mceTableInsertRowAfter"),ON(e,t,r))),ON=(e,t,r)=>O_(e,t,A4(r,nk)),OD=(e,t,r)=>O_(e,t,A7(r,nk)),OR=(e,t)=>{let r=["table","li","dl"],n=rz.fromDom(e.getBody()),o=e=>{let t=ri(e);return rW(e,n)||em(r,t)},a=e.selection.getRng();return A3(rz.fromDom(t?a.endContainer:a.startContainer),o).map(r=>(A5(r,o).each(t=>{e.model.table.clearSelectedCells(t.dom)}),e.selection.collapse(!t),(t?ON:OD)(e,o,r).each(t=>{e.selection.setRng(t)}),!0)).getOr(!1)},OA=(e,t,r)=>{let n=tJ.os.isMacOS()||tJ.os.isiOS();AK([{keyCode:fz.RIGHT,action:AW(AN,e,!0)},{keyCode:fz.LEFT,action:AW(AN,e,!1)},{keyCode:fz.UP,action:AW(AD,e,!1)},{keyCode:fz.DOWN,action:AW(AD,e,!0)},...n?[{keyCode:fz.UP,action:AW(AA,e,!1),metaKey:!0,shiftKey:!0},{keyCode:fz.DOWN,action:AW(AA,e,!0),metaKey:!0,shiftKey:!0}]:[],{keyCode:fz.RIGHT,action:AW(OE,e,!0)},{keyCode:fz.LEFT,action:AW(OE,e,!1)},{keyCode:fz.UP,action:AW(Ok,e,!1)},{keyCode:fz.DOWN,action:AW(Ok,e,!0)},{keyCode:fz.UP,action:AW(Ok,e,!1)},{keyCode:fz.UP,action:AW(AU,e,!1)},{keyCode:fz.DOWN,action:AW(AU,e,!0)},{keyCode:fz.RIGHT,action:AW(AY,e,!0)},{keyCode:fz.LEFT,action:AW(AY,e,!1)},{keyCode:fz.UP,action:AW(AX,e,!1)},{keyCode:fz.DOWN,action:AW(AX,e,!0)},{keyCode:fz.RIGHT,action:AW(Rn,e,t,!0)},{keyCode:fz.LEFT,action:AW(Rn,e,t,!1)},{keyCode:fz.RIGHT,ctrlKey:!n,altKey:n,action:AW(Rl,e,t)},{keyCode:fz.LEFT,ctrlKey:!n,altKey:n,action:AW(Ri,e,t)},{keyCode:fz.UP,action:AW(AL,e,!1)},{keyCode:fz.DOWN,action:AW(AL,e,!0)}],r).each(e=>{r.preventDefault()})},OO=(e,t)=>{e.on("keydown",r=>{r.isDefaultPrevented()||OA(e,t,r)})},OT=(e,t)=>({container:e,offset:t}),OB=it.DOM,OP=e=>t=>e===t?-1:0,OL=e=>t=>e.isBlock(t)||em(["BR","IMG","HR","INPUT"],t.nodeName)||"false"===e.getContentEditable(t),OF=(e,t,r)=>{if(ow(e)&&t>=0)return ea.some(OT(e,t));{let n=iV(OB);return ea.from(n.backwards(e,t,OP(e),r)).map(e=>OT(e.container,e.container.data.length))}},OM=(e,t,r)=>{if(ow(e)&&t>=e.length)return ea.some(OT(e,t));{let n=iV(OB);return ea.from(n.forwards(e,t,OP(e),r)).map(e=>OT(e.container,0))}},OI=(e,t,r)=>{if(!ow(e))return ea.none();let n=e.data;if(t>=0&&t<=n.length)return ea.some(OT(e,t));{let n=iV(OB);return ea.from(n.backwards(e,t,OP(e),r)).bind(e=>{let n=e.container.data;return OI(e.container,t+n.length,r)})}},OU=(e,t,r)=>{if(!ow(e))return ea.none();let n=e.data;if(t<=n.length)return ea.some(OT(e,t));{let o=iV(OB);return ea.from(o.forwards(e,t,OP(e),r)).bind(e=>OU(e.container,t-n.length,r))}},Oz=(e,t,r,n,o)=>{let a=iV(e,OL(e));return ea.from(a.backwards(t,r,n,o))},Oj=e=>e.collapsed&&ow(e.startContainer),OH=e=>o4(e.toString().replace(/\u00A0/g," ")),O$=e=>""!==e&&-1!==" \xa0\f\n\r	\v".indexOf(e),Oq=(e,t)=>e.substring(t.length),OV=(e,t,r)=>{let n;let o=r.charAt(0);for(n=t-1;n>=0;n--){let a=e.charAt(n);if(O$(a))return ea.none();if(o===a&&tc(e,r,n,t))break}return ea.some(n)},OW=(e,t,r,n=0)=>{if(!Oj(t))return ea.none();let o={text:"",offset:0},a=e.getParent(t.startContainer,e.isBlock)||e.getRoot();return Oz(e,t.startContainer,t.startOffset,(e,t,n)=>(o.text=n+o.text,o.offset+=t,OV(o.text,o.offset,r).getOr(t)),a).bind(e=>{let o=t.cloneRange();if(o.setStart(e.container,e.offset),o.setEnd(t.endContainer,t.endOffset),o.collapsed)return ea.none();let a=OH(o);return 0!==a.lastIndexOf(r)||Oq(a,r).length<n?ea.none():ea.some({text:Oq(a,r),range:o,trigger:r})})},OK=(e,t,r,n=0)=>p1(rz.fromDom(t.startContainer)).fold(()=>OW(e,t,r,n),t=>{let n=e.createRng();n.selectNode(t.dom);let o=OH(n);return ea.some({range:n,text:Oq(o,r),trigger:r})}),OG=e=>3===e.nodeType,OY=e=>1===e.nodeType,OX=e=>{if(OG(e))return OT(e,e.data.length);{let t=e.childNodes;return t.length>0?OX(t[t.length-1]):OT(e,t.length)}},OQ=(e,t)=>{let r=e.childNodes;return r.length>0&&t<r.length?OQ(r[t],0):r.length>0&&OY(e)&&r.length===t?OX(r[r.length-1]):OT(e,t)},OJ=(e,t)=>{var r;let n=null!==(r=e.getParent(t.container,e.isBlock))&&void 0!==r?r:e.getRoot();return Oz(e,t.container,t.offset,(e,t)=>0===t?-1:t,n).filter(e=>!O$(e.container.data.charAt(e.offset-1))).isSome()},OZ=e=>t=>!OJ(e,OQ(t.startContainer,t.startOffset)),O0=(e,t,r)=>eP(r.triggers,r=>OK(e,t,r)),O1=(e,t)=>{let r=t(),n=e.selection.getRng();return O0(e.dom,n,r).bind(r=>O2(e,t,r))},O2=(e,t,r,n={})=>{var o;let a=t(),l=null!==(o=e.selection.getRng().startContainer.nodeValue)&&void 0!==o?o:"",i=eb(a.lookupByTrigger(r.trigger),t=>r.text.length>=t.minChars&&t.matches.getOrThunk(()=>OZ(e.dom))(r.range,l,r.text));if(0===i.length)return ea.none();let s=Promise.all(ef(i,e=>e.fetch(r.text,e.maxResults,n).then(t=>({matchText:r.text,items:t,columns:e.columns,onAction:e.onAction,highlightOn:e.highlightOn}))));return ea.some({lookupData:s,context:r})};(f=v||(v={}))[f.Error=0]="Error",f[f.Value=1]="Value";let O3=(e,t,r)=>e.stype===v.Error?t(e.serror):r(e.svalue),O8={toResult:e=>O3(e,sV.error,sV.value),svalue:e=>({stype:v.Value,svalue:e}),partition:e=>{let t=[],r=[];return eg(e,e=>{O3(e,e=>r.push(e),e=>t.push(e))}),{values:t,errors:r}},serror:e=>({stype:v.Error,serror:e}),bindError:(e,t)=>e.stype===v.Error?t(e.serror):e,map:(e,t)=>e.stype===v.Value?{stype:v.Value,svalue:t(e.svalue)}:e,mapError:(e,t)=>e.stype===v.Error?{stype:v.Error,serror:t(e.serror)}:e,fold:O3},O5=e=>L(e)&&eF(e).length>100?" removed due to size":JSON.stringify(e,null,2),O6=e=>ef(e.length>10?e.slice(0,10).concat([{path:[],getErrorInfo:Y("... (only showing first ten failures)")}]):e,e=>"Failed path: ("+e.path.join(" > ")+")\n"+e.getErrorInfo()),O9=(e,t)=>O8.serror([{path:e,getErrorInfo:t}]),O4=(e,t,r)=>O9(e,()=>'Could not find valid *required* value for "'+t+'" in '+O5(r)),O7=(e,t)=>O9(e,()=>'Choice schema did not contain choice key: "'+t+'"'),Te=(e,t,r)=>O9(e,()=>'The chosen schema: "'+r+'" did not exist in branches: '+O5(t)),Tt=(e,t)=>O9(e,Y(t)),Tr=(e,t,r,n)=>eK(r,n).fold(()=>Te(e,r,n),r=>r.extract(e.concat(["branch: "+n]),t)),Tn=(e,t)=>({extract:(r,n)=>eK(n,e).fold(()=>O7(r,e),e=>Tr(r,n,t,e)),toString:()=>"chooseOn("+e+"). Possible values: "+eF(t)}),To=e=>(...t)=>{if(0===t.length)throw Error("Can't merge zero objects");let r={};for(let n=0;n<t.length;n++){let o=t[n];for(let t in o)eG(o,t)&&(r[t]=e(r[t],o[t]))}return r},Ta=To((e,t)=>F(e)&&F(t)?Ta(e,t):t),Tl=(To((e,t)=>t),()=>({tag:"required",process:{}})),Ti=e=>({tag:"defaultedThunk",process:e}),Ts=e=>Ti(Y(e)),Td=()=>({tag:"option",process:{}}),Tc=e=>K(O8.serror,eE)(e),Tm=e=>{let t=O8.partition(e);return t.errors.length>0?Tc(t.errors):O8.svalue(t.values)},Tu=(e,t,r)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return r(e.newKey,e.instantiator)}},Tf=e=>({extract:(t,r)=>O8.bindError(e(r),e=>Tt(t,e)),toString:Y("val")}),Tg=Tf(O8.svalue),Tp=(e,t,r,n)=>eK(t,r).fold(()=>O4(e,r,t),n),Th=(e,t,r,n)=>n(eK(e,t).getOrThunk(()=>r(e))),Tb=(e,t,r)=>r(eK(e,t)),Tv=(e,t,r,n)=>n(eK(e,t).map(t=>!0===t?r(e):t)),Ty=(e,t,r,n,o)=>{let a=e=>o.extract(t.concat([n]),e),l=e=>e.fold(()=>O8.svalue(ea.none()),e=>{let r=o.extract(t.concat([n]),e);return O8.map(r,ea.some)});switch(e.tag){case"required":return Tp(t,r,n,a);case"defaultedThunk":return Th(r,n,e.process,a);case"option":return Tb(r,n,l);case"defaultedOptionThunk":return Tv(r,n,e.process,l);case"mergeWithThunk":return Th(r,n,Y({}),t=>a(Ta(e.process(r),t)))}},TC=(e,t,r)=>{let n={},o=[];for(let a of r)Tu(a,(r,a,l,i)=>{let s=Ty(l,e,t,r,i);O8.fold(s,e=>{o.push(...e)},e=>{n[a]=e})},(e,r)=>{n[e]=r(t)});return o.length>0?O8.serror(o):O8.svalue(n)},Tx=e=>({extract:(t,r)=>TC(t,r,e),toString:()=>"obj{\n"+ef(e,e=>Tu(e,(e,t,r,n)=>e+" -> "+n.toString(),(e,t)=>"state("+e+")")).join("\n")+"}"}),Tw=e=>({extract:(t,r)=>Tm(ef(r,(r,n)=>e.extract(t.concat(["["+n+"]"]),r))),toString:()=>"array("+e.toString()+")"}),TE=e=>Tf(t=>e(t).fold(O8.serror,O8.svalue)),Tk=(e,t,r)=>{let n=t.extract([e],r);return O8.mapError(n,e=>({input:r,errors:e}))},TS=(e,t,r)=>O8.toResult(Tk(e,t,r)),T_=e=>"Errors: \n"+O6(e.errors).join("\n")+"\n\nInput object: "+O5(e.input),TN=(e,t)=>Tn(e,eU(t,Tx)),TD=Y(Tg),TR=(e,t)=>Tf(r=>{let n=typeof r;return e(r)?O8.svalue(r):O8.serror(`Expected type: ${t} but got: ${n}`)}),TA=TR(q,"number"),TO=TR(P,"string"),TT=TR(U,"boolean"),TB=TR($,"function"),TP=(e,t,r,n)=>({tag:"field",key:e,newKey:t,presence:r,prop:n}),TL=(e,t)=>({tag:"custom",newKey:e,instantiator:t}),TF=e=>TE(t=>em(e,t)?sV.value(t):sV.error(`Unsupported value: "${t}", choose one of "${e.join(", ")}".`)),TM=(e,t)=>TP(e,e,Tl(),t),TI=e=>TM(e,TO),TU=e=>TM(e,TB),Tz=(e,t)=>TP(e,e,Td(),t),Tj=e=>Tz(e,TO),TH=(e,t,r)=>TP(e,e,Ts(t),r),T$=(e,t)=>TH(e,t,TA),Tq=(e,t)=>TH(e,t,TO),TV=(e,t,r)=>TH(e,t,TF(r)),TW=(e,t)=>TH(e,t,TT),TK=(e,t)=>TH(e,t,TB),TG=TI("type"),TY=TU("fetch"),TX=TU("onAction"),TQ=TK("onSetup",()=>W),TJ=Tj("text"),TZ=Tj("icon"),T0=Tj("tooltip"),T1=Tj("label"),T2=TW("active",!1),T3=TW("enabled",!0),T8=TW("primary",!1),T5=e=>Tq("type",e),T6=Tx([TG,TI("trigger"),T$("minChars",1),TP(i="columns",i,Ts(1),TD()),T$("maxResults",10),Tz("matches",TB),TY,TX,TH("highlightOn",[],Tw(TO))]),T9=e=>TS("Autocompleter",T6,{trigger:e.ch,...e}),T4=[T3,T0,TZ,TJ,TQ],T7=[T2].concat(T4),Be=[TK("predicate",en),TV("scope","node",["node","editor"]),TV("position","selection",["node","selection","line"])],Bt=T4.concat([T5("contextformbutton"),T8,TX,TL("original",X)]),Br=T7.concat([T5("contextformbutton"),T8,TX,TL("original",X)]),Bn=T4.concat([T5("contextformbutton")]),Bo=T7.concat([T5("contextformtogglebutton")]),Ba=TN("type",{contextformbutton:Bt,contextformtogglebutton:Br});Tx([T5("contextform"),TK("initValue",Y("")),T1,TP(a="commands",a,Tl(),Tw(Ba)),Tz("launch",TN("type",{contextformbutton:Bn,contextformtogglebutton:Bo}))].concat(Be));let Bl=e=>{let t=eU(e.ui.registry.getAll().popups,e=>T9(e).fold(e=>{throw Error(T_(e))},X)),r=eQ(eV(t,e=>e.trigger)),n=eW(t);return{dataset:t,triggers:r,lookupByTrigger:e=>eb(n,t=>t.trigger===e)}},Bi=(e,t)=>{let r=iy(t.load,50);e.on("keypress compositionend",e=>{27!==e.which&&r.throttle()}),e.on("keydown",e=>{let n=e.which;8===n?r.throttle():27===n&&t.cancelIfNecessary()}),e.on("remove",r.cancel)},Bs=e=>{let t=ib(),r=ia(!1),n=t.isSet,o=()=>{n()&&(kK(e),fL(e),r.set(!1),t.clear())},a=r=>{n()||(kW(e,r.range),t.set({trigger:r.trigger,matchLength:r.text.length}))},l=e6(()=>Bl(e)),i=r=>t.get().map(t=>OK(e.dom,e.selection.getRng(),t.trigger).bind(t=>O2(e,l,t,r))).getOrThunk(()=>O1(e,l)),s=n=>{i(n).fold(o,n=>{a(n.context),n.lookupData.then(a=>{t.get().map(l=>{let i=n.context;l.trigger===i.trigger&&(i.text.length-l.matchLength>=10?o():(t.set({...l,matchLength:i.text.length}),r.get()?fP(e,{lookupData:a}):(r.set(!0),fB(e,{lookupData:a}))))})})})};e.addCommand("mceAutocompleterReload",(e,t)=>{s(L(t)?t.fetchOptions:{})}),e.addCommand("mceAutocompleterClose",o),Bi(e,{cancelIfNecessary:o,load:s})},Bd=tV().browser.isSafari(),Bc=e=>o6(rz.fromDom(e)),Bm=(e,t)=>{var r;return 0===e.startOffset&&e.endOffset===(null===(r=t.textContent)||void 0===r?void 0:r.length)},Bu=(e,t)=>ea.from(e.getParent(t.container(),"details")),Bf=(e,t)=>Bu(e,t).isSome(),Bg=(e,t)=>{let r=ea.from(e.getParent(t.startContainer,"details")),n=ea.from(e.getParent(t.endContainer,"details"));if(!(r.isSome()||n.isSome()))return ea.none();{let t=r.bind(t=>ea.from(e.select("summary",t)[0]));return ea.some({startSummary:t,startDetails:r,endDetails:n})}},Bp=(e,t)=>mT(t).exists(t=>t.isEqual(e)),Bh=(e,t)=>mB(t).exists(r=>oD(r.getNode())&&mO(t,r).exists(t=>t.isEqual(e))||r.isEqual(e)),Bb=(e,t)=>t.startSummary.exists(t=>Bp(e,t)),Bv=(e,t)=>t.startSummary.exists(t=>Bh(e,t)),By=(e,t)=>t.startDetails.exists(r=>mO(r,e).forall(r=>t.startSummary.exists(t=>!t.contains(e.container())&&t.contains(r.container())))),BC=(e,t,r)=>r.startDetails.exists(r=>mA(e,t).forall(e=>!r.contains(e.container()))),Bx=(e,t)=>{let r=t.getNode();z(r)||e.selection.setCursorLocation(r,t.offset())},Bw=(e,t,r)=>{let n=e.dom.getParent(t.container(),"details");if(n&&!n.open){let t=e.dom.select("summary",n)[0];t&&(r?mT(t):mB(t)).each(t=>Bx(e,t))}else Bx(e,t)},BE=(e,t)=>{let r=t.startSummary.exists(t=>t.contains(e.startContainer)),n=t.startSummary.exists(t=>t.contains(e.endContainer)),o=t.startDetails.forall(e=>t.endDetails.forall(t=>e!==t));return(r||n)&&!(r&&n)||o},Bk=(e,t,r)=>{let{dom:n,selection:o}=e,a=e.getBody();if("character"!==r)return!1;{let r=sf.fromRangeStart(o.getRng()),l=n.getParent(r.container(),n.isBlock),i=Bu(n,r),s=l&&n.isEmpty(l),d=I(null==l?void 0:l.previousSibling),c=I(null==l?void 0:l.nextSibling);return!!(s&&(t?c:d)&&mN(!t,a,r).exists(e=>Bf(n,e)&&!t8(i,Bu(n,e))))||mN(t,a,r).fold(en,r=>{let o=Bu(n,r);if(!Bf(n,r)||t8(i,o))return!1;if(t||Bw(e,r,!1),l&&s){if(t&&d||!t&&c)return!0;Bw(e,r,t),e.dom.remove(l)}return!0})}},BS=(e,t,r,n)=>{let o=e.selection.getRng(),a=sf.fromRangeStart(o),l=e.getBody();return"selection"===n?BE(o,t):r?Bv(a,t)||BC(l,a,t):Bb(a,t)||By(a,t)},B_=(e,t,r)=>Bg(e.dom,e.selection.getRng()).fold(()=>Bk(e,t,r),n=>BS(e,n,t,r)||Bk(e,t,r)),BN=(e,t,r)=>{let n=e.selection,o=n.getNode(),a=n.getRng(),l=sf.fromRangeStart(a);return!!oM(o)&&("selection"===r&&Bm(a,o)||b4(t,l,o)?Bc(o):e.undoManager.transact(()=>{let a=n.getSel(),{anchorNode:l,anchorOffset:i,focusNode:s,focusOffset:d}=null!=a?a:{},c=()=>{H(l)&&H(i)&&H(s)&&H(d)&&(null==a||a.setBaseAndExtent(l,i,s,d))},m=(e,t)=>{eg(e.childNodes,e=>{uS(e)&&t.appendChild(e)})},u=e.dom.create("span",{"data-mce-bogus":"1"});m(o,u),o.appendChild(u),c(),("word"===r||"line"===r)&&(null==a||a.modify("extend",t?"right":"left",r)),!n.isCollapsed()&&Bm(n.getRng(),u)?Bc(o):(e.execCommand(t?"ForwardDelete":"Delete"),l=null==a?void 0:a.anchorNode,i=null==a?void 0:a.anchorOffset,s=null==a?void 0:a.focusNode,d=null==a?void 0:a.focusOffset,m(u,o),c()),e.dom.remove(u)}),!0)},BD=(e,t,r)=>B_(e,t,r)||Bd&&BN(e,t,r)?ea.some(W):ea.none(),BR=e=>(t,r,n={})=>{let o=t.getBody(),a={bubbles:!0,composed:!0,data:null,isComposing:!1,detail:0,view:null,target:o,currentTarget:o,eventPhase:Event.AT_TARGET,originalTarget:o,explicitOriginalTarget:o,isTrusted:!1,srcElement:o,cancelable:!1,preventDefault:W,inputType:r},l=lV(new InputEvent(e));return t.dispatch(e,{...l,...a,...n})},BA=BR("input"),BO=BR("beforeinput"),BT=tV(),BB=BT.os,BP=BB.isMacOS()||BB.isiOS(),BL=BT.browser.isFirefox(),BF=(e,t,r)=>{let n=r.keyCode===fz.BACKSPACE?"deleteContentBackward":"deleteContentForward",o=e.selection.isCollapsed(),a=o?"character":"selection",l=e=>o?e?"word":"line":"selection";AG([{keyCode:fz.BACKSPACE,action:AW(R6,e)},{keyCode:fz.BACKSPACE,action:AW(NW,e,!1)},{keyCode:fz.DELETE,action:AW(NW,e,!0)},{keyCode:fz.BACKSPACE,action:AW(NS,e,!1)},{keyCode:fz.DELETE,action:AW(NS,e,!0)},{keyCode:fz.BACKSPACE,action:AW(Rp,e,t,!1)},{keyCode:fz.DELETE,action:AW(Rp,e,t,!0)},{keyCode:fz.BACKSPACE,action:AW(vY,e,!1)},{keyCode:fz.DELETE,action:AW(vY,e,!0)},{keyCode:fz.BACKSPACE,action:AW(BD,e,!1,a)},{keyCode:fz.DELETE,action:AW(BD,e,!0,a)},...BP?[{keyCode:fz.BACKSPACE,altKey:!0,action:AW(BD,e,!1,l(!0))},{keyCode:fz.DELETE,altKey:!0,action:AW(BD,e,!0,l(!0))},{keyCode:fz.BACKSPACE,metaKey:!0,action:AW(BD,e,!1,l(!1))}]:[{keyCode:fz.BACKSPACE,ctrlKey:!0,action:AW(BD,e,!1,l(!0))},{keyCode:fz.DELETE,ctrlKey:!0,action:AW(BD,e,!0,l(!0))}],{keyCode:fz.BACKSPACE,action:AW(NG,e,!1)},{keyCode:fz.DELETE,action:AW(NG,e,!0)},{keyCode:fz.BACKSPACE,action:AW(RK,e,!1)},{keyCode:fz.DELETE,action:AW(RK,e,!0)},{keyCode:fz.BACKSPACE,action:AW(Ng,e,!1)},{keyCode:fz.DELETE,action:AW(Ng,e,!0)},{keyCode:fz.BACKSPACE,action:AW(Ni,e,!1)},{keyCode:fz.DELETE,action:AW(Ni,e,!0)},{keyCode:fz.BACKSPACE,action:AW(RU,e,!1)},{keyCode:fz.DELETE,action:AW(RU,e,!0)}],r).filter(t=>e.selection.isEditable()).each(t=>{r.preventDefault(),BO(e,n).isDefaultPrevented()||(t(),BA(e,n))})},BM=(e,t,r)=>AK([{keyCode:fz.BACKSPACE,action:AW(NV,e)},{keyCode:fz.DELETE,action:AW(NV,e)},...BP?[{keyCode:fz.BACKSPACE,altKey:!0,action:AW(R$,e)},{keyCode:fz.DELETE,altKey:!0,action:AW(R$,e)},...r?[{keyCode:BL?224:91,action:AW(R$,e)}]:[]]:[{keyCode:fz.BACKSPACE,ctrlKey:!0,action:AW(R$,e)},{keyCode:fz.DELETE,ctrlKey:!0,action:AW(R$,e)}]],t),BI=(e,t)=>{let r=!1;e.on("keydown",n=>{r=n.keyCode===fz.BACKSPACE,n.isDefaultPrevented()||BF(e,t,n)}),e.on("keyup",t=>{t.isDefaultPrevented()||BM(e,t,r),r=!1})},BU=e=>{for(;e;){if(ou(e)||ow(e)&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}return null},Bz=(e,t)=>{let r=e.dom,n=e.schema.getMoveCaretBeforeOnEnterElements();if(!t)return;if(/^(LI|DT|DD)$/.test(t.nodeName)){let e=BU(t.firstChild);e&&/^(UL|OL|DL)$/.test(e.nodeName)&&t.insertBefore(r.doc.createTextNode("\xa0"),t.firstChild)}let o=r.createRng();if(t.normalize(),t.hasChildNodes()){let e;let r=new od(t,t),a=t;for(;e=r.current();){if(ow(e)){o.setStart(e,0),o.setEnd(e,0);break}if(n[e.nodeName.toLowerCase()]){o.setStartBefore(e),o.setEndBefore(e);break}a=e,e=r.next()}e||(o.setStart(a,0),o.setEnd(a,0))}else oD(t)?t.nextSibling&&r.isBlock(t.nextSibling)?(o.setStartBefore(t),o.setEndBefore(t)):(o.setStartAfter(t),o.setEndAfter(t)):(o.setStart(t,0),o.setEnd(t,0));e.selection.setRng(o),gJ(e,o)},Bj=(e,t)=>{let r;let n=e.getRoot(),o=t;for(;o!==n&&o&&"false"!==e.getContentEditable(o);){if("true"===e.getContentEditable(o)){r=o;break}o=o.parentNode}return o!==n?r:n},BH=e=>ea.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock)),B$=e=>BH(e).fold(Y(""),e=>e.nodeName.toUpperCase()),Bq=e=>BH(e).filter(e=>oQ(rz.fromDom(e))).isSome(),BV=e=>{e.innerHTML='<br data-mce-bogus="1">'},BW=(e,t,r)=>{let n=e.dom;ea.from(r.style).map(n.parseStyle).each(e=>{let r={...nP(rz.fromDom(t)),...e};n.setStyles(t,r)}),t6(ea.from(r.class).map(e=>e.split(/\s+/)),ea.from(t.className).map(e=>eb(e.split(/\s+/),e=>""!==e)),(e,r)=>{let o=eb(r,t=>!em(e,t)),a=[...e,...o];n.setAttrib(t,"class",a.join(" "))});let o=["style","class"],a=eq(r,(e,t)=>!em(o,t));n.setAttribs(t,a)},BK=(e,t)=>{if(dd(e).toLowerCase()===t.tagName.toLowerCase()){let r=dc(e);BW(e,t,r)}},BG=(e,t,r,n,o=!0,a)=>{let l;let i=e.dom,s=e.schema,d=dd(e),c=r?r.nodeName.toUpperCase():"",m=t,u=s.getTextInlineElements(),f=l=a||"TABLE"===c||"HR"===c?i.create(a||d):r.cloneNode(!1);if(o)do if(u[m.nodeName]){if(mL(m)||m8(m))continue;let e=m.cloneNode(!1);i.setAttrib(e,"id",""),l.hasChildNodes()?e.appendChild(l.firstChild):f=e,l.appendChild(e)}while((m=m.parentNode)&&m!==n);else i.setAttrib(l,"style",null),i.setAttrib(l,"class",null);return BK(e,l),BV(f),l},BY=(e,t)=>e.dom.getParent(t,oF),BX=(e,t,r)=>{let n=t;for(;n&&n!==e&&I(n.nextSibling);){let e=n.parentElement;if(!e||!r(e))return oF(e);n=e}return!1},BQ=(e,t,r)=>!t&&r.nodeName.toLowerCase()===dd(e)&&e.dom.isEmpty(r)&&BX(e.getBody(),r,t=>eG(e.schema.getTextBlockElements(),t.nodeName.toLowerCase())),BJ=(e,t,r)=>{var n,o,a;let l=t(dd(e)),i=BY(e,r);i&&(e.dom.insertAfter(l,i),Bz(e,l),(null!==(a=null===(o=null===(n=r.parentElement)||void 0===n?void 0:n.childNodes)||void 0===o?void 0:o.length)&&void 0!==a?a:0)>1&&e.dom.remove(r))},BZ=(e,t)=>e.firstChild&&e.firstChild.nodeName===t,B0=e=>{var t;return(null===(t=e.parentNode)||void 0===t?void 0:t.firstChild)===e},B1=(e,t)=>{let r=null==e?void 0:e.parentNode;return H(r)&&r.nodeName===t},B2=e=>H(e)&&/^(OL|UL|LI)$/.test(e.nodeName),B3=e=>H(e)&&/^(LI|DT|DD)$/.test(e.nodeName),B8=e=>B2(e)&&B2(e.parentNode),B5=e=>{let t=e.parentNode;return B3(t)?t:e},B6=(e,t,r)=>{let n=e[r?"firstChild":"lastChild"];for(;n&&!ou(n);)n=n[r?"nextSibling":"previousSibling"];return n===t},B9=(e,t,r,n,o)=>{let a=e.dom,l=e.selection.getRng(),i=r.parentNode;if(r===e.getBody()||!i)return;B8(r)&&(o="LI");let s=t(o);if(B6(r,n,!0)&&B6(r,n,!1)){if(B1(r,"LI")){let e=B5(r);a.insertAfter(s,e),B0(r)?a.remove(e):a.remove(r)}else a.replace(s,r)}else if(B6(r,n,!0))B1(r,"LI")?(a.insertAfter(s,B5(r)),s.appendChild(a.doc.createTextNode(" ")),s.appendChild(r)):i.insertBefore(s,r),a.remove(n);else if(B6(r,n,!1))a.insertAfter(s,B5(r)),a.remove(n);else{r=B5(r);let e=l.cloneRange();e.setStartAfter(n),e.setEndAfter(r);let t=e.extractContents();"LI"===o&&BZ(t,"LI")?(s=t.firstChild,a.insertAfter(t,r)):(a.insertAfter(t,r),a.insertAfter(s,r)),a.remove(n)}Bz(e,s)},B4=e=>{eg(ol(rz.fromDom(e),rf),e=>{let t=e.dom;t.nodeValue=o4(t.data)})},B7=(e,t)=>{let r=e.dom.getParent(t,"ol,ul,dl");return null!==r&&"false"===e.dom.getContentEditableParent(r)},Pe=(e,t)=>t&&"A"===t.nodeName&&e.isEmpty(t),Pt=(e,t)=>e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t,Pr=(e,t)=>H(t)&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&e.isEditable(t.parentNode)&&"false"!==e.getContentEditable(t),Pn=(e,t,r)=>{var n;let o=[];if(!r)return;let a=r;for(;a=a.firstChild;){if(e.isBlock(a))return;ou(a)&&!t[a.nodeName.toLowerCase()]&&o.push(a)}let l=o.length;for(;l--;)(a=o[l]).hasChildNodes()&&(a.firstChild!==a.lastChild||(null===(n=a.firstChild)||void 0===n?void 0:n.nodeValue)!=="")?Pe(e,a)&&e.remove(a):e.remove(a)},Po=(e,t,r)=>ow(t)?e?1===r&&"\uFEFF"===t.data.charAt(r-1)?0:r:r===t.data.length-1&&"\uFEFF"===t.data.charAt(r)?t.data.length:r:r,Pa=e=>{let t=e.cloneRange();return t.setStart(e.startContainer,Po(!0,e.startContainer,e.startOffset)),t.setEnd(e.endContainer,Po(!1,e.endContainer,e.endOffset)),t},Pl=e=>{let t=e;do ow(t)&&(t.data=t.data.replace(/^[\r\n]+/,"")),t=t.firstChild;while(t)},Pi=(e,t,r,n,o)=>{var a,l;let i=e.dom,s=null!==(a=Bj(i,n))&&void 0!==a?a:i.getRoot(),d=i.getParent(n,i.isBlock);if(!d||!Pr(i,d)){let a;if(!(d=d||s).hasChildNodes()){let n=i.create(t);return BK(e,n),d.appendChild(n),r.setStart(n,0),r.setEnd(n,0),n}let c=n;for(;c&&c.parentNode!==d;)c=c.parentNode;for(;c&&!i.isBlock(c);)a=c,c=c.previousSibling;let m=null===(l=null==a?void 0:a.parentElement)||void 0===l?void 0:l.nodeName;if(a&&m&&e.schema.isValidChild(m,t.toLowerCase())){let l=a.parentNode,s=i.create(t);for(BK(e,s),l.insertBefore(s,a),c=a;c&&!i.isBlock(c);){let e=c.nextSibling;s.appendChild(c),c=e}r.setStart(n,o),r.setEnd(n,o)}}return n},Ps=(e,t)=>{t.normalize();let r=t.lastChild;(!r||ou(r)&&/^(left|right)$/gi.test(e.getStyle(r,"float",!0)))&&e.add(t,"br")},Pd=(e,t)=>{let r=dp(e);return!j(t)&&(P(r)?em(t2.explode(r),t.nodeName.toLowerCase()):r)},Pc={insert:(e,t)=>{let r,n,o,a,l;let i=!1,s=e.dom,d=e.schema.getNonEmptyElements(),c=e.selection.getRng(),m=dd(e),u=rz.fromDom(c.startContainer),f=r9(u,c.startOffset),g=f.exists(e=>rm(e)&&!nk(e)),p=c.collapsed&&g,h=t=>BG(e,r,w,x,dg(e),t),b=e=>{let t;let o=Po(e,r,n);if(ow(r)&&(e?o>0:o<r.data.length))return!1;if(r.parentNode===w&&i&&!e||e&&ou(r)&&r===w.firstChild)return!0;if(Pt(r,"TABLE")||Pt(r,"HR"))return i&&!e||!i&&e;let a=new od(r,w);for(ow(r)&&(e&&0===o?a.prev():e||o!==r.data.length||a.next());t=a.current();){if(ou(t)){if(!t.getAttribute("data-mce-bogus")){let e=t.nodeName.toLowerCase();if(d[e]&&"br"!==e)return!1}}else if(ow(t)&&!aw(t.data))return!1;e?a.prev():a.next()}return!0},v=()=>{let t;return t=/^(H[1-6]|PRE|FIGURE)$/.test(o)&&"HGROUP"!==E?h(m):h(),Pd(e,a)&&Pr(s,a)&&s.isEmpty(w,void 0,{includeZwsp:!0})?t=s.split(a,w):s.insertAfter(t,w),Bz(e,t),t};gC(s,c).each(e=>{c.setStart(e.startContainer,e.startOffset),c.setEnd(e.endContainer,e.endOffset)}),r=c.startContainer,n=c.startOffset;let y=!!(t&&t.shiftKey),C=!!(t&&t.ctrlKey);ou(r)&&r.hasChildNodes()&&!p&&(i=n>r.childNodes.length-1,r=r.childNodes[Math.min(n,r.childNodes.length-1)]||r,n=i&&ow(r)?r.data.length:0);let x=Bj(s,r);if(!x||B7(e,r))return;y||(r=Pi(e,m,c,r,n));let w=s.getParent(r,s.isBlock)||s.getRoot();a=H(null==w?void 0:w.parentNode)?s.getParent(w.parentNode,s.isBlock):null,o=w?w.nodeName.toUpperCase():"";let E=a?a.nodeName.toUpperCase():"";if("LI"===E&&!C){let e=a;w=e,a=e.parentNode,o=E}if(ou(a)&&BQ(e,y,w))return BJ(e,h,w);if(/^(LI|DT|DD)$/.test(o)&&ou(a)&&s.isEmpty(w)){B9(e,h,a,w,m);return}if(!p&&(w===e.getBody()||!Pr(s,w)))return;let k=w.parentNode;if(p)l=h(m),f.fold(()=>{nz(u,rz.fromDom(l))},e=>{nM(e,rz.fromDom(l))}),e.selection.setCursorLocation(l,0);else if(o7(w))l=ac(w),s.isEmpty(w)&&BV(w),BK(e,l),Bz(e,l);else if(b(!1))l=v();else if(b(!0)&&k){l=k.insertBefore(h(),w);let t=nt(rz.fromDom(c.startContainer))&&c.collapsed;Bz(e,Pt(w,"HR")||t?l:w)}else{let t=Pa(c).cloneRange();t.setEndAfter(w);let r=t.extractContents();B4(r),Pl(r),l=r.firstChild,s.insertAfter(r,w),Pn(s,d,l),Ps(s,w),s.isEmpty(w)&&BV(w),l.normalize(),s.isEmpty(l)?(s.remove(l),v()):(BK(e,l),Bz(e,l))}s.setAttrib(l,"id",""),e.dispatch("NewBlock",{newBlock:l})},fakeEventName:"insertParagraph"},Pm=(e,t,r)=>{let n;let o=new od(t,r),a=e.getNonEmptyElements();for(;n=o.next();)if(a[n.nodeName.toLowerCase()]||ow(n)&&n.length>0)return!0;return!1},Pu=(e,t,r)=>{let n=e.dom.createRng();r?(n.setStartBefore(t),n.setEndBefore(t)):(n.setStartAfter(t),n.setEndAfter(t)),e.selection.setRng(n),gJ(e,n)},Pf=(e,t)=>{let r;let n=e.selection,o=e.dom,a=n.getRng(),l=!1;gC(o,a).each(e=>{a.setStart(e.startContainer,e.startOffset),a.setEnd(e.endContainer,e.endOffset)});let i=a.startOffset,s=a.startContainer;if(ou(s)&&s.hasChildNodes()){let e=i>s.childNodes.length-1;s=s.childNodes[Math.min(i,s.childNodes.length-1)]||s,i=e&&ow(s)?s.data.length:0}let d=o.getParent(s,o.isBlock),c=d&&d.parentNode?o.getParent(d.parentNode,o.isBlock):null,m=c?c.nodeName.toUpperCase():"",u=!!(t&&t.ctrlKey);"LI"!==m||u||(d=c),ow(s)&&i>=s.data.length&&!Pm(e.schema,s,d||o.getRoot())&&(r=o.create("br"),a.insertNode(r),a.setStartAfter(r),a.setEndAfter(r),l=!0),r=o.create("br"),sb(o,a,r),Pu(e,r,l),e.undoManager.add()},Pg=(e,t)=>{let r=rz.fromTag("br");nM(rz.fromDom(t),r),e.undoManager.add()},Pp=(e,t)=>{Pb(e.getBody(),t)||nI(rz.fromDom(t),rz.fromTag("br"));let r=rz.fromTag("br");nI(rz.fromDom(t),r),Pu(e,r.dom,!1),e.undoManager.add()},Ph=e=>oD(e.getNode()),Pb=(e,t)=>!!Ph(sf.after(t))||mA(e,sf.after(t)).map(e=>oD(e.getNode())).getOr(!1),Pv=e=>e&&"A"===e.nodeName&&"href"in e,Py=e=>e.fold(en,Pv,Pv,en),PC=e=>{let t=J(bV,e),r=sf.fromRangeStart(e.selection.getRng());return Dl(t,e.getBody(),r).filter(Py)},Px=(e,t)=>{t.fold(W,J(Pg,e),J(Pp,e),W)},Pw={insert:(e,t)=>{let r=PC(e);r.isSome()?r.each(J(Px,e)):Pf(e,t)},fakeEventName:"insertLineBreak"},PE=(e,t)=>BH(e).filter(e=>t.length>0&&rH(rz.fromDom(e),t)).isSome(),Pk=e=>PE(e,du(e)),PS=e=>PE(e,df(e)),P_=sW([{br:[]},{block:[]},{none:[]}]),PN=(e,t)=>PS(e),PD=e=>(t,r)=>Bq(t)===e,PR=(e,t)=>(r,n)=>B$(r)===e.toUpperCase()===t,PA=e=>j(Bj(e.dom,e.selection.getStart())),PO=e=>PR("pre",e),PT=()=>PR("summary",!0),PB=e=>(t,r)=>ds(t)===e,PP=(e,t)=>Pk(e),PL=(e,t)=>t,PF=e=>{let t=dd(e),r=Bj(e.dom,e.selection.getStart());return H(r)&&e.schema.isValidChild(r.nodeName,t)},PM=e=>{let t=e.selection.getRng(),r=r9(rz.fromDom(t.startContainer),t.startOffset).map(e=>rm(e)&&!nk(e));return t.collapsed&&r.getOr(!0)},PI=(e,t)=>(r,n)=>ey(e,(e,t)=>e&&t(r,n),!0)?ea.some(t):ea.none(),PU=(e,t)=>N6([PI([PN],P_.none()),PI([PO(!0),PA],P_.none()),PI([PT()],P_.br()),PI([PO(!0),PB(!1),PL],P_.br()),PI([PO(!0),PB(!1)],P_.block()),PI([PO(!0),PB(!0),PL],P_.block()),PI([PO(!0),PB(!0)],P_.br()),PI([PD(!0),PL],P_.br()),PI([PD(!0)],P_.block()),PI([PP],P_.br()),PI([PL],P_.br()),PI([PF],P_.block()),PI([PM],P_.block())],[e,!!(t&&t.shiftKey)]).getOr(P_.none()),Pz=(e,t,r)=>{t.selection.isCollapsed()||b1(t),!(H(r)&&BO(t,e.fakeEventName).isDefaultPrevented())&&(e.insert(t,r),H(r)&&BA(t,e.fakeEventName))},Pj=(e,t)=>{let r=()=>Pz(Pw,e,t),n=()=>Pz(Pc,e,t),o=PU(e,t);switch(dm(e)){case"linebreak":o.fold(r,r,W);break;case"block":o.fold(n,n,W);break;case"invert":o.fold(n,r,W);break;default:o.fold(r,n,W)}},PH=tV(),P$=PH.os.isiOS()&&PH.browser.isSafari(),Pq=(e,t)=>{t.isDefaultPrevented()||(t.preventDefault(),E7(e.undoManager),e.undoManager.transact(()=>{Pj(e,t)}))},PV=e=>{if(!e.collapsed)return!1;let t=e.startContainer;if(!ow(t))return!1;{let r=t.data.charAt(e.startOffset-1);return/^[\uAC00-\uD7AF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uD7B0-\uD7FF]$/.test(r)}},PW=e=>{let t=ea.none(),r=e=>{t=ea.some(e.selection.getBookmark()),e.undoManager.add()},n=(e,r)=>{e.undoManager.undo(),t.fold(W,t=>e.selection.moveToBookmark(t)),Pq(e,r),t=ea.none()};e.on("keydown",t=>{t.keyCode===fz.ENTER&&(P$&&PV(e.selection.getRng())?r(e):Pq(e,t))}),e.on("keyup",r=>{r.keyCode===fz.ENTER&&t.each(()=>n(e,r))})},PK=(e,t,r)=>{let n=tJ.os.isMacOS()||tJ.os.isiOS();AK([{keyCode:fz.END,action:AW(AR,e,!0)},{keyCode:fz.HOME,action:AW(AR,e,!1)},...n?[]:[{keyCode:fz.HOME,action:AW(AA,e,!1),ctrlKey:!0,shiftKey:!0},{keyCode:fz.END,action:AW(AA,e,!0),ctrlKey:!0,shiftKey:!0}],{keyCode:fz.END,action:AW(AQ,e,!0)},{keyCode:fz.HOME,action:AW(AQ,e,!1)},{keyCode:fz.END,action:AW(Rs,e,!0,t)},{keyCode:fz.HOME,action:AW(Rs,e,!1,t)}],r).each(e=>{r.preventDefault()})},PG=(e,t)=>{e.on("keydown",r=>{r.isDefaultPrevented()||PK(e,t,r)})},PY=e=>{e.on("input",t=>{t.isComposing||by(e)})},PX=tV(),PQ=(e,t,r)=>{AK([{keyCode:fz.PAGE_UP,action:AW(Rs,e,!1,t)},{keyCode:fz.PAGE_DOWN,action:AW(Rs,e,!0,t)}],r)},PJ=e=>e.stopImmediatePropagation(),PZ=e=>e.keyCode===fz.PAGE_UP||e.keyCode===fz.PAGE_DOWN,P0=(e,t,r)=>{r&&!e.get()?t.on("NodeChange",PJ,!0):!r&&e.get()&&t.off("NodeChange",PJ),e.set(r)},P1=(e,t)=>{if(PX.os.isMacOS())return;let r=ia(!1);e.on("keydown",t=>{PZ(t)&&P0(r,e,!0)}),e.on("keyup",n=>{n.isDefaultPrevented()||PQ(e,t,n),PZ(n)&&r.get()&&(P0(r,e,!1),e.nodeChanged())})},P2=(e,t)=>{let r=t.container(),n=t.offset();return ow(r)?(r.insertData(n,e),ea.some(sf(r,n+e.length))):ms(t).map(r=>{let n=rz.fromText(e);return t.isAtEnd()?nI(r,n):nM(r,n),sf(n.dom,e.length)})},P3=J(P2,"\xa0"),P8=J(P2," "),P5=(e,t)=>bl(e,t)?P3(t):P8(t),P6=e=>t=>t.fold(t=>mO(e.dom,sf.before(t)),e=>mT(e),e=>mB(e),t=>mA(e.dom,sf.after(t))),P9=(e,t)=>r=>bl(e,r)?P3(t):P8(t),P4=e=>t=>{e.selection.setRng(t.toRange()),e.nodeChanged()},P7=(e,t)=>e.isEditable(e.getParent(t,"summary")),Le=e=>{let t=sf.fromRangeStart(e.selection.getRng()),r=rz.fromDom(e.getBody());if(!e.selection.isCollapsed())return ea.none();{let n=J(bV,e),o=sf.fromRangeStart(e.selection.getRng());return Dl(n,e.getBody(),o).bind(P6(r)).map(n=>()=>P9(r,t)(n).each(P4(e)))}},Lt=e=>t4(tJ.browser.isFirefox()&&e.selection.isEditable()&&P7(e.dom,e.selection.getRng().startContainer),()=>{let t=rz.fromDom(e.getBody());e.selection.isCollapsed()||e.getDoc().execCommand("Delete"),P5(t,sf.fromRangeStart(e.selection.getRng())).each(P4(e))}),Lr=(e,t)=>{AG([{keyCode:fz.SPACEBAR,action:AW(Le,e)},{keyCode:fz.SPACEBAR,action:AW(Lt,e)}],t).each(r=>{t.preventDefault(),BO(e,"insertText",{data:" "}).isDefaultPrevented()||(r(),BA(e,"insertText",{data:" "}))})},Ln=e=>{e.on("keydown",t=>{t.isDefaultPrevented()||Lr(e,t)})},Lo=e=>cF(e)?[{keyCode:fz.TAB,action:AW(OR,e,!0)},{keyCode:fz.TAB,shiftKey:!0,action:AW(OR,e,!1)}]:[],La=(e,t)=>{AK([...Lo(e)],t).each(e=>{t.preventDefault()})},Ll=e=>{e.on("keydown",t=>{t.isDefaultPrevented()||La(e,t)})},Li=e=>{if(e.addShortcut("Meta+P","","mcePrint"),Bs(e),kp(e))return ia(null);{let t=Ra(e);return Ay(e),OO(e,t),BI(e,t),PW(e),Ln(e),PY(e),Ll(e),PG(e,t),P1(e,t),t}};class Ls{constructor(e){let t;this.lastPath=[],this.editor=e;let r=this;"onselectionchange"in e.getDoc()||e.on("NodeChange click mouseup keyup focus",r=>{let n=e.selection.getRng(),o={startContainer:n.startContainer,startOffset:n.startOffset,endContainer:n.endContainer,endOffset:n.endOffset};"nodechange"!==r.type&&gc(o,t)||e.dispatch("SelectionChange"),t=o}),e.on("contextmenu",()=>{e.dispatch("SelectionChange")}),e.on("SelectionChange",()=>{let t=e.selection.getStart(!0);t&&uw(e)&&!r.isSameElementPath(t)&&e.dom.isChildOf(t,e.getBody())&&e.nodeChanged({selectionChange:!0})}),e.on("mouseup",t=>{!t.isDefaultPrevented()&&uw(e)&&("IMG"===e.selection.getNode().nodeName?pd.setEditorTimeout(e,()=>{e.nodeChanged()}):e.nodeChanged())})}nodeChanged(e={}){let t;let r=this.editor.selection;if(this.editor.initialized&&r&&!d3(this.editor)&&!this.editor.mode.isReadOnly()){let n=this.editor.getBody();(t=r.getStart(!0)||n).ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(t,n)||(t=n);let o=[];this.editor.dom.getParent(t,e=>e===n||(o.push(e),!1)),this.editor.dispatch("NodeChange",{...e,element:t,parents:o})}}isSameElementPath(e){let t;let r=this.editor,n=e_(r.dom.getParents(e,eo,r.getBody()));if(n.length===this.lastPath.length){for(t=n.length;t>=0&&n[t]===this.lastPath[t];t--);if(-1===t)return this.lastPath=n,!0}return this.lastPath=n,!1}}let Ld=iF("image"),Lc=e=>ea.from(e[Ld]),Lm=(e,t)=>{e[Ld]=t},Lu=iF("event"),Lf=e=>ea.from(e[Lu]),Lg=e=>t=>{t[Lu]=e},Lp=(e,t)=>Lg(t)(e),Lh=Lg(0),Lb=Lg(2),Lv=Lg(1),Ly=e=>ea.from(e[Lu]).exists(e=>0===e),LC=()=>Object.freeze({length:0,item:e=>null}),Lx=iF("mode"),Lw=e=>ea.from(e[Lx]),LE=e=>t=>{t[Lx]=e},Lk=(e,t)=>LE(t)(e),LS=LE(0),L_=LE(2),LN=LE(1),LD=e=>t=>ea.from(t[Lx]).exists(t=>t===e),LR=LD(0),LA=LD(1),LO=(e,t)=>({...t,get length(){return t.length},add:(r,n)=>{if(LR(e)){if(!P(r))return t.add(r);if(!z(n))return t.add(r,n)}return null},remove:r=>{LR(e)&&t.remove(r)},clear:()=>{LR(e)&&t.clear()}}),LT=["none","copy","link","move"],LB=["none","copy","copyLink","copyMove","link","linkMove","move","all","uninitialized"],LP=()=>{let e=new window.DataTransfer,t="move",r="all",n={get dropEffect(){return t},set dropEffect(effect){em(LT,effect)&&(t=effect)},get effectAllowed(){return r},set effectAllowed(allowed){Ly(n)&&em(LB,allowed)&&(r=allowed)},get items(){return LO(n,e.items)},get files(){if(LA(n))return LC();return e.files},get types(){return e.types},setDragImage:(t,r,o)=>{LR(n)&&(Lm(n,{image:t,x:r,y:o}),e.setDragImage(t,r,o))},getData:t=>LA(n)?"":e.getData(t),setData:(t,r)=>{LR(n)&&e.setData(t,r)},clearData:t=>{LR(n)&&e.clearData(t)}};return LS(n),n},LL=e=>{let t=LP(),r=Lw(e);return L_(e),Lh(t),t.dropEffect=e.dropEffect,t.effectAllowed=e.effectAllowed,Lc(e).each(e=>t.setDragImage(e.image,e.x,e.y)),eg(e.types,r=>{"Files"!==r&&t.setData(r,e.getData(r))}),eg(e.files,e=>t.items.add(e)),Lf(e).each(e=>{Lp(t,e)}),r.each(r=>{Lk(e,r),Lk(t,r)}),t},LF=e=>{let t=e.getData("text/html");return""===t?ea.none():ea.some(t)},LM=(e,t)=>e.setData("text/html",t),LI="x-tinymce/html",LU=Y(LI),Lz="<!-- "+LI+" -->",Lj=e=>Lz+e,LH=e=>e.replace(Lz,""),L$=e=>-1!==e.indexOf(Lz),Lq=e=>!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(e),LV=(e,t)=>{let r="<"+e,n=eV(t,(e,t)=>t+'="'+lC.encodeAllRaw(e)+'"');return n.length&&(r+=" "+n.join(" ")),r+">"},LW=(e,t,r)=>{let n=e.split(/\n\n/),o=LV(t,r),a="</"+t+">",l=ef(n,e=>e.split(/\n/).join("<br />"));return 1===l.length?l[0]:ef(l,e=>o+e+a).join("")},LK="%MCEPASTEBIN%",LG=(e,t)=>{let{dom:r,selection:n}=e,o=e.getBody();t.set(n.getRng());let a=r.add(e.getBody(),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},LK);tJ.browser.isFirefox()&&r.setStyle(a,"left","rtl"===r.getStyle(o,"direction",!0)?65535:-65535),r.bind(a,"beforedeactivate focusin focusout",e=>{e.stopPropagation()}),a.focus(),n.select(a,!0)},LY=(e,t)=>{let r=e.dom;if(LX(e)){let n;let o=t.get();for(;n=LX(e);)r.remove(n),r.unbind(n);o&&e.selection.setRng(o)}t.set(null)},LX=e=>e.dom.get("mcepastebin"),LQ=e=>H(e)&&"mcepastebin"===e.id,LJ=e=>{let t=e.dom,r=(e,r)=>{e.appendChild(r),t.remove(r,!0)},[n,...o]=eb(e.getBody().childNodes,LQ);eg(o,e=>{r(n,e)});let a=t.select("div[id=mcepastebin]",n);for(let e=a.length-1;e>=0;e--){let o=t.create("div");n.insertBefore(o,a[e]),r(o,a[e])}return n?n.innerHTML:""},LZ=e=>e===LK,L0=e=>{let t=ia(null);return{create:()=>LG(e,t),remove:()=>LY(e,t),getEl:()=>LX(e),getHtml:()=>LJ(e),getLastRng:t.get}},L1=(e,t)=>(t2.each(t,t=>{e=B(t,RegExp)?e.replace(t,""):e.replace(t[0],t[1])}),e),L2=e=>{let t=lU(),r=w7({},t),n="",o=t.getVoidElements(),a=t2.makeMap("script noscript style textarea video audio iframe object"," "),l=t.getBlockElements(),i=e=>{let r=e.name;if("br"===r){n+="\n";return}if("wbr"!==r){if(o[r]&&(n+=" "),a[r]){n+=" ";return}if(3===e.type&&(n+=e.value),!(e.name in t.getVoidElements())){let t=e.firstChild;if(t)do i(t);while(t=t.next)}l[r]&&e.next&&(n+="\n","p"===r&&(n+="\n"))}};return e=L1(e,[/<!\[[^\]]+\]>/g]),i(r.parse(e)),n},L3=e=>e=L1(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/ig,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,(e,t,r)=>t||r?"\xa0":" "],/<br class="Apple-interchange-newline">/g,/<br>$/i]),L8=e=>{let t=e.toLowerCase(),r={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"};return t2.hasOwn(r,t)?"image/"+r[t]:"image/"+t},L5=(e,t)=>{let r=w7({sanitize:cR(e)},e.schema);r.addNodeFilter("meta",e=>{t2.each(e,e=>{e.remove()})});let n=r.parse(t,{forced_root_block:!1,isRootContent:!0});return hh({validate:!0},e.schema).serialize(n)},L6=(e,t)=>({content:e,cancelled:t}),L9=(e,t,r)=>{let n=e.dom.create("div",{style:"display:none"},t),o=fM(e,n,r);return L6(o.node.innerHTML,o.isDefaultPrevented())},L4=(e,t,r)=>{let n=fF(e,t,r),o=L5(e,n.content);return e.hasEventListeners("PastePostProcess")&&!n.isDefaultPrevented()?L9(e,o,r):L6(o,n.isDefaultPrevented())},L7=(e,t,r)=>L4(e,t,r),Fe=(e,t)=>(e.insertContent(t,{merge:cb(e),paste:!0}),!0),Ft=e=>/^https?:\/\/[\w\-\/+=.,!;:&%@^~(){}?#]+$/i.test(e),Fr=(e,t)=>Ft(t)&&eu(cL(e),e=>tu(t.toLowerCase(),`.${e.toLowerCase()}`)),Fn=(e,t,r)=>(e.undoManager.extra(()=>{r(e,t)},()=>{e.insertContent('<img src="'+t+'">')}),!0),Fo=(e,t,r)=>(e.undoManager.extra(()=>{r(e,t)},()=>{e.execCommand("mceInsertLink",!1,t)}),!0),Fa=(e,t,r)=>!!(!e.selection.isCollapsed()&&Ft(t))&&Fo(e,t,r),Fl=(e,t,r)=>!!Fr(e,t)&&Fn(e,t,r),Fi=(e,t)=>{t2.each([Fa,Fl,Fe],r=>!r(e,t,Fe))},Fs=(e,t,r)=>{r||!cv(e)?Fe(e,t):Fi(e,t)},Fd=(l=0,()=>"mceclip"+l++),Fc=e=>{let t=LP();return LM(t,e),L_(t),t},Fm=(e,t,r,n,o)=>{let a=L7(e,t,r);if(!a.cancelled){let t=a.content,r=()=>Fs(e,t,n);o?BO(e,"insertFromPaste",{dataTransfer:Fc(t)}).isDefaultPrevented()||(r(),BA(e,"insertFromPaste")):r()}},Fu=(e,t,r,n)=>{let o=r||L$(t);Fm(e,LH(t),o,!1,n)},Ff=(e,t,r)=>{let n=LW(aN(e.dom.encode(t).replace(/\r\n/g,"\n"),cC(e)),dd(e),dc(e));Fm(e,n,!1,!0,r)},Fg=e=>{let t={};if(e&&e.types)for(let r=0;r<e.types.length;r++){let n=e.types[r];try{t[n]=e.getData(n)}catch(e){t[n]=""}}return t},Fp=(e,t)=>t in e&&e[t].length>0,Fh=e=>Fp(e,"text/html")||Fp(e,"text/plain"),Fb=(e,t)=>{let r=t.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return H(r)?e.dom.encode(r[1]):void 0},Fv=(e,t,r,n)=>{let o=Fd(),a=db(e)&&H(r.name),l=a?Fb(e,r.name):o,i=a?r.name:void 0,s=t.create(o,r,n,l,i);return t.add(s),s},Fy=(e,t)=>{xL(t.uri).each(({data:r,type:n,base64Encoded:o})=>{let a=o?r:btoa(r),l=t.file,i=e.editorUpload.blobCache,s=i.getByData(a,n),d=null!=s?s:Fv(e,i,l,a);Fu(e,`<img src="${d.blobUri()}">`,!1,!0)})},FC=e=>"paste"===e.type,Fx=e=>Promise.all(ef(e,e=>xU(e).then(t=>({file:e,uri:t})))),Fw=e=>{let t=cL(e);return e=>tm(e.type,"image/")&&eu(t,t=>L8(t)===e.type)},FE=(e,t)=>{let r=t.items?ek(eB(t.items),e=>"file"===e.kind?[e.getAsFile()]:[]):[],n=t.files?eB(t.files):[];return eb(r.length>0?r:n,Fw(e))},Fk=(e,t,r)=>{let n=FC(t)?t.clipboardData:t.dataTransfer;if(cm(e)&&n){let o=FE(e,n);if(o.length>0)return t.preventDefault(),Fx(o).then(t=>{r&&e.selection.setRng(r),eg(t,t=>{Fy(e,t)})}),!0}return!1},FS=e=>{var t,r;return tJ.os.isAndroid()&&(null===(r=null===(t=e.clipboardData)||void 0===t?void 0:t.items)||void 0===r?void 0:r.length)===0},F_=e=>fz.metaKeyPressed(e)&&86===e.keyCode||e.shiftKey&&45===e.keyCode,FN=(e,t,r,n,o)=>{let a=L3(r),l=Fp(t,LU())||L$(r),i=!l&&Lq(a),s=Ft(a);(LZ(a)||!a.length||i&&!s)&&(n=!0),(n||s)&&(a=Fp(t,"text/plain")&&i?t["text/plain"]:L2(a)),LZ(a)||(n?Ff(e,a,o):Fu(e,a,l,o))},FD=(e,t,r)=>{let n;let o=()=>t.getLastRng()||e.selection.getRng();e.on("keydown",e=>{F_(e)&&!e.isDefaultPrevented()&&(n=e.shiftKey&&86===e.keyCode)}),e.on("paste",a=>{if(a.isDefaultPrevented()||FS(a))return;let l="text"===r.get()||n;n=!1;let i=Fg(a.clipboardData);!Fh(i)&&Fk(e,a,o())||(Fp(i,"text/html")?(a.preventDefault(),FN(e,i,i["text/html"],l,!0)):Fp(i,"text/plain")&&Fp(i,"text/uri-list")?(a.preventDefault(),FN(e,i,i["text/plain"],l,!0)):(t.create(),pd.setEditorTimeout(e,()=>{let r=t.getHtml();t.remove(),FN(e,i,r,l,!1)},0)))})},FR=e=>{let t=e=>tm(e,"webkit-fake-url"),r=e=>tm(e,"data:"),n=e=>{var t;return(null===(t=e.data)||void 0===t?void 0:t.paste)===!0};e.parser.addNodeFilter("img",(o,a,l)=>{if(!cm(e)&&n(l))for(let n of o){let o=n.attr("src");P(o)&&!n.attr("data-mce-object")&&o!==tJ.transparentSrc&&(t(o)?n.remove():!cx(e)&&r(o)&&n.remove())}})},FA=(e,t,r)=>{FD(e,t,r),FR(e)},FO=(e,t)=>{"text"===t.get()?(t.set("html"),fI(e,!1)):(t.set("text"),fI(e,!0)),e.focus()},FT=(e,t)=>{e.addCommand("mceTogglePlainTextPaste",()=>{FO(e,t)}),e.addCommand("mceInsertClipboardContent",(t,r)=>{r.html&&Fu(e,r.html,r.internal,!1),r.text&&Ff(e,r.text,!1)})},FB=(e,t,r)=>{if(!e)return!1;try{return e.clearData(),e.setData("text/html",t),e.setData("text/plain",r),e.setData(LU(),t),!0}catch(e){return!1}},FP=(e,t,r,n)=>{FB(e.clipboardData,t.html,t.text)?(e.preventDefault(),n()):r(t.html,n)},FL=e=>(t,r)=>{let{dom:n,selection:o}=e,a=n.create("div",{contenteditable:"false","data-mce-bogus":"all"}),l=n.create("div",{contenteditable:"true"},t);n.setStyles(a,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),a.appendChild(l),n.add(e.getBody(),a);let i=o.getRng();l.focus();let s=n.createRng();s.selectNodeContents(l),o.setRng(s),pd.setEditorTimeout(e,()=>{o.setRng(i),n.remove(a),r()},0)},FF=e=>({html:Lj(e.selection.getContent({contextual:!0})),text:e.selection.getContent({format:"text"})}),FM=e=>!!e.dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody()),FI=e=>!e.selection.isCollapsed()||FM(e),FU=e=>t=>{!t.isDefaultPrevented()&&FI(e)&&FP(t,FF(e),FL(e),()=>{if(tJ.browser.isChromium()||tJ.browser.isFirefox()){let t=e.selection.getRng();pd.setEditorTimeout(e,()=>{e.selection.setRng(t),e.execCommand("Delete")},0)}else e.execCommand("Delete")})},Fz=e=>t=>{!t.isDefaultPrevented()&&FI(e)&&FP(t,FF(e),FL(e),W)},Fj=e=>{e.on("cut",FU(e)),e.on("copy",Fz(e))},FH=(e,t)=>{var r,n;return gE.getCaretRangeFromPoint(null!==(r=t.clientX)&&void 0!==r?r:0,null!==(n=t.clientY)&&void 0!==n?n:0,e.getDoc())},F$=e=>{let t=e["text/plain"];return!!t&&0===t.indexOf("file://")},Fq=(e,t)=>{e.focus(),t&&e.selection.setRng(t)},FV=e=>eu(e.files,e=>/^image\//.test(e.type)),FW=(e,t,r,n)=>{let o=e.getParent(r,e=>aJ(t,e));return!I(e.getParent(r,"summary"))||!!(o&&eG(n,"text/html"))&&!I(new DOMParser().parseFromString(n["text/html"],"text/html").body.querySelector(o.nodeName.toLowerCase()))},FK=e=>{e.on("input",t=>{"deleteByDrag"===t.inputType&&eg(eb(e.dom.select("details"),e=>I(e.querySelector("summary"))),t=>{oD(t.firstChild)&&t.firstChild.remove();let r=e.dom.create("summary");r.appendChild(o5().dom),t.prepend(r)})})},FG=(e,t)=>{cc(e)&&e.on("dragend dragover draggesture dragdrop drop drag",e=>{e.preventDefault(),e.stopPropagation()}),cm(e)||e.on("drop",e=>{let t=e.dataTransfer;t&&FV(t)&&e.preventDefault()}),e.on("drop",r=>{if(r.isDefaultPrevented())return;let n=FH(e,r);if(j(n))return;let o=Fg(r.dataTransfer),a=Fp(o,LU());if((!Fh(o)||F$(o))&&Fk(e,r,n))return;let l=o[LU()],i=l||o["text/html"]||o["text/plain"],s=FW(e.dom,e.schema,n.startContainer,o),d=t.get();(!d||s)&&i&&(r.preventDefault(),pd.setEditorTimeout(e,()=>{e.undoManager.transact(()=>{(l||d&&s)&&e.execCommand("Delete"),Fq(e,n);let t=L3(i);o["text/html"]?Fu(e,t,a,!0):Ff(e,t,!0)})}))}),e.on("dragstart",e=>{t.set(!0)}),e.on("dragover dragend",r=>{cm(e)&&!t.get()&&(r.preventDefault(),Fq(e,FH(e,r))),"dragend"===r.type&&t.set(!1)}),FK(e)},FY=e=>{let t=t=>r=>{t(e,r)},r=cu(e);$(r)&&e.on("PastePreProcess",t(r));let n=cf(e);$(n)&&e.on("PastePostProcess",t(n))},FX=(e,t)=>{e.on("PastePreProcess",r=>{r.content=t(e,r.content,r.internal)})},FQ=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,FJ=e=>t2.trim(e).replace(FQ,ui).toLowerCase(),FZ=(e,t,r)=>{let n=cp(e);if(r||"all"===n||!ch(e))return t;let o=n?n.split(/[, ]/):[];if(o&&"none"!==n){let r=e.dom,n=e.selection.getNode();t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(e,t,a,l)=>{let i=r.parseStyle(r.decode(a)),s={};for(let e=0;e<o.length;e++){let t=i[o[e]],a=t,l=r.getStyle(n,o[e],!0);/color/.test(o[e])&&(a=FJ(a),l=FJ(l)),l!==a&&(s[o[e]]=t)}let d=r.serializeStyle(s,"span");return d?t+' style="'+d+'"'+l:t+l})}else t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return t=t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(e,t,r,n)=>t+' style="'+r+'"'+n)},F0=e=>{(tJ.browser.isChromium()||tJ.browser.isSafari())&&FX(e,FZ)},F1=e=>{let t=ia(!1),r=ia(cy(e)?"text":"html"),n=L0(e);F0(e),FT(e,r),FY(e),e.on("PreInit",()=>{Fj(e),FG(e,t),FA(e,n,r)})},F2=e=>{e.on("click",t=>{e.dom.getParent(t.target,"details")&&t.preventDefault()})},F3=e=>{e.parser.addNodeFilter("details",t=>{let r=cM(e);eg(t,e=>{"expanded"===r?e.attr("open","open"):"collapsed"===r&&e.attr("open",null)})}),e.serializer.addNodeFilter("details",t=>{let r=cI(e);eg(t,e=>{"expanded"===r?e.attr("open","open"):"collapsed"===r&&e.attr("open",null)})})},F8=e=>{F2(e),F3(e)},F5=e=>oO(e.dom),F6=e=>oA(e.dom),F9=e=>t=>rW(rz.fromDom(e),t),F4=(e,t)=>nh(rz.fromDom(e),e=>F6(e)||oV(e),F9(t)).getOr(rz.fromDom(t)).dom,F7=(e,t)=>nh(rz.fromDom(e),F5,F9(t)),Me=(e,t,r)=>{let n=new od(e,t),o=r?n.next.bind(n):n.prev.bind(n),a=e;for(let t=r?e:o();t&&!oD(t);t=o())ap(t)&&(a=t);return a},Mt=(e,t)=>{let r=sf.fromRangeStart(e).getNode(),n=F4(r,t),o=Me(r,n,!1),a=Me(r,n,!0),l=document.createRange();return F7(o,n).fold(()=>{ow(o)?l.setStart(o,0):l.setStartBefore(o)},e=>l.setStartBefore(e.dom)),F7(a,n).fold(()=>{ow(a)?l.setEnd(a,a.data.length):l.setEndAfter(a)},e=>l.setEndAfter(e.dom)),l},Mr=e=>{let t=Mt(e.selection.getRng(),e.getBody());e.selection.setRng(ys(t))},Mn=e=>{e.on("mousedown",t=>{t.detail>=3&&(t.preventDefault(),Mr(e))})};(g=y||(y={})).Before="before",g.After="after";let Mo=(e,t)=>Math.abs(e.left-t),Ma=(e,t)=>Math.abs(e.right-t),Ml=(e,t)=>e>=t.top&&e<=t.bottom,Mi=(e,t)=>e.top<t.bottom&&e.bottom>t.top,Ms=(e,t)=>{let r=i2(e,t)/Math.min(e.height,t.height);return Mi(e,t)&&r>.5},Md=(e,t)=>i0(eb(e,e=>Ml(t,e))).fold(()=>[[],e],t=>{let{pass:r,fail:n}=eh(e,e=>Ms(e,t));return[r,n]}),Mc=(e,t)=>({node:e.node,position:Mo(e,t)<Ma(e,t)?y.Before:y.After}),Mm=(e,t,r)=>t>e.left&&t<e.right?0:Math.min(Math.abs(e.left-t),Math.abs(e.right-t)),Mu=(e,t,r)=>{let n=e=>ap(e.node)?ea.some(e):ou(e.node)?Mu(eB(e.node.childNodes),t,r):ea.none(),o=(e,o)=>{if(e.length>=2){let a=n(e[0]).getOr(e[0]),l=n(e[1]).getOr(e[1]);if(2>Math.abs(o(a,t,r)-o(l,t,r))){if(ow(a.node))return ea.some(a);if(ow(l.node))return ea.some(l)}}return ea.none()},a=(e,a)=>{let l=eR(e,(e,n)=>a(e,t,r)-a(n,t,r));return o(l,a).orThunk(()=>eP(l,n))},[l,i]=Md(DH(e),r),{pass:s,fail:d}=eh(i,e=>e.top<r);return a(l,Mm).orThunk(()=>a(d,i1)).orThunk(()=>a(s,i1))},Mf=(e,t,r,n)=>{let o=(t,a)=>{let l=eb(t.dom.childNodes,Z(e=>ou(e)&&e.classList.contains("mce-drag-container")));return a.fold(()=>Mu(l,r,n),e=>Mu(eb(l,t=>t!==e.dom),r,n)).orThunk(()=>(rW(t,e)?ea.none():rZ(t)).bind(e=>o(e,ea.some(t))))};return o(t,ea.none())},Mg=(e,t,r)=>{let n=rz.fromDom(e),o=rY(n),a=rz.fromPoint(o,t,r).filter(e=>rK(n,e)).getOr(n);return Mf(n,a,t,r)},Mp=(e,t,r)=>Mg(e,t,r).filter(e=>c0(e.node)).map(e=>Mc(e,t)),Mh=e=>{var t,r;let n=e.getBoundingClientRect(),o=e.ownerDocument,a=o.documentElement,l=o.defaultView;return{top:n.top+(null!==(t=null==l?void 0:l.scrollY)&&void 0!==t?t:0)-a.clientTop,left:n.left+(null!==(r=null==l?void 0:l.scrollX)&&void 0!==r?r:0)-a.clientLeft}},Mb=e=>e.inline?Mh(e.getBody()):{left:0,top:0},Mv=e=>{let t=e.getBody();return e.inline?{left:t.scrollLeft,top:t.scrollTop}:{left:0,top:0}},My=e=>{let t=e.getBody(),r=e.getDoc().documentElement,n={left:t.scrollLeft,top:t.scrollTop},o={left:t.scrollLeft||r.scrollLeft,top:t.scrollTop||r.scrollTop};return e.inline?n:o},MC=(e,t)=>{if(t.target.ownerDocument!==e.getDoc()){let r=Mh(e.getContentAreaContainer()),n=My(e);return{left:t.pageX-r.left+n.left,top:t.pageY-r.top+n.top}}return{left:t.pageX,top:t.pageY}},Mx=(e,t,r)=>({pageX:r.left-e.left+t.left,pageY:r.top-e.top+t.top}),Mw=(e,t)=>Mx(Mb(e),Mv(e),MC(e,t)),ME=e=>({target:e,srcElement:e}),Mk=(e,t,r,n)=>({...t,dataTransfer:n,type:e,...ME(r)}),MS=(e,t,r)=>{let n=ee("Function not supported on simulated event.");return{bubbles:!0,cancelBubble:!1,cancelable:!0,composed:!1,currentTarget:null,defaultPrevented:!1,eventPhase:0,isTrusted:!0,returnValue:!1,timeStamp:0,type:e,composedPath:n,initEvent:n,preventDefault:W,stopImmediatePropagation:W,stopPropagation:W,AT_TARGET:window.Event.AT_TARGET,BUBBLING_PHASE:window.Event.BUBBLING_PHASE,CAPTURING_PHASE:window.Event.CAPTURING_PHASE,NONE:window.Event.NONE,altKey:!1,button:0,buttons:0,clientX:0,clientY:0,ctrlKey:!1,metaKey:!1,movementX:0,movementY:0,offsetX:0,offsetY:0,pageX:0,pageY:0,relatedTarget:null,screenX:0,screenY:0,shiftKey:!1,x:0,y:0,detail:0,view:null,which:0,initUIEvent:n,initMouseEvent:n,getModifierState:n,dataTransfer:r,...ME(t)}},M_=(e,t)=>{let r=LL(e);return"dragstart"===t?(Lh(r),LS(r)):"drop"===t?(Lb(r),L_(r)):(Lv(r),LN(r)),r},MN=(e,t,r,n)=>{let o=M_(r,e);return z(n)?MS(e,t,o):Mk(e,n,t,o)},MD=((...e)=>t=>{for(let r=0;r<e.length;r++)if(e[r](t))return!0;return!1})(oO,oA),MR=(e,t,r)=>oO(r)&&r!==t&&e.isEditable(r.parentElement),MA=(e,t,r)=>!j(t)&&!(t===r||e.dom.isChildOf(t,r))&&e.dom.isEditable(t),MO=(e,t,r,n)=>{let o=e.dom,a=t.cloneNode(!0);o.setStyles(a,{width:r,height:n}),o.setAttrib(a,"data-mce-selected",null);let l=o.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return o.setStyles(l,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:r,height:n}),o.setStyles(a,{margin:0,boxSizing:"border-box"}),l.appendChild(a),l},MT=(e,t)=>{e.parentNode!==t&&t.appendChild(e)},MB=(e,t)=>r=>()=>{let n="left"===e?r.scrollX:r.scrollY;r.scroll({[e]:n+t,behavior:"smooth"})},MP=MB("left",-32),ML=MB("left",32),MF=MB("top",-32),MM=MB("top",32),MI=(e,t,r,n,o,a,l,i,s,d,c,m)=>{let u=0,f=0;e.style.left=t.pageX+"px",e.style.top=t.pageY+"px",t.pageX+r>o&&(u=t.pageX+r-o),t.pageY+n>a&&(f=t.pageY+n-a),e.style.width=r-u+"px",e.style.height=n-f+"px";let g=s.clientHeight,p=s.clientWidth,h=l+s.getBoundingClientRect().top,b=i+s.getBoundingClientRect().left;c.on(e=>{e.intervalId.clear(),e.dragging&&m&&(l+8>=g?e.intervalId.set(MM(d)):l-8<=0?e.intervalId.set(MF(d)):i+8>=p?e.intervalId.set(ML(d)):i-8<=0?e.intervalId.set(MP(d)):h+16>=window.innerHeight?e.intervalId.set(MM(window)):h-16<=0?e.intervalId.set(MF(window)):b+16>=window.innerWidth?e.intervalId.set(ML(window)):b-16<=0&&e.intervalId.set(MP(window)))})},MU=e=>{e&&e.parentNode&&e.parentNode.removeChild(e)},Mz=(e,t)=>{let r=e.getParent(t.parentNode,e.isBlock);MU(t),r&&r!==e.getRoot()&&e.isEmpty(r)&&o6(rz.fromDom(r))},Mj=e=>0===e.button,MH=(e,t)=>({pageX:t.pageX-e.relX,pageY:t.pageY+5}),M$=(e,t)=>r=>{if(Mj(r)){let n=ex(t.dom.getParents(r.target),MD).getOr(null);if(H(n)&&MR(t.dom,t.getBody(),n)){let o=t.dom.getPos(n),a=t.getBody(),l=t.getDoc().documentElement;e.set({element:n,dataTransfer:LP(),dragging:!1,screenX:r.screenX,screenY:r.screenY,maxX:(t.inline?a.scrollWidth:l.offsetWidth)-2,maxY:(t.inline?a.scrollHeight:l.offsetHeight)-2,relX:r.pageX-o.x,relY:r.pageY-o.y,width:n.offsetWidth,height:n.offsetHeight,ghost:MO(t,n,n.offsetWidth,n.offsetHeight),intervalId:ih(100)})}}},Mq=(e,t,r)=>{e._selectionOverrides.hideFakeCaret(),Mp(e.getBody(),t,r).fold(()=>e.selection.placeCaretAt(t,r),n=>{let o=e._selectionOverrides.showCaret(1,n.node,n.position===y.Before,!1);o?e.selection.setRng(o):e.selection.placeCaretAt(t,r)})},MV=(e,t,r,n,o)=>{"dragstart"===t&&LM(n,e.dom.getOuterHTML(r));let a=MN(t,r,n,o);return e.dispatch(t,a)},MW=(e,t)=>{let r=iv((e,r)=>Mq(t,e,r),0);return t.on("remove",r.cancel),n=>e.on(o=>{let a=Math.max(Math.abs(n.screenX-o.screenX),Math.abs(n.screenY-o.screenY));if(!o.dragging&&a>10){let e=MV(t,"dragstart",o.element,o.dataTransfer,n);if(H(e.dataTransfer)&&(o.dataTransfer=e.dataTransfer),e.isDefaultPrevented())return;o.dragging=!0,t.focus()}if(o.dragging){let a=n.currentTarget===t.getDoc().documentElement,l=MH(o,Mw(t,n));MT(o.ghost,t.getBody()),MI(o.ghost,l,o.width,o.height,o.maxX,o.maxY,n.clientY,n.clientX,t.getContentAreaContainer(),t.getWin(),e,a),r.throttle(n.clientX,n.clientY)}})},MK=e=>{let t=e.getSel();if(!H(t))return null;{let e=t.getRangeAt(0).startContainer;return ow(e)?e.parentNode:e}},MG=(e,t)=>r=>{e.on(e=>{var n;if(e.intervalId.clear(),e.dragging){if(MA(t,MK(t.selection),e.element)){let o=null!==(n=t.getDoc().elementFromPoint(r.clientX,r.clientY))&&void 0!==n?n:t.getBody();MV(t,"drop",o,e.dataTransfer,r).isDefaultPrevented()||t.undoManager.transact(()=>{Mz(t.dom,e.element),LF(e.dataTransfer).each(e=>t.insertContent(e)),t._selectionOverrides.hideFakeCaret()})}MV(t,"dragend",t.getBody(),e.dataTransfer,r)}}),MQ(e)},MY=(e,t,r)=>{e.on(e=>{e.intervalId.clear(),e.dragging&&r.fold(()=>MV(t,"dragend",e.element,e.dataTransfer),r=>MV(t,"dragend",e.element,e.dataTransfer,r))}),MQ(e)},MX=(e,t)=>r=>MY(e,t,ea.some(r)),MQ=e=>{e.on(e=>{e.intervalId.clear(),MU(e.ghost)}),e.clear()},MJ=e=>{let t=ib(),r=it.DOM,n=document,o=M$(t,e),a=MW(t,e),l=MG(t,e),i=MX(t,e);e.on("mousedown",o),e.on("mousemove",a),e.on("mouseup",l),r.bind(n,"mousemove",a),r.bind(n,"mouseup",i),e.on("remove",()=>{r.unbind(n,"mousemove",a),r.unbind(n,"mouseup",i)}),e.on("keydown",r=>{r.keyCode===fz.ESC&&MY(t,e,ea.none())})},MZ=e=>{let t=t=>{if(!t.isDefaultPrevented()){let r=t.dataTransfer;r&&(em(r.types,"Files")||r.files.length>0)&&(t.preventDefault(),"drop"===t.type&&S8(e,"Dropped file type is not supported"))}},r=r=>{pv(e,r.target)&&t(r)},n=()=>{let n=it.DOM,o=e.dom,a=document,l=e.inline?e.getBody():e.getDoc(),i=["drop","dragover"];eg(i,e=>{n.bind(a,e,r),o.bind(l,e,t)}),e.on("remove",()=>{eg(i,e=>{n.unbind(a,e,r),o.unbind(l,e,t)})})};e.on("init",()=>{pd.setEditorTimeout(e,n,0)})},M0=e=>{MJ(e),d7(e)&&MZ(e)},M1=e=>{let t=iv(()=>{if(!e.removed&&e.getBody().contains(document.activeElement)){let t=e.selection.getRng();if(t.collapsed){let r=Ny(e,t,!1);e.selection.setRng(r)}}},0);e.on("focus",()=>{t.throttle()}),e.on("blur",()=>{t.cancel()})},M2=e=>{e.on("init",()=>{e.on("focusin",t=>{let r=t.target;if(oP(r)){let t=vX(e.getBody(),r),n=oO(t)?t:r;e.selection.getNode()!==n&&Nb(e,n).each(t=>e.selection.setRng(t))}})})},M3=(e,t)=>vX(e.getBody(),t),M8=e=>{let t;let r=e.selection,n=e.dom,o=e.getBody(),a=cQ(e,o,n.isBlock,()=>pT(e)),l="sel-"+n.uniqueId(),i="data-mce-selected",s=e=>H(e)&&n.hasClass(e,"mce-offscreen-selection"),d=e=>e!==o&&(oO(e)||oP(e))&&n.isChildOf(e,o)&&n.isEditable(e.parentNode),c=e=>{e&&r.setRng(e)},m=(t,n,o,l=!0)=>e.dispatch("ShowCaret",{target:n,direction:t,before:o}).isDefaultPrevented()?null:(l&&r.scrollIntoView(n,-1===t),a.show(o,n)),u=e=>at(e)||ai(e)||as(e),f=e=>u(e.startContainer)||u(e.endContainer),g=t=>{let r=e.schema.getVoidElements(),o=n.createRng(),a=t.startContainer,l=t.startOffset,i=t.endContainer,s=t.endOffset;return eG(r,a.nodeName.toLowerCase())?0===l?o.setStartBefore(a):o.setStartAfter(a):o.setStart(a,l),eG(r,i.nodeName.toLowerCase())?0===s?o.setEndBefore(i):o.setEndAfter(i):o.setEnd(i,s),o},p=(t,o)=>{let a=rz.fromDom(e.getBody()),i=e.getDoc(),s=nx(a,"#"+l).getOrThunk(()=>{let e=rz.fromHtml('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>',i);return rv(e,"id",l),nz(a,e),e}),d=n.createRng();nq(s),n$(s,[rz.fromText("\xa0",i),rz.fromDom(o),rz.fromText("\xa0",i)]),d.setStart(s.dom.firstChild,1),d.setEnd(s.dom.lastChild,0),nA(s,{top:n.getPos(t,e.getBody()).y+"px"}),gZ(s);let c=r.getSel();return c&&(c.removeAllRanges(),c.addRange(d)),d},h=r=>{let o=r.cloneNode(!0),a=e.dispatch("ObjectSelected",{target:r,targetClone:o});if(a.isDefaultPrevented())return null;let l=p(r,a.targetClone),s=rz.fromDom(r);return eg(oi(rz.fromDom(e.getBody()),`*[${i}]`),e=>{rW(s,e)||rE(e,i)}),n.getAttrib(r,i)||r.setAttribute(i,"1"),t=r,C(),l},b=(e,t)=>{if(!e)return null;if(e.collapsed){if(!f(e)){let r=t?1:-1,a=mi(r,o,e),l=a.getNode(!t);if(H(l)){if(c0(l))return m(r,l,!!t&&!a.isAtEnd(),!1);if(ae(l)&&oO(l.nextSibling)){let e=n.createRng();return e.setStart(l,0),e.setEnd(l,0),e}}let i=a.getNode(t);if(H(i)){if(c0(i))return m(r,i,!t&&!a.isAtEnd(),!1);if(ae(i)&&oO(i.previousSibling)){let e=n.createRng();return e.setStart(i,1),e.setEnd(i,1),e}}}return null}let r=e.startContainer,a=e.startOffset,l=e.endOffset;if(ow(r)&&0===a&&oO(r.parentNode)&&(r=r.parentNode,a=n.nodeIndex(r),r=r.parentNode),!ou(r))return null;if(l===a+1&&r===e.endContainer){let e=r.childNodes[a];if(d(e))return h(e)}return null},v=()=>{t&&t.removeAttribute(i),nx(rz.fromDom(e.getBody()),"#"+l).each(nV),t=null},C=()=>{a.hide()};return kp(e)||(()=>{e.on("click",t=>{n.isEditable(t.target)||(t.preventDefault(),e.focus())}),e.on("blur NewBlock",v),e.on("ResizeWindow FullscreenStateChanged",a.reposition),e.on("tap",t=>{let r=t.target,n=M3(e,r);oO(n)?(t.preventDefault(),Nb(e,n).each(b)):d(r)&&Nb(e,r).each(b)},!0),e.on("mousedown",t=>{let r=t.target;if(r!==o&&"HTML"!==r.nodeName&&!n.isChildOf(r,o)||!SG(e,t.clientX,t.clientY))return;v(),C();let a=M3(e,r);oO(a)?(t.preventDefault(),Nb(e,a).each(b)):Mp(o,t.clientX,t.clientY).each(r=>{t.preventDefault(),c(m(1,r.node,r.position===y.Before,!1)),ou(a)?a.focus():e.getBody().focus()})}),e.on("keypress",e=>{!fz.modifierPressed(e)&&oO(r.getNode())&&e.preventDefault()}),e.on("GetSelectionRange",e=>{let r=e.range;if(t){if(!t.parentNode){t=null;return}(r=r.cloneRange()).selectNode(t),e.range=r}}),e.on("SetSelectionRange",e=>{e.range=g(e.range);let t=b(e.range,e.forward);t&&(e.range=t)});let l=e=>ou(e)&&"mcepastebin"===e.id;e.on("AfterSetSelectionRange",e=>{let t=e.range,r=t.startContainer.parentElement;f(t)||l(r)||C(),s(r)||v()}),M0(e),M1(e),M2(e)})(),{showCaret:m,showBlockCaretContainer:e=>{e.hasAttribute("data-mce-caret")&&(ac(e),r.scrollIntoView(e))},hideFakeCaret:C,destroy:()=>{a.destroy(),t=null}}},M5=(e,t)=>{let r=t;for(let t=e.previousSibling;ow(t);t=t.previousSibling)r+=t.data.length;return r},M6=(e,t,r,n,o)=>{if(ow(r)&&(n<0||n>r.data.length))return[];let a=o&&ow(r)?[M5(r,n)]:[n],l=r;for(;l!==t&&l.parentNode;)a.push(e.nodeIndex(l,o)),l=l.parentNode;return l===t?a.reverse():[]},M9=(e,t,r,n,o,a,l=!1)=>({start:M6(e,t,r,n,l),end:M6(e,t,o,a,l)}),M4=(e,t)=>{let r=t.slice(),n=r.pop();return q(n)?ey(r,(e,t)=>e.bind(e=>ea.from(e.childNodes[t])),ea.some(e)).bind(e=>ow(e)&&(n<0||n>e.data.length)?ea.none():ea.some({node:e,offset:n})):ea.none()},M7=(e,t)=>M4(e,t.start).bind(({node:r,offset:n})=>M4(e,t.end).map(({node:e,offset:t})=>{let o=document.createRange();return o.setStart(r,n),o.setEnd(e,t),o})),Ie=(e,t,r,n=!1)=>M9(e,t,r.startContainer,r.startOffset,r.endContainer,r.endOffset,n),It=(e,t,r)=>{if(t&&e.isEmpty(t)&&!r(t)){let n=t.parentNode;e.remove(t,ow(t.firstChild)&&aw(t.firstChild.data)),It(e,n,r)}},Ir=(e,t,r,n=!0)=>{let o=t.startContainer.parentNode,a=t.endContainer.parentNode;t.deleteContents(),n&&!r(t.startContainer)&&(ow(t.startContainer)&&0===t.startContainer.data.length&&e.remove(t.startContainer),ow(t.endContainer)&&0===t.endContainer.data.length&&e.remove(t.endContainer),It(e,o,r),o!==a&&It(e,a,r))},In=(e,t)=>ea.from(e.dom.getParent(t.startContainer,e.dom.isBlock)),Io=(e,t,r)=>{let n=e.dynamicPatternsLookup({text:r,block:t});return{...e,blockPatterns:sQ(n).concat(e.blockPatterns),inlinePatterns:sJ(n).concat(e.inlinePatterns)}},Ia=(e,t,r,n)=>{let o=e.createRng();return o.setStart(t,0),o.setEnd(r,n),o.toString()},Il=e=>/^\s[^\s]/.test(e),Ii=(e,t,r)=>{OM(t,0,t).each(n=>{let o=n.container;OU(o,r.start.length,t).each(r=>{let n=e.createRng();n.setStart(o,0),n.setEnd(r.container,r.offset),Ir(e,n,e=>e===t)});let a=rz.fromDom(o),l=oz(a);Il(l)&&oH(a,l.slice(1))})},Is=(e,t)=>{let r=e.dom,n=t.pattern,o=M7(r.getRoot(),t.range).getOrDie("Unable to resolve path range"),a=(e,t)=>{let r=t.get(e);return M(r)&&eO(r).exists(e=>eG(e,"block"))};return In(e,o).each(t=>{"block-format"===n.type?a(n.format,e.formatter)&&e.undoManager.transact(()=>{Ii(e.dom,t,n),e.formatter.apply(n.format)}):"block-command"===n.type&&e.undoManager.transact(()=>{Ii(e.dom,t,n),e.execCommand(n.cmd,!1,n.value)})}),!0},Id=e=>eR(e,(e,t)=>t.start.length-e.start.length),Ic=(e,t)=>{let r=Id(e),n=t.replace("\xa0"," ");return ex(r,e=>0===t.indexOf(e.start)||0===n.indexOf(e.start))},Im=(e,t,r,n)=>{var o;let a=e.dom,l=dd(e);if(!a.is(t,l))return[];let i=null!==(o=t.textContent)&&void 0!==o?o:"";return Ic(r.blockPatterns,i).map(e=>t2.trim(i).length===e.start.length?[]:[{pattern:e,range:M9(a,a.getRoot(),t,0,t,0,n)}]).getOr([])},Iu=(e,t)=>{if(0===t.length)return;let r=e.selection.getBookmark();eg(t,t=>Is(e,t)),e.selection.moveToBookmark(r)},If=(e,t)=>e.create("span",{"data-mce-type":"bookmark",id:t}),Ig=(e,t)=>{let r=e.createRng();return r.setStartAfter(t.start),r.setEndBefore(t.end),r},Ip=(e,t,r)=>{let n=M7(e.getRoot(),r).getOrDie("Unable to resolve path range"),o=n.startContainer,a=n.endContainer,l=0===n.endOffset?a:a.splitText(n.endOffset),i=0===n.startOffset?o:o.splitText(n.startOffset),s=i.parentNode;return{prefix:t,end:l.parentNode.insertBefore(If(e,t+"-end"),l),start:s.insertBefore(If(e,t+"-start"),i)}},Ih=(e,t,r)=>{It(e,e.get(t.prefix+"-end"),r),It(e,e.get(t.prefix+"-start"),r)},Ib=e=>0===e.start.length,Iv=e=>(t,r)=>{let n=t.data.substring(0,r),o=n.lastIndexOf(e.charAt(e.length-1)),a=n.lastIndexOf(e);return -1!==a?a+e.length:-1!==o?o+1:-1},Iy=(e,t,r,n)=>{let o=t.start;return Oz(e,n.container,n.offset,Iv(o),r).bind(n=>{var a,l;let i=null!==(l=null===(a=r.textContent)||void 0===a?void 0:a.indexOf(o))&&void 0!==l?l:-1;if(-1!==i&&n.offset>=i+o.length){let t=e.createRng();return t.setStart(n.container,n.offset-o.length),t.setEnd(n.container,n.offset),ea.some(t)}{let a=n.offset-o.length;return OI(n.container,a,r).map(t=>{let r=e.createRng();return r.setStart(t.container,t.offset),r.setEnd(n.container,n.offset),r}).filter(e=>e.toString()===o).orThunk(()=>Iy(e,t,r,OT(n.container,0)))}})},IC=(e,t,r,n,o,a=!1)=>{if(0===t.start.length&&!a){let t=e.createRng();return t.setStart(r,n),t.setEnd(r,n),ea.some(t)}return OF(r,n,o).bind(r=>Iy(e,t,o,r).bind(e=>{var t;return a&&(e.endContainer===r.container&&e.endOffset===r.offset||0===r.offset&&(null===(t=e.endContainer.textContent)||void 0===t?void 0:t.length)===e.endOffset)?ea.none():ea.some(e)}))},Ix=(e,t,r,n)=>{let o=e.dom,a=o.getRoot(),l=r.pattern,i=r.position.container,s=r.position.offset;return OI(i,s-r.pattern.end.length,t).bind(d=>{let c=M9(o,a,d.container,d.offset,i,s,n);if(Ib(l))return ea.some({matches:[{pattern:l,startRng:c,endRng:c}],position:d});{let i=Iw(e,r.remainingPatterns,d.container,d.offset,t,n),s=i.getOr({matches:[],position:d}),m=s.position;return IC(o,l,m.container,m.offset,t,i.isNone()).map(e=>{let t=Ie(o,a,e,n);return{matches:s.matches.concat([{pattern:l,startRng:t,endRng:c}]),position:OT(e.startContainer,e.startOffset)}})}})},Iw=(e,t,r,n,o,a)=>{let l=e.dom;return OF(r,n,l.getRoot()).bind(i=>{let s=Ia(l,o,r,n);for(let l=0;l<t.length;l++){let d=t[l];if(!tu(s,d.end))continue;let c=t.slice();c.splice(l,1);let m=Ix(e,o,{pattern:d,remainingPatterns:c,position:i},a);if(m.isNone()&&n>0)return Iw(e,t,r,n-1,o,a);if(m.isSome())return m}return ea.none()})},IE=(e,t,r)=>{e.selection.setRng(r),"inline-format"===t.type?eg(t.format,t=>{e.formatter.apply(t)}):e.execCommand(t.cmd,!1,t.value)},Ik=(e,t,r,n)=>{let o=Ig(e.dom,r);Ir(e.dom,o,n),IE(e,t,o)},IS=(e,t,r,n,o)=>{let a=e.dom,l=Ig(a,n),i=Ig(a,r);Ir(a,i,o),Ir(a,l,o),IE(e,t,Ig(a,{prefix:r.prefix,start:r.end,end:n.start}))},I_=(e,t)=>{let r=iF("mce_textpattern"),n=ev(t,(t,n)=>{let o=Ip(e,r+`_end${t.length}`,n.endRng);return t.concat([{...n,endMarker:o}])},[]);return ev(n,(t,o)=>{let a=n.length-t.length-1,l=Ib(o.pattern)?o.endMarker:Ip(e,r+`_start${a}`,o.startRng);return t.concat([{...o,startMarker:l}])},[])},IN=e=>eR(e,(e,t)=>t.end.length-e.end.length),ID=(e,t)=>{let r=eS(e,e=>eu(t,t=>e.pattern.start===t.pattern.start&&e.pattern.end===t.pattern.end));return e.length===t.length?r?e:t:e.length>t.length?e:t},IR=(e,t,r,n,o,a)=>ID(Iw(e,o.inlinePatterns,r,n,t,a).fold(()=>[],e=>e.matches),Iw(e,IN(o.inlinePatterns),r,n,t,a).fold(()=>[],e=>e.matches)),IA=(e,t)=>{if(0===t.length)return;let r=e.dom,n=e.selection.getBookmark();eg(I_(r,t),t=>{let n=r.getParent(t.startMarker.start,r.isBlock),o=e=>e===n;Ib(t.pattern)?Ik(e,t.pattern,t.endMarker,o):IS(e,t.pattern,t.startMarker,t.endMarker,o),Ih(r,t.endMarker,o),Ih(r,t.startMarker,o)}),e.selection.moveToBookmark(n)},IO=(e,t)=>{let r=e.selection.getRng();return In(e,r).map(n=>{var o;let a=Math.max(0,r.startOffset),l=Io(t,n,null!==(o=n.textContent)&&void 0!==o?o:""),i=IR(e,n,r.startContainer,a,l,!0),s=Im(e,n,l,!0);return(s.length>0||i.length>0)&&(e.undoManager.add(),e.undoManager.extra(()=>{e.execCommand("mceInsertNewLine")},()=>{e.insertContent("\uFEFF"),IA(e,i),Iu(e,s);let t=e.selection.getRng(),r=OF(t.startContainer,t.startOffset,e.dom.getRoot());e.execCommand("mceInsertNewLine"),r.each(t=>{let r=t.container;"\uFEFF"===r.data.charAt(t.offset-1)&&(r.deleteData(t.offset-1,1),It(e.dom,r.parentNode,t=>t===e.dom.getRoot()))})}),!0)}).getOr(!1)},IT=(e,t)=>{let r=e.selection.getRng();In(e,r).map(n=>{let o=Math.max(0,r.startOffset-1),a=Ia(e.dom,n,r.startContainer,o),l=Io(t,n,a),i=IR(e,n,r.startContainer,o,l,!1);i.length>0&&e.undoManager.transact(()=>{IA(e,i)})})},IB=(e,t,r)=>{for(let n=0;n<e.length;n++)if(r(e[n],t))return!0;return!1},IP=(e,t)=>IB(e,t,(e,t)=>e===t.keyCode&&!fz.modifierPressed(t)),IL=(e,t)=>IB(e,t,(e,t)=>e.charCodeAt(0)===t.charCode),IF=e=>{let t=[",",".",";",":","!","?"],r=[32],n=()=>sZ(cw(e),cE(e)),o=()=>cO(e);e.on("keydown",t=>{if(13===t.keyCode&&!fz.modifierPressed(t)&&e.selection.isCollapsed()){let r=n();(r.inlinePatterns.length>0||r.blockPatterns.length>0||o())&&IO(e,r)&&t.preventDefault()}},!0);let a=()=>{if(e.selection.isCollapsed()){let t=n();(t.inlinePatterns.length>0||o())&&IT(e,t)}};e.on("keyup",e=>{IP(r,e)&&a()}),e.on("keypress",r=>{IL(t,r)&&pd.setEditorTimeout(e,a)})},IM=e=>{IF(e)},II=e=>{let t=t2.each,r=fz.BACKSPACE,n=fz.DELETE,o=e.dom,a=e.selection,l=e.parser,i=tJ.browser,s=i.isFirefox(),d=i.isChromium()||i.isSafari(),c=tJ.deviceType.isiPhone()||tJ.deviceType.isiPad(),m=tJ.os.isMacOS()||tJ.os.isiOS(),u=(t,r)=>{try{e.getDoc().execCommand(t,!1,String(r))}catch(e){}},f=e=>e.isDefaultPrevented(),g=()=>{e.shortcuts.add("meta+a",null,"SelectAll")},p=()=>{e.inline||o.bind(e.getDoc(),"mousedown mouseup",t=>{let r;if(t.target===e.getDoc().documentElement){if(r=a.getRng(),e.getBody().focus(),"mousedown"===t.type){if(at(r.startContainer))return;a.placeCaretAt(t.clientX,t.clientY)}else a.setRng(r)}})},h=()=>{Range.prototype.getClientRects||e.on("mousedown",t=>{if(!f(t)&&"HTML"===t.target.nodeName){let t=e.getBody();t.blur(),pd.setEditorTimeout(e,()=>{t.focus()})}})},b=()=>{let t=cr(e);e.on("click",r=>{let n=r.target;/^(IMG|HR)$/.test(n.nodeName)&&o.isEditable(n.parentNode)&&(r.preventDefault(),e.selection.select(n),e.nodeChanged()),"A"===n.nodeName&&o.hasClass(n,t)&&0===n.childNodes.length&&o.isEditable(n.parentNode)&&(r.preventDefault(),a.select(n))})},v=()=>{e.on("keydown",e=>{if(!f(e)&&e.keyCode===r&&a.isCollapsed()&&0===a.getRng().startOffset){let t=a.getNode().previousSibling;if(t&&t.nodeName&&"table"===t.nodeName.toLowerCase())return e.preventDefault(),!1}return!0})},y=()=>{d8(e)||e.on("BeforeExecCommand mousedown",()=>{u("StyleWithCSS",!1),u("enableInlineTableEditing",!1),dF(e)||u("enableObjectResizing",!1)})},C=e=>{let t=e.getBody(),r=e.selection.getRng();return r.startContainer===r.endContainer&&r.startContainer===t&&0===r.startOffset&&r.endOffset===t.childNodes.length},x=()=>{e.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},w=()=>{e.inline||e.on("keydown",()=>{document.activeElement===document.body&&e.getWin().focus()})},E=()=>{e.inline||(e.contentStyles.push("body {min-height: 150px}"),e.on("click",t=>{let r;"HTML"===t.target.nodeName&&(r=e.selection.getRng(),e.getBody().focus(),e.selection.setRng(r),e.selection.normalize(),e.nodeChanged())}))},k=()=>{m&&e.on("keydown",t=>{fz.metaKeyPressed(t)&&!t.shiftKey&&(37===t.keyCode||39===t.keyCode)&&(t.preventDefault(),e.selection.getSel().modify("move",37===t.keyCode?"backward":"forward","lineboundary"))})},S=()=>{e.on("click",e=>{let t=e.target;do if("A"===t.tagName){e.preventDefault();return}while(t=t.parentNode)}),e.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},_=()=>{e.on("init",()=>{e.dom.bind(e.getBody(),"submit",e=>{e.preventDefault()})})};return kp(e)?(d&&(p(),b(),_(),g(),c&&(w(),E(),S())),s&&(h(),y(),x(),k())):(e.on("keydown",t=>{if(f(t)||t.keyCode!==fz.BACKSPACE)return;let r=a.getRng(),n=r.startContainer,l=r.startOffset,i=o.getRoot(),s=n;if(r.collapsed&&0===l){for(;s.parentNode&&s.parentNode.firstChild===s&&s.parentNode!==i;)s=s.parentNode;"BLOCKQUOTE"===s.nodeName&&(e.formatter.toggle("blockquote",void 0,s),(r=o.createRng()).setStart(n,0),r.setEnd(n,0),a.setRng(r))}}),(()=>{let t=e=>{let t=o.create("body"),r=e.cloneContents();return t.appendChild(r),a.serializer.serialize(t,{format:"html"})},l=r=>{let n=t(r),a=o.createRng();return a.selectNode(e.getBody()),n===t(a)},i=e=>eu(oi(rz.fromDom(e),'[contenteditable="true"]'),e=>rZ(e).exists(e=>!nk(e)));e.on("keydown",t=>{let a=t.keyCode;if(!f(t)&&(a===n||a===r)&&e.selection.isEditable()){let r=e.selection.isCollapsed(),n=e.getBody();if(r&&(!o.isEmpty(n)||i(n))||!r&&!l(e.selection.getRng()))return;t.preventDefault(),e.setContent(""),n.firstChild&&o.isBlock(n.firstChild)?e.selection.setCursorLocation(n.firstChild,0):e.selection.setCursorLocation(n,0),e.nodeChanged()}})})(),tJ.windowsPhone||e.on("keyup focusin mouseup",t=>{fz.modifierPressed(t)||C(e)||a.normalize()},!0),d&&(p(),b(),e.on("init",()=>{u("DefaultParagraphSeparator",dd(e))}),_(),v(),l.addNodeFilter("br",e=>{let t=e.length;for(;t--;)"Apple-interchange-newline"===e[t].attr("class")&&e[t].remove()}),c?(w(),E(),S()):g()),s&&(e.on("keydown",t=>{if(!f(t)&&t.keyCode===r&&e.getBody().getElementsByTagName("hr").length&&a.isCollapsed()&&0===a.getRng().startOffset){let e=a.getNode(),r=e.previousSibling;if("HR"===e.nodeName){o.remove(e),t.preventDefault();return}r&&r.nodeName&&"hr"===r.nodeName.toLowerCase()&&(o.remove(r),t.preventDefault())}}),h(),(()=>{let r=()=>{let r=o.getAttribs(a.getStart().cloneNode(!1));return()=>{let n=a.getStart();n!==e.getBody()&&(o.setAttrib(n,"style",null),t(r,e=>{n.setAttributeNode(e.cloneNode(!0))}))}},n=()=>!a.isCollapsed()&&o.getParent(a.getStart(),o.isBlock)!==o.getParent(a.getEnd(),o.isBlock);e.on("keypress",t=>{let o;return!(!f(t)&&(8===t.keyCode||46===t.keyCode)&&n())||(o=r(),e.getDoc().execCommand("delete",!1),o(),t.preventDefault(),!1)}),o.bind(e.getDoc(),"cut",t=>{if(!f(t)&&n()){let t=r();pd.setEditorTimeout(e,()=>{t()})}})})(),y(),(()=>{let r=()=>{t(o.select("a:not([data-mce-block])"),e=>{var t;let r=e.parentNode,n=o.getRoot();if((null==r?void 0:r.lastChild)===e){for(;r&&!o.isBlock(r);){if((null===(t=r.parentNode)||void 0===t?void 0:t.lastChild)!==r||r===n)return;r=r.parentNode}o.add(r,"br",{"data-mce-bogus":1})}})};e.on("SetContent ExecCommand",e=>{("setcontent"===e.type||"mceInsertLink"===e.command)&&r()})})(),x(),k(),v(),e.on("drop",t=>{var r;let n=null===(r=t.dataTransfer)||void 0===r?void 0:r.getData("text/html");P(n)&&/^<img[^>]*>$/.test(n)&&e.dispatch("dragend",new window.DragEvent("dragend",t))}))),{refreshContentEditable:W,isHidden:()=>{if(!s||e.removed)return!1;let t=e.selection.getSel();return!t||!t.rangeCount||0===t.rangeCount}}},IU=it.DOM,Iz=(e,t)=>{let r=ni(nl(rz.fromDom(e.getBody()))),n=rz.fromTag("style");rv(n,"type","text/css"),nz(n,rz.fromText(t)),nz(r,n),e.on("remove",()=>{nV(n)})},Ij=e=>e.inline?e.getElement().nodeName.toLowerCase():void 0,IH=e=>eq(e,e=>!1===z(e)),I$=e=>{let t=e.options.get,r=e.editorUpload.blobCache;return IH({allow_conditional_comments:t("allow_conditional_comments"),allow_html_data_urls:t("allow_html_data_urls"),allow_svg_data_urls:t("allow_svg_data_urls"),allow_html_in_named_anchor:t("allow_html_in_named_anchor"),allow_script_urls:t("allow_script_urls"),allow_unsafe_link_target:t("allow_unsafe_link_target"),convert_fonts_to_spans:t("convert_fonts_to_spans"),fix_list_elements:t("fix_list_elements"),font_size_legacy_values:t("font_size_legacy_values"),forced_root_block:t("forced_root_block"),forced_root_block_attrs:t("forced_root_block_attrs"),preserve_cdata:t("preserve_cdata"),inline_styles:t("inline_styles"),root_name:Ij(e),sanitize:t("xss_sanitization"),validate:!0,blob_cache:r,document:e.getDoc()})},Iq=e=>{let t=e.options.get;return IH({custom_elements:t("custom_elements"),extended_valid_elements:t("extended_valid_elements"),invalid_elements:t("invalid_elements"),invalid_styles:t("invalid_styles"),schema:t("schema"),valid_children:t("valid_children"),valid_classes:t("valid_classes"),valid_elements:t("valid_elements"),valid_styles:t("valid_styles"),verify_html:t("verify_html"),padd_empty_block_inline_children:t("format_empty_lines")})},IV=e=>{let t=e.options.get;return{...I$(e),...Iq(e),...IH({remove_trailing_brs:t("remove_trailing_brs"),pad_empty_with_br:t("pad_empty_with_br"),url_converter:t("url_converter"),url_converter_scope:t("url_converter_scope"),element_format:t("element_format"),entities:t("entities"),entity_encoding:t("entity_encoding"),indent:t("indent"),indent_after:t("indent_after"),indent_before:t("indent_before")})}},IW=e=>{let t=w7(I$(e),e.schema);return t.addAttributeFilter("src,href,style,tabindex",(t,r)=>{let n=e.dom,o="data-mce-"+r,a=t.length;for(;a--;){let l=t[a],i=l.attr(r);if(i&&!l.attr(o)){if(0===i.indexOf("data:")||0===i.indexOf("blob:"))continue;"style"===r?((i=n.serializeStyle(n.parseStyle(i),l.name)).length||(i=null),l.attr(o,i),l.attr(r,i)):"tabindex"===r?(l.attr(o,i),l.attr(r,null)):l.attr(o,e.convertURL(i,r,l.name))}}}),t.addNodeFilter("script",e=>{let t=e.length;for(;t--;){let r=e[t],n=r.attr("type")||"no/type";0!==n.indexOf("mce-")&&r.attr("type","mce-"+n)}}),cN(e)&&t.addNodeFilter("#cdata",t=>{var r;let n=t.length;for(;n--;){let o=t[n];o.type=8,o.name="#comment",o.value="[CDATA["+e.dom.encode(null!==(r=o.value)&&void 0!==r?r:"")+"]]"}}),t.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",t=>{let r=t.length,n=e.schema.getNonEmptyElements();for(;r--;){let e=t[r];e.isEmpty(n)&&0===e.getAll("br").length&&e.append(new p4("br",1))}}),t},IK=e=>{let t=ci(e);t&&pd.setEditorTimeout(e,()=>{let r;(r=!0===t?e:e.editorManager.get(t))&&!r.destroyed&&(r.focus(),r.selection.scrollIntoView())},100)},IG=e=>{let t=e.dom.getRoot();e.inline||uw(e)&&e.selection.getStart(!0)!==t||mT(t).each(t=>{let r=t.getNode(),n=oy(r)?mT(r).getOr(t):t;e.selection.setRng(n.toRange())})},IY=e=>{e.bindPendingEventDelegates(),e.initialized=!0,fk(e),e.focus(!0),IG(e),e.nodeChanged({initial:!0});let t=ca(e);$(t)&&t.call(e,e),IK(e)},IX=e=>e.inline?e.ui.styleSheetLoader:e.dom.styleSheetLoader,IQ=(e,t,r)=>{let n=[IX(e).loadAll(t)];return e.inline?n:n.concat([e.ui.styleSheetLoader.loadAll(r)])},IJ=e=>{let t=IX(e),r=dB(e),n=e.contentCSS,o=()=>{t.unloadAll(n),e.inline||e.ui.styleSheetLoader.unloadAll(r)},a=()=>{e.removed?o():e.on("remove",o)};if(e.contentStyles.length>0){let t="";t2.each(e.contentStyles,e=>{t+=e+"\r\n"}),e.dom.addStyle(t)}let l=Promise.all(IQ(e,n,r)).then(a).catch(a),i=dT(e);return i&&Iz(e,i),l},IZ=e=>{let t=e.getDoc(),r=e.getBody();fw(e),cs(e)||(t.body.spellcheck=!1,IU.setAttrib(r,"spellcheck","false")),e.quirks=II(e),fE(e);let n=dP(e);void 0!==n&&(r.dir=n);let o=cd(e);o&&e.on("BeforeSetContent",e=>{t2.each(o,t=>{e.content=e.content.replace(t,e=>"<!--mce:protected "+escape(e)+"-->")})}),e.on("SetContent",()=>{e.addVisual(e.getBody())}),e.on("compositionstart compositionend",t=>{e.composing="compositionstart"===t.type})},I0=e=>{kp(e)||e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"})},I1=e=>{!0!==e.removed&&(I0(e),IY(e))},I2=e=>{let t=!1,r=setTimeout(()=>{t||e.setProgressState(!0)},500);return()=>{clearTimeout(r),t=!0,e.setProgressState(!1)}},I3=e=>{let t=e.getElement(),r=e.getDoc();e.inline&&(IU.addClass(t,"mce-content-body"),e.contentDocument=r=document,e.contentWindow=window,e.bodyElement=t,e.contentAreaContainer=t);let n=e.getBody();n.disabled=!0,e.readonly=d8(e),e._editableRoot=d5(e),!e.readonly&&e.hasEditableRoot()&&(e.inline&&"static"===IU.getStyle(n,"position",!0)&&(n.style.position="relative"),n.contentEditable="true"),n.disabled=!1,e.editorUpload=_w(e),e.schema=lU(Iq(e)),e.dom=it(r,{keep_values:!0,url_converter:e.convertURL,url_converter_scope:e,update_styles:!0,root_element:e.inline?e.getBody():null,collect:e.inline,schema:e.schema,contentCssCors:dS(e),referrerPolicy:d_(e),onSetAttrib:t=>{e.dispatch("SetAttrib",t)}}),e.parser=IW(e),e.serializer=Sm(IV(e),e),e.selection=k4(e.dom,e.getWin(),e.serializer,e),e.annotator=fu(e),e.formatter=_F(e),e.undoManager=_z(e),e._nodeChangeDispatcher=new Ls(e),e._selectionOverrides=M8(e),An(e),F8(e),Ap(e),kp(e)||(Mn(e),IM(e));let o=Li(e);Ae(e,o),Am(e),_G(e),F1(e);let a=kb(e);IZ(e),a.fold(()=>{let t=I2(e);IJ(e).then(()=>{I1(e),t()})},t=>{e.setProgressState(!0),IJ(e).then(()=>{t().then(t=>{e.setProgressState(!1),I1(e),kV(e)},t=>{e.notificationManager.open({type:"error",text:String(t)}),I1(e),kV(e)})})})},I8=(e,t,r)=>n2(e,t,eo,r),I5=it.DOM,I6=(e,t,r,n)=>{let o=rz.fromTag("iframe");return n.each(e=>rv(o,"tabindex",e)),ry(o,r),ry(o,{id:e+"_ifr",frameBorder:"0",allowTransparency:"true",title:t}),rP(o,"tox-edit-area__iframe"),o},I9=e=>{let t=dr(e)+"<html><head>";dn(e)!==e.documentBaseUrl&&(t+='<base href="'+e.documentBaseURI.getURI()+'" />'),t+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';let r=da(e),n=dl(e),o=e.translate(cn(e));return di(e)&&(t+='<meta http-equiv="Content-Security-Policy" content="'+di(e)+'" />'),t+=`</head><body id="${r}" class="mce-content-body ${n}" data-id="${e.id}" aria-label="${o}"><br></body></html>`},I4=(e,t)=>{let r=e.translate("Rich Text Area"),n=rx(rz.fromDom(e.getElement()),"tabindex").bind(tC),o=I6(e.id,r,dt(e),n).dom;o.onload=()=>{o.onload=null,e.dispatch("load")},e.contentAreaContainer=t.iframeContainer,e.iframeElement=o,e.iframeHTML=I9(e),I5.add(t.iframeContainer,o)},I7=e=>{let t=e.iframeElement,r=()=>{e.contentDocument=t.contentDocument,I3(e)};if(cA(e)||tJ.browser.isFirefox()){let t=e.getDoc();t.open(),t.write(e.iframeHTML),t.close(),r()}else{let n=I8(rz.fromDom(t),"load",()=>{n.unbind(),r()});t.srcdoc=e.iframeHTML}},Ue=(e,t)=>{I4(e,t),t.editorContainer&&(t.editorContainer.style.display=e.orgDisplay,e.hidden=I5.isHidden(t.editorContainer)),e.getElement().style.display="none",I5.setAttrib(e.id,"aria-hidden","true"),e.getElement().style.visibility=e.orgVisibility,I7(e)},Ut=it.DOM,Ur=(e,t,r)=>{let n=SZ.get(r),o=SZ.urls[r]||e.documentBaseUrl.replace(/\/$/,"");if(r=t2.trim(r),n&&-1===t2.inArray(t,r)){if(e.plugins[r])return;try{let a=n(e,o)||{};e.plugins[r]=a,$(a.init)&&(a.init(e,o),t.push(r))}catch(t){_n(e,r,t)}}},Un=e=>e.replace(/^\-/,""),Uo=e=>{let t=[];eg(d9(e),r=>{Ur(e,t,Un(r))})},Ua=e=>{let t=t2.trim(dy(e)),r=e.ui.registry.getAll().icons;eI({...SM.get("default").icons,...SM.get(t).icons},(t,n)=>{eG(r,n)||e.ui.registry.addIcon(n,t)})},Ul=e=>{let t=dj(e);if(P(t)){let r=S0.get(t);e.theme=r(e,S0.urls[t])||{},$(e.theme.init)&&e.theme.init(e,S0.urls[t]||e.documentBaseUrl.replace(/\/$/,""))}else e.theme={}},Ui=e=>{let t=d$(e),r=SI.get(t);e.model=r(e,SI.urls[t])},Us=e=>{let t=e.theme.renderUI;return t?t():Uu(e)},Ud=e=>{let t=e.getElement(),r=dj(e)(e,t);return r.editorContainer.nodeType&&(r.editorContainer.id=r.editorContainer.id||e.id+"_parent"),r.iframeContainer&&r.iframeContainer.nodeType&&(r.iframeContainer.id=r.iframeContainer.id||e.id+"_iframecontainer"),r.height=r.iframeHeight?r.iframeHeight:t.offsetHeight,r},Uc=(e,t)=>({editorContainer:e,iframeContainer:t,api:{}}),Um=e=>{let t=Ut.create("div");return Ut.insertAfter(t,e),Uc(t,t)},Uu=e=>{let t=e.getElement();return e.inline?Uc(null):Um(t)},Uf=e=>{let t=e.getElement();return(e.orgDisplay=t.style.display,P(dj(e)))?Us(e):$(dj(e))?Ud(e):Uu(e)},Ug=(e,t)=>{let r={show:ea.from(t.show).getOr(W),hide:ea.from(t.hide).getOr(W),isEnabled:ea.from(t.isEnabled).getOr(eo),setEnabled:r=>{e.mode.isReadOnly()||ea.from(t.setEnabled).each(e=>e(r))}};e.ui={...e.ui,...r}},Up=async e=>{e.dispatch("ScriptsLoaded"),Ua(e),Ul(e),Ui(e),Uo(e);let t=await Uf(e);Ug(e,ea.from(t.api).getOr({})),e.editorContainer=t.editorContainer,_d(e),e.inline?I3(e):Ue(e,{editorContainer:t.editorContainer,iframeContainer:t.iframeContainer})},Uh=it.DOM,Ub=e=>"-"===e.charAt(0),Uv=(e,t)=>{let r=dN(t),n=dD(t);if(!iu.hasCode(r)&&"en"!==r){let o=tb(n)?n:`${t.editorManager.baseURL}/langs/${r}.js`;e.add(o).catch(()=>{_e(t,o,r)})}},Uy=(e,t)=>{let r=dj(e);if(P(r)&&!Ub(r)&&!eG(S0.urls,r)){let n=dH(e),o=n?e.documentBaseURI.toAbsolute(n):`themes/${r}/theme${t}.js`;S0.load(r,o).catch(()=>{_t(e,o,r)})}},UC=(e,t)=>{let r=d$(e);if("plugin"!==r&&!eG(SI.urls,r)){let n=dq(e),o=P(n)?e.documentBaseURI.toAbsolute(n):`models/${r}/model${t}.js`;SI.load(r,o).catch(()=>{_r(e,o,r)})}},Ux=e=>ea.from(dC(e)).filter(tb).map(e=>({url:e,name:ea.none()})),Uw=(e,t,r)=>ea.from(t).filter(e=>tb(e)&&!SM.has(e)).map(t=>({url:`${e.editorManager.baseURL}/icons/${t}/icons${r}.js`,name:ea.some(t)})),UE=(e,t,r)=>{eg(t5([Uw(t,"default",r),Ux(t).orThunk(()=>Uw(t,dy(t),""))]),r=>{e.add(r.url).catch(()=>{S7(t,r.url,r.name.getOrUndefined())})})},Uk=(e,t)=>{let r=(t,r)=>{SZ.load(t,r).catch(()=>{S4(e,r,t)})};eI(d4(e),(t,n)=>{r(n,t),e.options.set("plugins",d9(e).concat(n))}),eg(d9(e),e=>{(e=t2.trim(e))&&!SZ.urls[e]&&!Ub(e)&&r(e,`plugins/${e}/plugin${t}.js`)})},US=e=>{let t=dj(e);return!P(t)||H(S0.get(t))},U_=e=>{let t=d$(e);return H(SI.get(t))},UN=(e,t)=>{let r=io.ScriptLoader,n=()=>{!e.removed&&US(e)&&U_(e)&&Up(e)};Uy(e,t),UC(e,t),Uv(r,e),UE(r,e,t),Uk(e,t),r.loadQueue().then(n,n)},UD=(e,t)=>a9.forElement(e,{contentCssCors:d6(t),referrerPolicy:d_(t)}),UR=e=>{let t=e.id;iu.setCode(dN(e));let r=()=>{Uh.unbind(window,"ready",r),e.render()};if(!lZ.Event.domLoaded){Uh.bind(window,"ready",r);return}if(!e.getElement())return;let n=rz.fromDom(e.getElement()),o=rS(n);e.on("remove",()=>{ep(n.dom.attributes,e=>rE(n,e.name)),ry(n,o)}),e.ui.styleSheetLoader=UD(n,e),dQ(e)?e.inline=!0:(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden");let a=e.getElement().form||Uh.getParent(t,"form");!a||(e.formElement=a,dJ(e)&&!ox(e.getElement())&&(Uh.insertAfter(Uh.create("input",{type:"hidden",name:t}),t),e.hasHiddenInput=!0),e.formEventDelegate=t=>{e.dispatch(t.type,t)},Uh.bind(a,"submit reset",e.formEventDelegate),e.on("reset",()=>{e.resetContent()}),!dZ(e)||a.submit.nodeType||a.submit.length||a._mceOldSubmit||(a._mceOldSubmit=a.submit,a.submit=()=>(e.editorManager.triggerSave(),e.setDirty(!1),a._mceOldSubmit(a)))),e.windowManager=S2(e),e.notificationManager=SJ(e),cP(e)&&e.on("GetContent",e=>{e.save&&(e.content=Uh.encode(e.content))}),d0(e)&&e.on("submit",()=>{e.initialized&&e.save()}),d1(e)&&(e._beforeUnload=()=>{!e.initialized||e.destroyed||e.isHidden()||e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),UN(e,e.suffix)},UA=(e,t)=>{e._editableRoot!==t&&(e._editableRoot=t,e.readonly||(e.getBody().contentEditable=String(e.hasEditableRoot()),e.nodeChanged()),fU(e,t))},UO=e=>e._editableRoot,UT=(e,t)=>({sections:Y(e),options:Y(t)}),UB=tV().deviceType,UP=UB.isPhone(),UL=UB.isTablet(),UF=e=>j(e)?[]:eb(ef(M(e)?e:e.split(/[ ,]/),tg),tb),UM=(e,t)=>{let r=e$(t,(t,r)=>em(e,r));return UT(r.t,r.f)},UI=(e,t,r={})=>{let n=eK(e.sections(),t).getOr({});return t2.extend({},r,n)},UU=(e,t)=>eG(e.sections(),t),Uz=(e,t)=>UU(e,t)?e.sections()[t]:{},Uj=(e,t)=>({table_grid:!1,object_resizing:!1,resize:!1,toolbar_mode:eK(e,"toolbar_mode").getOr("scrolling"),toolbar_sticky:!1,...t?{menubar:!1}:{}}),UH=(e,t)=>{var r;let n=null!==(r=t.external_plugins)&&void 0!==r?r:{};return e&&e.external_plugins?t2.extend({},e.external_plugins,n):n},U$=(e,t)=>[...UF(e),...UF(t)],Uq=(e,t,r,n)=>e&&UU(t,"mobile")?n:r,UV=(e,t,r,n)=>{let o=UF(r.forced_plugins),a=UF(n.plugins),l=Uz(t,"mobile"),i=l.plugins?UF(l.plugins):a,s=U$(o,Uq(e,t,a,i));return t2.extend(n,{forced_plugins:o,plugins:s})},UW=(e,t)=>e&&UU(t,"mobile"),UK=(e,t,r,n,o)=>{var a;let l=UM(["mobile"],Ta(e?{mobile:Uj(null!==(a=o.mobile)&&void 0!==a?a:{},t)}:{},o)),i=t2.extend(r,n,l.options(),UW(e,l)?UI(l,"mobile"):{},{external_plugins:UH(n,l.options())});return UV(e,l,n,i)},UG=(e,t)=>UK(UP||UL,UP,t,e,t),UY=(e,t)=>kq(e,t),UX=e=>{let t=(t,r)=>{e.formatter.toggle(t,r),e.nodeChanged()},r=r=>()=>{eg("left,center,right,justify".split(","),t=>{r!==t&&e.formatter.remove("align"+t)}),"none"!==r&&t("align"+r)};e.editorCommands.addCommands({JustifyLeft:r("left"),JustifyCenter:r("center"),JustifyRight:r("right"),JustifyFull:r("justify"),JustifyNone:r("none")})},UQ=e=>{let t=t=>()=>{let r=e.selection;return eu(r.isCollapsed()?[e.dom.getParent(r.getNode(),e.dom.isBlock)]:r.getSelectedBlocks(),r=>H(e.formatter.matchNode(r,t)))};e.editorCommands.addCommands({JustifyLeft:t("alignleft"),JustifyCenter:t("aligncenter"),JustifyRight:t("alignright"),JustifyFull:t("alignjustify")},"state")},UJ=e=>{UX(e),UQ(e)},UZ=e=>{e.editorCommands.addCommands({"Cut,Copy,Paste":t=>{let r;let n=e.getDoc();try{n.execCommand(t)}catch(e){r=!0}if("paste"!==t||n.queryCommandEnabled(t)||(r=!0),r||!n.queryCommandSupported(t)){let t=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");(tJ.os.isMacOS()||tJ.os.isiOS())&&(t=t.replace(/Ctrl\+/g,"⌘+")),e.notificationManager.open({text:t,type:"error"})}}})},U0=(e,t,r)=>{let n=rz.fromDom(e.getRoot());return r=bi(n,sf.fromRangeStart(t))?r.replace(/^ /,"&nbsp;"):r.replace(/^&nbsp;/," "),r=bd(n,sf.fromRangeEnd(t))?r.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):r.replace(/&nbsp;(<br( \/)?>)?$/," ")},U1=e=>{if("string"!=typeof e){let t=t2.extend({paste:e.paste,data:{paste:e.paste}},e);return{content:e.content,details:t}}return{content:e,details:{}}},U2=(e,t)=>{let r=e.selection,n=e.dom;return/^ | $/.test(t)?U0(n,r.getRng(),t):t},U3=(e,t)=>{if(e.selection.isEditable()){let{content:r,details:n}=U1(t);Eo(e,{...n,content:U2(e,r),format:"html",set:!1,selection:!0}).each(t=>{let r=kH(e,t.content,n);Ea(e,r,t),e.addVisual()})}},U8=e=>{e.editorCommands.addCommands({mceCleanup:()=>{let t=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(t)},insertImage:(t,r,n)=>{U3(e,e.dom.createHTML("img",{src:n}))},insertHorizontalRule:()=>{e.execCommand("mceInsertContent",!1,"<hr>")},insertText:(t,r,n)=>{U3(e,e.dom.encode(n))},insertHTML:(t,r,n)=>{U3(e,n)},mceInsertContent:(t,r,n)=>{U3(e,n)},mceSetContent:(t,r,n)=>{e.setContent(n)},mceReplaceContent:(t,r,n)=>{e.execCommand("mceInsertContent",!1,n.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceNewDocument:()=>{e.setContent(cg(e))}})},U5={"font-size":"size","font-family":"face"},U6=rh("font"),U9=(e,t,r)=>{let n=t=>nB(t,e).orThunk(()=>U6(t)?eK(U5,e).bind(e=>rx(t,e)):ea.none());return y0(rz.fromDom(r),e=>n(e),e=>rW(rz.fromDom(t),e))},U4=(e,t)=>ea.from(it.DOM.getStyle(t,e,!0)),U7=e=>(t,r)=>ea.from(r).map(rz.fromDom).filter(ru).bind(r=>U9(e,t,r.dom).or(U4(e,r.dom))).getOr(""),ze=U7("font-size"),zt=K(e=>e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,","),U7("font-family")),zr=e=>mT(e.getBody()).bind(e=>{let t=e.container();return ea.from(ow(t)?t.parentNode:t)}),zn=e=>ea.from(e.selection.getRng()).bind(t=>{let r=e.getBody();return t.startContainer===r&&0===t.startOffset?ea.none():ea.from(e.selection.getStart(!0))}),zo=(e,t)=>zn(e).orThunk(J(zr,e)).map(rz.fromDom).filter(ru).bind(t),za=(e,t)=>zo(e,G(ea.some,t)),zl=(e,t)=>{if(!/^[0-9.]+$/.test(t))return t;{let r=parseInt(t,10);if(!(r>=1)||!(r<=7))return t;{let n=cT(e),o=cB(e);return o.length>0?o[r-1]||t:n[r-1]||t}}},zi=e=>ef(e.split(/\s*,\s*/),e=>-1===e.indexOf(" ")||tm(e,'"')||tm(e,"'")?e:`'${e}'`).join(","),zs=(e,t)=>{let r=zl(e,t);e.formatter.toggle("fontname",{value:zi(r)}),e.nodeChanged()},zd=e=>za(e,t=>zt(e.getBody(),t.dom)).getOr(""),zc=(e,t)=>{e.formatter.toggle("fontsize",{value:zl(e,t)}),e.nodeChanged()},zm=e=>za(e,t=>ze(e.getBody(),t.dom)).getOr(""),zu=e=>za(e,t=>y0(t,e=>nB(e,"line-height"),J(rW,rz.fromDom(e.getBody()))).getOrThunk(()=>String(parseFloat(nO(t,"line-height"))/parseFloat(nO(t,"font-size"))))).getOr(""),zf=(e,t)=>{e.formatter.toggle("lineheight",{value:String(t)}),e.nodeChanged()},zg=e=>{let t=(t,r)=>{e.formatter.toggle(t,r),e.nodeChanged()};e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":e=>{t(e)},"ForeColor,HiliteColor":(e,r,n)=>{t(e,{value:n})},BackColor:(e,r,n)=>{t("hilitecolor",{value:n})},FontName:(t,r,n)=>{zs(e,n)},FontSize:(t,r,n)=>{zc(e,n)},LineHeight:(t,r,n)=>{zf(e,n)},Lang:(e,r,n)=>{var o;t(e,{value:n.code,customValue:null!==(o=n.customCode)&&void 0!==o?o:null})},RemoveFormat:t=>{e.formatter.remove(t)},mceBlockQuote:()=>{t("blockquote")},FormatBlock:(e,r,n)=>{t(P(n)?n:"p")},mceToggleFormat:(e,r,n)=>{t(n)}})},zp=e=>{let t=t=>e.formatter.match(t);e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":e=>t(e),mceBlockQuote:()=>t("blockquote")},"state"),e.editorCommands.addQueryValueHandler("FontName",()=>zd(e)),e.editorCommands.addQueryValueHandler("FontSize",()=>zm(e)),e.editorCommands.addQueryValueHandler("LineHeight",()=>zu(e))},zh=e=>{zg(e),zp(e)},zb=e=>{e.editorCommands.addCommands({mceAddUndoLevel:()=>{e.undoManager.add()},mceEndUndoLevel:()=>{e.undoManager.add()},Undo:()=>{e.undoManager.undo()},Redo:()=>{e.undoManager.redo()}})},zv=e=>{e.editorCommands.addCommands({Indent:()=>{R8(e)},Outdent:()=>{R5(e)}}),e.editorCommands.addCommands({Outdent:()=>RZ(e)},"state")},zy=e=>{let t=(t,r,n)=>{let o=P(n)?{href:n}:n,a=e.dom.getParent(e.selection.getNode(),"a");L(o)&&P(o.href)&&(o.href=o.href.replace(/ /g,"%20"),a&&o.href||e.formatter.remove("link"),o.href&&e.formatter.apply("link",o,a))};e.editorCommands.addCommands({unlink:()=>{if(e.selection.isEditable()){if(e.selection.isCollapsed()){let t=e.dom.getParent(e.selection.getStart(),"a");t&&e.dom.remove(t,!0);return}e.formatter.remove("link")}},mceInsertLink:t,createLink:t})},zC=e=>{e.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":t=>{e.getDoc().execCommand(t);let r=e.dom.getParent(e.selection.getNode(),"ol,ul");if(r){let t=r.parentNode;if(t&&/^(H[1-6]|P|ADDRESS|PRE)$/.test(t.nodeName)){let n=e.selection.getBookmark();e.dom.split(t,r),e.selection.moveToBookmark(n)}}}})},zx=e=>{e.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":t=>{let r=e.dom.getParent(e.selection.getNode(),"ul,ol");return r&&("insertunorderedlist"===t&&"UL"===r.tagName||"insertorderedlist"===t&&"OL"===r.tagName)}},"state")},zw=e=>{zC(e),zx(e)},zE=(e,t,r,n)=>{let o=e.dom,a=e=>o.isBlock(e)&&e.parentElement===r,l=a(t)?t:o.getParent(n,a,r);return ea.from(l).map(rz.fromDom)},zk=(e,t)=>{let r=e.dom,n=e.selection.getRng(),o=t?e.selection.getStart():e.selection.getEnd(),a=t?n.startContainer:n.endContainer,l=Bj(r,a);if(!l||!l.isContentEditable)return;let i=t?nM:nI,s=dd(e);zE(e,o,l,a).each(t=>{let r=BG(e,a,t.dom,l,!1,s);i(t,rz.fromDom(r)),e.selection.setCursorLocation(r,0),e.dispatch("NewBlock",{newBlock:r}),BA(e,"insertParagraph")})},zS=e=>zk(e,!0),z_=e=>zk(e,!1),zN=e=>{e.editorCommands.addCommands({InsertNewBlockBefore:()=>{zS(e)},InsertNewBlockAfter:()=>{z_(e)}})},zD=e=>{e.editorCommands.addCommands({insertParagraph:()=>{Pz(Pc,e)},mceInsertNewLine:(t,r,n)=>{Pj(e,n)},InsertLineBreak:(t,r,n)=>{Pz(Pw,e)}})},zR=e=>{e.editorCommands.addCommands({mceSelectNodeDepth:(t,r,n)=>{let o=0;e.dom.getParent(e.selection.getNode(),t=>!ou(t)||o++!==n||(e.selection.select(t),!1),e.getBody())},mceSelectNode:(t,r,n)=>{e.selection.select(n)},selectAll:()=>{let t=e.dom.getParent(e.selection.getStart(),oA);if(t){let r=e.dom.createRng();r.selectNodeContents(t),e.selection.setRng(r)}}})},zA=e=>{e.editorCommands.addCommands({mceRemoveNode:(t,r,n)=>{let o=null!=n?n:e.selection.getNode();if(o!==e.getBody()){let t=e.selection.getBookmark();e.dom.remove(o,!0),e.selection.moveToBookmark(t)}},mcePrint:()=>{e.getWin().print()},mceFocus:(t,r,n)=>{pF(e,!0===n)},mceToggleVisualAid:()=>{e.hasVisual=!e.hasVisual,e.addVisual()}})},zO=e=>{UJ(e),UZ(e),zb(e),zR(e),U8(e),zy(e),zv(e),zN(e),zD(e),zw(e),zh(e),zA(e)},zT=["toggleview"],zB=e=>em(zT,e.toLowerCase());class zP{constructor(e){this.commands={state:{},exec:{},value:{}},this.editor=e}execCommand(e,t=!1,r,n){let o=this.editor,a=e.toLowerCase(),l=null==n?void 0:n.skip_focus;if(o.removed||("mcefocus"!==a&&(/^(mceAddUndoLevel|mceEndUndoLevel)$/i.test(a)||l?pa(o):o.focus()),o.dispatch("BeforeExecCommand",{command:e,ui:t,value:r}).isDefaultPrevented()))return!1;let i=this.commands.exec[a];return!!$(i)&&(i(a,t,r),o.dispatch("ExecCommand",{command:e,ui:t,value:r}),!0)}queryCommandState(e){if(!zB(e)&&this.editor.quirks.isHidden()||this.editor.removed)return!1;let t=e.toLowerCase(),r=this.commands.state[t];return!!$(r)&&r(t)}queryCommandValue(e){if(!zB(e)&&this.editor.quirks.isHidden()||this.editor.removed)return"";let t=e.toLowerCase(),r=this.commands.value[t];return $(r)?r(t):""}addCommands(e,t="exec"){let r=this.commands;eI(e,(e,n)=>{eg(n.toLowerCase().split(","),n=>{r[t][n]=e})})}addCommand(e,t,r){let n=e.toLowerCase();this.commands.exec[n]=(e,n,o)=>t.call(null!=r?r:this.editor,n,o)}queryCommandSupported(e){let t=e.toLowerCase();return!!this.commands.exec[t]}addQueryStateHandler(e,t,r){this.commands.state[e.toLowerCase()]=()=>t.call(null!=r?r:this.editor)}addQueryValueHandler(e,t,r){this.commands.value[e.toLowerCase()]=()=>t.call(null!=r?r:this.editor)}}let zL="data-mce-contenteditable",zF=(e,t,r)=>{rI(e,t)&&!r?rF(e,t):r&&rP(e,t)},zM=(e,t,r)=>{try{e.getDoc().execCommand(t,!1,String(r))}catch(e){}},zI=(e,t)=>{e.dom.contentEditable=t?"true":"false"},zU=e=>{eg(oi(e,'*[contenteditable="true"]'),e=>{rv(e,zL,"true"),zI(e,!1)})},zz=e=>{eg(oi(e,`*[${zL}="true"]`),e=>{rE(e,zL),zI(e,!0)})},zj=e=>{ea.from(e.selection.getNode()).each(e=>{e.removeAttribute("data-mce-selected")})},zH=e=>{e.selection.setRng(e.selection.getRng())},z$=(e,t)=>{let r=rz.fromDom(e.getBody());zF(r,"mce-content-readonly",t),t?(e.selection.controlSelection.hideResizeRect(),e._selectionOverrides.hideFakeCaret(),zj(e),e.readonly=!0,zI(r,!1),zU(r)):(e.readonly=!1,e.hasEditableRoot()&&zI(r,!0),zz(r),zM(e,"StyleWithCSS",!1),zM(e,"enableInlineTableEditing",!1),zM(e,"enableObjectResizing",!1),pB(e)&&e.focus(),zH(e),e.nodeChanged())},zq=e=>e.readonly,zV=e=>{e.parser.addAttributeFilter("contenteditable",t=>{zq(e)&&eg(t,e=>{e.attr(zL,e.attr("contenteditable")),e.attr("contenteditable","false")})}),e.serializer.addAttributeFilter(zL,t=>{zq(e)&&eg(t,e=>{e.attr("contenteditable",e.attr(zL))})}),e.serializer.addTempAttr(zL)},zW=e=>{e.serializer?zV(e):e.on("PreInit",()=>{zV(e)})},zK=e=>"click"===e.type,zG=["copy"],zY=e=>em(zG,e.type),zX=(e,t)=>nw(t,"a",t=>rW(t,rz.fromDom(e.getBody()))).bind(e=>rx(e,"href")),zQ=(e,t)=>{zK(t)&&!fz.metaKeyPressed(t)?zX(e,rz.fromDom(t.target)).each(r=>{if(t.preventDefault(),/^#/.test(r)){let t=e.dom.select(`${r},[name="${td(r,"#")}"]`);t.length&&e.selection.scrollIntoView(t[0],!0)}else window.open(r,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")}):zY(t)&&e.dispatch(t.type,t)},zJ=e=>{e.on("ShowCaret",t=>{zq(e)&&t.preventDefault()}),e.on("ObjectSelected",t=>{zq(e)&&t.preventDefault()})},zZ=t2.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," ");class z0{static isNative(e){return!!zZ[e.toLowerCase()]}constructor(e){this.bindings={},this.settings=e||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||en}fire(e,t){return this.dispatch(e,t)}dispatch(e,t){let r=e.toLowerCase(),n=lW(r,null!=t?t:{},this.scope);this.settings.beforeFire&&this.settings.beforeFire(n);let o=this.bindings[r];if(o)for(let e=0,t=o.length;e<t;e++){let t=o[e];if(!t.removed){if(t.once&&this.off(r,t.func),n.isImmediatePropagationStopped())break;if(!1===t.func.call(this.scope,n)){n.preventDefault();break}}}return n}on(e,t,r,n){if(!1===t&&(t=en),t){let o={func:t,removed:!1};n&&t2.extend(o,n);let a=e.toLowerCase().split(" "),l=a.length;for(;l--;){let e=a[l],t=this.bindings[e];t||(t=[],this.toggleEvent(e,!0)),t=r?[o,...t]:[...t,o],this.bindings[e]=t}}return this}off(e,t){if(e){let r=e.toLowerCase().split(" "),n=r.length;for(;n--;){let o=r[n],a=this.bindings[o];if(!o){eI(this.bindings,(e,t)=>{this.toggleEvent(t,!1),delete this.bindings[t]});break}if(a){if(t){let e=eh(a,e=>e.func===t);a=e.fail,this.bindings[o]=a,eg(e.pass,e=>{e.removed=!0})}else a.length=0;a.length||(this.toggleEvent(e,!1),delete this.bindings[o])}}}else eI(this.bindings,(e,t)=>{this.toggleEvent(t,!1)}),this.bindings={};return this}once(e,t,r){return this.on(e,t,r,{once:!0})}has(e){e=e.toLowerCase();let t=this.bindings[e];return!(!t||0===t.length)}}let z1=e=>(e._eventDispatcher||(e._eventDispatcher=new z0({scope:e,toggleEvent:(t,r)=>{z0.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,r)}})),e._eventDispatcher),z2={fire(e,t,r){return this.dispatch(e,t,r)},dispatch(e,t,r){if(this.removed&&"remove"!==e&&"detach"!==e)return lW(e.toLowerCase(),null!=t?t:{},this);let n=z1(this).dispatch(e,t);if(!1!==r&&this.parent){let t=this.parent();for(;t&&!n.isPropagationStopped();)t.dispatch(e,n,!1),t=t.parent?t.parent():void 0}return n},on(e,t,r){return z1(this).on(e,t,r)},off(e,t){return z1(this).off(e,t)},once(e,t){return z1(this).once(e,t)},hasEventListeners(e){return z1(this).has(e)}},z3=it.DOM,z8=(e,t)=>{if("selectionchange"===t)return e.getDoc();if(!e.inline&&/^(?:mouse|touch|click|contextmenu|drop|dragover|dragend)/.test(t))return e.getDoc().documentElement;let r=dU(e);return r?(e.eventRoot||(e.eventRoot=z3.select(r)[0]),e.eventRoot):e.getBody()},z5=e=>!e.hidden&&!zq(e),z6=(e,t,r)=>{z5(e)?e.dispatch(t,r):zq(e)&&zQ(e,r)},z9=(e,r)=>{if(e.delegates||(e.delegates={}),e.delegates[r]||e.removed)return;let n=z8(e,r);if(dU(e)){if(t||(t={},e.editorManager.on("removeEditor",()=>{!e.editorManager.activeEditor&&t&&(eI(t,(t,r)=>{e.dom.unbind(z8(e,r))}),t=null)})),t[r])return;let o=t=>{let n=t.target,o=e.editorManager.get(),a=o.length;for(;a--;){let e=o[a].getBody();(e===n||z3.isChildOf(n,e))&&z6(o[a],r,t)}};t[r]=o,z3.bind(n,r,o)}else{let t=t=>{z6(e,r,t)};z3.bind(n,r,t),e.delegates[r]=t}},z4={...z2,bindPendingEventDelegates(){let e=this;t2.each(e._pendingNativeEvents,t=>{z9(e,t)})},toggleNativeEvent(e,t){"focus"!==e&&"blur"!==e&&!this.removed&&(t?this.initialized?z9(this,e):this._pendingNativeEvents?this._pendingNativeEvents.push(e):this._pendingNativeEvents=[e]:this.initialized&&this.delegates&&(this.dom.unbind(z8(this,e),e,this.delegates[e]),delete this.delegates[e]))},unbindAllNativeEvents(){let e=this,t=e.getBody(),r=e.dom;e.delegates&&(eI(e.delegates,(t,r)=>{e.dom.unbind(z8(e,r),r,t)}),delete e.delegates),!e.inline&&t&&r&&(t.onload=null,r.unbind(e.getWin()),r.unbind(e.getDoc())),r&&(r.unbind(t),r.unbind(e.getContainer()))}},z7=e=>P(e)?{value:e.split(/[ ,]/),valid:!0}:V(e,P)?{value:e,valid:!0}:{valid:!1,message:"The value must be a string[] or a comma/space separated string."},je=e=>{let t=(()=>{switch(e){case"array":return M;case"boolean":return U;case"function":return $;case"number":return q;case"object":return L;case"string":return P;case"string[]":return z7;case"object[]":return e=>V(e,L);case"regexp":return e=>B(e,RegExp);default:return eo}})();return r=>jo(r,t,`The value must be a ${e}.`)},jt=e=>P(e.processor),jr=(e,t)=>e+(tv(t.message)?"":`. ${t.message}`),jn=e=>e.valid,jo=(e,t,r="")=>{let n=t(e);return U(n)?n?{value:e,valid:!0}:{valid:!1,message:r}:n},ja=(e,t,r)=>{if(!z(t)){let n=jo(t,r);if(jn(n))return n.value;console.error(jr(`Invalid default value passed for the "${e}" option`,n))}},jl=(e,t)=>{let r={},n={},o=(e,t,r)=>{let o=jo(t,r);return jn(o)?(n[e]=o.value,!0):(console.warn(jr(`Invalid value passed for the ${e} option`,o)),!1)},a=e=>eG(r,e);return{register:(e,a)=>{let l=jt(a)?je(a.processor):a.processor,i=ja(e,a.default,l);r[e]={...a,default:i,processor:l},eK(n,e).orThunk(()=>eK(t,e)).each(t=>o(e,t,l))},isRegistered:a,get:e=>eK(n,e).orThunk(()=>eK(r,e).map(e=>e.default)).getOrUndefined(),set:(e,t)=>{if(!a(e))return console.warn(`"${e}" is not a registered option. Ensure the option has been registered before setting a value.`),!1;{let n=r[e];return n.immutable?(console.error(`"${e}" is an immutable option and cannot be updated`),!1):o(e,t,n.processor)}},unset:e=>{let t=a(e);return t&&delete n[e],t},isSet:e=>eG(n,e)}},ji=["design","readonly"],js=(e,t,r,n)=>{let o=r[t.get()],a=r[n];try{a.activate()}catch(e){console.error(`problem while activating editor mode ${n}:`,e);return}o.deactivate(),o.editorReadOnly!==a.editorReadOnly&&z$(e,a.editorReadOnly),t.set(n),fy(e,n)},jd=(e,t,r,n)=>{if(n!==r.get()){if(!eG(t,n))throw Error(`Editor mode '${n}' is invalid`);e.initialized?js(e,r,t,n):e.on("init",()=>js(e,r,t,n))}},jc=(e,t,r)=>{if(em(ji,t))throw Error(`Cannot override default mode ${t}`);return{...e,[t]:{...r,deactivate:()=>{try{r.deactivate()}catch(e){console.error(`problem while deactivating editor mode ${t}:`,e)}}}}},jm=e=>{let t=ia("design"),r=ia({design:{activate:W,deactivate:W,editorReadOnly:!1},readonly:{activate:W,deactivate:W,editorReadOnly:!0}});return zW(e),zJ(e),{isReadOnly:()=>zq(e),set:n=>jd(e,r.get(),t,n),get:()=>t.get(),register:(e,t)=>{r.set(jc(r.get(),e,t))}}},ju=t2.each,jf=t2.explode,jg={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},jp=t2.makeMap("alt,ctrl,shift,meta,access"),jh=e=>e in jp,jb=e=>{let t;let r={},n=tJ.os.isMacOS()||tJ.os.isiOS();ju(jf(e.toLowerCase(),"+"),e=>{jh(e)?r[e]=!0:/^[0-9]{2,}$/.test(e)?r.keyCode=parseInt(e,10):(r.charCode=e.charCodeAt(0),r.keyCode=jg[e]||e.toUpperCase().charCodeAt(0))});let o=[r.keyCode];for(t in jp)r[t]?o.push(t):r[t]=!1;return r.id=o.join(","),r.access&&(r.alt=!0,n?r.ctrl=!0:r.shift=!0),r.meta&&(n?r.meta=!0:(r.ctrl=!0,r.meta=!1)),r};class jv{constructor(e){this.shortcuts={},this.pendingPatterns=[],this.editor=e;let t=this;e.on("keyup keypress keydown",e=>{(t.hasModifier(e)||t.isFunctionKey(e))&&!e.isDefaultPrevented()&&(ju(t.shortcuts,r=>{t.matchShortcut(e,r)&&(t.pendingPatterns=r.subpatterns.slice(0),"keydown"===e.type&&t.executeShortcutAction(r))}),t.matchShortcut(e,t.pendingPatterns[0])&&(1===t.pendingPatterns.length&&"keydown"===e.type&&t.executeShortcutAction(t.pendingPatterns[0]),t.pendingPatterns.shift()))})}add(e,t,r,n){let o=this,a=o.normalizeCommandFunc(r);return ju(jf(t2.trim(e)),e=>{let r=o.createShortcut(e,t,a,n);o.shortcuts[r.id]=r}),!0}remove(e){let t=this.createShortcut(e);return!!this.shortcuts[t.id]&&(delete this.shortcuts[t.id],!0)}normalizeCommandFunc(e){let t=this;return"string"==typeof e?()=>{t.editor.execCommand(e,!1,null)}:t2.isArray(e)?()=>{t.editor.execCommand(e[0],e[1],e[2])}:e}createShortcut(e,t,r,n){let o=t2.map(jf(e,">"),jb);return o[o.length-1]=t2.extend(o[o.length-1],{func:r,scope:n||this.editor}),t2.extend(o[0],{desc:this.editor.translate(t),subpatterns:o.slice(1)})}hasModifier(e){return e.altKey||e.ctrlKey||e.metaKey}isFunctionKey(e){return"keydown"===e.type&&e.keyCode>=112&&e.keyCode<=123}matchShortcut(e,t){return!!t&&t.ctrl===e.ctrlKey&&t.meta===e.metaKey&&t.alt===e.altKey&&t.shift===e.shiftKey&&(e.keyCode===t.keyCode||!!e.charCode&&e.charCode===t.charCode)&&(e.preventDefault(),!0)}executeShortcutAction(e){return e.func?e.func.call(e.scope):null}}let jy=()=>{let e={},t={},r={},n={},o={},a={},l={},i={},s=(e,t)=>(r,n)=>{e[r.toLowerCase()]={...n,type:t}};return{addButton:s(e,"button"),addGroupToolbarButton:s(e,"grouptoolbarbutton"),addToggleButton:s(e,"togglebutton"),addMenuButton:s(e,"menubutton"),addSplitButton:s(e,"splitbutton"),addMenuItem:s(t,"menuitem"),addNestedMenuItem:s(t,"nestedmenuitem"),addToggleMenuItem:s(t,"togglemenuitem"),addAutocompleter:s(r,"autocompleter"),addContextMenu:s(o,"contextmenu"),addContextToolbar:s(a,"contexttoolbar"),addContextForm:s(a,"contextform"),addSidebar:s(l,"sidebar"),addView:s(i,"views"),addIcon:(e,t)=>n[e.toLowerCase()]=t,getAll:()=>({buttons:e,menuItems:t,icons:n,popups:r,contextMenus:o,contextToolbars:a,sidebars:l,views:i})}},jC=()=>{let e=jy();return{addAutocompleter:e.addAutocompleter,addButton:e.addButton,addContextForm:e.addContextForm,addContextMenu:e.addContextMenu,addContextToolbar:e.addContextToolbar,addIcon:e.addIcon,addMenuButton:e.addMenuButton,addMenuItem:e.addMenuItem,addNestedMenuItem:e.addNestedMenuItem,addSidebar:e.addSidebar,addSplitButton:e.addSplitButton,addToggleButton:e.addToggleButton,addGroupToolbarButton:e.addGroupToolbarButton,addToggleMenuItem:e.addToggleMenuItem,addView:e.addView,getAll:e.getAll}},jx=it.DOM,jw=t2.extend,jE=t2.each;class jk{constructor(e,t,r){this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.composing=!1,this.destroyed=!1,this.hasHiddenInput=!1,this.iframeElement=null,this.initialized=!1,this.readonly=!1,this.removed=!1,this.startContent="",this._pendingNativeEvents=[],this._skinLoaded=!1,this._editableRoot=!0,this.editorManager=r,this.documentBaseUrl=r.documentBaseURL,jw(this,z4),this.id=e,this.hidden=!1;let n=UG(r.defaultOptions,t);this.options=jl(this,n),de(this);let o=this.options.get;o("deprecation_warnings")&&SR(t,n);let a=o("suffix");a&&(r.suffix=a),this.suffix=r.suffix;let l=o("base_url");l&&r._setBaseUrl(l),this.baseUri=r.baseURI;let i=d_(this);i&&(io.ScriptLoader._setReferrerPolicy(i),it.DOM.styleSheetLoader._setReferrerPolicy(i));let s=d6(this);H(s)&&it.DOM.styleSheetLoader._setContentCssCors(s),ig.languageLoad=o("language_load"),ig.baseURL=r.baseURL,this.setDirty(!1),this.documentBaseURI=new wV(dn(this),{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=dQ(this),this.hasVisual=ce(this),this.shortcuts=new jv(this),this.editorCommands=new zP(this),zO(this);let d=o("cache_suffix");d&&(tJ.cacheSuffix=d.replace(/^[\?\&]+/,"")),this.ui={registry:jC(),styleSheetLoader:void 0,show:W,hide:W,setEnabled:W,isEnabled:eo},this.mode=jm(this),r.dispatch("SetupEditor",{editor:this});let c=co(this);$(c)&&c.call(this,this)}render(){UR(this)}focus(e){this.execCommand("mceFocus",!1,e)}hasFocus(){return pT(this)}translate(e){return iu.translate(e)}getParam(e,t,r){let n=this.options;return n.isRegistered(e)||(H(r)?n.register(e,{processor:r,default:t}):n.register(e,{processor:eo,default:t})),n.isSet(e)||z(t)?n.get(e):t}hasPlugin(e,t){return!!em(d9(this),e)&&(!t||void 0!==SZ.get(e))}nodeChanged(e){this._nodeChangeDispatcher.nodeChanged(e)}addCommand(e,t,r){this.editorCommands.addCommand(e,t,r)}addQueryStateHandler(e,t,r){this.editorCommands.addQueryStateHandler(e,t,r)}addQueryValueHandler(e,t,r){this.editorCommands.addQueryValueHandler(e,t,r)}addShortcut(e,t,r,n){this.shortcuts.add(e,t,r,n)}execCommand(e,t,r,n){return this.editorCommands.execCommand(e,t,r,n)}queryCommandState(e){return this.editorCommands.queryCommandState(e)}queryCommandValue(e){return this.editorCommands.queryCommandValue(e)}queryCommandSupported(e){return this.editorCommands.queryCommandSupported(e)}show(){this.hidden&&(this.hidden=!1,this.inline?this.getBody().contentEditable="true":(jx.show(this.getContainer()),jx.hide(this.id)),this.load(),this.dispatch("show"))}hide(){this.hidden||(this.save(),this.inline?(this.getBody().contentEditable="false",this===this.editorManager.focusedEditor&&(this.editorManager.focusedEditor=null)):(jx.hide(this.getContainer()),jx.setStyle(this.id,"display",this.orgDisplay)),this.hidden=!0,this.dispatch("hide"))}isHidden(){return this.hidden}setProgressState(e,t){this.dispatch("ProgressState",{state:e,time:t})}load(e={}){let t=this.getElement();if(this.removed||!t)return"";{let r={...e,load:!0},n=ox(t)?t.value:t.innerHTML,o=this.setContent(n,r);return r.no_events||this.dispatch("LoadContent",{...r,element:t}),o}}save(e={}){let t=this,r=t.getElement();if(!r||!t.initialized||t.removed)return"";let n={...e,save:!0,element:r},o=t.getContent(n),a={...n,content:o};if(a.no_events||t.dispatch("SaveContent",a),"raw"===a.format&&t.dispatch("RawSaveContent",a),o=a.content,ox(r))r.value=o;else{(e.is_removing||!t.inline)&&(r.innerHTML=o);let n=jx.getParent(t.id,"form");n&&jE(n.elements,e=>e.name!==t.id||(e.value=o,!1))}return a.element=n.element=r=null,!1!==a.set_dirty&&t.setDirty(!1),o}setContent(e,t){return Sp(this,e,t)}getContent(e){return Sf(this,e)}insertContent(e,t){t&&(e=jw({content:e},t)),this.execCommand("mceInsertContent",!1,e)}resetContent(e){void 0===e?Sp(this,this.startContent,{format:"raw"}):Sp(this,e),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()}isDirty(){return!this.isNotDirty}setDirty(e){let t=!this.isNotDirty;this.isNotDirty=!e,e&&e!==t&&this.dispatch("dirty")}getContainer(){return this.container||(this.container=this.editorContainer||jx.get(this.id+"_parent")),this.container}getContentAreaContainer(){return this.contentAreaContainer}getElement(){return this.targetElm||(this.targetElm=jx.get(this.id)),this.targetElm}getWin(){if(!this.contentWindow){let e=this.iframeElement;e&&(this.contentWindow=e.contentWindow)}return this.contentWindow}getDoc(){if(!this.contentDocument){let e=this.getWin();e&&(this.contentDocument=e.document)}return this.contentDocument}getBody(){var e,t;let r=this.getDoc();return null!==(t=null!==(e=this.bodyElement)&&void 0!==e?e:null==r?void 0:r.body)&&void 0!==t?t:null}convertURL(e,t,r){let n=this.options.get,o=cl(this);return $(o)?o.call(this,e,r,!0,t):!n("convert_urls")||"link"===r||L(r)&&"LINK"===r.nodeName||0===e.indexOf("file:")||0===e.length?e:n("relative_urls")?this.documentBaseURI.toRelative(e):e=this.documentBaseURI.toAbsolute(e,n("remove_script_host"))}addVisual(e){UY(this,e)}setEditableRoot(e){UA(this,e)}hasEditableRoot(){return UO(this)}remove(){SL(this)}destroy(e){SF(this,e)}uploadImages(){return this.editorUpload.uploadImages()}_scanForImages(){return this.editorUpload.scanForImages()}}let jS=it.DOM,j_=t2.each,jN=!1,jD=[],jR=e=>{let t=e.type;j_(jP.get(),r=>{switch(t){case"scroll":r.dispatch("ScrollWindow",e);break;case"resize":r.dispatch("ResizeWindow",e)}})},jA=e=>{if(e!==jN){let t=it.DOM;e?(t.bind(window,"resize",jR),t.bind(window,"scroll",jR)):(t.unbind(window,"resize",jR),t.unbind(window,"scroll",jR)),jN=e}},jO=e=>{let t=jD;return jD=eb(jD,t=>e!==t),jP.activeEditor===e&&(jP.activeEditor=jD.length>0?jD[0]:null),jP.focusedEditor===e&&(jP.focusedEditor=null),t.length!==jD.length},jT=e=>{e&&e.initialized&&!(e.getContainer()||e.getBody()).parentNode&&(jO(e),e.unbindAllNativeEvents(),e.destroy(!0),e.removed=!0)},jB="CSS1Compat"!==document.compatMode,jP={...z2,baseURI:null,baseURL:null,defaultOptions:{},documentBaseURL:null,suffix:null,majorVersion:"6",minorVersion:"7.2",releaseDate:"2023-10-25",i18n:iu,activeEditor:null,focusedEditor:null,setup(){let e="",t="",r=wV.getDocumentBaseUrl(document.location);/^[^:]+:\/\/\/?[^\/]+\//.test(r)&&(r=r.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(r)||(r+="/"));let n=window.tinymce||window.tinyMCEPreInit;if(n)e=n.base||n.baseURL,t=n.suffix;else{let r=document.getElementsByTagName("script");for(let n=0;n<r.length;n++){let o=r[n].src||"";if(""===o)continue;let a=o.substring(o.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(o)){-1!==a.indexOf(".min")&&(t=".min"),e=o.substring(0,o.lastIndexOf("/"));break}}if(!e&&document.currentScript){let r=document.currentScript.src;-1!==r.indexOf(".min")&&(t=".min"),e=r.substring(0,r.lastIndexOf("/"))}}this.baseURL=new wV(r).toAbsolute(e),this.documentBaseURL=r,this.baseURI=new wV(this.baseURL),this.suffix=t,pw(this)},overrideDefaults(e){let t=e.base_url;t&&this._setBaseUrl(t);let r=e.suffix;r&&(this.suffix=r),this.defaultOptions=e;let n=e.plugin_base_urls;void 0!==n&&eI(n,(e,t)=>{ig.PluginManager.urls[t]=e})},init(e){let t;let r=this,n=t2.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),o=(e,t)=>e.inline&&t.tagName.toLowerCase() in n,a=e=>{let t=e.id;return t||(t=eK(e,"name").filter(e=>!jS.get(e)).getOrThunk(jS.uniqueId),e.setAttribute("id",t)),t},l=t=>{let n=e[t];if(n)return n.apply(r,[])},i=e=>tJ.browser.isIE()||tJ.browser.isEdge()?(_o("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tiny.cloud/docs/tinymce/6/support/#supportedwebbrowsers"),[]):jB?(_o("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[]):P(e.selector)?jS.select(e.selector):H(e.target)?[e.target]:[],s=e=>{t=e},d=()=>{let t,n=0,c=[],m=(e,o,a)=>{let l=new jk(e,o,r);c.push(l),l.on("init",()=>{++n===t.length&&s(c)}),l.targetElm=l.targetElm||a,l.render()};jS.unbind(window,"ready",d),l("onpageload"),t=eL(i(e)),t2.each(t,e=>{jT(r.get(e.id))}),0===(t=t2.grep(t,e=>!r.get(e.id))).length?s([]):j_(t,t=>{o(e,t)?_o("Could not initialize inline editor on invalid inline target element",t):m(a(t),e,t)})};return jS.bind(window,"ready",d),new Promise(e=>{t?e(t):s=t=>{e(t)}})},get(e){return 0==arguments.length?jD.slice(0):P(e)?ex(jD,t=>t.id===e).getOr(null):q(e)&&jD[e]?jD[e]:null},add(e){let t=this,n=t.get(e.id);return n===e||(null===n&&jD.push(e),jA(!0),t.activeEditor=e,t.dispatch("AddEditor",{editor:e}),r||(r=e=>{let r=t.dispatch("BeforeUnload");if(r.returnValue)return e.preventDefault(),e.returnValue=r.returnValue,r.returnValue},window.addEventListener("beforeunload",r))),e},createEditor(e,t){return this.add(new jk(e,t,this))},remove(e){let t;let n=this;if(!e){for(let e=jD.length-1;e>=0;e--)n.remove(jD[e]);return}if(P(e)){j_(jS.select(e),e=>{(t=n.get(e.id))&&n.remove(t)});return}return(t=e,I(n.get(t.id)))?null:(jO(t)&&n.dispatch("RemoveEditor",{editor:t}),0===jD.length&&window.removeEventListener("beforeunload",r),t.remove(),jA(jD.length>0),t)},execCommand(e,t,r){var n;let o=L(r)?null!==(n=r.id)&&void 0!==n?n:r.index:r;switch(e){case"mceAddEditor":return this.get(o)||new jk(o,r.options,this).render(),!0;case"mceRemoveEditor":{let e=this.get(o);return e&&e.remove(),!0}case"mceToggleEditor":{let e=this.get(o);if(!e)return this.execCommand("mceAddEditor",!1,r),!0;return e.isHidden()?e.show():e.hide(),!0}}return!!this.activeEditor&&this.activeEditor.execCommand(e,t,r)},triggerSave:()=>{j_(jD,e=>{e.save()})},addI18n:(e,t)=>{iu.add(e,t)},translate:e=>iu.translate(e),setActive(e){let t=this.activeEditor;this.activeEditor!==e&&(t&&t.dispatch("deactivate",{relatedTarget:e}),e.dispatch("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl(e){this.baseURL=new wV(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new wV(this.baseURL)}};jP.setup();let jL=(()=>{let e=ib();return{FakeClipboardItem:e=>({items:e,types:eF(e),getType:t=>eK(e,t).getOrUndefined()}),write:t=>{e.set(t)},read:()=>e.get().getOrUndefined(),clear:e.clear}})(),jF=Math.min,jM=Math.max,jI=Math.round,jU=(e,t,r)=>{let n=t.x,o=t.y,a=e.w,l=e.h,i=t.w,s=t.h,d=(r||"").split("");return"b"===d[0]&&(o+=s),"r"===d[1]&&(n+=i),"c"===d[0]&&(o+=jI(s/2)),"c"===d[1]&&(n+=jI(i/2)),"b"===d[3]&&(o-=l),"r"===d[4]&&(n-=a),"c"===d[3]&&(o-=jI(l/2)),"c"===d[4]&&(n-=jI(a/2)),jz(n,o,a,l)},jz=(e,t,r,n)=>({x:e,y:t,w:r,h:n}),jj=(e,t,r=1e3)=>{let n=!1,o=null,a=e=>(...t)=>{n||(n=!0,null!==o&&(clearTimeout(o),o=null),e.apply(null,t))},l=a(e),i=a(t);return{start:(...e)=>{n||null!==o||(o=setTimeout(()=>i.apply(null,e),r))},resolve:l,reject:i}},jH=(()=>{let e={},t={};return{load:(r,n)=>{let o=`Script at URL "${n}" failed to load`,a=`Script at URL "${n}" did not call \`tinymce.Resource.add('${r}', data)\` within 1 second`;if(void 0!==e[r])return e[r];{let l=new Promise((e,l)=>{let i=jj(e,l);t[r]=i.resolve,io.ScriptLoader.loadScript(n).then(()=>i.start(a),()=>i.reject(o))});return e[r]=l,l}},add:(r,n)=>{void 0!==t[r]&&(t[r](n),delete t[r]),e[r]=Promise.resolve(n)},unload:t=>{delete e[t]}}})();try{let e="__storage_test__";(n=window.localStorage).setItem(e,e),n.removeItem(e)}catch(e){n=(()=>{let e={},t=[],r={getItem:t=>e[t]||null,setItem:(r,n)=>{t.push(r),e[r]=String(n)},key:e=>t[e],removeItem:r=>{t=t.filter(e=>e===r),delete e[r]},clear:()=>{t=[],e={}},length:0};return Object.defineProperty(r,"length",{get:()=>t.length,configurable:!1,enumerable:!1}),r})()}let j$={geom:{Rect:{inflate:(e,t,r)=>jz(e.x-t,e.y-r,e.w+2*t,e.h+2*r),relativePosition:jU,findBestRelativePosition:(e,t,r,n)=>{for(let o=0;o<n.length;o++){let a=jU(e,t,n[o]);if(a.x>=r.x&&a.x+a.w<=r.w+r.x&&a.y>=r.y&&a.y+a.h<=r.h+r.y)return n[o]}return null},intersect:(e,t)=>{let r=jM(e.x,t.x),n=jM(e.y,t.y),o=jF(e.x+e.w,t.x+t.w),a=jF(e.y+e.h,t.y+t.h);return o-r<0||a-n<0?null:jz(r,n,o-r,a-n)},clamp:(e,t,r)=>{let n=e.x,o=e.y,a=e.x+e.w,l=e.y+e.h,i=t.x+t.w,s=t.y+t.h,d=jM(0,t.x-n),c=jM(0,t.y-o),m=jM(0,a-i),u=jM(0,l-s);return n+=d,o+=c,r&&(a+=d,l+=c,n-=m,o-=u),jz(n,o,(a-=m)-n,(l-=u)-o)},create:jz,fromClientRect:e=>jz(e.left,e.top,e.width,e.height)}},util:{Delay:pd,Tools:t2,VK:fz,URI:wV,EventDispatcher:z0,Observable:z2,I18n:iu,LocalStorage:n,ImageUploader:e=>{let t=_y(e,_u());return{upload:(r,n=!0)=>t.upload(r,n?_v(e):void 0)}}},dom:{EventUtils:lZ,TreeWalker:od,TextSeeker:iV,DOMUtils:it,ScriptLoader:io,RangeUtils:gE,Serializer:Sm,StyleSheetLoader:a6,ControlSelection:fW,BookmarkManager:ff,Selection:k4,Event:lZ.Event},html:{Styles:lz,Entities:lC,Node:p4,Schema:lU,DomParser:w7,Writer:hp,Serializer:hh},Env:tJ,AddOnManager:ig,Annotator:fu,Formatter:_F,UndoManager:_z,EditorCommands:zP,WindowManager:S2,NotificationManager:SJ,EditorObservable:z4,Shortcuts:jv,Editor:jk,FocusManager:pl,EditorManager:jP,DOM:it.DOM,ScriptLoader:io.ScriptLoader,PluginManager:SZ,ThemeManager:S0,ModelManager:SI,IconManager:SM,Resource:jH,FakeClipboard:jL,trim:t2.trim,isArray:t2.isArray,is:t2.is,toArray:t2.toArray,makeMap:t2.makeMap,each:t2.each,map:t2.map,grep:t2.grep,inArray:t2.inArray,extend:t2.extend,walk:t2.walk,resolve:t2.resolve,explode:t2.explode,_addCacheSuffix:t2._addCacheSuffix},jq=t2.extend(jP,j$);window.tinymce=jq,window.tinyMCE=jq,(e=>{if("object"==typeof module)try{module.exports=e}catch(e){}})(jq)}();