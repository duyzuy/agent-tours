!function(){"use strict";let e,t,n,o,a;var i,l,s,d,c,m,u,p,g,f,h,b,C,typeOf$1=function(e){if(null===e)return"null";if(void 0===e)return"undefined";var t=typeof e;return"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t},eq$2=function(e){return{eq:e}},y=eq$2(function(e,t){return e===t}),eqArray=function(e){return eq$2(function(t,n){if(t.length!==n.length)return!1;for(var o=t.length,a=0;a<o;a++)if(!e.eq(t[a],n[a]))return!1;return!0})},eqSortedArray=function(e,t){var n,o;return n=eqArray(e),o=function(e){return Array.prototype.slice.call(e).sort(t)},eq$2(function(e,t){return n.eq(o(e),o(t))})},eqRecord=function(e){return eq$2(function(t,n){var o=Object.keys(t),a=Object.keys(n);if(!eqSortedArray(y).eq(o,a))return!1;for(var i=o.length,l=0;l<i;l++){var s=o[l];if(!e.eq(t[s],n[s]))return!1}return!0})},v=eq$2(function(e,t){if(e===t)return!0;var n=typeOf$1(e);return n===typeOf$1(t)&&(-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(n)?e===t:"array"===n?eqArray(v).eq(e,t):"object"===n&&eqRecord(v).eq(e,t))});let E=Object.getPrototypeOf,hasProto=(e,t,n)=>{var o;return!!n(e,t.prototype)||(null===(o=e.constructor)||void 0===o?void 0:o.name)===t.name},typeOf=e=>{let t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&hasProto(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},isType$1=e=>t=>typeOf(t)===e,isSimpleType=e=>t=>typeof t===e,eq$1=e=>t=>e===t,is$4=(e,t)=>$(e)&&hasProto(e,t,(e,t)=>E(e)===t),k=isType$1("string"),$=isType$1("object"),isPlainObject=e=>is$4(e,Object),S=isType$1("array"),N=eq$1(null),O=isSimpleType("boolean"),P=eq$1(void 0),isNullable=e=>null==e,isNonNullable=e=>!isNullable(e),R=isSimpleType("function"),x=isSimpleType("number"),isArrayOf=(e,t)=>{if(S(e)){for(let n=0,o=e.length;n<o;++n)if(!t(e[n]))return!1;return!0}return!1},noop=()=>{},compose=(e,t)=>(...n)=>e(t.apply(null,n)),compose1=(e,t)=>n=>e(t(n)),constant=e=>()=>e,identity=e=>e,tripleEquals=(e,t)=>e===t;function curry(e,...t){return(...n)=>{let o=t.concat(n);return e.apply(null,o)}}let not=e=>t=>!e(t),die=e=>()=>{throw Error(e)},apply$1=e=>e(),call=e=>{e()},w=constant(!1),A=constant(!0);let Optional=class Optional{constructor(e,t){this.tag=e,this.value=t}static some(e){return new Optional(!0,e)}static none(){return Optional.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?Optional.some(e(this.value)):Optional.none()}bind(e){return this.tag?e(this.value):Optional.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:Optional.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return isNonNullable(e)?Optional.some(e):Optional.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}};Optional.singletonNone=new Optional(!1);let T=Array.prototype.slice,B=Array.prototype.indexOf,D=Array.prototype.push,rawIndexOf=(e,t)=>B.call(e,t),indexOf$1=(e,t)=>{let n=rawIndexOf(e,t);return -1===n?Optional.none():Optional.some(n)},contains$2=(e,t)=>rawIndexOf(e,t)>-1,exists=(e,t)=>{for(let n=0,o=e.length;n<o;n++){let o=e[n];if(t(o,n))return!0}return!1},map$3=(e,t)=>{let n=e.length,o=Array(n);for(let a=0;a<n;a++){let n=e[a];o[a]=t(n,a)}return o},each$e=(e,t)=>{for(let n=0,o=e.length;n<o;n++){let o=e[n];t(o,n)}},eachr=(e,t)=>{for(let n=e.length-1;n>=0;n--){let o=e[n];t(o,n)}},partition$2=(e,t)=>{let n=[],o=[];for(let a=0,i=e.length;a<i;a++){let i=e[a],l=t(i,a)?n:o;l.push(i)}return{pass:n,fail:o}},filter$5=(e,t)=>{let n=[];for(let o=0,a=e.length;o<a;o++){let a=e[o];t(a,o)&&n.push(a)}return n},foldr=(e,t,n)=>(eachr(e,(e,o)=>{n=t(n,e,o)}),n),foldl=(e,t,n)=>(each$e(e,(e,o)=>{n=t(n,e,o)}),n),findUntil$1=(e,t,n)=>{for(let o=0,a=e.length;o<a;o++){let a=e[o];if(t(a,o))return Optional.some(a);if(n(a,o))break}return Optional.none()},find$2=(e,t)=>findUntil$1(e,t,w),findIndex$2=(e,t)=>{for(let n=0,o=e.length;n<o;n++){let o=e[n];if(t(o,n))return Optional.some(n)}return Optional.none()},flatten=e=>{let t=[];for(let n=0,o=e.length;n<o;++n){if(!S(e[n]))throw Error("Arr.flatten item "+n+" was not an array, input: "+e);D.apply(t,e[n])}return t},bind$3=(e,t)=>flatten(map$3(e,t)),forall=(e,t)=>{for(let n=0,o=e.length;n<o;++n){let o=e[n];if(!0!==t(o,n))return!1}return!0},reverse=e=>{let t=T.call(e,0);return t.reverse(),t},difference=(e,t)=>filter$5(e,e=>!contains$2(t,e)),mapToObject=(e,t)=>{let n={};for(let o=0,a=e.length;o<a;o++){let a=e[o];n[String(a)]=t(a,o)}return n},sort=(e,t)=>{let n=T.call(e,0);return n.sort(t),n},get$b=(e,t)=>t>=0&&t<e.length?Optional.some(e[t]):Optional.none(),head=e=>get$b(e,0),last$3=e=>get$b(e,e.length-1),I=R(Array.from)?Array.from:e=>T.call(e),findMap=(e,t)=>{for(let n=0;n<e.length;n++){let o=t(e[n],n);if(o.isSome())return o}return Optional.none()},unique$1=(e,t)=>{let n=[],o=R(t)?e=>exists(n,n=>t(n,e)):e=>contains$2(n,e);for(let t=0,a=e.length;t<a;t++){let a=e[t];o(a)||n.push(a)}return n},F=Object.keys,_=Object.hasOwnProperty,each$d=(e,t)=>{let n=F(e);for(let o=0,a=n.length;o<a;o++){let a=n[o],i=e[a];t(i,a)}},map$2=(e,t)=>tupleMap(e,(e,n)=>({k:n,v:t(e,n)})),tupleMap=(e,t)=>{let n={};return each$d(e,(e,o)=>{let a=t(e,o);n[a.k]=a.v}),n},objAcc=e=>(t,n)=>{e[n]=t},internalFilter=(e,t,n,o)=>{each$d(e,(e,a)=>{(t(e,a)?n:o)(e,a)})},bifilter=(e,t)=>{let n={},o={};return internalFilter(e,t,objAcc(n),objAcc(o)),{t:n,f:o}},filter$4=(e,t)=>{let n={};return internalFilter(e,t,objAcc(n),noop),n},mapToArray=(e,t)=>{let n=[];return each$d(e,(e,o)=>{n.push(t(e,o))}),n},values=e=>mapToArray(e,identity),get$a=(e,t)=>has$2(e,t)?Optional.from(e[t]):Optional.none(),has$2=(e,t)=>_.call(e,t),hasNonNullableKey=(e,t)=>has$2(e,t)&&void 0!==e[t]&&null!==e[t],equal$1=(e,t,n=v)=>eqRecord(n).eq(e,t),stringArray=e=>{let t={};return each$e(e,e=>{t[e]={}}),F(t)},isArrayLike=e=>void 0!==e.length,L=Array.isArray,each$c=(e,t,n)=>{if(!e)return!1;if(n=n||e,isArrayLike(e)){for(let o=0,a=e.length;o<a;o++)if(!1===t.call(n,e[o],o,e))return!1}else for(let o in e)if(has$2(e,o)&&!1===t.call(n,e[o],o,e))return!1;return!0},map$1=(e,t)=>{let n=[];return each$c(e,(o,a)=>{n.push(t(o,a,e))}),n},filter$3=(e,t)=>{let n=[];return each$c(e,(o,a)=>{(!t||t(o,a,e))&&n.push(o)}),n},reduce=(e,t,n,o)=>{let a=P(n)?e[0]:n;for(let n=0;n<e.length;n++)a=t.call(o,a,e[n],n);return a},findIndex$1=(e,t,n)=>{for(let o=0,a=e.length;o<a;o++)if(t.call(n,e[o],o,e))return o;return -1},last$2=e=>e[e.length-1],cached=e=>{let t,n=!1;return(...o)=>(n||(n=!0,t=e.apply(null,o)),t)},DeviceType=(e,t,n,o)=>{let a=e.isiOS()&&!0===/ipad/i.test(n),i=e.isiOS()&&!a,l=e.isiOS()||e.isAndroid(),s=l||o("(pointer:coarse)"),d=a||!i&&l&&o("(min-device-width:768px)"),c=i||l&&!d,m=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),u=!c&&!d&&!m;return{isiPad:constant(a),isiPhone:constant(i),isTablet:constant(d),isPhone:constant(c),isTouch:constant(s),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:constant(m),isDesktop:constant(u)}},firstMatch=(e,t)=>{for(let n=0;n<e.length;n++){let o=e[n];if(o.test(t))return o}},find$1=(e,t)=>{let n=firstMatch(e,t);if(!n)return{major:0,minor:0};let group=e=>Number(t.replace(n,"$"+e));return nu$3(group(1),group(2))},unknown$2=()=>nu$3(0,0),nu$3=(e,t)=>({major:e,minor:t}),M={nu:nu$3,detect:(e,t)=>{let n=String(t).toLowerCase();return 0===e.length?unknown$2():find$1(e,n)},unknown:unknown$2},detectBrowser$1=(e,t)=>findMap(t.brands,t=>{let n=t.brand.toLowerCase();return find$2(e,e=>{var t;return n===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())}).map(e=>({current:e.name,version:M.nu(parseInt(t.version,10),0)}))}),detect$4=(e,t)=>{let n=String(t).toLowerCase();return find$2(e,e=>e.search(n))},detectBrowser=(e,t)=>detect$4(e,t).map(e=>{let n=M.detect(e.versionRegexes,t);return{current:e.name,version:n}}),detectOs=(e,t)=>detect$4(e,t).map(e=>{let n=M.detect(e.versionRegexes,t);return{current:e.name,version:n}}),removeFromStart=(e,t)=>e.substring(t),checkRange=(e,t,n)=>""===t||e.length>=t.length&&e.substr(n,n+t.length)===t,removeLeading=(e,t)=>startsWith(e,t)?removeFromStart(e,t.length):e,contains$1=(e,t,n=0,o)=>{let a=e.indexOf(t,n);return -1!==a&&(!!P(o)||a+t.length<=o)},startsWith=(e,t)=>checkRange(e,t,0),endsWith=(e,t)=>checkRange(e,t,e.length-t.length),blank=e=>t=>t.replace(e,""),U=blank(/^\s+|\s+$/g),z=blank(/^\s+/g),W=blank(/\s+$/g),isNotEmpty=e=>e.length>0,isEmpty$3=e=>!isNotEmpty(e),repeat=(e,t)=>t<=0?"":Array(t+1).join(e),toInt=(e,t=10)=>{let n=parseInt(e,t);return isNaN(n)?Optional.none():Optional.some(n)},H=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,checkContains=e=>t=>contains$1(t,e),V=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>contains$1(e,"edge/")&&contains$1(e,"chrome")&&contains$1(e,"safari")&&contains$1(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,H],search:e=>contains$1(e,"chrome")&&!contains$1(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>contains$1(e,"msie")||contains$1(e,"trident")},{name:"Opera",versionRegexes:[H,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:checkContains("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:checkContains("firefox")},{name:"Safari",versionRegexes:[H,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(contains$1(e,"safari")||contains$1(e,"mobile/"))&&contains$1(e,"applewebkit")}],q=[{name:"Windows",search:checkContains("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>contains$1(e,"iphone")||contains$1(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:checkContains("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:checkContains("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:checkContains("linux"),versionRegexes:[]},{name:"Solaris",search:checkContains("sunos"),versionRegexes:[]},{name:"FreeBSD",search:checkContains("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:checkContains("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],j={browsers:constant(V),oses:constant(q)},K="Edge",G="Chromium",Y="Opera",X="Firefox",Z="Safari",nu$2=e=>{let t=e.current,n=e.version,isBrowser=e=>()=>t===e;return{current:t,version:n,isEdge:isBrowser(K),isChromium:isBrowser(G),isIE:isBrowser("IE"),isOpera:isBrowser(Y),isFirefox:isBrowser(X),isSafari:isBrowser(Z)}},Q={unknown:()=>nu$2({current:void 0,version:M.unknown()}),nu:nu$2,edge:constant(K),chromium:constant(G),ie:constant("IE"),opera:constant(Y),firefox:constant(X),safari:constant(Z)},J="Windows",ee="Android",et="Linux",en="macOS",er="Solaris",eo="FreeBSD",ea="ChromeOS",nu$1=e=>{let t=e.current,n=e.version,isOS=e=>()=>t===e;return{current:t,version:n,isWindows:isOS(J),isiOS:isOS("iOS"),isAndroid:isOS(ee),isMacOS:isOS(en),isLinux:isOS(et),isSolaris:isOS(er),isFreeBSD:isOS(eo),isChromeOS:isOS(ea)}},ei={unknown:()=>nu$1({current:void 0,version:M.unknown()}),nu:nu$1,windows:constant(J),ios:constant("iOS"),android:constant(ee),linux:constant(et),macos:constant(en),solaris:constant(er),freebsd:constant(eo),chromeos:constant(ea)},el={detect:(e,t,n)=>{let o=j.browsers(),a=j.oses(),i=t.bind(e=>detectBrowser$1(o,e)).orThunk(()=>detectBrowser(o,e)).fold(Q.unknown,Q.nu),l=detectOs(a,e).fold(ei.unknown,ei.nu),s=DeviceType(l,i,e,n);return{browser:i,os:l,deviceType:s}}},mediaMatch=e=>window.matchMedia(e).matches,es=cached(()=>el.detect(navigator.userAgent,Optional.from(navigator.userAgentData),mediaMatch)),detect$2=()=>es(),ed=navigator.userAgent,ec=detect$2(),em=ec.browser,eu=ec.os,ep=ec.deviceType,eg=-1!==ed.indexOf("Windows Phone"),ef={transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",documentMode:em.isIE()?document.documentMode||7:10,cacheSuffix:null,container:null,canHaveCSP:!em.isIE(),windowsPhone:eg,browser:{current:em.current,version:em.version,isChromium:em.isChromium,isEdge:em.isEdge,isFirefox:em.isFirefox,isIE:em.isIE,isOpera:em.isOpera,isSafari:em.isSafari},os:{current:eu.current,version:eu.version,isAndroid:eu.isAndroid,isChromeOS:eu.isChromeOS,isFreeBSD:eu.isFreeBSD,isiOS:eu.isiOS,isLinux:eu.isLinux,isMacOS:eu.isMacOS,isSolaris:eu.isSolaris,isWindows:eu.isWindows},deviceType:{isDesktop:ep.isDesktop,isiPad:ep.isiPad,isiPhone:ep.isiPhone,isPhone:ep.isPhone,isTablet:ep.isTablet,isTouch:ep.isTouch,isWebView:ep.isWebView}},eh=/^\s*|\s*$/g,trim$3=e=>isNullable(e)?"":(""+e).replace(eh,""),walk$4=function(e,t,n,o){o=o||this,e&&(n&&(e=e[n]),each$c(e,(e,a)=>!1!==t.call(o,e,a,n)&&(walk$4(e,t,n,o),!0)))},eb={trim:trim$3,isArray:L,is:(e,t)=>t?!!("array"===t&&L(e))||typeof e===t:void 0!==e,toArray:e=>{if(L(e))return e;{let t=[];for(let n=0,o=e.length;n<o;n++)t[n]=e[n];return t}},makeMap:(e,t,n={})=>{let o=k(e)?e.split(t||","):e||[],a=o.length;for(;a--;)n[o[a]]={};return n},each:each$c,map:map$1,grep:filter$3,inArray:(e,t)=>{if(e){for(let n=0,o=e.length;n<o;n++)if(e[n]===t)return n}return -1},hasOwn:has$2,extend:(e,...t)=>{for(let n=0;n<t.length;n++){let o=t[n];for(let t in o)if(has$2(o,t)){let n=o[t];void 0!==n&&(e[t]=n)}}return e},walk:walk$4,resolve:(e,t=window)=>{let n=e.split(".");for(let e=0,o=n.length;e<o&&(t=t[n[e]]);e++);return t},explode:(e,t)=>S(e)?e:""===e?[]:map$1(e.split(t||","),trim$3),_addCacheSuffix:e=>{let t=ef.cacheSuffix;return t&&(e+=(-1===e.indexOf("?")?"?":"&")+t),e}},is$2=(e,t,n=tripleEquals)=>e.exists(e=>n(e,t)),equals=(e,t,n=tripleEquals)=>lift2(e,t,n).getOr(e.isNone()&&t.isNone()),cat=e=>{let t=[],push=e=>{t.push(e)};for(let t=0;t<e.length;t++)e[t].each(push);return t},lift2=(e,t,n)=>e.isSome()&&t.isSome()?Optional.some(n(e.getOrDie(),t.getOrDie())):Optional.none(),lift3=(e,t,n,o)=>e.isSome()&&t.isSome()&&n.isSome()?Optional.some(o(e.getOrDie(),t.getOrDie(),n.getOrDie())):Optional.none(),someIf=(e,t)=>e?Optional.some(t):Optional.none(),eC="undefined"!=typeof window?window:Function("return this;")(),path=(e,t)=>{let n=null!=t?t:eC;for(let t=0;t<e.length&&null!=n;++t)n=n[e[t]];return n},resolve$2=(e,t)=>{let n=e.split(".");return path(n,t)},unsafe=(e,t)=>resolve$2(e,t),getOrDie=(e,t)=>{let n=unsafe(e,t);if(null==n)throw Error(e+" not available on this browser");return n},ey=Object.getPrototypeOf,sandHTMLElement=e=>getOrDie("HTMLElement",e),isPrototypeOf=e=>{let t=resolve$2("ownerDocument.defaultView",e);return $(e)&&(sandHTMLElement(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(ey(e).constructor.name))},name=e=>{let t=e.dom.nodeName;return t.toLowerCase()},type$1=e=>e.dom.nodeType,isType=e=>t=>type$1(t)===e,isComment$1=e=>8===type$1(e)||"#comment"===name(e),isHTMLElement=e=>ev(e)&&isPrototypeOf(e.dom),ev=isType(1),eE=isType(3),ek=isType(9),e$=isType(11),isTag=e=>t=>ev(t)&&name(t)===e,rawSet=(e,t,n)=>{if(k(n)||O(n)||x(n))e.setAttribute(t,n+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),Error("Attribute value was not simple")},set$3=(e,t,n)=>{rawSet(e.dom,t,n)},setAll$1=(e,t)=>{let n=e.dom;each$d(t,(e,t)=>{rawSet(n,t,e)})},get$9=(e,t)=>{let n=e.dom.getAttribute(t);return null===n?void 0:n},getOpt=(e,t)=>Optional.from(get$9(e,t)),has$1=(e,t)=>{let n=e.dom;return!!n&&!!n.hasAttribute&&n.hasAttribute(t)},remove$a=(e,t)=>{e.dom.removeAttribute(t)},hasNone=e=>{let t=e.dom.attributes;return null==t||0===t.length},clone$4=e=>foldl(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),read$4=(e,t)=>{let n=get$9(e,t);return void 0===n||""===n?[]:n.split(" ")},add$4=(e,t,n)=>{let o=read$4(e,t),a=o.concat([n]);return set$3(e,t,a.join(" ")),!0},remove$9=(e,t,n)=>{let o=filter$5(read$4(e,t),e=>e!==n);return o.length>0?set$3(e,t,o.join(" ")):remove$a(e,t),!1},supports=e=>void 0!==e.dom.classList,get$8=e=>read$4(e,"class"),add$3=(e,t)=>add$4(e,"class",t),remove$8=(e,t)=>remove$9(e,"class",t),toggle$2=(e,t)=>contains$2(get$8(e),t)?remove$8(e,t):add$3(e,t),add$2=(e,t)=>{supports(e)?e.dom.classList.add(t):add$3(e,t)},cleanClass=e=>{let t=supports(e)?e.dom.classList:get$8(e);0===t.length&&remove$a(e,"class")},remove$7=(e,t)=>{if(supports(e)){let n=e.dom.classList;n.remove(t)}else remove$8(e,t);cleanClass(e)},toggle$1=(e,t)=>{let n=supports(e)?e.dom.classList.toggle(t):toggle$2(e,t);return cleanClass(e),n},has=(e,t)=>supports(e)&&e.dom.classList.contains(t),fromDom$2=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},eS={fromHtml:(e,t)=>{let n=t||document,o=n.createElement("div");if(o.innerHTML=e,!o.hasChildNodes()||o.childNodes.length>1){let t="HTML does not have a single root node";throw console.error(t,e),Error(t)}return fromDom$2(o.childNodes[0])},fromTag:(e,t)=>{let n=t||document,o=n.createElement(e);return fromDom$2(o)},fromText:(e,t)=>{let n=t||document,o=n.createTextNode(e);return fromDom$2(o)},fromDom:fromDom$2,fromPoint:(e,t,n)=>Optional.from(e.dom.elementFromPoint(t,n)).map(fromDom$2)},toArray=(e,t)=>{let n=[],recurse=e=>(n.push(e),t(e)),o=t(e);do o=o.bind(recurse);while(o.isSome());return n},is$1=(e,t)=>{let n=e.dom;if(1!==n.nodeType)return!1;if(void 0!==n.matches)return n.matches(t);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(t);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(t);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(t);throw Error("Browser lacks native selectors")},bypassSelector=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,all=(e,t)=>{let n=void 0===t?document:t.dom;return bypassSelector(n)?[]:map$3(n.querySelectorAll(e),eS.fromDom)},one=(e,t)=>{let n=void 0===t?document:t.dom;return bypassSelector(n)?Optional.none():Optional.from(n.querySelector(e)).map(eS.fromDom)},eq=(e,t)=>e.dom===t.dom,contains=(e,t)=>{let n=e.dom,o=t.dom;return n!==o&&n.contains(o)},owner$1=e=>eS.fromDom(e.dom.ownerDocument),documentOrOwner=e=>ek(e)?e:owner$1(e),documentElement=e=>eS.fromDom(documentOrOwner(e).dom.documentElement),defaultView=e=>eS.fromDom(documentOrOwner(e).dom.defaultView),parent=e=>Optional.from(e.dom.parentNode).map(eS.fromDom),parentElement=e=>Optional.from(e.dom.parentElement).map(eS.fromDom),parents$1=(e,t)=>{let n=R(t)?t:w,o=e.dom,a=[];for(;null!==o.parentNode&&void 0!==o.parentNode;){let e=o.parentNode,t=eS.fromDom(e);if(a.push(t),!0===n(t))break;o=e}return a},siblings=e=>parent(e).map(children$1).map(t=>filter$5(t,t=>!eq(e,t))).getOr([]),prevSibling=e=>Optional.from(e.dom.previousSibling).map(eS.fromDom),nextSibling=e=>Optional.from(e.dom.nextSibling).map(eS.fromDom),prevSiblings=e=>reverse(toArray(e,prevSibling)),nextSiblings=e=>toArray(e,nextSibling),children$1=e=>map$3(e.dom.childNodes,eS.fromDom),child$1=(e,t)=>{let n=e.dom.childNodes;return Optional.from(n[t]).map(eS.fromDom)},firstChild=e=>child$1(e,0),lastChild=e=>child$1(e,e.dom.childNodes.length-1),childNodesCount=e=>e.dom.childNodes.length,hasChildNodes=e=>e.dom.hasChildNodes(),getHead=e=>{let t=e.dom.head;if(null==t)throw Error("Head is not available yet");return eS.fromDom(t)},isShadowRoot=e=>e$(e)&&isNonNullable(e.dom.host),eN=R(Element.prototype.attachShadow)&&R(Node.prototype.getRootNode),eO=constant(eN),eP=eN?e=>eS.fromDom(e.dom.getRootNode()):documentOrOwner,getStyleContainer=e=>isShadowRoot(e)?e:getHead(documentOrOwner(e)),getContentContainer=e=>isShadowRoot(e)?e:eS.fromDom(documentOrOwner(e).dom.body),getShadowRoot=e=>{let t=eP(e);return isShadowRoot(t)?Optional.some(t):Optional.none()},getShadowHost=e=>eS.fromDom(e.dom.host),getOriginalEventTarget=e=>{if(eO()&&isNonNullable(e.target)){let t=eS.fromDom(e.target);if(ev(t)&&isOpenShadowHost(t)&&e.composed&&e.composedPath){let t=e.composedPath();if(t)return head(t)}}return Optional.from(e.target)},isOpenShadowHost=e=>isNonNullable(e.dom.shadowRoot),inBody=e=>{let t=eE(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;let n=t.ownerDocument;return getShadowRoot(eS.fromDom(t)).fold(()=>n.body.contains(t),compose1(inBody,getShadowHost))};var ClosestOrAncestor=(e,t,n,o,a)=>e(n,o)?Optional.some(n):R(a)&&a(n)?Optional.none():t(n,o,a);let ancestor$4=(e,t,n)=>{let o=e.dom,a=R(n)?n:w;for(;o.parentNode;){o=o.parentNode;let e=eS.fromDom(o);if(t(e))return Optional.some(e);if(a(e))break}return Optional.none()},closest$4=(e,t,n)=>ClosestOrAncestor((e,t)=>t(e),ancestor$4,e,t,n),sibling$1=(e,t)=>{let n=e.dom;return n.parentNode?child(eS.fromDom(n.parentNode),n=>!eq(e,n)&&t(n)):Optional.none()},child=(e,t)=>{let n=find$2(e.dom.childNodes,e=>t(eS.fromDom(e)));return n.map(eS.fromDom)},descendant$1=(e,t)=>{let descend=e=>{for(let n=0;n<e.childNodes.length;n++){let o=eS.fromDom(e.childNodes[n]);if(t(o))return Optional.some(o);let a=descend(e.childNodes[n]);if(a.isSome())return a}return Optional.none()};return descend(e.dom)},ancestor$3=(e,t,n)=>ancestor$4(e,e=>is$1(e,t),n),descendant=(e,t)=>one(t,e),closest$3=(e,t,n)=>ClosestOrAncestor((e,t)=>is$1(e,t),ancestor$3,e,t,n),closest$2=e=>closest$3(e,"[contenteditable]"),isEditable$3=(e,t=!1)=>inBody(e)?e.dom.isContentEditable:closest$2(e).fold(constant(t),e=>"true"===getRaw$1(e)),getRaw$1=e=>e.dom.contentEditable,isSupported=e=>void 0!==e.style&&R(e.style.getPropertyValue),internalSet=(e,t,n)=>{if(!k(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),Error("CSS value must be a string: "+n);isSupported(e)&&e.style.setProperty(t,n)},internalRemove=(e,t)=>{isSupported(e)&&e.style.removeProperty(t)},set$2=(e,t,n)=>{let o=e.dom;internalSet(o,t,n)},setAll=(e,t)=>{let n=e.dom;each$d(t,(e,t)=>{internalSet(n,t,e)})},get$7=(e,t)=>{let n=e.dom,o=window.getComputedStyle(n),a=o.getPropertyValue(t);return""!==a||inBody(e)?a:getUnsafeProperty(n,t)},getUnsafeProperty=(e,t)=>isSupported(e)?e.style.getPropertyValue(t):"",getRaw=(e,t)=>{let n=e.dom,o=getUnsafeProperty(n,t);return Optional.from(o).filter(e=>e.length>0)},getAllRaw=e=>{let t={},n=e.dom;if(isSupported(n))for(let e=0;e<n.style.length;e++){let o=n.style.item(e);t[o]=n.style[o]}return t},remove$6=(e,t)=>{let n=e.dom;internalRemove(n,t),is$2(getOpt(e,"style").map(U),"")&&remove$a(e,"style")},reflow=e=>e.dom.offsetWidth,before$3=(e,t)=>{let n=parent(e);n.each(n=>{n.dom.insertBefore(t.dom,e.dom)})},after$4=(e,t)=>{let n=nextSibling(e);n.fold(()=>{let n=parent(e);n.each(e=>{append$1(e,t)})},e=>{before$3(e,t)})},prepend=(e,t)=>{let n=firstChild(e);n.fold(()=>{append$1(e,t)},n=>{e.dom.insertBefore(t.dom,n.dom)})},append$1=(e,t)=>{e.dom.appendChild(t.dom)},wrap$2=(e,t)=>{before$3(e,t),append$1(t,e)},after$3=(e,t)=>{each$e(t,(n,o)=>{let a=0===o?e:t[o-1];after$4(a,n)})},append=(e,t)=>{each$e(t,t=>{append$1(e,t)})},empty=e=>{e.dom.textContent="",each$e(children$1(e),e=>{remove$5(e)})},remove$5=e=>{let t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},unwrap=e=>{let t=children$1(e);t.length>0&&after$3(e,t),remove$5(e)},fromHtml=(e,t)=>{let n=t||document,o=n.createElement("div");return o.innerHTML=e,children$1(eS.fromDom(o))},fromDom$1=e=>map$3(e,eS.fromDom),get$6=e=>e.dom.innerHTML,set$1=(e,t)=>{let n=owner$1(e),o=n.dom,a=eS.fromDom(o.createDocumentFragment()),i=fromHtml(t,o);append(a,i),empty(e),append$1(e,a)},getOuter=e=>{let t=eS.fromTag("div"),n=eS.fromDom(e.dom.cloneNode(!0));return append$1(t,n),get$6(t)},mkEvent=(e,t,n,o,a,i,l)=>({target:e,x:t,y:n,stop:o,prevent:a,kill:i,raw:l}),fromRawEvent=e=>{let t=eS.fromDom(getOriginalEventTarget(e).getOr(e.target)),stop=()=>e.stopPropagation(),prevent=()=>e.preventDefault(),n=compose(prevent,stop);return mkEvent(t,e.clientX,e.clientY,stop,prevent,n,e)},handle$1=(e,t)=>n=>{e(n)&&t(fromRawEvent(n))},binder=(e,t,n,o,a)=>{let i=handle$1(n,o);return e.dom.addEventListener(t,i,a),{unbind:curry(unbind,e,t,i,a)}},bind$2=(e,t,n,o)=>binder(e,t,n,o,!1),unbind=(e,t,n,o)=>{e.dom.removeEventListener(t,n,o)},r=(e,t)=>({left:e,top:t,translate:(n,o)=>r(e+n,t+o)}),boxPosition=e=>{let t=e.getBoundingClientRect();return r(t.left,t.top)},firstDefinedOrZero=(e,t)=>void 0!==e?e:void 0!==t?t:0,absolute=e=>{let t=e.dom.ownerDocument,n=t.body,o=t.defaultView,a=t.documentElement;if(n===e.dom)return r(n.offsetLeft,n.offsetTop);let i=firstDefinedOrZero(null==o?void 0:o.pageYOffset,a.scrollTop),l=firstDefinedOrZero(null==o?void 0:o.pageXOffset,a.scrollLeft),s=firstDefinedOrZero(a.clientTop,n.clientTop),d=firstDefinedOrZero(a.clientLeft,n.clientLeft);return viewport(e).translate(l-d,i-s)},viewport=e=>{let t=e.dom,n=t.ownerDocument,o=n.body;return o===t?r(o.offsetLeft,o.offsetTop):inBody(e)?boxPosition(t):r(0,0)},get$5=e=>{let t=void 0!==e?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,o=t.body.scrollTop||t.documentElement.scrollTop;return r(n,o)},to=(e,t,n)=>{let o=void 0!==n?n.dom:document,a=o.defaultView;a&&a.scrollTo(e,t)},intoView=(e,t)=>{let n=detect$2().browser.isSafari();n&&R(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(!1):e.dom.scrollIntoView(t)},get$4=e=>{let t=void 0===e?window:e;return detect$2().browser.isFirefox()?Optional.none():Optional.from(t.visualViewport)},bounds=(e,t,n,o)=>({x:e,y:t,width:n,height:o,right:e+n,bottom:t+o}),getBounds=e=>{let t=void 0===e?window:e,n=t.document,o=get$5(eS.fromDom(n));return get$4(t).fold(()=>{let e=t.document.documentElement,n=e.clientWidth,a=e.clientHeight;return bounds(o.left,o.top,n,a)},e=>bounds(Math.max(e.pageLeft,o.left),Math.max(e.pageTop,o.top),e.width,e.height))},children=(e,t)=>filter$5(children$1(e),t),descendants$1=(e,t)=>{let n=[];return each$e(children$1(e),e=>{t(e)&&(n=n.concat([e])),n=n.concat(descendants$1(e,t))}),n},descendants=(e,t)=>all(t,e),ancestor$2=(e,t,n)=>ancestor$3(e,t,n).isSome();let DomTreeWalker=class DomTreeWalker{constructor(e,t){this.node=e,this.rootNode=t,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}current(){return this.node}next(e){return this.node=this.findSibling(this.node,"firstChild","nextSibling",e),this.node}prev(e){return this.node=this.findSibling(this.node,"lastChild","previousSibling",e),this.node}prev2(e){return this.node=this.findPreviousNode(this.node,e),this.node}findSibling(e,t,n,o){if(e){if(!o&&e[t])return e[t];if(e!==this.rootNode){let t=e[n];if(t)return t;for(let o=e.parentNode;o&&o!==this.rootNode;o=o.parentNode)if(t=o[n])return t}}}findPreviousNode(e,t){if(e){let n=e.previousSibling;if(this.rootNode&&n===this.rootNode)return;if(n){if(!t){for(let e=n.lastChild;e;e=e.lastChild)if(!e.lastChild)return e}return n}let o=e.parentNode;if(o&&o!==this.rootNode)return o}}};let isNodeType=e=>t=>!!t&&t.nodeType===e,isRestrictedNode=e=>!!e&&!Object.getPrototypeOf(e),eR=isNodeType(1),matchNodeName=e=>{let t=e.toLowerCase();return e=>isNonNullable(e)&&e.nodeName.toLowerCase()===t},matchNodeNames=e=>{let t=e.map(e=>e.toLowerCase());return e=>{if(e&&e.nodeName){let n=e.nodeName.toLowerCase();return contains$2(t,n)}return!1}},matchStyleValues=(e,t)=>{let n=t.toLowerCase().split(" ");return t=>{if(eR(t)){let o=t.ownerDocument.defaultView;if(o)for(let a=0;a<n.length;a++){let i=o.getComputedStyle(t,null),l=i?i.getPropertyValue(e):null;if(l===n[a])return!0}}return!1}},hasAttribute=e=>t=>eR(t)&&t.hasAttribute(e),isBogus$2=e=>eR(e)&&e.hasAttribute("data-mce-bogus"),isBogusAll$1=e=>eR(e)&&"all"===e.getAttribute("data-mce-bogus"),isTable$2=e=>eR(e)&&"TABLE"===e.tagName,hasContentEditableState=e=>t=>!!eR(t)&&(t.contentEditable===e||t.getAttribute("data-mce-contenteditable")===e),ex=matchNodeNames(["textarea","input"]),ew=isNodeType(3),eA=isNodeType(4),eT=isNodeType(7),eB=isNodeType(8),eD=isNodeType(9),eI=isNodeType(11),eF=matchNodeName("br"),e_=matchNodeName("img"),eL=hasContentEditableState("true"),eM=hasContentEditableState("false"),eU=matchNodeNames(["td","th"]),ez=matchNodeNames(["td","th","caption"]),eW=matchNodeNames(["video","audio","object","embed"]),eH=matchNodeName("li"),eV=matchNodeName("details"),ej=matchNodeName("summary"),isZwsp$2=e=>"\uFEFF"===e,eK=((e,t)=>{let getOption=t=>e(t)?Optional.from(t.dom.nodeValue):Optional.none();return{get:n=>{if(!e(n))throw Error("Can only get "+t+" value of a "+t+" node");return getOption(n).getOr("")},getOption,set:(n,o)=>{if(!e(n))throw Error("Can only set raw "+t+" value of a "+t+" node");n.dom.nodeValue=o}}})(eE,"text"),get$3=e=>eK.get(e),getOption=e=>eK.getOption(e),set=(e,t)=>eK.set(e,t),eG=["pre"].concat(["h1","h2","h3","h4","h5","h6"]),lazyLookup=e=>{let t;return n=>has$2(t=t||mapToObject(e,A),name(n))},eY=lazyLookup(["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"]),isTable$1=e=>"table"===name(e),isInline$1=e=>ev(e)&&!eY(e),isBr$5=e=>ev(e)&&"br"===name(e),eX=lazyLookup(["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"]),eZ=lazyLookup(["ul","ol","dl"]),eQ=lazyLookup(["li","dd","dt"]),eJ=lazyLookup(["thead","tbody","tfoot"]),e0=lazyLookup(["td","th"]),e1=lazyLookup(["pre","script","textarea","style"]),e2=lazyLookup(eG),isWrapElement=e=>e2(e)||isInline$1(e),getLastChildren$1=e=>{let t=[],n=e.dom;for(;n;)t.push(eS.fromDom(n)),n=n.lastChild;return t},removeTrailingBr=e=>{let t=descendants(e,"br"),n=filter$5(getLastChildren$1(e).slice(-1),isBr$5);t.length===n.length&&each$e(n,remove$5)},createPaddingBr=()=>{let e=eS.fromTag("br");return set$3(e,"data-mce-bogus","1"),e},fillWithPaddingBr=e=>{empty(e),append$1(e,createPaddingBr())},trimBlockTrailingBr=e=>{lastChild(e).each(t=>{prevSibling(t).each(n=>{eY(e)&&isBr$5(t)&&eY(n)&&remove$5(t)})})},trim$2=e=>e.replace(/\uFEFF/g,""),isCaretContainerBlock$1=e=>(ew(e)&&(e=e.parentNode),eR(e)&&e.hasAttribute("data-mce-caret")),isCaretContainerInline=e=>ew(e)&&isZwsp$2(e.data),isCaretContainer$2=e=>isCaretContainerBlock$1(e)||isCaretContainerInline(e),hasContent=e=>e.firstChild!==e.lastChild||!eF(e.firstChild),insertInline$1=(e,t)=>{var n;let o=null!==(n=e.ownerDocument)&&void 0!==n?n:document,a=o.createTextNode("\uFEFF"),i=e.parentNode;if(t){let t=e.previousSibling;if(ew(t)){if(isCaretContainer$2(t))return t;if(endsWithCaretContainer$1(t))return t.splitText(t.data.length-1)}null==i||i.insertBefore(a,e)}else{let t=e.nextSibling;if(ew(t)){if(isCaretContainer$2(t))return t;if(startsWithCaretContainer$1(t))return t.splitText(1),t}e.nextSibling?null==i||i.insertBefore(a,e.nextSibling):null==i||i.appendChild(a)}return a},isBeforeInline=e=>{let t=e.container();return!!ew(t)&&("\uFEFF"===t.data.charAt(e.offset())||e.isAtStart()&&isCaretContainerInline(t.previousSibling))},isAfterInline=e=>{let t=e.container();return!!ew(t)&&("\uFEFF"===t.data.charAt(e.offset()-1)||e.isAtEnd()&&isCaretContainerInline(t.nextSibling))},insertBlock=(e,t,n)=>{var o;let a=null!==(o=t.ownerDocument)&&void 0!==o?o:document,i=a.createElement(e);i.setAttribute("data-mce-caret",n?"before":"after"),i.setAttribute("data-mce-bogus","all"),i.appendChild(createPaddingBr().dom);let l=t.parentNode;return n?null==l||l.insertBefore(i,t):t.nextSibling?null==l||l.insertBefore(i,t.nextSibling):null==l||l.appendChild(i),i},startsWithCaretContainer$1=e=>ew(e)&&"\uFEFF"===e.data[0],endsWithCaretContainer$1=e=>ew(e)&&"\uFEFF"===e.data[e.data.length-1],trimBogusBr=e=>{var t;let n=e.getElementsByTagName("br"),o=n[n.length-1];isBogus$2(o)&&(null===(t=o.parentNode)||void 0===t||t.removeChild(o))},showCaretContainerBlock=e=>e&&e.hasAttribute("data-mce-caret")?(trimBogusBr(e),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("data-mce-style"),e.removeAttribute("_moz_abspos"),e):null,isRangeInCaretContainerBlock=e=>isCaretContainerBlock$1(e.startContainer),e3=matchNodeNames(["script","style","textarea"]),e5=matchNodeNames(["img","input","textarea","hr","iframe","video","audio","object","embed"]),e4=matchNodeNames(["table"]),isCaretCandidate$3=e=>!isCaretContainer$2(e)&&(ew(e)?!e3(e.parentNode):e5(e)||eF(e)||e4(e)||isNonUiContentEditableFalse(e)),isUnselectable=e=>eR(e)&&"true"===e.getAttribute("unselectable"),isNonUiContentEditableFalse=e=>!isUnselectable(e)&&eM(e),isInEditable=(e,t)=>{for(let n=e.parentNode;n&&n!==t;n=n.parentNode){if(isNonUiContentEditableFalse(n))return!1;if(eL(n))break}return!0},isAtomicContentEditableFalse=e=>!!isNonUiContentEditableFalse(e)&&!foldl(I(e.getElementsByTagName("*")),(e,t)=>e||eL(t),!1),isEditableCaretCandidate$1=(e,t)=>isCaretCandidate$3(e)&&isInEditable(e,t),e8=/^[ \t\r\n]*$/,isWhitespaceText=e=>e8.test(e),isZwsp=e=>{for(let t of e)if(!isZwsp$2(t))return!1;return!0},isCollapsibleWhitespace$1=e=>-1!==" \f	\v".indexOf(e),isNewLineChar=e=>"\n"===e||"\r"===e,isNewline=(e,t)=>t<e.length&&t>=0&&isNewLineChar(e[t]),normalize$4=(e,t=4,n=!0,o=!0)=>{let a=repeat(" ",t),i=e.replace(/\t/g,a),l=foldl(i,(e,t)=>isCollapsibleWhitespace$1(t)||"\xa0"===t?e.pcIsSpace||""===e.str&&n||e.str.length===i.length-1&&o||isNewline(i,e.str.length+1)?{pcIsSpace:!1,str:e.str+"\xa0"}:{pcIsSpace:!0,str:e.str+" "}:{pcIsSpace:isNewLineChar(t),str:e.str+t},{pcIsSpace:!1,str:""});return l.str},hasWhitespacePreserveParent=(e,t)=>{let n=eS.fromDom(t),o=eS.fromDom(e);return ancestor$2(o,"pre,code",curry(eq,n))},isWhitespace$1=(e,t)=>ew(e)&&isWhitespaceText(e.data)&&!hasWhitespacePreserveParent(e,t),isNamedAnchor=e=>eR(e)&&"A"===e.nodeName&&!e.hasAttribute("href")&&(e.hasAttribute("name")||e.hasAttribute("id")),isContent$1=(e,t)=>isCaretCandidate$3(e)&&!isWhitespace$1(e,t)||isNamedAnchor(e)||e6(e),e6=hasAttribute("data-mce-bookmark"),e9=hasAttribute("data-mce-bogus"),isBogusAll=e=>eR(e)&&"all"===e.getAttribute("data-mce-bogus"),isEmptyNode=(e,t)=>{let n=0;if(isContent$1(e,e))return!1;{let o=e.firstChild;if(!o)return!0;let a=new DomTreeWalker(o,e);do{if(t){if(isBogusAll(o)){o=a.next(!0);continue}if(e9(o)){o=a.next();continue}}if(eF(o)){n++,o=a.next();continue}if(isContent$1(o,e))return!1;o=a.next()}while(o);return n<=1}},isEmpty$2=(e,t=!0)=>isEmptyNode(e.dom,t),e7="data-mce-block",elementNames=e=>filter$5(F(e),e=>!/[A-Z]/.test(e)),makeSelectorFromSchemaMap=e=>elementNames(e).join(","),updateTransparent=(e,t)=>isNonNullable(t.querySelector(e))?(t.setAttribute(e7,"true"),"inline-boundary"===t.getAttribute("data-mce-selected")&&t.removeAttribute("data-mce-selected"),!0):(t.removeAttribute(e7),!1),updateBlockStateOnChildren=(e,t)=>{let n=makeSelectorFromSchemaMap(e.getTransparentElements()),o=makeSelectorFromSchemaMap(e.getBlockElements());return filter$5(t.querySelectorAll(n),e=>updateTransparent(o,e))},trimEdge=(e,t)=>{var n;let o=t?"lastChild":"firstChild";for(let t=e[o];t;t=t[o])if(isEmpty$2(eS.fromDom(t))){null===(n=t.parentNode)||void 0===n||n.removeChild(t);return}},split$2=(e,t)=>{let n=document.createRange(),o=e.parentNode;if(o){n.setStartBefore(e),n.setEndBefore(t);let a=n.extractContents();trimEdge(a,!0),n.setStartAfter(t),n.setEndAfter(e);let i=n.extractContents();trimEdge(i,!1),isEmpty$2(eS.fromDom(a))||o.insertBefore(a,e),isEmpty$2(eS.fromDom(t))||o.insertBefore(t,e),isEmpty$2(eS.fromDom(i))||o.insertBefore(i,e),o.removeChild(e)}},splitInvalidChildren=(e,t,n)=>{let o=e.getBlockElements(),a=eS.fromDom(t),isBlock=e=>name(e) in o,isRoot=e=>eq(e,a);each$e(fromDom$1(n),t=>{ancestor$4(t,isBlock,isRoot).each(n=>{let o=children(t,t=>isBlock(t)&&!e.isValidChild(name(n),name(t)));if(o.length>0){let t=parentElement(n);each$e(o,e=>{ancestor$4(e,isBlock,isRoot).each(t=>{split$2(t.dom,e.dom)})}),t.each(t=>updateBlockStateOnChildren(e,t.dom))}})})},unwrapInvalidChildren=(e,t,n)=>{each$e([...n,...isTransparentBlock(e,t)?[t]:[]],t=>each$e(descendants(eS.fromDom(t),t.nodeName.toLowerCase()),t=>{isTransparentInline(e,t.dom)&&unwrap(t)}))},updateChildren=(e,t)=>{let n=updateBlockStateOnChildren(e,t);splitInvalidChildren(e,t,n),unwrapInvalidChildren(e,t,n)},updateElement=(e,t)=>{if(isTransparentElement(e,t)){let n=makeSelectorFromSchemaMap(e.getBlockElements());updateTransparent(n,t)}},updateCaret=(e,t,n)=>{let o=parents$1(eS.fromDom(n),e=>eq(e,eS.fromDom(t)));get$b(o,o.length-2).filter(ev).fold(()=>updateChildren(e,t),t=>updateChildren(e,t.dom))},hasBlockAttr=e=>e.hasAttribute(e7),isTransparentElementName=(e,t)=>has$2(e.getTransparentElements(),t),isTransparentElement=(e,t)=>eR(t)&&isTransparentElementName(e,t.nodeName),isTransparentBlock=(e,t)=>isTransparentElement(e,t)&&hasBlockAttr(t),isTransparentInline=(e,t)=>isTransparentElement(e,t)&&!hasBlockAttr(t),isTransparentAstBlock=(e,t)=>1===t.type&&isTransparentElementName(e,t.name)&&k(t.attr(e7)),te=detect$2().browser,firstElement=e=>find$2(e,ev),getTableCaptionDeltaY=e=>te.isFirefox()&&"table"===name(e)?firstElement(children$1(e)).filter(e=>"caption"===name(e)).bind(e=>firstElement(nextSiblings(e)).map(t=>{let n=t.dom.offsetTop,o=e.dom.offsetTop,a=e.dom.offsetHeight;return n<=o?-a:0})).getOr(0):0,hasChild=(e,t)=>e.children&&contains$2(e.children,t),getPos=(e,t,n)=>{let o=0,a=0,i=e.ownerDocument;if(n=n||e,t){if(n===e&&t.getBoundingClientRect&&"static"===get$7(eS.fromDom(e),"position")){let n=t.getBoundingClientRect();return{x:o=n.left+(i.documentElement.scrollLeft||e.scrollLeft)-i.documentElement.clientLeft,y:a=n.top+(i.documentElement.scrollTop||e.scrollTop)-i.documentElement.clientTop}}let l=t;for(;l&&l!==n&&l.nodeType&&!hasChild(l,n);){let e=l;o+=e.offsetLeft||0,a+=e.offsetTop||0,l=e.offsetParent}for(l=t.parentNode;l&&l!==n&&l.nodeType&&!hasChild(l,n);)o-=l.scrollLeft||0,a-=l.scrollTop||0,l=l.parentNode;a+=getTableCaptionDeltaY(eS.fromDom(t))}return{x:o,y:a}},StyleSheetLoader=(e,t={})=>{let n=0,o={},a=eS.fromDom(e),i=documentOrOwner(a),addStyle=e=>{append$1(getStyleContainer(a),e)},removeStyle=e=>{let t=getStyleContainer(a);descendant(t,"#"+e).each(remove$5)},getOrCreateState=e=>get$a(o,e).getOrThunk(()=>({id:"mce-u"+n++,passed:[],failed:[],count:0})),load=e=>new Promise((n,a)=>{let l;let s=eb._addCacheSuffix(e),d=getOrCreateState(s);o[s]=d,d.count++;let resolve=(e,t)=>{each$e(e,call),d.status=t,d.passed=[],d.failed=[],l&&(l.onload=null,l.onerror=null,l=null)},passed=()=>resolve(d.passed,2),failed=()=>resolve(d.failed,3);if(n&&d.passed.push(n),a&&d.failed.push(a),1===d.status)return;if(2===d.status){passed();return}if(3===d.status){failed();return}d.status=1;let c=eS.fromTag("link",i.dom);setAll$1(c,{rel:"stylesheet",type:"text/css",id:d.id}),t.contentCssCors&&set$3(c,"crossOrigin","anonymous"),t.referrerPolicy&&set$3(c,"referrerpolicy",t.referrerPolicy),(l=c.dom).onload=passed,l.onerror=failed,addStyle(c),set$3(c,"href",s)}),unload=e=>{let t=eb._addCacheSuffix(e);get$a(o,t).each(e=>{let n=--e.count;0===n&&(delete o[t],removeStyle(e.id))})};return{load,loadAll:e=>{let t=Promise.allSettled(map$3(e,e=>load(e).then(constant(e))));return t.then(e=>{let t=partition$2(e,e=>"fulfilled"===e.status);return t.fail.length>0?Promise.reject(map$3(t.fail,e=>e.reason)):map$3(t.pass,e=>e.value)})},unload,unloadAll:e=>{each$e(e,e=>{unload(e)})},_setReferrerPolicy:e=>{t.referrerPolicy=e},_setContentCssCors:e=>{t.contentCssCors=e}}},tt=(()=>{let e=new WeakMap;return{forElement:(t,n)=>{let o=eP(t),a=o.dom;return Optional.from(e.get(a)).getOrThunk(()=>{let t=StyleSheetLoader(a,n);return e.set(a,t),t})}}})(),isSpan=e=>"span"===e.nodeName.toLowerCase(),isInlineContent=(e,t)=>isNonNullable(e)&&(isContent$1(e,t)||isInline$1(eS.fromDom(e))),surroundedByInlineContent=(e,t)=>{let n=new DomTreeWalker(e,t).prev(!1),o=new DomTreeWalker(e,t).next(!1),a=P(n)||isInlineContent(n,t),i=P(o)||isInlineContent(o,t);return a&&i},isBookmarkNode$2=e=>isSpan(e)&&"bookmark"===e.getAttribute("data-mce-type"),isKeepTextNode=(e,t)=>ew(e)&&e.data.length>0&&surroundedByInlineContent(e,t),isKeepElement=e=>!!eR(e)&&e.childNodes.length>0,isDocument=e=>eI(e)||eD(e),trimNode=(e,t,n)=>{var o;let a=n||t;if(eR(t)&&isBookmarkNode$2(t))return t;let i=t.childNodes;for(let t=i.length-1;t>=0;t--)trimNode(e,i[t],a);if(eR(t)){let e=t.childNodes;1===e.length&&isBookmarkNode$2(e[0])&&(null===(o=t.parentNode)||void 0===o||o.insertBefore(e[0],t))}return isDocument(t)||isContent$1(t,a)||isKeepElement(t)||isKeepTextNode(t,a)||e.remove(t),t},tn=eb.makeMap,tr=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,ta=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,ti=/[<>&\"\']/g,tl=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,ts={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},td={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},tc={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},nativeDecode=e=>{let t=eS.fromTag("div").dom;return t.innerHTML=e,t.textContent||t.innerText||e},buildEntitiesLookup=(e,t)=>{let n={};if(e){let o=e.split(",");t=t||10;for(let e=0;e<o.length;e+=2){let a=String.fromCharCode(parseInt(o[e],t));if(!td[a]){let t="&"+o[e+1]+";";n[a]=t,n[t]=a}}return n}},tm=buildEntitiesLookup("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),encodeRaw=(e,t)=>e.replace(t?tr:ta,e=>td[e]||e),encodeNumeric=(e,t)=>e.replace(t?tr:ta,e=>e.length>1?"&#"+((e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320)+65536)+";":td[e]||"&#"+e.charCodeAt(0)+";"),encodeNamed=(e,t,n)=>{let o=n||tm;return e.replace(t?tr:ta,e=>td[e]||o[e]||e)},tu={encodeRaw,encodeAllRaw:e=>(""+e).replace(ti,e=>td[e]||e),encodeNumeric,encodeNamed,getEncodeFunc:(e,t)=>{let n=buildEntitiesLookup(t)||tm,o=tn(e.replace(/\+/g,","));return o.named&&o.numeric?(e,t)=>e.replace(t?tr:ta,e=>void 0!==td[e]?td[e]:void 0!==n[e]?n[e]:e.length>1?"&#"+((e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320)+65536)+";":"&#"+e.charCodeAt(0)+";"):o.named?t?(e,t)=>encodeNamed(e,t,n):encodeNamed:o.numeric?encodeNumeric:encodeRaw},decode:e=>e.replace(tl,(e,t)=>t?(t="x"===t.charAt(0).toLowerCase()?parseInt(t.substr(1),16):parseInt(t,10))>65535?String.fromCharCode(55296+((t-=65536)>>10),56320+(1023&t)):ts[t]||String.fromCharCode(t):tc[e]||tm[e]||nativeDecode(e))},split$1=(e,t)=>(e=eb.trim(e))?e.split(t||" "):[],patternToRegExp=e=>RegExp("^"+e.replace(/([?+*])/g,".$1")+"$"),parseCustomElementsRules=e=>{let t=/^(~)?(.+)$/;return bind$3(split$1(e,","),e=>{let n=t.exec(e);if(!n)return[];{let e="~"===n[1],t=n[2];return[{inline:e,cloneName:e?"span":"div",name:t}]}})},getElementSetsAsStrings=e=>{let t,n,o,a;return t="id accesskey class dir lang style tabindex title role",n="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",o="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==e&&(t+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",n+=" article aside details dialog figure main header footer hgroup section nav a ins del canvas map",o+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==e&&(t+=" xml:lang",o=[o,"acronym applet basefont big font strike tt"].join(" "),a=[n=[n,"center dir isindex noframes"].join(" "),o].join(" ")),{globalAttributes:t,blockContent:n,phrasingContent:o,flowContent:a=a||[n,o].join(" ")}},makeSchema=e=>{let{globalAttributes:t,phrasingContent:n,flowContent:o}=getElementSetsAsStrings(e),a={},add=(e,n="",o="")=>{let i=split$1(o),l=split$1(e),s=l.length;for(;s--;){let e=split$1([t,n].join(" "));a[l[s]]={attributes:mapToObject(e,constant({})),attributesOrder:e,children:mapToObject(i,constant({}))}}},addAttrs=(e,t)=>{let n=split$1(e),o=split$1(t),i=n.length;for(;i--;){let e=a[n[i]];for(let t=0,n=o.length;t<n;t++)e.attributes[o[t]]={},e.attributesOrder.push(o[t])}};return"html5-strict"!==e&&(each$e(split$1("acronym applet basefont big font strike tt"),e=>{add(e,"",n)}),each$e(split$1("center dir isindex noframes"),e=>{add(e,"",o)})),add("html","manifest","head body"),add("head","","base command link meta noscript script style title"),add("title hr noscript br"),add("base","href target"),add("link","href rel media hreflang type sizes hreflang"),add("meta","name http-equiv content charset"),add("style","media type scoped"),add("script","src async defer type charset"),add("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",o),add("dd div","",o),add("address dt caption","","html4"===e?n:o),add("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",n),add("blockquote","cite",o),add("ol","reversed start type","li"),add("ul","","li"),add("li","value",o),add("dl","","dt dd"),add("a","href target rel media hreflang type","html4"===e?n:o),add("q","cite",n),add("ins del","cite datetime",o),add("img","src sizes srcset alt usemap ismap width height"),add("iframe","src name width height",o),add("embed","src type width height"),add("object","data type typemustmatch name usemap form width height",[o,"param"].join(" ")),add("param","name value"),add("map","name",[o,"area"].join(" ")),add("area","alt coords shape href target rel media hreflang type"),add("table","border","caption colgroup thead tfoot tbody tr"+("html4"===e?" col":"")),add("colgroup","span","col"),add("col","span"),add("tbody thead tfoot","","tr"),add("tr","","td th"),add("td","colspan rowspan headers",o),add("th","colspan rowspan headers scope abbr",o),add("form","accept-charset action autocomplete enctype method name novalidate target",o),add("fieldset","disabled form name",[o,"legend"].join(" ")),add("label","form for",n),add("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),add("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===e?o:n),add("select","disabled form multiple name required size","option optgroup"),add("optgroup","disabled label","option"),add("option","disabled label selected value"),add("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),add("menu","type label",[o,"li"].join(" ")),add("noscript","",o),"html4"!==e&&(add("wbr"),add("ruby","",[n,"rt rp"].join(" ")),add("figcaption","",o),add("mark rt rp summary bdi","",n),add("canvas","width height",o),add("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[o,"track source"].join(" ")),add("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[o,"track source"].join(" ")),add("picture","","img source"),add("source","src srcset type media sizes"),add("track","kind src srclang label default"),add("datalist","",[n,"option"].join(" ")),add("article section nav aside main header footer","",o),add("hgroup","","h1 h2 h3 h4 h5 h6"),add("figure","",[o,"figcaption"].join(" ")),add("time","datetime",n),add("dialog","open",o),add("command","type label icon disabled checked radiogroup command"),add("output","for form name",n),add("progress","value max",n),add("meter","value min max low high optimum",n),add("details","open",[o,"summary"].join(" ")),add("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==e&&(addAttrs("script","language xml:space"),addAttrs("style","xml:space"),addAttrs("object","declare classid code codebase codetype archive standby align border hspace vspace"),addAttrs("embed","align name hspace vspace"),addAttrs("param","valuetype type"),addAttrs("a","charset name rev shape coords"),addAttrs("br","clear"),addAttrs("applet","codebase archive code object alt name width height align hspace vspace"),addAttrs("img","name longdesc align border hspace vspace"),addAttrs("iframe","longdesc frameborder marginwidth marginheight scrolling align"),addAttrs("font basefont","size color face"),addAttrs("input","usemap align"),addAttrs("select"),addAttrs("textarea"),addAttrs("h1 h2 h3 h4 h5 h6 div p legend caption","align"),addAttrs("ul","type compact"),addAttrs("li","type"),addAttrs("ol dl menu dir","compact"),addAttrs("pre","width xml:space"),addAttrs("hr","align noshade size width"),addAttrs("isindex","prompt"),addAttrs("table","summary width frame rules cellspacing cellpadding align bgcolor"),addAttrs("col","width align char charoff valign"),addAttrs("colgroup","width align char charoff valign"),addAttrs("thead","align char charoff valign"),addAttrs("tr","align char charoff valign bgcolor"),addAttrs("th","axis align char charoff valign nowrap bgcolor width height"),addAttrs("form","accept"),addAttrs("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),addAttrs("tfoot","align char charoff valign"),addAttrs("tbody","align char charoff valign"),addAttrs("area","nohref"),addAttrs("body","background bgcolor text link vlink alink")),"html4"!==e&&(addAttrs("input button select textarea","autofocus"),addAttrs("input textarea","placeholder"),addAttrs("a","download"),addAttrs("link script img","crossorigin"),addAttrs("img","loading"),addAttrs("iframe","sandbox seamless allow allowfullscreen loading")),"html4"!==e&&each$e([a.video,a.audio],e=>{delete e.children.audio,delete e.children.video}),each$e(split$1("a form meter progress dfn"),e=>{a[e]&&delete a[e].children[e]}),delete a.caption.children.table,delete a.script,a},prefixToOperation=e=>"-"===e?"remove":"add",parseValidChildrenRules=e=>{let t=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;return bind$3(split$1(e,","),e=>{let n=t.exec(e);if(!n)return[];{let e=n[1],t=e?prefixToOperation(e):"replace",o=n[2],a=split$1(n[3],"|");return[{operation:t,name:o,validChildren:a}]}})},parseValidElementsAttrDataIntoElement=(e,t)=>{let n=/^([!\-])?(\w+[\\:]:\w+|[^=~<]+)?(?:([=~<])(.*))?$/,o=/[*?+]/,{attributes:a,attributesOrder:i}=t;return each$e(split$1(e,"|"),e=>{let l=n.exec(e);if(l){let e={},n=l[1],s=l[2].replace(/[\\:]:/g,":"),d=l[3],c=l[4];if("!"===n&&(t.attributesRequired=t.attributesRequired||[],t.attributesRequired.push(s),e.required=!0),"-"===n){delete a[s],i.splice(eb.inArray(i,s),1);return}d&&("="===d?(t.attributesDefault=t.attributesDefault||[],t.attributesDefault.push({name:s,value:c}),e.defaultValue=c):"~"===d?(t.attributesForced=t.attributesForced||[],t.attributesForced.push({name:s,value:c}),e.forcedValue=c):"<"===d&&(e.validValues=eb.makeMap(c,"?"))),o.test(s)?(t.attributePatterns=t.attributePatterns||[],e.pattern=patternToRegExp(s),t.attributePatterns.push(e)):(a[s]||i.push(s),a[s]=e)}})},cloneAttributesInto=(e,t)=>{each$d(e.attributes,(e,n)=>{t.attributes[n]=e}),t.attributesOrder.push(...e.attributesOrder)},parseValidElementsRules=(e,t)=>{let n=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/;return bind$3(split$1(t,","),t=>{let o=n.exec(t);if(!o)return[];{let t=o[1],n=o[2],a=o[3],i=o[4],l=o[5],s={attributes:{},attributesOrder:[]};if(e.each(e=>cloneAttributesInto(e,s)),"#"===t?s.paddEmpty=!0:"-"===t&&(s.removeEmpty=!0),"!"===i&&(s.removeEmptyAttrs=!0),l&&parseValidElementsAttrDataIntoElement(l,s),a&&(s.outputName=n),"@"===n){if(!e.isNone())return[];e=Optional.some(s)}return[a?{name:n,element:s,aliasName:a}:{name:n,element:s}]}})},tp={},tg=eb.makeMap,tf=eb.each,th=eb.extend,tb=eb.explode,createMap=(e,t={})=>{let n=tg(e," ",tg(e.toUpperCase()," "));return th(n,t)},getTextRootBlockElements=e=>createMap("td th li dt dd figcaption caption details summary",e.getTextBlockElements()),compileElementMap=(e,t)=>{if(e){let n={};return k(e)&&(e={"*":e}),tf(e,(e,o)=>{n[o]=n[o.toUpperCase()]="map"===t?tg(e,/[, ]/):tb(e,/[, ]/)}),n}},Schema=(e={})=>{var t;let n={},o={},a=[],i={},l={},createLookupTable=(t,n,o)=>{let a=e[t];if(a)return tg(a,/[, ]/,tg(a.toUpperCase(),/[, ]/));{let e=tp[t];return e||(e=createMap(n,o),tp[t]=e),e}},s=null!==(t=e.schema)&&void 0!==t?t:"html5",d=makeSchema(s);!1===e.verify_html&&(e.valid_elements="*[*]");let c=compileElementMap(e.valid_styles),m=compileElementMap(e.invalid_styles,"map"),u=compileElementMap(e.valid_classes,"map"),p=createLookupTable("whitespace_elements","pre script noscript style textarea video audio iframe object code"),g=createLookupTable("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),f=createLookupTable("void_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),h=createLookupTable("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls allowfullscreen"),b="td th iframe video audio object script code",C=createLookupTable("non_empty_elements",b+" pre",f),y=createLookupTable("move_caret_before_on_enter_elements",b+" table",f),v=createLookupTable("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),E=createLookupTable("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",v),k=createLookupTable("text_inline_elements","span strong b em i font s strike u var cite dfn code mark q sup sub samp"),$=createLookupTable("transparent_elements","a ins del canvas map");tf("script noscript iframe noframes noembed title style textarea xmp plaintext".split(" "),e=>{l[e]=RegExp("</"+e+"[^>]*>","gi")});let addValidElements=e=>{let t=Optional.from(n["@"]),o=/[*?+]/;each$e(parseValidElementsRules(t,null!=e?e:""),({name:e,element:t,aliasName:i})=>{i&&(n[i]=t),o.test(e)?(t.pattern=patternToRegExp(e),a.push(t)):n[e]=t})},setValidElements=e=>{a=[],each$e(F(n),e=>{delete n[e]}),addValidElements(e)},addCustomElements=e=>{delete tp.text_block_elements,delete tp.block_elements,each$e(parseCustomElementsRules(null!=e?e:""),({inline:e,name:t,cloneName:a})=>{if(o[t]=o[a],i[t]=a,C[t.toUpperCase()]={},C[t]={},e||(E[t.toUpperCase()]={},E[t]={}),!n[t]){let e=n[a];e=th({},e),delete e.removeEmptyAttrs,delete e.removeEmpty,n[t]=e}each$d(o,(e,n)=>{e[a]&&(o[n]=e=th({},o[n]),e[t]=e[a])})})},addValidChildren=e=>{each$e(parseValidChildrenRules(null!=e?e:""),({operation:e,name:t,validChildren:n})=>{let a="replace"===e?{"#comment":{}}:o[t];each$e(n,t=>{"remove"===e?delete a[t]:a[t]={}}),o[t]=a})},getElementRule=e=>{let t=n[e];if(t)return t;let o=a.length;for(;o--;){let t=a[o];if(t.pattern.test(e))return t}};e.valid_elements?(setValidElements(e.valid_elements),tf(d,(e,t)=>{o[t]=e.children})):(tf(d,(e,t)=>{n[t]={attributes:e.attributes,attributesOrder:e.attributesOrder},o[t]=e.children}),tf(split$1("strong/b em/i"),e=>{let t=split$1(e,"/");n[t[1]].outputName=t[0]}),tf(k,(t,o)=>{n[o]&&(e.padd_empty_block_inline_children&&(n[o].paddInEmptyBlock=!0),n[o].removeEmpty=!0)}),tf(split$1("ol ul blockquote a table tbody"),e=>{n[e]&&(n[e].removeEmpty=!0)}),tf(split$1("p h1 h2 h3 h4 h5 h6 th td pre div address caption li summary"),e=>{n[e]&&(n[e].paddEmpty=!0)}),tf(split$1("span"),e=>{n[e].removeEmptyAttrs=!0})),addCustomElements(e.custom_elements),addValidChildren(e.valid_children),addValidElements(e.extended_valid_elements),addValidChildren("+ol[ul|ol],+ul[ul|ol]"),tf({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(e,t)=>{n[t]&&(n[t].parentsRequired=split$1(e))}),e.invalid_elements&&tf(tb(e.invalid_elements),e=>{n[e]&&delete n[e]}),getElementRule("span")||addValidElements("span[!data-mce-type|*]");let S=constant(c),N=constant(m),O=constant(u),P=constant(h),R=constant(E),x=constant(v),w=constant(k),A=constant(Object.seal(f)),T=constant(g),B=constant(C),D=constant(y),I=constant(p),_=constant($),L=constant(Object.seal(l)),M=constant(i);return{type:s,children:o,elements:n,getValidStyles:S,getValidClasses:O,getBlockElements:R,getInvalidStyles:N,getVoidElements:A,getTextBlockElements:x,getTextInlineElements:w,getBoolAttrs:P,getElementRule,getSelfClosingElements:T,getNonEmptyElements:B,getMoveCaretBeforeOnEnterElements:D,getWhitespaceElements:I,getTransparentElements:_,getSpecialElements:L,isValidChild:(e,t)=>{let n=o[e.toLowerCase()];return!!(n&&n[t.toLowerCase()])},isValid:(e,t)=>{let n=getElementRule(e);if(n){if(!t)return!0;{if(n.attributes[t])return!0;let e=n.attributePatterns;if(e){let n=e.length;for(;n--;)if(e[n].pattern.test(t))return!0}}}return!1},getCustomElements:M,addValidElements,setValidElements,addCustomElements,addValidChildren}},Styles=(e={},t)=>{let n,o;let a=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,i=/\s*([^:]+):\s*([^;]+);?/g,l=/\s+$/,s={};t&&(n=t.getValidStyles(),o=t.getInvalidStyles());let d="\\\" \\' \\; \\: ; : \uFEFF".split(" ");for(let e=0;e<d.length;e++)s[d[e]]="\uFEFF"+e,s["\uFEFF"+e]=d[e];let c={parse:t=>{let n={},o=!1,d=e.url_converter,m=e.url_converter_scope||c,compress=(e,t,o)=>{let a=n[e+"-top"+t];if(!a)return;let i=n[e+"-right"+t];if(!i)return;let l=n[e+"-bottom"+t];if(!l)return;let s=n[e+"-left"+t];if(!s)return;let d=[a,i,l,s],c=d.length-1;for(;c--&&d[c]===d[c+1];);c>-1&&o||(n[e+t]=-1===c?d[0]:d.join(" "),delete n[e+"-top"+t],delete n[e+"-right"+t],delete n[e+"-bottom"+t],delete n[e+"-left"+t])},canCompress=e=>{let t=n[e];if(!t)return;let o=t.indexOf(",")>-1?[t]:t.split(" "),a=o.length;for(;a--;)if(o[a]!==o[0])return!1;return n[e]=o[0],!0},encode=e=>(o=!0,s[e]),decode=(e,t)=>(o&&(e=e.replace(/\uFEFF[0-9]/g,e=>s[e])),t||(e=e.replace(/\\([\'\";:])/g,"$1")),e),decodeSingleHexSequence=e=>String.fromCharCode(parseInt(e.slice(1),16)),decodeHexSequences=e=>e.replace(/\\[0-9a-f]+/gi,decodeSingleHexSequence),processUrl=(t,n,o,a,i,l)=>{if(i=i||l)return"'"+(i=decode(i)).replace(/\'/g,"\\'")+"'";if(n=decode(n||o||a||""),!e.allow_script_urls){let t=n.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(t)||!e.allow_svg_data_urls&&/^data:image\/svg/i.test(t))return""}return d&&(n=d.call(m,n,"style")),"url('"+n.replace(/\'/g,"\\'")+"')"};if(t){var u,p,g;let s;for(t=(t=t.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,encode).replace(/\"[^\"]+\"|\'[^\']+\'/g,e=>e.replace(/[;:]/g,encode));s=i.exec(t);){i.lastIndex=s.index+s[0].length;let t=s[1].replace(l,"").toLowerCase(),d=s[2].replace(l,"");if(t&&d){if(t=decodeHexSequences(t),d=decodeHexSequences(d),-1!==t.indexOf("\uFEFF")||-1!==t.indexOf('"')||!e.allow_script_urls&&("behavior"===t||/expression\s*\(|\/\*|\*\//.test(d)))continue;"font-weight"===t&&"700"===d?d="bold":("color"===t||"background-color"===t)&&(d=d.toLowerCase()),d=d.replace(a,processUrl),n[t]=o?decode(d,!0):d}}compress("border","",!0),compress("border","-width"),compress("border","-color"),compress("border","-style"),compress("padding",""),compress("margin",""),p="border-style",g="border-color",canCompress(u="border-width")&&canCompress(p)&&canCompress(g)&&(n.border=n[u]+" "+n[p]+" "+n[g],delete n[u],delete n[p],delete n[g]),"medium none"===n.border&&delete n.border,"none"===n["border-image"]&&delete n["border-image"]}return n},serialize:(e,t)=>{let a="",serializeStyles=(t,n)=>{let o=n[t];if(o)for(let t=0,n=o.length;t<n;t++){let n=o[t],i=e[n];i&&(a+=(a.length>0?" ":"")+n+": "+i+";")}},isValid=(e,t)=>{if(!o||!t)return!0;let n=o["*"];return(!n||!n[e])&&!((n=o[t])&&n[e])};return t&&n?(serializeStyles("*",n),serializeStyles(t,n)):each$d(e,(e,n)=>{e&&isValid(n,t)&&(a+=(a.length>0?" ":"")+n+": "+e+";")}),a}};return c},tC={keyLocation:!0,layerX:!0,layerY:!0,returnValue:!0,webkitMovementX:!0,webkitMovementY:!0,keyIdentifier:!0,mozPressure:!0},isNativeEvent=e=>e instanceof Event||R(e.initEvent),hasIsDefaultPrevented=e=>e.isDefaultPrevented===A||e.isDefaultPrevented===w,needsNormalizing=e=>isNullable(e.preventDefault)||isNativeEvent(e),clone$3=(e,t)=>{let n=null!=t?t:{};for(let t in e)has$2(tC,t)||(n[t]=e[t]);return isNonNullable(e.composedPath)&&(n.composedPath=()=>e.composedPath()),isNonNullable(e.getModifierState)&&(n.getModifierState=t=>e.getModifierState(t)),n},normalize$3=(e,t,n,o)=>{var a;let i=clone$3(t,o);return i.type=e,isNullable(i.target)&&(i.target=null!==(a=i.srcElement)&&void 0!==a?a:n),needsNormalizing(t)&&(i.preventDefault=()=>{i.defaultPrevented=!0,i.isDefaultPrevented=A,R(t.preventDefault)&&t.preventDefault()},i.stopPropagation=()=>{i.cancelBubble=!0,i.isPropagationStopped=A,R(t.stopPropagation)&&t.stopPropagation()},i.stopImmediatePropagation=()=>{i.isImmediatePropagationStopped=A,i.stopPropagation()},hasIsDefaultPrevented(i)||(i.isDefaultPrevented=!0===i.defaultPrevented?A:w,i.isPropagationStopped=!0===i.cancelBubble?A:w,i.isImmediatePropagationStopped=w)),i},ty=/^(?:mouse|contextmenu)|click/,addEvent=(e,t,n,o)=>{e.addEventListener(t,n,o||!1)},removeEvent=(e,t,n,o)=>{e.removeEventListener(t,n,o||!1)},isMouseEvent=e=>isNonNullable(e)&&ty.test(e.type),fix=(e,t)=>{let n=normalize$3(e.type,e,document,t);if(isMouseEvent(e)&&P(e.pageX)&&!P(e.clientX)){let t=n.target.ownerDocument||document,o=t.documentElement,a=t.body;n.pageX=e.clientX+(o&&o.scrollLeft||a&&a.scrollLeft||0)-(o&&o.clientLeft||a&&a.clientLeft||0),n.pageY=e.clientY+(o&&o.scrollTop||a&&a.scrollTop||0)-(o&&o.clientTop||a&&a.clientTop||0)}return n},bindOnReady=(e,t,n)=>{let o=e.document,a={type:"ready"};if(n.domLoaded){t(a);return}let readyHandler=()=>{removeEvent(e,"DOMContentLoaded",readyHandler),removeEvent(e,"load",readyHandler),n.domLoaded||(n.domLoaded=!0,t(a)),e=null};"complete"===o.readyState||"interactive"===o.readyState&&o.body?readyHandler():addEvent(e,"DOMContentLoaded",readyHandler),n.domLoaded||addEvent(e,"load",readyHandler)};let EventUtils=class EventUtils{constructor(){this.domLoaded=!1,this.events={},this.count=1,this.expando="mce-data-"+(+new Date).toString(32),this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}bind(e,t,n,o){let a,i;let l=this,s=window,defaultNativeHandler=e=>{l.executeHandlers(fix(e||s.event),i)};if(!e||ew(e)||eB(e))return n;e[l.expando]?i=e[l.expando]:(i=l.count++,e[l.expando]=i,l.events[i]={}),o=o||e;let d=t.split(" "),c=d.length;for(;c--;){let t=d[c],m=defaultNativeHandler,u=!1,p=!1;if("DOMContentLoaded"===t&&(t="ready"),l.domLoaded&&"ready"===t&&"complete"===e.readyState){n.call(o,fix({type:t}));continue}l.hasFocusIn||"focusin"!==t&&"focusout"!==t||(u=!0,p="focusin"===t?"focus":"blur",m=e=>{let t=fix(e||s.event);t.type="focus"===t.type?"focusin":"focusout",l.executeHandlers(t,i)}),(a=l.events[i][t])?"ready"===t&&l.domLoaded?n(fix({type:t})):a.push({func:n,scope:o}):(l.events[i][t]=a=[{func:n,scope:o}],a.fakeName=p,a.capture=u,a.nativeHandler=m,"ready"===t?bindOnReady(e,m,l):addEvent(e,p||t,m,u))}return e=a=null,n}unbind(e,t,n){if(!e||ew(e)||eB(e))return this;let o=e[this.expando];if(o){let a=this.events[o];if(t){let o=t.split(" "),i=o.length;for(;i--;){let t=o[i],l=a[t];if(l){if(n){let e=l.length;for(;e--;)if(l[e].func===n){let n=l.nativeHandler,o=l.fakeName,i=l.capture,s=l.slice(0,e).concat(l.slice(e+1));s.nativeHandler=n,s.fakeName=o,s.capture=i,a[t]=s}}n&&0!==l.length||(delete a[t],removeEvent(e,l.fakeName||t,l.nativeHandler,l.capture))}}}else each$d(a,(t,n)=>{removeEvent(e,t.fakeName||n,t.nativeHandler,t.capture)}),a={};for(let e in a)if(has$2(a,e))return this;delete this.events[o];try{delete e[this.expando]}catch(t){e[this.expando]=null}}return this}fire(e,t,n){return this.dispatch(e,t,n)}dispatch(e,t,n){if(!e||ew(e)||eB(e))return this;let o=fix({type:t,target:e},n);do{let t=e[this.expando];t&&this.executeHandlers(o,t),e=e.parentNode||e.ownerDocument||e.defaultView||e.parentWindow}while(e&&!o.isPropagationStopped());return this}clean(e){if(!e||ew(e)||eB(e))return this;if(e[this.expando]&&this.unbind(e),e.getElementsByTagName||(e=e.document),e&&e.getElementsByTagName){this.unbind(e);let t=e.getElementsByTagName("*"),n=t.length;for(;n--;)(e=t[n])[this.expando]&&this.unbind(e)}return this}destroy(){this.events={}}cancel(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1}executeHandlers(e,t){let n=this.events[t],o=n&&n[e.type];if(o)for(let t=0,n=o.length;t<n;t++){let n=o[t];if(n&&!1===n.func.call(n.scope,e)&&e.preventDefault(),e.isImmediatePropagationStopped())return}}};EventUtils.Event=new EventUtils;let tv=eb.each,tE=eb.grep,tk="data-mce-style",t$=eb.makeMap("fill-opacity font-weight line-height opacity orphans widows z-index zoom"," "),legacySetAttribute=(e,t,n)=>{isNullable(n)||""===n?remove$a(e,t):set$3(e,t,n)},camelCaseToHyphens=e=>e.replace(/[A-Z]/g,e=>"-"+e.toLowerCase()),findNodeIndex=(e,t)=>{let n=0;if(e)for(let o=e.nodeType,a=e.previousSibling;a;a=a.previousSibling){let e=a.nodeType;(!(t&&ew(a))||e!==o&&a.data.length)&&(n++,o=e)}return n},updateInternalStyleAttr=(e,t)=>{let n=get$9(t,"style"),o=e.serialize(e.parse(n),name(t));legacySetAttribute(t,tk,o)},convertStyleToString=(e,t)=>x(e)?has$2(t$,t)?e+"":e+"px":e,applyStyle$1=(e,t,n)=>{let o=camelCaseToHyphens(t);isNullable(n)||""===n?remove$6(e,o):set$2(e,o,convertStyleToString(n,o))},setupAttrHooks=(e,t,n)=>{let o=t.keep_values,a={set:(e,o,a)=>{let i=eS.fromDom(e);R(t.url_converter)&&isNonNullable(o)&&(o=t.url_converter.call(t.url_converter_scope||n(),String(o),a,e));let l="data-mce-"+a;legacySetAttribute(i,l,o),legacySetAttribute(i,a,o)},get:(e,t)=>{let n=eS.fromDom(e);return get$9(n,"data-mce-"+t)||get$9(n,t)}},i={style:{set:(t,n)=>{let a=eS.fromDom(t);o&&legacySetAttribute(a,tk,n),remove$a(a,"style"),k(n)&&setAll(a,e.parse(n))},get:t=>{let n=eS.fromDom(t),o=get$9(n,tk)||get$9(n,"style");return e.serialize(e.parse(o),name(n))}}};return o&&(i.href=i.src=a),i},DOMUtils=(e,t={})=>{let n={},o=window,a={},i=0,l=tt.forElement(eS.fromDom(e),{contentCssCors:t.contentCssCors,referrerPolicy:t.referrerPolicy}),s=[],d=t.schema?t.schema:Schema({}),c=Styles({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope},t.schema),m=t.ownEvents?new EventUtils:EventUtils.Event,u=d.getBlockElements(),get=t=>t&&e&&k(t)?e.getElementById(t):t,_get=e=>{let t=get(e);return isNonNullable(t)?eS.fromDom(t):null},getAttrib=(e,t,n="")=>{let o;let a=_get(e);if(isNonNullable(a)&&ev(a)){let e=h[t];o=e&&e.get?e.get(a.dom,t):get$9(a,t)}return isNonNullable(o)?o:n},getAttribs=e=>{let t=get(e);return isNullable(t)?[]:t.attributes},setAttrib=(e,n,o)=>{run(e,e=>{if(eR(e)){let a=eS.fromDom(e),i=""===o?null:o,l=get$9(a,n),s=h[n];s&&s.set?s.set(a.dom,i,n):legacySetAttribute(a,n,i),l!==i&&t.onSetAttrib&&t.onSetAttrib({attrElm:a.dom,attrName:n,attrValue:i})}})},getRoot=()=>t.root_element||e.body,getPos$1=(t,n)=>getPos(e.body,get(t),n),getStyle=(e,t,n)=>{let o=get(e);return isNullable(o)||!eR(o)?void 0:n?get$7(eS.fromDom(o),camelCaseToHyphens(t)):("float"===(t=t.replace(/-(\D)/g,(e,t)=>t.toUpperCase()))&&(t="cssFloat"),o.style?o.style[t]:void 0)},getSize=e=>{let t=get(e);if(!t)return{w:0,h:0};let n=getStyle(t,"width"),o=getStyle(t,"height");return n&&-1!==n.indexOf("px")||(n="0"),o&&-1!==o.indexOf("px")||(o="0"),{w:parseInt(n,10)||t.offsetWidth||t.clientWidth,h:parseInt(o,10)||t.offsetHeight||t.clientHeight}},is=(e,t)=>{if(!e)return!1;let n=S(e)?e:[e];return exists(n,e=>is$1(eS.fromDom(e),t))},getParents=(e,t,n,o)=>{let a=[],i=get(e);o=void 0===o;let l=n||("BODY"!==getRoot().nodeName?getRoot().parentNode:null);if(k(t)){if("*"===t)t=eR;else{let e=t;t=t=>is(t,e)}}for(;i&&!(i===l||isNullable(i.nodeType)||eD(i)||eI(i));){if(!t||t(i)){if(!o)return[i];a.push(i)}i=i.parentNode}return o?a:null},_findSib=(e,t,n)=>{let o=t;if(e){k(t)&&(o=e=>is(e,t));for(let t=e[n];t;t=t[n])if(R(o)&&o(t))return t}return null},isParentNode=e=>R(e.querySelectorAll),run=function(e,t,n){let o=null!=n?n:this;if(S(e)){let n=[];return tv(e,(e,a)=>{let i=get(e);i&&n.push(t.call(o,i,a))}),n}{let n=get(e);return!!n&&t.call(o,n)}},setAttribs=(e,t)=>{run(e,e=>{each$d(t,(t,n)=>{setAttrib(e,n,t)})})},setHTML=(e,t)=>{run(e,e=>{let n=eS.fromDom(e);set$1(n,t)})},add=(t,n,o,a,i)=>run(t,t=>{let l=k(n)?e.createElement(n):n;return isNonNullable(o)&&setAttribs(l,o),a&&(!k(a)&&a.nodeType?l.appendChild(a):k(a)&&setHTML(l,a)),i?l:t.appendChild(l)}),create=(t,n,o)=>add(e.createElement(t),t,n,o,!0),p=tu.decode,g=tu.encodeAllRaw,remove=(e,t)=>run(e,e=>{let n=eS.fromDom(e);return t&&each$e(children$1(n),e=>{eE(e)&&0===e.dom.length?remove$5(e):before$3(n,e)}),remove$5(n),n.dom}),toggleClass=(e,t,n)=>{run(e,e=>{if(eR(e)){let o=eS.fromDom(e),a=t.split(" ");each$e(a,e=>{if(isNonNullable(n)){let t=n?add$2:remove$7;t(o,e)}else toggle$1(o,e)})}})},replace=(e,t,n)=>run(t,o=>{var a;let i=S(t)?e.cloneNode(!0):e;return n&&tv(tE(o.childNodes),e=>{i.appendChild(e)}),null===(a=o.parentNode)||void 0===a||a.replaceChild(i,o),o}),isNonEmptyElement=e=>{if(eR(e)){let t="a"===e.nodeName.toLowerCase()&&!getAttrib(e,"href")&&getAttrib(e,"id");if(getAttrib(e,"name")||getAttrib(e,"data-mce-bookmark")||t)return!0}return!1},createRng=()=>e.createRange(),bind=(n,a,i,l)=>{if(!S(n))return t.collect&&(n===e||n===o)&&s.push([n,a,i,l]),m.bind(n,a,i,l||f);{let e=n.length,t=[];for(;e--;)t[e]=bind(n[e],a,i,l);return t}},unbind=(t,n,a)=>{if(S(t)){let e=t.length,o=[];for(;e--;)o[e]=unbind(t[e],n,a);return o}if(s.length>0&&(t===e||t===o)){let e=s.length;for(;e--;){let[o,i,l]=s[e];t!==o||n&&n!==i||a&&a!==l||m.unbind(o,i,l)}}return m.unbind(t,n,a)},getContentEditable=e=>{if(!(e&&eR(e)))return null;{let t=e.getAttribute("data-mce-contenteditable");return t&&"inherit"!==t?t:"inherit"!==e.contentEditable?e.contentEditable:null}},f={doc:e,settings:t,win:o,files:a,stdMode:!0,boxModel:!0,styleSheetLoader:l,boundEvents:s,styles:c,schema:d,events:m,isBlock:e=>k(e)?has$2(u,e):eR(e)&&(has$2(u,e.nodeName)||isTransparentBlock(d,e)),root:null,clone:(e,t)=>e.cloneNode(t),getRoot,getViewPort:e=>{let t=getBounds(e);return{x:t.x,y:t.y,w:t.width,h:t.height}},getRect:e=>{let t=get(e),n=getPos$1(t),o=getSize(t);return{x:n.x,y:n.y,w:o.w,h:o.h}},getSize,getParent:(e,t,n)=>{let o=getParents(e,t,n,!1);return o&&o.length>0?o[0]:null},getParents:getParents,get,getNext:(e,t)=>_findSib(e,t,"nextSibling"),getPrev:(e,t)=>_findSib(e,t,"previousSibling"),select:(n,o)=>{var a,i;let l=null!==(i=null!==(a=get(o))&&void 0!==a?a:t.root_element)&&void 0!==i?i:e;return isParentNode(l)?I(l.querySelectorAll(n)):[]},is,add,create,createHTML:(e,t,n="")=>{let o="<"+e;for(let e in t)hasNonNullableKey(t,e)&&(o+=" "+e+'="'+g(t[e])+'"');return isEmpty$3(n)&&has$2(d.getVoidElements(),e)?o+" />":o+">"+n+"</"+e+">"},createFragment:t=>{let n;let o=e.createElement("div"),a=e.createDocumentFragment();for(a.appendChild(o),t&&(o.innerHTML=t);n=o.firstChild;)a.appendChild(n);return a.removeChild(o),a},remove,setStyle:(e,n,o)=>{run(e,e=>{let a=eS.fromDom(e);applyStyle$1(a,n,o),t.update_styles&&updateInternalStyleAttr(c,a)})},getStyle:getStyle,setStyles:(e,n)=>{run(e,e=>{let o=eS.fromDom(e);each$d(n,(e,t)=>{applyStyle$1(o,t,e)}),t.update_styles&&updateInternalStyleAttr(c,o)})},removeAllAttribs:e=>run(e,e=>{let t=e.attributes;for(let n=t.length-1;n>=0;n--)e.removeAttributeNode(t.item(n))}),setAttrib,setAttribs,getAttrib,getPos:getPos$1,parseStyle:e=>c.parse(e),serializeStyle:(e,t)=>c.serialize(e,t),addStyle:t=>{if(f!==DOMUtils.DOM&&e===document){if(n[t])return;n[t]=!0}let o=e.getElementById("mceDefaultStyles");if(!o){(o=e.createElement("style")).id="mceDefaultStyles",o.type="text/css";let t=e.head;t.firstChild?t.insertBefore(o,t.firstChild):t.appendChild(o)}o.styleSheet?o.styleSheet.cssText+=t:o.appendChild(e.createTextNode(t))},loadCSS:e=>{e||(e=""),each$e(e.split(","),e=>{a[e]=!0,l.load(e).catch(noop)})},addClass:(e,t)=>{toggleClass(e,t,!0)},removeClass:(e,t)=>{toggleClass(e,t,!1)},hasClass:(e,t)=>{let n=_get(e),o=t.split(" ");return isNonNullable(n)&&forall(o,e=>has(n,e))},toggleClass,show:e=>{run(e,e=>remove$6(eS.fromDom(e),"display"))},hide:e=>{run(e,e=>set$2(eS.fromDom(e),"display","none"))},isHidden:e=>{let t=_get(e);return isNonNullable(t)&&is$2(getRaw(t,"display"),"none")},uniqueId:e=>(e||"mce_")+i++,setHTML,getOuterHTML:e=>{let t=_get(e);return isNonNullable(t)?eR(t.dom)?t.dom.outerHTML:getOuter(t):""},setOuterHTML:(e,t)=>{run(e,e=>{eR(e)&&(e.outerHTML=t)})},decode:p,encode:g,insertAfter:(e,t)=>{let n=get(t);return run(e,e=>{let t=null==n?void 0:n.parentNode,o=null==n?void 0:n.nextSibling;return t&&(o?t.insertBefore(e,o):t.appendChild(e)),e})},replace,rename:(e,t)=>{if(e.nodeName===t.toUpperCase())return e;{let n=create(t);return tv(getAttribs(e),t=>{setAttrib(n,t.nodeName,getAttrib(e,t.nodeName))}),replace(n,e,!0),n}},findCommonAncestor:(e,t)=>{let n=e;for(;n;){let e=t;for(;e&&n!==e;)e=e.parentNode;if(n===e)break;n=n.parentNode}return!n&&e.ownerDocument?e.ownerDocument.documentElement:n},run,getAttribs,isEmpty:(e,t,n)=>{let o=0;if(isNonEmptyElement(e))return!1;let a=e.firstChild;if(a){let i=new DomTreeWalker(a,e),l=d?d.getWhitespaceElements():{},s=t||(d?d.getNonEmptyElements():null),c=a;do{if(eR(c)){let e=c.getAttribute("data-mce-bogus");if(e){c=i.next("all"===e);continue}let t=c.nodeName.toLowerCase();if(s&&s[t]){if("br"===t){o++,c=i.next();continue}return!1}if(isNonEmptyElement(c))return!1}if(eB(c)||ew(c)&&!isWhitespaceText(c.data)&&(!(null==n?void 0:n.includeZwsp)||!isZwsp(c.data))||ew(c)&&c.parentNode&&l[c.parentNode.nodeName]&&isWhitespaceText(c.data))return!1;c=i.next()}while(c)}return o<=1},createRng,nodeIndex:findNodeIndex,split:(e,t,n)=>{let o,a,i=createRng();if(e&&t&&e.parentNode&&t.parentNode){let l=e.parentNode;return i.setStart(l,findNodeIndex(e)),i.setEnd(t.parentNode,findNodeIndex(t)),o=i.extractContents(),(i=createRng()).setStart(t.parentNode,findNodeIndex(t)+1),i.setEnd(l,findNodeIndex(e)+1),a=i.extractContents(),l.insertBefore(trimNode(f,o),e),n?l.insertBefore(n,e):l.insertBefore(t,e),l.insertBefore(trimNode(f,a),e),remove(e),n||t}},bind:bind,unbind:unbind,fire:(e,t,n)=>m.dispatch(e,t,n),dispatch:(e,t,n)=>m.dispatch(e,t,n),getContentEditable,getContentEditableParent:e=>{let t=getRoot(),n=null;for(let o=e;o&&o!==t&&null===(n=getContentEditable(o));o=o.parentNode);return n},isEditable:e=>{if(!isNonNullable(e))return!1;{let t=eR(e)?e:e.parentElement;return isNonNullable(t)&&isEditable$3(eS.fromDom(t))}},destroy:()=>{if(s.length>0){let e=s.length;for(;e--;){let[t,n,o]=s[e];m.unbind(t,n,o)}}each$d(a,(e,t)=>{l.unload(t),delete a[t]})},isChildOf:(e,t)=>e===t||t.contains(e),dumpRng:e=>"startContainer: "+e.startContainer.nodeName+", startOffset: "+e.startOffset+", endContainer: "+e.endContainer.nodeName+", endOffset: "+e.endOffset},h=setupAttrHooks(c,t,constant(f));return f};DOMUtils.DOM=DOMUtils(document),DOMUtils.nodeIndex=findNodeIndex;let tS=DOMUtils.DOM;let ScriptLoader=class ScriptLoader{constructor(e={}){this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=!1,this.settings=e}_setReferrerPolicy(e){this.settings.referrerPolicy=e}loadScript(e){return new Promise((t,n)=>{let o;let cleanup=()=>{tS.remove(a),o&&(o.onerror=o.onload=o=null)},a=tS.uniqueId();(o=document.createElement("script")).id=a,o.type="text/javascript",o.src=eb._addCacheSuffix(e),this.settings.referrerPolicy&&tS.setAttrib(o,"referrerpolicy",this.settings.referrerPolicy),o.onload=()=>{cleanup(),t()},o.onerror=()=>{cleanup(),n("Failed to load script: "+e)},(document.getElementsByTagName("head")[0]||document.body).appendChild(o)})}isDone(e){return 2===this.states[e]}markDone(e){this.states[e]=2}add(e){let t=this;t.queue.push(e);let n=t.states[e];return void 0===n&&(t.states[e]=0),new Promise((n,o)=>{t.scriptLoadedCallbacks[e]||(t.scriptLoadedCallbacks[e]=[]),t.scriptLoadedCallbacks[e].push({resolve:n,reject:o})})}load(e){return this.add(e)}remove(e){delete this.states[e],delete this.scriptLoadedCallbacks[e]}loadQueue(){let e=this.queue;return this.queue=[],this.loadScripts(e)}loadScripts(e){let t=this,execCallbacks=(e,n)=>{get$a(t.scriptLoadedCallbacks,n).each(t=>{each$e(t,t=>t[e](n))}),delete t.scriptLoadedCallbacks[n]},processResults=e=>{let t=filter$5(e,e=>"rejected"===e.status);return t.length>0?Promise.reject(bind$3(t,({reason:e})=>S(e)?e:[e])):Promise.resolve()},load=e=>Promise.allSettled(map$3(e,e=>2===t.states[e]?(execCallbacks("resolve",e),Promise.resolve()):3===t.states[e]?(execCallbacks("reject",e),Promise.reject(e)):(t.states[e]=1,t.loadScript(e).then(()=>{t.states[e]=2,execCallbacks("resolve",e);let n=t.queue;return n.length>0?(t.queue=[],load(n).then(processResults)):Promise.resolve()},()=>(t.states[e]=3,execCallbacks("reject",e),Promise.reject(e)))))),processQueue=e=>(t.loading=!0,load(e).then(e=>{t.loading=!1;let n=t.queueLoadedCallbacks.shift();return Optional.from(n).each(call),processResults(e)})),n=stringArray(e);return t.loading?new Promise((e,o)=>{t.queueLoadedCallbacks.push(()=>{processQueue(n).then(e,o)})}):processQueue(n)}};ScriptLoader.ScriptLoader=new ScriptLoader;let Cell=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}},isDuplicated=(e,t)=>{let n=e.indexOf(t);return -1!==n&&e.indexOf(t,n+1)>n},isRaw=e=>$(e)&&has$2(e,"raw"),isTokenised=e=>S(e)&&e.length>1,tN={},tO=Cell("en"),getLanguageData=()=>get$a(tN,tO.get()),tP={getData:()=>map$2(tN,e=>({...e})),setCode:e=>{e&&tO.set(e)},getCode:()=>tO.get(),add:(e,t)=>{let n=tN[e];n||(tN[e]=n={});let o=map$3(F(t),e=>e.toLowerCase());each$d(t,(e,a)=>{let i=a.toLowerCase();i!==a&&isDuplicated(o,i)?(has$2(t,i)||(n[i]=e),n[a]=e):n[i]=e})},translate:e=>{let t=getLanguageData().getOr({}),toString=e=>R(e)?Object.prototype.toString.call(e):isEmpty(e)?"":""+e,isEmpty=e=>""===e||null==e,getLangData=e=>{let n=toString(e);return has$2(t,n)?toString(t[n]):get$a(t,n.toLowerCase()).map(toString).getOr(n)},removeContext=e=>e.replace(/{context:\w+}$/,"");if(isEmpty(e))return"";if(isRaw(e))return toString(e.raw);if(isTokenised(e)){let t=e.slice(1),n=getLangData(e[0]).replace(/\{([0-9]+)\}/g,(e,n)=>has$2(t,n)?toString(t[n]):e);return removeContext(n)}return removeContext(getLangData(e))},isRtl:()=>getLanguageData().bind(e=>get$a(e,"_dir")).exists(e=>"rtl"===e),hasCode:e=>has$2(tN,e)},AddOnManager=()=>{let e=[],t={},n={},o=[],runListeners=(e,t)=>{let n=filter$5(o,n=>n.name===e&&n.state===t);each$e(n,e=>e.resolve())},isLoaded=e=>has$2(t,e),isAdded=e=>has$2(n,e),loadLanguagePack=(e,n)=>{let o=tP.getCode();o&&(!n||-1!==(","+(n||"")+",").indexOf(","+o+","))&&ScriptLoader.ScriptLoader.add(t[e]+"/langs/"+o+".js")},waitFor=(e,t="added")=>"added"===t&&isAdded(e)?Promise.resolve():"loaded"===t&&isLoaded(e)?Promise.resolve():new Promise(n=>{o.push({name:e,state:t,resolve:n})});return{items:e,urls:t,lookup:n,get:e=>{if(n[e])return n[e].instance},requireLangPack:(e,t)=>{!1!==AddOnManager.languageLoad&&(isLoaded(e)?loadLanguagePack(e,t):waitFor(e,"loaded").then(()=>loadLanguagePack(e,t)))},add:(t,o)=>(e.push(o),n[t]={instance:o},runListeners(t,"added"),o),remove:e=>{delete t[e],delete n[e]},createUrl:(e,t)=>k(t)?k(e)?{prefix:"",resource:t,suffix:""}:{prefix:e.prefix,resource:t,suffix:e.suffix}:t,load:(e,o)=>{if(t[e])return Promise.resolve();let a=k(o)?o:o.prefix+o.resource+o.suffix;0!==a.indexOf("/")&&-1===a.indexOf("://")&&(a=AddOnManager.baseURL+"/"+a),t[e]=a.substring(0,a.lastIndexOf("/"));let done=()=>(runListeners(e,"loaded"),Promise.resolve());return n[e]?done():ScriptLoader.ScriptLoader.add(a).then(done)},waitFor}};AddOnManager.languageLoad=!0,AddOnManager.baseURL="",AddOnManager.PluginManager=AddOnManager(),AddOnManager.ThemeManager=AddOnManager(),AddOnManager.ModelManager=AddOnManager();let singleton=e=>{let t=Cell(Optional.none()),revoke=()=>t.get().each(e);return{clear:()=>{revoke(),t.set(Optional.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:e=>{revoke(),t.set(Optional.some(e))}}},repeatable=e=>{let t=Cell(Optional.none()),revoke=()=>t.get().each(e=>clearInterval(e));return{clear:()=>{revoke(),t.set(Optional.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:n=>{revoke(),t.set(Optional.some(setInterval(n,e)))}}},value$2=()=>{let e=singleton(noop);return{...e,on:t=>e.get().each(t)}},first$1=(e,t)=>{let n=null;return{cancel:()=>{N(n)||(clearTimeout(n),n=null)},throttle:(...o)=>{N(n)&&(n=setTimeout(()=>{n=null,e.apply(null,o)},t))}}},last$1=(e,t)=>{let n=null,cancel=()=>{N(n)||(clearTimeout(n),n=null)};return{cancel,throttle:(...o)=>{cancel(),n=setTimeout(()=>{n=null,e.apply(null,o)},t)}}},tR=constant("mce-annotation"),tx=constant("data-mce-annotation"),tw=constant("data-mce-annotation-uid"),tA=constant("data-mce-annotation-active"),tT=constant("data-mce-annotation-classes"),tB=constant("data-mce-annotation-attrs"),isRoot$1=e=>t=>eq(t,e),identify=(e,t)=>{let n=e.selection.getRng(),o=eS.fromDom(n.startContainer),a=eS.fromDom(e.getBody()),i=t.fold(()=>"."+tR(),e=>`[${tx()}="${e}"]`),l=child$1(o,n.startOffset).getOr(o),s=closest$3(l,i,isRoot$1(a));return s.bind(t=>getOpt(t,`${tw()}`).bind(n=>getOpt(t,`${tx()}`).map(t=>{let o=findMarkers(e,n);return{uid:n,name:t,elements:o}})))},isAnnotation=e=>ev(e)&&has(e,tR()),isBogusElement=(e,t)=>has$1(e,"data-mce-bogus")||ancestor$2(e,'[data-mce-bogus="all"]',isRoot$1(t)),findMarkers=(e,t)=>{let n=eS.fromDom(e.getBody()),o=descendants(n,`[${tw()}="${t}"]`);return filter$5(o,e=>!isBogusElement(e,n))},findAll=(e,t)=>{let n=eS.fromDom(e.getBody()),o=descendants(n,`[${tx()}="${t}"]`),a={};return each$e(o,e=>{if(!isBogusElement(e,n)){let t=get$9(e,tw()),n=get$a(a,t).getOr([]);a[t]=n.concat([e])}}),a},setup$x=(e,t)=>{let n=Cell({}),initData=()=>({listeners:[],previous:value$2()}),withCallbacks=(e,t)=>{updateCallbacks(e,e=>(t(e),e))},updateCallbacks=(e,t)=>{let o=n.get(),a=get$a(o,e).getOrThunk(initData),i=t(a);o[e]=i,n.set(o)},fireCallbacks=(e,t,n)=>{withCallbacks(e,o=>{each$e(o.listeners,o=>o(!0,e,{uid:t,nodes:map$3(n,e=>e.dom)}))})},fireNoAnnotation=e=>{withCallbacks(e,t=>{each$e(t.listeners,t=>t(!1,e))})},toggleActiveAttr=(t,n)=>{each$e(findMarkers(e,t),e=>{n?set$3(e,tA(),"true"):remove$a(e,tA())})},o=last$1(()=>{let n=sort(t.getNames());each$e(n,t=>{updateCallbacks(t,n=>{let o=n.previous.get();return identify(e,Optional.some(t)).fold(()=>{o.each(e=>{fireNoAnnotation(t),n.previous.clear(),toggleActiveAttr(e,!1)})},({uid:e,name:t,elements:a})=>{is$2(o,e)||(o.each(e=>toggleActiveAttr(e,!1)),fireCallbacks(t,e,a),n.previous.set(e),toggleActiveAttr(e,!0))}),{previous:n.previous,listeners:n.listeners}})})},30);return e.on("remove",()=>{o.cancel()}),e.on("NodeChange",()=>{o.throttle()}),{addListener:(e,t)=>{updateCallbacks(e,e=>({previous:e.previous,listeners:e.listeners.concat([t])}))}}},setup$w=(e,t)=>{let n=tx(),identifyParserNode=e=>Optional.from(e.attr(n)).bind(t.lookup),removeDirectAnnotation=e=>{var t,n;e.attr(tw(),null),e.attr(tx(),null),e.attr(tA(),null);let o=Optional.from(e.attr(tB())).map(e=>e.split(",")).getOr([]),a=Optional.from(e.attr(tT())).map(e=>e.split(",")).getOr([]);each$e(o,t=>e.attr(t,null));let i=null!==(n=null===(t=e.attr("class"))||void 0===t?void 0:t.split(" "))&&void 0!==n?n:[],l=difference(i,[tR()].concat(a));e.attr("class",l.length>0?l.join(" "):null),e.attr(tT(),null),e.attr(tB(),null)};e.serializer.addTempAttr(tA()),e.serializer.addAttributeFilter(n,e=>{for(let t of e)identifyParserNode(t).each(e=>{!1===e.persistent&&("span"===t.name?t.unwrap():removeDirectAnnotation(t))})})},create$c=()=>{let e={};return{register:(t,n)=>{e[t]={name:t,settings:n}},lookup:t=>get$a(e,t).map(e=>e.settings),getNames:()=>F(e)}},tD=0,generate$1=e=>{let t=new Date,n=t.getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++tD+String(n)},add=(e,t)=>{each$e(t,t=>{add$2(e,t)})},remove$4=(e,t)=>{each$e(t,t=>{remove$7(e,t)})},clone$2=(e,t)=>eS.fromDom(e.dom.cloneNode(t)),shallow$1=e=>clone$2(e,!1),deep$1=e=>clone$2(e,!0),shallowAs=(e,t)=>{let n=eS.fromTag(t),o=clone$4(e);return setAll$1(n,o),n},mutate=(e,t)=>{let n=shallowAs(e,t);after$4(e,n);let o=children$1(e);return append(n,o),remove$5(e),n},TextWalker=(e,t,n=w)=>{let o=new DomTreeWalker(e,t),walk=e=>{let t;do t=o[e]();while(t&&!ew(t)&&!n(t));return Optional.from(t).filter(ew)};return{current:()=>Optional.from(o.current()).filter(ew),next:()=>walk("next"),prev:()=>walk("prev"),prev2:()=>walk("prev2")}},TextSeeker=(e,t)=>{let n=t||(t=>e.isBlock(t)||eF(t)||eM(t)),walk=(e,t,n,o)=>{if(ew(e)){let n=o(e,t,e.data);if(-1!==n)return Optional.some({container:e,offset:n})}return n().bind(e=>walk(e.container,e.offset,n,o))};return{backwards:(t,o,a,i)=>{let l=TextWalker(t,null!=i?i:e.getRoot(),n);return walk(t,o,()=>l.prev().map(e=>({container:e,offset:e.length})),a).getOrNull()},forwards:(t,o,a,i)=>{let l=TextWalker(t,null!=i?i:e.getRoot(),n);return walk(t,o,()=>l.next().map(e=>({container:e,offset:0})),a).getOrNull()}}},tI=Math.round,clone$1=e=>e?{left:tI(e.left),top:tI(e.top),bottom:tI(e.bottom),right:tI(e.right),width:tI(e.width),height:tI(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0},collapse=(e,t)=>(e=clone$1(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e),isEqual=(e,t)=>e.left===t.left&&e.top===t.top&&e.bottom===t.bottom&&e.right===t.right,isValidOverflow=(e,t,n)=>e>=0&&e<=Math.min(t.height,n.height)/2,isAbove$1=(e,t)=>{let n=Math.min(t.height/2,e.height/2);return e.bottom-n<t.top||!(e.top>t.bottom)&&isValidOverflow(t.top-e.bottom,e,t)},isBelow$1=(e,t)=>e.top>t.bottom||!(e.bottom<t.top)&&isValidOverflow(t.bottom-e.top,e,t),containsXY=(e,t,n)=>t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom,boundingClientRectFromRects=e=>foldl(e,(e,t)=>e.fold(()=>Optional.some(t),e=>{let n=Math.min(t.left,e.left),o=Math.min(t.top,e.top),a=Math.max(t.right,e.right),i=Math.max(t.bottom,e.bottom);return Optional.some({top:o,right:a,bottom:i,left:n,width:a-n,height:i-o})}),Optional.none()),distanceToRectEdgeFromXY=(e,t,n)=>{let o=Math.max(Math.min(t,e.left+e.width),e.left),a=Math.max(Math.min(n,e.top+e.height),e.top);return Math.sqrt((t-o)*(t-o)+(n-a)*(n-a))},overlapY=(e,t)=>Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),clamp$2=(e,t,n)=>Math.min(Math.max(e,t),n),getSelectedNode=e=>{let t=e.startContainer,n=e.startOffset;return t===e.endContainer&&t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null},getNode$1=(e,t)=>{if(!(eR(e)&&e.hasChildNodes()))return e;{let n=e.childNodes,o=clamp$2(t,0,n.length-1);return n[o]}},tF=RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]"),isExtendingChar=e=>k(e)&&e.charCodeAt(0)>=768&&tF.test(e),t_=matchStyleValues("display","block table"),tL=matchStyleValues("float","left right"),tM=((...e)=>t=>{for(let n=0;n<e.length;n++)if(!e[n](t))return!1;return!0})(eR,isCaretCandidate$3,not(tL)),tU=not(matchStyleValues("white-space","pre pre-line pre-wrap")),tz=DOMUtils.nodeIndex,resolveIndex$1=(e,t)=>{if(!(t<0&&eR(e)&&e.hasChildNodes()))return getNode$1(e,t)},createRange$1=e=>e?e.createRange():DOMUtils.DOM.createRng(),isWhiteSpace$1=e=>k(e)&&/[\r\n\t ]/.test(e),isRange=e=>!!e.setStart&&!!e.setEnd,isHiddenWhiteSpaceRange=e=>{let t=e.startContainer,n=e.startOffset;if(isWhiteSpace$1(e.toString())&&tU(t.parentNode)&&ew(t)){let e=t.data;if(isWhiteSpace$1(e[n-1])||isWhiteSpace$1(e[n+1]))return!0}return!1},getBrClientRect=e=>{let t=e.ownerDocument,n=createRange$1(t),o=t.createTextNode("\xa0"),a=e.parentNode;a.insertBefore(o,e),n.setStart(o,0),n.setEnd(o,1);let i=clone$1(n.getBoundingClientRect());return a.removeChild(o),i},getBoundingClientRectWebKitText=e=>{let t=e.startContainer,n=e.endContainer,o=e.startOffset,a=e.endOffset;if(!(t===n&&ew(n))||0!==o||1!==a)return null;{let t=e.cloneRange();return t.setEndAfter(n),getBoundingClientRect$1(t)}},isZeroRect=e=>0===e.left&&0===e.right&&0===e.top&&0===e.bottom,getBoundingClientRect$1=e=>{var t;let n;let o=e.getClientRects();return(n=o.length>0?clone$1(o[0]):clone$1(e.getBoundingClientRect()),!isRange(e)&&eF(e)&&isZeroRect(n))?getBrClientRect(e):isZeroRect(n)&&isRange(e)&&null!==(t=getBoundingClientRectWebKitText(e))&&void 0!==t?t:n},collapseAndInflateWidth=(e,t)=>{let n=collapse(e,t);return n.width=1,n.right=n.left+1,n},getCaretPositionClientRects=e=>{let t=[],addUniqueAndValidRect=e=>{0===e.height||t.length>0&&isEqual(e,t[t.length-1])||t.push(e)},addCharacterOffset=(e,t)=>{let n=createRange$1(e.ownerDocument);if(t<e.data.length){if(isExtendingChar(e.data[t]))return;if(isExtendingChar(e.data[t-1])&&(n.setStart(e,t),n.setEnd(e,t+1),!isHiddenWhiteSpaceRange(n))){addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(n),!1));return}}t>0&&(n.setStart(e,t-1),n.setEnd(e,t),isHiddenWhiteSpaceRange(n)||addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(n),!1))),t<e.data.length&&(n.setStart(e,t),n.setEnd(e,t+1),isHiddenWhiteSpaceRange(n)||addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(n),!0)))},n=e.container(),o=e.offset();if(ew(n))return addCharacterOffset(n,o),t;if(eR(n)){if(e.isAtEnd()){let e=resolveIndex$1(n,o);ew(e)&&addCharacterOffset(e,e.data.length),tM(e)&&!eF(e)&&addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(e),!1))}else{let a=resolveIndex$1(n,o);if(ew(a)&&addCharacterOffset(a,0),tM(a)&&e.isAtEnd())return addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(a),!1)),t;let i=resolveIndex$1(e.container(),e.offset()-1);tM(i)&&!eF(i)&&(t_(i)||t_(a)||!tM(a))&&addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(i),!1)),tM(a)&&addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(a),!0))}}return t},CaretPosition=(e,t,n)=>{let getClientRects=()=>(n||(n=getCaretPositionClientRects(CaretPosition(e,t))),n);return{container:constant(e),offset:constant(t),toRange:()=>{let n=createRange$1(e.ownerDocument);return n.setStart(e,t),n.setEnd(e,t),n},getClientRects,isVisible:()=>getClientRects().length>0,isAtStart:()=>(ew(e),0===t),isAtEnd:()=>ew(e)?t>=e.data.length:t>=e.childNodes.length,isEqual:n=>n&&e===n.container()&&t===n.offset(),getNode:n=>resolveIndex$1(e,n?t-1:t)}};CaretPosition.fromRangeStart=e=>CaretPosition(e.startContainer,e.startOffset),CaretPosition.fromRangeEnd=e=>CaretPosition(e.endContainer,e.endOffset),CaretPosition.after=e=>CaretPosition(e.parentNode,tz(e)+1),CaretPosition.before=e=>CaretPosition(e.parentNode,tz(e)),CaretPosition.isAbove=(e,t)=>lift2(head(t.getClientRects()),last$3(e.getClientRects()),isAbove$1).getOr(!1),CaretPosition.isBelow=(e,t)=>lift2(last$3(t.getClientRects()),head(e.getClientRects()),isBelow$1).getOr(!1),CaretPosition.isAtStart=e=>!!e&&e.isAtStart(),CaretPosition.isAtEnd=e=>!!e&&e.isAtEnd(),CaretPosition.isTextPosition=e=>!!e&&ew(e.container()),CaretPosition.isElementPosition=e=>!CaretPosition.isTextPosition(e);let trimEmptyTextNode$1=(e,t)=>{ew(t)&&0===t.data.length&&e.remove(t)},insertNode=(e,t,n)=>{t.insertNode(n),trimEmptyTextNode$1(e,n.previousSibling),trimEmptyTextNode$1(e,n.nextSibling)},insertFragment=(e,t,n)=>{let o=Optional.from(n.firstChild),a=Optional.from(n.lastChild);t.insertNode(n),o.each(t=>trimEmptyTextNode$1(e,t.previousSibling)),a.each(t=>trimEmptyTextNode$1(e,t.nextSibling))},rangeInsertNode=(e,t,n)=>{eI(n)?insertFragment(e,t,n):insertNode(e,t,n)},tW=DOMUtils.nodeIndex,normalizedParent=e=>{let t=e.parentNode;return isBogus$2(t)?normalizedParent(t):t},getChildNodes=e=>e?reduce(e.childNodes,(e,t)=>(isBogus$2(t)&&"BR"!==t.nodeName?e=e.concat(getChildNodes(t)):e.push(t),e),[]):[],normalizedTextOffset=(e,t)=>{let n=e;for(;(n=n.previousSibling)&&ew(n);)t+=n.data.length;return t},equal=e=>t=>e===t,normalizedNodeIndex=e=>{let t,n;n=findIndex$1(t=getChildNodes(normalizedParent(e)),equal(e),e),t=t.slice(0,n+1);let o=reduce(t,(e,n,o)=>(ew(n)&&ew(t[o-1])&&e++,e),0);return(n=findIndex$1(t=filter$3(t,matchNodeNames([e.nodeName])),equal(e),e))-o},createPathItem=e=>{let t=ew(e)?"text()":e.nodeName.toLowerCase();return t+"["+normalizedNodeIndex(e)+"]"},parentsUntil$1=(e,t,n)=>{let o=[];for(let a=t.parentNode;a&&a!==e&&!(n&&n(a));a=a.parentNode)o.push(a);return o},create$b=(e,t)=>{let n,o=[],a=t.container(),i=t.offset();if(ew(a))n=normalizedTextOffset(a,i);else{let e=a.childNodes;i>=e.length?(n="after",i=e.length-1):n="before",a=e[i]}o.push(createPathItem(a));let l=parentsUntil$1(e,a);return l=filter$3(l,not(isBogus$2)),(o=o.concat(map$1(l,e=>createPathItem(e)))).reverse().join("/")+","+n},resolvePathItem=(e,t,n)=>{let o=getChildNodes(e);return o=filter$3(o,(e,t)=>!ew(e)||!ew(o[t-1])),(o=filter$3(o,matchNodeNames([t])))[n]},findTextPosition=(e,t)=>{let n=e,o=0;for(;ew(n);){let a=n.data.length;if(t>=o&&t<=o+a){e=n,t-=o;break}if(!ew(n.nextSibling)){e=n,t=a;break}o+=a,n=n.nextSibling}return ew(e)&&t>e.data.length&&(t=e.data.length),CaretPosition(e,t)},resolve$1=(e,t)=>{if(!t)return null;let n=t.split(","),o=n[0].split("/"),a=n.length>1?n[1]:"before",i=reduce(o,(e,t)=>{let n=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(t);return n?("text()"===n[1]&&(n[1]="#text"),resolvePathItem(e,n[1],parseInt(n[2],10))):null},e);if(!i)return null;if(!ew(i)&&i.parentNode){let e;return e="after"===a?tW(i)+1:tW(i),CaretPosition(i.parentNode,e)}return findTextPosition(i,parseInt(a,10))},getNormalizedTextOffset$1=(e,t,n)=>{let o=e(t.data.slice(0,n)).length;for(let n=t.previousSibling;n&&ew(n);n=n.previousSibling)o+=e(n.data).length;return o},getPoint=(e,t,n,o,a)=>{let i=a?o.startContainer:o.endContainer,l=a?o.startOffset:o.endOffset,s=[],d=e.getRoot();if(ew(i))s.push(n?getNormalizedTextOffset$1(t,i,l):l);else{let t=0,o=i.childNodes;l>=o.length&&o.length&&(t=1,l=Math.max(0,o.length-1)),s.push(e.nodeIndex(o[l],n)+t)}for(let t=i;t&&t!==d;t=t.parentNode)s.push(e.nodeIndex(t,n));return s},getLocation=(e,t,n,o)=>{let a=t.dom,i=getPoint(a,e,n,o,!0),l=t.isForward(),s=isRangeInCaretContainerBlock(o)?{isFakeCaret:!0}:{};if(t.isCollapsed())return{start:i,forward:l,...s};{let t=getPoint(a,e,n,o,!1);return{start:i,end:t,forward:l,...s}}},findIndex=(e,t,n)=>{let o=0;return eb.each(e.select(t),e=>{if("all"!==e.getAttribute("data-mce-bogus")){if(e===n)return!1;o++}}),o},moveEndPoint$1=(e,t)=>{let n=t?e.startContainer:e.endContainer,o=t?e.startOffset:e.endOffset;if(eR(n)&&"TR"===n.nodeName){let a=n.childNodes;(n=a[Math.min(t?o:o-1,a.length-1)])&&(o=t?0:n.childNodes.length,t?e.setStart(n,o):e.setEnd(n,o))}},normalizeTableCellSelection=e=>(moveEndPoint$1(e,!0),moveEndPoint$1(e,!1),e),findSibling=(e,t)=>{if(eR(e)&&eM(e=getNode$1(e,t)))return e;if(isCaretContainer$2(e)){ew(e)&&isCaretContainerBlock$1(e)&&(e=e.parentNode);let t=e.previousSibling;if(eM(t)||eM(t=e.nextSibling))return t}},findAdjacentContentEditableFalseElm=e=>findSibling(e.startContainer,e.startOffset)||findSibling(e.endContainer,e.endOffset),getOffsetBookmark=(e,t,n)=>{let o=n.getNode(),a=n.getRng();if("IMG"===o.nodeName||eM(o)){let e=o.nodeName;return{name:e,index:findIndex(n.dom,e,o)}}let i=findAdjacentContentEditableFalseElm(a);if(i){let e=i.tagName;return{name:e,index:findIndex(n.dom,e,i)}}return getLocation(e,n,t,a)},getCaretBookmark=e=>{let t=e.getRng();return{start:create$b(e.dom.getRoot(),CaretPosition.fromRangeStart(t)),end:create$b(e.dom.getRoot(),CaretPosition.fromRangeEnd(t)),forward:e.isForward()}},getRangeBookmark=e=>({rng:e.getRng(),forward:e.isForward()}),createBookmarkSpan=(e,t,n)=>{let o={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",o,"&#xFEFF;"):e.create("span",o)},getPersistentBookmark=(e,t)=>{let n=e.dom,o=e.getRng(),a=n.uniqueId(),i=e.isCollapsed(),l=e.getNode(),s=l.nodeName,d=e.isForward();if("IMG"===s)return{name:s,index:findIndex(n,s,l)};let c=normalizeTableCellSelection(o.cloneRange());if(!i){c.collapse(!1);let e=createBookmarkSpan(n,a+"_end",t);rangeInsertNode(n,c,e)}(o=normalizeTableCellSelection(o)).collapse(!0);let m=createBookmarkSpan(n,a+"_start",t);return rangeInsertNode(n,o,m),e.moveToBookmark({id:a,keep:!0,forward:d}),{id:a,forward:d}},getBookmark$2=(e,t,n=!1)=>2===t?getOffsetBookmark(trim$2,n,e):3===t?getCaretBookmark(e):t?getRangeBookmark(e):getPersistentBookmark(e,!1),tH=curry(getOffsetBookmark,identity,!0),value$1=e=>{let applyHelper=t=>t(e),t=constant(e),outputHelper=()=>n,n={tag:!0,inner:e,fold:(t,n)=>n(e),isValue:A,isError:w,map:t=>tV.value(t(e)),mapError:outputHelper,bind:applyHelper,exists:applyHelper,forall:applyHelper,getOr:t,or:outputHelper,getOrThunk:t,orThunk:outputHelper,getOrDie:t,each:t=>{t(e)},toOptional:()=>Optional.some(e)};return n},error=e=>{let outputHelper=()=>t,t={tag:!1,inner:e,fold:(t,n)=>t(e),isValue:w,isError:A,map:outputHelper,mapError:t=>tV.error(t(e)),bind:outputHelper,exists:w,forall:A,getOr:identity,or:identity,getOrThunk:apply$1,orThunk:apply$1,getOrDie:die(String(e)),each:noop,toOptional:Optional.none};return t},tV={value:value$1,error,fromOption:(e,t)=>e.fold(()=>error(t),value$1)},tq={generate:e=>{if(!S(e))throw Error("cases must be an array");if(0===e.length)throw Error("there must be at least one case");let t=[],n={};return each$e(e,(o,a)=>{let i=F(o);if(1!==i.length)throw Error("one and only one name per case");let l=i[0],s=o[l];if(void 0!==n[l])throw Error("duplicate key detected:"+l);if("cata"===l)throw Error("cannot have a case named cata (sorry)");if(!S(s))throw Error("case arguments must be an array");t.push(l),n[l]=(...n)=>{let o=n.length;if(o!==s.length)throw Error("Wrong number of arguments to case "+l+". Expected "+s.length+" ("+s+"), got "+o);return{fold:(...t)=>{if(t.length!==e.length)throw Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);let o=t[a];return o.apply(null,n)},match:e=>{let o=F(e);if(t.length!==o.length)throw Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+o.join(","));let a=forall(t,e=>contains$2(o,e));if(!a)throw Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+t.join(", "));return e[l].apply(null,n)},log:e=>{console.log(e,{constructors:t,constructor:l,params:n})}}}}),n}};tq.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);let partition$1=e=>{let t=[],n=[];return each$e(e,e=>{e.fold(e=>{t.push(e)},e=>{n.push(e)})}),{errors:t,values:n}},isInlinePattern=e=>"inline-command"===e.type||"inline-format"===e.type,isBlockPattern=e=>"block-command"===e.type||"block-format"===e.type,normalizePattern=e=>{let err=t=>tV.error({message:t,pattern:e}),formatOrCmd=(t,n,o)=>{if(void 0!==e.format){let o;if(S(e.format)){if(!forall(e.format,k))return err(t+" pattern has non-string items in the `format` array");o=e.format}else{if(!k(e.format))return err(t+" pattern has non-string `format` parameter");o=[e.format]}return tV.value(n(o))}return void 0===e.cmd?err(t+" pattern is missing both `format` and `cmd` parameters"):k(e.cmd)?tV.value(o(e.cmd,e.value)):err(t+" pattern has non-string `cmd` parameter")};if(!$(e))return err("Raw pattern is not an object");if(!k(e.start))return err("Raw pattern is missing `start` parameter");if(void 0!==e.end){if(!k(e.end))return err("Inline pattern has non-string `end` parameter");if(0===e.start.length&&0===e.end.length)return err("Inline pattern has empty `start` and `end` parameters");let t=e.start,n=e.end;return 0===n.length&&(n=t,t=""),formatOrCmd("Inline",e=>({type:"inline-format",start:t,end:n,format:e}),(e,o)=>({type:"inline-command",start:t,end:n,cmd:e,value:o}))}return void 0!==e.replacement?k(e.replacement)?0===e.start.length?err("Replacement pattern has empty `start` parameter"):tV.value({type:"inline-command",start:"",end:e.start,cmd:"mceInsertContent",value:e.replacement}):err("Replacement pattern has non-string `replacement` parameter"):0===e.start.length?err("Block pattern has empty `start` parameter"):formatOrCmd("Block",t=>({type:"block-format",start:e.start,format:t[0]}),(t,n)=>({type:"block-command",start:e.start,cmd:t,value:n}))},getBlockPatterns=e=>filter$5(e,isBlockPattern),getInlinePatterns=e=>filter$5(e,isInlinePattern),createPatternSet=(e,t)=>({inlinePatterns:getInlinePatterns(e),blockPatterns:getBlockPatterns(e),dynamicPatternsLookup:t}),fromRawPatterns=e=>{let t=partition$1(map$3(e,normalizePattern));return each$e(t.errors,e=>console.error(e.message,e.pattern)),t.values},fromRawPatternsLookup=e=>t=>{let n=e(t);return fromRawPatterns(n)},tj=detect$2().deviceType,tK=tj.isTouch(),tG=DOMUtils.DOM,getHash=e=>{let t=e.indexOf("=")>0?e.split(/[;,](?![^=;,]*(?:[;,]|$))/):e.split(",");return foldl(t,(e,t)=>{let n=t.split("="),o=n[0],a=n.length>1?n[1]:o;return e[U(o)]=U(a),e},{})},isRegExp=e=>is$4(e,RegExp),option=e=>t=>t.options.get(e),stringOrObjectProcessor=e=>k(e)||$(e),bodyOptionProcessor=(e,t="")=>n=>{let o=k(n);if(!o)return{valid:!1,message:"Must be a string."};if(-1===n.indexOf("="))return{value:n,valid:o};{let a=getHash(n);return{value:get$a(a,e.id).getOr(t),valid:o}}},register$7=e=>{let t=e.options.register;t("id",{processor:"string",default:e.id}),t("selector",{processor:"string"}),t("target",{processor:"object"}),t("suffix",{processor:"string"}),t("cache_suffix",{processor:"string"}),t("base_url",{processor:"string"}),t("referrer_policy",{processor:"string",default:""}),t("language_load",{processor:"boolean",default:!0}),t("inline",{processor:"boolean",default:!1}),t("iframe_attrs",{processor:"object",default:{}}),t("doctype",{processor:"string",default:"<!DOCTYPE html>"}),t("document_base_url",{processor:"string",default:e.documentBaseUrl}),t("body_id",{processor:bodyOptionProcessor(e,"tinymce"),default:"tinymce"}),t("body_class",{processor:bodyOptionProcessor(e),default:""}),t("content_security_policy",{processor:"string",default:""}),t("br_in_pre",{processor:"boolean",default:!0}),t("forced_root_block",{processor:e=>{let t=k(e)&&isNotEmpty(e);return t?{value:e,valid:t}:{valid:!1,message:"Must be a non-empty string."}},default:"p"}),t("forced_root_block_attrs",{processor:"object",default:{}}),t("newline_behavior",{processor:e=>{let t=contains$2(["block","linebreak","invert","default"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be one of: block, linebreak, invert or default."}},default:"default"}),t("br_newline_selector",{processor:"string",default:".mce-toc h2,figcaption,caption"}),t("no_newline_selector",{processor:"string",default:""}),t("keep_styles",{processor:"boolean",default:!0}),t("end_container_on_empty_block",{processor:e=>O(e)?{valid:!0,value:e}:k(e)?{valid:!0,value:e}:{valid:!1,message:"Must be boolean or a string"},default:"blockquote"}),t("font_size_style_values",{processor:"string",default:"xx-small,x-small,small,medium,large,x-large,xx-large"}),t("font_size_legacy_values",{processor:"string",default:"xx-small,small,medium,large,x-large,xx-large,300%"}),t("font_size_classes",{processor:"string",default:""}),t("automatic_uploads",{processor:"boolean",default:!0}),t("images_reuse_filename",{processor:"boolean",default:!1}),t("images_replace_blob_uris",{processor:"boolean",default:!0}),t("icons",{processor:"string",default:""}),t("icons_url",{processor:"string",default:""}),t("images_upload_url",{processor:"string",default:""}),t("images_upload_base_path",{processor:"string",default:""}),t("images_upload_credentials",{processor:"boolean",default:!1}),t("images_upload_handler",{processor:"function"}),t("language",{processor:"string",default:"en"}),t("language_url",{processor:"string",default:""}),t("entity_encoding",{processor:"string",default:"named"}),t("indent",{processor:"boolean",default:!0}),t("indent_before",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_after",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_use_margin",{processor:"boolean",default:!1}),t("indentation",{processor:"string",default:"40px"}),t("content_css",{processor:e=>{let t=!1===e||k(e)||isArrayOf(e,k);return t?k(e)?{value:map$3(e.split(","),U),valid:t}:S(e)?{value:e,valid:t}:!1===e?{value:[],valid:t}:{value:e,valid:t}:{valid:!1,message:"Must be false, a string or an array of strings."}},default:nI(e)?[]:["default"]}),t("content_style",{processor:"string"}),t("content_css_cors",{processor:"boolean",default:!1}),t("font_css",{processor:e=>{let t=k(e)||isArrayOf(e,k);if(!t)return{valid:!1,message:"Must be a string or an array of strings."};{let n=S(e)?e:map$3(e.split(","),U);return{value:n,valid:t}}},default:[]}),t("inline_boundaries",{processor:"boolean",default:!0}),t("inline_boundaries_selector",{processor:"string",default:"a[href],code,span.mce-annotation"}),t("object_resizing",{processor:e=>{let t=O(e)||k(e);return t?!1===e||tj.isiPhone()||tj.isiPad()?{value:"",valid:t}:{value:!0===e?"table,img,figure.image,div,video,iframe":e,valid:t}:{valid:!1,message:"Must be boolean or a string"}},default:!tK}),t("resize_img_proportional",{processor:"boolean",default:!0}),t("event_root",{processor:"object"}),t("service_message",{processor:"string"}),t("theme",{processor:e=>!1===e||k(e)||R(e),default:"silver"}),t("theme_url",{processor:"string"}),t("formats",{processor:"object"}),t("format_empty_lines",{processor:"boolean",default:!1}),t("format_noneditable_selector",{processor:"string",default:""}),t("preview_styles",{processor:e=>{let t=!1===e||k(e);return t?{value:!1===e?"":e,valid:t}:{valid:!1,message:"Must be false or a string"}},default:"font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"}),t("custom_ui_selector",{processor:"string",default:""}),t("hidden_input",{processor:"boolean",default:!0}),t("submit_patch",{processor:"boolean",default:!0}),t("encoding",{processor:"string"}),t("add_form_submit_trigger",{processor:"boolean",default:!0}),t("add_unload_trigger",{processor:"boolean",default:!0}),t("custom_undo_redo_levels",{processor:"number",default:0}),t("disable_nodechange",{processor:"boolean",default:!1}),t("readonly",{processor:"boolean",default:!1}),t("editable_root",{processor:"boolean",default:!0}),t("plugins",{processor:"string[]",default:[]}),t("external_plugins",{processor:"object"}),t("forced_plugins",{processor:"string[]"}),t("model",{processor:"string",default:e.hasPlugin("rtc")?"plugin":"dom"}),t("model_url",{processor:"string"}),t("block_unsupported_drop",{processor:"boolean",default:!0}),t("visual",{processor:"boolean",default:!0}),t("visual_table_class",{processor:"string",default:"mce-item-table"}),t("visual_anchor_class",{processor:"string",default:"mce-item-anchor"}),t("iframe_aria_text",{processor:"string",default:"Rich Text Area. Press ALT-0 for help."}),t("setup",{processor:"function"}),t("init_instance_callback",{processor:"function"}),t("url_converter",{processor:"function",default:e.convertURL}),t("url_converter_scope",{processor:"object",default:e}),t("urlconverter_callback",{processor:"function"}),t("allow_conditional_comments",{processor:"boolean",default:!1}),t("allow_html_data_urls",{processor:"boolean",default:!1}),t("allow_svg_data_urls",{processor:"boolean"}),t("allow_html_in_named_anchor",{processor:"boolean",default:!1}),t("allow_script_urls",{processor:"boolean",default:!1}),t("allow_unsafe_link_target",{processor:"boolean",default:!1}),t("convert_fonts_to_spans",{processor:"boolean",default:!0,deprecated:!0}),t("fix_list_elements",{processor:"boolean",default:!1}),t("preserve_cdata",{processor:"boolean",default:!1}),t("remove_trailing_brs",{processor:"boolean",default:!0}),t("pad_empty_with_br",{processor:"boolean",default:!1}),t("inline_styles",{processor:"boolean",default:!0,deprecated:!0}),t("element_format",{processor:"string",default:"html"}),t("entities",{processor:"string"}),t("schema",{processor:"string",default:"html5"}),t("convert_urls",{processor:"boolean",default:!0}),t("relative_urls",{processor:"boolean",default:!0}),t("remove_script_host",{processor:"boolean",default:!0}),t("custom_elements",{processor:"string"}),t("extended_valid_elements",{processor:"string"}),t("invalid_elements",{processor:"string"}),t("invalid_styles",{processor:stringOrObjectProcessor}),t("valid_children",{processor:"string"}),t("valid_classes",{processor:stringOrObjectProcessor}),t("valid_elements",{processor:"string"}),t("valid_styles",{processor:stringOrObjectProcessor}),t("verify_html",{processor:"boolean",default:!0}),t("auto_focus",{processor:e=>k(e)||!0===e}),t("browser_spellcheck",{processor:"boolean",default:!1}),t("protect",{processor:"array"}),t("images_file_types",{processor:"string",default:"jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp"}),t("deprecation_warnings",{processor:"boolean",default:!0}),t("a11y_advanced_options",{processor:"boolean",default:!1}),t("api_key",{processor:"string"}),t("paste_block_drop",{processor:"boolean",default:!1}),t("paste_data_images",{processor:"boolean",default:!0}),t("paste_preprocess",{processor:"function"}),t("paste_postprocess",{processor:"function"}),t("paste_webkit_styles",{processor:"string",default:"none"}),t("paste_remove_styles_if_webkit",{processor:"boolean",default:!0}),t("paste_merge_formats",{processor:"boolean",default:!0}),t("smart_paste",{processor:"boolean",default:!0}),t("paste_as_text",{processor:"boolean",default:!1}),t("paste_tab_spaces",{processor:"number",default:4}),t("text_patterns",{processor:e=>{if(!isArrayOf(e,$)&&!1!==e)return{valid:!1,message:"Must be an array of objects or false."};{let t=!1===e?[]:e;return{value:fromRawPatterns(t),valid:!0}}},default:[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}]}),t("text_patterns_lookup",{processor:e=>R(e)?{value:fromRawPatternsLookup(e),valid:!0}:{valid:!1,message:"Must be a single function"},default:e=>[]}),t("noneditable_class",{processor:"string",default:"mceNonEditable"}),t("editable_class",{processor:"string",default:"mceEditable"}),t("noneditable_regexp",{processor:e=>isArrayOf(e,isRegExp)?{value:e,valid:!0}:isRegExp(e)?{value:[e],valid:!0}:{valid:!1,message:"Must be a RegExp or an array of RegExp."},default:[]}),t("table_tab_navigation",{processor:"boolean",default:!0}),t("highlight_on_focus",{processor:"boolean",default:!1}),t("xss_sanitization",{processor:"boolean",default:!0}),t("details_initial_state",{processor:e=>{let t=contains$2(["inherited","collapsed","expanded"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),t("details_serialized_state",{processor:e=>{let t=contains$2(["inherited","collapsed","expanded"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),t("init_content_sync",{processor:"boolean",default:!1}),t("newdocument_content",{processor:"string",default:""}),e.on("ScriptsLoaded",()=>{t("directionality",{processor:"string",default:tP.isRtl()?"rtl":void 0}),t("placeholder",{processor:"string",default:tG.getAttrib(e.getElement(),"placeholder")})})},tY=option("iframe_attrs"),tX=option("doctype"),tZ=option("document_base_url"),tQ=option("body_id"),tJ=option("body_class"),t0=option("content_security_policy"),t1=option("br_in_pre"),t2=option("forced_root_block"),t3=option("forced_root_block_attrs"),t5=option("newline_behavior"),t4=option("br_newline_selector"),t8=option("no_newline_selector"),t6=option("keep_styles"),t9=option("end_container_on_empty_block"),t7=option("automatic_uploads"),ne=option("images_reuse_filename"),nt=option("images_replace_blob_uris"),nn=option("icons"),nr=option("icons_url"),no=option("images_upload_url"),na=option("images_upload_base_path"),ni=option("images_upload_credentials"),nl=option("images_upload_handler"),ns=option("content_css_cors"),nd=option("referrer_policy"),nc=option("language"),nm=option("language_url"),np=option("indent_use_margin"),ng=option("indentation"),nf=option("content_css"),nh=option("content_style"),nb=option("font_css"),nC=option("directionality"),ny=option("inline_boundaries_selector"),nv=option("object_resizing"),nE=option("resize_img_proportional"),nk=option("placeholder"),n$=option("event_root"),nS=option("service_message"),nN=option("theme"),nO=option("theme_url"),nP=option("model"),nR=option("model_url"),nx=option("inline_boundaries"),nw=option("formats"),nA=option("preview_styles"),nT=option("format_empty_lines"),nB=option("format_noneditable_selector"),nD=option("custom_ui_selector"),nI=option("inline"),nF=option("hidden_input"),n_=option("submit_patch"),nL=option("add_form_submit_trigger"),nM=option("add_unload_trigger"),nU=option("custom_undo_redo_levels"),nz=option("disable_nodechange"),nW=option("readonly"),nH=option("editable_root"),nV=option("content_css_cors"),nq=option("plugins"),nj=option("external_plugins"),nK=option("block_unsupported_drop"),nG=option("visual"),nY=option("visual_table_class"),nX=option("visual_anchor_class"),nZ=option("iframe_aria_text"),nQ=option("setup"),nJ=option("init_instance_callback"),n0=option("urlconverter_callback"),n1=option("auto_focus"),n2=option("browser_spellcheck"),n3=option("protect"),n5=option("paste_block_drop"),n4=option("paste_data_images"),n8=option("paste_preprocess"),n6=option("paste_postprocess"),n9=option("newdocument_content"),n7=option("paste_webkit_styles"),re=option("paste_remove_styles_if_webkit"),rt=option("paste_merge_formats"),rn=option("smart_paste"),rr=option("paste_as_text"),ro=option("paste_tab_spaces"),ra=option("allow_html_data_urls"),ri=option("text_patterns"),rl=option("text_patterns_lookup"),rs=option("noneditable_class"),rd=option("editable_class"),rc=option("noneditable_regexp"),rm=option("preserve_cdata"),ru=option("highlight_on_focus"),rp=option("xss_sanitization"),rg=option("init_content_sync"),hasTextPatternsLookup=e=>e.options.isSet("text_patterns_lookup"),getFontStyleValues=e=>eb.explode(e.options.get("font_size_style_values")),getFontSizeClasses=e=>eb.explode(e.options.get("font_size_classes")),isEncodingXml=e=>"xml"===e.options.get("encoding"),getAllowedImageFileTypes=e=>eb.explode(e.options.get("images_file_types")),rf=option("table_tab_navigation"),rh=option("details_initial_state"),rb=option("details_serialized_state"),removeNode$1=e=>{let t=e.parentNode;t&&t.removeChild(e)},trimCount=e=>{let t=trim$2(e);return{count:e.length-t.length,text:t}},deleteZwspChars=e=>{let t;for(;-1!==(t=e.data.lastIndexOf("\uFEFF"));)e.deleteData(t,1)},removeUnchanged=(e,t)=>(remove$3(e),t),removeTextAndReposition=(e,t)=>{let n=trimCount(e.data.substr(0,t.offset())),o=trimCount(e.data.substr(t.offset())),a=n.text+o.text;return a.length>0?(deleteZwspChars(e),CaretPosition(e,t.offset()-n.count)):t},removeElementAndReposition=(e,t)=>{let n=t.container(),o=indexOf$1(I(n.childNodes),e).map(e=>e<t.offset()?CaretPosition(n,t.offset()-1):t).getOr(t);return remove$3(e),o},removeTextCaretContainer=(e,t)=>ew(e)&&t.container()===e?removeTextAndReposition(e,t):removeUnchanged(e,t),removeElementCaretContainer=(e,t)=>t.container()===e.parentNode?removeElementAndReposition(e,t):removeUnchanged(e,t),removeAndReposition=(e,t)=>CaretPosition.isTextPosition(t)?removeTextCaretContainer(e,t):removeElementCaretContainer(e,t),remove$3=e=>{eR(e)&&isCaretContainer$2(e)&&(hasContent(e)?e.removeAttribute("data-mce-caret"):removeNode$1(e)),ew(e)&&(deleteZwspChars(e),0===e.data.length&&removeNode$1(e))},getAbsoluteClientRect=(e,t,n)=>{let o,a;let i=collapse(t.getBoundingClientRect(),n);if("BODY"===e.tagName){let t=e.ownerDocument.documentElement;o=e.scrollLeft||t.scrollLeft,a=e.scrollTop||t.scrollTop}else{let t=e.getBoundingClientRect();o=e.scrollLeft-t.left,a=e.scrollTop-t.top}i.left+=o,i.right+=o,i.top+=a,i.bottom+=a,i.width=1;let l=t.offsetWidth-t.clientWidth;return l>0&&(n&&(l*=-1),i.left+=l,i.right+=l),i},trimInlineCaretContainers=e=>{var t,n;let o=descendants(eS.fromDom(e),"*[contentEditable=false],video,audio,embed,object");for(let e=0;e<o.length;e++){let a=o[e].dom,i=a.previousSibling;if(endsWithCaretContainer$1(i)){let e=i.data;1===e.length?null===(t=i.parentNode)||void 0===t||t.removeChild(i):i.deleteData(e.length-1,1)}if(startsWithCaretContainer$1(i=a.nextSibling)){let e=i.data;1===e.length?null===(n=i.parentNode)||void 0===n||n.removeChild(i):i.deleteData(0,1)}}},FakeCaret=(e,t,n,o)=>{let a,i;let l=value$2(),s=t2(e),d=e.dom,hide=()=>{trimInlineCaretContainers(t),i&&(remove$3(i),i=null),l.on(e=>{d.remove(e.caret),l.clear()}),a&&(clearInterval(a),a=void 0)},startBlink=()=>{a=setInterval(()=>{l.on(e=>{o()?d.toggleClass(e.caret,"mce-visual-caret-hidden"):d.addClass(e.caret,"mce-visual-caret-hidden")})},500)};return{show:(e,o)=>{let a;if(hide(),eU(o))return null;if(n(o)){let n=insertBlock(s,o,e),c=getAbsoluteClientRect(t,o,e);d.setStyle(n,"top",c.top),i=n;let m=d.create("div",{class:"mce-visual-caret","data-mce-bogus":"all"});d.setStyles(m,{...c}),d.add(t,m),l.set({caret:m,element:o,before:e}),e&&d.addClass(m,"mce-visual-caret-before"),startBlink(),(a=o.ownerDocument.createRange()).setStart(n,0),a.setEnd(n,0)}else i=insertInline$1(o,e),a=o.ownerDocument.createRange(),isInlineFakeCaretTarget(i.nextSibling)?(a.setStart(i,0),a.setEnd(i,0)):(a.setStart(i,1),a.setEnd(i,1));return a},hide,getCss:()=>".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}",reposition:()=>{l.on(e=>{let n=getAbsoluteClientRect(t,e.element,e.before);d.setStyles(e.caret,{...n})})},destroy:()=>clearInterval(a)}},isFakeCaretTableBrowser=()=>ef.browser.isFirefox(),isInlineFakeCaretTarget=e=>eM(e)||eW(e),isFakeCaretTarget=e=>{let t=isInlineFakeCaretTarget(e)||isTable$2(e)&&isFakeCaretTableBrowser();return t&&parentElement(eS.fromDom(e)).exists(isEditable$3)},rC=matchStyleValues("display","block table table-cell table-caption list-item"),isForwards=e=>e>0,isBackwards=e=>e<0,skipCaretContainers=(e,t)=>{let n;for(;n=e(t);)if(!isCaretContainerBlock$1(n))return n;return null},findNode=(e,t,n,o,a)=>{let i;let l=new DomTreeWalker(e,o),s=eM(e)||isCaretContainerBlock$1(e);if(isBackwards(t)){if(s&&n(i=skipCaretContainers(l.prev.bind(l),!0)))return i;for(;i=skipCaretContainers(l.prev.bind(l),a);)if(n(i))return i}if(isForwards(t)){if(s&&n(i=skipCaretContainers(l.next.bind(l),!0)))return i;for(;i=skipCaretContainers(l.next.bind(l),a);)if(n(i))return i}return null},getEditingHost=(e,t)=>ancestor$4(eS.fromDom(e),e=>eL(e.dom),e=>e.dom===t).map(e=>e.dom).getOr(t),getParentBlock$3=(e,t)=>{for(;e&&e!==t;){if(rC(e))return e;e=e.parentNode}return null},isInSameBlock=(e,t,n)=>getParentBlock$3(e.container(),n)===getParentBlock$3(t.container(),n),getChildNodeAtRelativeOffset=(e,t)=>{if(!t)return Optional.none();let n=t.container(),o=t.offset();return eR(n)?Optional.from(n.childNodes[o+e]):Optional.none()},beforeAfter=(e,t)=>{var n;let o=null!==(n=t.ownerDocument)&&void 0!==n?n:document,a=o.createRange();return e?(a.setStartBefore(t),a.setEndBefore(t)):(a.setStartAfter(t),a.setEndAfter(t)),a},isNodesInSameBlock=(e,t,n)=>getParentBlock$3(t,e)===getParentBlock$3(n,e),lean=(e,t,n)=>{let o=e?"previousSibling":"nextSibling",a=n;for(;a&&a!==t;){let e=a[o];if(e&&isCaretContainer$2(e)&&(e=e[o]),eM(e)||eW(e)){if(isNodesInSameBlock(t,e,a))return e;break}if(isCaretCandidate$3(e))break;a=a.parentNode}return null},ry=curry(beforeAfter,!0),rv=curry(beforeAfter,!1),normalizeRange=(e,t,n)=>{let o;let a=curry(lean,!0,t),i=curry(lean,!1,t),l=n.startContainer,s=n.startOffset;if(isCaretContainerBlock$1(l)){let e=ew(l)?l.parentNode:l,t=e.getAttribute("data-mce-caret");if("before"===t&&isFakeCaretTarget(o=e.nextSibling))return ry(o);if("after"===t&&isFakeCaretTarget(o=e.previousSibling))return rv(o)}if(!n.collapsed)return n;if(ew(l)){if(isCaretContainer$2(l)){if(1===e){if(o=i(l))return ry(o);if(o=a(l))return rv(o)}if(-1===e){if(o=a(l))return rv(o);if(o=i(l))return ry(o)}return n}if(endsWithCaretContainer$1(l)&&s>=l.data.length-1)return 1===e&&(o=i(l))?ry(o):n;if(startsWithCaretContainer$1(l)&&s<=1)return -1===e&&(o=a(l))?rv(o):n;if(s===l.data.length)return(o=i(l))?ry(o):n;if(0===s&&(o=a(l)))return rv(o)}return n},getRelativeCefElm=(e,t)=>getChildNodeAtRelativeOffset(e?0:-1,t).filter(eM),getNormalizedRangeEndPoint=(e,t,n)=>{let o=normalizeRange(e,t,n);return -1===e?CaretPosition.fromRangeStart(o):CaretPosition.fromRangeEnd(o)},getElementFromPosition=e=>Optional.from(e.getNode()).map(eS.fromDom),getElementFromPrevPosition=e=>Optional.from(e.getNode(!0)).map(eS.fromDom),getVisualCaretPosition=(e,t)=>{let n=t;for(;(n=e(n))&&!n.isVisible(););return n},isMoveInsideSameBlock=(e,t)=>{let n=isInSameBlock(e,t);return!!(!n&&eF(e.getNode()))||n};(s=g||(g={}))[s.Backwards=-1]="Backwards",s[s.Forwards=1]="Forwards";let isAtomic=e=>e5(e)||isAtomicContentEditableFalse(e),getParents$3=(e,t)=>{let n=[],o=e;for(;o&&o!==t;)n.push(o),o=o.parentNode;return n},nodeAtIndex=(e,t)=>e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null,getCaretCandidatePosition=(e,t)=>{if(isForwards(e)){if(isCaretCandidate$3(t.previousSibling)&&!ew(t.previousSibling))return CaretPosition.before(t);if(ew(t))return CaretPosition(t,0)}if(isBackwards(e)){if(isCaretCandidate$3(t.nextSibling)&&!ew(t.nextSibling))return CaretPosition.after(t);if(ew(t))return CaretPosition(t,t.data.length)}return isBackwards(e)?eF(t)?CaretPosition.before(t):CaretPosition.after(t):CaretPosition.before(t)},moveForwardFromBr=(e,t)=>{let n=t.nextSibling;return n&&isCaretCandidate$3(n)?ew(n)?CaretPosition(n,0):CaretPosition.before(n):findCaretPosition$1(g.Forwards,CaretPosition.after(t),e)},findCaretPosition$1=(e,t,n)=>{let o,a,i,l;if(!eR(n)||!t)return null;if(t.isEqual(CaretPosition.after(n))&&n.lastChild){if(l=CaretPosition.after(n.lastChild),isBackwards(e)&&isCaretCandidate$3(n.lastChild)&&eR(n.lastChild))return eF(n.lastChild)?CaretPosition.before(n.lastChild):l}else l=t;let s=l.container(),d=l.offset();if(ew(s)){if(isBackwards(e)&&d>0)return CaretPosition(s,--d);if(isForwards(e)&&d<s.length)return CaretPosition(s,++d);o=s}else{if(isBackwards(e)&&d>0&&isCaretCandidate$3(a=nodeAtIndex(s,d-1)))return!isAtomic(a)&&(i=findNode(a,e,isEditableCaretCandidate$1,a))?ew(i)?CaretPosition(i,i.data.length):CaretPosition.after(i):ew(a)?CaretPosition(a,a.data.length):CaretPosition.before(a);if(isForwards(e)&&d<s.childNodes.length&&isCaretCandidate$3(a=nodeAtIndex(s,d)))return eF(a)?moveForwardFromBr(n,a):!isAtomic(a)&&(i=findNode(a,e,isEditableCaretCandidate$1,a))?ew(i)?CaretPosition(i,0):CaretPosition.before(i):ew(a)?CaretPosition(a,0):CaretPosition.after(a);o=a||l.getNode()}if(o&&(isForwards(e)&&l.isAtEnd()||isBackwards(e)&&l.isAtStart())&&isEditableCaretCandidate$1(o=findNode(o,e,A,n,!0),n))return getCaretCandidatePosition(e,o);a=o?findNode(o,e,isEditableCaretCandidate$1,n):o;let c=last$2(filter$5(getParents$3(s,n),eM));return!c||a&&c.contains(a)?a?getCaretCandidatePosition(e,a):null:l=isForwards(e)?CaretPosition.after(c):CaretPosition.before(c)},CaretWalker=e=>({next:t=>findCaretPosition$1(g.Forwards,t,e),prev:t=>findCaretPosition$1(g.Backwards,t,e)}),walkToPositionIn=(e,t,n)=>{let o=e?CaretPosition.before(n):CaretPosition.after(n);return fromPosition(e,t,o)},afterElement=e=>eF(e)?CaretPosition.before(e):CaretPosition.after(e),isBeforeOrStart=e=>CaretPosition.isTextPosition(e)?0===e.offset():isCaretCandidate$3(e.getNode()),isAfterOrEnd=e=>{if(!CaretPosition.isTextPosition(e))return isCaretCandidate$3(e.getNode(!0));{let t=e.container();return e.offset()===t.data.length}},isBeforeAfterSameElement=(e,t)=>!CaretPosition.isTextPosition(e)&&!CaretPosition.isTextPosition(t)&&e.getNode()===t.getNode(!0),isAtBr=e=>!CaretPosition.isTextPosition(e)&&eF(e.getNode()),shouldSkipPosition=(e,t,n)=>e?!isBeforeAfterSameElement(t,n)&&!isAtBr(t)&&isAfterOrEnd(t)&&isBeforeOrStart(n):!isBeforeAfterSameElement(n,t)&&isBeforeOrStart(t)&&isAfterOrEnd(n),fromPosition=(e,t,n)=>{let o=CaretWalker(t);return Optional.from(e?o.next(n):o.prev(n))},navigate=(e,t,n)=>fromPosition(e,t,n).bind(o=>isInSameBlock(n,o,t)&&shouldSkipPosition(e,n,o)?fromPosition(e,t,o):Optional.some(o)),navigateIgnore=(e,t,n,o)=>navigate(e,t,n).bind(n=>o(n)?navigateIgnore(e,t,n,o):Optional.some(n)),positionIn=(e,t)=>{let n=e?t.firstChild:t.lastChild;return ew(n)?Optional.some(CaretPosition(n,e?0:n.data.length)):n?isCaretCandidate$3(n)?Optional.some(e?CaretPosition.before(n):afterElement(n)):walkToPositionIn(e,t,n):Optional.none()},rE=curry(fromPosition,!0),rk=curry(fromPosition,!1),r$=curry(positionIn,!0),rS=curry(positionIn,!1),rN="_mce_caret",isCaretNode=e=>eR(e)&&e.id===rN,getParentCaretContainer=(e,t)=>{let n=t;for(;n&&n!==e;){if(isCaretNode(n))return n;n=n.parentNode}return null},isStringPathBookmark=e=>k(e.start),isRangeBookmark=e=>has$2(e,"rng"),isIdBookmark=e=>has$2(e,"id"),isIndexBookmark=e=>has$2(e,"name"),isPathBookmark=e=>eb.isArray(e.start),isForwardBookmark=e=>!(!isIndexBookmark(e)&&O(e.forward))||e.forward,addBogus=(e,t)=>(eR(t)&&e.isBlock(t)&&!t.innerHTML&&(t.innerHTML='<br data-mce-bogus="1" />'),t),resolveCaretPositionBookmark=(e,t)=>{let n=Optional.from(resolve$1(e.getRoot(),t.start)),o=Optional.from(resolve$1(e.getRoot(),t.end));return lift2(n,o,(n,o)=>{let a=e.createRng();return a.setStart(n.container(),n.offset()),a.setEnd(o.container(),o.offset()),{range:a,forward:isForwardBookmark(t)}})},insertZwsp=(e,t)=>{var n;let o=null!==(n=e.ownerDocument)&&void 0!==n?n:document,a=o.createTextNode("\uFEFF");e.appendChild(a),t.setStart(a,0),t.setEnd(a,0)},isEmpty$1=e=>!e.hasChildNodes(),tryFindRangePosition=(e,t)=>rS(e).fold(w,e=>(t.setStart(e.container(),e.offset()),t.setEnd(e.container(),e.offset()),!0)),padEmptyCaretContainer=(e,t,n)=>!!(isEmpty$1(t)&&getParentCaretContainer(e,t))&&(insertZwsp(t,n),!0),setEndPoint=(e,t,n,o)=>{let a=n[t?"start":"end"],i=e.getRoot();if(a){let e=i,n=a[0];for(let t=a.length-1;e&&t>=1;t--){let n=e.childNodes;if(padEmptyCaretContainer(i,e,o))return!0;if(a[t]>n.length-1){if(padEmptyCaretContainer(i,e,o))return!0;return tryFindRangePosition(e,o)}e=n[a[t]]}ew(e)&&(n=Math.min(a[0],e.data.length)),eR(e)&&(n=Math.min(a[0],e.childNodes.length)),t?o.setStart(e,n):o.setEnd(e,n)}return!0},isValidTextNode=e=>ew(e)&&e.data.length>0,restoreEndPoint=(e,t,n)=>{let o=e.get(n.id+"_"+t),a=null==o?void 0:o.parentNode,i=n.keep;if(!o||!a)return Optional.none();{let l,s;if("start"===t?i?o.hasChildNodes()?(l=o.firstChild,s=1):isValidTextNode(o.nextSibling)?(l=o.nextSibling,s=0):isValidTextNode(o.previousSibling)?(l=o.previousSibling,s=o.previousSibling.data.length):(l=a,s=e.nodeIndex(o)+1):(l=a,s=e.nodeIndex(o)):i?o.hasChildNodes()?(l=o.firstChild,s=1):isValidTextNode(o.previousSibling)?(l=o.previousSibling,s=o.previousSibling.data.length):(l=a,s=e.nodeIndex(o)):(l=a,s=e.nodeIndex(o)),!i){let a;let i=o.previousSibling,d=o.nextSibling;for(eb.each(eb.grep(o.childNodes),e=>{ew(e)&&(e.data=e.data.replace(/\uFEFF/g,""))});a=e.get(n.id+"_"+t);)e.remove(a,!0);if(ew(d)&&ew(i)&&!ef.browser.isOpera()){let t=i.data.length;i.appendData(d.data),e.remove(d),l=i,s=t}}return Optional.some(CaretPosition(l,s))}},resolvePaths=(e,t)=>{let n=e.createRng();return setEndPoint(e,!0,t,n)&&setEndPoint(e,!1,t,n)?Optional.some({range:n,forward:isForwardBookmark(t)}):Optional.none()},resolveId=(e,t)=>{let n=restoreEndPoint(e,"start",t),o=restoreEndPoint(e,"end",t);return lift2(n,o.or(n),(n,o)=>{let a=e.createRng();return a.setStart(addBogus(e,n.container()),n.offset()),a.setEnd(addBogus(e,o.container()),o.offset()),{range:a,forward:isForwardBookmark(t)}})},resolveIndex=(e,t)=>Optional.from(e.select(t.name)[t.index]).map(t=>{let n=e.createRng();return n.selectNode(t),{range:n,forward:!0}}),resolve=(e,t)=>{let n=e.dom;if(t){if(isPathBookmark(t))return resolvePaths(n,t);if(isStringPathBookmark(t))return resolveCaretPositionBookmark(n,t);if(isIdBookmark(t))return resolveId(n,t);if(isIndexBookmark(t))return resolveIndex(n,t);else if(isRangeBookmark(t))return Optional.some({range:t.rng,forward:isForwardBookmark(t)})}return Optional.none()},getBookmark$1=(e,t,n)=>getBookmark$2(e,t,n),moveToBookmark=(e,t)=>{resolve(e,t).each(({range:t,forward:n})=>{e.setRng(t,n)})},isBookmarkNode$1=e=>eR(e)&&"SPAN"===e.tagName&&"bookmark"===e.getAttribute("data-mce-type"),isNbsp=e=>"\xa0"===e,isWhiteSpace=e=>""!==e&&-1!==" \f\n\r	\v".indexOf(e),isContent=e=>!isWhiteSpace(e)&&!isNbsp(e)&&!isZwsp$2(e),hexColour=e=>({value:normalizeHex(e)}),normalizeHex=e=>removeLeading(e,"#").toUpperCase(),toHex=e=>{let t=e.toString(16);return(1===t.length?"0"+t:t).toUpperCase()},fromRgba=e=>{let t=toHex(e.red)+toHex(e.green)+toHex(e.blue);return hexColour(t)},rO=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,rP=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,rgbaColour=(e,t,n,o)=>({red:e,green:t,blue:n,alpha:o}),fromStringValues=(e,t,n,o)=>{let a=parseInt(e,10),i=parseInt(t,10),l=parseInt(n,10),s=parseFloat(o);return rgbaColour(a,i,l,s)},fromString=e=>{if("transparent"===e)return Optional.some(rgbaColour(0,0,0,0));let t=rO.exec(e);if(null!==t)return Optional.some(fromStringValues(t[1],t[2],t[3],"1"));let n=rP.exec(e);return null!==n?Optional.some(fromStringValues(n[1],n[2],n[3],n[4])):Optional.none()},rgbaToHexString=e=>fromString(e).map(fromRgba).map(e=>"#"+e.value).getOr(e),getRanges$1=e=>{let t=[];if(e)for(let n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t},getSelectedNodes=e=>bind$3(e,e=>{let t=getSelectedNode(e);return t?[eS.fromDom(t)]:[]}),hasMultipleRanges=e=>getRanges$1(e).length>1,getCellsFromRanges=e=>filter$5(getSelectedNodes(e),e0),getCellsFromElement=e=>descendants(e,"td[data-mce-selected],th[data-mce-selected]"),getCellsFromElementOrRanges=(e,t)=>{let n=getCellsFromElement(t);return n.length>0?n:getCellsFromRanges(e)},getCellsFromEditor=e=>getCellsFromElementOrRanges(getRanges$1(e.selection.getSel()),eS.fromDom(e.getBody())),getClosestTable=(e,t)=>ancestor$3(e,"table",t),getStartNode=e=>{let t=e.startContainer,n=e.startOffset;return ew(t)?0===n?Optional.some(eS.fromDom(t)):Optional.none():Optional.from(t.childNodes[n]).map(eS.fromDom)},getEndNode=e=>{let t=e.endContainer,n=e.endOffset;return ew(t)?n===t.data.length?Optional.some(eS.fromDom(t)):Optional.none():Optional.from(t.childNodes[n-1]).map(eS.fromDom)},getFirstChildren=e=>firstChild(e).fold(constant([e]),t=>[e].concat(getFirstChildren(t))),getLastChildren=e=>lastChild(e).fold(constant([e]),t=>"br"===name(t)?prevSibling(t).map(t=>[e].concat(getLastChildren(t))).getOr([]):[e].concat(getLastChildren(t))),hasAllContentsSelected=(e,t)=>lift2(getStartNode(t),getEndNode(t),(t,n)=>{let o=find$2(getFirstChildren(e),curry(eq,t)),a=find$2(getLastChildren(e),curry(eq,n));return o.isSome()&&a.isSome()}).getOr(!1),moveEndPoint=(e,t,n,o)=>{let a=new DomTreeWalker(n,n),i=filter$4(e.schema.getMoveCaretBeforeOnEnterElements(),(e,t)=>!contains$2(["td","th","table"],t.toLowerCase())),l=n;do{if(ew(l)&&0!==eb.trim(l.data).length){o?t.setStart(l,0):t.setEnd(l,l.data.length);return}if(i[l.nodeName]){o?t.setStartBefore(l):"BR"===l.nodeName?t.setEndBefore(l):t.setEndAfter(l);return}}while(l=o?a.next():a.prev());"BODY"===n.nodeName&&(o?t.setStart(n,0):t.setEnd(n,n.childNodes.length))},hasAnyRanges=e=>{let t=e.selection.getSel();return isNonNullable(t)&&t.rangeCount>0},runOnRanges=(e,t)=>{let n=getCellsFromEditor(e);n.length>0?each$e(n,n=>{let o=n.dom,a=e.dom.createRng();a.setStartBefore(o),a.setEndAfter(o),t(a,!0)}):t(e.selection.getRng(),!1)},preserve=(e,t,n)=>{let o=getPersistentBookmark(e,t);n(o),e.moveToBookmark(o)},isNode=e=>x(null==e?void 0:e.nodeType),isElementNode$1=e=>eR(e)&&!isBookmarkNode$1(e)&&!isCaretNode(e)&&!isBogus$2(e),isElementDirectlySelected=(e,t)=>{if(!isElementNode$1(t)||/^(TD|TH)$/.test(t.nodeName))return!1;{let n=e.getAttrib(t,"data-mce-selected"),o=parseInt(n,10);return!isNaN(o)&&o>0}},isEditable$2=e=>!0===e.isContentEditable,preserveSelection=(e,t,n)=>{let{selection:o,dom:a}=e,i=o.getNode(),l=eM(i);preserve(o,!0,()=>{t()});let s=l&&eM(i);s&&a.isChildOf(i,e.getBody())?e.selection.select(i):n(o.getStart())&&moveStartToNearestText(a,o)},moveStartToNearestText=(e,t)=>{var n,o;let a=t.getRng(),{startContainer:i,startOffset:l}=a,s=t.getNode();if(!isElementDirectlySelected(e,s)&&eR(i)){let s;let d=i.childNodes,c=e.getRoot();if(l<d.length){let t=d[l];s=new DomTreeWalker(t,null!==(n=e.getParent(t,e.isBlock))&&void 0!==n?n:c)}else{let t=d[d.length-1];(s=new DomTreeWalker(t,null!==(o=e.getParent(t,e.isBlock))&&void 0!==o?o:c)).next(!0)}for(let n=s.current();n;n=s.next()){if("false"===e.getContentEditable(n))return;if(ew(n)&&!isWhiteSpaceNode$1(n)){a.setStart(n,0),t.setRng(a);return}}}},getNonWhiteSpaceSibling=(e,t,n)=>{if(e){let o=t?"nextSibling":"previousSibling";for(e=n?e:e[o];e;e=e[o])if(eR(e)||!isWhiteSpaceNode$1(e))return e}},isTextBlock$1=(e,t)=>!!e.getTextBlockElements()[t.nodeName.toLowerCase()]||isTransparentBlock(e,t),isValid=(e,t,n)=>e.schema.isValidChild(t,n),isWhiteSpaceNode$1=(e,t=!1)=>{if(!(isNonNullable(e)&&ew(e)))return!1;{let n=t?e.data.replace(/ /g,"\xa0"):e.data;return isWhitespaceText(n)}},isEmptyTextNode$1=e=>isNonNullable(e)&&ew(e)&&0===e.length,isWrapNoneditableTarget=(e,t)=>{let n="[data-mce-cef-wrappable]",o=nB(e),a=isEmpty$3(o)?n:`${n},${o}`;return is$1(eS.fromDom(t),a)},isWrappableNoneditable=(e,t)=>{let n=e.dom;return isElementNode$1(t)&&"false"===n.getContentEditable(t)&&isWrapNoneditableTarget(e,t)&&0===n.select('[contenteditable="true"]',t).length},replaceVars=(e,t)=>R(e)?e(t):(isNonNullable(t)&&(e=e.replace(/%(\w+)/g,(e,n)=>t[n]||e)),e),isEq$5=(e,t)=>(t=t||"",e=""+((e=e||"").nodeName||e),t=""+(t.nodeName||t),e.toLowerCase()===t.toLowerCase()),normalizeStyleValue=(e,t)=>{if(isNullable(e))return null;{let n=String(e);return("color"===t||"backgroundColor"===t)&&(n=rgbaToHexString(n)),"fontWeight"===t&&700===e&&(n="bold"),"fontFamily"===t&&(n=n.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),n}},getStyle=(e,t,n)=>{let o=e.getStyle(t,n);return normalizeStyleValue(o,n)},getTextDecoration=(e,t)=>{let n;return e.getParent(t,t=>!!eR(t)&&!!(n=e.getStyle(t,"text-decoration"))&&"none"!==n),n},getParents$2=(e,t,n)=>e.getParents(t,n,e.getRoot()),isFormatPredicate=(e,t,n)=>{let o=e.formatter.get(t);return isNonNullable(o)&&exists(o,n)},isVariableFormatName=(e,t)=>isFormatPredicate(e,t,e=>{let isVariableValue=e=>R(e)||e.length>1&&"%"===e.charAt(0);return exists(["styles","attributes"],t=>get$a(e,t).exists(e=>{let t=S(e)?e:values(e);return exists(t,isVariableValue)}))}),areSimilarFormats=(e,t,n)=>{let o=["inline","block","selector","attributes","styles","classes"],filterObj=e=>filter$4(e,(e,t)=>exists(o,e=>e===t));return isFormatPredicate(e,t,t=>{let o=filterObj(t);return isFormatPredicate(e,n,e=>{let t=filterObj(e);return equal$1(o,t)})})},isBlockFormat=e=>hasNonNullableKey(e,"block"),isWrappingBlockFormat=e=>isBlockFormat(e)&&!0===e.wrapper,isNonWrappingBlockFormat=e=>isBlockFormat(e)&&!0!==e.wrapper,isSelectorFormat=e=>hasNonNullableKey(e,"selector"),isInlineFormat=e=>hasNonNullableKey(e,"inline"),isMixedFormat=e=>isSelectorFormat(e)&&isInlineFormat(e)&&is$2(get$a(e,"mixed"),!0),shouldExpandToSelector=e=>isSelectorFormat(e)&&!1!==e.expand&&!isInlineFormat(e),isBogusBr=e=>eF(e)&&e.getAttribute("data-mce-bogus")&&!e.nextSibling,findParentContentEditable=(e,t)=>{let n=t;for(;n;){if(eR(n)&&e.getContentEditable(n))return"false"===e.getContentEditable(n)?n:t;n=n.parentNode}return t},walkText=(e,t,n,o)=>{let a=t.data;if(e){for(let e=n;e>0;e--)if(o(a.charAt(e-1)))return e}else for(let e=n;e<a.length;e++)if(o(a.charAt(e)))return e;return -1},findSpace=(e,t,n)=>walkText(e,t,n,e=>isNbsp(e)||isWhiteSpace(e)),findContent=(e,t,n)=>walkText(e,t,n,isContent),findWordEndPoint=(e,t,n,o,a,i)=>{let l;let s=e.getParent(n,e.isBlock)||t,walk=(t,n,o)=>{let i=TextSeeker(e),d=a?i.backwards:i.forwards;return Optional.from(d(t,n,(e,t)=>isBookmarkNode$1(e.parentNode)?-1:(l=e,o(a,e,t)),s))},d=walk(n,o,findSpace);return d.bind(e=>i?walk(e.container,e.offset+(a?-1:0),findContent):Optional.some(e)).orThunk(()=>l?Optional.some({container:l,offset:a?0:l.length}):Optional.none())},findSelectorEndPoint=(e,t,n,o,a)=>{let i=o[a];ew(o)&&isEmpty$3(o.data)&&i&&(o=i);let l=getParents$2(e,o);for(let o=0;o<l.length;o++)for(let a=0;a<t.length;a++){let i=t[a];if((!isNonNullable(i.collapsed)||i.collapsed===n.collapsed)&&isSelectorFormat(i)&&e.is(l[o],i.selector))return l[o]}return o},findBlockEndPoint=(e,t,n,o)=>{var a;let i=n,l=e.getRoot(),s=t[0];if(isBlockFormat(s)&&(i=s.wrapper?null:e.getParent(n,s.block,l)),!i){let t=null!==(a=e.getParent(n,"LI,TD,TH"))&&void 0!==a?a:l;i=e.getParent(ew(n)?n.parentNode:n,t=>t!==l&&isTextBlock$1(e.schema,t),t)}if(i&&isBlockFormat(s)&&s.wrapper&&(i=getParents$2(e,i,"ul,ol").reverse()[0]||i),!i)for(i=n;i&&i[o]&&!e.isBlock(i[o])&&!isEq$5(i=i[o],"br"););return i||n},isAtBlockBoundary$1=(e,t,n,o)=>{let a=n.parentNode;return!isNonNullable(n[o])&&(!!(a===t||isNullable(a)||e.isBlock(a))||isAtBlockBoundary$1(e,t,a,o))},findParentContainer=(e,t,n,o,a)=>{let i=n,l=a?"previousSibling":"nextSibling",s=e.getRoot();if(ew(n)&&!isWhiteSpaceNode$1(n)&&(a?o>0:o<n.data.length))return n;for(;i;){if(!t[0].block_expand&&e.isBlock(i))return i;for(let t=i[l];t;t=t[l]){let n=ew(t)&&!isAtBlockBoundary$1(e,s,t,l);if(!isBookmarkNode$1(t)&&!isBogusBr(t)&&!isWhiteSpaceNode$1(t,n))return i}if(i===s||i.parentNode===s){n=i;break}i=i.parentNode}return n},isSelfOrParentBookmark=e=>isBookmarkNode$1(e.parentNode)||isBookmarkNode$1(e),expandRng=(e,t,n,o=!1)=>{let{startContainer:a,startOffset:i,endContainer:l,endOffset:s}=t,d=n[0];if(eR(a)&&a.hasChildNodes()&&ew(a=getNode$1(a,i))&&(i=0),eR(l)&&l.hasChildNodes()&&ew(l=getNode$1(l,t.collapsed?s:s-1))&&(s=l.data.length),a=findParentContentEditable(e,a),l=findParentContentEditable(e,l),isSelfOrParentBookmark(a)&&(a=isBookmarkNode$1(a)?a:a.parentNode,ew(a=t.collapsed?a.previousSibling||a:a.nextSibling||a)&&(i=t.collapsed?a.length:0)),isSelfOrParentBookmark(l)&&(l=isBookmarkNode$1(l)?l:l.parentNode,ew(l=t.collapsed?l.nextSibling||l:l.previousSibling||l)&&(s=t.collapsed?0:l.length)),t.collapsed){let t=findWordEndPoint(e,e.getRoot(),a,i,!0,o);t.each(({container:e,offset:t})=>{a=e,i=t});let n=findWordEndPoint(e,e.getRoot(),l,s,!1,o);n.each(({container:e,offset:t})=>{l=e,s=t})}return(isInlineFormat(d)||d.block_expand)&&(isInlineFormat(d)&&ew(a)&&0!==i||(a=findParentContainer(e,n,a,i,!0)),isInlineFormat(d)&&ew(l)&&s!==l.data.length||(l=findParentContainer(e,n,l,s,!1))),shouldExpandToSelector(d)&&(a=findSelectorEndPoint(e,n,t,a,"previousSibling"),l=findSelectorEndPoint(e,n,t,l,"nextSibling")),(isBlockFormat(d)||isSelectorFormat(d))&&(a=findBlockEndPoint(e,n,a,"previousSibling"),l=findBlockEndPoint(e,n,l,"nextSibling"),isBlockFormat(d)&&(e.isBlock(a)||(a=findParentContainer(e,n,a,i,!0)),e.isBlock(l)||(l=findParentContainer(e,n,l,s,!1)))),eR(a)&&a.parentNode&&(i=e.nodeIndex(a),a=a.parentNode),eR(l)&&l.parentNode&&(s=e.nodeIndex(l)+1,l=l.parentNode),{startContainer:a,startOffset:i,endContainer:l,endOffset:s}},walk$3=(e,t,n)=>{var o;let a=t.startOffset,i=getNode$1(t.startContainer,a),l=t.endOffset,s=getNode$1(t.endContainer,l-1),exclude=e=>{let t=e[0];ew(t)&&t===i&&a>=t.data.length&&e.splice(0,1);let n=e[e.length-1];return 0===l&&e.length>0&&n===s&&ew(n)&&e.splice(e.length-1,1),e},collectSiblings=(e,t,n)=>{let o=[];for(;e&&e!==n;e=e[t])o.push(e);return o},findEndPoint=(t,n)=>e.getParent(t,e=>e.parentNode===n,n),walkBoundary=(e,t,o)=>{let a=o?"nextSibling":"previousSibling";for(let i=e,l=i.parentNode;i&&i!==t;i=l){l=i.parentNode;let t=collectSiblings(i===e?i:i[a],a);t.length&&(o||t.reverse(),n(exclude(t)))}};if(i===s)return n(exclude([i]));let d=null!==(o=e.findCommonAncestor(i,s))&&void 0!==o?o:e.getRoot();if(e.isChildOf(i,s))return walkBoundary(i,d,!0);if(e.isChildOf(s,i))return walkBoundary(s,d);let c=findEndPoint(i,d)||i,m=findEndPoint(s,d)||s;walkBoundary(i,c,!0);let u=collectSiblings(c===i?c:c.nextSibling,"nextSibling",m===s?m.nextSibling:m);u.length&&n(exclude(u)),walkBoundary(s,m)},rR=['pre[class*=language-][contenteditable="false"]',"figure.image","div[data-ephox-embed-iri]","div.tiny-pageembed","div.mce-toc","div[data-mce-toc]"],isZeroWidth=e=>eE(e)&&"\uFEFF"===get$3(e),context=(e,t,n,o)=>parent(t).fold(()=>"skipping",a=>"br"===o||isZeroWidth(t)?"valid":isAnnotation(t)?"existing":isCaretNode(t.dom)?"caret":exists(rR,e=>is$1(t,e))?"valid-block":isValid(e,n,o)&&isValid(e,name(a),n)?"valid":"invalid-child"),applyWordGrab=(e,t)=>{let n=expandRng(e.dom,t,[{inline:"span"}]);t.setStart(n.startContainer,n.startOffset),t.setEnd(n.endContainer,n.endOffset),e.selection.setRng(t)},applyAnnotation=(e,t,n,o,a,i)=>{let{uid:l=t,...s}=n;add$2(e,tR()),set$3(e,`${tw()}`,l),set$3(e,`${tx()}`,o);let{attributes:d={},classes:c=[]}=a(l,s);if(setAll$1(e,d),add(e,c),i){c.length>0&&set$3(e,`${tT()}`,c.join(","));let t=F(d);t.length>0&&set$3(e,`${tB()}`,t.join(","))}},removeDirectAnnotation=e=>{remove$7(e,tR()),remove$a(e,`${tw()}`),remove$a(e,`${tx()}`),remove$a(e,`${tA()}`);let t=getOpt(e,`${tB()}`).map(e=>e.split(",")).getOr([]),n=getOpt(e,`${tT()}`).map(e=>e.split(",")).getOr([]);each$e(t,t=>remove$a(e,t)),remove$4(e,n),remove$a(e,`${tT()}`),remove$a(e,`${tB()}`)},makeAnnotation=(e,t,n,o,a)=>{let i=eS.fromTag("span",e);return applyAnnotation(i,t,n,o,a,!1),i},annotate=(e,t,n,o,a,i)=>{let l=[],s=makeAnnotation(e.getDoc(),n,i,o,a),d=value$2(),finishWrapper=()=>{d.clear()},getOrOpenWrapper=()=>d.get().getOrThunk(()=>{let e=shallow$1(s);return l.push(e),d.set(e),e}),processElements=e=>{each$e(e,processElement)},processElement=t=>{let l=context(e,t,"span",name(t));switch(l){case"invalid-child":{finishWrapper();let e=children$1(t);processElements(e),finishWrapper();break}case"valid-block":finishWrapper(),applyAnnotation(t,n,i,o,a,!0);break;case"valid":{let e=getOrOpenWrapper();wrap$2(t,e)}}},processNodes=e=>{let t=map$3(e,eS.fromDom);processElements(t)};return walk$3(e.dom,t,e=>{finishWrapper(),processNodes(e)}),l},annotateWithBookmark=(e,t,n,o)=>{e.undoManager.transact(()=>{let a=e.selection,i=a.getRng(),l=getCellsFromEditor(e).length>0,s=generate$1("mce-annotation");if(i.collapsed&&!l&&applyWordGrab(e,i),a.getRng().collapsed&&!l){let i=makeAnnotation(e.getDoc(),s,o,t,n.decorate);set$1(i,"\xa0"),a.getRng().insertNode(i.dom),a.select(i.dom)}else preserve(a,!1,()=>{runOnRanges(e,a=>{annotate(e,a,s,t,n.decorate,o)})})})},Annotator=e=>{let t=create$c();setup$w(e,t);let n=setup$x(e,t),o=isTag("span"),removeAnnotations=e=>{each$e(e,e=>{o(e)?unwrap(e):removeDirectAnnotation(e)})};return{register:(e,n)=>{t.register(e,n)},annotate:(n,o)=>{t.lookup(n).each(t=>{annotateWithBookmark(e,n,t,o)})},annotationChanged:(e,t)=>{n.addListener(e,t)},remove:t=>{identify(e,Optional.some(t)).each(({elements:t})=>{let n=e.selection.getBookmark();removeAnnotations(t),e.selection.moveToBookmark(n)})},removeAll:t=>{let n=e.selection.getBookmark();each$d(findAll(e,t),(e,t)=>{removeAnnotations(e)}),e.selection.moveToBookmark(n)},getAll:t=>{let n=findAll(e,t);return map$2(n,e=>map$3(e,e=>e.dom))}}},BookmarkManager=e=>({getBookmark:curry(getBookmark$1,e),moveToBookmark:curry(moveToBookmark,e)});BookmarkManager.isBookmarkNode=isBookmarkNode$1;let isXYWithinRange=(e,t,n)=>!n.collapsed&&exists(n.getClientRects(),n=>containsXY(n,e,t)),firePreProcess=(e,t)=>e.dispatch("PreProcess",t),firePostProcess=(e,t)=>e.dispatch("PostProcess",t),fireRemove=e=>{e.dispatch("remove")},fireDetach=e=>{e.dispatch("detach")},fireSwitchMode=(e,t)=>{e.dispatch("SwitchMode",{mode:t})},fireObjectResizeStart=(e,t,n,o,a)=>{e.dispatch("ObjectResizeStart",{target:t,width:n,height:o,origin:a})},fireObjectResized=(e,t,n,o,a)=>{e.dispatch("ObjectResized",{target:t,width:n,height:o,origin:a})},firePreInit=e=>{e.dispatch("PreInit")},firePostRender=e=>{e.dispatch("PostRender")},fireInit=e=>{e.dispatch("Init")},firePlaceholderToggle=(e,t)=>{e.dispatch("PlaceholderToggle",{state:t})},fireError=(e,t,n)=>{e.dispatch(t,n)},fireFormatApply=(e,t,n,o)=>{e.dispatch("FormatApply",{format:t,node:n,vars:o})},fireFormatRemove=(e,t,n,o)=>{e.dispatch("FormatRemove",{format:t,node:n,vars:o})},fireBeforeSetContent=(e,t)=>e.dispatch("BeforeSetContent",t),fireSetContent=(e,t)=>e.dispatch("SetContent",t),fireBeforeGetContent=(e,t)=>e.dispatch("BeforeGetContent",t),fireGetContent=(e,t)=>e.dispatch("GetContent",t),fireAutocompleterStart=(e,t)=>{e.dispatch("AutocompleterStart",t)},fireAutocompleterUpdate=(e,t)=>{e.dispatch("AutocompleterUpdate",t)},fireAutocompleterEnd=e=>{e.dispatch("AutocompleterEnd")},firePastePreProcess=(e,t,n)=>e.dispatch("PastePreProcess",{content:t,internal:n}),firePastePostProcess=(e,t,n)=>e.dispatch("PastePostProcess",{node:t,internal:n}),firePastePlainTextToggle=(e,t)=>e.dispatch("PastePlainTextToggle",{state:t}),fireEditableRootStateChange=(e,t)=>e.dispatch("EditableRootStateChange",{state:t}),rx={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:e=>e.shiftKey||e.ctrlKey||e.altKey||rx.metaKeyPressed(e),metaKeyPressed:e=>ef.os.isMacOS()||ef.os.isiOS()?e.metaKey:e.ctrlKey&&!e.altKey},rw="data-mce-selected",rA=Math.abs,rT=Math.round,rB={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},isTouchEvent=e=>"longpress"===e.type||0===e.type.indexOf("touch"),ControlSelection=(e,t)=>{let n,o,a,i,l,s,d,c,m,u,p,g,f,h,b,C,y;let v=t.dom,E=t.getDoc(),k=document,$=t.getBody(),isImage=e=>isNonNullable(e)&&(e_(e)||v.is(e,"figure.image")),isMedia=e=>eW(e)||v.hasClass(e,"mce-preview-object"),isEventOnImageOutsideRange=(e,t)=>{if(!isTouchEvent(e))return isImage(e.target)&&!isXYWithinRange(e.clientX,e.clientY,t);{let n=e.touches[0];return isImage(e.target)&&!isXYWithinRange(n.clientX,n.clientY,t)}},contextMenuSelectImage=e=>{let n=e.target;isEventOnImageOutsideRange(e,t.selection.getRng())&&!e.isDefaultPrevented()&&t.selection.select(n)},getResizeTargets=e=>v.hasClass(e,"mce-preview-object")&&isNonNullable(e.firstElementChild)?[e,e.firstElementChild]:v.is(e,"figure.image")?[e.querySelector("img")]:[e],isResizable=e=>{let n=nv(t);return!!n&&"false"!==e.getAttribute("data-mce-resize")&&e!==t.getBody()&&(v.hasClass(e,"mce-preview-object")&&isNonNullable(e.firstElementChild)?is$1(eS.fromDom(e.firstElementChild),n):is$1(eS.fromDom(e),n))},createGhostElement=e=>isMedia(e)?v.create("img",{src:ef.transparentSrc}):e.cloneNode(!0),setSizeProp=(e,n,o)=>{if(isNonNullable(o)){let a=getResizeTargets(e);each$e(a,e=>{e.style[n]||!t.schema.isValid(e.nodeName.toLowerCase(),n)?v.setStyle(e,n,o):v.setAttrib(e,n,""+o)})}},setGhostElmSize=(e,t,n)=>{setSizeProp(e,"width",t),setSizeProp(e,"height",n)},resizeGhostElement=e=>{let l,E,k,S;l=e.screenX-s,E=e.screenY-d,h=l*i[2]+u,b=E*i[3]+p,h=h<5?5:h,b=b<5?5:b,((isImage(n)||isMedia(n))&&!1!==nE(t)?!rx.modifierPressed(e):rx.modifierPressed(e))&&(rA(l)>rA(E)?(b=rT(h*g),h=rT(b/g)):(h=rT(b/g),b=rT(h*g))),setGhostElmSize(o,h,b),k=i.startPos.x+l,S=i.startPos.y+E,k=k>0?k:0,S=S>0?S:0,v.setStyles(a,{left:k,top:S,display:"block"}),a.innerHTML=h+" &times; "+b,i[2]<0&&o.clientWidth<=h&&v.setStyle(o,"left",c+(u-h)),i[3]<0&&o.clientHeight<=b&&v.setStyle(o,"top",m+(p-b)),(l=$.scrollWidth-C)+(E=$.scrollHeight-y)!=0&&v.setStyles(a,{left:k-l,top:S-E}),f||(fireObjectResizeStart(t,n,u,p,"corner-"+i.name),f=!0)},endGhostResize=()=>{let e=f;f=!1,e&&(setSizeProp(n,"width",h),setSizeProp(n,"height",b)),v.unbind(E,"mousemove",resizeGhostElement),v.unbind(E,"mouseup",endGhostResize),k!==E&&(v.unbind(k,"mousemove",resizeGhostElement),v.unbind(k,"mouseup",endGhostResize)),v.remove(o),v.remove(a),v.remove(l),showResizeRect(n),e&&(fireObjectResized(t,n,h,b,"corner-"+i.name),v.setAttrib(n,"style",v.getAttrib(n,"style"))),t.nodeChanged()},showResizeRect=e=>{unbindResizeHandleEvents();let c=v.getPos(e,$),m=c.x,f=c.y,S=e.getBoundingClientRect(),N=S.width||S.right-S.left,O=S.height||S.bottom-S.top;n!==e&&(hideResizeRect(),n=e,h=b=0);let P=t.dispatch("ObjectSelected",{target:e});isResizable(e)&&!P.isDefaultPrevented()?each$d(rB,(e,t)=>{let startDrag=c=>{let h=getResizeTargets(n)[0];s=c.screenX,d=c.screenY,u=h.clientWidth,g=(p=h.clientHeight)/u,(i=e).name=t,i.startPos={x:N*e[0]+m,y:O*e[1]+f},C=$.scrollWidth,y=$.scrollHeight,l=v.add($,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"}),v.setStyles(l,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),o=createGhostElement(n),v.addClass(o,"mce-clonedresizable"),v.setAttrib(o,"data-mce-bogus","all"),o.contentEditable="false",v.setStyles(o,{left:m,top:f,margin:0}),setGhostElmSize(o,N,O),o.removeAttribute(rw),$.appendChild(o),v.bind(E,"mousemove",resizeGhostElement),v.bind(E,"mouseup",endGhostResize),k!==E&&(v.bind(k,"mousemove",resizeGhostElement),v.bind(k,"mouseup",endGhostResize)),a=v.add($,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},u+" &times; "+p)},c=v.get("mceResizeHandle"+t);c&&v.remove(c),c=v.add($,"div",{id:"mceResizeHandle"+t,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+t+"-resize; margin:0; padding:0"}),v.bind(c,"mousedown",e=>{e.stopImmediatePropagation(),e.preventDefault(),startDrag(e)}),e.elm=c,v.setStyles(c,{left:N*e[0]+m-c.offsetWidth/2,top:O*e[1]+f-c.offsetHeight/2})}):hideResizeRect(!1)},S=first$1(showResizeRect,0),hideResizeRect=(e=!0)=>{S.cancel(),unbindResizeHandleEvents(),n&&e&&n.removeAttribute(rw),each$d(rB,(e,t)=>{let n=v.get("mceResizeHandle"+t);n&&(v.unbind(n),v.remove(n))})},isChildOrEqual=(e,t)=>v.isChildOf(e,t),updateResizeRect=n=>{if(f||t.removed||t.composing)return;let o="mousedown"===n.type?n.target:e.getNode(),a=closest$3(eS.fromDom(o),"table,img,figure.image,hr,video,span.mce-preview-object,details").map(e=>e.dom).filter(e=>v.isEditable(e.parentElement)).getOrUndefined(),i=isNonNullable(a)?v.getAttrib(a,rw,"1"):"1";if(each$e(v.select(`img[${rw}],hr[${rw}]`),e=>{e.removeAttribute(rw)}),isNonNullable(a)&&isChildOrEqual(a,$)&&t.hasFocus()){disableGeckoResize();let t=e.getStart(!0);if(isChildOrEqual(t,a)&&isChildOrEqual(e.getEnd(!0),a)){v.setAttrib(a,rw,i),S.throttle(a);return}}hideResizeRect()},unbindResizeHandleEvents=()=>{each$d(rB,e=>{e.elm&&(v.unbind(e.elm),delete e.elm)})},disableGeckoResize=()=>{try{t.getDoc().execCommand("enableObjectResizing",!1,"false")}catch(e){}};return t.on("init",()=>{disableGeckoResize(),t.on("NodeChange ResizeEditor ResizeWindow ResizeContent drop",updateResizeRect),t.on("keyup compositionend",e=>{n&&"TABLE"===n.nodeName&&updateResizeRect(e)}),t.on("hide blur",hideResizeRect),t.on("contextmenu longpress",contextMenuSelectImage,!0)}),t.on("remove",unbindResizeHandleEvents),{isResizable,showResizeRect,hideResizeRect,updateResizeRect,destroy:()=>{S.cancel(),n=o=l=null}}},setStart=(e,t)=>{t.fold(t=>{e.setStartBefore(t.dom)},(t,n)=>{e.setStart(t.dom,n)},t=>{e.setStartAfter(t.dom)})},setFinish=(e,t)=>{t.fold(t=>{e.setEndBefore(t.dom)},(t,n)=>{e.setEnd(t.dom,n)},t=>{e.setEndAfter(t.dom)})},relativeToNative=(e,t,n)=>{let o=e.document.createRange();return setStart(o,t),setFinish(o,n),o},exactToNative=(e,t,n,o,a)=>{let i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(o.dom,a),i},rD=tq.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),fromRange=(e,t,n)=>t(eS.fromDom(n.startContainer),n.startOffset,eS.fromDom(n.endContainer),n.endOffset),getRanges=(e,t)=>t.match({domRange:e=>({ltr:constant(e),rtl:Optional.none}),relative:(t,n)=>({ltr:cached(()=>relativeToNative(e,t,n)),rtl:cached(()=>Optional.some(relativeToNative(e,n,t)))}),exact:(t,n,o,a)=>({ltr:cached(()=>exactToNative(e,t,n,o,a)),rtl:cached(()=>Optional.some(exactToNative(e,o,a,t,n)))})}),doDiagnose=(e,t)=>{let n=t.ltr();if(!n.collapsed)return fromRange(e,rD.ltr,n);{let o=t.rtl().filter(e=>!1===e.collapsed);return o.map(e=>rD.rtl(eS.fromDom(e.endContainer),e.endOffset,eS.fromDom(e.startContainer),e.startOffset)).getOrThunk(()=>fromRange(e,rD.ltr,n))}},diagnose=(e,t)=>{let n=getRanges(e,t);return doDiagnose(e,n)};rD.ltr,rD.rtl;let rI={create:(e,t,n,o)=>({start:e,soffset:t,finish:n,foffset:o})},rF=document.caretPositionFromPoint?(e,t,n)=>{var o,a;return Optional.from(null===(a=(o=e.dom).caretPositionFromPoint)||void 0===a?void 0:a.call(o,t,n)).bind(t=>{if(null===t.offsetNode)return Optional.none();let n=e.dom.createRange();return n.setStart(t.offsetNode,t.offset),n.collapse(),Optional.some(n)})}:document.caretRangeFromPoint?(e,t,n)=>{var o,a;return Optional.from(null===(a=(o=e.dom).caretRangeFromPoint)||void 0===a?void 0:a.call(o,t,n))}:Optional.none,fromPoint$1=(e,t,n)=>{let o=eS.fromDom(e.document);return rF(o,t,n).map(e=>rI.create(eS.fromDom(e.startContainer),e.startOffset,eS.fromDom(e.endContainer),e.endOffset))},r_=tq.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),rL=r_.before,rM=r_.on,rU=r_.after,rz={before:rL,on:rM,after:rU,cata:(e,t,n,o)=>e.fold(t,n,o),getStart:e=>e.fold(identity,identity,identity)},rW=tq.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),getStart$1=e=>e.match({domRange:e=>eS.fromDom(e.startContainer),relative:(e,t)=>rz.getStart(e),exact:(e,t,n,o)=>e}),rH=rW.domRange,rV=rW.relative,rq=rW.exact,rj=rI.create,rK={domRange:rH,relative:rV,exact:rq,exactFromRange:e=>rW.exact(e.start,e.soffset,e.finish,e.foffset),getWin:e=>{let t=getStart$1(e);return defaultView(t)},range:rj},beforeSpecial=(e,t)=>{let n=name(e);return"input"===n?rz.after(e):contains$2(["br","img"],n)?0===t?rz.before(e):rz.after(e):rz.on(e,t)},preprocessRelative=(e,t)=>{let n=e.fold(rz.before,beforeSpecial,rz.after),o=t.fold(rz.before,beforeSpecial,rz.after);return rK.relative(n,o)},preprocessExact=(e,t,n,o)=>{let a=beforeSpecial(e,t),i=beforeSpecial(n,o);return rK.relative(a,i)},preprocess=e=>e.match({domRange:e=>{let t=eS.fromDom(e.startContainer),n=eS.fromDom(e.endContainer);return preprocessExact(t,e.startOffset,n,e.endOffset)},relative:preprocessRelative,exact:preprocessExact}),fromElements=(e,t)=>{let n=t||document,o=n.createDocumentFragment();return each$e(e,e=>{o.appendChild(e.dom)}),eS.fromDom(o)},toNative=e=>{let t=rK.getWin(e).dom,getDomRange=(e,n,o,a)=>exactToNative(t,e,n,o,a),n=preprocess(e);return diagnose(t,n).match({ltr:getDomRange,rtl:getDomRange})},getAtPoint=(e,t,n)=>fromPoint$1(e,t,n),fromPoint=(e,t,n)=>{let o=defaultView(eS.fromDom(n));return getAtPoint(o.dom,e,t).map(e=>{let t=n.createRange();return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),t}).getOrUndefined()},isEq$4=(e,t)=>isNonNullable(e)&&isNonNullable(t)&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset,findParent=(e,t,n)=>{let o=e;for(;o&&o!==t;){if(n(o))return o;o=o.parentNode}return null},hasParent$1=(e,t,n)=>null!==findParent(e,t,n),hasParentWithName=(e,t,n)=>hasParent$1(e,t,e=>e.nodeName===n),isCeFalseCaretContainer=(e,t)=>isCaretContainer$2(e)&&!hasParent$1(e,t,isCaretNode),hasBrBeforeAfter=(e,t,n)=>{let o=t.parentNode;if(o){let a;let i=new DomTreeWalker(t,e.getParent(o,e.isBlock)||e.getRoot());for(;a=i[n?"prev":"next"]();)if(eF(a))return!0}return!1},isPrevNode=(e,t)=>{var n;return(null===(n=e.previousSibling)||void 0===n?void 0:n.nodeName)===t},hasContentEditableFalseParent=(e,t)=>{let n=t;for(;n&&n!==e;){if(eM(n))return!0;n=n.parentNode}return!1},findTextNodeRelative=(e,t,n,o,a)=>{let i,l;let s=e.getRoot(),d=e.schema.getNonEmptyElements(),c=a.parentNode;if(!c)return Optional.none();let m=e.getParent(c,e.isBlock)||s;if(o&&eF(a)&&t&&e.isEmpty(m))return Optional.some(CaretPosition(c,e.nodeIndex(a)));let u=new DomTreeWalker(a,m);for(;l=u[o?"prev":"next"]();){if("false"===e.getContentEditableParent(l)||isCeFalseCaretContainer(l,s))return Optional.none();if(ew(l)&&l.data.length>0){if(!hasParentWithName(l,s,"A"))return Optional.some(CaretPosition(l,o?l.data.length:0));return Optional.none()}if(e.isBlock(l)||d[l.nodeName.toLowerCase()])return Optional.none();i=l}return eB(i)?Optional.none():n&&i?Optional.some(CaretPosition(i,0)):Optional.none()},normalizeEndPoint=(e,t,n,o)=>{let a;let i=e.getRoot(),l=!1,s=n?o.startContainer:o.endContainer,d=n?o.startOffset:o.endOffset,c=eR(s)&&d===s.childNodes.length,m=e.schema.getNonEmptyElements(),u=n;if(isCaretContainer$2(s))return Optional.none();if(eR(s)&&d>s.childNodes.length-1&&(u=!1),eD(s)&&(s=i,d=0),s===i){if(u&&(a=s.childNodes[d>0?d-1:0])&&(isCaretContainer$2(a)||m[a.nodeName]||isTable$2(a)))return Optional.none();if(s.hasChildNodes()){if(d=Math.min(!u&&d>0?d-1:d,s.childNodes.length-1),d=ew(s=s.childNodes[d])&&c?s.data.length:0,!t&&s===i.lastChild&&isTable$2(s)||hasContentEditableFalseParent(i,s)||isCaretContainer$2(s))return Optional.none();if(s.hasChildNodes()&&!isTable$2(s)){a=s;let t=new DomTreeWalker(s,i);do{if(eM(a)||isCaretContainer$2(a)){l=!1;break}if(ew(a)&&a.data.length>0){d=u?0:a.data.length,s=a,l=!0;break}if(m[a.nodeName.toLowerCase()]&&!ez(a)){d=e.nodeIndex(a),s=a.parentNode,!u&&d++,l=!0;break}}while(a=u?t.next():t.prev())}}}return t&&(ew(s)&&0===d&&findTextNodeRelative(e,c,t,!0,s).each(e=>{s=e.container(),d=e.offset(),l=!0}),eR(s)&&((a=s.childNodes[d])||(a=s.childNodes[d-1]),a&&eF(a)&&!isPrevNode(a,"A")&&!hasBrBeforeAfter(e,a,!1)&&!hasBrBeforeAfter(e,a,!0)&&findTextNodeRelative(e,c,t,!0,a).each(e=>{s=e.container(),d=e.offset(),l=!0}))),u&&!t&&ew(s)&&d===s.data.length&&findTextNodeRelative(e,c,t,!1,s).each(e=>{s=e.container(),d=e.offset(),l=!0}),l&&s?Optional.some(CaretPosition(s,d)):Optional.none()},normalize$2=(e,t)=>{let n=t.collapsed,o=t.cloneRange(),a=CaretPosition.fromRangeStart(t);return normalizeEndPoint(e,n,!0,o).each(e=>{n&&CaretPosition.isAbove(a,e)||o.setStart(e.container(),e.offset())}),n||normalizeEndPoint(e,n,!1,o).each(e=>{o.setEnd(e.container(),e.offset())}),n&&o.collapse(!0),isEq$4(t,o)?Optional.none():Optional.some(o)},splitText=(e,t)=>e.splitText(t),split=e=>{let t=e.startContainer,n=e.startOffset,o=e.endContainer,a=e.endOffset;if(t===o&&ew(t)){if(n>0&&n<t.data.length){if(t=(o=splitText(t,n)).previousSibling,a>n){a-=n;let e=splitText(o,a).previousSibling;t=o=e,a=e.data.length,n=0}else a=0}}else if(ew(t)&&n>0&&n<t.data.length&&(t=splitText(t,n),n=0),ew(o)&&a>0&&a<o.data.length){let e=splitText(o,a).previousSibling;o=e,a=e.data.length}return{startContainer:t,startOffset:n,endContainer:o,endOffset:a}},RangeUtils=e=>({walk:(t,n)=>walk$3(e,t,n),split:split,expand:(t,n={type:"word"})=>{if("word"===n.type){let n=expandRng(e,t,[{inline:"span"}]),o=e.createRng();return o.setStart(n.startContainer,n.startOffset),o.setEnd(n.endContainer,n.endOffset),o}return t},normalize:t=>normalize$2(e,t).fold(w,e=>(t.setStart(e.startContainer,e.startOffset),t.setEnd(e.endContainer,e.endOffset),!0))});RangeUtils.compareRanges=isEq$4,RangeUtils.getCaretRangeFromPoint=fromPoint,RangeUtils.getSelectedNode=getSelectedNode,RangeUtils.getNode=getNode$1;let rG=((e,t)=>{let get=n=>{let o=t(n);if(o<=0||null===o){let t=get$7(n,e);return parseFloat(t)||0}return o},aggregate=(e,t)=>foldl(t,(t,n)=>{let o=get$7(e,n),a=void 0===o?0:parseInt(o,10);return isNaN(a)?t:t+a},0);return{set:(t,n)=>{if(!x(n)&&!n.match(/^[0-9]+$/))throw Error(e+".set accepts only positive integer values. Value was "+n);let o=t.dom;isSupported(o)&&(o.style[e]=n+"px")},get,getOuter:get,aggregate,max:(e,t,n)=>{let o=aggregate(e,n);return t>o?t-o:0}}})("height",e=>{let t=e.dom;return inBody(e)?t.getBoundingClientRect().height:t.offsetHeight}),get$2=e=>rG.get(e),getDocument=()=>eS.fromDom(document),walkUp=(e,t)=>{let n=e.view(t);return n.fold(constant([]),t=>{let n=e.owner(t),o=walkUp(e,n);return[t].concat(o)})},pathTo=(e,t)=>{let n=t.owner(e);return walkUp(t,n)};var rY=Object.freeze({__proto__:null,view:e=>{var t;let n=e.dom===document?Optional.none():Optional.from(null===(t=e.dom.defaultView)||void 0===t?void 0:t.frameElement);return n.map(eS.fromDom)},owner:e=>documentOrOwner(e)});let find=e=>{let t=getDocument(),n=get$5(t),o=pathTo(e,rY),a=viewport(e),i=foldr(o,(e,t)=>{let n=viewport(t);return{left:e.left+n.left,top:e.top+n.top}},{left:0,top:0});return r(i.left+a.left+n.left,i.top+a.top+n.top)},excludeFromDescend=e=>"textarea"===name(e),fireScrollIntoViewEvent=(e,t)=>{let n=e.dispatch("ScrollIntoView",t);return n.isDefaultPrevented()},fireAfterScrollIntoViewEvent=(e,t)=>{e.dispatch("AfterScrollIntoView",t)},descend=(e,t)=>{let n=children$1(e);if(0===n.length||excludeFromDescend(e))return{element:e,offset:t};if(t<n.length&&!excludeFromDescend(n[t]))return{element:n[t],offset:0};{let o=n[n.length-1];return excludeFromDescend(o)?{element:e,offset:t}:"img"===name(o)?{element:o,offset:1}:eE(o)?{element:o,offset:get$3(o).length}:{element:o,offset:children$1(o).length}}},markerInfo=(e,t)=>{let n=absolute(e),o=get$2(e);return{element:e,bottom:n.top+o,height:o,pos:n,cleanup:t}},createMarker$1=(e,t)=>{let n=descend(e,t),o=eS.fromHtml('<span data-mce-bogus="all" style="display: inline-block;">\uFEFF</span>');return before$3(n.element,o),markerInfo(o,()=>remove$5(o))},elementMarker=e=>markerInfo(eS.fromDom(e),noop),withMarker=(e,t,n,o)=>{preserveWith(e,(a,i)=>applyWithMarker(e,t,n,o),n)},withScrollEvents=(e,t,n,o,a)=>{let i={elm:o.element.dom,alignToTop:a};if(fireScrollIntoViewEvent(e,i))return;let l=get$5(t).top;n(e,t,l,o,a),fireAfterScrollIntoViewEvent(e,i)},applyWithMarker=(e,t,n,o)=>{let a=eS.fromDom(e.getBody()),i=eS.fromDom(e.getDoc());reflow(a);let l=createMarker$1(eS.fromDom(n.startContainer),n.startOffset);withScrollEvents(e,i,t,l,o),l.cleanup()},withElement=(e,t,n,o)=>{let a=eS.fromDom(e.getDoc());withScrollEvents(e,a,n,elementMarker(t),o)},preserveWith=(e,t,n)=>{let o=n.startContainer,a=n.startOffset,i=n.endContainer,l=n.endOffset;t(eS.fromDom(o),eS.fromDom(i));let s=e.dom.createRng();s.setStart(o,a),s.setEnd(i,l),e.selection.setRng(n)},scrollToMarker=(e,t,n,o,a)=>{let i=t.pos;if(o)to(i.left,i.top,a);else{let o=i.top-n+t.height;to(-e.getBody().getBoundingClientRect().left,o,a)}},intoWindowIfNeeded=(e,t,n,o,a,i)=>{let l=o+n,s=a.pos.top,d=a.bottom,c=d-s>=o;if(s<n)scrollToMarker(e,a,o,!1!==i,t);else if(s>l){let n=c?!1!==i:!0===i;scrollToMarker(e,a,o,n,t)}else d>l&&!c&&scrollToMarker(e,a,o,!0===i,t)},intoWindow=(e,t,n,o,a)=>{let i=defaultView(t).dom.innerHeight;intoWindowIfNeeded(e,t,n,i,o,a)},intoFrame=(e,t,n,o,a)=>{let i=defaultView(t).dom.innerHeight;intoWindowIfNeeded(e,t,n,i,o,a);let l=find(o.element),s=getBounds(window);l.top<s.y?intoView(o.element,!1!==a):l.top>s.bottom&&intoView(o.element,!0===a)},rangeIntoWindow=(e,t,n)=>withMarker(e,intoWindow,t,n),elementIntoWindow=(e,t,n)=>withElement(e,t,intoWindow,n),rangeIntoFrame=(e,t,n)=>withMarker(e,intoFrame,t,n),elementIntoFrame=(e,t,n)=>withElement(e,t,intoFrame,n),scrollElementIntoView=(e,t,n)=>{let o=e.inline?elementIntoWindow:elementIntoFrame;o(e,t,n)},scrollRangeIntoView=(e,t,n)=>{let o=e.inline?rangeIntoWindow:rangeIntoFrame;o(e,t,n)},focus$1=e=>e.dom.focus(),hasFocus$1=e=>{let t=eP(e).dom;return e.dom===t.activeElement},active$1=(e=getDocument())=>Optional.from(e.dom.activeElement).map(eS.fromDom),search=e=>active$1(eP(e)).filter(t=>e.dom.contains(t.dom)),clamp$1=(e,t)=>{let n=eE(t)?get$3(t).length:children$1(t).length+1;return e>n?n:e<0?0:e},normalizeRng=e=>rK.range(e.start,clamp$1(e.soffset,e.start),e.finish,clamp$1(e.foffset,e.finish)),isOrContains=(e,t)=>!isRestrictedNode(t.dom)&&(contains(e,t)||eq(e,t)),isRngInRoot=e=>t=>isOrContains(e,t.start)&&isOrContains(e,t.finish),shouldStore=e=>e.inline||ef.browser.isFirefox(),nativeRangeToSelectionRange=e=>rK.range(eS.fromDom(e.startContainer),e.startOffset,eS.fromDom(e.endContainer),e.endOffset),readRange=e=>{let t=e.getSelection(),n=t&&0!==t.rangeCount?Optional.from(t.getRangeAt(0)):Optional.none();return n.map(nativeRangeToSelectionRange)},getBookmark=e=>{let t=defaultView(e);return readRange(t.dom).filter(isRngInRoot(e))},validate=(e,t)=>Optional.from(t).filter(isRngInRoot(e)).map(normalizeRng),bookmarkToNativeRng=e=>{let t=document.createRange();try{return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),Optional.some(t)}catch(e){return Optional.none()}},store=e=>{let t=shouldStore(e)?getBookmark(eS.fromDom(e.getBody())):Optional.none();e.bookmark=t.isSome()?t:e.bookmark},getRng=e=>{let t=e.bookmark?e.bookmark:Optional.none();return t.bind(t=>validate(eS.fromDom(e.getBody()),t)).bind(bookmarkToNativeRng)},restore=e=>{getRng(e).each(t=>e.selection.setRng(t))},rX={isEditorUIElement:e=>{let t=e.className.toString();return -1!==t.indexOf("tox-")||-1!==t.indexOf("mce-")}},wrappedSetTimeout=(e,t)=>(x(t)||(t=0),setTimeout(e,t)),wrappedSetInterval=(e,t)=>(x(t)||(t=0),setInterval(e,t)),rZ={setEditorTimeout:(e,t,n)=>wrappedSetTimeout(()=>{e.removed||t()},n),setEditorInterval:(e,t,n)=>{let o=wrappedSetInterval(()=>{e.removed?clearInterval(o):t()},n);return o}},isManualNodeChange=e=>"nodechange"===e.type&&e.selectionChange,registerPageMouseUp=(e,t)=>{let mouseUpPage=()=>{t.throttle()};DOMUtils.DOM.bind(document,"mouseup",mouseUpPage),e.on("remove",()=>{DOMUtils.DOM.unbind(document,"mouseup",mouseUpPage)})},registerMouseUp=(e,t)=>{e.on("mouseup touchend",e=>{t.throttle()})},registerEditorEvents=(e,t)=>{registerMouseUp(e,t),e.on("keyup NodeChange AfterSetSelectionRange",t=>{isManualNodeChange(t)||store(e)})},register$6=e=>{let t=first$1(()=>{store(e)},0);e.on("init",()=>{e.inline&&registerPageMouseUp(e,t),registerEditorEvents(e,t)}),e.on("remove",()=>{t.cancel()})},rQ=DOMUtils.DOM,isEditorUIElement=e=>eR(e)&&rX.isEditorUIElement(e),isEditorContentAreaElement=e=>{let t=e.classList;return void 0!==t&&(t.contains("tox-edit-area")||t.contains("tox-edit-area__iframe")||t.contains("mce-content-body"))},isUIElement=(e,t)=>{let n=nD(e),o=rQ.getParent(t,t=>isEditorUIElement(t)||!!n&&e.dom.is(t,n));return null!==o},getActiveElement=e=>{try{let t=eP(eS.fromDom(e.getElement()));return active$1(t).fold(()=>document.body,e=>e.dom)}catch(e){return document.body}},registerEvents$1=(t,n)=>{let o=n.editor;register$6(o);let toggleContentAreaOnFocus=(e,t)=>{if(ru(e)&&!0!==e.inline){let n=eS.fromDom(e.getContainer());t(n,"tox-edit-focus")}};o.on("focusin",()=>{let e=t.focusedEditor;isEditorContentAreaElement(getActiveElement(o))&&toggleContentAreaOnFocus(o,add$2),e!==o&&(e&&e.dispatch("blur",{focusedEditor:o}),t.setActive(o),t.focusedEditor=o,o.dispatch("focus",{blurredEditor:e}),o.focus(!0))}),o.on("focusout",()=>{rZ.setEditorTimeout(o,()=>{let e=t.focusedEditor;isEditorContentAreaElement(getActiveElement(o))&&e===o||toggleContentAreaOnFocus(o,remove$7),isUIElement(o,getActiveElement(o))||e!==o||(o.dispatch("blur",{focusedEditor:null}),t.focusedEditor=null)})}),e||(e=e=>{let n=t.activeEditor;n&&getOriginalEventTarget(e).each(e=>{e.ownerDocument!==document||e===document.body||isUIElement(n,e)||t.focusedEditor!==n||(n.dispatch("blur",{focusedEditor:null}),t.focusedEditor=null)})},rQ.bind(document,"focusin",e))},unregisterDocumentEvents=(t,n)=>{t.focusedEditor===n.editor&&(t.focusedEditor=null),!t.activeEditor&&e&&(rQ.unbind(document,"focusin",e),e=null)},setup$v=e=>{e.on("AddEditor",curry(registerEvents$1,e)),e.on("RemoveEditor",curry(unregisterDocumentEvents,e))},getContentEditableHost=(e,t)=>e.dom.getParent(t,t=>"true"===e.dom.getContentEditable(t)),getCollapsedNode=e=>e.collapsed?Optional.from(getNode$1(e.startContainer,e.startOffset)).map(eS.fromDom):Optional.none(),getFocusInElement=(e,t)=>getCollapsedNode(t).bind(t=>eJ(t)?Optional.some(t):contains(e,t)?Optional.none():Optional.some(e)),normalizeSelection=(e,t)=>{getFocusInElement(eS.fromDom(e.getBody()),t).bind(e=>r$(e.dom)).fold(()=>{e.selection.normalize()},t=>e.selection.setRng(t.toRange()))},focusBody=e=>{if(e.setActive)try{e.setActive()}catch(t){e.focus()}else e.focus()},hasElementFocus=e=>hasFocus$1(e)||search(e).isSome(),hasIframeFocus=e=>isNonNullable(e.iframeElement)&&hasFocus$1(eS.fromDom(e.iframeElement)),hasInlineFocus=e=>{let t=e.getBody();return t&&hasElementFocus(eS.fromDom(t))},hasUiFocus=e=>{let t=eP(eS.fromDom(e.getElement()));return active$1(t).filter(t=>!isEditorContentAreaElement(t.dom)&&isUIElement(e,t.dom)).isSome()},hasFocus=e=>e.inline?hasInlineFocus(e):hasIframeFocus(e),hasEditorOrUiFocus=e=>hasFocus(e)||hasUiFocus(e),focusEditor=e=>{let t=e.selection,n=e.getBody(),o=t.getRng();e.quirks.refreshContentEditable(),isNonNullable(e.bookmark)&&!hasFocus(e)&&getRng(e).each(t=>{e.selection.setRng(t),o=t});let a=getContentEditableHost(e,t.getNode());if(a&&e.dom.isChildOf(a,n)){focusBody(a),normalizeSelection(e,o),activateEditor(e);return}e.inline||(ef.browser.isOpera()||focusBody(n),e.getWin().focus()),(ef.browser.isFirefox()||e.inline)&&(focusBody(n),normalizeSelection(e,o)),activateEditor(e)},activateEditor=e=>e.editorManager.setActive(e),focus=(e,t)=>{e.removed||(t?activateEditor(e):focusEditor(e))},getEndpointElement=(e,t,n,o,a)=>{let i=n?t.startContainer:t.endContainer,l=n?t.startOffset:t.endOffset;return Optional.from(i).map(eS.fromDom).map(e=>o&&t.collapsed?e:child$1(e,a(e,l)).getOr(e)).bind(e=>ev(e)?Optional.some(e):parent(e).filter(ev)).map(e=>e.dom).getOr(e)},getStart=(e,t,n=!1)=>getEndpointElement(e,t,!0,n,(e,t)=>Math.min(childNodesCount(e),t)),getEnd$1=(e,t,n=!1)=>getEndpointElement(e,t,!1,n,(e,t)=>t>0?t-1:t),skipEmptyTextNodes=(e,t)=>{let n=e;for(;e&&ew(e)&&0===e.length;)e=t?e.nextSibling:e.previousSibling;return e||n},getNode=(e,t)=>{if(!t)return e;let n=t.startContainer,o=t.endContainer,a=t.startOffset,i=t.endOffset,l=t.commonAncestorContainer;!t.collapsed&&(n===o&&i-a<2&&n.hasChildNodes()&&(l=n.childNodes[a]),ew(n)&&ew(o)&&(n=n.length===a?skipEmptyTextNodes(n.nextSibling,!0):n.parentNode,o=0===i?skipEmptyTextNodes(o.previousSibling,!1):o.parentNode,n&&n===o&&(l=n)));let s=ew(l)?l.parentNode:l;return eR(s)?s:e},getSelectedBlocks=(e,t,n,o)=>{let a=[],i=e.getRoot(),l=e.getParent(n||getStart(i,t,t.collapsed),e.isBlock),s=e.getParent(o||getEnd$1(i,t,t.collapsed),e.isBlock);if(l&&l!==i&&a.push(l),l&&s&&l!==s){let t;let n=new DomTreeWalker(l,i);for(;(t=n.next())&&t!==s;)e.isBlock(t)&&a.push(t)}return s&&l!==s&&s!==i&&a.push(s),a},select=(e,t,n)=>Optional.from(t).bind(t=>Optional.from(t.parentNode).map(o=>{let a=e.nodeIndex(t),i=e.createRng();return i.setStart(o,a),i.setEnd(o,a+1),n&&(moveEndPoint(e,i,t,!0),moveEndPoint(e,i,t,!1)),i})),processRanges=(e,t)=>map$3(t,t=>{let n=e.dispatch("GetSelectionRange",{range:t});return n.range!==t?n.range:t}),getEnd=e=>"img"===name(e)?1:getOption(e).fold(()=>children$1(e).length,e=>e.length),isTextNodeWithCursorPosition=e=>getOption(e).filter(e=>0!==e.trim().length||e.indexOf("\xa0")>-1).isSome(),isContentEditableFalse$5=e=>isHTMLElement(e)&&"false"===get$9(e,"contenteditable"),rJ=["img","br"],isCursorPosition=e=>{let t=isTextNodeWithCursorPosition(e);return t||contains$2(rJ,name(e))||isContentEditableFalse$5(e)},first=e=>descendant$1(e,isCursorPosition),last=e=>descendantRtl(e,isCursorPosition),descendantRtl=(e,t)=>{let descend=e=>{let n=children$1(e);for(let e=n.length-1;e>=0;e--){let o=n[e];if(t(o))return Optional.some(o);let a=descend(o);if(a.isSome())return a}return Optional.none()};return descend(e)},r0="[data-mce-autocompleter]",create$9=(e,t)=>{if(findIn(eS.fromDom(e.getBody())).isNone()){let n=eS.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',e.getDoc());append$1(n,eS.fromDom(t.extractContents())),t.insertNode(n.dom),parent(n).each(e=>e.dom.normalize()),last(n).map(t=>{e.selection.setCursorLocation(t.dom,getEnd(t))})}},detect$1=e=>closest$3(e,r0),findIn=e=>descendant(e,r0),remove$2=(e,t)=>findIn(t).each(t=>{let n=e.selection.getBookmark();unwrap(t),e.selection.moveToBookmark(n)}),r1={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},walk$2=(e,t,n)=>{let o=n?"lastChild":"firstChild",a=n?"prev":"next";if(e[o])return e[o];if(e!==t){let n=e[a];if(n)return n;for(let o=e.parent;o&&o!==t;o=o.parent)if(n=o[a])return n}},isEmptyTextNode=e=>{var t;let n=null!==(t=e.value)&&void 0!==t?t:"";if(!isWhitespaceText(n))return!1;let o=e.parent;return!(o&&("span"!==o.name||o.attr("style"))&&/^[ ]+$/.test(n))},isNonEmptyElement=e=>{let t="a"===e.name&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t};let AstNode=class AstNode{static create(e,t){let n=new AstNode(e,r1[e]||1);return t&&each$d(t,(e,t)=>{n.attr(t,e)}),n}constructor(e,t){this.name=e,this.type=t,1===t&&(this.attributes=[],this.attributes.map={})}replace(e){return e.parent&&e.remove(),this.insert(e,this),this.remove(),this}attr(e,t){let n=this;if(!k(e))return isNonNullable(e)&&each$d(e,(e,t)=>{n.attr(t,e)}),n;let o=n.attributes;if(o){if(void 0!==t){if(null===t){if(e in o.map){delete o.map[e];let t=o.length;for(;t--;)if(o[t].name===e){o.splice(t,1);break}}return n}if(e in o.map){let n=o.length;for(;n--;)if(o[n].name===e){o[n].value=t;break}}else o.push({name:e,value:t});return o.map[e]=t,n}return o.map[e]}}clone(){let e=new AstNode(this.name,this.type),t=this.attributes;if(t){let n=[];n.map={};for(let e=0,o=t.length;e<o;e++){let o=t[e];"id"!==o.name&&(n[n.length]={name:o.name,value:o.value},n.map[o.name]=o.value)}e.attributes=n}return e.value=this.value,e}wrap(e){return this.parent&&(this.parent.insert(e,this),e.append(this)),this}unwrap(){for(let e=this.firstChild;e;){let t=e.next;this.insert(e,this,!0),e=t}this.remove()}remove(){let e=this.parent,t=this.next,n=this.prev;return e&&(e.firstChild===this?(e.firstChild=t,t&&(t.prev=null)):n&&(n.next=t),e.lastChild===this?(e.lastChild=n,n&&(n.next=null)):t&&(t.prev=n),this.parent=this.next=this.prev=null),this}append(e){e.parent&&e.remove();let t=this.lastChild;return t?(t.next=e,e.prev=t,this.lastChild=e):this.lastChild=this.firstChild=e,e.parent=this,e}insert(e,t,n){e.parent&&e.remove();let o=t.parent||this;return n?(t===o.firstChild?o.firstChild=e:t.prev&&(t.prev.next=e),e.prev=t.prev,e.next=t,t.prev=e):(t===o.lastChild?o.lastChild=e:t.next&&(t.next.prev=e),e.next=t.next,e.prev=t,t.next=e),e.parent=o,e}getAll(e){let t=[];for(let n=this.firstChild;n;n=walk$2(n,this))n.name===e&&t.push(n);return t}children(){let e=[];for(let t=this.firstChild;t;t=t.next)e.push(t);return e}empty(){if(this.firstChild){let e=[];for(let t=this.firstChild;t;t=walk$2(t,this))e.push(t);let t=e.length;for(;t--;){let n=e[t];n.parent=n.firstChild=n.lastChild=n.next=n.prev=null}}return this.firstChild=this.lastChild=null,this}isEmpty(e,t={},n){var o;let a=this.firstChild;if(isNonEmptyElement(this))return!1;if(a)do{if(1===a.type){if(a.attr("data-mce-bogus"))continue;if(e[a.name]||isNonEmptyElement(a))return!1}if(8===a.type||3===a.type&&!isEmptyTextNode(a)||3===a.type&&a.parent&&t[a.parent.name]&&isWhitespaceText(null!==(o=a.value)&&void 0!==o?o:"")||n&&n(a))return!1}while(a=walk$2(a,this));return!0}walk(e){return walk$2(this,null,e)}};let getTemporaryNodeSelector=e=>`${0===e.length?"":`${map$3(e,e=>`[${e}]`).join(",")},`}[data-mce-bogus="all"]`,getTemporaryNodes=(e,t)=>e.querySelectorAll(getTemporaryNodeSelector(t)),createCommentWalker=e=>document.createTreeWalker(e,NodeFilter.SHOW_COMMENT,null),hasComments=e=>null!==createCommentWalker(e).nextNode(),hasTemporaryNodes=(e,t)=>null!==e.querySelector(getTemporaryNodeSelector(t)),trimTemporaryNodes=(e,t)=>{each$e(getTemporaryNodes(e,t),e=>{let n=eS.fromDom(e);"all"===get$9(n,"data-mce-bogus")?remove$5(n):each$e(t,e=>{has$1(n,e)&&remove$a(n,e)})})},removeCommentsContainingZwsp=e=>{let t=createCommentWalker(e),n=t.nextNode();for(;null!==n;){let e=t.currentNode;n=t.nextNode(),k(e.nodeValue)&&e.nodeValue.includes("\uFEFF")&&remove$5(eS.fromDom(e))}},deepClone=e=>e.cloneNode(!0),trim$1=(e,t)=>{let n=e;return hasComments(e)?(removeCommentsContainingZwsp(n=deepClone(e)),hasTemporaryNodes(n,t)&&trimTemporaryNodes(n,t)):hasTemporaryNodes(e,t)&&trimTemporaryNodes(n=deepClone(e),t),n},cleanupBogusElements=e=>{let t=descendants(e,"[data-mce-bogus]");each$e(t,e=>{let t=get$9(e,"data-mce-bogus");"all"===t?remove$5(e):isBr$5(e)?(before$3(e,eS.fromText("\uFEFF")),remove$5(e)):unwrap(e)})},cleanupInputNames=e=>{let t=descendants(e,"input");each$e(t,e=>{remove$a(e,"name")})},trimEmptyContents=(e,t)=>{let n=t2(e),o=RegExp(`^(<${n}[^>]*>(&nbsp;|&#160;|\\s|\u00a0|<br \\/>|)<\\/${n}>[\r
]*|<br \\/>[\r
]*)$`);return t.replace(o,"")},getPlainTextContent=(e,t)=>{let n=e.getDoc(),o=eP(eS.fromDom(e.getBody())),a=eS.fromTag("div",n);set$3(a,"data-mce-bogus","all"),setAll(a,{position:"fixed",left:"-9999999px",top:"0"}),set$1(a,t.innerHTML),cleanupBogusElements(a),cleanupInputNames(a);let i=getContentContainer(o);append$1(i,a);let l=trim$2(a.dom.innerText);return remove$5(a),l},getContentFromBody=(e,t,n)=>{let o;o="raw"===t.format?eb.trim(trim$2(trim$1(n,e.serializer.getTempAttrs()).innerHTML)):"text"===t.format?getPlainTextContent(e,n):"tree"===t.format?e.serializer.serialize(n,t):trimEmptyContents(e,e.serializer.serialize(n,t));let a="text"!==t.format&&!e1(eS.fromDom(n));return a&&k(o)?eb.trim(o):o},getContentInternal=(e,t)=>Optional.from(e.getBody()).fold(constant("tree"===t.format?new AstNode("body",11):""),n=>getContentFromBody(e,t,n)),r2=eb.makeMap,Writer=e=>{let t=[];e=e||{};let n=e.indent,o=r2(e.indent_before||""),a=r2(e.indent_after||""),i=tu.getEncodeFunc(e.entity_encoding||"raw",e.entities),l="xhtml"!==e.element_format;return{start:(e,s,d)=>{if(n&&o[e]&&t.length>0){let e=t[t.length-1];e.length>0&&"\n"!==e&&t.push("\n")}if(t.push("<",e),s)for(let e=0,n=s.length;e<n;e++){let n=s[e];t.push(" ",n.name,'="',i(n.value,!0),'"')}if(!d||l?t[t.length]=">":t[t.length]=" />",d&&n&&a[e]&&t.length>0){let e=t[t.length-1];e.length>0&&"\n"!==e&&t.push("\n")}},end:e=>{let o;t.push("</",e,">"),n&&a[e]&&t.length>0&&(o=t[t.length-1]).length>0&&"\n"!==o&&t.push("\n")},text:(e,n)=>{e.length>0&&(t[t.length]=n?e:i(e))},cdata:e=>{t.push("<![CDATA[",e,"]]>")},comment:e=>{t.push("<!--",e,"-->")},pi:(e,o)=>{o?t.push("<?",e," ",i(o),"?>"):t.push("<?",e,"?>"),n&&t.push("\n")},doctype:e=>{t.push("<!DOCTYPE",e,">",n?"\n":"")},reset:()=>{t.length=0},getContent:()=>t.join("").replace(/\n$/,"")}},HtmlSerializer=(e={},t=Schema())=>{let n=Writer(e);return e.validate=!("validate"in e)||e.validate,{serialize:o=>{let a=e.validate,i={3:e=>{var t;n.text(null!==(t=e.value)&&void 0!==t?t:"",e.raw)},8:e=>{var t;n.comment(null!==(t=e.value)&&void 0!==t?t:"")},7:e=>{n.pi(e.name,e.value)},10:e=>{var t;n.doctype(null!==(t=e.value)&&void 0!==t?t:"")},4:e=>{var t;n.cdata(null!==(t=e.value)&&void 0!==t?t:"")},11:e=>{let t=e;if(t=t.firstChild)do walk(t);while(t=t.next)}};n.reset();let walk=e=>{var o;let l=i[e.type];if(l)l(e);else{let i=e.name,l=i in t.getVoidElements(),s=e.attributes;if(a&&s&&s.length>1){let n=[];n.map={};let o=t.getElementRule(e.name);if(o){for(let e=0,t=o.attributesOrder.length;e<t;e++){let t=o.attributesOrder[e];if(t in s.map){let e=s.map[t];n.map[t]=e,n.push({name:t,value:e})}}for(let e=0,t=s.length;e<t;e++){let t=s[e].name;if(!(t in n.map)){let e=s.map[t];n.map[t]=e,n.push({name:t,value:e})}}s=n}}if(n.start(i,s,l),!l){let t=e.firstChild;if(t){("pre"===i||"textarea"===i)&&3===t.type&&(null===(o=t.value)||void 0===o?void 0:o[0])==="\n"&&n.text("\n",!0);do walk(t);while(t=t.next)}n.end(i)}}};return 1!==o.type||e.inner?3===o.type?i[3](o):i[11](o):walk(o),n.getContent()}}},r3=new Set;each$e(["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"],e=>{r3.add(e)});let r5=["font","text-decoration","text-emphasis"],getStyleProps=(e,t)=>F(e.parseStyle(e.getAttrib(t,"style"))),isNonInheritableStyle=e=>r3.has(e),hasInheritableStyles=(e,t)=>forall(getStyleProps(e,t),e=>!isNonInheritableStyle(e)),getLonghandStyleProps=e=>filter$5(e,e=>exists(r5,t=>startsWith(e,t))),hasStyleConflict=(e,t,n)=>{let o=getStyleProps(e,t),a=getStyleProps(e,n),valueMismatch=o=>{var a,i;let l=null!==(a=e.getStyle(t,o))&&void 0!==a?a:"",s=null!==(i=e.getStyle(n,o))&&void 0!==i?i:"";return isNotEmpty(l)&&isNotEmpty(s)&&l!==s};return exists(o,e=>{let propExists=t=>exists(t,t=>t===e);if(!(!propExists(a)&&propExists(r5)))return valueMismatch(e);{let e=getLonghandStyleProps(a);return exists(e,valueMismatch)}})},isChar=(e,t,n)=>Optional.from(n.container()).filter(ew).exists(o=>t(o.data.charAt(n.offset()+(e?0:-1)))),r4=curry(isChar,!0,isWhiteSpace),r8=curry(isChar,!1,isWhiteSpace),isEmptyText=e=>{let t=e.container();return ew(t)&&(0===t.data.length||isZwsp$2(t.data)&&BookmarkManager.isBookmarkNode(t.parentNode))},matchesElementPosition=(e,t)=>n=>getChildNodeAtRelativeOffset(e?0:-1,n).filter(t).isSome(),isImageBlock=e=>e_(e)&&"block"===get$7(eS.fromDom(e),"display"),isCefNode=e=>eM(e)&&!isBogusAll$1(e),r6=matchesElementPosition(!0,isImageBlock),r9=matchesElementPosition(!1,isImageBlock),r7=matchesElementPosition(!0,eW),oe=matchesElementPosition(!1,eW),ot=matchesElementPosition(!0,isTable$2),on=matchesElementPosition(!1,isTable$2),or=matchesElementPosition(!0,isCefNode),oo=matchesElementPosition(!1,isCefNode),dropLast=e=>e.slice(0,-1),parentsUntil=(e,t,n)=>contains(t,e)?dropLast(parents$1(e,e=>n(e)||eq(e,t))):[],parents=(e,t)=>parentsUntil(e,t,w),parentsAndSelf=(e,t)=>[e].concat(parents(e,t)),navigateIgnoreEmptyTextNodes=(e,t,n)=>navigateIgnore(e,t,n,isEmptyText),getClosestBlock$1=(e,t)=>find$2(parentsAndSelf(eS.fromDom(t.container()),e),eY),isAtBeforeAfterBlockBoundary=(e,t,n)=>navigateIgnoreEmptyTextNodes(e,t.dom,n).forall(e=>getClosestBlock$1(t,n).fold(()=>!isInSameBlock(e,n,t.dom),o=>!isInSameBlock(e,n,t.dom)&&contains(o,eS.fromDom(e.container())))),isAtBlockBoundary=(e,t,n)=>getClosestBlock$1(t,n).fold(()=>navigateIgnoreEmptyTextNodes(e,t.dom,n).forall(e=>!isInSameBlock(e,n,t.dom)),t=>navigateIgnoreEmptyTextNodes(e,t.dom,n).isNone()),oa=curry(isAtBlockBoundary,!1),oi=curry(isAtBlockBoundary,!0),ol=curry(isAtBeforeAfterBlockBoundary,!1),os=curry(isAtBeforeAfterBlockBoundary,!0),isBr$1=e=>getElementFromPosition(e).exists(isBr$5),findBr=(e,t,n)=>{let o=filter$5(parentsAndSelf(eS.fromDom(n.container()),t),eY),a=head(o).getOr(t);return fromPosition(e,a.dom,n).filter(isBr$1)},isBeforeBr$1=(e,t)=>getElementFromPosition(t).exists(isBr$5)||findBr(!0,e,t).isSome(),isAfterBr=(e,t)=>getElementFromPrevPosition(t).exists(isBr$5)||findBr(!1,e,t).isSome(),od=curry(findBr,!1),oc=curry(findBr,!0),isInMiddleOfText=e=>CaretPosition.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd(),getClosestBlock=(e,t)=>{let n=filter$5(parentsAndSelf(eS.fromDom(t.container()),e),eY);return head(n).getOr(e)},hasSpaceBefore=(e,t)=>isInMiddleOfText(t)?r8(t):r8(t)||rk(getClosestBlock(e,t).dom,t).exists(r8),hasSpaceAfter=(e,t)=>isInMiddleOfText(t)?r4(t):r4(t)||rE(getClosestBlock(e,t).dom,t).exists(r4),isPreValue=e=>contains$2(["pre","pre-wrap"],e),isInPre=e=>getElementFromPosition(e).bind(e=>closest$4(e,ev)).exists(e=>isPreValue(get$7(e,"white-space"))),isAtBeginningOfBody=(e,t)=>rk(e.dom,t).isNone(),isAtEndOfBody=(e,t)=>rE(e.dom,t).isNone(),isAtLineBoundary=(e,t)=>isAtBeginningOfBody(e,t)||isAtEndOfBody(e,t)||oa(e,t)||oi(e,t)||isAfterBr(e,t)||isBeforeBr$1(e,t),isCefBlock=e=>isNonNullable(e)&&eM(e)&&rC(e),isSiblingCefBlock=(e,t)=>n=>isCefBlock(new DomTreeWalker(n,e)[t]()),isBeforeCefBlock=(e,t)=>{let n=rE(e.dom,t).getOr(t),o=isSiblingCefBlock(e.dom,"next");return t.isAtEnd()&&(o(t.container())||o(n.container()))},isAfterCefBlock=(e,t)=>{let n=rk(e.dom,t).getOr(t),o=isSiblingCefBlock(e.dom,"prev");return t.isAtStart()&&(o(t.container())||o(n.container()))},needsToHaveNbsp=(e,t)=>!isInPre(t)&&(isAtLineBoundary(e,t)||hasSpaceBefore(e,t)||hasSpaceAfter(e,t)),needsToBeNbspLeft=(e,t)=>!isInPre(t)&&(oa(e,t)||ol(e,t)||isAfterBr(e,t)||hasSpaceBefore(e,t)||isAfterCefBlock(e,t)),leanRight=e=>{let t=e.container(),n=e.offset();return ew(t)&&n<t.data.length?CaretPosition(t,n+1):e},needsToBeNbspRight=(e,t)=>!isInPre(t)&&(oi(e,t)||os(e,t)||isBeforeBr$1(e,t)||hasSpaceAfter(e,t)||isBeforeCefBlock(e,t)),needsToBeNbsp=(e,t)=>needsToBeNbspLeft(e,t)||needsToBeNbspRight(e,leanRight(t)),isNbspAt=(e,t)=>isNbsp(e.charAt(t)),isWhiteSpaceAt=(e,t)=>isWhiteSpace(e.charAt(t)),hasNbsp=e=>{let t=e.container();return ew(t)&&contains$1(t.data,"\xa0")},normalizeNbspMiddle=e=>{let t=e.split("");return map$3(t,(e,n)=>isNbsp(e)&&n>0&&n<t.length-1&&isContent(t[n-1])&&isContent(t[n+1])?" ":e).join("")},normalizeNbspAtStart=(e,t,n)=>{let o=t.data,a=CaretPosition(t,0);return!n&&isNbspAt(o,0)&&!needsToBeNbsp(e,a)?(t.data=" "+o.slice(1),!0):!!(n&&isWhiteSpaceAt(o,0)&&needsToBeNbspLeft(e,a))&&(t.data="\xa0"+o.slice(1),!0)},normalizeNbspInMiddleOfTextNode=e=>{let t=e.data,n=normalizeNbspMiddle(t);return n!==t&&(e.data=n,!0)},normalizeNbspAtEnd=(e,t,n)=>{let o=t.data,a=CaretPosition(t,o.length-1);return!n&&isNbspAt(o,o.length-1)&&!needsToBeNbsp(e,a)?(t.data=o.slice(0,-1)+" ",!0):!!(n&&isWhiteSpaceAt(o,o.length-1)&&needsToBeNbspRight(e,a))&&(t.data=o.slice(0,-1)+"\xa0",!0)},normalizeNbsps=(e,t)=>{let n=t.container();if(!ew(n))return Optional.none();if(hasNbsp(t)){let o=normalizeNbspAtStart(e,n,!1)||normalizeNbspInMiddleOfTextNode(n)||normalizeNbspAtEnd(e,n,!1);return someIf(o,t)}if(!needsToBeNbsp(e,t))return Optional.none();{let o=normalizeNbspAtStart(e,n,!0)||normalizeNbspAtEnd(e,n,!0);return someIf(o,t)}},normalizeNbspsInEditor=e=>{let t=eS.fromDom(e.getBody());e.selection.isCollapsed()&&normalizeNbsps(t,CaretPosition.fromRangeStart(e.selection.getRng())).each(t=>{e.selection.setRng(t.toRange())})},normalize$1=(e,t,n)=>{if(0===n)return;let o=eS.fromDom(e),a=ancestor$4(o,eY).getOr(o),i=e.data.slice(t,t+n),l=t+n>=e.data.length&&needsToBeNbspRight(a,CaretPosition(e,e.data.length)),s=0===t&&needsToBeNbspLeft(a,CaretPosition(e,0));e.replaceData(t,n,normalize$4(i,4,s,l))},normalizeWhitespaceAfter=(e,t)=>{let n=e.data.slice(t),o=n.length-z(n).length;normalize$1(e,t,o)},normalizeWhitespaceBefore=(e,t)=>{let n=e.data.slice(0,t),o=n.length-W(n).length;normalize$1(e,t-o,o)},mergeTextNodes=(e,t,n,o=!0)=>{let a=W(e.data).length,i=o?e:t,l=o?t:e;return o?i.appendData(l.data):i.insertData(0,l.data),remove$5(eS.fromDom(l)),n&&normalizeWhitespaceAfter(i,a),i},needsReposition=(e,t)=>{let n=e.container(),o=e.offset();return!CaretPosition.isTextPosition(e)&&n===t.parentNode&&o>CaretPosition.before(t).offset()},reposition=(e,t)=>needsReposition(t,e)?CaretPosition(t.container(),t.offset()-1):t,beforeOrStartOf=e=>ew(e)?CaretPosition(e,0):CaretPosition.before(e),afterOrEndOf=e=>ew(e)?CaretPosition(e,e.data.length):CaretPosition.after(e),getPreviousSiblingCaretPosition=e=>isCaretCandidate$3(e.previousSibling)?Optional.some(afterOrEndOf(e.previousSibling)):e.previousSibling?rS(e.previousSibling):Optional.none(),getNextSiblingCaretPosition=e=>isCaretCandidate$3(e.nextSibling)?Optional.some(beforeOrStartOf(e.nextSibling)):e.nextSibling?r$(e.nextSibling):Optional.none(),findCaretPositionBackwardsFromElm=(e,t)=>Optional.from(t.previousSibling?t.previousSibling:t.parentNode).bind(t=>rk(e,CaretPosition.before(t))).orThunk(()=>rE(e,CaretPosition.after(t))),findCaretPositionForwardsFromElm=(e,t)=>rE(e,CaretPosition.after(t)).orThunk(()=>rk(e,CaretPosition.before(t))),findCaretPositionBackwards=(e,t)=>getPreviousSiblingCaretPosition(t).orThunk(()=>getNextSiblingCaretPosition(t)).orThunk(()=>findCaretPositionBackwardsFromElm(e,t)),findCaretPositionForward=(e,t)=>getNextSiblingCaretPosition(t).orThunk(()=>getPreviousSiblingCaretPosition(t)).orThunk(()=>findCaretPositionForwardsFromElm(e,t)),findCaretPosition=(e,t,n)=>e?findCaretPositionForward(t,n):findCaretPositionBackwards(t,n),findCaretPosOutsideElmAfterDelete=(e,t,n)=>findCaretPosition(e,t,n).map(curry(reposition,n)),setSelection$1=(e,t,n)=>{n.fold(()=>{e.focus()},n=>{e.selection.setRng(n.toRange(),t)})},eqRawNode=e=>t=>t.dom===e,isBlock=(e,t)=>t&&has$2(e.schema.getBlockElements(),name(t)),paddEmptyBlock=e=>{if(!isEmpty$2(e))return Optional.none();{let t=eS.fromHtml('<br data-mce-bogus="1">');return empty(e),append$1(e,t),Optional.some(CaretPosition.before(t.dom))}},deleteNormalized=(e,t,n)=>{let o=prevSibling(e).filter(eE),a=nextSibling(e).filter(eE);return remove$5(e),lift3(o,a,t,(e,t,o)=>{let a=e.dom,i=t.dom,l=a.data.length;return mergeTextNodes(a,i,n),o.container()===i?CaretPosition(a,l):o}).orThunk(()=>(n&&(o.each(e=>normalizeWhitespaceBefore(e.dom,e.dom.length)),a.each(e=>normalizeWhitespaceAfter(e.dom,0))),t))},isInlineElement=(e,t)=>has$2(e.schema.getTextInlineElements(),name(t)),deleteElement$2=(e,t,n,o=!0)=>{let a=findCaretPosOutsideElmAfterDelete(t,e.getBody(),n.dom),i=ancestor$4(n,curry(isBlock,e),eqRawNode(e.getBody())),l=deleteNormalized(n,a,isInlineElement(e,n));e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):i.bind(paddEmptyBlock).fold(()=>{o&&setSelection$1(e,t,l)},n=>{o&&setSelection$1(e,t,Optional.some(n))})},om=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,hasStrongRtl=e=>om.test(e),isInlineTarget=(e,t)=>is$1(eS.fromDom(t),ny(e))&&!isTransparentBlock(e.schema,t)&&e.dom.isEditable(t),isRtl=e=>{var t;return"rtl"===DOMUtils.DOM.getStyle(e,"direction",!0)||hasStrongRtl(null!==(t=e.textContent)&&void 0!==t?t:"")},findInlineParents=(e,t,n)=>filter$5(DOMUtils.DOM.getParents(n.container(),"*",t),e),findRootInline=(e,t,n)=>{let o=findInlineParents(e,t,n);return Optional.from(o[o.length-1])},hasSameParentBlock=(e,t,n)=>{let o=getParentBlock$3(t,e),a=getParentBlock$3(n,e);return isNonNullable(o)&&o===a},isAtZwsp=e=>isBeforeInline(e)||isAfterInline(e),normalizePosition=(e,t)=>{let n=t.container(),o=t.offset();return e?isCaretContainerInline(n)?ew(n.nextSibling)?CaretPosition(n.nextSibling,0):CaretPosition.after(n):isBeforeInline(t)?CaretPosition(n,o+1):t:isCaretContainerInline(n)?ew(n.previousSibling)?CaretPosition(n.previousSibling,n.previousSibling.data.length):CaretPosition.before(n):isAfterInline(t)?CaretPosition(n,o-1):t},ou=curry(normalizePosition,!0),op=curry(normalizePosition,!1),execCommandIgnoreInputEvents=(e,t)=>{let inputBlocker=e=>e.stopImmediatePropagation();e.on("beforeinput input",inputBlocker,!0),e.getDoc().execCommand(t),e.off("beforeinput input",inputBlocker)},execEditorDeleteCommand=e=>{e.execCommand("delete")},execNativeDeleteCommand=e=>execCommandIgnoreInputEvents(e,"Delete"),execNativeForwardDeleteCommand=e=>execCommandIgnoreInputEvents(e,"ForwardDelete"),isBeforeRoot=e=>t=>is$2(parent(t),e,eq),isTextBlockOrListItem=e=>eX(e)||eQ(e),getParentBlock$2=(e,t)=>contains(e,t)?closest$4(t,isTextBlockOrListItem,isBeforeRoot(e)):Optional.none(),paddEmptyBody=(e,t=!0)=>{e.dom.isEmpty(e.getBody())&&e.setContent("",{no_selection:!t})},willDeleteLastPositionInElement=(e,t,n)=>lift2(r$(n),rS(n),(o,a)=>{let i=normalizePosition(!0,o),l=normalizePosition(!1,a),s=normalizePosition(!1,t);return e?rE(n,s).exists(e=>e.isEqual(l)&&t.isEqual(i)):rk(n,s).exists(e=>e.isEqual(i)&&t.isEqual(l))}).getOr(!0),freefallRtl=e=>{let t=isComment$1(e)?prevSibling(e):lastChild(e);return t.bind(freefallRtl).orThunk(()=>Optional.some(e))},deleteRangeContents=(e,t,n,o=!0)=>{var a;t.deleteContents();let i=freefallRtl(n).getOr(n),l=eS.fromDom(null!==(a=e.dom.getParent(i.dom,e.dom.isBlock))&&void 0!==a?a:n.dom);if(l.dom===e.getBody()?paddEmptyBody(e,o):isEmpty$2(l)&&(fillWithPaddingBr(l),o&&e.selection.setCursorLocation(l.dom,0)),!eq(n,l)){let e=is$2(parent(l),n)?[]:siblings(l);each$e(e.concat(children$1(n)),e=>{!eq(e,l)&&!contains(e,l)&&isEmpty$2(e)&&remove$5(e)})}},isRootFromElement=e=>t=>eq(e,t),getTableCells=e=>descendants(e,"td,th"),getTableDetailsFromRange=(e,t)=>{let getTable=e=>getClosestTable(eS.fromDom(e),t),n=getTable(e.startContainer),o=getTable(e.endContainer),a=n.isSome(),i=o.isSome(),l=lift2(n,o,eq).getOr(!1);return{startTable:n,endTable:o,isStartInTable:a,isEndInTable:i,isSameTable:l,isMultiTable:!l&&a&&i}},tableCellRng=(e,t)=>({start:e,end:t}),tableSelection=(e,t,n)=>({rng:e,table:t,cells:n}),og=tq.generate([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]),getClosestCell$1=(e,t)=>closest$3(eS.fromDom(e),"td,th",t),isExpandedCellRng=e=>!eq(e.start,e.end),getTableFromCellRng=(e,t)=>getClosestTable(e.start,t).bind(n=>getClosestTable(e.end,t).bind(e=>someIf(eq(n,e),n))),isSingleCellTable=(e,t)=>!isExpandedCellRng(e)&&getTableFromCellRng(e,t).exists(e=>{let t=e.dom.rows;return 1===t.length&&1===t[0].cells.length}),getCellRng=(e,t)=>{let n=getClosestCell$1(e.startContainer,t),o=getClosestCell$1(e.endContainer,t);return lift2(n,o,tableCellRng)},getCellRangeFromStartTable=e=>t=>getClosestTable(t,e).bind(e=>last$3(getTableCells(e)).map(e=>tableCellRng(t,e))),getCellRangeFromEndTable=e=>t=>getClosestTable(t,e).bind(e=>head(getTableCells(e)).map(e=>tableCellRng(e,t))),getTableSelectionFromCellRng=e=>t=>getTableFromCellRng(t,e).map(e=>tableSelection(t,e,getTableCells(e))),getTableSelections=(e,t,n,o)=>{if(n.collapsed||!e.forall(isExpandedCellRng))return Optional.none();if(t.isSameTable){let t=e.bind(getTableSelectionFromCellRng(o));return Optional.some({start:t,end:t})}{let e=getClosestCell$1(n.startContainer,o),t=getClosestCell$1(n.endContainer,o),a=e.bind(getCellRangeFromStartTable(o)).bind(getTableSelectionFromCellRng(o)),i=t.bind(getCellRangeFromEndTable(o)).bind(getTableSelectionFromCellRng(o));return Optional.some({start:a,end:i})}},getCellIndex=(e,t)=>findIndex$2(e,e=>eq(e,t)),getSelectedCells=e=>lift2(getCellIndex(e.cells,e.rng.start),getCellIndex(e.cells,e.rng.end),(t,n)=>e.cells.slice(t,n+1)),isSingleCellTableContentSelected=(e,t,n)=>e.exists(e=>isSingleCellTable(e,n)&&hasAllContentsSelected(e.start,t)),unselectCells=(e,t)=>{let{startTable:n,endTable:o}=t,a=e.cloneRange();return n.each(e=>a.setStartAfter(e.dom)),o.each(e=>a.setEndBefore(e.dom)),a},handleSingleTable=(e,t,n,o)=>getTableSelections(e,t,n,o).bind(({start:e,end:t})=>e.or(t)).bind(e=>{let{isSameTable:o}=t,a=getSelectedCells(e).getOr([]);if(o&&e.cells.length===a.length)return Optional.some(og.fullTable(e.table));if(!(a.length>0))return Optional.none();if(o)return Optional.some(og.partialTable(a,Optional.none()));{let e=unselectCells(n,t);return Optional.some(og.partialTable(a,Optional.some({...t,rng:e})))}}),handleMultiTable=(e,t,n,o)=>getTableSelections(e,t,n,o).bind(({start:e,end:o})=>{let a=e.bind(getSelectedCells).getOr([]),i=o.bind(getSelectedCells).getOr([]);if(!(a.length>0)||!(i.length>0))return Optional.none();{let e=unselectCells(n,t);return Optional.some(og.multiTable(a,i,e))}}),getActionFromRange=(e,t)=>{let n=isRootFromElement(e),o=getCellRng(t,n),a=getTableDetailsFromRange(t,n);return isSingleCellTableContentSelected(o,t,n)?o.map(e=>og.singleCellTable(t,e.start)):a.isMultiTable?handleMultiTable(o,a,t,n):handleSingleTable(o,a,t,n)},cleanCells=e=>each$e(e,e=>{remove$a(e,"contenteditable"),fillWithPaddingBr(e)}),getOutsideBlock=(e,t)=>Optional.from(e.dom.getParent(t,e.dom.isBlock)).map(eS.fromDom),handleEmptyBlock=(e,t,n)=>{n.each(n=>{t?remove$5(n):(fillWithPaddingBr(n),e.selection.setCursorLocation(n.dom,0))})},deleteContentInsideCell=(e,t,n,o)=>{let a=n.cloneRange();o?(a.setStart(n.startContainer,n.startOffset),a.setEndAfter(t.dom.lastChild)):(a.setStartBefore(t.dom.firstChild),a.setEnd(n.endContainer,n.endOffset)),deleteCellContents(e,a,t,!1).each(e=>e())},collapseAndRestoreCellSelection=e=>{let t=getCellsFromEditor(e),n=eS.fromDom(e.selection.getNode());eU(n.dom)&&isEmpty$2(n)?e.selection.setCursorLocation(n.dom,0):e.selection.collapse(!0),t.length>1&&exists(t,e=>eq(e,n))&&set$3(n,"data-mce-selected","1")},emptySingleTableCells=(e,t,n)=>Optional.some(()=>{let o=e.selection.getRng(),a=n.bind(({rng:n,isStartInTable:a})=>{let i=getOutsideBlock(e,a?n.endContainer:n.startContainer);n.deleteContents(),handleEmptyBlock(e,a,i.filter(isEmpty$2));let l=a?t[0]:t[t.length-1];return(deleteContentInsideCell(e,l,o,a),isEmpty$2(l))?Optional.none():Optional.some(a?t.slice(1):t.slice(0,-1))}).getOr(t);cleanCells(a),collapseAndRestoreCellSelection(e)}),emptyMultiTableCells=(e,t,n,o)=>Optional.some(()=>{let a=e.selection.getRng(),i=t[0],l=n[n.length-1];deleteContentInsideCell(e,i,a,!0),deleteContentInsideCell(e,l,a,!1);let s=isEmpty$2(i)?t:t.slice(1),d=isEmpty$2(l)?n:n.slice(0,-1);cleanCells(s.concat(d)),o.deleteContents(),collapseAndRestoreCellSelection(e)}),deleteCellContents=(e,t,n,o=!0)=>Optional.some(()=>{deleteRangeContents(e,t,n,o)}),deleteTableElement=(e,t)=>Optional.some(()=>deleteElement$2(e,!1,t)),deleteCellRange=(e,t,n)=>getActionFromRange(t,n).bind(t=>t.fold(curry(deleteCellContents,e),curry(deleteTableElement,e),curry(emptySingleTableCells,e),curry(emptyMultiTableCells,e))),deleteCaptionRange=(e,t)=>emptyElement(e,t),deleteTableRange=(e,t,n,o)=>getParentCaption(t,o).fold(()=>deleteCellRange(e,t,n),t=>deleteCaptionRange(e,t)),deleteRange$3=(e,t,n)=>{let o=eS.fromDom(e.getBody()),a=e.selection.getRng();return 0!==n.length?emptySingleTableCells(e,n,Optional.none()):deleteTableRange(e,o,a,t)},getParentCell=(e,t)=>find$2(parentsAndSelf(t,e),e0),getParentCaption=(e,t)=>find$2(parentsAndSelf(t,e),isTag("caption")),deleteBetweenCells=(e,t,n,o,a)=>navigate(n,e.getBody(),a).bind(e=>getParentCell(t,eS.fromDom(e.getNode())).bind(e=>eq(e,o)?Optional.none():Optional.some(noop))),emptyElement=(e,t)=>Optional.some(()=>{fillWithPaddingBr(t),e.selection.setCursorLocation(t.dom,0)}),isDeleteOfLastCharPos=(e,t,n,o)=>r$(e.dom).bind(a=>rS(e.dom).map(e=>t?n.isEqual(a)&&o.isEqual(e):n.isEqual(e)&&o.isEqual(a))).getOr(!0),emptyCaretCaption=(e,t)=>emptyElement(e,t),validateCaretCaption=(e,t,n)=>getParentCaption(e,eS.fromDom(n.getNode())).fold(()=>Optional.some(noop),e=>someIf(!eq(e,t),noop)),deleteCaretInsideCaption=(e,t,n,o,a)=>navigate(n,e.getBody(),a).fold(()=>Optional.some(noop),i=>isDeleteOfLastCharPos(o,n,a,i)?emptyCaretCaption(e,o):validateCaretCaption(t,o,i)),deleteCaretCells=(e,t,n,o)=>{let a=CaretPosition.fromRangeStart(e.selection.getRng());return getParentCell(n,o).bind(o=>isEmpty$2(o)?emptyElement(e,o):deleteBetweenCells(e,n,t,o,a))},deleteCaretCaption=(e,t,n,o)=>{let a=CaretPosition.fromRangeStart(e.selection.getRng());return isEmpty$2(o)?emptyElement(e,o):deleteCaretInsideCaption(e,n,t,o,a)},isNearTable=(e,t)=>e?ot(t):on(t),isBeforeOrAfterTable=(e,t)=>{let n=CaretPosition.fromRangeStart(e.selection.getRng());return isNearTable(t,n)||fromPosition(t,e.getBody(),n).exists(e=>isNearTable(t,e))},deleteCaret$3=(e,t,n)=>{let o=eS.fromDom(e.getBody());return getParentCaption(o,n).fold(()=>deleteCaretCells(e,t,o,n).orThunk(()=>someIf(isBeforeOrAfterTable(e,t),noop)),n=>deleteCaretCaption(e,t,o,n))},backspaceDelete$a=(e,t)=>{let n=eS.fromDom(e.selection.getStart(!0)),o=getCellsFromEditor(e);return e.selection.isCollapsed()&&0===o.length?deleteCaret$3(e,t,n):deleteRange$3(e,n,o)},getContentEditableRoot$1=(e,t)=>{let n=t;for(;n&&n!==e;){if(eL(n)||eM(n))return n;n=n.parentNode}return null},of=["data-ephox-","data-mce-","data-alloy-","data-snooker-","_"],oh=eb.each,ElementUtils=e=>{let t=e.dom,n=new Set(e.serializer.getTempAttrs()),isAttributeInternal=e=>exists(of,t=>startsWith(e,t))||n.has(e);return{compare:(e,n)=>{if(e.nodeName!==n.nodeName||e.nodeType!==n.nodeType)return!1;let getAttribs=e=>{let n={};return oh(t.getAttribs(e),o=>{let a=o.nodeName.toLowerCase();"style"===a||isAttributeInternal(a)||(n[a]=t.getAttrib(e,a))}),n},compareObjects=(e,t)=>{for(let n in e)if(has$2(e,n)){let o=t[n];if(P(o)||e[n]!==o)return!1;delete t[n]}for(let e in t)if(has$2(t,e))return!1;return!0};return(!(eR(e)&&eR(n))||!!compareObjects(getAttribs(e),getAttribs(n))&&!!compareObjects(t.parseStyle(t.getAttrib(e,"style")),t.parseStyle(t.getAttrib(n,"style"))))&&!isBookmarkNode$1(e)&&!isBookmarkNode$1(n)},isAttributeInternal}},traverse=(e,t)=>{let n=e;for(;n=n.walk();)t(n)},matchNode$1=(e,t,n,o)=>{let a=n.name;for(let t=0,i=e.length;t<i;t++){let i=e[t];if(i.name===a){let e=o.nodes[a];e?e.nodes.push(n):o.nodes[a]={filter:i,nodes:[n]}}}if(n.attributes)for(let e=0,a=t.length;e<a;e++){let a=t[e],i=a.name;if(i in n.attributes.map){let e=o.attributes[i];e?e.nodes.push(n):o.attributes[i]={filter:a,nodes:[n]}}}},findMatchingNodes=(e,t,n)=>{let o={nodes:{},attributes:{}};return n.firstChild&&traverse(n,n=>{matchNode$1(e,t,n,o)}),o},runFilters=(e,t)=>{let run=(e,n)=>{each$d(e,e=>{let o=I(e.nodes);each$e(e.filter.callbacks,a=>{for(let t=o.length-1;t>=0;t--){let a=o[t],i=n?void 0!==a.attr(e.filter.name):a.name===e.filter.name;(!i||isNullable(a.parent))&&o.splice(t,1)}o.length>0&&a(o,e.filter.name,t)})})};run(e.nodes,!1),run(e.attributes,!0)},filter$2=(e,t,n,o={})=>{let a=findMatchingNodes(e,t,n);runFilters(a,o)},paddEmptyNode=(e,t,n,o)=>{let a=e.pad_empty_with_br||t.insert;if(a&&n(o)){let e=new AstNode("br",1);t.insert&&e.attr("data-mce-bogus","1"),o.empty().append(e)}else o.empty().append(new AstNode("#text",3)).value="\xa0"},isPaddedWithNbsp=e=>{var t;return hasOnlyChild(e,"#text")&&(null===(t=null==e?void 0:e.firstChild)||void 0===t?void 0:t.value)==="\xa0"},hasOnlyChild=(e,t)=>{let n=null==e?void 0:e.firstChild;return isNonNullable(n)&&n===e.lastChild&&n.name===t},isPadded=(e,t)=>{let n=e.getElementRule(t.name);return(null==n?void 0:n.paddEmpty)===!0},isEmpty=(e,t,n,o)=>o.isEmpty(t,n,t=>isPadded(e,t)),isLineBreakNode=(e,t)=>isNonNullable(e)&&(t(e)||"br"===e.name),findClosestEditingHost=e=>{let t;for(let n=e;n;n=n.parent){let e=n.attr("contenteditable");if("false"===e)break;"true"===e&&(t=n)}return Optional.from(t)},removeOrUnwrapInvalidNode=(e,t,n=e.parent)=>{if(t.getSpecialElements()[e.name])e.empty().remove();else{let o=e.children();for(let e of o)n&&!t.isValidChild(n.name,e.name)&&removeOrUnwrapInvalidNode(e,t,n);e.unwrap()}},cleanInvalidNodes=(e,t,n,o=noop)=>{let a=t.getTextBlockElements(),i=t.getNonEmptyElements(),l=t.getWhitespaceElements(),s=eb.makeMap("tr,td,th,tbody,thead,tfoot,table,summary"),d=new Set,isSplittableElement=e=>e!==n&&!s[e.name];for(let n=0;n<e.length;n++){let s,c,m;let u=e[n];if(!u.parent||d.has(u))continue;if(a[u.name]&&"li"===u.parent.name){let e=u.next;for(;e&&a[e.name];)e.name="li",d.add(e),u.parent.insert(e,u.parent),e=e.next;u.unwrap();continue}let p=[u];for(s=u.parent;s&&!t.isValidChild(s.name,u.name)&&isSplittableElement(s);s=s.parent)p.push(s);if(s&&p.length>1){if(t.isValidChild(s.name,u.name)){p.reverse(),o(c=p[0].clone());let e=c;for(let n=0;n<p.length-1;n++){t.isValidChild(e.name,p[n].name)&&n>0?(o(m=p[n].clone()),e.append(m)):m=e;for(let e=p[n].firstChild;e&&e!==p[n+1];){let t=e.next;m.append(e),e=t}e=m}isEmpty(t,i,l,c)?s.insert(u,p[0],!0):(s.insert(c,p[0],!0),s.insert(u,c)),(isEmpty(t,i,l,s=p[0])||hasOnlyChild(s,"br"))&&s.empty().remove()}else removeOrUnwrapInvalidNode(u,t)}else if(u.parent){if("li"===u.name){let e=u.prev;if(e&&("ul"===e.name||"ol"===e.name)){e.append(u);continue}if((e=u.next)&&("ul"===e.name||"ol"===e.name)&&e.firstChild){e.insert(u,e.firstChild,!0);continue}let t=new AstNode("ul",1);o(t),u.wrap(t);continue}if(t.isValidChild(u.parent.name,"div")&&t.isValidChild("div",u.name)){let e=new AstNode("div",1);o(e),u.wrap(e)}else removeOrUnwrapInvalidNode(u,t)}}},hasClosest=(e,t)=>{let n=e;for(;n;){if(n.name===t)return!0;n=n.parent}return!1},isInvalid=(e,t,n=t.parent)=>!!n&&!!e.children[t.name]&&!e.isValidChild(n.name,t.name)||!!(n&&"a"===t.name&&hasClosest(n,"a")),createRange=(e,t,n,o)=>{let a=document.createRange();return a.setStart(e,t),a.setEnd(n,o),a},normalizeBlockSelectionRange=e=>{let t=CaretPosition.fromRangeStart(e),n=CaretPosition.fromRangeEnd(e),o=e.commonAncestorContainer;return fromPosition(!1,o,n).map(a=>!isInSameBlock(t,n,o)&&isInSameBlock(t,a,o)?createRange(t.container(),t.offset(),a.container(),a.offset()):e).getOr(e)},normalize=e=>e.collapsed?e:normalizeBlockSelectionRange(e),hasOnlyOneChild$1=e=>isNonNullable(e.firstChild)&&e.firstChild===e.lastChild,isPaddingNode=e=>"br"===e.name||"\xa0"===e.value,isPaddedEmptyBlock=(e,t)=>{let n=e.getBlockElements();return n[t.name]&&hasOnlyOneChild$1(t)&&isPaddingNode(t.firstChild)},isEmptyFragmentElement=(e,t)=>{let n=e.getNonEmptyElements();return isNonNullable(t)&&(t.isEmpty(n)||isPaddedEmptyBlock(e,t))},isListFragment=(e,t)=>{let n=t.firstChild,o=t.lastChild;return n&&"meta"===n.name&&(n=n.next),o&&"mce_marker"===o.attr("id")&&(o=o.prev),isEmptyFragmentElement(e,o)&&(o=null==o?void 0:o.prev),!!n&&n===o&&("ul"===n.name||"ol"===n.name)},cleanupDomFragment=e=>{var t,n;let o=e.firstChild,a=e.lastChild;return o&&"META"===o.nodeName&&(null===(t=o.parentNode)||void 0===t||t.removeChild(o)),a&&"mce_marker"===a.id&&(null===(n=a.parentNode)||void 0===n||n.removeChild(a)),e},toDomFragment=(e,t,n)=>{let o=t.serialize(n),a=e.createFragment(o);return cleanupDomFragment(a)},listItems=e=>{var t;return filter$5(null!==(t=null==e?void 0:e.childNodes)&&void 0!==t?t:[],e=>"LI"===e.nodeName)},isPadding=e=>"\xa0"===e.data||eF(e),isListItemPadded=e=>isNonNullable(null==e?void 0:e.firstChild)&&e.firstChild===e.lastChild&&isPadding(e.firstChild),isEmptyOrPadded=e=>!e.firstChild||isListItemPadded(e),trimListItems=e=>e.length>0&&isEmptyOrPadded(e[e.length-1])?e.slice(0,-1):e,getParentLi=(e,t)=>{let n=e.getParent(t,e.isBlock);return n&&"LI"===n.nodeName?n:null},isParentBlockLi=(e,t)=>!!getParentLi(e,t),getSplit=(e,t)=>{let n=t.cloneRange(),o=t.cloneRange();return n.setStartBefore(e),o.setEndAfter(e),[n.cloneContents(),o.cloneContents()]},findFirstIn=(e,t)=>{let n=CaretPosition.before(e),o=CaretWalker(t),a=o.next(n);return a?a.toRange():null},findLastOf=(e,t)=>{let n=CaretPosition.after(e),o=CaretWalker(t),a=o.prev(n);return a?a.toRange():null},insertMiddle=(e,t,n,o)=>{let a=getSplit(e,o),i=e.parentNode;return i&&(i.insertBefore(a[0],e),eb.each(t,t=>{i.insertBefore(t,e)}),i.insertBefore(a[1],e),i.removeChild(e)),findLastOf(t[t.length-1],n)},insertBefore$2=(e,t,n)=>{let o=e.parentNode;return o&&eb.each(t,t=>{o.insertBefore(t,e)}),findFirstIn(e,n)},insertAfter$2=(e,t,n,o)=>(o.insertAfter(t.reverse(),e),findLastOf(t[0],n)),insertAtCaret$1=(e,t,n,o)=>{let a=toDomFragment(t,e,o),i=getParentLi(t,n.startContainer),l=trimListItems(listItems(a.firstChild)),s=t.getRoot(),isAt=e=>{let o=CaretPosition.fromRangeStart(n),a=CaretWalker(t.getRoot()),l=1===e?a.prev(o):a.next(o),s=null==l?void 0:l.getNode();return!s||getParentLi(t,s)!==i};return i?isAt(1)?insertBefore$2(i,l,s):isAt(2)?insertAfter$2(i,l,s,t):insertMiddle(i,l,s,n):null},ob=["pre"],shouldPasteContentOnly=(e,t,n,o)=>{var a;let i=t.firstChild,l=t.lastChild,s="bookmark"===l.attr("data-mce-type")?l.prev:l,d=contains$2(ob,i.name);if(i!==s||!d)return!1;{let t="false"!==i.attr("contenteditable"),l=(null===(a=e.getParent(n,e.isBlock))||void 0===a?void 0:a.nodeName.toLowerCase())===i.name,s=Optional.from(getContentEditableRoot$1(o,n)).forall(eL);return t&&l&&s}},isTableCellContentSelected=(e,t,n)=>{if(!isNonNullable(n))return!1;{let o=e.getParent(t.endContainer,eU);return n===o&&hasAllContentsSelected(eS.fromDom(n),t)}},validInsertion=(e,t,n)=>{var o;if("all"===n.getAttribute("data-mce-bogus"))null===(o=n.parentNode)||void 0===o||o.insertBefore(e.dom.createFragment(t),n);else{let o=n.firstChild,a=n.lastChild;o&&(o!==a||"BR"!==o.nodeName)?e.selection.setContent(t,{no_events:!0}):e.dom.setHTML(n,t)}},trimBrsFromTableCell=(e,t)=>{Optional.from(e.getParent(t,"td,th")).map(eS.fromDom).each(trimBlockTrailingBr)},reduceInlineTextElements=(e,t)=>{let n=e.schema.getTextInlineElements(),o=e.dom;if(t){let t=e.getBody(),a=ElementUtils(e);eb.each(o.select("*[data-mce-fragment]"),e=>{let i=isNonNullable(n[e.nodeName.toLowerCase()]);if(i&&hasInheritableStyles(o,e))for(let n=e.parentElement;isNonNullable(n)&&n!==t;n=n.parentElement){let t=hasStyleConflict(o,e,n);if(t)break;if(a.compare(n,e)){o.remove(e,!0);break}}})}},markFragmentElements=e=>{let t=e;for(;t=t.walk();)1===t.type&&t.attr("data-mce-fragment","1")},unmarkFragmentElements=e=>{eb.each(e.getElementsByTagName("*"),e=>{e.removeAttribute("data-mce-fragment")})},isPartOfFragment=e=>!!e.getAttribute("data-mce-fragment"),canHaveChildren=(e,t)=>isNonNullable(t)&&!e.schema.getVoidElements()[t.nodeName],moveSelectionToMarker=(e,t)=>{var n,o,a;let i;let l=e.dom,s=e.selection;if(!t)return;s.scrollIntoView(t);let d=getContentEditableRoot$1(e.getBody(),t);if(d&&"false"===l.getContentEditable(d)){l.remove(t),s.select(d);return}let c=l.createRng(),m=t.previousSibling;if(ew(m)){c.setStart(m,null!==(o=null===(n=m.nodeValue)||void 0===n?void 0:n.length)&&void 0!==o?o:0);let e=t.nextSibling;ew(e)&&(m.appendData(e.data),null===(a=e.parentNode)||void 0===a||a.removeChild(e))}else c.setStartBefore(t),c.setEndBefore(t);let u=l.getParent(t,l.isBlock);if(l.remove(t),u&&l.isEmpty(u)){let t=eU(u);empty(eS.fromDom(u)),c.setStart(u,0),c.setEnd(u,0),!t&&!isPartOfFragment(u)&&(i=(t=>{let n=CaretPosition.fromRangeStart(t),o=CaretWalker(e.getBody());return null==(n=o.next(n))?void 0:n.toRange()})(c))?(c=i,l.remove(u)):l.add(u,l.create("br",t?{}:{"data-mce-bogus":"1"}))}s.setRng(c)},deleteSelectedContent=e=>{let t=e.dom,n=normalize(e.selection.getRng());e.selection.setRng(n);let o=t.getParent(n.startContainer,eU);isTableCellContentSelected(t,n,o)?deleteCellContents(e,n,eS.fromDom(o)):n.startContainer===n.endContainer&&n.endOffset-n.startOffset==1&&ew(n.startContainer.childNodes[n.startOffset])?n.deleteContents():e.getDoc().execCommand("Delete",!1)},findMarkerNode=e=>{for(let t=e;t;t=t.walk())if("mce_marker"===t.attr("id"))return Optional.some(t);return Optional.none()},insertHtmlAtCaret=(e,t,n)=>{var o,a;let i=e.selection,l=e.dom,s=e.parser,d=n.merge,c=HtmlSerializer({validate:!0},e.schema),m='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';-1===t.indexOf("{$caret}")&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,m);let u=i.getRng(),p=u.startContainer,g=e.getBody();p===g&&i.isCollapsed()&&l.isBlock(g.firstChild)&&canHaveChildren(e,g.firstChild)&&l.isEmpty(g.firstChild)&&((u=l.createRng()).setStart(g.firstChild,0),u.setEnd(g.firstChild,0),i.setRng(u)),i.isCollapsed()||deleteSelectedContent(e);let f=i.getNode(),h={context:f.nodeName.toLowerCase(),data:n.data,insert:!0},b=s.parse(t,h);if(!0===n.paste&&isListFragment(e.schema,b)&&isParentBlockLi(l,f))return(u=insertAtCaret$1(c,l,i.getRng(),b))&&i.setRng(u),t;!0===n.paste&&shouldPasteContentOnly(l,b,f,e.getBody())&&(null===(o=b.firstChild)||void 0===o||o.unwrap()),markFragmentElements(b);let C=b.lastChild;if(C&&"mce_marker"===C.attr("id")){let t=C;for(C=C.prev;C;C=C.walk(!0))if(3===C.type||!l.isBlock(C.name)){C.parent&&e.schema.isValidChild(C.parent.name,"span")&&C.parent.insert(t,C,"br"===C.name);break}}if(e._selectionOverrides.showBlockCaretContainer(f),h.invalid){let n;e.selection.setContent(m);let o=i.getNode(),d=e.getBody();for(eD(o)?o=n=d:n=o;n&&n!==d;)o=n,n=n.parentNode;t=o===d?d.innerHTML:l.getOuterHTML(o);let u=s.parse(t),p=findMarkerNode(u),g=p.bind(findClosestEditingHost).getOr(u);p.each(e=>e.replace(b));let f=b.children(),h=null!==(a=b.parent)&&void 0!==a?a:u;b.unwrap();let C=filter$5(f,t=>isInvalid(e.schema,t,h));cleanInvalidNodes(C,e.schema,g),filter$2(s.getNodeFilters(),s.getAttributeFilters(),u),t=c.serialize(u),o===d?l.setHTML(d,t):l.setOuterHTML(o,t)}else validInsertion(e,t=c.serialize(b),f);return reduceInlineTextElements(e,d),moveSelectionToMarker(e,l.get("mce_marker")),unmarkFragmentElements(e.getBody()),trimBrsFromTableCell(l,i.getStart()),updateCaret(e.schema,e.getBody(),i.getStart()),t},isTreeNode=e=>e instanceof AstNode,moveSelection=e=>{hasFocus(e)&&r$(e.getBody()).each(t=>{let n=t.getNode(),o=isTable$2(n)?r$(n).getOr(t):t;e.selection.setRng(o.toRange())})},setEditorHtml=(e,t,n)=>{e.dom.setHTML(e.getBody(),t),!0!==n&&moveSelection(e)},setContentString=(e,t,n,o)=>{if(0===n.length||/^\s+$/.test(n)){let a='<br data-mce-bogus="1">';"TABLE"===t.nodeName?n="<tr><td>"+a+"</td></tr>":/^(UL|OL)$/.test(t.nodeName)&&(n="<li>"+a+"</li>");let i=t2(e);return e.schema.isValidChild(t.nodeName.toLowerCase(),i.toLowerCase())?(n=a,n=e.dom.createHTML(i,t3(e),n)):n||(n=a),setEditorHtml(e,n,o.no_selection),{content:n,html:n}}{"raw"!==o.format&&(n=HtmlSerializer({validate:!1},e.schema).serialize(e.parser.parse(n,{isRootContent:!0,insert:!0})));let a=e1(eS.fromDom(t))?n:eb.trim(n);return setEditorHtml(e,a,o.no_selection),{content:a,html:a}}},setContentTree=(e,t,n,o)=>{filter$2(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),n);let a=HtmlSerializer({validate:!1},e.schema).serialize(n),i=e1(eS.fromDom(t))?a:eb.trim(a);return setEditorHtml(e,i,o.no_selection),{content:n,html:i}},setContentInternal=(e,t,n)=>Optional.from(e.getBody()).map(o=>isTreeNode(t)?setContentTree(e,o,t,n):setContentString(e,o,t,n)).getOr({content:t,html:isTreeNode(n.content)?"":n.content}),ancestor$1=(e,t,n)=>ancestor$4(e,t,n).isSome(),sibling=(e,t)=>sibling$1(e,t).isSome(),ensureIsRoot=e=>R(e)?e:w,ancestor=(e,t,n)=>{let o=e.dom,a=ensureIsRoot(n);for(;o.parentNode;){o=o.parentNode;let e=eS.fromDom(o),n=t(e);if(n.isSome())return n;if(a(e))break}return Optional.none()},closest$1=(e,t,n)=>{let o=t(e),a=ensureIsRoot(n);return o.orThunk(()=>a(e)?Optional.none():ancestor(e,t,a))},matchesUnInheritedFormatSelector=(e,t,n)=>{let o=e.formatter.get(n);if(o)for(let n=0;n<o.length;n++){let a=o[n];if(isSelectorFormat(a)&&!1===a.inherit&&e.dom.is(t,a.selector))return!0}return!1},matchParents=(e,t,n,o,a)=>{let i=e.dom.getRoot();if(t===i)return!1;let l=e.dom.getParent(t,t=>!!matchesUnInheritedFormatSelector(e,t,n)||t.parentNode===i||!!matchNode(e,t,n,o,!0));return!!matchNode(e,l,n,o,a)},matchName=(e,t,n)=>!!(isInlineFormat(n)&&isEq$5(t,n.inline)||isBlockFormat(n)&&isEq$5(t,n.block))||!!isSelectorFormat(n)&&eR(t)&&e.is(t,n.selector),matchItems=(e,t,n,o,a,i)=>{let l=n[o],s="attributes"===o;if(R(n.onmatch))return n.onmatch(t,n,o);if(l){if(isArrayLike(l))for(let n=0;n<l.length&&(s?!e.getAttrib(t,l[n]):!getStyle(e,t,l[n]));n++);else for(let o in l)if(has$2(l,o)){let d=s?e.getAttrib(t,o):getStyle(e,t,o),c=replaceVars(l[o],i),m=isNullable(d)||isEmpty$3(d);if(m&&isNullable(c))continue;if(a&&m&&!n.exact||(!a||n.exact)&&!isEq$5(d,normalizeStyleValue(c,o)))return!1}}return!0},matchNode=(e,t,n,o,a)=>{let i=e.formatter.get(n),l=e.dom;if(i&&eR(t))for(let n=0;n<i.length;n++){let s=i[n];if(matchName(e.dom,t,s)&&matchItems(l,t,s,"attributes",a,o)&&matchItems(l,t,s,"styles",a,o)){let n=s.classes;if(n){for(let a=0;a<n.length;a++)if(!e.dom.hasClass(t,replaceVars(n[a],o)))return}return s}}},match$2=(e,t,n,o,a)=>{if(o)return matchParents(e,o,t,n,a);if(o=e.selection.getNode(),matchParents(e,o,t,n,a))return!0;let i=e.selection.getStart();return!!(i!==o&&matchParents(e,i,t,n,a))},matchAll=(e,t,n)=>{let o=[],a={},i=e.selection.getStart();return e.dom.getParent(i,i=>{for(let l=0;l<t.length;l++){let s=t[l];!a[s]&&matchNode(e,i,s,n)&&(a[s]=!0,o.push(s))}},e.dom.getRoot()),o},closest=(e,t)=>{let isRoot=t=>eq(t,eS.fromDom(e.getBody())),match=(t,n)=>matchNode(e,t.dom,n)?Optional.some(n):Optional.none();return Optional.from(e.selection.getStart(!0)).bind(e=>closest$1(eS.fromDom(e),e=>findMap(t,t=>match(e,t)),isRoot)).getOrNull()},canApply=(e,t)=>{let n=e.formatter.get(t),o=e.dom;if(n&&e.selection.isEditable()){let t=e.selection.getStart(),a=getParents$2(o,t);for(let e=n.length-1;e>=0;e--){let t=n[e];if(!isSelectorFormat(t))return!0;for(let e=a.length-1;e>=0;e--)if(o.is(a[e],t.selector))return!0}}return!1},matchAllOnNode=(e,t,n)=>foldl(n,(n,o)=>{let a=isVariableFormatName(e,o);return e.formatter.matchNode(t,o,{},a)?n.concat([o]):n},[]),importNode=(e,t)=>e.importNode(t,!0),getEmptyCaretContainers=e=>{let t=[],n=e;for(;n;){if(ew(n)&&"\uFEFF"!==n.data||n.childNodes.length>1)return[];eR(n)&&t.push(n),n=n.firstChild}return t},isCaretContainerEmpty=e=>getEmptyCaretContainers(e).length>0,findFirstTextNode=e=>{if(e){let t=new DomTreeWalker(e,e);for(let e=t.current();e;e=t.next())if(ew(e))return e}return null},createCaretContainer=e=>{let t=eS.fromTag("span");return setAll$1(t,{id:rN,"data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&append$1(t,eS.fromText("\uFEFF")),t},trimZwspFromCaretContainer=e=>{let t=findFirstTextNode(e);return t&&"\uFEFF"===t.data.charAt(0)&&t.deleteData(0,1),t},removeCaretContainerNode=(e,t,n=!0)=>{let o=e.dom,a=e.selection;if(isCaretContainerEmpty(t))deleteElement$2(e,!1,eS.fromDom(t),n);else{let e=a.getRng(),n=o.getParent(t,o.isBlock),i=e.startContainer,l=e.startOffset,s=e.endContainer,d=e.endOffset,c=trimZwspFromCaretContainer(t);o.remove(t,!0),i===c&&l>0&&e.setStart(c,l-1),s===c&&d>0&&e.setEnd(c,d-1),n&&o.isEmpty(n)&&fillWithPaddingBr(eS.fromDom(n)),a.setRng(e)}},removeCaretContainer=(e,t,n=!0)=>{let o=e.dom,a=e.selection;if(t)removeCaretContainerNode(e,t,n);else if(!(t=getParentCaretContainer(e.getBody(),a.getStart())))for(;t=o.get(rN);)removeCaretContainerNode(e,t,n)},insertCaretContainerNode=(e,t,n)=>{var o,a;let i=e.dom,l=i.getParent(n,curry(isTextBlock$1,e.schema));l&&i.isEmpty(l)?null===(o=n.parentNode)||void 0===o||o.replaceChild(t,n):(removeTrailingBr(eS.fromDom(n)),i.isEmpty(n)?null===(a=n.parentNode)||void 0===a||a.replaceChild(t,n):i.insertAfter(t,n))},appendNode=(e,t)=>(e.appendChild(t),t),insertFormatNodesIntoCaretContainer=(e,t)=>{var n;let o=foldr(e,(e,t)=>appendNode(e,t.cloneNode(!1)),t),a=null!==(n=o.ownerDocument)&&void 0!==n?n:document;return appendNode(o,a.createTextNode("\uFEFF"))},cleanFormatNode=(e,t,n,o,a,i)=>{let l=e.formatter,s=e.dom,d=filter$5(F(l.get()),e=>e!==o&&!contains$1(e,"removeformat")),c=matchAllOnNode(e,n,d),m=filter$5(c,t=>!areSimilarFormats(e,t,o));if(!(m.length>0))return Optional.none();{let e=n.cloneNode(!1);return s.add(t,e),l.remove(o,a,e,i),s.remove(e),Optional.some(e)}},applyCaretFormat=(e,t,n)=>{let o;let a=e.selection,i=e.formatter.get(t);if(!i)return;let l=a.getRng(),s=l.startOffset,d=l.startContainer,c=d.nodeValue;o=getParentCaretContainer(e.getBody(),a.getStart());let m=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(c&&s>0&&s<c.length&&m.test(c.charAt(s))&&m.test(c.charAt(s-1))){let o=a.getBookmark();l.collapse(!0);let s=expandRng(e.dom,l,i);s=split(s),e.formatter.apply(t,n,s),a.moveToBookmark(o)}else{let i=o?findFirstTextNode(o):null;o&&(null==i?void 0:i.data)==="\uFEFF"||(i=(o=importNode(e.getDoc(),createCaretContainer(!0).dom)).firstChild,l.insertNode(o),s=1),e.formatter.apply(t,n,o),a.setCursorLocation(i,s)}},removeCaretFormat=(e,t,n,o)=>{let a;let i=e.dom,l=e.selection,s=!1,d=e.formatter.get(t);if(!d)return;let c=l.getRng(),m=c.startContainer,u=c.startOffset,p=m;ew(m)&&(u!==m.data.length&&(s=!0),p=p.parentNode);let g=[];for(;p;){if(matchNode(e,p,t,n,o)){a=p;break}p.nextSibling&&(s=!0),g.push(p),p=p.parentNode}if(a){if(s){let a=l.getBookmark();c.collapse(!0);let s=expandRng(i,c,d,!0);s=split(s),e.formatter.remove(t,n,s,o),l.moveToBookmark(a)}else{let s=getParentCaretContainer(e.getBody(),a),d=createCaretContainer(!1).dom;insertCaretContainerNode(e,d,null!=s?s:a);let c=cleanFormatNode(e,d,a,t,n,o),m=insertFormatNodesIntoCaretContainer(g.concat(c.toArray()),d);s&&removeCaretContainerNode(e,s,!1),l.setCursorLocation(m,1),i.isEmpty(a)&&i.remove(a)}}},disableCaretContainer=(e,t,n)=>{let o=e.selection,a=e.getBody();removeCaretContainer(e,null,n),(8===t||46===t)&&o.isCollapsed()&&"\uFEFF"===o.getStart().innerHTML&&removeCaretContainer(e,getParentCaretContainer(a,o.getStart())),(37===t||39===t)&&removeCaretContainer(e,getParentCaretContainer(a,o.getStart()))},endsWithNbsp=e=>ew(e)&&endsWith(e.data,"\xa0"),setup$u=e=>{e.on("mouseup keydown",t=>{disableCaretContainer(e,t.keyCode,endsWithNbsp(e.selection.getRng().endContainer))})},createCaretFormat=e=>{let t=createCaretContainer(!1),n=insertFormatNodesIntoCaretContainer(e,t.dom);return{caretContainer:t,caretPosition:CaretPosition(n,0)}},replaceWithCaretFormat=(e,t)=>{let{caretContainer:n,caretPosition:o}=createCaretFormat(t);return before$3(eS.fromDom(e),n),remove$5(eS.fromDom(e)),o},createCaretFormatAtStart$1=(e,t)=>{let{caretContainer:n,caretPosition:o}=createCaretFormat(t);return e.insertNode(n.dom),o},isFormatElement=(e,t)=>{let n=e.schema.getTextInlineElements();return has$2(n,name(t))&&!isCaretNode(t.dom)&&!isBogus$2(t.dom)},isEmptyCaretFormatElement=e=>isCaretNode(e.dom)&&isCaretContainerEmpty(e.dom),oC={},oy=matchNodeNames(["pre"]),postProcess$1=(e,t)=>{has$2(oC,e)&&each$e(oC[e],e=>{e(t)})};((e,t)=>{let n=oC[e];n||(oC[e]=[]),oC[e].push(t)})("pre",e=>{let t=e.selection.getRng(),joinPre=(e,t)=>{let n=eS.fromDom(t),o=documentOrOwner(n).dom;remove$5(n),append(eS.fromDom(e),[eS.fromTag("br",o),eS.fromTag("br",o),...children$1(n)])};if(!t.collapsed){let t=e.selection.getSelectedBlocks(),n=filter$5(filter$5(t,oy),e=>{let n=e.previousSibling;return oy(n)&&contains$2(t,n)});each$e(n,e=>{joinPre(e.previousSibling,e)})}});let ov=["fontWeight","fontStyle","color","fontSize","fontFamily"],hasListStyles=e=>$(e.styles)&&exists(F(e.styles),e=>contains$2(ov,e)),findExpandedListItemFormat=e=>find$2(e,e=>isInlineFormat(e)&&"span"===e.inline&&hasListStyles(e)),getExpandedListItemFormat=(e,t)=>{let n=e.get(t);return S(n)?findExpandedListItemFormat(n):Optional.none()},isRngStartAtStartOfElement=(e,t)=>rk(t,CaretPosition.fromRangeStart(e)).isNone(),isRngEndAtEndOfElement=(e,t)=>!1===rE(t,CaretPosition.fromRangeEnd(e)).exists(e=>!eF(e.getNode())||rE(t,e).isSome()),isEditableListItem=e=>t=>eH(t)&&e.isEditable(t),getFullySelectedBlocks=e=>{let t=e.getSelectedBlocks(),n=e.getRng();if(e.isCollapsed())return[];if(1===t.length)return isRngStartAtStartOfElement(n,t[0])&&isRngEndAtEndOfElement(n,t[0])?t:[];{let e=head(t).filter(e=>isRngStartAtStartOfElement(n,e)).toArray(),o=last$3(t).filter(e=>isRngEndAtEndOfElement(n,e)).toArray(),a=t.slice(1,-1);return e.concat(a).concat(o)}},getFullySelectedListItems=e=>filter$5(getFullySelectedBlocks(e),isEditableListItem(e.dom)),getPartiallySelectedListItems=e=>filter$5(e.getSelectedBlocks(),isEditableListItem(e.dom)),oE=eb.each,isElementNode=e=>eR(e)&&!isBookmarkNode$1(e)&&!isCaretNode(e)&&!isBogus$2(e),findElementSibling=(e,t)=>{for(let n=e;n&&!(ew(n)&&isNotEmpty(n.data));n=n[t])if(eR(n)&&!isBookmarkNode$1(n))return n;return e},mergeSiblingsNodes=(e,t,n)=>{let o=ElementUtils(e),a=eR(t)&&isEditable$2(t),i=eR(n)&&isEditable$2(n);if(a&&i){let a=findElementSibling(t,"previousSibling"),i=findElementSibling(n,"nextSibling");if(o.compare(a,i)){for(let e=a.nextSibling;e&&e!==i;){let t=e;e=e.nextSibling,a.appendChild(t)}return e.dom.remove(i),eb.each(eb.grep(i.childNodes),e=>{a.appendChild(e)}),a}}return n},mergeSiblings=(e,t,n,o)=>{var a;if(o&&!1!==t.merge_siblings){let t=null!==(a=mergeSiblingsNodes(e,getNonWhiteSpaceSibling(o),o))&&void 0!==a?a:o;mergeSiblingsNodes(e,t,getNonWhiteSpaceSibling(t,!0))}},clearChildStyles=(e,t,n)=>{if(t.clear_child_styles){let o=t.links?"*:not(a)":"*";oE(e.select(o,n),n=>{isElementNode(n)&&isEditable$2(n)&&oE(t.styles,(t,o)=>{e.setStyle(n,o,"")})})}},processChildElements=(e,t,n)=>{oE(e.childNodes,e=>{isElementNode(e)&&(t(e)&&n(e),e.hasChildNodes()&&processChildElements(e,t,n))})},unwrapEmptySpan=(e,t)=>{"SPAN"===t.nodeName&&0===e.getAttribs(t).length&&e.remove(t,!0)},hasStyle=(e,t)=>n=>!!(n&&getStyle(e,n,t)),applyStyle=(e,t,n)=>o=>{e.setStyle(o,t,n),""===o.getAttribute("style")&&o.removeAttribute("style"),unwrapEmptySpan(e,o)},ok=tq.generate([{keep:[]},{rename:["name"]},{removed:[]}]),o$=/^(src|href|style)$/,oS=eb.each,isTableCellOrRow=e=>/^(TR|TH|TD)$/.test(e.nodeName),isChildOfInlineParent=(e,t,n)=>e.isChildOf(t,n)&&t!==n&&!e.isBlock(n),getContainer=(e,t,n)=>{let o=t[n?"startContainer":"endContainer"],a=t[n?"startOffset":"endOffset"];if(eR(o)){let e=o.childNodes.length-1;!n&&a&&a--,o=o.childNodes[a>e?e:a]}return ew(o)&&n&&a>=o.data.length&&(o=new DomTreeWalker(o,e.getBody()).next()||o),ew(o)&&!n&&0===a&&(o=new DomTreeWalker(o,e.getBody()).prev()||o),o},normalizeTableSelection=(e,t)=>{let n=t?"firstChild":"lastChild",o=e[n];return isTableCellOrRow(e)&&o?"TR"===e.nodeName&&o[n]||o:e},wrap$1=(e,t,n,o)=>{var a;let i=e.create(n,o);return null===(a=t.parentNode)||void 0===a||a.insertBefore(i,t),i.appendChild(t),i},wrapWithSiblings=(e,t,n,o,a)=>{let i=eS.fromDom(t),l=eS.fromDom(e.create(o,a)),s=n?nextSiblings(i):prevSiblings(i);return append(l,s),n?(before$3(i,l),prepend(l,i)):(after$4(i,l),append$1(l,i)),l.dom},isColorFormatAndAnchor=(e,t)=>t.links&&"A"===e.nodeName,removeNode=(e,t,n)=>{let o;let a=t.parentNode,i=e.dom,l=t2(e);!isBlockFormat(n)||a!==i.getRoot()||n.list_block&&isEq$5(t,n.list_block)||each$e(I(t.childNodes),t=>{isValid(e,l,t.nodeName.toLowerCase())?o?o.appendChild(t):(o=wrap$1(i,t,l),i.setAttribs(o,t3(e))):o=null}),(!isMixedFormat(n)||isEq$5(n.inline,t))&&i.remove(t,!0)},processFormatAttrOrStyle=(e,t,n)=>x(e)?{name:t,value:null}:{name:e,value:replaceVars(t,n)},removeEmptyStyleAttributeIfNeeded=(e,t)=>{""===e.getAttrib(t,"style")&&(t.removeAttribute("style"),t.removeAttribute("data-mce-style"))},removeStyles=(e,t,n,o,a)=>{let i=!1;oS(n.styles,(l,s)=>{let{name:d,value:c}=processFormatAttrOrStyle(s,l,o),m=normalizeStyleValue(c,d);(n.remove_similar||N(c)||!eR(a)||isEq$5(getStyle(e,a,d),m))&&e.setStyle(t,d,""),i=!0}),i&&removeEmptyStyleAttributeIfNeeded(e,t)},removeListStyleFormats=(e,t,n)=>{"removeformat"===t?each$e(getPartiallySelectedListItems(e.selection),t=>{each$e(ov,n=>e.dom.setStyle(t,n,"")),removeEmptyStyleAttributeIfNeeded(e.dom,t)}):getExpandedListItemFormat(e.formatter,t).each(t=>{each$e(getPartiallySelectedListItems(e.selection),o=>removeStyles(e.dom,o,t,n,null))})},removeNodeFormatInternal=(e,t,n,o,a)=>{let i=e.dom,l=ElementUtils(e),s=e.schema;if(isInlineFormat(t)&&isTransparentElementName(s,t.inline)&&isTransparentBlock(s,o)&&o.parentElement===e.getBody())return removeNode(e,o,t),ok.removed();if(!t.ceFalseOverride&&o&&"false"===i.getContentEditableParent(o)||o&&!matchName(i,o,t)&&!isColorFormatAndAnchor(o,t))return ok.keep();let d=t.preserve_attributes;if(isInlineFormat(t)&&"all"===t.remove&&S(d)){let e=filter$5(i.getAttribs(o),e=>contains$2(d,e.name.toLowerCase()));if(i.removeAllAttribs(o),each$e(e,e=>i.setAttrib(o,e.name,e.value)),e.length>0)return ok.rename("span")}if("all"!==t.remove){removeStyles(i,o,t,n,a),oS(t.attributes,(e,l)=>{let{name:s,value:d}=processFormatAttrOrStyle(l,e,n);if(t.remove_similar||N(d)||!eR(a)||isEq$5(i.getAttrib(a,s),d)){if("class"===s){let e=i.getAttrib(o,s);if(e){let t="";if(each$e(e.split(/\s+/),e=>{/mce\-\w+/.test(e)&&(t+=(t?" ":"")+e)}),t){i.setAttrib(o,s,t);return}}}if(o$.test(s)&&o.removeAttribute("data-mce-"+s),"style"===s&&matchNodeNames(["li"])(o)&&"none"===i.getStyle(o,"list-style-type")){o.removeAttribute(s),i.setStyle(o,"list-style-type","none");return}"class"===s&&o.removeAttribute("className"),o.removeAttribute(s)}}),oS(t.classes,e=>{e=replaceVars(e,n),(!eR(a)||i.hasClass(a,e))&&i.removeClass(o,e)});let e=i.getAttribs(o);for(let t=0;t<e.length;t++){let n=e[t].nodeName;if(!l.isAttributeInternal(n))return ok.keep()}}return"none"!==t.remove?(removeNode(e,o,t),ok.removed()):ok.keep()},findFormatRoot=(e,t,n,o,a)=>{let i;return t.parentNode&&each$e(getParents$2(e.dom,t.parentNode).reverse(),t=>{if(!i&&eR(t)&&"_start"!==t.id&&"_end"!==t.id){let l=matchNode(e,t,n,o,a);l&&!1!==l.split&&(i=t)}}),i},removeNodeFormatFromClone=(e,t,n,o)=>removeNodeFormatInternal(e,t,n,o,o).fold(constant(o),t=>{let n=e.dom.createFragment();return n.appendChild(o),e.dom.rename(o,t)},constant(null)),wrapAndSplit=(e,t,n,o,a,i,l,s)=>{var d,c;let m,u;let p=e.dom;if(n){let g=n.parentNode;for(let n=o.parentNode;n&&n!==g;n=n.parentNode){let o=p.clone(n,!1);for(let n=0;n<t.length&&null!==(o=removeNodeFormatFromClone(e,t[n],s,o));n++);o&&(m&&o.appendChild(m),u||(u=o),m=o)}!i||l.mixed&&p.isBlock(n)||(o=null!==(d=p.split(n,o))&&void 0!==d?d:o),m&&u&&(null===(c=a.parentNode)||void 0===c||c.insertBefore(m,a),u.appendChild(a),isInlineFormat(l)&&mergeSiblings(e,l,s,m))}return o},removeFormatInternal=(e,t,n,o,a)=>{let i=e.formatter.get(t),l=i[0],s=e.dom,d=e.selection,splitToFormatRoot=o=>{let s=findFormatRoot(e,o,t,n,a);return wrapAndSplit(e,i,s,o,o,!0,l,n)},isRemoveBookmarkNode=e=>isBookmarkNode$1(e)&&eR(e)&&("_start"===e.id||"_end"===e.id),removeFormatOnNode=t=>exists(i,o=>removeNodeFormat(e,o,n,t,t)),process=t=>{let n=I(t.childNodes),o=removeFormatOnNode(t),a=o||exists(i,e=>matchName(s,t,e)),d=t.parentNode;if(!a&&isNonNullable(d)&&shouldExpandToSelector(l)&&removeFormatOnNode(d),l.deep&&n.length)for(let e=0;e<n.length;e++)process(n[e]);each$e(["underline","line-through","overline"],n=>{eR(t)&&e.dom.getStyle(t,"text-decoration")===n&&t.parentNode&&getTextDecoration(s,t.parentNode)===n&&removeNodeFormat(e,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:n}},void 0,t)})},unwrap=e=>{let t=s.get(e?"_start":"_end");if(!t)return null;{let n=t[e?"firstChild":"lastChild"];return isRemoveBookmarkNode(n)&&(n=n[e?"firstChild":"lastChild"]),ew(n)&&0===n.data.length&&(n=e?t.previousSibling||t.nextSibling:t.nextSibling||t.previousSibling),s.remove(t,!0),n}},removeRngStyle=t=>{let n,o;let a=expandRng(s,t,i,t.collapsed);if(l.split){if((n=getContainer(e,a=split(a),!0))!==(o=getContainer(e,a))){if(isChildOfInlineParent(s,n=normalizeTableSelection(n,!0),o=normalizeTableSelection(o,!1))){let e=Optional.from(n.firstChild).getOr(n);splitToFormatRoot(wrapWithSiblings(s,e,!0,"span",{id:"_start","data-mce-type":"bookmark"})),unwrap(!0);return}if(isChildOfInlineParent(s,o,n)){let e=Optional.from(o.lastChild).getOr(o);splitToFormatRoot(wrapWithSiblings(s,e,!1,"span",{id:"_end","data-mce-type":"bookmark"})),unwrap(!1);return}n=wrap$1(s,n,"span",{id:"_start","data-mce-type":"bookmark"}),o=wrap$1(s,o,"span",{id:"_end","data-mce-type":"bookmark"});let e=s.createRng();e.setStartAfter(n),e.setEndBefore(o),walk$3(s,e,e=>{each$e(e,e=>{isBookmarkNode$1(e)||isBookmarkNode$1(e.parentNode)||splitToFormatRoot(e)})}),splitToFormatRoot(n),splitToFormatRoot(o),n=unwrap(!0),o=unwrap()}else n=o=splitToFormatRoot(n);a.startContainer=n.parentNode?n.parentNode:n,a.startOffset=s.nodeIndex(n),a.endContainer=o.parentNode?o.parentNode:o,a.endOffset=s.nodeIndex(o)+1}walk$3(s,a,e=>{each$e(e,process)})};if(o){if(isNode(o)){let e=s.createRng();e.setStartBefore(o),e.setEndAfter(o),removeRngStyle(e)}else removeRngStyle(o);fireFormatRemove(e,t,o,n);return}d.isCollapsed()&&isInlineFormat(l)&&!getCellsFromEditor(e).length?removeCaretFormat(e,t,n,a):(preserveSelection(e,()=>runOnRanges(e,removeRngStyle),o=>isInlineFormat(l)&&match$2(e,t,n,o)),e.nodeChanged()),removeListStyleFormats(e,t,n),fireFormatRemove(e,t,o,n)},removeFormat$1=(e,t,n,o,a)=>{(o||e.selection.isEditable())&&removeFormatInternal(e,t,n,o,a)},removeNodeFormat=(e,t,n,o,a)=>removeNodeFormatInternal(e,t,n,o,a).fold(w,t=>(e.dom.rename(o,t),!0),A),oN=eb.each,mergeTextDecorationsAndColor=(e,t,n,o)=>{let processTextDecorationsAndColor=t=>{if(eR(t)&&eR(t.parentNode)&&isEditable$2(t)){let n=getTextDecoration(e,t.parentNode);e.getStyle(t,"color")&&n?e.setStyle(t,"text-decoration",n):e.getStyle(t,"text-decoration")===n&&e.setStyle(t,"text-decoration",null)}};t.styles&&(t.styles.color||t.styles.textDecoration)&&(eb.walk(o,processTextDecorationsAndColor,"childNodes"),processTextDecorationsAndColor(o))},mergeBackgroundColorAndFontSize=(e,t,n,o)=>{if(t.styles&&t.styles.backgroundColor){let a=hasStyle(e,"fontSize");processChildElements(o,e=>a(e)&&isEditable$2(e),applyStyle(e,"backgroundColor",replaceVars(t.styles.backgroundColor,n)))}},mergeSubSup=(e,t,n,o)=>{if(isInlineFormat(t)&&("sub"===t.inline||"sup"===t.inline)){let n=hasStyle(e,"fontSize");processChildElements(o,e=>n(e)&&isEditable$2(e),applyStyle(e,"fontSize",""));let a=filter$5(e.select("sup"===t.inline?"sub":"sup",o),isEditable$2);e.remove(a,!0)}},mergeWithChildren=(e,t,n,o)=>{oN(t,t=>{isInlineFormat(t)&&oN(e.dom.select(t.inline,o),o=>{isElementNode(o)&&removeNodeFormat(e,t,n,o,t.exact?o:null)}),clearChildStyles(e.dom,t,o)})},mergeWithParents=(e,t,n,o,a)=>{let i=a.parentNode;!(matchNode(e,i,n,o)&&removeNodeFormat(e,t,o,a))&&t.merge_with_parents&&i&&e.dom.getParent(i,i=>!!matchNode(e,i,n,o)&&(removeNodeFormat(e,t,o,a),!0))},oO=eb.each,canFormatBR=(e,t,n,o)=>{if(!(nT(e)&&isInlineFormat(t))||!n.parentNode)return!1;{let t=getTextRootBlockElements(e.schema),a=sibling(eS.fromDom(n),e=>isCaretNode(e.dom));return hasNonNullableKey(t,o)&&isEmpty$2(eS.fromDom(n.parentNode),!1)&&!a}},applyStyles=(e,t,n,o)=>{if(oO(n.styles,(n,a)=>{e.setStyle(t,a,replaceVars(n,o))}),n.styles){let n=e.getAttrib(t,"style");n&&e.setAttrib(t,"data-mce-style",n)}},applyFormatAction=(e,t,n,o)=>{let a=e.formatter.get(t),i=a[0],l=!o&&e.selection.isCollapsed(),s=e.dom,d=e.selection,setElementFormat=(e,t=i)=>{R(t.onformat)&&t.onformat(e,t,n,o),applyStyles(s,e,t,n),oO(t.attributes,(t,o)=>{s.setAttrib(e,o,replaceVars(t,n))}),oO(t.classes,t=>{let o=replaceVars(t,n);s.hasClass(e,o)||s.addClass(e,o)})},applyNodeStyle=(e,t)=>{let n=!1;return oO(e,e=>!!isSelectorFormat(e)&&(!!("false"===s.getContentEditable(t)&&!e.ceFalseOverride||isNonNullable(e.collapsed)&&e.collapsed!==l)||!s.is(t,e.selector)||!!isCaretNode(t)||(setElementFormat(t,e),n=!0,!1))),n},createWrapElement=e=>{if(!k(e))return null;{let t=s.create(e);return setElementFormat(t),t}},applyRngStyle=(o,l,s)=>{let d=[],c=!0,m=i.inline||i.block,u=createWrapElement(m),isMatchingWrappingBlock=o=>isWrappingBlockFormat(i)&&matchNode(e,o,t,n),canRenameBlock=(t,n,o)=>{let a=isNonWrappingBlockFormat(i)&&isTextBlock$1(e.schema,t)&&isValid(e,n,m);return o&&a},canWrapNode=(t,n,a,l)=>{let d=t.nodeName.toLowerCase(),c=isValid(e,m,d)&&isValid(e,n,m),u=!s&&ew(t)&&isZwsp$2(t.data),p=isCaretNode(t),g=!isInlineFormat(i)||!o.isBlock(t);return(a||l)&&c&&!u&&!p&&g};walk$3(o,l,t=>{let n;let process=t=>{let l=!1,s=c,p=!1,g=t.parentNode,f=g.nodeName.toLowerCase(),h=o.getContentEditable(t);isNonNullable(h)&&(s=c,c="true"===h,l=!0,p=isWrappableNoneditable(e,t));let b=c&&!l;if(eF(t)&&!canFormatBR(e,i,t,f)){n=null,isBlockFormat(i)&&o.remove(t);return}if(isMatchingWrappingBlock(t)){n=null;return}if(canRenameBlock(t,f,b)){let e=o.rename(t,m);setElementFormat(e),d.push(e),n=null;return}if(isSelectorFormat(i)){let e=applyNodeStyle(a,t);if(!e&&isNonNullable(g)&&shouldExpandToSelector(i)&&(e=applyNodeStyle(a,g)),!isInlineFormat(i)||e){n=null;return}}isNonNullable(u)&&canWrapNode(t,f,b,p)?(n||(n=o.clone(u,!1),g.insertBefore(n,t),d.push(n)),p&&l&&(c=s),n.appendChild(t)):(n=null,each$e(I(t.childNodes),process),l&&(c=s),n=null)};each$e(t,process)}),!0===i.links&&each$e(d,e=>{let process=e=>{"A"===e.nodeName&&setElementFormat(e,i),each$e(I(e.childNodes),process)};process(e)}),each$e(d,l=>{let s;let c=(s=0,each$e(l.childNodes,e=>{!isEmptyTextNode$1(e)&&!isBookmarkNode$1(e)&&s++}),s);if((d.length>1||!o.isBlock(l))&&0===c){o.remove(l,!0);return}(isInlineFormat(i)||isBlockFormat(i)&&i.wrapper)&&(i.exact||1!==c||(l=(e=>{let t=find$2(e.childNodes,isElementNode$1).filter(e=>"false"!==o.getContentEditable(e)&&matchName(o,e,i));return t.map(t=>{let n=o.clone(t,!1);return setElementFormat(n),o.replace(n,e,!0),o.remove(t,!0),n}).getOr(e)})(l)),mergeWithChildren(e,a,n,l),mergeWithParents(e,i,t,n,l),mergeBackgroundColorAndFontSize(o,i,n,l),mergeTextDecorationsAndColor(o,i,n,l),mergeSubSup(o,i,n,l),mergeSiblings(e,i,n,l))})},c=isNode(o)?o:d.getNode();if("false"===s.getContentEditable(c)&&!isWrappableNoneditable(e,c)){applyNodeStyle(a,o=c),fireFormatApply(e,t,o,n);return}if(i){if(o){if(isNode(o)){if(!applyNodeStyle(a,o)){let e=s.createRng();e.setStartBefore(o),e.setEndAfter(o),applyRngStyle(s,expandRng(s,e,a),!0)}}else applyRngStyle(s,o,!0)}else l&&isInlineFormat(i)&&!getCellsFromEditor(e).length?applyCaretFormat(e,t,n):(d.setRng(normalize(d.getRng())),preserveSelection(e,()=>{runOnRanges(e,(e,t)=>{let n=t?e:expandRng(s,e,a);applyRngStyle(s,n,!1)})},A),e.nodeChanged()),getExpandedListItemFormat(e.formatter,t).each(t=>{each$e(getFullySelectedListItems(e.selection),e=>applyStyles(s,e,t,n))});postProcess$1(t,e)}fireFormatApply(e,t,o,n)},applyFormat$1=(e,t,n,o)=>{(o||e.selection.isEditable())&&applyFormatAction(e,t,n,o)},hasVars=e=>has$2(e,"vars"),setup$t=(e,t)=>{e.set({}),t.on("NodeChange",n=>{updateAndFireChangeCallbacks(t,n.element,e.get())}),t.on("FormatApply FormatRemove",n=>{let o=Optional.from(n.node).map(e=>isNode(e)?e:e.startContainer).bind(e=>eR(e)?Optional.some(e):Optional.from(e.parentElement)).getOrThunk(()=>fallbackElement(t));updateAndFireChangeCallbacks(t,o,e.get())})},fallbackElement=e=>e.selection.getStart(),matchingNode=(e,t,n,o,a)=>findUntil$1(t,t=>{let i=e.formatter.matchNode(t,n,null!=a?a:{},o);return!P(i)},t=>!!matchesUnInheritedFormatSelector(e,t,n)||!o&&isNonNullable(e.formatter.matchNode(t,n,a,!0))),getParents=(e,t)=>{let n=null!=t?t:fallbackElement(e);return filter$5(getParents$2(e.dom,n),e=>eR(e)&&!isBogus$2(e))},updateAndFireChangeCallbacks=(e,t,n)=>{let o=getParents(e,t);each$d(n,(n,a)=>{let runIfChanged=n=>{let i=matchingNode(e,o,a,n.similar,hasVars(n)?n.vars:void 0),l=i.isSome();if(n.state.get()!==l){n.state.set(l);let e=i.getOr(t);hasVars(n)?n.callback(l,{node:e,format:a,parents:o}):each$e(n.callbacks,t=>t(l,{node:e,format:a,parents:o}))}};each$e([n.withSimilar,n.withoutSimilar],runIfChanged),each$e(n.withVars,runIfChanged)})},addListeners=(e,t,n,o,a,i)=>{let l=t.get();each$e(n.split(","),t=>{let n=get$a(l,t).getOrThunk(()=>{let e={withSimilar:{state:Cell(!1),similar:!0,callbacks:[]},withoutSimilar:{state:Cell(!1),similar:!1,callbacks:[]},withVars:[]};return l[t]=e,e}),getCurrent=()=>{let n=getParents(e);return matchingNode(e,n,t,a,i).isSome()};if(P(i)){let e=a?n.withSimilar:n.withoutSimilar;e.callbacks.push(o),1===e.callbacks.length&&e.state.set(getCurrent())}else n.withVars.push({state:Cell(getCurrent()),similar:a,vars:i,callback:o})}),t.set(l)},removeListeners=(e,t,n)=>{let o=e.get();each$e(t.split(","),e=>get$a(o,e).each(t=>{o[e]={withSimilar:{...t.withSimilar,callbacks:filter$5(t.withSimilar.callbacks,e=>e!==n)},withoutSimilar:{...t.withoutSimilar,callbacks:filter$5(t.withoutSimilar.callbacks,e=>e!==n)},withVars:filter$5(t.withVars,e=>e.callback!==n)}})),e.set(o)},formatChangedInternal=(e,t,n,o,a,i)=>(addListeners(e,t,n,o,a,i),{unbind:()=>removeListeners(t,n,o)}),toggle=(e,t,n,o)=>{let a=e.formatter.get(t);a&&(!match$2(e,t,n,o)||"toggle"in a[0]&&!a[0].toggle?applyFormat$1(e,t,n,o):removeFormat$1(e,t,n,o))},oP=eb.explode,create$8=()=>{let e={};return{addFilter:(t,n)=>{each$e(oP(t),t=>{has$2(e,t)||(e[t]={name:t,callbacks:[]}),e[t].callbacks.push(n)})},getFilters:()=>values(e),removeFilter:(t,n)=>{each$e(oP(t),t=>{if(has$2(e,t)){if(isNonNullable(n)){let o=e[t],a=filter$5(o.callbacks,e=>e!==n);a.length>0?o.callbacks=a:delete e[t]}else delete e[t]}})}}},removeAttrs=(e,t)=>{each$e(t,t=>{e.attr(t,null)})},addFontToSpansFilter=(e,t,n)=>{e.addNodeFilter("font",e=>{each$e(e,e=>{let o=t.parse(e.attr("style")),a=e.attr("color"),i=e.attr("face"),l=e.attr("size");a&&(o.color=a),i&&(o["font-family"]=i),l&&toInt(l).each(e=>{o["font-size"]=n[e-1]}),e.name="span",e.attr("style",t.serialize(o)),removeAttrs(e,["color","face","size"])})})},addStrikeFilter=(e,t,n)=>{e.addNodeFilter("strike",e=>{let o="html4"!==t.type;each$e(e,e=>{if(o)e.name="s";else{let t=n.parse(e.attr("style"));t["text-decoration"]="line-through",e.name="span",e.attr("style",n.serialize(t))}})})},addFilters=(e,t,n)=>{var o;let a=Styles();t.convert_fonts_to_spans&&addFontToSpansFilter(e,a,eb.explode(null!==(o=t.font_size_legacy_values)&&void 0!==o?o:"")),addStrikeFilter(e,n,a)},register$5=(e,t,n)=>{t.inline_styles&&addFilters(e,t,n)},addNodeFilter=(e,t,n)=>{t.addNodeFilter("br",(t,o,a)=>{let i=eb.extend({},n.getBlockElements()),l=n.getNonEmptyElements(),s=n.getWhitespaceElements();i.body=1;let isBlock=e=>e.name in i||isTransparentAstBlock(n,e);for(let o=0,d=t.length;o<d;o++){let d=t[o],c=d.parent;if(c&&isBlock(c)&&d===c.lastChild){let t=d.prev;for(;t;){let e=t.name;if("span"!==e||"bookmark"!==t.attr("data-mce-type")){"br"===e&&(d=null);break}t=t.prev}if(d&&(d.remove(),isEmpty(n,l,s,c))){let t=n.getElementRule(c.name);t&&(t.removeEmpty?c.remove():t.paddEmpty&&paddEmptyNode(e,a,isBlock,c))}}else{let e=d;for(;c&&c.firstChild===e&&c.lastChild===e&&(e=c,!i[c.name]);)c=c.parent;if(e===c){let e=new AstNode("#text",3);e.value="\xa0",d.replace(e)}}}})},blobUriToBlob=e=>fetch(e).then(e=>e.ok?e.blob():Promise.reject()).catch(()=>Promise.reject({message:`Cannot convert ${e} to Blob. Resource might not exist or is inaccessible.`,uriType:"blob"})),extractBase64Data=e=>{let t=/([a-z0-9+\/=\s]+)/i.exec(e);return t?t[1]:""},parseDataUri=e=>{let[t,...n]=e.split(","),o=n.join(","),a=/data:([^/]+\/[^;]+)(;.+)?/.exec(t);if(!a)return Optional.none();{let e=";base64"===a[2],t=e?extractBase64Data(o):decodeURIComponent(o);return Optional.some({type:a[1],data:t,base64Encoded:e})}},buildBlob=(e,t,n=!0)=>{let o=t;if(n)try{o=atob(t)}catch(e){return Optional.none()}let a=new Uint8Array(o.length);for(let e=0;e<a.length;e++)a[e]=o.charCodeAt(e);return Optional.some(new Blob([a],{type:e}))},dataUriToBlob=e=>new Promise((t,n)=>{parseDataUri(e).bind(({type:e,data:t,base64Encoded:n})=>buildBlob(e,t,n)).fold(()=>n("Invalid data URI"),t)}),uriToBlob=e=>startsWith(e,"blob:")?blobUriToBlob(e):startsWith(e,"data:")?dataUriToBlob(e):Promise.reject("Unknown URI format"),blobToDataUri=e=>new Promise((t,n)=>{let o=new FileReader;o.onloadend=()=>{t(o.result)},o.onerror=()=>{var e;n(null===(e=o.error)||void 0===e?void 0:e.message)},o.readAsDataURL(e)}),oR=0,uniqueId$1=e=>(e||"blobid")+oR++,processDataUri=(e,t,n)=>parseDataUri(e).bind(({data:e,type:o,base64Encoded:a})=>{if(t&&!a)return Optional.none();{let t=a?e:btoa(e);return n(t,o)}}),createBlobInfo$1=(e,t,n)=>{let o=e.create(uniqueId$1(),t,n);return e.add(o),o},dataUriToBlobInfo=(e,t,n=!1)=>processDataUri(t,n,(t,n)=>Optional.from(e.getByData(t,n)).orThunk(()=>buildBlob(n,t).map(n=>createBlobInfo$1(e,n,t)))),imageToBlobInfo=(e,t)=>{let invalidDataUri=()=>Promise.reject("Invalid data URI");if(startsWith(t,"blob:")){let n=e.getByUri(t);return isNonNullable(n)?Promise.resolve(n):uriToBlob(t).then(t=>blobToDataUri(t).then(n=>processDataUri(n,!1,n=>Optional.some(createBlobInfo$1(e,t,n))).getOrThunk(invalidDataUri)))}return startsWith(t,"data:")?dataUriToBlobInfo(e,t).fold(invalidDataUri,e=>Promise.resolve(e)):Promise.reject("Unknown image data format")},isBogusImage=e=>isNonNullable(e.attr("data-mce-bogus")),isInternalImageSource=e=>e.attr("src")===ef.transparentSrc||isNonNullable(e.attr("data-mce-placeholder")),registerBase64ImageFilter=(e,t)=>{let{blob_cache:n}=t;if(n){let processImage=e=>{let t=e.attr("src");isInternalImageSource(e)||isBogusImage(e)||isNullable(t)||dataUriToBlobInfo(n,t,!0).each(t=>{e.attr("src",t.blobUri())})};e.addAttributeFilter("src",e=>each$e(e,processImage))}},register$4=(e,t)=>{let n=e.schema;t.remove_trailing_brs&&addNodeFilter(t,e,n),e.addAttributeFilter("href",e=>{let n=e.length,appendRel=e=>{let t=e.split(" ").filter(e=>e.length>0);return t.concat(["noopener"]).sort().join(" ")},addNoOpener=e=>{let t=e?eb.trim(e):"";return/\b(noopener)\b/g.test(t)?t:appendRel(t)};if(!t.allow_unsafe_link_target)for(;n--;){let t=e[n];"a"===t.name&&"_blank"===t.attr("target")&&t.attr("rel",addNoOpener(t.attr("rel")))}}),t.allow_html_in_named_anchor||e.addAttributeFilter("id,name",e=>{let t=e.length,n,o,a,i;for(;t--;)if("a"===(i=e[t]).name&&i.firstChild&&!i.attr("href"))for(a=i.parent,n=i.lastChild;n&&a;)o=n.prev,a.insert(n,i),n=o}),t.fix_list_elements&&e.addNodeFilter("ul,ol",e=>{let t=e.length,n,o;for(;t--;)if((o=(n=e[t]).parent)&&("ul"===o.name||"ol"===o.name)){if(n.prev&&"li"===n.prev.name)n.prev.append(n);else{let e=new AstNode("li",1);e.attr("style","list-style-type: none"),n.wrap(e)}}});let o=n.getValidClasses();t.validate&&o&&e.addAttributeFilter("class",e=>{var t;let n=e.length;for(;n--;){let a=e[n],i=null!==(t=a.attr("class"))&&void 0!==t?t:"",l=eb.explode(i," "),s="";for(let e=0;e<l.length;e++){let t=l[e],n=!1,i=o["*"];i&&i[t]&&(n=!0),i=o[a.name],!n&&i&&i[t]&&(n=!0),n&&(s&&(s+=" "),s+=t)}s.length||(s=null),a.attr("class",s)}}),registerBase64ImageFilter(e,t)};function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _construct(e,t,n){return(_construct=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?function(e,t,n){var o=[null];o.push.apply(o,t);var a=new(Function.bind.apply(e,o));return n&&_setPrototypeOf(a,n.prototype),a}:Reflect.construct).apply(null,arguments)}function _toConsumableArray(e){return function(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}var ox=Object.hasOwnProperty,ow=Object.setPrototypeOf,oA=Object.isFrozen,oT=Object.getPrototypeOf,oB=Object.getOwnPropertyDescriptor,oD=Object.freeze,oI=Object.seal,oF=Object.create,o_="undefined"!=typeof Reflect&&Reflect,oL=o_.apply,oM=o_.construct;oL||(oL=function(e,t,n){return e.apply(t,n)}),oD||(oD=function(e){return e}),oI||(oI=function(e){return e}),oM||(oM=function(e,t){return _construct(e,_toConsumableArray(t))});var oU=unapply(Array.prototype.forEach),oz=unapply(Array.prototype.pop),oW=unapply(Array.prototype.push),oH=unapply(String.prototype.toLowerCase),oV=unapply(String.prototype.match),oq=unapply(String.prototype.replace),oj=unapply(String.prototype.indexOf),oK=unapply(String.prototype.trim),oG=unapply(RegExp.prototype.test),oY=(i=TypeError,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return oM(i,t)});function unapply(e){return function(t){for(var n=arguments.length,o=Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return oL(e,t,o)}}function addToSet(e,t){ow&&ow(e,null);for(var n=t.length;n--;){var o=t[n];if("string"==typeof o){var a=oH(o);a!==o&&(oA(t)||(t[n]=a),o=a)}e[o]=!0}return e}function clone(e){var t,n=oF(null);for(t in e)oL(ox,e,[t])&&(n[t]=e[t]);return n}function lookupGetter(e,t){for(;null!==e;){var n=oB(e,t);if(n){if(n.get)return unapply(n.get);if("function"==typeof n.value)return unapply(n.value)}e=oT(e)}return function(e){return console.warn("fallback value for",e),null}}var oX=oD(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),oZ=oD(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),oQ=oD(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),oJ=oD(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),o0=oD(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),o1=oD(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),o2=oD(["#text"]),o3=oD(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),o5=oD(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),o4=oD(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),o8=oD(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),o6=oI(/\{\{[\w\W]*|[\w\W]*\}\}/gm),o9=oI(/<%[\w\W]*|[\w\W]*%>/gm),o7=oI(/^data-[\-\w.\u00B7-\uFFFF]/),ae=oI(/^aria-[\-\w]+$/),at=oI(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),an=oI(/^(?:\w+script|data):/i),ar=oI(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ao=oI(/^html$/i),_createTrustedTypesPolicy=function(e,t){if("object"!==_typeof(e)||"function"!=typeof e.createPolicy)return null;var n=null,o="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(o)&&(n=t.currentScript.getAttribute(o));var a="dompurify"+(n?"#"+n:"");try{return e.createPolicy(a,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+a+" could not be created."),null}},aa=function createDOMPurify(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,DOMPurify=function(e){return createDOMPurify(e)};if(DOMPurify.version="2.3.8",DOMPurify.removed=[],!n||!n.document||9!==n.document.nodeType)return DOMPurify.isSupported=!1,DOMPurify;var o=n.document,a=n.document,i=n.DocumentFragment,l=n.HTMLTemplateElement,s=n.Node,d=n.Element,c=n.NodeFilter,m=n.NamedNodeMap,u=void 0===m?n.NamedNodeMap||n.MozNamedAttrMap:m,p=n.HTMLFormElement,g=n.DOMParser,f=n.trustedTypes,h=d.prototype,b=lookupGetter(h,"cloneNode"),C=lookupGetter(h,"nextSibling"),y=lookupGetter(h,"childNodes"),v=lookupGetter(h,"parentNode");if("function"==typeof l){var E=a.createElement("template");E.content&&E.content.ownerDocument&&(a=E.content.ownerDocument)}var k=_createTrustedTypesPolicy(f,o),$=k?k.createHTML(""):"",S=a,N=S.implementation,O=S.createNodeIterator,P=S.createDocumentFragment,R=S.getElementsByTagName,x=o.importNode,w={};try{w=clone(a).documentMode?a.documentMode:{}}catch(e){}var A={};DOMPurify.isSupported="function"==typeof v&&N&&void 0!==N.createHTMLDocument&&9!==w;var T=at,B=null,D=addToSet({},[].concat(_toConsumableArray(oX),_toConsumableArray(oZ),_toConsumableArray(oQ),_toConsumableArray(o0),_toConsumableArray(o2))),I=null,F=addToSet({},[].concat(_toConsumableArray(o3),_toConsumableArray(o5),_toConsumableArray(o4),_toConsumableArray(o8))),_=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),L=null,M=null,U=!0,z=!0,W=!1,H=!1,V=!1,q=!1,j=!1,K=!1,G=!1,Y=!1,X=!0,Z=!0,Q=!1,J={},ee=null,et=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),en=null,er=addToSet({},["audio","video","img","source","image","track"]),eo=null,ea=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ei="http://www.w3.org/1998/Math/MathML",el="http://www.w3.org/2000/svg",es="http://www.w3.org/1999/xhtml",ed=es,ec=!1,em=["application/xhtml+xml","text/html"],eu=null,ep=a.createElement("form"),isRegexOrFunction=function(e){return e instanceof RegExp||e instanceof Function},_parseConfig=function(n){eu&&eu===n||(n&&"object"===_typeof(n)||(n={}),B="ALLOWED_TAGS"in(n=clone(n))?addToSet({},n.ALLOWED_TAGS):D,I="ALLOWED_ATTR"in n?addToSet({},n.ALLOWED_ATTR):F,eo="ADD_URI_SAFE_ATTR"in n?addToSet(clone(ea),n.ADD_URI_SAFE_ATTR):ea,en="ADD_DATA_URI_TAGS"in n?addToSet(clone(er),n.ADD_DATA_URI_TAGS):er,ee="FORBID_CONTENTS"in n?addToSet({},n.FORBID_CONTENTS):et,L="FORBID_TAGS"in n?addToSet({},n.FORBID_TAGS):{},M="FORBID_ATTR"in n?addToSet({},n.FORBID_ATTR):{},J="USE_PROFILES"in n&&n.USE_PROFILES,U=!1!==n.ALLOW_ARIA_ATTR,z=!1!==n.ALLOW_DATA_ATTR,W=n.ALLOW_UNKNOWN_PROTOCOLS||!1,H=n.SAFE_FOR_TEMPLATES||!1,V=n.WHOLE_DOCUMENT||!1,K=n.RETURN_DOM||!1,G=n.RETURN_DOM_FRAGMENT||!1,Y=n.RETURN_TRUSTED_TYPE||!1,j=n.FORCE_BODY||!1,X=!1!==n.SANITIZE_DOM,Z=!1!==n.KEEP_CONTENT,Q=n.IN_PLACE||!1,T=n.ALLOWED_URI_REGEXP||T,ed=n.NAMESPACE||es,n.CUSTOM_ELEMENT_HANDLING&&isRegexOrFunction(n.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(_.tagNameCheck=n.CUSTOM_ELEMENT_HANDLING.tagNameCheck),n.CUSTOM_ELEMENT_HANDLING&&isRegexOrFunction(n.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(_.attributeNameCheck=n.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),n.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof n.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(_.allowCustomizedBuiltInElements=n.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),t="application/xhtml+xml"===(e=e=-1===em.indexOf(n.PARSER_MEDIA_TYPE)?"text/html":n.PARSER_MEDIA_TYPE)?function(e){return e}:oH,H&&(z=!1),G&&(K=!0),J&&(B=addToSet({},_toConsumableArray(o2)),I=[],!0===J.html&&(addToSet(B,oX),addToSet(I,o3)),!0===J.svg&&(addToSet(B,oZ),addToSet(I,o5),addToSet(I,o8)),!0===J.svgFilters&&(addToSet(B,oQ),addToSet(I,o5),addToSet(I,o8)),!0===J.mathMl&&(addToSet(B,o0),addToSet(I,o4),addToSet(I,o8))),n.ADD_TAGS&&(B===D&&(B=clone(B)),addToSet(B,n.ADD_TAGS)),n.ADD_ATTR&&(I===F&&(I=clone(I)),addToSet(I,n.ADD_ATTR)),n.ADD_URI_SAFE_ATTR&&addToSet(eo,n.ADD_URI_SAFE_ATTR),n.FORBID_CONTENTS&&(ee===et&&(ee=clone(ee)),addToSet(ee,n.FORBID_CONTENTS)),Z&&(B["#text"]=!0),V&&addToSet(B,["html","head","body"]),B.table&&(addToSet(B,["tbody"]),delete L.tbody),oD&&oD(n),eu=n)},eg=addToSet({},["mi","mo","mn","ms","mtext"]),ef=addToSet({},["foreignobject","desc","title","annotation-xml"]),eh=addToSet({},["title","style","font","a","script"]),eb=addToSet({},oZ);addToSet(eb,oQ),addToSet(eb,oJ);var eC=addToSet({},o0);addToSet(eC,o1);var _checkValidNamespace=function(e){var t=v(e);t&&t.tagName||(t={namespaceURI:es,tagName:"template"});var n=oH(e.tagName),o=oH(t.tagName);return e.namespaceURI===el?t.namespaceURI===es?"svg"===n:t.namespaceURI===ei?"svg"===n&&("annotation-xml"===o||eg[o]):!!eb[n]:e.namespaceURI===ei?t.namespaceURI===es?"math"===n:t.namespaceURI===el?"math"===n&&ef[o]:!!eC[n]:e.namespaceURI===es&&(t.namespaceURI!==el||!!ef[o])&&(t.namespaceURI!==ei||!!eg[o])&&!eC[n]&&(eh[n]||!eb[n])},_forceRemove=function(e){oW(DOMPurify.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=$}catch(t){e.remove()}}},_removeAttribute=function(e,t){try{oW(DOMPurify.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){oW(DOMPurify.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!I[e]){if(K||G)try{_forceRemove(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}}},_initDocument=function(t){if(j)t="<remove></remove>"+t;else{var n,o,i=oV(t,/^[\r\n\t ]+/);o=i&&i[0]}"application/xhtml+xml"===e&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var l=k?k.createHTML(t):t;if(ed===es)try{n=new g().parseFromString(l,e)}catch(e){}if(!n||!n.documentElement){n=N.createDocument(ed,"template",null);try{n.documentElement.innerHTML=ec?"":l}catch(e){}}var s=n.body||n.documentElement;return(t&&o&&s.insertBefore(a.createTextNode(o),s.childNodes[0]||null),ed===es)?R.call(n,V?"html":"body")[0]:V?n.documentElement:s},_createIterator=function(e){return O.call(e.ownerDocument||e,e,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},_isNode=function(e){return"object"===_typeof(s)?e instanceof s:e&&"object"===_typeof(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},_executeHook=function(e,t,n){A[e]&&oU(A[e],function(e){e.call(DOMPurify,t,n,eu)})},_sanitizeElements=function(e){if(_executeHook("beforeSanitizeElements",e,null),e instanceof p&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof u)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore)||oG(/[\u0080-\uFFFF]/,e.nodeName))return _forceRemove(e),!0;var n,o=t(e.nodeName);if(_executeHook("uponSanitizeElement",e,{tagName:o,allowedTags:B}),e.hasChildNodes()&&!_isNode(e.firstElementChild)&&(!_isNode(e.content)||!_isNode(e.content.firstElementChild))&&oG(/<[/\w]/g,e.innerHTML)&&oG(/<[/\w]/g,e.textContent)||"select"===o&&oG(/<template/i,e.innerHTML))return _forceRemove(e),!0;if(!B[o]||L[o]){if(!L[o]&&_basicCustomElementTest(o)&&(_.tagNameCheck instanceof RegExp&&oG(_.tagNameCheck,o)||_.tagNameCheck instanceof Function&&_.tagNameCheck(o)))return!1;if(Z&&!ee[o]){var a=v(e)||e.parentNode,i=y(e)||e.childNodes;if(i&&a)for(var l=i.length,s=l-1;s>=0;--s)a.insertBefore(b(i[s],!0),C(e))}return _forceRemove(e),!0}return e instanceof d&&!_checkValidNamespace(e)||("noscript"===o||"noembed"===o)&&oG(/<\/no(script|embed)/i,e.innerHTML)?(_forceRemove(e),!0):(H&&3===e.nodeType&&(n=oq(n=e.textContent,o6," "),n=oq(n,o9," "),e.textContent!==n&&(oW(DOMPurify.removed,{element:e.cloneNode()}),e.textContent=n)),_executeHook("afterSanitizeElements",e,null),!1)},_isValidAttribute=function(e,t,n){if(X&&("id"===t||"name"===t)&&(n in a||n in ep))return!1;if(z&&!M[t]&&oG(o7,t));else if(U&&oG(ae,t));else if(!I[t]||M[t]){if(!(_basicCustomElementTest(e)&&(_.tagNameCheck instanceof RegExp&&oG(_.tagNameCheck,e)||_.tagNameCheck instanceof Function&&_.tagNameCheck(e))&&(_.attributeNameCheck instanceof RegExp&&oG(_.attributeNameCheck,t)||_.attributeNameCheck instanceof Function&&_.attributeNameCheck(t))||"is"===t&&_.allowCustomizedBuiltInElements&&(_.tagNameCheck instanceof RegExp&&oG(_.tagNameCheck,n)||_.tagNameCheck instanceof Function&&_.tagNameCheck(n))))return!1}else if(eo[t]);else if(oG(T,oq(n,ar,"")));else if(("src"===t||"xlink:href"===t||"href"===t)&&"script"!==e&&0===oj(n,"data:")&&en[e]);else if(W&&!oG(an,oq(n,ar,"")));else if(n)return!1;return!0},_basicCustomElementTest=function(e){return e.indexOf("-")>0},_sanitizeAttributes=function(e){_executeHook("beforeSanitizeAttributes",e,null);var n,o,a,i,l=e.attributes;if(l){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:I};for(i=l.length;i--;){var d=(n=l[i]).name,c=n.namespaceURI;o="value"===d?n.value:oK(n.value),a=t(d);var m=o;if(s.attrName=a,s.attrValue=o,s.keepAttr=!0,s.forceKeepAttr=void 0,_executeHook("uponSanitizeAttribute",e,s),o=s.attrValue,!s.forceKeepAttr){if(!s.keepAttr||oG(/\/>/i,o)||(H&&(o=oq(o,o6," "),o=oq(o,o9," ")),!_isValidAttribute(t(e.nodeName),a,o))){_removeAttribute(d,e);continue}if(o!==m)try{c?e.setAttributeNS(c,d,o):e.setAttribute(d,o)}catch(t){_removeAttribute(d,e)}}}_executeHook("afterSanitizeAttributes",e,null)}},_sanitizeShadowDOM=function _sanitizeShadowDOM(e){var t,n=_createIterator(e);for(_executeHook("beforeSanitizeShadowDOM",e,null);t=n.nextNode();)_executeHook("uponSanitizeShadowNode",t,null),_sanitizeElements(t)||(t.content instanceof i&&_sanitizeShadowDOM(t.content),_sanitizeAttributes(t));_executeHook("afterSanitizeShadowDOM",e,null)};return DOMPurify.sanitize=function(e,a){if((ec=!e)&&(e="<!-->"),"string"!=typeof e&&!_isNode(e)){if("function"!=typeof e.toString)throw oY("toString is not a function");if("string"!=typeof(e=e.toString()))throw oY("dirty is not a string, aborting")}if(!DOMPurify.isSupported){if("object"===_typeof(n.toStaticHTML)||"function"==typeof n.toStaticHTML){if("string"==typeof e)return n.toStaticHTML(e);if(_isNode(e))return n.toStaticHTML(e.outerHTML)}return e}if(q||_parseConfig(a),DOMPurify.removed=[],"string"==typeof e&&(Q=!1),Q){if(e.nodeName){var l,d,c,m,u,p=t(e.nodeName);if(!B[p]||L[p])throw oY("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof s)1===(d=(l=_initDocument("<!---->")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===d.nodeName?l=d:"HTML"===d.nodeName?l=d:l.appendChild(d);else{if(!K&&!H&&!V&&-1===e.indexOf("<"))return k&&Y?k.createHTML(e):e;if(!(l=_initDocument(e)))return K?null:Y?$:""}l&&j&&_forceRemove(l.firstChild);for(var g=_createIterator(Q?e:l);c=g.nextNode();)3===c.nodeType&&c===m||_sanitizeElements(c)||(c.content instanceof i&&_sanitizeShadowDOM(c.content),_sanitizeAttributes(c),m=c);if(m=null,Q)return e;if(K){if(G)for(u=P.call(l.ownerDocument);l.firstChild;)u.appendChild(l.firstChild);else u=l;return I.shadowroot&&(u=x.call(o,u,!0)),u}var f=V?l.outerHTML:l.innerHTML;return V&&B["!doctype"]&&l.ownerDocument&&l.ownerDocument.doctype&&l.ownerDocument.doctype.name&&oG(ao,l.ownerDocument.doctype.name)&&(f="<!DOCTYPE "+l.ownerDocument.doctype.name+">\n"+f),H&&(f=oq(f,o6," "),f=oq(f,o9," ")),k&&Y?k.createHTML(f):f},DOMPurify.setConfig=function(e){_parseConfig(e),q=!0},DOMPurify.clearConfig=function(){eu=null,q=!1},DOMPurify.isValidAttribute=function(e,n,o){return eu||_parseConfig({}),_isValidAttribute(t(e),t(n),o)},DOMPurify.addHook=function(e,t){"function"==typeof t&&(A[e]=A[e]||[],oW(A[e],t))},DOMPurify.removeHook=function(e){if(A[e])return oz(A[e])},DOMPurify.removeHooks=function(e){A[e]&&(A[e]=[])},DOMPurify.removeAllHooks=function(){A={}},DOMPurify}();let ai=eb.each,al=eb.trim,as=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],ad={ftp:21,http:80,https:443,mailto:25},ac=["img","video"],blockSvgDataUris=(e,t)=>isNonNullable(e)?!e:!isNonNullable(t)||!contains$2(ac,t),decodeUri=e=>{try{return decodeURIComponent(e)}catch(t){return unescape(e)}},isInvalidUri=(e,t,n)=>{let o=decodeUri(t).replace(/\s/g,"");return!e.allow_script_urls&&(!!/((java|vb)script|mhtml):/i.test(o)||!e.allow_html_data_urls&&(/^data:image\//i.test(o)?blockSvgDataUris(e.allow_svg_data_urls,n)&&/^data:image\/svg\+xml/i.test(o):/^data:/i.test(o)))};let URI=class URI{static parseDataUri(e){let t;let n=decodeURIComponent(e).split(","),o=/data:([^;]+)/.exec(n[0]);return o&&(t=o[1]),{type:t,data:n[1]}}static isDomSafe(e,t,n={}){if(n.allow_script_urls)return!0;{let o=tu.decode(e).replace(/[\s\u0000-\u001F]+/g,"");return!isInvalidUri(n,o,t)}}static getDocumentBaseUrl(e){var t;let n;return n=0!==e.protocol.indexOf("http")&&"file:"!==e.protocol?null!==(t=e.href)&&void 0!==t?t:"":e.protocol+"//"+e.host+e.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(n)&&(n=n.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(n)||(n+="/")),n}constructor(e,t={}){this.path="",this.directory="",e=al(e),this.settings=t;let n=t.base_uri,o=this;if(/^([\w\-]+):([^\/]{2})/i.test(e)||/^\s*#/.test(e)){o.source=e;return}let a=0===e.indexOf("//");if(0!==e.indexOf("/")||a||(e=(n&&n.protocol||"http")+"://mce_host"+e),!/^[\w\-]*:?\/\//.test(e)){let t=n?n.path:new URI(document.location.href).directory;if((null==n?void 0:n.protocol)==="")e="//mce_host"+o.toAbsPath(t,e);else{let a=/([^#?]*)([#?]?.*)/.exec(e);a&&(e=(n&&n.protocol||"http")+"://mce_host"+o.toAbsPath(t,a[1])+a[2])}}e=e.replace(/@@/g,"(mce_at)");let i=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(e);i&&ai(as,(e,t)=>{let n=i[t];n&&(n=n.replace(/\(mce_at\)/g,"@@")),o[e]=n}),n&&(o.protocol||(o.protocol=n.protocol),o.userInfo||(o.userInfo=n.userInfo),o.port||"mce_host"!==o.host||(o.port=n.port),o.host&&"mce_host"!==o.host||(o.host=n.host),o.source=""),a&&(o.protocol="")}setPath(e){let t=/^(.*?)\/?(\w+)?$/.exec(e);t&&(this.path=t[0],this.directory=t[1],this.file=t[2]),this.source="",this.getURI()}toRelative(e){if("./"===e)return e;let t=new URI(e,{base_uri:this});if("mce_host"!==t.host&&this.host!==t.host&&t.host||this.port!==t.port||this.protocol!==t.protocol&&""!==t.protocol)return t.getURI();let n=this.getURI(),o=t.getURI();if(n===o||"/"===n.charAt(n.length-1)&&n.substr(0,n.length-1)===o)return n;let a=this.toRelPath(this.path,t.path);return t.query&&(a+="?"+t.query),t.anchor&&(a+="#"+t.anchor),a}toAbsolute(e,t){let n=new URI(e,{base_uri:this});return n.getURI(t&&this.isSameOrigin(n))}isSameOrigin(e){if(this.host==e.host&&this.protocol==e.protocol){if(this.port==e.port)return!0;let t=this.protocol?ad[this.protocol]:null;if(t&&(this.port||t)==(e.port||t))return!0}return!1}toRelPath(e,t){let n=0,o="",a,i,l=e.substring(0,e.lastIndexOf("/")).split("/"),s=t.split("/");if(l.length>=s.length){for(a=0,i=l.length;a<i;a++)if(a>=s.length||l[a]!==s[a]){n=a+1;break}}if(l.length<s.length){for(a=0,i=s.length;a<i;a++)if(a>=l.length||l[a]!==s[a]){n=a+1;break}}if(1===n)return t;for(a=0,i=l.length-(n-1);a<i;a++)o+="../";for(a=n-1,i=s.length;a<i;a++)a!==n-1?o+="/"+s[a]:o+=s[a];return o}toAbsPath(e,t){let n,o=0,a=/\/$/.test(t)?"/":"",i=e.split("/"),l=t.split("/"),s=[];ai(i,e=>{e&&s.push(e)});let d=[];for(let e=l.length-1;e>=0;e--)if(0!==l[e].length&&"."!==l[e]){if(".."===l[e]){o++;continue}if(o>0){o--;continue}d.push(l[e])}let c=s.length-o;return 0!==(n=c<=0?reverse(d).join("/"):s.slice(0,c).join("/")+"/"+reverse(d).join("/")).indexOf("/")&&(n="/"+n),a&&n.lastIndexOf("/")!==n.length-1&&(n+=a),n}getURI(e=!1){let t;return(!this.source||e)&&(t="",!e&&(this.protocol?t+=this.protocol+"://":t+="//",this.userInfo&&(t+=this.userInfo+"@"),this.host&&(t+=this.host),this.port&&(t+=":"+this.port)),this.path&&(t+=this.path),this.query&&(t+="?"+this.query),this.anchor&&(t+="#"+this.anchor),this.source=t),this.source}};let am=eb.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),au="data-mce-type",ap=0,processNode=(e,t,n,o)=>{var a,i,l,s;let d=t.validate,c=n.getSpecialElements();8===e.nodeType&&!t.allow_conditional_comments&&/^\[if/i.test(null!==(a=e.nodeValue)&&void 0!==a?a:"")&&(e.nodeValue=" "+e.nodeValue);let m=null!==(i=null==o?void 0:o.tagName)&&void 0!==i?i:e.nodeName.toLowerCase();if(1!==e.nodeType||"body"===m)return;let u=eS.fromDom(e),p=has$1(u,au),g=get$9(u,"data-mce-bogus");if(!p&&k(g)){"all"===g?remove$5(u):unwrap(u);return}let f=n.getElementRule(m);if(d&&!f){has$2(c,m)?remove$5(u):unwrap(u);return}if(isNonNullable(o)&&(o.allowedTags[m]=!0),d&&f&&!p){if(each$e(null!==(l=f.attributesForced)&&void 0!==l?l:[],e=>{set$3(u,e.name,"{$uid}"===e.value?`mce_${ap++}`:e.value)}),each$e(null!==(s=f.attributesDefault)&&void 0!==s?s:[],e=>{has$1(u,e.name)||set$3(u,e.name,"{$uid}"===e.value?`mce_${ap++}`:e.value)}),f.attributesRequired&&!exists(f.attributesRequired,e=>has$1(u,e))||f.removeEmptyAttrs&&hasNone(u)){unwrap(u);return}f.outputName&&f.outputName!==m&&mutate(u,f.outputName)}},shouldKeepAttribute=(e,t,n,o,a)=>!(o in am&&isInvalidUri(e,a,n))&&(!e.validate||t.isValid(n,o)||startsWith(o,"data-")||startsWith(o,"aria-")),isRequiredAttributeOfInternalElement=(e,t)=>e.hasAttribute(au)&&("id"===t||"class"===t||"style"===t),isBooleanAttribute=(e,t)=>e in t.getBoolAttrs(),filterAttributes=(e,t,n)=>{let{attributes:o}=e;for(let a=o.length-1;a>=0;a--){let i=o[a],l=i.name,s=i.value;shouldKeepAttribute(t,n,e.tagName.toLowerCase(),l,s)||isRequiredAttributeOfInternalElement(e,l)?isBooleanAttribute(l,n)&&e.setAttribute(l,l):e.removeAttribute(l)}},setupPurify=(e,t)=>{let n=aa();return n.addHook("uponSanitizeElement",(n,o)=>{processNode(n,e,t,o)}),n.addHook("uponSanitizeAttribute",(n,o)=>{let a=n.tagName.toLowerCase(),{attrName:i,attrValue:l}=o;o.keepAttr=shouldKeepAttribute(e,t,a,i,l),o.keepAttr?(o.allowedAttributes[i]=!0,isBooleanAttribute(i,t)&&(o.attrValue=i),e.allow_svg_data_urls&&startsWith(l,"data:image/svg+xml")&&(o.forceKeepAttr=!0)):isRequiredAttributeOfInternalElement(n,i)&&(o.forceKeepAttr=!0)}),n},getPurifyConfig=(e,t)=>{let n={IN_PLACE:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ALLOWED_TAGS:["#comment","#cdata-section","body"],ALLOWED_ATTR:[]};return n.PARSER_MEDIA_TYPE=t,e.allow_script_urls?n.ALLOWED_URI_REGEXP=/.*/:e.allow_html_data_urls&&(n.ALLOWED_URI_REGEXP=/^(?!(\w+script|mhtml):)/i),n},getSanitizer=(e,t)=>{if(!e.sanitize)return(n,o)=>{let a;let i=document.createNodeIterator(n,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT);for(;a=i.nextNode();)processNode(a,e,t),eR(a)&&filterAttributes(a,e,t)};{let n=setupPurify(e,t);return(t,o)=>{n.sanitize(t,getPurifyConfig(e,o)),n.removed=[]}}},ag=eb.makeMap,af=eb.extend,transferChildren=(e,t,n)=>{let o=e.name,a=o in n&&"title"!==o&&"textarea"!==o,i=t.childNodes;for(let t=0,o=i.length;t<o;t++){let o=i[t],l=new AstNode(o.nodeName.toLowerCase(),o.nodeType);if(eR(o)){let e=o.attributes;for(let t=0,n=e.length;t<n;t++){let n=e[t];l.attr(n.name,n.value)}}else ew(o)?(l.value=o.data,a&&(l.raw=!0)):(eB(o)||eA(o)||eT(o))&&(l.value=o.data);transferChildren(l,o,n),e.append(l)}},walkTree=(e,t,n)=>{let o=[];for(let n=e,a=n;n;a=n,n=n.walk()){let i=n;each$e(t,e=>e(i)),isNullable(i.parent)&&i!==e?n=a:o.push(i)}for(let e=o.length-1;e>=0;e--){let t=o[e];each$e(n,e=>e(t))}},whitespaceCleaner=(e,t,n,o)=>{let a=n.validate,i=t.getNonEmptyElements(),l=t.getWhitespaceElements(),s=af(ag("script,style,head,html,body,title,meta,param"),t.getBlockElements()),d=getTextRootBlockElements(t),c=/[ \t\r\n]+/g,m=/^[ \t\r\n]+/,u=/[ \t\r\n]+$/,hasWhitespaceParent=e=>{let t=e.parent;for(;isNonNullable(t);){if(t.name in l)return!0;t=t.parent}return!1},isTextRootBlockEmpty=e=>{let n=e;for(;isNonNullable(n);){if(n.name in d)return isEmpty(t,i,l,n);n=n.parent}return!1},isBlock=e=>e.name in s||isTransparentAstBlock(t,e),isAtEdgeOfBlock=(t,n)=>{let a=n?t.prev:t.next;return!(isNonNullable(a)||isNullable(t.parent))&&isBlock(t.parent)&&(t.parent!==e||!0===o.isRootContent)};return[e=>{var t;if(3===e.type&&!hasWhitespaceParent(e)){let n=null!==(t=e.value)&&void 0!==t?t:"";n=n.replace(c," "),(isLineBreakNode(e.prev,isBlock)||isAtEdgeOfBlock(e,!0))&&(n=n.replace(m,"")),0===n.length?e.remove():e.value=n}},e=>{var s;if(1===e.type){let s=t.getElementRule(e.name);if(a&&s){let a=isEmpty(t,i,l,e);s.paddInEmptyBlock&&a&&isTextRootBlockEmpty(e)?paddEmptyNode(n,o,isBlock,e):s.removeEmpty&&a?isBlock(e)?e.remove():e.unwrap():s.paddEmpty&&(a||isPaddedWithNbsp(e))&&paddEmptyNode(n,o,isBlock,e)}}else if(3===e.type&&!hasWhitespaceParent(e)){let t=null!==(s=e.value)&&void 0!==s?s:"";(e.next&&isBlock(e.next)||isAtEdgeOfBlock(e,!1))&&(t=t.replace(u,"")),0===t.length?e.remove():e.value=t}}]},getRootBlockName=(e,t)=>{var n;let o=null!==(n=t.forced_root_block)&&void 0!==n?n:e.forced_root_block;return!1===o?"":!0===o?"p":o},DomParser=(e={},t=Schema())=>{let n=create$8(),o=create$8(),a={validate:!0,root_name:"body",sanitize:!0,...e},i=new DOMParser,l=getSanitizer(a,t),parseAndSanitizeWithContext=(e,n,o="html")=>{let a="xhtml"===o?"application/xhtml+xml":"text/html",s=has$2(t.getSpecialElements(),n.toLowerCase()),d=s?`<${n}>${e}</${n}>`:e,c="xhtml"===o?`<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>${d}</body></html>`:`<body>${d}</body>`,m=i.parseFromString(c,a).body;return l(m,a),s?m.firstChild:m},s=n.addFilter,d=n.getFilters,c=n.removeFilter,m=o.addFilter,u=o.getFilters,p=o.removeFilter,findInvalidChildren=(e,n)=>{isInvalid(t,e)&&n.push(e)},isWrappableNode=(e,n)=>{let o=k(n.attr(au)),a=1===n.type&&!has$2(e,n.name)&&!isTransparentAstBlock(t,n);return 3===n.type||a&&!o},addRootBlocks=(e,n)=>{let o=af(ag("script,style,head,html,body,title,meta,param"),t.getBlockElements()),i=/^[ \t\r\n]+/,l=/[ \t\r\n]+$/,s=e.firstChild,d=null,trim=e=>{var t,n;e&&((s=e.firstChild)&&3===s.type&&(s.value=null===(t=s.value)||void 0===t?void 0:t.replace(i,"")),(s=e.lastChild)&&3===s.type&&(s.value=null===(n=s.value)||void 0===n?void 0:n.replace(l,"")))};if(t.isValidChild(e.name,n.toLowerCase())){for(;s;){let t=s.next;isWrappableNode(o,s)?(d||((d=new AstNode(n,1)).attr(a.forced_root_block_attrs),e.insert(d,s)),d.append(s)):(trim(d),d=null),s=t}trim(d)}},g={schema:t,addAttributeFilter:m,getAttributeFilters:u,removeAttributeFilter:p,addNodeFilter:s,getNodeFilters:d,removeNodeFilter:c,parse:(e,n={})=>{var o;let i=a.validate,l=null!==(o=n.context)&&void 0!==o?o:a.root_name,s=parseAndSanitizeWithContext(e,l,n.format);updateChildren(t,s);let c=new AstNode(l,11);transferChildren(c,s,t.getSpecialElements()),s.innerHTML="";let[m,p]=whitespaceCleaner(c,t,a,n),g=[],f=i?e=>findInvalidChildren(e,g):noop,h={nodes:{},attributes:{}},matchFinder=e=>matchNode$1(d(),u(),e,h);if(walkTree(c,[m,matchFinder],[p,f]),g.reverse(),i&&g.length>0){if(n.context){let{pass:e,fail:o}=partition$2(g,e=>e.parent===c);cleanInvalidNodes(o,t,c,matchFinder),n.invalid=e.length>0}else cleanInvalidNodes(g,t,c,matchFinder)}let b=getRootBlockName(a,n);return b&&("body"===c.name||n.isRootContent)&&addRootBlocks(c,b),n.invalid||runFilters(h,n),c}};return register$4(g,a),register$5(g,a,t),g},serializeContent=e=>isTreeNode(e)?HtmlSerializer({validate:!1}).serialize(e):e,withSerializedContent=(e,t,n)=>{let o=serializeContent(e),a=t(o);if(a.isDefaultPrevented()||!isTreeNode(e))return a;if(a.content===o)return{...a,content:e};{let t=DomParser({validate:!1,forced_root_block:!1,sanitize:n}).parse(a.content,{context:e.name});return{...a,content:t}}},preProcessGetContent=(e,t)=>{if(t.no_events)return tV.value(t);{let n=fireBeforeGetContent(e,t);return n.isDefaultPrevented()?tV.error(fireGetContent(e,{content:"",...n}).content):tV.value(n)}},postProcessGetContent=(e,t,n)=>{if(n.no_events)return t;{let o=withSerializedContent(t,t=>fireGetContent(e,{...n,content:t}),rp(e));return o.content}},preProcessSetContent=(e,t)=>{if(t.no_events)return tV.value(t);{let n=withSerializedContent(t.content,n=>fireBeforeSetContent(e,{...t,content:n}),rp(e));return n.isDefaultPrevented()?(fireSetContent(e,n),tV.error(void 0)):tV.value(n)}},postProcessSetContent=(e,t,n)=>{n.no_events||fireSetContent(e,{...n,content:t})},tableModel=(e,t,n)=>({element:e,width:t,rows:n}),tableRow=(e,t)=>({element:e,cells:t}),cellPosition=(e,t)=>({x:e,y:t}),getSpan=(e,t)=>getOpt(e,t).bind(toInt).getOr(1),fillout=(e,t,n,o,a)=>{let i=getSpan(a,"rowspan"),l=getSpan(a,"colspan"),s=e.rows;for(let e=n;e<n+i;e++){s[e]||(s[e]=tableRow(deep$1(o),[]));for(let o=t;o<t+l;o++){let i=s[e].cells;i[o]=e===n&&o===t?a:shallow$1(a)}}},cellExists=(e,t,n)=>{let o=e.rows,a=o[n]?o[n].cells:[];return!!a[t]},skipCellsX=(e,t,n)=>{for(;cellExists(e,t,n);)t++;return t},getWidth=e=>foldl(e,(e,t)=>t.cells.length>e?t.cells.length:e,0),findElementPos=(e,t)=>{let n=e.rows;for(let e=0;e<n.length;e++){let o=n[e].cells;for(let n=0;n<o.length;n++)if(eq(o[n],t))return Optional.some(cellPosition(n,e))}return Optional.none()},extractRows=(e,t,n,o,a)=>{let i=[],l=e.rows;for(let e=n;e<=a;e++){let n=l[e].cells,a=t<o?n.slice(t,o+1):n.slice(o,t+1);i.push(tableRow(l[e].element,a))}return i},subTable=(e,t,n)=>{let o=t.x,a=t.y,i=n.x,l=n.y,s=a<l?extractRows(e,o,a,i,l):extractRows(e,o,l,i,a);return tableModel(e.element,getWidth(s),s)},createDomTable=(e,t)=>{let n=shallow$1(e.element),o=eS.fromTag("tbody");return append(o,t),append$1(n,o),n},modelRowsToDomRows=e=>map$3(e.rows,e=>{let t=map$3(e.cells,e=>{let t=deep$1(e);return remove$a(t,"colspan"),remove$a(t,"rowspan"),t}),n=shallow$1(e.element);return append(n,t),n}),fromDom=e=>{let t=tableModel(shallow$1(e),0,[]);return each$e(descendants(e,"tr"),(e,n)=>{each$e(descendants(e,"td,th"),(o,a)=>{fillout(t,skipCellsX(t,a,n),n,e,o)})}),tableModel(t.element,getWidth(t.rows),t.rows)},toDom=e=>createDomTable(e,modelRowsToDomRows(e)),subsection=(e,t,n)=>findElementPos(e,t).bind(t=>findElementPos(e,n).map(n=>subTable(e,t,n))),findParentListContainer=e=>find$2(e,e=>"ul"===name(e)||"ol"===name(e)),getFullySelectedListWrappers=(e,t)=>find$2(e,e=>"li"===name(e)&&hasAllContentsSelected(e,t)).fold(constant([]),t=>findParentListContainer(e).map(e=>{let t=eS.fromTag(name(e)),n=filter$4(getAllRaw(e),(e,t)=>startsWith(t,"list-style"));return setAll(t,n),[eS.fromTag("li"),t]}).getOr([])),wrap=(e,t)=>{let n=foldl(t,(e,t)=>(append$1(t,e),t),e);return t.length>0?fromElements([n]):n},directListWrappers=e=>eQ(e)?parent(e).filter(eZ).fold(constant([]),t=>[e,t]):eZ(e)?[e]:[],getWrapElements=(e,t)=>{let n=eS.fromDom(t.commonAncestorContainer),o=parentsAndSelf(n,e),a=filter$5(o,isWrapElement),i=getFullySelectedListWrappers(o,t),l=a.concat(i.length?i:directListWrappers(n));return map$3(l,shallow$1)},emptyFragment=()=>fromElements([]),getFragmentFromRange=(e,t)=>wrap(eS.fromDom(t.cloneContents()),getWrapElements(e,t)),getParentTable=(e,t)=>ancestor$3(t,"table",curry(eq,e)),getTableFragment=(e,t)=>getParentTable(e,t[0]).bind(e=>{let n=t[0],o=t[t.length-1],a=fromDom(e);return subsection(a,n,o).map(e=>fromElements([toDom(e)]))}).getOrThunk(emptyFragment),getSelectionFragment=(e,t)=>t.length>0&&t[0].collapsed?emptyFragment():getFragmentFromRange(e,t[0]),read$3=(e,t)=>{let n=getCellsFromElementOrRanges(t,e);return n.length>0?getTableFragment(e,n):getSelectionFragment(e,t)},isCollapsibleWhitespace=(e,t)=>t>=0&&t<e.length&&isWhiteSpace(e.charAt(t)),getInnerText=e=>trim$2(e.innerText),getContextNodeName=e=>e.map(e=>e.nodeName).getOr("div").toLowerCase(),getTextContent=e=>Optional.from(e.selection.getRng()).map(t=>{var n;let o=Optional.from(e.dom.getParent(t.commonAncestorContainer,e.dom.isBlock)),a=e.getBody(),i=getContextNodeName(o),l=eS.fromDom(t.cloneContents());cleanupBogusElements(l),cleanupInputNames(l);let s=e.dom.add(a,i,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},l.dom),d=getInnerText(s),c=trim$2(null!==(n=s.textContent)&&void 0!==n?n:"");if(e.dom.remove(s),!(isCollapsibleWhitespace(c,0)||isCollapsibleWhitespace(c,c.length-1)))return d;{let e=o.getOr(a),t=getInnerText(e),n=t.indexOf(d);if(-1===n)return d;{let e=isCollapsibleWhitespace(t,n-1),o=isCollapsibleWhitespace(t,n+d.length);return(e?" ":"")+d+(o?" ":"")}}}).getOr(""),getSerializedContent=(e,t)=>{let n=e.selection.getRng(),o=e.dom.create("body"),a=e.selection.getSel(),i=processRanges(e,getRanges$1(a)),l=t.contextual?read$3(eS.fromDom(e.getBody()),i).dom:n.cloneContents();return l&&o.appendChild(l),e.selection.serializer.serialize(o,t)},extractSelectedContent=(e,t)=>{if("text"===t.format)return getTextContent(e);{let n=getSerializedContent(e,t);return"tree"===t.format?n:e.selection.isCollapsed()?"":n}},setupArgs$3=(e,t)=>({...e,format:t,get:!0,selection:!0,getInner:!0}),getSelectedContentInternal=(e,t,n={})=>{let o=setupArgs$3(n,t);return preProcessGetContent(e,o).fold(identity,t=>{let n=extractSelectedContent(e,t);return postProcessGetContent(e,n,t)})},diff=(e,t)=>{let n=e.length+t.length+2,o=Array(n),a=Array(n),snake=(e,t,n)=>({start:e,end:t,diag:n}),buildScript=(n,o,a,i,l)=>{let s=getMiddleSnake(n,o,a,i);if(null===s||s.start===o&&s.diag===o-i||s.end===n&&s.diag===n-a){let s=n,d=a;for(;s<o||d<i;)s<o&&d<i&&e[s]===t[d]?(l.push([0,e[s]]),++s,++d):o-n>i-a?(l.push([2,e[s]]),++s):(l.push([1,t[d]]),++d)}else{buildScript(n,s.start,a,s.start-s.diag,l);for(let t=s.start;t<s.end;++t)l.push([0,e[t]]);buildScript(s.end,o,s.end-s.diag,i,l)}},buildSnake=(n,o,a,i)=>{let l=n;for(;l-o<i&&l<a&&e[l]===t[l-o];)++l;return snake(n,l,o)},getMiddleSnake=(n,i,l,s)=>{let d,c,m,u,p;let g=i-n,f=s-l;if(0===g||0===f)return null;let h=g-f,b=f+g,C=(b%2==0?b:b+1)/2;for(d=0,o[1+C]=n,a[1+C]=i+1;d<=C;++d){for(c=-d;c<=d;c+=2){for(m=c+C,c===-d||c!==d&&o[m-1]<o[m+1]?o[m]=o[m+1]:o[m]=o[m-1]+1,p=(u=o[m])-n+l-c;u<i&&p<s&&e[u]===t[p];)o[m]=++u,++p;if(h%2!=0&&h-d<=c&&c<=h+d&&a[m-h]<=o[m])return buildSnake(a[m-h],c+n-l,i,s)}for(c=h-d;c<=h+d;c+=2){for(m=c+C-h,c===h-d||c!==h+d&&a[m+1]<=a[m-1]?a[m]=a[m+1]-1:a[m]=a[m-1],p=(u=a[m]-1)-n+l-c;u>=n&&p>=l&&e[u]===t[p];)a[m]=u--,p--;if(h%2==0&&-d<=c&&c<=d&&a[m]<=o[m+h])return buildSnake(a[m],c+n-l,i,s)}}return null},i=[];return buildScript(0,e.length,0,t.length,i),i},getOuterHtml=e=>eR(e)?e.outerHTML:ew(e)?tu.encodeRaw(e.data,!1):eB(e)?"<!--"+e.data+"-->":"",createFragment=e=>{let t;let n=document.createElement("div"),o=document.createDocumentFragment();for(e&&(n.innerHTML=e);t=n.firstChild;)o.appendChild(t);return o},insertAt=(e,t,n)=>{let o=createFragment(t);if(e.hasChildNodes()&&n<e.childNodes.length){let t=e.childNodes[n];e.insertBefore(o,t)}else e.appendChild(o)},removeAt=(e,t)=>{if(e.hasChildNodes()&&t<e.childNodes.length){let n=e.childNodes[t];e.removeChild(n)}},applyDiff=(e,t)=>{let n=0;each$e(e,e=>{0===e[0]?n++:1===e[0]?(insertAt(t,e[1],n),n++):2===e[0]&&removeAt(t,n)})},read$2=(e,t)=>filter$5(map$3(I(e.childNodes),t?compose(trim$2,getOuterHtml):getOuterHtml),e=>e.length>0),write=(e,t)=>{let n=map$3(I(t.childNodes),getOuterHtml);return applyDiff(diff(n,e),t),t},ah=cached(()=>document.implementation.createHTMLDocument("undo")),hasIframes=e=>null!==e.querySelector("iframe"),createFragmentedLevel=e=>({type:"fragmented",fragments:e,content:"",bookmark:null,beforeBookmark:null}),createCompleteLevel=e=>({type:"complete",fragments:null,content:e,bookmark:null,beforeBookmark:null}),createFromEditor=e=>{let t=e.serializer.getTempAttrs(),n=trim$1(e.getBody(),t);return hasIframes(n)?createFragmentedLevel(read$2(n,!0)):createCompleteLevel(trim$2(n.innerHTML))},applyToEditor=(e,t,n)=>{let o=n?t.beforeBookmark:t.bookmark;"fragmented"===t.type?write(t.fragments,e.getBody()):e.setContent(t.content,{format:"raw",no_selection:!(isNonNullable(o)&&isPathBookmark(o))||!o.isFakeCaret}),o&&(e.selection.moveToBookmark(o),e.selection.scrollIntoView())},getLevelContent=e=>"fragmented"===e.type?e.fragments.join(""):e.content,getCleanLevelContent=e=>{let t=eS.fromTag("body",ah());return set$1(t,getLevelContent(e)),each$e(descendants(t,"*[data-mce-bogus]"),unwrap),get$6(t)},hasEqualContent=(e,t)=>getLevelContent(e)===getLevelContent(t),hasEqualCleanedContent=(e,t)=>getCleanLevelContent(e)===getCleanLevelContent(t),isEq$1=(e,t)=>!!e&&!!t&&(!!hasEqualContent(e,t)||hasEqualCleanedContent(e,t)),isUnlocked=e=>0===e.get(),setTyping=(e,t,n)=>{isUnlocked(n)&&(e.typing=t)},endTyping=(e,t)=>{e.typing&&(setTyping(e,!1,t),e.add())},endTypingLevelIgnoreLocks=e=>{e.typing&&(e.typing=!1,e.add())},beforeChange$1=(e,t,n)=>{isUnlocked(t)&&n.set(tH(e.selection))},addUndoLevel$1=(e,t,n,o,a,i,l)=>{let s=createFromEditor(e),d=eb.extend(i||{},s);if(!isUnlocked(o)||e.removed)return null;let c=t.data[n.get()];if(e.dispatch("BeforeAddUndo",{level:d,lastLevel:c,originalEvent:l}).isDefaultPrevented()||c&&isEq$1(c,d))return null;t.data[n.get()]&&a.get().each(e=>{t.data[n.get()].beforeBookmark=e});let m=nU(e);if(m&&t.data.length>m){for(let e=0;e<t.data.length-1;e++)t.data[e]=t.data[e+1];t.data.length--,n.set(t.data.length)}d.bookmark=tH(e.selection),n.get()<t.data.length-1&&(t.data.length=n.get()+1),t.data.push(d),n.set(t.data.length-1);let u={level:d,lastLevel:c,originalEvent:l};return n.get()>0?(e.setDirty(!0),e.dispatch("AddUndo",u),e.dispatch("change",u)):e.dispatch("AddUndo",u),d},clear$1=(e,t,n)=>{t.data=[],n.set(0),t.typing=!1,e.dispatch("ClearUndos")},extra$1=(e,t,n,o,a)=>{if(t.transact(o)){let o=t.data[n.get()].bookmark,i=t.data[n.get()-1];applyToEditor(e,i,!0),t.transact(a)&&(t.data[n.get()-1].beforeBookmark=o)}},redo$1=(e,t,n)=>{let o;return t.get()<n.length-1&&(t.set(t.get()+1),applyToEditor(e,o=n[t.get()],!1),e.setDirty(!0),e.dispatch("Redo",{level:o})),o},undo$1=(e,t,n,o)=>{let a;return t.typing&&(t.add(),t.typing=!1,setTyping(t,!1,n)),o.get()>0&&(o.set(o.get()-1),applyToEditor(e,a=t.data[o.get()],!0),e.setDirty(!0),e.dispatch("Undo",{level:a})),a},reset$1=e=>{e.clear(),e.add()},hasUndo$1=(e,t,n)=>n.get()>0||t.typing&&t.data[0]&&!isEq$1(createFromEditor(e),t.data[0]),hasRedo$1=(e,t)=>t.get()<e.data.length-1&&!e.typing,transact$1=(e,t,n)=>(endTyping(e,t),e.beforeChange(),e.ignore(n),e.add()),ignore$1=(e,t)=>{try{e.set(e.get()+1),t()}finally{e.set(e.get()-1)}},addVisualInternal=(e,t)=>{let n=e.dom,o=isNonNullable(t)?t:e.getBody();each$e(n.select("table,a",o),t=>{switch(t.nodeName){case"TABLE":let o=nY(e),a=n.getAttrib(t,"border");(!a||"0"===a)&&e.hasVisual?n.addClass(t,o):n.removeClass(t,o);break;case"A":if(!n.getAttrib(t,"href")){let o=n.getAttrib(t,"name")||t.id,a=nX(e);o&&e.hasVisual?n.addClass(t,a):n.removeClass(t,a)}}}),e.dispatch("VisualAid",{element:t,hasVisual:e.hasVisual})},makePlainAdaptor=e=>({init:{bindEvents:noop},undoManager:{beforeChange:(t,n)=>beforeChange$1(e,t,n),add:(t,n,o,a,i,l)=>addUndoLevel$1(e,t,n,o,a,i,l),undo:(t,n,o)=>undo$1(e,t,n,o),redo:(t,n)=>redo$1(e,t,n),clear:(t,n)=>clear$1(e,t,n),reset:e=>reset$1(e),hasUndo:(t,n)=>hasUndo$1(e,t,n),hasRedo:(e,t)=>hasRedo$1(e,t),transact:(e,t,n)=>transact$1(e,t,n),ignore:(e,t)=>ignore$1(e,t),extra:(t,n,o,a)=>extra$1(e,t,n,o,a)},formatter:{match:(t,n,o,a)=>match$2(e,t,n,o,a),matchAll:(t,n)=>matchAll(e,t,n),matchNode:(t,n,o,a)=>matchNode(e,t,n,o,a),canApply:t=>canApply(e,t),closest:t=>closest(e,t),apply:(t,n,o)=>applyFormat$1(e,t,n,o),remove:(t,n,o,a)=>removeFormat$1(e,t,n,o,a),toggle:(t,n,o)=>toggle(e,t,n,o),formatChanged:(t,n,o,a,i)=>formatChangedInternal(e,t,n,o,a,i)},editor:{getContent:t=>getContentInternal(e,t),setContent:(t,n)=>setContentInternal(e,t,n),insertContent:(t,n)=>insertHtmlAtCaret(e,t,n),addVisual:t=>addVisualInternal(e,t)},selection:{getContent:(t,n)=>getSelectedContentInternal(e,t,n)},autocompleter:{addDecoration:t=>create$9(e,t),removeDecoration:()=>remove$2(e,eS.fromDom(e.getBody()))},raw:{getModel:()=>Optional.none()}}),makeRtcAdaptor=e=>{let defaultVars=e=>$(e)?e:{},{init:t,undoManager:n,formatter:o,editor:a,selection:i,autocompleter:l,raw:s}=e;return{init:{bindEvents:t.bindEvents},undoManager:{beforeChange:n.beforeChange,add:n.add,undo:n.undo,redo:n.redo,clear:n.clear,reset:n.reset,hasUndo:n.hasUndo,hasRedo:n.hasRedo,transact:(e,t,o)=>n.transact(o),ignore:(e,t)=>n.ignore(t),extra:(e,t,o,a)=>n.extra(o,a)},formatter:{match:(e,t,n,a)=>o.match(e,defaultVars(t),a),matchAll:o.matchAll,matchNode:o.matchNode,canApply:e=>o.canApply(e),closest:e=>o.closest(e),apply:(e,t,n)=>o.apply(e,defaultVars(t)),remove:(e,t,n,a)=>o.remove(e,defaultVars(t)),toggle:(e,t,n)=>o.toggle(e,defaultVars(t)),formatChanged:(e,t,n,a,i)=>o.formatChanged(t,n,a,i)},editor:{getContent:e=>a.getContent(e),setContent:(e,t)=>({content:a.setContent(e,t),html:""}),insertContent:(e,t)=>(a.insertContent(e),""),addVisual:a.addVisual},selection:{getContent:(e,t)=>i.getContent(t)},autocompleter:{addDecoration:l.addDecoration,removeDecoration:l.removeDecoration},raw:{getModel:()=>Optional.some(s.getRawModel())}}},makeNoopAdaptor=()=>{let e=constant(null),t=constant("");return{init:{bindEvents:noop},undoManager:{beforeChange:noop,add:e,undo:e,redo:e,clear:noop,reset:noop,hasUndo:w,hasRedo:w,transact:e,ignore:noop,extra:noop},formatter:{match:w,matchAll:constant([]),matchNode:constant(void 0),canApply:w,closest:t,apply:noop,remove:noop,toggle:noop,formatChanged:constant({unbind:noop})},editor:{getContent:t,setContent:constant({content:"",html:""}),insertContent:constant(""),addVisual:noop},selection:{getContent:t},autocompleter:{addDecoration:noop,removeDecoration:noop},raw:{getModel:constant(Optional.none())}}},isRtc=e=>has$2(e.plugins,"rtc"),getRtcSetup=e=>get$a(e.plugins,"rtc").bind(e=>Optional.from(e.setup)),setup$s=e=>getRtcSetup(e).fold(()=>(e.rtcInstance=makePlainAdaptor(e),Optional.none()),t=>(e.rtcInstance=makeNoopAdaptor(),Optional.some(()=>t().then(t=>(e.rtcInstance=makeRtcAdaptor(t),t.rtc.isRemote))))),getRtcInstanceWithFallback=e=>e.rtcInstance?e.rtcInstance:makePlainAdaptor(e),getRtcInstanceWithError=e=>{let t=e.rtcInstance;if(t)return t;throw Error("Failed to get RTC instance not yet initialized.")},beforeChange=(e,t,n)=>{getRtcInstanceWithError(e).undoManager.beforeChange(t,n)},addUndoLevel=(e,t,n,o,a,i,l)=>getRtcInstanceWithError(e).undoManager.add(t,n,o,a,i,l),undo=(e,t,n,o)=>getRtcInstanceWithError(e).undoManager.undo(t,n,o),redo=(e,t,n)=>getRtcInstanceWithError(e).undoManager.redo(t,n),clear=(e,t,n)=>{getRtcInstanceWithError(e).undoManager.clear(t,n)},reset=(e,t)=>{getRtcInstanceWithError(e).undoManager.reset(t)},hasUndo=(e,t,n)=>getRtcInstanceWithError(e).undoManager.hasUndo(t,n),hasRedo=(e,t,n)=>getRtcInstanceWithError(e).undoManager.hasRedo(t,n),transact=(e,t,n,o)=>getRtcInstanceWithError(e).undoManager.transact(t,n,o),ignore=(e,t,n)=>{getRtcInstanceWithError(e).undoManager.ignore(t,n)},extra=(e,t,n,o,a)=>{getRtcInstanceWithError(e).undoManager.extra(t,n,o,a)},matchFormat=(e,t,n,o,a)=>getRtcInstanceWithError(e).formatter.match(t,n,o,a),matchAllFormats=(e,t,n)=>getRtcInstanceWithError(e).formatter.matchAll(t,n),matchNodeFormat=(e,t,n,o,a)=>getRtcInstanceWithError(e).formatter.matchNode(t,n,o,a),canApplyFormat=(e,t)=>getRtcInstanceWithError(e).formatter.canApply(t),closestFormat=(e,t)=>getRtcInstanceWithError(e).formatter.closest(t),applyFormat=(e,t,n,o)=>{getRtcInstanceWithError(e).formatter.apply(t,n,o)},removeFormat=(e,t,n,o,a)=>{getRtcInstanceWithError(e).formatter.remove(t,n,o,a)},toggleFormat=(e,t,n,o)=>{getRtcInstanceWithError(e).formatter.toggle(t,n,o)},formatChanged=(e,t,n,o,a,i)=>getRtcInstanceWithError(e).formatter.formatChanged(t,n,o,a,i),getContent$2=(e,t)=>getRtcInstanceWithFallback(e).editor.getContent(t),setContent$2=(e,t,n)=>getRtcInstanceWithFallback(e).editor.setContent(t,n),insertContent$1=(e,t,n)=>getRtcInstanceWithFallback(e).editor.insertContent(t,n),getSelectedContent=(e,t,n)=>getRtcInstanceWithError(e).selection.getContent(t,n),addVisual$1=(e,t)=>getRtcInstanceWithError(e).editor.addVisual(t),bindEvents=e=>getRtcInstanceWithError(e).init.bindEvents(),addAutocompleterDecoration=(e,t)=>getRtcInstanceWithError(e).autocompleter.addDecoration(t),removeAutocompleterDecoration=e=>getRtcInstanceWithError(e).autocompleter.removeDecoration(),getContent$1=(e,t={})=>{let n=t.format?t.format:"html";return getSelectedContent(e,n,t)},removeEmpty=e=>0===e.dom.length?(remove$5(e),Optional.none()):Optional.some(e),walkPastBookmark=(e,t)=>e.filter(e=>BookmarkManager.isBookmarkNode(e.dom)).bind(t?nextSibling:prevSibling),merge$1=(e,t,n,o)=>{let a=e.dom,i=t.dom,l=o?a.length:i.length;o?(mergeTextNodes(a,i,!1,!o),n.setStart(i,l)):(mergeTextNodes(i,a,!1,!o),n.setEnd(i,l))},normalizeTextIfRequired=(e,t)=>{parent(e).each(n=>{let o=e.dom;t&&needsToBeNbspLeft(n,CaretPosition(o,0))?normalizeWhitespaceAfter(o,0):!t&&needsToBeNbspRight(n,CaretPosition(o,o.length))&&normalizeWhitespaceBefore(o,o.length)})},mergeAndNormalizeText=(e,t,n,o)=>{e.bind(e=>{let a=o?normalizeWhitespaceBefore:normalizeWhitespaceAfter;return a(e.dom,o?e.dom.length:0),t.filter(eE).map(t=>merge$1(e,t,n,o))}).orThunk(()=>{let e=walkPastBookmark(t,o).or(t).filter(eE);return e.map(e=>normalizeTextIfRequired(e,o))})},rngSetContent=(e,t)=>{let n=Optional.from(t.firstChild).map(eS.fromDom),o=Optional.from(t.lastChild).map(eS.fromDom);e.deleteContents(),e.insertNode(t);let a=n.bind(prevSibling).filter(eE).bind(removeEmpty),i=o.bind(nextSibling).filter(eE).bind(removeEmpty);mergeAndNormalizeText(a,n,e,!0),mergeAndNormalizeText(i,o,e,!1),e.collapse(!1)},setupArgs$2=(e,t)=>({format:"html",...e,set:!0,selection:!0,content:t}),cleanContent=(e,t)=>{if("raw"===t.format)return t.content;{let n=e.selection.getRng(),o=e.dom.getParent(n.commonAncestorContainer,e.dom.isBlock),a=o?{context:o.nodeName.toLowerCase()}:{},i=e.parser.parse(t.content,{forced_root_block:!1,...a,...t});return HtmlSerializer({validate:!1},e.schema).serialize(i)}},setContent$1=(e,t,n={})=>{let o=setupArgs$2(n,t);preProcessSetContent(e,o).each(t=>{let n=cleanContent(e,t),o=e.selection.getRng();rngSetContent(o,o.createContextualFragment(n)),e.selection.setRng(o),scrollRangeIntoView(e,o),postProcessSetContent(e,n,t)})},deleteFromCallbackMap=(e,t,n)=>{if(has$2(e,t)){let o=filter$5(e[t],e=>e!==n);0===o.length?delete e[t]:e[t]=o}};var SelectorChanged=(e,t)=>{let n,o;let findMatchingNode=(t,n)=>find$2(n,n=>e.is(n,t)),getParents=t=>e.getParents(t,void 0,e.getRoot()),setup=()=>{n={},o={},t.on("NodeChange",e=>{let t=e.element,a=getParents(t),i={};each$d(n,(e,t)=>{findMatchingNode(t,a).each(n=>{o[t]||(each$e(e,e=>{e(!0,{node:n,selector:t,parents:a})}),o[t]=e),i[t]=e})}),each$d(o,(e,n)=>{i[n]||(delete o[n],each$e(e,e=>{e(!1,{node:t,selector:n,parents:a})}))})})};return{selectorChangedWithUnbind:(e,a)=>(n||setup(),n[e]||(n[e]=[]),n[e].push(a),findMatchingNode(e,getParents(t.selection.getStart())).each(()=>{o[e]=n[e]}),{unbind:()=>{deleteFromCallbackMap(n,e,a),deleteFromCallbackMap(o,e,a)}})}};let isAttachedToDom=e=>!!(e&&e.ownerDocument)&&contains(eS.fromDom(e.ownerDocument),eS.fromDom(e)),isValidRange=e=>!!e&&isAttachedToDom(e.startContainer)&&isAttachedToDom(e.endContainer),EditorSelection=(e,t,n,o)=>{let a,i;let{selectorChangedWithUnbind:l}=SelectorChanged(e,o),setContent=(e,t)=>setContent$1(o,e,t),collapse=e=>{let t=getRng$1();t.collapse(!!e),setRng(t)},getSel=()=>t.getSelection?t.getSelection():t.document.selection,getRng$1=()=>{let n;let tryCompareBoundaryPoints=(e,t,n)=>{try{return t.compareBoundaryPoints(e,n)}catch(e){return -1}},l=t.document;if(isNonNullable(o.bookmark)&&!hasFocus(o)){let e=getRng(o);if(e.isSome())return e.map(e=>processRanges(o,[e])[0]).getOr(l.createRange())}try{let e=getSel();e&&!isRestrictedNode(e.anchorNode)&&(n=e.rangeCount>0?e.getRangeAt(0):l.createRange(),n=processRanges(o,[n])[0])}catch(e){}if(n||(n=l.createRange()),eD(n.startContainer)&&n.collapsed){let t=e.getRoot();n.setStart(t,0),n.setEnd(t,0)}return a&&i&&(0===tryCompareBoundaryPoints(n.START_TO_START,n,a)&&0===tryCompareBoundaryPoints(n.END_TO_END,n,a)?n=i:(a=null,i=null)),n},setRng=(e,t)=>{if(!isValidRange(e))return;let n=getSel(),l=o.dispatch("SetSelectionRange",{range:e,forward:t});if(e=l.range,n){i=e;try{n.removeAllRanges(),n.addRange(e)}catch(e){}!1===t&&n.extend&&(n.collapse(e.endContainer,e.endOffset),n.extend(e.startContainer,e.startOffset)),a=n.rangeCount>0?n.getRangeAt(0):null}if(!e.collapsed&&e.startContainer===e.endContainer&&(null==n?void 0:n.setBaseAndExtent)&&e.endOffset-e.startOffset<2&&e.startContainer.hasChildNodes()){let t=e.startContainer.childNodes[e.startOffset];t&&"IMG"===t.nodeName&&(n.setBaseAndExtent(e.startContainer,e.startOffset,e.endContainer,e.endOffset),(n.anchorNode!==e.startContainer||n.focusNode!==e.endContainer)&&n.setBaseAndExtent(t,0,t,1))}o.dispatch("AfterSetSelectionRange",{range:e,forward:t})},isForward=()=>{let t=getSel(),n=null==t?void 0:t.anchorNode,o=null==t?void 0:t.focusNode;if(!t||!n||!o||isRestrictedNode(n)||isRestrictedNode(o))return!0;let a=e.createRng(),i=e.createRng();try{a.setStart(n,t.anchorOffset),a.collapse(!0),i.setStart(o,t.focusOffset),i.collapse(!0)}catch(e){return!0}return 0>=a.compareBoundaryPoints(a.START_TO_START,i)},s={dom:e,win:t,serializer:n,editor:o,expand:(t={type:"word"})=>setRng(RangeUtils(e).expand(getRng$1(),t)),collapse,setCursorLocation:(t,n)=>{let a=e.createRng();isNonNullable(t)&&isNonNullable(n)?(a.setStart(t,n),a.setEnd(t,n),setRng(a),collapse(!1)):(moveEndPoint(e,a,o.getBody(),!0),setRng(a))},getContent:e=>getContent$1(o,e),setContent,getBookmark:(e,t)=>d.getBookmark(e,t),moveToBookmark:e=>d.moveToBookmark(e),select:(t,n)=>(select(e,t,n).each(setRng),t),isCollapsed:()=>{let e=getRng$1(),t=getSel();return!!e&&!e.item&&(e.compareEndPoints?0===e.compareEndPoints("StartToEnd",e):!t||e.collapsed)},isEditable:()=>{let t=getRng$1(),n=o.getBody().querySelectorAll('[data-mce-selected="1"]');return n.length>0?forall(n,t=>e.isEditable(t.parentElement)):t.startContainer===t.endContainer?e.isEditable(t.startContainer):e.isEditable(t.startContainer)&&e.isEditable(t.endContainer)},isForward,setNode:t=>(setContent(e.getOuterHTML(t)),t),getNode:()=>getNode(o.getBody(),getRng$1()),getSel,setRng,getRng:getRng$1,getStart:e=>getStart(o.getBody(),getRng$1(),e),getEnd:e=>getEnd$1(o.getBody(),getRng$1(),e),getSelectedBlocks:(t,n)=>getSelectedBlocks(e,getRng$1(),t,n),normalize:()=>{let t=getRng$1(),n=getSel();if(!hasMultipleRanges(n)&&hasAnyRanges(o)){let n=normalize$2(e,t);return n.each(e=>{setRng(e,isForward())}),n.getOr(t)}return t},selectorChanged:(e,t)=>(l(e,t),s),selectorChangedWithUnbind:l,getScrollContainer:()=>{let t;let n=e.getRoot();for(;n&&"BODY"!==n.nodeName;){if(n.scrollHeight>n.clientHeight){t=n;break}n=n.parentNode}return t},scrollIntoView:(e,t)=>{isNonNullable(e)?scrollElementIntoView(o,e,t):scrollRangeIntoView(o,getRng$1(),t)},placeCaretAt:(e,t)=>setRng(fromPoint(e,t,o.getDoc())),getBoundingClientRect:()=>{let e=getRng$1();return e.collapsed?CaretPosition.fromRangeStart(e).getClientRects()[0]:e.getBoundingClientRect()},destroy:()=>{t=a=i=null,c.destroy()}},d=BookmarkManager(s),c=ControlSelection(s,o);return s.bookmarkManager=d,s.controlSelection=c,s},register$3=(e,t,n)=>{e.addAttributeFilter("data-mce-tabindex",(e,t)=>{let n=e.length;for(;n--;){let o=e[n];o.attr("tabindex",o.attr("data-mce-tabindex")),o.attr(t,null)}}),e.addAttributeFilter("src,href,style",(e,o)=>{let a="data-mce-"+o,i=t.url_converter,l=t.url_converter_scope,s=e.length;for(;s--;){let t=e[s],d=t.attr(a);void 0!==d?(t.attr(o,d.length>0?d:null),t.attr(a,null)):(d=t.attr(o),"style"===o?d=n.serializeStyle(n.parseStyle(d),t.name):i&&(d=i.call(l,d,o,t.name)),t.attr(o,d.length>0?d:null))}}),e.addAttributeFilter("class",e=>{let t=e.length;for(;t--;){let n=e[t],o=n.attr("class");o&&(o=o.replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),n.attr("class",o.length>0?o:null))}}),e.addAttributeFilter("data-mce-type",(e,t,n)=>{let o=e.length;for(;o--;){let t=e[o];if("bookmark"===t.attr("data-mce-type")&&!n.cleanup){let e=Optional.from(t.firstChild).exists(e=>{var t;return!isZwsp$2(null!==(t=e.value)&&void 0!==t?t:"")});e?t.unwrap():t.remove()}}}),e.addNodeFilter("noscript",e=>{var t;let n=e.length;for(;n--;){let o=e[n].firstChild;o&&(o.value=tu.decode(null!==(t=o.value)&&void 0!==t?t:""))}}),e.addNodeFilter("script,style",(e,n)=>{var o;let trim=e=>e.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,""),a=e.length;for(;a--;){let i=e[a],l=i.firstChild,s=null!==(o=null==l?void 0:l.value)&&void 0!==o?o:"";if("script"===n){let e=i.attr("type");e&&i.attr("type","mce-no/type"===e?null:e.replace(/^mce\-/,"")),"xhtml"===t.element_format&&l&&s.length>0&&(l.value="// <![CDATA[\n"+trim(s)+"\n// ]]>")}else"xhtml"===t.element_format&&l&&s.length>0&&(l.value="<!--\n"+trim(s)+"\n-->")}}),e.addNodeFilter("#comment",e=>{let o=e.length;for(;o--;){let a=e[o],i=a.value;t.preserve_cdata&&(null==i?void 0:i.indexOf("[CDATA["))===0?(a.name="#cdata",a.type=4,a.value=n.decode(i.replace(/^\[CDATA\[|\]\]$/g,""))):(null==i?void 0:i.indexOf("mce:protected "))===0&&(a.name="#text",a.type=3,a.raw=!0,a.value=unescape(i).substr(14))}}),e.addNodeFilter("xml:namespace,input",(e,t)=>{let n=e.length;for(;n--;){let o=e[n];7===o.type?o.remove():1!==o.type||"input"!==t||o.attr("type")||o.attr("type","text")}}),e.addAttributeFilter("data-mce-type",t=>{each$e(t,t=>{"format-caret"===t.attr("data-mce-type")&&(t.isEmpty(e.schema.getNonEmptyElements())?t.remove():t.unwrap())})}),e.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-block,data-mce-type,data-mce-resize,data-mce-placeholder",(e,t)=>{let n=e.length;for(;n--;)e[n].attr(t,null)}),t.remove_trailing_brs&&addNodeFilter(t,e,e.schema)},trimTrailingBr=e=>{let isBr=e=>(null==e?void 0:e.name)==="br",t=e.lastChild;if(isBr(t)){let e=t.prev;isBr(e)&&(t.remove(),e.remove())}},preProcess$1=(e,t,n)=>{let o;let a=e.dom,i=t.cloneNode(!0),l=document.implementation;if(l.createHTMLDocument){let e=l.createHTMLDocument("");eb.each("BODY"===i.nodeName?i.childNodes:[i],t=>{e.body.appendChild(e.importNode(t,!0))}),i="BODY"!==i.nodeName?e.body.firstChild:e.body,o=a.doc,a.doc=e}return firePreProcess(e,{...n,node:i}),o&&(a.doc=o),i},shouldFireEvent=(e,t)=>isNonNullable(e)&&e.hasEventListeners("PreProcess")&&!t.no_events,process$1=(e,t,n)=>shouldFireEvent(e,n)?preProcess$1(e,t,n):t,addTempAttr=(e,t,n)=>{-1===eb.inArray(t,n)&&(e.addAttributeFilter(n,(e,t)=>{let n=e.length;for(;n--;)e[n].attr(t,null)}),t.push(n))},postProcess=(e,t,n)=>{if(t.no_events||!e)return n;{let o=firePostProcess(e,{...t,content:n});return o.content}},getHtmlFromNode=(e,t,n)=>{let o=trim$2(n.getInner?t.innerHTML:e.getOuterHTML(t));return n.selection||e1(eS.fromDom(t))?o:eb.trim(o)},parseHtml=(e,t,n)=>{let o=n.selection?{forced_root_block:!1,...n}:n,a=e.parse(t,o);return trimTrailingBr(a),a},serializeNode=(e,t,n)=>{let o=HtmlSerializer(e,t);return o.serialize(n)},toHtml=(e,t,n,o,a)=>{let i=serializeNode(t,n,o);return postProcess(e,a,i)},DomSerializerImpl=(e,t)=>{let n=["data-mce-selected"],o={entity_encoding:"named",remove_trailing_brs:!0,pad_empty_with_br:!1,...e},a=t&&t.dom?t.dom:DOMUtils.DOM,i=t&&t.schema?t.schema:Schema(o),l=DomParser(o,i);return register$3(l,o,a),{schema:i,addNodeFilter:l.addNodeFilter,addAttributeFilter:l.addAttributeFilter,serialize:(e,n={})=>{let s={format:"html",...n},d=process$1(t,e,s),c=getHtmlFromNode(a,d,s),m=parseHtml(l,c,s);return"tree"===s.format?m:toHtml(t,o,i,m,s)},addRules:i.addValidElements,setRules:i.setValidElements,addTempAttr:curry(addTempAttr,l,n),getTempAttrs:constant(n),getNodeFilters:l.getNodeFilters,getAttributeFilters:l.getAttributeFilters,removeNodeFilter:l.removeNodeFilter,removeAttributeFilter:l.removeAttributeFilter}},DomSerializer=(e,t)=>{let n=DomSerializerImpl(e,t);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters,removeNodeFilter:n.removeNodeFilter,removeAttributeFilter:n.removeAttributeFilter}},setupArgs$1=(e,t)=>({...e,format:t,get:!0,getInner:!0}),getContent=(e,t={})=>{let n=t.format?t.format:"html",o=setupArgs$1(t,n);return preProcessGetContent(e,o).fold(identity,t=>{let n=getContent$2(e,t);return postProcessGetContent(e,n,t)})},setupArgs=(e,t)=>({format:"html",...e,set:!0,content:t}),setContent=(e,t,n={})=>{let o=setupArgs(n,t);return preProcessSetContent(e,o).map(t=>{let n=setContent$2(e,t.content,t);return postProcessSetContent(e,n.html,t),n.content}).getOr(t)},ab="autoresize_on_init,content_editable_state,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,tabfocus_elements,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_enable_default_filters,paste_filter_drop,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists".split(","),aC="template_cdate_classes,template_mdate_classes,template_selected_content_classes,template_preview_replace_values,template_replace_values,templates,template_cdate_format,template_mdate_format".split(","),ay="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,textcolor".split(","),av=[{name:"template",replacedWith:"Advanced Template"},{name:"rtc"}],getMatchingOptions=(e,t)=>{let n=filter$5(t,t=>has$2(e,t));return sort(n)},getRemovedOptions=e=>{let t=getMatchingOptions(e,ab),n=e.forced_root_block;return(!1===n||""===n)&&t.push("forced_root_block (false only)"),sort(t)},getDeprecatedOptions=e=>getMatchingOptions(e,aC),getMatchingPlugins=(e,t)=>{let n=eb.makeMap(e.plugins," "),o=filter$5(t,e=>has$2(n,e));return sort(o)},getRemovedPlugins=e=>getMatchingPlugins(e,ay),getDeprecatedPlugins=e=>getMatchingPlugins(e,av.map(e=>e.name)),logRemovedWarnings=(e,t)=>{let n=getRemovedOptions(e),o=getRemovedPlugins(t),a=o.length>0,i=n.length>0,l="mobile"===t.theme;if(a||i||l){let e=l?`

Themes:
- mobile`:"",t=a?`

Plugins:
- ${o.join("\n- ")}`:"",s=i?`

Options:
- ${n.join("\n- ")}`:"";console.warn("The following deprecated features are currently enabled and have been removed in TinyMCE 6.0. These features will no longer work and should be removed from the TinyMCE configuration. See https://www.tiny.cloud/docs/tinymce/6/migration-from-5x/ for more information."+e+t+s)}},getPluginDescription=e=>find$2(av,t=>t.name===e).fold(()=>e,t=>t.replacedWith?`${e}, replaced by ${t.replacedWith}`:e),logDeprecatedWarnings=(e,t)=>{let n=getDeprecatedOptions(e),o=getDeprecatedPlugins(t),a=o.length>0,i=n.length>0;if(a||i){let e=a?`

Plugins:
- ${o.map(getPluginDescription).join("\n- ")}`:"",t=i?`

Options:
- ${n.join("\n- ")}`:"";console.warn("The following deprecated features are currently enabled but will be removed soon."+e+t)}},logWarnings=(e,t)=>{logRemovedWarnings(e,t),logDeprecatedWarnings(e,t)},aE=DOMUtils.DOM,restoreOriginalStyles=e=>{aE.setStyle(e.id,"display",e.orgDisplay)},safeDestroy=e=>Optional.from(e).each(e=>e.destroy()),clearDomReferences=e=>{e.contentAreaContainer=e.formElement=e.container=e.editorContainer=null,e.bodyElement=e.contentDocument=e.contentWindow=null,e.iframeElement=e.targetElm=null;let t=e.selection;if(t){let n=t.dom;e.selection=t.win=t.dom=n.doc=null}},restoreForm=e=>{let t=e.formElement;t&&(t._mceOldSubmit&&(t.submit=t._mceOldSubmit,delete t._mceOldSubmit),aE.unbind(t,"submit reset",e.formEventDelegate))},remove$1=e=>{if(!e.removed){let{_selectionOverrides:t,editorUpload:n}=e,o=e.getBody(),a=e.getElement();o&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&isNonNullable(null==a?void 0:a.nextSibling)&&aE.remove(a.nextSibling),fireRemove(e),e.editorManager.remove(e),!e.inline&&o&&restoreOriginalStyles(e),fireDetach(e),aE.remove(e.getContainer()),safeDestroy(t),safeDestroy(n),e.destroy()}},destroy=(e,t)=>{let{selection:n,dom:o}=e;if(!e.destroyed){if(!t&&!e.removed){e.remove();return}t||(e.editorManager.off("beforeunload",e._beforeUnload),e.theme&&e.theme.destroy&&e.theme.destroy(),safeDestroy(n),safeDestroy(o)),restoreForm(e),clearDomReferences(e),e.destroyed=!0}},ak=(()=>{let e={};return{add:(t,n)=>{e[t]=n},get:t=>e[t]?e[t]:{icons:{}},has:t=>has$2(e,t)}})(),a$=AddOnManager.ModelManager,getProp=(e,t)=>{let n=t.dom;return n[e]},getComputedSizeProp=(e,t)=>parseInt(get$7(t,e),10),aS=curry(getProp,"clientWidth"),aN=curry(getProp,"clientHeight"),aO=curry(getComputedSizeProp,"margin-top"),aP=curry(getComputedSizeProp,"margin-left"),getBoundingClientRect=e=>e.dom.getBoundingClientRect(),isInsideElementContentArea=(e,t,n)=>{let o=aS(e),a=aN(e);return t>=0&&n>=0&&t<=o&&n<=a},transpose=(e,t,n,o)=>{let a=getBoundingClientRect(t),i=e?a.left+t.dom.clientLeft+aP(t):0,l=e?a.top+t.dom.clientTop+aO(t):0;return{x:n-i,y:o-l}},isXYInContentArea=(e,t,n)=>{let o=eS.fromDom(e.getBody()),a=e.inline?o:documentElement(o),i=transpose(e.inline,a,t,n);return isInsideElementContentArea(a,i.x,i.y)},fromDomSafe=e=>Optional.from(e).map(eS.fromDom),isEditorAttachedToDom=e=>{let t=e.inline?e.getBody():e.getContentAreaContainer();return fromDomSafe(t).map(inBody).getOr(!1)};var NotificationManagerImpl=()=>{let unimplemented=()=>{throw Error("Theme did not provide a NotificationManager implementation.")};return{open:unimplemented,close:unimplemented,getArgs:unimplemented}};let NotificationManager=e=>{let t=[],getImplementation=()=>{let t=e.theme;return t&&t.getNotificationManagerImpl?t.getNotificationManagerImpl():NotificationManagerImpl()},getTopNotification=()=>Optional.from(t[0]),isEqual=(e,t)=>e.type===t.type&&e.text===t.text&&!e.progressBar&&!e.timeout&&!t.progressBar&&!t.timeout,reposition=()=>{each$e(t,e=>{e.reposition()})},addNotification=e=>{t.push(e)},closeNotification=e=>{findIndex$2(t,t=>t===e).each(e=>{t.splice(e,1)})},open=(n,o=!0)=>e.removed||!isEditorAttachedToDom(e)?{}:(o&&e.dispatch("BeforeOpenNotification",{notification:n}),find$2(t,e=>isEqual(getImplementation().getArgs(e),n)).getOrThunk(()=>{e.editorManager.setActive(e);let t=getImplementation().open(n,()=>{closeNotification(t),reposition(),getTopNotification().fold(()=>e.focus(),e=>focus$1(eS.fromDom(e.getEl())))});return addNotification(t),reposition(),e.dispatch("OpenNotification",{notification:{...t}}),t})),n=constant(t);return e.on("SkinLoaded",()=>{let t=nS(e);t&&open({text:t,type:"warning",timeout:0},!1),reposition()}),e.on("show ResizeEditor ResizeWindow NodeChange",()=>{requestAnimationFrame(reposition)}),e.on("remove",()=>{each$e(t.slice(),e=>{getImplementation().close(e)})}),{open,close:()=>{getTopNotification().each(e=>{getImplementation().close(e),closeNotification(e),reposition()})},getNotifications:n}},aR=AddOnManager.PluginManager,ax=AddOnManager.ThemeManager;var WindowManagerImpl=()=>{let unimplemented=()=>{throw Error("Theme did not provide a WindowManager implementation.")};return{open:unimplemented,openUrl:unimplemented,alert:unimplemented,confirm:unimplemented,close:unimplemented}};let WindowManager=e=>{let t=[],getImplementation=()=>{let t=e.theme;return t&&t.getWindowManagerImpl?t.getWindowManagerImpl():WindowManagerImpl()},funcBind=(e,t)=>(...n)=>t?t.apply(e,n):void 0,fireOpenEvent=t=>{e.dispatch("OpenWindow",{dialog:t})},fireCloseEvent=t=>{e.dispatch("CloseWindow",{dialog:t})},addDialog=e=>{t.push(e),fireOpenEvent(e)},closeDialog=n=>{fireCloseEvent(n),0===(t=filter$5(t,e=>e!==n)).length&&e.focus()},getTopDialog=()=>Optional.from(t[t.length-1]),storeSelectionAndOpenDialog=t=>{e.editorManager.setActive(e),store(e),e.ui.show();let n=t();return addDialog(n),n};return e.on("remove",()=>{each$e(t,e=>{getImplementation().close(e)})}),{open:(e,t)=>storeSelectionAndOpenDialog(()=>getImplementation().open(e,t,closeDialog)),openUrl:e=>storeSelectionAndOpenDialog(()=>getImplementation().openUrl(e,closeDialog)),alert:(e,t,n)=>{let o=getImplementation();o.alert(e,funcBind(n||o,t))},confirm:(e,t,n)=>{let o=getImplementation();o.confirm(e,funcBind(n||o,t))},close:()=>{getTopDialog().each(e=>{getImplementation().close(e),closeDialog(e)})}}},displayNotification=(e,t)=>{e.notificationManager.open({type:"error",text:t})},displayError=(e,t)=>{e._skinLoaded?displayNotification(e,t):e.on("SkinLoaded",()=>{displayNotification(e,t)})},uploadError=(e,t)=>{displayError(e,tP.translate(["Failed to upload image: {0}",t]))},logError=(e,t,n)=>{fireError(e,t,{message:n}),console.error(n)},createLoadError=(e,t,n)=>n?`Failed to load ${e}: ${n} from url ${t}`:`Failed to load ${e} url: ${t}`,pluginLoadError=(e,t,n)=>{logError(e,"PluginLoadError",createLoadError("plugin",t,n))},iconsLoadError=(e,t,n)=>{logError(e,"IconsLoadError",createLoadError("icons",t,n))},languageLoadError=(e,t,n)=>{logError(e,"LanguageLoadError",createLoadError("language",t,n))},themeLoadError=(e,t,n)=>{logError(e,"ThemeLoadError",createLoadError("theme",t,n))},modelLoadError=(e,t,n)=>{logError(e,"ModelLoadError",createLoadError("model",t,n))},pluginInitError=(e,t,n)=>{let o=tP.translate(["Failed to initialize plugin: {0}",t]);fireError(e,"PluginLoadError",{message:o}),initError(o,n),displayError(e,o)},initError=(e,...t)=>{let n=window.console;n&&(n.error?n.error(e,...t):n.log(e,...t))},isContentCssSkinName=e=>/^[a-z0-9\-]+$/i.test(e),getContentCssUrls=e=>transformToUrls(e,nf(e)),getFontCssUrls=e=>transformToUrls(e,nb(e)),transformToUrls=(e,t)=>{let n=e.editorManager.baseURL+"/skins/content",o=e.editorManager.suffix,a=`content${o}.css`;return map$3(t,t=>isContentCssSkinName(t)&&!e.inline?`${n}/${t}/${a}`:e.documentBaseURI.toAbsolute(t))},appendContentCssFromSettings=e=>{e.contentCSS=e.contentCSS.concat(getContentCssUrls(e),getFontCssUrls(e))},getAllImages=e=>e?I(e.getElementsByTagName("img")):[],ImageScanner=(e,t)=>{let n={};return{findAll:(o,a=A)=>{let i=filter$5(getAllImages(o),t=>{let n=t.src;return!(t.hasAttribute("data-mce-bogus")||t.hasAttribute("data-mce-placeholder"))&&!!n&&n!==ef.transparentSrc&&(startsWith(n,"blob:")?!e.isUploaded(n)&&a(t):!!startsWith(n,"data:")&&a(t))}),l=map$3(i,e=>{let o=e.src;if(has$2(n,o))return n[o].then(t=>k(t)?t:{image:e,blobInfo:t.blobInfo});{let a=imageToBlobInfo(t,o).then(t=>(delete n[o],{image:e,blobInfo:t})).catch(e=>(delete n[o],e));return n[o]=a,a}});return Promise.all(l)}}},UploadStatus=()=>{let e={},createStatus=(e,t)=>({status:e,resultUri:t}),hasBlobUri=t=>t in e;return{hasBlobUri,getResultUri:t=>{let n=e[t];return n?n.resultUri:null},isPending:t=>!!hasBlobUri(t)&&1===e[t].status,isUploaded:t=>!!hasBlobUri(t)&&2===e[t].status,markPending:t=>{e[t]=createStatus(1,null)},markUploaded:(t,n)=>{e[t]=createStatus(2,n)},removeFailed:t=>{delete e[t]},destroy:()=>{e={}}}},aw=0,seed=()=>{let rnd=()=>Math.round(4294967295*Math.random()).toString(36),e=new Date().getTime();return"s"+e.toString(36)+rnd()+rnd()+rnd()},uuid=e=>e+aw+++seed(),BlobCache=()=>{let e=[],mimeToExt=e=>({"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"})[e.toLowerCase()]||"dat",toBlobInfo=e=>{if(!e.blob||!e.base64)throw Error("blob and base64 representations of the image are required for BlobInfo to be created");let t=e.id||uuid("blobid"),n=e.name||t,o=e.blob;return{id:constant(t),name:constant(n),filename:constant(e.filename||n+"."+mimeToExt(o.type)),blob:constant(o),base64:constant(e.base64),blobUri:constant(e.blobUri||URL.createObjectURL(o)),uri:constant(e.uri)}},findFirst=t=>find$2(e,t).getOrUndefined(),get=e=>findFirst(t=>t.id()===e);return{create:(e,t,n,o,a)=>{if(k(e))return toBlobInfo({id:e,name:o,filename:a,blob:t,base64:n});if($(e))return toBlobInfo(e);throw Error("Unknown input type")},add:t=>{get(t.id())||e.push(t)},get,getByUri:e=>findFirst(t=>t.blobUri()===e),getByData:(e,t)=>findFirst(n=>n.base64()===e&&n.blob().type===t),findFirst,removeByUri:t=>{e=filter$5(e,e=>e.blobUri()!==t||(URL.revokeObjectURL(e.blobUri()),!1))},destroy:()=>{each$e(e,e=>{URL.revokeObjectURL(e.blobUri())}),e=[]}}},Uploader=(e,t)=>{let n={},pathJoin=(e,t)=>e?e.replace(/\/$/,"")+"/"+t.replace(/^\//,""):t,defaultHandler=(e,n)=>new Promise((o,a)=>{let i=new XMLHttpRequest;i.open("POST",t.url),i.withCredentials=t.credentials,i.upload.onprogress=e=>{n(e.loaded/e.total*100)},i.onerror=()=>{a("Image upload failed due to a XHR Transport error. Code: "+i.status)},i.onload=()=>{if(i.status<200||i.status>=300){a("HTTP Error: "+i.status);return}let e=JSON.parse(i.responseText);if(!e||!k(e.location)){a("Invalid JSON: "+i.responseText);return}o(pathJoin(t.basePath,e.location))};let l=new FormData;l.append("file",e.blob(),e.filename()),i.send(l)}),o=R(t.handler)?t.handler:defaultHandler,noUpload=()=>new Promise(e=>{e([])}),handlerSuccess=(e,t)=>({url:t,blobInfo:e,status:!0}),handlerFailure=(e,t)=>({url:"",blobInfo:e,status:!1,error:t}),resolvePending=(e,t)=>{eb.each(n[e],e=>{e(t)}),delete n[e]},uploadBlobInfo=(t,n,o)=>(e.markPending(t.blobUri()),new Promise(a=>{let i,l;try{let closeNotification=()=>{i&&(i.close(),l=noop)},failure=n=>{closeNotification(),e.removeFailed(t.blobUri()),resolvePending(t.blobUri(),handlerFailure(t,n)),a(handlerFailure(t,n))};l=e=>{e<0||e>100||Optional.from(i).orThunk(()=>Optional.from(o).map(apply$1)).each(t=>{i=t,t.progressBar.value(e)})},n(t,l).then(n=>{closeNotification(),e.markUploaded(t.blobUri(),n),resolvePending(t.blobUri(),handlerSuccess(t,n)),a(handlerSuccess(t,n))},e=>{failure(k(e)?{message:e}:e)})}catch(e){a(handlerFailure(t,e))}})),isDefaultHandler=e=>e===defaultHandler,pendingUploadBlobInfo=e=>{let t=e.blobUri();return new Promise(e=>{n[t]=n[t]||[],n[t].push(e)})},uploadBlobs=(t,n)=>(t=eb.grep(t,t=>!e.isUploaded(t.blobUri())),Promise.all(eb.map(t,t=>e.isPending(t.blobUri())?pendingUploadBlobInfo(t):uploadBlobInfo(t,o,n))));return{upload:(e,n)=>!t.url&&isDefaultHandler(o)?noUpload():uploadBlobs(e,n)}},openNotification=e=>()=>e.notificationManager.open({text:e.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0}),createUploader=(e,t)=>Uploader(t,{url:no(e),basePath:na(e),credentials:ni(e),handler:nl(e)}),isEmptyForPadding=(e,t)=>e.dom.isEmpty(t.dom)&&isNonNullable(e.schema.getTextBlockElements()[name(t)]),addPaddingToEmpty=e=>t=>{isEmptyForPadding(e,t)&&append$1(t,eS.fromHtml('<br data-mce-bogus="1" />'))},EditorUpload=e=>{let t,n;let o=BlobCache(),a=UploadStatus(),i=[],aliveGuard=t=>n=>e.selection?t(n):[],cacheInvalidator=e=>e+(-1===e.indexOf("?")?"?":"&")+new Date().getTime(),replaceString=(e,t,n)=>{let o=0;do -1!==(o=e.indexOf(t,o))&&(e=e.substring(0,o)+n+e.substr(o+t.length),o+=n.length-t.length+1);while(-1!==o);return e},replaceImageUrl=(e,t,n)=>{let o=`src="${n}"${n===ef.transparentSrc?' data-mce-placeholder="1"':""}`;return e=replaceString(e,`src="${t}"`,o),e=replaceString(e,'data-mce-src="'+t+'"','data-mce-src="'+n+'"')},replaceUrlInUndoStack=(t,n)=>{each$e(e.undoManager.data,e=>{"fragmented"===e.type?e.fragments=map$3(e.fragments,e=>replaceImageUrl(e,t,n)):e.content=replaceImageUrl(e.content,t,n)})},replaceImageUriInView=(t,n)=>{let o=e.convertURL(n,"src");replaceUrlInUndoStack(t.src,n),setAll$1(eS.fromDom(t),{src:ne(e)?cacheInvalidator(n):n,"data-mce-src":o})},uploadImages=()=>(t||(t=createUploader(e,a)),scanForImages().then(aliveGuard(n=>{let a=map$3(n,e=>e.blobInfo);return t.upload(a,openNotification(e)).then(aliveGuard(t=>{let a=[],i=!1,l=map$3(t,(t,l)=>{let{blobInfo:s,image:d}=n[l],c=!1;return t.status&&nt(e)?(t.url&&!contains$1(d.src,t.url)&&(i=!0),o.removeByUri(d.src),isRtc(e)||replaceImageUriInView(d,t.url)):t.error&&(t.error.remove&&(replaceUrlInUndoStack(d.src,ef.transparentSrc),a.push(d),c=!0),uploadError(e,t.error.message)),{element:d,status:t.status,uploadUri:t.url,blobInfo:s,removed:c}});return a.length>0&&!isRtc(e)?e.undoManager.transact(()=>{each$e(fromDom$1(a),t=>{let n=parent(t);remove$5(t),n.each(addPaddingToEmpty(e)),o.removeByUri(t.dom.src)})}):i&&e.undoManager.dispatchChange(),l}))}))),uploadImagesAuto=()=>t7(e)?uploadImages():Promise.resolve([]),isValidDataUriImage=e=>forall(i,t=>t(e)),scanForImages=()=>(n||(n=ImageScanner(a,o)),n.findAll(e.getBody(),isValidDataUriImage).then(aliveGuard(t=>{let n=filter$5(t,t=>k(t)?(displayError(e,t),!1):"blob"!==t.uriType);return isRtc(e)||each$e(n,e=>{replaceUrlInUndoStack(e.image.src,e.blobInfo.blobUri()),e.image.src=e.blobInfo.blobUri(),e.image.removeAttribute("data-mce-src")}),n}))),replaceBlobUris=t=>t.replace(/src="(blob:[^"]+)"/g,(t,n)=>{let i=a.getResultUri(n);if(i)return'src="'+i+'"';let l=o.getByUri(n);if(l||(l=foldl(e.editorManager.get(),(e,t)=>e||t.editorUpload&&t.editorUpload.blobCache.getByUri(n),void 0)),l){let e=l.blob();return'src="data:'+e.type+";base64,"+l.base64()+'"'}return t});return e.on("SetContent",()=>{t7(e)?uploadImagesAuto():scanForImages()}),e.on("RawSaveContent",e=>{e.content=replaceBlobUris(e.content)}),e.on("GetContent",e=>{e.source_view||"raw"===e.format||"tree"===e.format||(e.content=replaceBlobUris(e.content))}),e.on("PostRender",()=>{e.parser.addNodeFilter("img",e=>{each$e(e,e=>{let t=e.attr("src");if(!t||o.getByUri(t))return;let n=a.getResultUri(t);n&&e.attr("src",n)})})}),{blobCache:o,addFilter:e=>{i.push(e)},uploadImages,uploadImagesAuto,scanForImages,destroy:()=>{o.destroy(),a.destroy(),n=t=null}}},get$1=e=>{let t=e.dom,n=e.schema.type,o={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"left"},inherit:!1,preview:!1},{selector:"img,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginLeft:"0px",marginRight:"auto"},onformat:e=>{t.setStyle(e,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"},{selector:".mce-preview-object",ceFalseOverride:!0,styles:{display:"table",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{marginLeft:"auto",marginRight:"auto"},preview:!1}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginRight:"0px",marginLeft:"auto"},onformat:e=>{t.setStyle(e,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"right"},preview:!1}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"justify"},inherit:!1,preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:(()=>{let e={inline:"span",styles:{textDecoration:"line-through"},exact:!0},t={inline:"strike",remove:"all",preserve_attributes:["class","style"]},o={inline:"s",remove:"all",preserve_attributes:["class","style"]};return"html4"!==n?[o,e,t]:[e,o,t]})(),forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:(e,t,n)=>eR(e)&&e.hasAttribute("href"),onformat:(e,n,o)=>{eb.each(o,(n,o)=>{t.setAttrib(e,o,n)})}},lang:{inline:"span",clear_child_styles:!0,remove_similar:!0,attributes:{lang:"%value","data-mce-lang":e=>{var t;return null!==(t=null==e?void 0:e.customValue)&&void 0!==t?t:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return eb.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd samp".split(/\s/),e=>{o[e]={block:e,remove:"all"}}),o},aA={remove_similar:!0,inherit:!1},aT={selector:"td,th",...aA},aB={tablecellbackgroundcolor:{styles:{backgroundColor:"%value"},...aT},tablecellverticalalign:{styles:{"vertical-align":"%value"},...aT},tablecellbordercolor:{styles:{borderColor:"%value"},...aT},tablecellclass:{classes:["%value"],...aT},tableclass:{selector:"table",classes:["%value"],...aA},tablecellborderstyle:{styles:{borderStyle:"%value"},...aT},tablecellborderwidth:{styles:{borderWidth:"%value"},...aT}},aD=constant(aB),FormatRegistry=e=>{let t={},register=(e,n)=>{e&&(k(e)?(S(n)||(n=[n]),each$e(n,e=>{P(e.deep)&&(e.deep=!isSelectorFormat(e)),P(e.split)&&(e.split=!isSelectorFormat(e)||isInlineFormat(e)),P(e.remove)&&isSelectorFormat(e)&&!isInlineFormat(e)&&(e.remove="none"),isSelectorFormat(e)&&isInlineFormat(e)&&(e.mixed=!0,e.block_expand=!0),k(e.classes)&&(e.classes=e.classes.split(/\s+/))}),t[e]=n):each$d(e,(e,t)=>{register(t,e)}))};return register(get$1(e)),register(aD()),register(nw(e)),{get:e=>isNonNullable(e)?t[e]:t,has:e=>has$2(t,e),register,unregister:e=>(e&&t[e]&&delete t[e],t)}},aI=eb.each,aF=DOMUtils.DOM,isPreviewItem=e=>isNonNullable(e)&&$(e),parsedSelectorToHtml=(e,t)=>{let n=t&&t.schema||Schema({}),decorate=(e,t)=>{t.classes.length>0&&aF.addClass(e,t.classes.join(" ")),aF.setAttribs(e,t.attrs)},createElement=e=>{let t=k(e)?{name:e,classes:[],attrs:{}}:e,n=aF.create(t.name);return decorate(n,t),n},getRequiredParent=(e,t)=>{let o=n.getElementRule(e.nodeName.toLowerCase()),a=null==o?void 0:o.parentsRequired;return!!a&&!!a.length&&(t&&contains$2(a,t)?t:a[0])},wrapInHtml=(e,t,n)=>{let o;let a=t[0],i=isPreviewItem(a)?a.name:void 0,l=getRequiredParent(e,i);if(l)i===l?(o=a,t=t.slice(1)):o=l;else if(a)o=a,t=t.slice(1);else if(!n)return e;let s=o?createElement(o):aF.create("div");s.appendChild(e),n&&eb.each(n,t=>{let n=createElement(t);s.insertBefore(n,e)});let d=isPreviewItem(o)?o.siblings:void 0;return wrapInHtml(s,t,d)},o=aF.create("div");if(e.length>0){let t=e[0],n=createElement(t),a=isPreviewItem(t)?t.siblings:void 0;o.appendChild(wrapInHtml(n,e.slice(1),a))}return o},parseSelectorItem=e=>{e=eb.trim(e);let t="div",n={name:t,classes:[],attrs:{},selector:e};return"*"!==e&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(e,t,o,a,i)=>{switch(t){case"#":n.attrs.id=o;break;case".":n.classes.push(o);break;case":":-1!==eb.inArray("checked disabled enabled read-only required".split(" "),o)&&(n.attrs[o]=o)}if("["===a){let e=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/);e&&(n.attrs[e[1]]=e[2])}return""})),n.name=t||"div",n},parseSelector=e=>k(e)?(e=(e=e.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),eb.map(e.split(/(?:>|\s+(?![^\[\]]+\]))/),e=>{let t=eb.map(e.split(/(?:~\+|~|\+)/),parseSelectorItem),n=t.pop();return t.length&&(n.siblings=t),n}).reverse()):[],getCssText=(e,t)=>{let n,o="",a=nA(e);if(""===a)return"";let removeVars=e=>k(e)?e.replace(/%(\w+)/g,""):"",getComputedStyle=(t,n)=>aF.getStyle(null!=n?n:e.getBody(),t,!0);if(k(t)){let n=e.formatter.get(t);if(!n)return"";t=n[0]}if("preview"in t){let e=t.preview;if(!1===e)return"";a=e||a}let i=t.block||t.inline||"span",l=parseSelector(t.selector);l.length>0?(l[0].name||(l[0].name=i),i=t.selector,n=parsedSelectorToHtml(l,e)):n=parsedSelectorToHtml([i],e);let s=aF.select(i,n)[0]||n.firstChild;aI(t.styles,(e,t)=>{let n=removeVars(e);n&&aF.setStyle(s,t,n)}),aI(t.attributes,(e,t)=>{let n=removeVars(e);n&&aF.setAttrib(s,t,n)}),aI(t.classes,e=>{let t=removeVars(e);aF.hasClass(s,t)||aF.addClass(s,t)}),e.dispatch("PreviewFormats"),aF.setStyles(n,{position:"absolute",left:-65535}),e.getBody().appendChild(n);let d=getComputedStyle("fontSize"),c=/px$/.test(d)?parseInt(d,10):0;return aI(a.split(" "),e=>{let t=getComputedStyle(e,s);if((!("background-color"===e&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(t))||"#ffffff"!==rgbaToHexString(t=getComputedStyle(e)).toLowerCase())&&("color"!==e||"#000000"!==rgbaToHexString(t).toLowerCase())){if("font-size"===e&&/em|%$/.test(t)){if(0===c)return;let e=parseFloat(t)/(/%$/.test(t)?100:1);t=e*c+"px"}"border"===e&&t&&(o+="padding:0 2px;"),o+=e+":"+t+";"}}),e.dispatch("AfterPreviewFormats"),aF.remove(n),o},setup$r=e=>{e.addShortcut("meta+b","","Bold"),e.addShortcut("meta+i","","Italic"),e.addShortcut("meta+u","","Underline");for(let t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",!1,"h"+t]);e.addShortcut("access+7","",["FormatBlock",!1,"p"]),e.addShortcut("access+8","",["FormatBlock",!1,"div"]),e.addShortcut("access+9","",["FormatBlock",!1,"address"])},Formatter=e=>{let t=FormatRegistry(e),n=Cell({});return setup$r(e),setup$u(e),isRtc(e)||setup$t(n,e),{get:t.get,has:t.has,register:t.register,unregister:t.unregister,apply:(t,n,o)=>{applyFormat(e,t,n,o)},remove:(t,n,o,a)=>{removeFormat(e,t,n,o,a)},toggle:(t,n,o)=>{toggleFormat(e,t,n,o)},match:(t,n,o,a)=>matchFormat(e,t,n,o,a),closest:t=>closestFormat(e,t),matchAll:(t,n)=>matchAllFormats(e,t,n),matchNode:(t,n,o,a)=>matchNodeFormat(e,t,n,o,a),canApply:t=>canApplyFormat(e,t),formatChanged:(t,o,a,i)=>formatChanged(e,n,t,o,a,i),getCssText:curry(getCssText,e)}},shouldIgnoreCommand=e=>{switch(e.toLowerCase()){case"undo":case"redo":case"mcefocus":return!0;default:return!1}},registerEvents=(e,t,n)=>{let o=Cell(!1),addNonTypingUndoLevel=e=>{setTyping(t,!1,n),t.add({},e)};e.on("init",()=>{t.add()}),e.on("BeforeExecCommand",e=>{let o=e.command;shouldIgnoreCommand(o)||(endTyping(t,n),t.beforeChange())}),e.on("ExecCommand",e=>{let t=e.command;shouldIgnoreCommand(t)||addNonTypingUndoLevel(e)}),e.on("ObjectResizeStart cut",()=>{t.beforeChange()}),e.on("SaveContent ObjectResized blur",addNonTypingUndoLevel),e.on("dragend",addNonTypingUndoLevel),e.on("keyup",n=>{let a=n.keyCode;if(n.isDefaultPrevented())return;let i=ef.os.isMacOS()&&"Meta"===n.key;(a>=33&&a<=36||a>=37&&a<=40||45===a||n.ctrlKey||i)&&(addNonTypingUndoLevel(),e.nodeChanged()),(46===a||8===a)&&e.nodeChanged(),o.get()&&t.typing&&!isEq$1(createFromEditor(e),t.data[0])&&(e.isDirty()||e.setDirty(!0),e.dispatch("TypingUndo"),o.set(!1),e.nodeChanged())}),e.on("keydown",e=>{let a=e.keyCode;if(e.isDefaultPrevented())return;if(a>=33&&a<=36||a>=37&&a<=40||45===a){t.typing&&addNonTypingUndoLevel(e);return}let i=e.ctrlKey&&!e.altKey||e.metaKey;if((a<16||a>20)&&224!==a&&91!==a&&!t.typing&&!i){t.beforeChange(),setTyping(t,!0,n),t.add({},e),o.set(!0);return}let l=ef.os.isMacOS()?e.metaKey:e.ctrlKey&&!e.altKey;l&&t.beforeChange()}),e.on("mousedown",e=>{t.typing&&addNonTypingUndoLevel(e)});let isInsertReplacementText=e=>"insertReplacementText"===e.inputType,isInsertTextDataNull=e=>"insertText"===e.inputType&&null===e.data,isInsertFromPasteOrDrop=e=>"insertFromPaste"===e.inputType||"insertFromDrop"===e.inputType;e.on("input",e=>{e.inputType&&(isInsertReplacementText(e)||isInsertTextDataNull(e)||isInsertFromPasteOrDrop(e))&&addNonTypingUndoLevel(e)}),e.on("AddUndo Undo Redo ClearUndos",t=>{t.isDefaultPrevented()||e.nodeChanged()})},addKeyboardShortcuts=e=>{e.addShortcut("meta+z","","Undo"),e.addShortcut("meta+y,meta+shift+z","","Redo")},UndoManager=e=>{let t=value$2(),n=Cell(0),o=Cell(0),a={data:[],typing:!1,beforeChange:()=>{beforeChange(e,n,t)},add:(i,l)=>addUndoLevel(e,a,o,n,t,i,l),dispatchChange:()=>{e.setDirty(!0);let t=createFromEditor(e);t.bookmark=tH(e.selection),e.dispatch("change",{level:t,lastLevel:get$b(a.data,o.get()).getOrUndefined()})},undo:()=>undo(e,a,n,o),redo:()=>redo(e,o,a.data),clear:()=>{clear(e,a,o)},reset:()=>{reset(e,a)},hasUndo:()=>hasUndo(e,a,o),hasRedo:()=>hasRedo(e,a,o),transact:t=>transact(e,a,n,t),ignore:t=>{ignore(e,n,t)},extra:(t,n)=>{extra(e,a,o,t,n)}};return isRtc(e)||registerEvents(e,a,n),addKeyboardShortcuts(e),a},a_=[9,27,rx.HOME,rx.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,rx.DOWN,rx.UP,rx.LEFT,rx.RIGHT].concat(ef.browser.isFirefox()?[224]:[]),aL="data-mce-placeholder",isKeyboardEvent=e=>"keydown"===e.type||"keyup"===e.type,isDeleteEvent=e=>{let t=e.keyCode;return t===rx.BACKSPACE||t===rx.DELETE},isNonTypingKeyboardEvent=e=>{if(!isKeyboardEvent(e))return!1;{let t=e.keyCode;return!isDeleteEvent(e)&&(rx.metaKeyPressed(e)||e.altKey||t>=112&&t<=123||contains$2(a_,t))}},isTypingKeyboardEvent=e=>isKeyboardEvent(e)&&!(isDeleteEvent(e)||"keyup"===e.type&&229===e.keyCode),isVisuallyEmpty=(e,t,n)=>{if(!isEmpty$2(eS.fromDom(t),!1))return!1;{let o=t.firstElementChild;return!o||!(e.getStyle(t.firstElementChild,"padding-left")||e.getStyle(t.firstElementChild,"padding-right"))&&n===o.nodeName.toLowerCase()}},setup$q=e=>{var t;let n=e.dom,o=t2(e),a=null!==(t=nk(e))&&void 0!==t?t:"",updatePlaceholder=(t,i)=>{if(isNonTypingKeyboardEvent(t))return;let l=e.getBody(),s=!isTypingKeyboardEvent(t)&&isVisuallyEmpty(n,l,o),d=""!==n.getAttrib(l,aL);(d!==s||i)&&(n.setAttrib(l,aL,s?a:null),n.setAttrib(l,"aria-placeholder",s?a:null),firePlaceholderToggle(e,s),e.on(s?"keydown":"keyup",updatePlaceholder),e.off(s?"keyup":"keydown",updatePlaceholder))};isNotEmpty(a)&&e.on("init",t=>{updatePlaceholder(t,!0),e.on("change SetContent ExecCommand",updatePlaceholder),e.on("paste",t=>rZ.setEditorTimeout(e,()=>updatePlaceholder(t)))})},blockPosition=(e,t)=>({block:e,position:t}),blockBoundary=(e,t)=>({from:e,to:t}),getBlockPosition=(e,t)=>{let n=eS.fromDom(e),o=eS.fromDom(t.container());return getParentBlock$2(n,o).map(e=>blockPosition(e,t))},isDifferentBlocks=e=>!eq(e.from.block,e.to.block),getClosestHost=(e,t)=>closest$4(t,e=>e0(e)||eL(e.dom),t=>eq(t,e)).filter(ev).getOr(e),hasSameHost=(e,t)=>{let n=eS.fromDom(e);return eq(getClosestHost(n,t.from.block),getClosestHost(n,t.to.block))},isEditable$1=e=>!1===eM(e.from.block.dom)&&!1===eM(e.to.block.dom),hasValidBlocks=e=>{let isValidBlock=e=>eX(e)||hasBlockAttr(e.dom);return isValidBlock(e.from.block)&&isValidBlock(e.to.block)},skipLastBr=(e,t,n)=>eF(n.position.getNode())&&!isEmpty$2(n.block)?positionIn(!1,n.block.dom).bind(o=>o.isEqual(n.position)?fromPosition(t,e,o).bind(t=>getBlockPosition(e,t)):Optional.some(n)).getOr(n):n,readFromRange=(e,t,n)=>{let o=getBlockPosition(e,CaretPosition.fromRangeStart(n)),a=o.bind(n=>fromPosition(t,e,n.position).bind(n=>getBlockPosition(e,n).map(n=>skipLastBr(e,t,n))));return lift2(o,a,blockBoundary).filter(t=>isDifferentBlocks(t)&&hasSameHost(e,t)&&isEditable$1(t)&&hasValidBlocks(t))},read$1=(e,t,n)=>n.collapsed?readFromRange(e,t,n):Optional.none(),getChildrenUntilBlockBoundary=e=>{let t=children$1(e);return findIndex$2(t,eY).fold(constant(t),e=>t.slice(0,e))},extractChildren=e=>{let t=getChildrenUntilBlockBoundary(e);return each$e(t,remove$5),t},removeEmptyRoot=(e,t)=>{let n=parentsAndSelf(t,e);return find$2(n.reverse(),e=>isEmpty$2(e)).each(remove$5)},isEmptyBefore=e=>0===filter$5(prevSiblings(e),e=>!isEmpty$2(e)).length,nestedBlockMerge=(e,t,n,o)=>{if(isEmpty$2(n))return fillWithPaddingBr(n),r$(n.dom);isEmptyBefore(o)&&isEmpty$2(t)&&before$3(o,eS.fromTag("br"));let a=rk(n.dom,CaretPosition.before(o.dom));return each$e(extractChildren(t),e=>{before$3(o,e)}),removeEmptyRoot(e,t),a},sidelongBlockMerge=(e,t,n)=>{if(isEmpty$2(n)){if(isEmpty$2(t)){let e=foldr((e=>{let helper=(e,t)=>firstChild(e).fold(()=>t,e=>isInline$1(e)?helper(e,t.concat(shallow$1(e))):t);return helper(e,[])})(n),(e,t)=>(wrap$2(e,t),t),createPaddingBr());empty(t),append$1(t,e)}return remove$5(n),r$(t.dom)}let o=rS(n.dom);return each$e(extractChildren(t),e=>{append$1(n,e)}),removeEmptyRoot(e,t),o},findInsertionPoint=(e,t)=>{let n=parentsAndSelf(t,e);return Optional.from(n[n.length-1])},getInsertionPoint=(e,t)=>contains(t,e)?findInsertionPoint(t,e):Optional.none(),trimBr=(e,t)=>{positionIn(e,t.dom).bind(e=>Optional.from(e.getNode())).map(eS.fromDom).filter(isBr$5).each(remove$5)},mergeBlockInto=(e,t,n)=>(trimBr(!0,t),trimBr(!1,n),getInsertionPoint(t,n).fold(curry(sidelongBlockMerge,e,t,n),curry(nestedBlockMerge,e,t,n))),mergeBlocks=(e,t,n,o)=>t?mergeBlockInto(e,o,n):mergeBlockInto(e,n,o),backspaceDelete$9=(e,t)=>{let n=eS.fromDom(e.getBody()),o=read$1(n.dom,t,e.selection.getRng()).map(o=>()=>{mergeBlocks(n,t,o.from.block,o.to.block).each(t=>{e.selection.setRng(t.toRange())})});return o},deleteRangeMergeBlocks=(e,t)=>{let n=t.getRng();return lift2(getParentBlock$2(e,eS.fromDom(n.startContainer)),getParentBlock$2(e,eS.fromDom(n.endContainer)),(o,a)=>eq(o,a)?Optional.none():Optional.some(()=>{n.deleteContents(),mergeBlocks(e,!0,o,a).each(e=>{t.setRng(e.toRange())})})).getOr(Optional.none())},isRawNodeInTable=(e,t)=>{let n=eS.fromDom(t),o=curry(eq,e);return ancestor$4(n,e0,o).isSome()},isSelectionInTable=(e,t)=>isRawNodeInTable(e,t.startContainer)||isRawNodeInTable(e,t.endContainer),isEverythingSelected=(e,t)=>{let n=rk(e.dom,CaretPosition.fromRangeStart(t)).isNone(),o=rE(e.dom,CaretPosition.fromRangeEnd(t)).isNone();return!isSelectionInTable(e,t)&&n&&o},emptyEditor=e=>Optional.some(()=>{e.setContent(""),e.selection.setCursorLocation()}),deleteRange$2=e=>{let t=eS.fromDom(e.getBody()),n=e.selection.getRng();return isEverythingSelected(t,n)?emptyEditor(e):deleteRangeMergeBlocks(t,e.selection)},backspaceDelete$8=(e,t)=>e.selection.isCollapsed()?Optional.none():deleteRange$2(e),showCaret=(e,t,n,o,a)=>Optional.from(t._selectionOverrides.showCaret(e,n,o,a)),getNodeRange=e=>{let t=e.ownerDocument.createRange();return t.selectNode(e),t},selectNode=(e,t)=>{let n=e.dispatch("BeforeObjectSelected",{target:t});return n.isDefaultPrevented()?Optional.none():Optional.some(getNodeRange(t))},renderCaretAtRange=(e,t,n)=>{let o=normalizeRange(1,e.getBody(),t),a=CaretPosition.fromRangeStart(o),i=a.getNode();if(isInlineFakeCaretTarget(i))return showCaret(1,e,i,!a.isAtEnd(),!1);let l=a.getNode(!0);if(isInlineFakeCaretTarget(l))return showCaret(1,e,l,!1,!1);let s=getContentEditableRoot$1(e.dom.getRoot(),a.getNode());return isInlineFakeCaretTarget(s)?showCaret(1,e,s,!1,n):Optional.none()},renderRangeCaret=(e,t,n)=>t.collapsed?renderCaretAtRange(e,t,n).getOr(t):t,isBeforeBoundary=e=>or(e)||r7(e),isAfterBoundary=e=>oo(e)||oe(e),trimEmptyTextNode=(e,t)=>{ew(t)&&0===t.data.length&&e.remove(t)},deleteContentAndShowCaret=(e,t,n,o,a,i)=>{showCaret(o,e,i.getNode(!a),a,!0).each(n=>{if(t.collapsed){let e=t.cloneRange();a?e.setEnd(n.startContainer,n.startOffset):e.setStart(n.endContainer,n.endOffset),e.deleteContents()}else t.deleteContents();e.selection.setRng(n)}),trimEmptyTextNode(e.dom,n)},deleteBoundaryText=(e,t)=>{let n=e.selection.getRng();if(!ew(n.commonAncestorContainer))return Optional.none();let o=t?g.Forwards:g.Backwards,a=CaretWalker(e.getBody()),i=curry(getVisualCaretPosition,t?a.next:a.prev),l=t?isBeforeBoundary:isAfterBoundary,s=getNormalizedRangeEndPoint(o,e.getBody(),n),d=i(s),c=d?normalizePosition(t,d):d;if(!c||!isMoveInsideSameBlock(s,c))return Optional.none();if(l(c))return Optional.some(()=>deleteContentAndShowCaret(e,n,s.getNode(),o,t,c));let m=i(c);return m&&l(m)&&isMoveInsideSameBlock(c,m)?Optional.some(()=>deleteContentAndShowCaret(e,n,s.getNode(),o,t,m)):Optional.none()},backspaceDelete$7=(e,t)=>deleteBoundaryText(e,t),getEdgeCefPosition=(e,t)=>{let n=e.getBody();return t?r$(n).filter(or):rS(n).filter(oo)},isCefAtEdgeSelected=e=>{let t=e.selection.getRng();return!t.collapsed&&(getEdgeCefPosition(e,!0).exists(e=>e.isEqual(CaretPosition.fromRangeStart(t)))||getEdgeCefPosition(e,!1).exists(e=>e.isEqual(CaretPosition.fromRangeEnd(t))))},isCompoundElement=e=>isNonNullable(e)&&(e0(eS.fromDom(e))||eQ(eS.fromDom(e))),aM=tq.generate([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),isAtContentEditableBlockCaret=(e,t)=>{let n=t.getNode(!e),o=e?"after":"before";return eR(n)&&n.getAttribute("data-mce-caret")===o},isDeleteFromCefDifferentBlocks=(e,t,n,o)=>{let inSameBlock=t=>isInline$1(eS.fromDom(t))&&!isInSameBlock(n,o,e);return getRelativeCefElm(!t,n).fold(()=>getRelativeCefElm(t,o).fold(w,inSameBlock),inSameBlock)},deleteEmptyBlockOrMoveToCef=(e,t,n,o)=>{let a=o.getNode(!t);return getParentBlock$2(eS.fromDom(e),eS.fromDom(n.getNode())).map(e=>isEmpty$2(e)?aM.remove(e.dom):aM.moveToElement(a)).orThunk(()=>Optional.some(aM.moveToElement(a)))},findCefPosition=(e,t,n)=>fromPosition(t,e,n).bind(o=>isCompoundElement(o.getNode())||isDeleteFromCefDifferentBlocks(e,t,n,o)?Optional.none():t&&eM(o.getNode())||!t&&eM(o.getNode(!0))?deleteEmptyBlockOrMoveToCef(e,t,n,o):t&&oo(n)?Optional.some(aM.moveToPosition(o)):!t&&or(n)?Optional.some(aM.moveToPosition(o)):Optional.none()),getContentEditableBlockAction=(e,t)=>isNullable(t)?Optional.none():e&&eM(t.nextSibling)?Optional.some(aM.moveToElement(t.nextSibling)):!e&&eM(t.previousSibling)?Optional.some(aM.moveToElement(t.previousSibling)):Optional.none(),skipMoveToActionFromInlineCefToContent=(e,t,n)=>n.fold(e=>Optional.some(aM.remove(e)),e=>Optional.some(aM.moveToElement(e)),n=>isInSameBlock(t,n,e)?Optional.none():Optional.some(aM.moveToPosition(n))),getContentEditableAction=(e,t,n)=>isAtContentEditableBlockCaret(t,n)?getContentEditableBlockAction(t,n.getNode(!t)).orThunk(()=>findCefPosition(e,t,n)):findCefPosition(e,t,n).bind(t=>skipMoveToActionFromInlineCefToContent(e,n,t)),read=(e,t,n)=>{let o=normalizeRange(t?1:-1,e,n),a=CaretPosition.fromRangeStart(o),i=eS.fromDom(e);return!t&&oo(a)?Optional.some(aM.remove(a.getNode(!0))):t&&or(a)?Optional.some(aM.remove(a.getNode())):!t&&or(a)&&isAfterBr(i,a)?od(i,a).map(e=>aM.remove(e.getNode())):t&&oo(a)&&isBeforeBr$1(i,a)?oc(i,a).map(e=>aM.remove(e.getNode())):getContentEditableAction(e,t,a)},deleteElement$1=(e,t)=>n=>(e._selectionOverrides.hideFakeCaret(),deleteElement$2(e,t,eS.fromDom(n)),!0),moveToElement=(e,t)=>n=>{let o=t?CaretPosition.before(n):CaretPosition.after(n);return e.selection.setRng(o.toRange()),!0},moveToPosition=e=>t=>(e.selection.setRng(t.toRange()),!0),getAncestorCe=(e,t)=>Optional.from(getContentEditableRoot$1(e.getBody(),t)),backspaceDeleteCaret=(e,t)=>{let n=e.selection.getNode();return getAncestorCe(e,n).filter(eM).fold(()=>read(e.getBody(),t,e.selection.getRng()).map(n=>()=>n.fold(deleteElement$1(e,t),moveToElement(e,t),moveToPosition(e))),()=>Optional.some(noop))},deleteOffscreenSelection=e=>{each$e(descendants(e,".mce-offscreen-selection"),remove$5)},backspaceDeleteRange=(e,t)=>{let n=e.selection.getNode();if(eM(n)&&!eU(n)){let o=getAncestorCe(e,n.parentNode).filter(eM);return o.fold(()=>Optional.some(()=>{deleteOffscreenSelection(eS.fromDom(e.getBody())),deleteElement$2(e,t,eS.fromDom(e.selection.getNode())),paddEmptyBody(e)}),()=>Optional.some(noop))}return isCefAtEdgeSelected(e)?Optional.some(()=>{deleteRangeContents(e,e.selection.getRng(),eS.fromDom(e.getBody()))}):Optional.none()},paddEmptyElement=e=>{let t=e.dom,n=e.selection,o=getContentEditableRoot$1(e.getBody(),n.getNode());if(eL(o)&&t.isBlock(o)&&t.isEmpty(o)){let e=t.create("br",{"data-mce-bogus":"1"});t.setHTML(o,""),o.appendChild(e),n.setRng(CaretPosition.before(e).toRange())}return!0},backspaceDelete$6=(e,t)=>e.selection.isCollapsed()?backspaceDeleteCaret(e,t):backspaceDeleteRange(e,t),deleteCaret$2=(e,t)=>{let n=CaretPosition.fromRangeStart(e.selection.getRng());return fromPosition(t,e.getBody(),n).filter(e=>t?r6(e):r9(e)).bind(e=>getChildNodeAtRelativeOffset(t?0:-1,e)).map(t=>()=>e.selection.select(t))},backspaceDelete$5=(e,t)=>e.selection.isCollapsed()?deleteCaret$2(e,t):Optional.none(),startsWithCaretContainer=e=>ew(e)&&"\uFEFF"===e.data[0],endsWithCaretContainer=e=>ew(e)&&"\uFEFF"===e.data[e.data.length-1],createZwsp=e=>{var t;let n=null!==(t=e.ownerDocument)&&void 0!==t?t:document;return n.createTextNode("\uFEFF")},insertBefore$1=e=>{var t;if(ew(e.previousSibling))return endsWithCaretContainer(e.previousSibling)||e.previousSibling.appendData("\uFEFF"),e.previousSibling;if(ew(e))return startsWithCaretContainer(e)||e.insertData(0,"\uFEFF"),e;{let n=createZwsp(e);return null===(t=e.parentNode)||void 0===t||t.insertBefore(n,e),n}},insertAfter$1=e=>{var t,n;if(ew(e.nextSibling))return startsWithCaretContainer(e.nextSibling)||e.nextSibling.insertData(0,"\uFEFF"),e.nextSibling;if(ew(e))return endsWithCaretContainer(e)||e.appendData("\uFEFF"),e;{let o=createZwsp(e);return e.nextSibling?null===(t=e.parentNode)||void 0===t||t.insertBefore(o,e.nextSibling):null===(n=e.parentNode)||void 0===n||n.appendChild(o),o}},insertInline=(e,t)=>e?insertBefore$1(t):insertAfter$1(t),aU=curry(insertInline,!0),az=curry(insertInline,!1),insertInlinePos=(e,t)=>ew(e.container())?insertInline(t,e.container()):insertInline(t,e.getNode()),isPosCaretContainer=(e,t)=>{let n=t.get();return n&&e.container()===n&&isCaretContainerInline(n)},renderCaret=(e,t)=>t.fold(t=>{remove$3(e.get());let n=aU(t);return e.set(n),Optional.some(CaretPosition(n,n.length-1))},t=>r$(t).map(t=>{if(isPosCaretContainer(t,e)){let t=e.get();return CaretPosition(t,1)}{remove$3(e.get());let n=insertInlinePos(t,!0);return e.set(n),CaretPosition(n,1)}}),t=>rS(t).map(t=>{if(isPosCaretContainer(t,e)){let t=e.get();return CaretPosition(t,t.length-1)}{remove$3(e.get());let n=insertInlinePos(t,!1);return e.set(n),CaretPosition(n,n.length-1)}}),t=>{remove$3(e.get());let n=az(t);return e.set(n),Optional.some(CaretPosition(n,1))}),evaluateUntil=(e,t)=>{for(let n=0;n<e.length;n++){let o=e[n].apply(null,t);if(o.isSome())return o}return Optional.none()},aW=tq.generate([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),rescope$1=(e,t)=>{let n=getParentBlock$3(t,e);return n||e},before=(e,t,n)=>{let o=ou(n),a=rescope$1(t,o.container());return findRootInline(e,a,o).fold(()=>rE(a,o).bind(curry(findRootInline,e,a)).map(e=>aW.before(e)),Optional.none)},isNotInsideFormatCaretContainer=(e,t)=>null===getParentCaretContainer(e,t),findInsideRootInline=(e,t,n)=>findRootInline(e,t,n).filter(curry(isNotInsideFormatCaretContainer,t)),start$1=(e,t,n)=>{let o=op(n);return findInsideRootInline(e,t,o).bind(e=>{let t=rk(e,o);return t.isNone()?Optional.some(aW.start(e)):Optional.none()})},end=(e,t,n)=>{let o=ou(n);return findInsideRootInline(e,t,o).bind(e=>{let t=rE(e,o);return t.isNone()?Optional.some(aW.end(e)):Optional.none()})},after=(e,t,n)=>{let o=op(n),a=rescope$1(t,o.container());return findRootInline(e,a,o).fold(()=>rk(a,o).bind(curry(findRootInline,e,a)).map(e=>aW.after(e)),Optional.none)},isValidLocation=e=>!isRtl(getElement(e)),readLocation=(e,t,n)=>{let o=evaluateUntil([before,start$1,end,after],[e,t,n]);return o.filter(isValidLocation)},getElement=e=>e.fold(identity,identity,identity,identity),getName=e=>e.fold(constant("before"),constant("start"),constant("end"),constant("after")),outside=e=>e.fold(aW.before,aW.before,aW.after,aW.after),inside=e=>e.fold(aW.start,aW.start,aW.end,aW.end),isEq=(e,t)=>getName(e)===getName(t)&&getElement(e)===getElement(t),betweenInlines=(e,t,n,o,a,i)=>lift2(findRootInline(t,n,o),findRootInline(t,n,a),(t,o)=>t!==o&&hasSameParentBlock(n,t,o)?aW.after(e?t:o):i).getOr(i),skipNoMovement=(e,t)=>e.fold(A,e=>!isEq(e,t)),findLocationTraverse=(e,t,n,o,a)=>{let i=normalizePosition(e,a),l=fromPosition(e,n,i).map(curry(normalizePosition,e)),s=l.fold(()=>o.map(outside),a=>readLocation(t,n,a).map(curry(betweenInlines,e,t,n,i,a)).filter(curry(skipNoMovement,o)));return s.filter(isValidLocation)},findLocationSimple=(e,t)=>e?t.fold(compose(Optional.some,aW.start),Optional.none,compose(Optional.some,aW.after),Optional.none):t.fold(Optional.none,compose(Optional.some,aW.before),Optional.none,compose(Optional.some,aW.end)),findLocation$1=(e,t,n,o)=>{let a=normalizePosition(e,o),i=readLocation(t,n,a);return readLocation(t,n,a).bind(curry(findLocationSimple,e)).orThunk(()=>findLocationTraverse(e,t,n,i,o))},hasSelectionModifyApi=e=>R(e.selection.getSel().modify),moveRel=(e,t,n)=>{let o=e?1:-1;return t.setRng(CaretPosition(n.container(),n.offset()+o).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0},moveByWord=(e,t)=>{let n=t.selection.getRng(),o=e?CaretPosition.fromRangeEnd(n):CaretPosition.fromRangeStart(n);return!!hasSelectionModifyApi(t)&&(e&&isBeforeInline(o)?moveRel(!0,t.selection,o):!!(!e&&isAfterInline(o))&&moveRel(!1,t.selection,o))};(d=f||(f={}))[d.Br=0]="Br",d[d.Block=1]="Block",d[d.Wrap=2]="Wrap",d[d.Eol=3]="Eol";let flip=(e,t)=>e===g.Backwards?reverse(t):t,walk$1=(e,t,n)=>e===g.Forwards?t.next(n):t.prev(n),getBreakType=(e,t,n,o)=>eF(o.getNode(t===g.Forwards))?f.Br:!1===isInSameBlock(n,o)?f.Block:f.Wrap,getPositionsUntil=(e,t,n,o)=>{let a=CaretWalker(n),i=o,l=[];for(;i;){let o=walk$1(t,a,i);if(!o)break;if(eF(o.getNode(!1))){if(t===g.Forwards)return{positions:flip(t,l).concat([o]),breakType:f.Br,breakAt:Optional.some(o)};return{positions:flip(t,l),breakType:f.Br,breakAt:Optional.some(o)}}if(!o.isVisible()){i=o;continue}if(e(i,o)){let e=getBreakType(n,t,i,o);return{positions:flip(t,l),breakType:e,breakAt:Optional.some(o)}}l.push(o),i=o}return{positions:flip(t,l),breakType:f.Eol,breakAt:Optional.none()}},getAdjacentLinePositions=(e,t,n,o)=>t(n,o).breakAt.map(o=>{let a=t(n,o).positions;return e===g.Backwards?a.concat(o):[o].concat(a)}).getOr([]),findClosestHorizontalPositionFromPoint=(e,t)=>foldl(e,(e,n)=>e.fold(()=>Optional.some(n),o=>lift2(head(o.getClientRects()),head(n.getClientRects()),(e,a)=>{let i=Math.abs(t-e.left),l=Math.abs(t-a.left);return l<=i?n:o}).or(e)),Optional.none()),findClosestHorizontalPosition=(e,t)=>head(t.getClientRects()).bind(t=>findClosestHorizontalPositionFromPoint(e,t.left)),aH=curry(getPositionsUntil,CaretPosition.isAbove,-1),aV=curry(getPositionsUntil,CaretPosition.isBelow,1),aq=curry(getAdjacentLinePositions,-1,aH),aj=curry(getAdjacentLinePositions,1,aV),isAtFirstLine=(e,t)=>aH(e,t).breakAt.isNone(),isAtLastLine=(e,t)=>aV(e,t).breakAt.isNone(),getFirstLinePositions=e=>r$(e).map(t=>[t].concat(aV(e,t).positions)).getOr([]),getLastLinePositions=e=>rS(e).map(t=>aH(e,t).positions.concat(t)).getOr([]),getClosestPositionAbove=(e,t)=>findClosestHorizontalPosition(aq(e,t),t),getClosestPositionBelow=(e,t)=>findClosestHorizontalPosition(aj(e,t),t),distanceToRectLeft$1=(e,t)=>Math.abs(e.left-t),distanceToRectRight$1=(e,t)=>Math.abs(e.right-t),isNodeClientRect=e=>hasNonNullableKey(e,"node"),findClosestClientRect=(e,t)=>reduce(e,(e,n)=>{let o=Math.min(distanceToRectLeft$1(e,t),distanceToRectRight$1(e,t)),a=Math.min(distanceToRectLeft$1(n,t),distanceToRectRight$1(n,t));return a===o&&isNodeClientRect(n)&&eM(n.node)||a<o?n:e}),getNodeClientRects=e=>{let toArrayWithNode=t=>map$3(t,t=>{let n=clone$1(t);return n.node=e,n});if(eR(e))return toArrayWithNode(e.getClientRects());if(!ew(e))return[];{let t=e.ownerDocument.createRange();return t.setStart(e,0),t.setEnd(e,e.data.length),toArrayWithNode(t.getClientRects())}},getClientRects=e=>bind$3(e,getNodeClientRects);(c=h||(h={}))[c.Up=-1]="Up",c[c.Down=1]="Down";let findUntil=(e,t,n,o)=>{let a=o;for(;a=findNode(a,e,isEditableCaretCandidate$1,t);)if(n(a))return},walkUntil=(e,t,n,o,a,i)=>{let l=0,s=[],add=o=>{let i=getClientRects([o]);-1===e&&(i=i.reverse());for(let e=0;e<i.length;e++){let o=i[e];if(!n(o,d)){if(s.length>0&&t(o,last$2(s))&&l++,o.line=l,a(o))return!0;s.push(o)}}return!1},d=last$2(i.getClientRects());if(!d)return s;let c=i.getNode();return c&&(add(c),findUntil(e,o,add,c)),s},aboveLineNumber=(e,t)=>t.line>e,isLineNumber=(e,t)=>t.line===e,aK=curry(walkUntil,h.Up,isAbove$1,isBelow$1),aG=curry(walkUntil,h.Down,isBelow$1,isAbove$1),getLastClientRect=e=>last$2(e.getClientRects()),positionsUntil=(e,t,n,o)=>{let a,i,l,s;let d=CaretWalker(t),c=[],m=0;1===e?(a=d.next,i=isBelow$1,l=isAbove$1,s=CaretPosition.after(o)):(a=d.prev,i=isAbove$1,l=isBelow$1,s=CaretPosition.before(o));let u=getLastClientRect(s);do{if(!s.isVisible())continue;let e=getLastClientRect(s);if(l(e,u))continue;c.length>0&&i(e,last$2(c))&&m++;let t=clone$1(e);if(t.position=s,t.line=m,n(t))break;c.push(t)}while(s=a(s));return c},isAboveLine=e=>t=>aboveLineNumber(e,t),isLine=e=>t=>isLineNumber(e,t),moveToRange=(e,t)=>{e.selection.setRng(t),scrollRangeIntoView(e,e.selection.getRng())},renderRangeCaretOpt=(e,t,n)=>Optional.some(renderRangeCaret(e,t,n)),moveHorizontally=(e,t,n,o,a,i)=>{let l=t===g.Forwards,s=CaretWalker(e.getBody()),d=curry(getVisualCaretPosition,l?s.next:s.prev),c=l?o:a;if(!n.collapsed){let o=getSelectedNode(n);if(i(o))return showCaret(t,e,o,t===g.Backwards,!1);if(isCefAtEdgeSelected(e)){let e=n.cloneRange();return e.collapse(t===g.Backwards),Optional.from(e)}}let m=getNormalizedRangeEndPoint(t,e.getBody(),n);if(c(m))return selectNode(e,m.getNode(!l));let u=d(m),p=isRangeInCaretContainerBlock(n);if(!u)return p?Optional.some(n):Optional.none();if(c(u=normalizePosition(l,u)))return showCaret(t,e,u.getNode(!l),l,!1);let f=d(u);return f&&c(f)&&isMoveInsideSameBlock(u,f)?showCaret(t,e,f.getNode(!l),l,!1):p?renderRangeCaretOpt(e,u.toRange(),!1):Optional.none()},moveVertically=(e,t,n,o,a,i)=>{let l;let s=getNormalizedRangeEndPoint(t,e.getBody(),n),d=last$2(s.getClientRects()),c=t===h.Down,m=e.getBody();if(!d)return Optional.none();if(isCefAtEdgeSelected(e)){let e=c?CaretPosition.fromRangeEnd(n):CaretPosition.fromRangeStart(n),t=c?getClosestPositionBelow:getClosestPositionAbove;return t(m,e).orThunk(()=>Optional.from(e)).map(e=>e.toRange())}let u=c?aG:aK,p=u(m,isAboveLine(1),s),g=filter$5(p,isLine(1)),f=d.left,b=findClosestClientRect(g,f);if(b&&i(b.node)){let n=Math.abs(f-b.left),o=Math.abs(f-b.right);return showCaret(t,e,b.node,n<o,!1)}if(l=o(s)?s.getNode():a(s)?s.getNode(!0):getSelectedNode(n)){let n=positionsUntil(t,m,isAboveLine(1),l),o=findClosestClientRect(filter$5(n,isLine(1)),f);if(o||(o=last$2(filter$5(n,isLine(0)))))return renderRangeCaretOpt(e,o.position.toRange(),!1)}return 0===g.length?getLineEndPoint(e,c).filter(c?a:o).map(t=>renderRangeCaret(e,t.toRange(),!1)):Optional.none()},getLineEndPoint=(e,t)=>{let n=e.selection.getRng(),o=t?CaretPosition.fromRangeEnd(n):CaretPosition.fromRangeStart(n),a=getEditingHost(o.container(),e.getBody());if(t){let e=aV(a,o);return last$3(e.positions)}{let e=aH(a,o);return head(e.positions)}},moveToLineEndPoint$3=(e,t,n)=>getLineEndPoint(e,t).filter(n).exists(t=>(e.selection.setRng(t.toRange()),!0)),setCaretPosition=(e,t)=>{let n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)},setSelected=(e,t)=>{e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")},renderCaretLocation=(e,t,n)=>renderCaret(t,n).map(t=>(setCaretPosition(e,t),n)),getPositionFromRange=(e,t,n)=>{let o=CaretPosition.fromRangeStart(e);if(e.collapsed)return o;{let a=CaretPosition.fromRangeEnd(e);return n?rk(t,a).getOr(a):rE(t,o).getOr(o)}},findLocation=(e,t,n)=>{let o=e.getBody(),a=getPositionFromRange(e.selection.getRng(),o,n),i=curry(isInlineTarget,e),l=findLocation$1(n,i,o,a);return l.bind(n=>renderCaretLocation(e,t,n))},toggleInlines=(e,t,n)=>{let o=map$3(descendants(eS.fromDom(t.getRoot()),'*[data-mce-selected="inline-boundary"]'),e=>e.dom),a=filter$5(o,e),i=filter$5(n,e);each$e(difference(a,i),curry(setSelected,!1)),each$e(difference(i,a),curry(setSelected,!0))},safeRemoveCaretContainer=(e,t)=>{let n=t.get();if(e.selection.isCollapsed()&&!e.composing&&n){let o=CaretPosition.fromRangeStart(e.selection.getRng());CaretPosition.isTextPosition(o)&&!isAtZwsp(o)&&(setCaretPosition(e,removeAndReposition(n,o)),t.set(null))}},renderInsideInlineCaret=(e,t,n,o)=>{if(t.selection.isCollapsed()){let a=filter$5(o,e);each$e(a,o=>{let a=CaretPosition.fromRangeStart(t.selection.getRng());readLocation(e,t.getBody(),a).bind(e=>renderCaretLocation(t,n,e))})}},move$3=(e,t,n)=>!!nx(e)&&findLocation(e,t,n).isSome(),moveWord=(e,t,n)=>!!nx(t)&&moveByWord(e,t),setupSelectedState=e=>{let t=Cell(null),n=curry(isInlineTarget,e);return e.on("NodeChange",o=>{nx(e)&&(toggleInlines(n,e.dom,o.parents),safeRemoveCaretContainer(e,t),renderInsideInlineCaret(n,e,t,o.parents))}),t},aY=curry(moveWord,!0),aX=curry(moveWord,!1),moveToLineEndPoint$2=(e,t,n)=>{if(!nx(e))return!1;{let o=getLineEndPoint(e,t).getOrThunk(()=>{let n=e.selection.getRng();return t?CaretPosition.fromRangeEnd(n):CaretPosition.fromRangeStart(n)});return readLocation(curry(isInlineTarget,e),e.getBody(),o).exists(t=>{let o=outside(t);return renderCaret(n,o).exists(t=>(setCaretPosition(e,t),!0))})}},rangeFromPositions=(e,t)=>{let n=document.createRange();return n.setStart(e.container(),e.offset()),n.setEnd(t.container(),t.offset()),n},hasOnlyTwoOrLessPositionsLeft=e=>lift2(r$(e),rS(e),(t,n)=>{let o=normalizePosition(!0,t),a=normalizePosition(!1,n);return rE(e,o).forall(e=>e.isEqual(a))}).getOr(!0),setCaretLocation=(e,t)=>n=>renderCaret(t,n).map(t=>()=>setCaretPosition(e,t)),deleteFromTo=(e,t,n,o)=>{let a=e.getBody(),i=curry(isInlineTarget,e);e.undoManager.ignore(()=>{e.selection.setRng(rangeFromPositions(n,o)),execNativeDeleteCommand(e),readLocation(i,a,CaretPosition.fromRangeStart(e.selection.getRng())).map(inside).bind(setCaretLocation(e,t)).each(call)}),e.nodeChanged()},rescope=(e,t)=>{let n=getParentBlock$3(t,e);return n||e},backspaceDeleteCollapsed=(e,t,n,o)=>{let a=rescope(e.getBody(),o.container()),i=curry(isInlineTarget,e),l=readLocation(i,a,o),s=l.bind(e=>n?e.fold(constant(Optional.some(inside(e))),Optional.none,constant(Optional.some(outside(e))),Optional.none):e.fold(Optional.none,constant(Optional.some(outside(e))),Optional.none,constant(Optional.some(inside(e)))));return s.map(setCaretLocation(e,t)).getOrThunk(()=>{let s=navigate(n,a,o),d=s.bind(e=>readLocation(i,a,e));return lift2(l,d,()=>findRootInline(i,a,o).bind(t=>hasOnlyTwoOrLessPositionsLeft(t)?Optional.some(()=>{deleteElement$2(e,n,eS.fromDom(t))}):Optional.none())).getOrThunk(()=>d.bind(()=>s.map(a=>()=>{n?deleteFromTo(e,t,o,a):deleteFromTo(e,t,a,o)})))})},backspaceDelete$4=(e,t,n)=>{if(e.selection.isCollapsed()&&nx(e)){let o=CaretPosition.fromRangeStart(e.selection.getRng());return backspaceDeleteCollapsed(e,t,n,o)}return Optional.none()},hasMultipleChildren=e=>childNodesCount(e)>1,getParentsUntil=(e,t)=>{let n=eS.fromDom(e.getBody()),o=eS.fromDom(e.selection.getStart()),a=parentsAndSelf(o,n);return findIndex$2(a,t).fold(constant(a),e=>a.slice(0,e))},hasOnlyOneChild=e=>1===childNodesCount(e),getParentInlinesUntilMultichildInline=e=>getParentsUntil(e,e=>eY(e)||hasMultipleChildren(e)),getParentInlines=e=>getParentsUntil(e,eY),getFormatNodes=(e,t)=>{let n=curry(isFormatElement,e);return bind$3(t,e=>n(e)?[e.dom]:[])},getFormatNodesAtStart=e=>{let t=getParentInlines(e);return getFormatNodes(e,t)},deleteLastPosition=(e,t,n,o)=>{let a=getFormatNodes(t,o);if(0===a.length)deleteElement$2(t,e,n);else{let e=replaceWithCaretFormat(n.dom,a);t.selection.setRng(e.toRange())}},deleteCaret$1=(e,t)=>{let n=filter$5(getParentInlinesUntilMultichildInline(e),hasOnlyOneChild);return last$3(n).bind(o=>{let a=CaretPosition.fromRangeStart(e.selection.getRng());return willDeleteLastPositionInElement(t,a,o.dom)&&!isEmptyCaretFormatElement(o)?Optional.some(()=>deleteLastPosition(t,e,o,n)):Optional.none()})},isBrInEmptyElement=(e,t)=>{let n=t.parentElement;return eF(t)&&!N(n)&&e.dom.isEmpty(n)},isEmptyCaret=e=>isEmptyCaretFormatElement(eS.fromDom(e)),createCaretFormatAtStart=(e,t)=>{let n=e.selection.getStart(),o=isBrInEmptyElement(e,n)||isEmptyCaret(n)?replaceWithCaretFormat(n,t):createCaretFormatAtStart$1(e.selection.getRng(),t);e.selection.setRng(o.toRange())},updateCaretFormat=(e,t)=>{let n=difference(t,getFormatNodesAtStart(e));n.length>0&&createCaretFormatAtStart(e,n)},rangeStartsAtTextContainer=e=>ew(e.startContainer),rangeStartsAtStartOfTextContainer=e=>0===e.startOffset&&rangeStartsAtTextContainer(e),rangeStartParentIsFormatElement=(e,t)=>{let n=t.startContainer.parentElement;return!N(n)&&isFormatElement(e,eS.fromDom(n))},rangeStartAndEndHaveSameParent=e=>{let t=e.startContainer.parentNode,n=e.endContainer.parentNode;return!N(t)&&!N(n)&&t.isEqualNode(n)},rangeEndsAtEndOfEndContainer=e=>{let t=e.endContainer;return e.endOffset===(ew(t)?t.length:t.childNodes.length)},rangeEndsAtEndOfStartContainer=e=>rangeStartAndEndHaveSameParent(e)&&rangeEndsAtEndOfEndContainer(e),rangeEndsAfterEndOfStartContainer=e=>!e.endContainer.isEqualNode(e.commonAncestorContainer),rangeEndsAtOrAfterEndOfStartContainer=e=>rangeEndsAtEndOfStartContainer(e)||rangeEndsAfterEndOfStartContainer(e),requiresDeleteRangeOverride=e=>{let t=e.selection.getRng();return rangeStartsAtStartOfTextContainer(t)&&rangeStartParentIsFormatElement(e,t)&&rangeEndsAtOrAfterEndOfStartContainer(t)},deleteRange$1=e=>{if(!requiresDeleteRangeOverride(e))return Optional.none();{let t=getFormatNodesAtStart(e);return Optional.some(()=>{execNativeDeleteCommand(e),updateCaretFormat(e,t)})}},backspaceDelete$3=(e,t)=>e.selection.isCollapsed()?deleteCaret$1(e,t):deleteRange$1(e),hasAncestorInlineCaret=e=>ancestor$1(e,e=>isCaretNode(e.dom),eY),hasAncestorInlineCaretAtStart=e=>hasAncestorInlineCaret(eS.fromDom(e.selection.getStart())),requiresRefreshCaretOverride=e=>{let t=e.selection.getRng();return t.collapsed&&(rangeStartsAtTextContainer(t)||e.dom.isEmpty(t.startContainer))&&!hasAncestorInlineCaretAtStart(e)},refreshCaret=e=>(requiresRefreshCaretOverride(e)&&createCaretFormatAtStart(e,[]),!0),deleteElement=(e,t,n)=>isNonNullable(n)?Optional.some(()=>{e._selectionOverrides.hideFakeCaret(),deleteElement$2(e,t,eS.fromDom(n))}):Optional.none(),deleteCaret=(e,t)=>{let n=t?r7:oe,o=t?g.Forwards:g.Backwards,a=getNormalizedRangeEndPoint(o,e.getBody(),e.selection.getRng());return n(a)?deleteElement(e,t,a.getNode(!t)):Optional.from(normalizePosition(t,a)).filter(e=>n(e)&&isMoveInsideSameBlock(a,e)).bind(n=>deleteElement(e,t,n.getNode(!t)))},deleteRange=(e,t)=>{let n=e.selection.getNode();return eW(n)?deleteElement(e,t,n):Optional.none()},backspaceDelete$2=(e,t)=>e.selection.isCollapsed()?deleteCaret(e,t):deleteRange(e,t),isEditable=e=>closest$4(e,e=>eL(e.dom)||eM(e.dom)).exists(e=>eL(e.dom)),parseIndentValue=e=>toInt(null!=e?e:"").getOr(0),getIndentStyleName=(e,t)=>{let n=e||isTable$1(t)?"margin":"padding",o="rtl"===get$7(t,"direction")?"-right":"-left";return n+o},indentElement=(e,t,n,o,a,i)=>{let l=getIndentStyleName(n,eS.fromDom(i)),s=parseIndentValue(e.getStyle(i,l));if("outdent"===t){let t=Math.max(0,s-o);e.setStyle(i,l,t?t+a:"")}else{let t=s+o+a;e.setStyle(i,l,t)}},validateBlocks=(e,t)=>forall(t,t=>{let n=getIndentStyleName(np(e),t),o=getRaw(t,n).map(parseIndentValue).getOr(0),a=e.dom.getContentEditable(t.dom);return"false"!==a&&o>0}),canOutdent=e=>{let t=getBlocksToIndent(e);return!e.mode.isReadOnly()&&(t.length>1||validateBlocks(e,t))},isListComponent=e=>eZ(e)||eQ(e),parentIsListComponent=e=>parent(e).exists(isListComponent),getBlocksToIndent=e=>filter$5(fromDom$1(e.selection.getSelectedBlocks()),e=>!isListComponent(e)&&!parentIsListComponent(e)&&isEditable(e)),handle=(e,t)=>{var n,o;let{dom:a}=e,i=ng(e),l=null!==(o=null===(n=/[a-z%]+$/i.exec(i))||void 0===n?void 0:n[0])&&void 0!==o?o:"px",s=parseIndentValue(i),d=np(e);each$e(getBlocksToIndent(e),e=>{indentElement(a,t,d,s,l,e.dom)})},indent=e=>handle(e,"indent"),outdent=e=>handle(e,"outdent"),backspaceDelete$1=e=>{if(e.selection.isCollapsed()&&canOutdent(e)){let t=e.dom,n=e.selection.getRng(),o=CaretPosition.fromRangeStart(n),a=t.getParent(n.startContainer,t.isBlock);if(null!==a&&oa(eS.fromDom(a),o))return Optional.some(()=>outdent(e))}return Optional.none()},findAction=(e,t,n)=>findMap([backspaceDelete$1,backspaceDelete$6,backspaceDelete$7,(e,n)=>backspaceDelete$4(e,t,n),backspaceDelete$9,backspaceDelete$a,backspaceDelete$5,backspaceDelete$2,backspaceDelete$8,backspaceDelete$3],t=>t(e,n)).filter(t=>e.selection.isEditable()),deleteCommand=(e,t)=>{let n=findAction(e,t,!1);n.fold(()=>{execNativeDeleteCommand(e),paddEmptyBody(e)},call)},forwardDeleteCommand=(e,t)=>{let n=findAction(e,t,!0);n.fold(()=>execNativeForwardDeleteCommand(e),call)},setup$p=(e,t)=>{e.addCommand("delete",()=>{deleteCommand(e,t)}),e.addCommand("forwardDelete",()=>{forwardDeleteCommand(e,t)})},getTouch=e=>void 0===e.touches||1!==e.touches.length?Optional.none():Optional.some(e.touches[0]),isFarEnough=(e,t)=>{let n=Math.abs(e.clientX-t.x),o=Math.abs(e.clientY-t.y);return n>5||o>5},setup$o=e=>{let t=value$2(),n=Cell(!1),o=last$1(t=>{e.dispatch("longpress",{...t,type:"longpress"}),n.set(!0)},400);e.on("touchstart",e=>{getTouch(e).each(a=>{o.cancel();let i={x:a.clientX,y:a.clientY,target:e.target};o.throttle(e),n.set(!1),t.set(i)})},!0),e.on("touchmove",a=>{o.cancel(),getTouch(a).each(o=>{t.on(a=>{isFarEnough(o,a)&&(t.clear(),n.set(!1),e.dispatch("longpresscancel"))})})},!0),e.on("touchend touchcancel",a=>{o.cancel(),"touchcancel"!==a.type&&t.get().filter(e=>e.target.isEqualNode(a.target)).each(()=>{n.get()?a.preventDefault():e.dispatch("tap",{...a,type:"tap"})})},!0)},isBlockElement=(e,t)=>has$2(e,t.nodeName),isValidTarget=(e,t)=>!!ew(t)||!!eR(t)&&!isBlockElement(e.getBlockElements(),t)&&!isBookmarkNode$1(t)&&!isTransparentBlock(e,t),hasBlockParent=(e,t,n)=>exists(parents(eS.fromDom(n),eS.fromDom(t)),t=>isBlockElement(e,t.dom)),shouldRemoveTextNode=(e,t)=>!!(ew(t)&&(0===t.data.length||/^\s+$/.test(t.data)&&(!t.nextSibling||isBlockElement(e,t.nextSibling)))),createRootBlock=e=>e.dom.create(t2(e),t3(e)),addRootBlocks=e=>{let t,n;let o=e.dom,a=e.selection,i=e.schema,l=i.getBlockElements(),s=a.getStart(),d=e.getBody(),c=!1,m=t2(e);if(!s||!eR(s))return;let u=d.nodeName.toLowerCase();if(!i.isValidChild(u,m.toLowerCase())||hasBlockParent(l,d,s))return;let p=a.getRng(),{startContainer:g,startOffset:f,endContainer:h,endOffset:b}=p,C=hasFocus(e),y=d.firstChild;for(;y;)if(eR(y)&&updateElement(i,y),isValidTarget(i,y)){if(shouldRemoveTextNode(l,y)){n=y,y=y.nextSibling,o.remove(n);continue}t||(t=createRootBlock(e),d.insertBefore(t,y),c=!0),n=y,y=y.nextSibling,t.appendChild(n)}else t=null,y=y.nextSibling;c&&C&&(p.setStart(g,f),p.setEnd(h,b),a.setRng(p),e.nodeChanged())},insertEmptyLine=(e,t,n)=>{let o=eS.fromDom(createRootBlock(e)),a=createPaddingBr();append$1(o,a),n(t,o);let i=document.createRange();return i.setStartBefore(a.dom),i.setEndBefore(a.dom),i},setup$n=e=>{e.on("NodeChange",curry(addRootBlocks,e))},hasClass=e=>t=>-1!==(" "+t.attr("class")+" ").indexOf(e),replaceMatchWithSpan=(e,t,n)=>function(o){let a=arguments,i=a[a.length-2],l=i>0?t.charAt(i-1):"";if('"'===l)return o;if(">"===l){let e=t.lastIndexOf("<",i);if(-1!==e){let n=t.substring(e,i);if(-1!==n.indexOf('contenteditable="false"'))return o}}return'<span class="'+n+'" data-mce-content="'+e.dom.encode(a[0])+'">'+e.dom.encode("string"==typeof a[1]?a[1]:a[0])+"</span>"},convertRegExpsToNonEditable=(e,t,n)=>{let o=t.length,a=n.content;if("raw"!==n.format){for(;o--;)a=a.replace(t[o],replaceMatchWithSpan(e,a,rs(e)));n.content=a}},setup$m=e=>{let t="contenteditable",n=" "+eb.trim(rd(e))+" ",o=" "+eb.trim(rs(e))+" ",a=hasClass(n),i=hasClass(o),l=rc(e);l.length>0&&e.on("BeforeSetContent",t=>{convertRegExpsToNonEditable(e,l,t)}),e.parser.addAttributeFilter("class",e=>{let n=e.length;for(;n--;){let o=e[n];a(o)?o.attr(t,"true"):i(o)&&o.attr(t,"false")}}),e.serializer.addAttributeFilter(t,e=>{let n=e.length;for(;n--;){let o=e[n];(a(o)||i(o))&&(l.length>0&&o.attr("data-mce-content")?(o.name="#text",o.type=3,o.raw=!0,o.value=o.attr("data-mce-content")):o.attr(t,null))}})},findBlockCaretContainer=e=>descendant(eS.fromDom(e.getBody()),"*[data-mce-caret]").map(e=>e.dom).getOrNull(),showBlockCaretContainer=(e,t)=>{t.hasAttribute("data-mce-caret")&&(showCaretContainerBlock(t),e.selection.setRng(e.selection.getRng()),e.selection.scrollIntoView(t))},handleBlockContainer=(e,t)=>{let n=findBlockCaretContainer(e);if(n){if("compositionstart"===t.type){t.preventDefault(),t.stopPropagation(),showBlockCaretContainer(e,n);return}hasContent(n)&&(showBlockCaretContainer(e,n),e.undoManager.add())}},setup$l=e=>{e.on("keyup compositionstart",curry(handleBlockContainer,e))},moveToCeFalseHorizontally=(e,t,n)=>moveHorizontally(t,e,n,or,oo,eM),moveToCeFalseVertically=(e,t,n)=>moveVertically(t,e,n,e=>or(e)||ot(e),e=>oo(e)||on(e),eM),createTextBlock=e=>{let t=e.dom.create(t2(e));return t.innerHTML='<br data-mce-bogus="1">',t},exitPreBlock=(e,t,n)=>{let o=CaretWalker(e.getBody()),a=curry(getVisualCaretPosition,1===t?o.next:o.prev);if(n.collapsed){let o=e.dom.getParent(n.startContainer,"PRE");if(!o)return;let i=a(CaretPosition.fromRangeStart(n));if(!i){let n=eS.fromDom(createTextBlock(e));1===t?after$4(eS.fromDom(o),n):before$3(eS.fromDom(o),n),e.selection.select(n.dom,!0),e.selection.collapse()}}},getHorizontalRange=(e,t)=>{let n=t?g.Forwards:g.Backwards,o=e.selection.getRng();return moveToCeFalseHorizontally(n,e,o).orThunk(()=>(exitPreBlock(e,n,o),Optional.none()))},getVerticalRange=(e,t)=>{let n=t?1:-1,o=e.selection.getRng();return moveToCeFalseVertically(n,e,o).orThunk(()=>(exitPreBlock(e,n,o),Optional.none()))},flipDirection=(e,t)=>{let n=t?e.getEnd(!0):e.getStart(!0);return isRtl(n)?!t:t},moveH$2=(e,t)=>getHorizontalRange(e,flipDirection(e.selection,t)).exists(t=>(moveToRange(e,t),!0)),moveV$4=(e,t)=>getVerticalRange(e,t).exists(t=>(moveToRange(e,t),!0)),moveToLineEndPoint$1=(e,t)=>{let n=t?oo:or;return moveToLineEndPoint$3(e,t,n)},selectToEndPoint=(e,t)=>getEdgeCefPosition(e,!t).map(n=>{let o=n.toRange(),a=e.selection.getRng();return t?o.setStart(a.startContainer,a.startOffset):o.setEnd(a.endContainer,a.endOffset),o}).exists(t=>(moveToRange(e,t),!0)),isTarget=e=>contains$2(["figcaption"],name(e)),getClosestTargetBlock=(e,t)=>{let n=curry(eq,t);return closest$4(eS.fromDom(e.container()),eY,n).filter(isTarget)},isAtFirstOrLastLine=(e,t,n)=>t?isAtLastLine(e.dom,n):isAtFirstLine(e.dom,n),moveCaretToNewEmptyLine=(e,t)=>{let n=eS.fromDom(e.getBody()),o=CaretPosition.fromRangeStart(e.selection.getRng());return getClosestTargetBlock(o,n).exists(()=>{if(!isAtFirstOrLastLine(n,t,o))return!1;{let o=t?append$1:prepend,a=insertEmptyLine(e,n,o);return e.selection.setRng(a),!0}})},moveV$3=(e,t)=>!!e.selection.isCollapsed()&&moveCaretToNewEmptyLine(e,t),moveUp=(e,t,n)=>{let o=e.selection.getRng(),a=CaretPosition.fromRangeStart(o),i=e.getBody();return!!(i.firstChild===t&&isAtFirstLine(n,a))&&(e.execCommand("InsertNewBlockBefore"),!0)},moveDown=(e,t)=>{let n=e.selection.getRng(),o=CaretPosition.fromRangeStart(n),a=e.getBody();return!!(a.lastChild===t&&isAtLastLine(t,o))&&(e.execCommand("InsertNewBlockAfter"),!0)},move$2=(e,t)=>t?Optional.from(e.dom.getParent(e.selection.getNode(),"details")).map(t=>moveDown(e,t)).getOr(!1):Optional.from(e.dom.getParent(e.selection.getNode(),"summary")).bind(t=>Optional.from(e.dom.getParent(t,"details")).map(n=>moveUp(e,n,t))).getOr(!1),moveV$2=(e,t)=>move$2(e,t),aZ={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0},defaultPatterns=e=>map$3(e,e=>({...aZ,...e})),defaultDelayedPatterns=e=>map$3(e,e=>({...aZ,...e})),matchesEvent=(e,t)=>t.keyCode===e.keyCode&&t.shiftKey===e.shiftKey&&t.altKey===e.altKey&&t.ctrlKey===e.ctrlKey&&t.metaKey===e.metaKey,match$1=(e,t)=>bind$3(defaultPatterns(e),e=>matchesEvent(e,t)?[e]:[]),matchDelayed=(e,t)=>bind$3(defaultDelayedPatterns(e),e=>matchesEvent(e,t)?[e]:[]),action=(e,...t)=>()=>e.apply(null,t),execute=(e,t)=>find$2(match$1(e,t),e=>e.action()),executeWithDelayedAction=(e,t)=>findMap(matchDelayed(e,t),e=>e.action()),moveH$1=(e,t)=>{let n=t?g.Forwards:g.Backwards,o=e.selection.getRng();return moveHorizontally(e,n,o,r7,oe,eW).exists(t=>(moveToRange(e,t),!0))},moveV$1=(e,t)=>{let n=e.selection.getRng();return moveVertically(e,t?1:-1,n,r7,oe,eW).exists(t=>(moveToRange(e,t),!0))},moveToLineEndPoint=(e,t)=>{let n=t?oe:r7;return moveToLineEndPoint$3(e,t,n)},aQ=tq.generate([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),aJ={...aQ,none:e=>aQ.none(e)},firstLayer=(e,t)=>filterFirstLayer(e,t,A),filterFirstLayer=(e,t,n)=>bind$3(children$1(e),e=>is$1(e,t)?n(e)?[e]:[]:filterFirstLayer(e,t,n)),lookup$1=(e,t,n=w)=>n(t)?Optional.none():contains$2(e,name(t))?Optional.some(t):ancestor$3(t,e.join(","),e=>is$1(e,"table")||n(e)),cell=(e,t)=>lookup$1(["td","th"],e,t),cells=e=>firstLayer(e,"th,td"),table=(e,t)=>closest$3(e,"table",t),walk=(e,t,n,o,a=A)=>{let i=1===o;if(!i&&n<=0)return aJ.first(e[0]);if(i&&n>=e.length-1)return aJ.last(e[e.length-1]);{let i=n+o,l=e[i];return a(l)?aJ.middle(t,l):walk(e,t,i,o,a)}},detect=(e,t)=>table(e,t).bind(t=>{let n=cells(t),o=findIndex$2(n,t=>eq(e,t));return o.map(e=>({index:e,all:n}))}),next=(e,t,n)=>{let o=detect(e,n);return o.fold(()=>aJ.none(e),n=>walk(n.all,e,n.index,1,t))},prev=(e,t,n)=>{let o=detect(e,n);return o.fold(()=>aJ.none(),n=>walk(n.all,e,n.index,-1,t))},deflate=(e,t)=>({left:e.left-t,top:e.top-t,right:e.right+2*t,bottom:e.bottom+2*t,width:e.width+t,height:e.height+t}),getCorners=(e,t)=>bind$3(t,t=>{let n=deflate(clone$1(t.getBoundingClientRect()),-1);return[{x:n.left,y:e(n),cell:t},{x:n.right,y:e(n),cell:t}]}),findClosestCorner=(e,t,n)=>foldl(e,(e,o)=>e.fold(()=>Optional.some(o),e=>{let a=Math.sqrt(Math.abs(e.x-t)+Math.abs(e.y-n)),i=Math.sqrt(Math.abs(o.x-t)+Math.abs(o.y-n));return Optional.some(i<a?o:e)}),Optional.none()),getClosestCell=(e,t,n,o,a)=>{let i=descendants(eS.fromDom(n),"td,th,caption").map(e=>e.dom),l=filter$5(getCorners(e,i),e=>t(e,a));return findClosestCorner(l,o,a).map(e=>e.cell)},a0=curry(getClosestCell,e=>e.bottom,(e,t)=>e.y<t),a1=curry(getClosestCell,e=>e.top,(e,t)=>e.y>t),findClosestPositionInAboveCell=(e,t)=>head(t.getClientRects()).bind(t=>a0(e,t.left,t.top)).bind(e=>findClosestHorizontalPosition(getLastLinePositions(e),t)),findClosestPositionInBelowCell=(e,t)=>last$3(t.getClientRects()).bind(t=>a1(e,t.left,t.top)).bind(e=>findClosestHorizontalPosition(getFirstLinePositions(e),t)),hasNextBreak=(e,t,n)=>n.breakAt.exists(n=>e(t,n).breakAt.isSome()),startsWithWrapBreak=e=>e.breakType===f.Wrap&&0===e.positions.length,startsWithBrBreak=e=>e.breakType===f.Br&&1===e.positions.length,isAtTableCellLine=(e,t,n)=>{let o=e(t,n);return startsWithWrapBreak(o)||!eF(n.getNode())&&startsWithBrBreak(o)?!hasNextBreak(e,t,o):o.breakAt.isNone()},a2=curry(isAtTableCellLine,aH),a3=curry(isAtTableCellLine,aV),isCaretAtStartOrEndOfTable=(e,t,n)=>{let o=CaretPosition.fromRangeStart(t);return positionIn(!e,n).exists(e=>e.isEqual(o))},navigateHorizontally=(e,t,n,o)=>{let a=e.selection.getRng(),i=t?1:-1;return!!(isFakeCaretTableBrowser()&&isCaretAtStartOrEndOfTable(t,a,n))&&(showCaret(i,e,n,!t,!1).each(t=>{moveToRange(e,t)}),!0)},getClosestAbovePosition=(e,t,n)=>findClosestPositionInAboveCell(t,n).orThunk(()=>head(n.getClientRects()).bind(n=>findClosestHorizontalPositionFromPoint(aq(e,CaretPosition.before(t)),n.left))).getOr(CaretPosition.before(t)),getClosestBelowPosition=(e,t,n)=>findClosestPositionInBelowCell(t,n).orThunk(()=>head(n.getClientRects()).bind(n=>findClosestHorizontalPositionFromPoint(aj(e,CaretPosition.after(t)),n.left))).getOr(CaretPosition.after(t)),getTable=(e,t)=>{let n=t.getNode(e);return isTable$2(n)?Optional.some(n):Optional.none()},renderBlock=(e,t,n)=>{t.undoManager.transact(()=>{let o=insertEmptyLine(t,eS.fromDom(n),e?after$4:before$3);moveToRange(t,o)})},moveCaret=(e,t,n)=>{let o=t?getTable(!0,n):getTable(!1,n),a=!1===t;o.fold(()=>moveToRange(e,n.toRange()),o=>positionIn(a,e.getBody()).filter(e=>e.isEqual(n)).fold(()=>moveToRange(e,n.toRange()),n=>renderBlock(t,e,o)))},navigateVertically=(e,t,n,o)=>{let a=e.selection.getRng(),i=CaretPosition.fromRangeStart(a),l=e.getBody();if(!t&&a2(o,i)){let o=getClosestAbovePosition(l,n,i);return moveCaret(e,t,o),!0}if(!(t&&a3(o,i)))return!1;{let o=getClosestBelowPosition(l,n,i);return moveCaret(e,t,o),!0}},move$1=(e,t,n)=>Optional.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind(o=>Optional.from(e.dom.getParent(o,"table")).map(a=>n(e,t,a,o))).getOr(!1),moveH=(e,t)=>move$1(e,t,navigateHorizontally),moveV=(e,t)=>move$1(e,t,navigateVertically),getCellFirstCursorPosition=e=>{let t=rK.exact(e,0,e,0);return toNative(t)},tabGo=(e,t,n)=>n.fold(Optional.none,Optional.none,(e,t)=>first(t).map(e=>getCellFirstCursorPosition(e)),n=>(e.execCommand("mceTableInsertRowAfter"),tabForward(e,t,n))),tabForward=(e,t,n)=>tabGo(e,t,next(n,isEditable$3)),tabBackward=(e,t,n)=>tabGo(e,t,prev(n,isEditable$3)),handleTab=(e,t)=>{let n=["table","li","dl"],o=eS.fromDom(e.getBody()),isRoot=e=>{let t=name(e);return eq(e,o)||contains$2(n,t)},a=e.selection.getRng(),i=eS.fromDom(t?a.endContainer:a.startContainer);return cell(i,isRoot).map(n=>{table(n,isRoot).each(t=>{e.model.table.clearSelectedCells(t.dom)}),e.selection.collapse(!t);let o=t?tabForward:tabBackward,a=o(e,isRoot,n);return a.each(t=>{e.selection.setRng(t)}),!0}).getOr(!1)},executeKeydownOverride$4=(e,t,n)=>{let o=ef.os.isMacOS()||ef.os.isiOS();execute([{keyCode:rx.RIGHT,action:action(moveH$2,e,!0)},{keyCode:rx.LEFT,action:action(moveH$2,e,!1)},{keyCode:rx.UP,action:action(moveV$4,e,!1)},{keyCode:rx.DOWN,action:action(moveV$4,e,!0)},...o?[{keyCode:rx.UP,action:action(selectToEndPoint,e,!1),metaKey:!0,shiftKey:!0},{keyCode:rx.DOWN,action:action(selectToEndPoint,e,!0),metaKey:!0,shiftKey:!0}]:[],{keyCode:rx.RIGHT,action:action(moveH,e,!0)},{keyCode:rx.LEFT,action:action(moveH,e,!1)},{keyCode:rx.UP,action:action(moveV,e,!1)},{keyCode:rx.DOWN,action:action(moveV,e,!0)},{keyCode:rx.UP,action:action(moveV,e,!1)},{keyCode:rx.UP,action:action(moveV$2,e,!1)},{keyCode:rx.DOWN,action:action(moveV$2,e,!0)},{keyCode:rx.RIGHT,action:action(moveH$1,e,!0)},{keyCode:rx.LEFT,action:action(moveH$1,e,!1)},{keyCode:rx.UP,action:action(moveV$1,e,!1)},{keyCode:rx.DOWN,action:action(moveV$1,e,!0)},{keyCode:rx.RIGHT,action:action(move$3,e,t,!0)},{keyCode:rx.LEFT,action:action(move$3,e,t,!1)},{keyCode:rx.RIGHT,ctrlKey:!o,altKey:o,action:action(aY,e,t)},{keyCode:rx.LEFT,ctrlKey:!o,altKey:o,action:action(aX,e,t)},{keyCode:rx.UP,action:action(moveV$3,e,!1)},{keyCode:rx.DOWN,action:action(moveV$3,e,!0)}],n).each(e=>{n.preventDefault()})},setup$k=(e,t)=>{e.on("keydown",n=>{n.isDefaultPrevented()||executeKeydownOverride$4(e,t,n)})},point=(e,t)=>({container:e,offset:t}),a5=DOMUtils.DOM,alwaysNext=e=>t=>e===t?-1:0,isBoundary=e=>t=>e.isBlock(t)||contains$2(["BR","IMG","HR","INPUT"],t.nodeName)||"false"===e.getContentEditable(t),textBefore=(e,t,n)=>{if(ew(e)&&t>=0)return Optional.some(point(e,t));{let o=TextSeeker(a5);return Optional.from(o.backwards(e,t,alwaysNext(e),n)).map(e=>point(e.container,e.container.data.length))}},textAfter=(e,t,n)=>{if(ew(e)&&t>=e.length)return Optional.some(point(e,t));{let o=TextSeeker(a5);return Optional.from(o.forwards(e,t,alwaysNext(e),n)).map(e=>point(e.container,0))}},scanLeft=(e,t,n)=>{if(!ew(e))return Optional.none();let o=e.data;if(t>=0&&t<=o.length)return Optional.some(point(e,t));{let o=TextSeeker(a5);return Optional.from(o.backwards(e,t,alwaysNext(e),n)).bind(e=>{let o=e.container.data;return scanLeft(e.container,t+o.length,n)})}},scanRight=(e,t,n)=>{if(!ew(e))return Optional.none();let o=e.data;if(t<=o.length)return Optional.some(point(e,t));{let a=TextSeeker(a5);return Optional.from(a.forwards(e,t,alwaysNext(e),n)).bind(e=>scanRight(e.container,t-o.length,n))}},repeatLeft=(e,t,n,o,a)=>{let i=TextSeeker(e,isBoundary(e));return Optional.from(i.backwards(t,n,o,a))},isValidTextRange=e=>e.collapsed&&ew(e.startContainer),getText=e=>trim$2(e.toString().replace(/\u00A0/g," ")),isWhitespace=e=>""!==e&&-1!==" \xa0\f\n\r	\v".indexOf(e),stripTrigger=(e,t)=>e.substring(t.length),findTrigger=(e,t,n)=>{let o;let a=n.charAt(0);for(o=t-1;o>=0;o--){let i=e.charAt(o);if(isWhitespace(i))return Optional.none();if(a===i&&contains$1(e,n,o,t))break}return Optional.some(o)},findStart=(e,t,n,o=0)=>{if(!isValidTextRange(t))return Optional.none();let a={text:"",offset:0},i=e.getParent(t.startContainer,e.isBlock)||e.getRoot();return repeatLeft(e,t.startContainer,t.startOffset,(e,t,o)=>(a.text=o+a.text,a.offset+=t,findTrigger(a.text,a.offset,n).getOr(t)),i).bind(e=>{let a=t.cloneRange();if(a.setStart(e.container,e.offset),a.setEnd(t.endContainer,t.endOffset),a.collapsed)return Optional.none();let i=getText(a),l=i.lastIndexOf(n);return 0!==l||stripTrigger(i,n).length<o?Optional.none():Optional.some({text:stripTrigger(i,n),range:a,trigger:n})})},getContext=(e,t,n,o=0)=>detect$1(eS.fromDom(t.startContainer)).fold(()=>findStart(e,t,n,o),t=>{let o=e.createRng();o.selectNode(t.dom);let a=getText(o);return Optional.some({range:o,text:stripTrigger(a,n),trigger:n})}),isText$1=e=>3===e.nodeType,isElement=e=>1===e.nodeType,toLast=e=>{if(isText$1(e))return point(e,e.data.length);{let t=e.childNodes;return t.length>0?toLast(t[t.length-1]):point(e,t.length)}},toLeaf=(e,t)=>{let n=e.childNodes;return n.length>0&&t<n.length?toLeaf(n[t],0):n.length>0&&isElement(e)&&n.length===t?toLast(n[n.length-1]):point(e,t)},isPreviousCharContent=(e,t)=>{var n;let o=null!==(n=e.getParent(t.container,e.isBlock))&&void 0!==n?n:e.getRoot();return repeatLeft(e,t.container,t.offset,(e,t)=>0===t?-1:t,o).filter(e=>{let t=e.container.data.charAt(e.offset-1);return!isWhitespace(t)}).isSome()},isStartOfWord=e=>t=>{let n=toLeaf(t.startContainer,t.startOffset);return!isPreviousCharContent(e,n)},getTriggerContext=(e,t,n)=>findMap(n.triggers,n=>getContext(e,t,n)),lookup=(e,t)=>{let n=t(),o=e.selection.getRng();return getTriggerContext(e.dom,o,n).bind(n=>lookupWithContext(e,t,n))},lookupWithContext=(e,t,n,o={})=>{var a;let i=t(),l=e.selection.getRng(),s=null!==(a=l.startContainer.nodeValue)&&void 0!==a?a:"",d=filter$5(i.lookupByTrigger(n.trigger),t=>n.text.length>=t.minChars&&t.matches.getOrThunk(()=>isStartOfWord(e.dom))(n.range,s,n.text));if(0===d.length)return Optional.none();let c=Promise.all(map$3(d,e=>{let t=e.fetch(n.text,e.maxResults,o);return t.then(t=>({matchText:n.text,items:t,columns:e.columns,onAction:e.onAction,highlightOn:e.highlightOn}))}));return Optional.some({lookupData:c,context:n})};(m=b||(b={}))[m.Error=0]="Error",m[m.Value=1]="Value";let fold$1=(e,t,n)=>e.stype===b.Error?t(e.serror):n(e.svalue),svalue=e=>({stype:b.Value,svalue:e}),serror=e=>({stype:b.Error,serror:e}),a4={fromResult:e=>e.fold(serror,svalue),toResult:e=>fold$1(e,tV.error,tV.value),svalue,partition:e=>{let t=[],n=[];return each$e(e,e=>{fold$1(e,e=>n.push(e),e=>t.push(e))}),{values:t,errors:n}},serror,bind:(e,t)=>e.stype===b.Value?t(e.svalue):e,bindError:(e,t)=>e.stype===b.Error?t(e.serror):e,map:(e,t)=>e.stype===b.Value?{stype:b.Value,svalue:t(e.svalue)}:e,mapError:(e,t)=>e.stype===b.Error?{stype:b.Error,serror:t(e.serror)}:e,fold:fold$1},formatObj=e=>$(e)&&F(e).length>100?" removed due to size":JSON.stringify(e,null,2),formatErrors=e=>{let t=e.length>10?e.slice(0,10).concat([{path:[],getErrorInfo:constant("... (only showing first ten failures)")}]):e;return map$3(t,e=>"Failed path: ("+e.path.join(" > ")+")\n"+e.getErrorInfo())},nu=(e,t)=>a4.serror([{path:e,getErrorInfo:t}]),missingRequired=(e,t,n)=>nu(e,()=>'Could not find valid *required* value for "'+t+'" in '+formatObj(n)),missingKey=(e,t)=>nu(e,()=>'Choice schema did not contain choice key: "'+t+'"'),missingBranch=(e,t,n)=>nu(e,()=>'The chosen schema: "'+n+'" did not exist in branches: '+formatObj(t)),custom=(e,t)=>nu(e,constant(t)),chooseFrom=(e,t,n,o)=>{let a=get$a(n,o);return a.fold(()=>missingBranch(e,n,o),n=>n.extract(e.concat(["branch: "+o]),t))},choose$1=(e,t)=>({extract:(n,o)=>{let a=get$a(o,e);return a.fold(()=>missingKey(n,e),e=>chooseFrom(n,o,t,e))},toString:()=>"chooseOn("+e+"). Possible values: "+F(t)}),baseMerge=e=>(...t)=>{if(0===t.length)throw Error("Can't merge zero objects");let n={};for(let o=0;o<t.length;o++){let a=t[o];for(let t in a)has$2(a,t)&&(n[t]=e(n[t],a[t]))}return n},a8=baseMerge((e,t)=>{let n=isPlainObject(e)&&isPlainObject(t);return n?a8(e,t):t}),a6=baseMerge((e,t)=>t),required=()=>({tag:"required",process:{}}),defaultedThunk=e=>({tag:"defaultedThunk",process:e}),defaulted$1=e=>defaultedThunk(constant(e)),asOption=()=>({tag:"option",process:{}}),mergeValues=(e,t)=>e.length>0?a4.svalue(a8(t,a6.apply(void 0,e))):a4.svalue(t),mergeErrors=e=>compose(a4.serror,flatten)(e),a9={consolidateObj:(e,t)=>{let n=a4.partition(e);return n.errors.length>0?mergeErrors(n.errors):mergeValues(n.values,t)},consolidateArr:e=>{let t=a4.partition(e);return t.errors.length>0?mergeErrors(t.errors):a4.svalue(t.values)}},fold=(e,t,n)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return n(e.newKey,e.instantiator)}},value=e=>{let t=constant("val");return{extract:(t,n)=>a4.bindError(e(n),e=>custom(t,e)),toString:t}},a7=value(a4.svalue),requiredAccess=(e,t,n,o)=>get$a(t,n).fold(()=>missingRequired(e,n,t),o),fallbackAccess=(e,t,n,o)=>{let a=get$a(e,t).getOrThunk(()=>n(e));return o(a)},optionAccess=(e,t,n)=>n(get$a(e,t)),optionDefaultedAccess=(e,t,n,o)=>{let a=get$a(e,t).map(t=>!0===t?n(e):t);return o(a)},extractField=(e,t,n,o,a)=>{let bundle=e=>a.extract(t.concat([o]),e),bundleAsOption=e=>e.fold(()=>a4.svalue(Optional.none()),e=>{let n=a.extract(t.concat([o]),e);return a4.map(n,Optional.some)});switch(e.tag){case"required":return requiredAccess(t,n,o,bundle);case"defaultedThunk":return fallbackAccess(n,o,e.process,bundle);case"option":return optionAccess(n,o,bundleAsOption);case"defaultedOptionThunk":return optionDefaultedAccess(n,o,e.process,bundleAsOption);case"mergeWithThunk":return fallbackAccess(n,o,constant({}),t=>{let o=a8(e.process(n),t);return bundle(o)})}},extractFields=(e,t,n)=>{let o={},a=[];for(let i of n)fold(i,(n,i,l,s)=>{let d=extractField(l,e,t,n,s);a4.fold(d,e=>{a.push(...e)},e=>{o[i]=e})},(e,n)=>{o[e]=n(t)});return a.length>0?a4.serror(a):a4.svalue(o)},objOf=e=>({extract:(t,n)=>extractFields(t,n,e),toString:()=>{let t=map$3(e,e=>fold(e,(e,t,n,o)=>e+" -> "+o.toString(),(e,t)=>"state("+e+")"));return"obj{\n"+t.join("\n")+"}"}}),arrOf=e=>({extract:(t,n)=>{let o=map$3(n,(n,o)=>e.extract(t.concat(["["+o+"]"]),n));return a9.consolidateArr(o)},toString:()=>"array("+e.toString()+")"}),valueOf=e=>value(t=>e(t).fold(a4.serror,a4.svalue)),extractValue=(e,t,n)=>{let o=t.extract([e],n);return a4.mapError(o,e=>({input:n,errors:e}))},asRaw=(e,t,n)=>a4.toResult(extractValue(e,t,n)),formatError=e=>"Errors: \n"+formatErrors(e.errors).join("\n")+"\n\nInput object: "+formatObj(e.input),choose=(e,t)=>choose$1(e,map$2(t,objOf)),ie=constant(a7),typedValue=(e,t)=>value(n=>{let o=typeof n;return e(n)?a4.svalue(n):a4.serror(`Expected type: ${t} but got: ${o}`)}),it=typedValue(x,"number"),ir=typedValue(k,"string"),io=typedValue(O,"boolean"),ia=typedValue(R,"function"),field=(e,t,n,o)=>({tag:"field",key:e,newKey:t,presence:n,prop:o}),customField=(e,t)=>({tag:"custom",newKey:e,instantiator:t}),validateEnum=e=>valueOf(t=>contains$2(e,t)?tV.value(t):tV.error(`Unsupported value: "${t}", choose one of "${e.join(", ")}".`)),requiredOf=(e,t)=>field(e,e,required(),t),requiredString=e=>requiredOf(e,ir),requiredFunction=e=>requiredOf(e,ia),optionOf=(e,t)=>field(e,e,asOption(),t),optionString=e=>optionOf(e,ir),defaultedOf=(e,t,n)=>field(e,e,defaulted$1(t),n),defaultedNumber=(e,t)=>defaultedOf(e,t,it),defaultedString=(e,t)=>defaultedOf(e,t,ir),defaultedStringEnum=(e,t,n)=>defaultedOf(e,t,validateEnum(n)),defaultedBoolean=(e,t)=>defaultedOf(e,t,io),defaultedFunction=(e,t)=>defaultedOf(e,t,ia),ii=requiredString("type"),il=requiredFunction("fetch"),id=requiredFunction("onAction"),ic=defaultedFunction("onSetup",()=>noop),im=optionString("text"),iu=optionString("icon"),ip=optionString("tooltip"),ig=optionString("label"),ih=defaultedBoolean("active",!1),ib=defaultedBoolean("enabled",!0),iC=defaultedBoolean("primary",!1),defaultedType=e=>defaultedString("type",e),iy=objOf([ii,requiredString("trigger"),defaultedNumber("minChars",1),field(l="columns",l,defaulted$1(1),ie()),defaultedNumber("maxResults",10),optionOf("matches",ia),il,id,defaultedOf("highlightOn",[],arrOf(ir))]),createAutocompleter=e=>asRaw("Autocompleter",iy,{trigger:e.ch,...e}),iv=[ib,ip,iu,im,ic],iE=[ih].concat(iv),ik=[defaultedFunction("predicate",w),defaultedStringEnum("scope","node",["node","editor"]),defaultedStringEnum("position","selection",["node","selection","line"])],i$=iv.concat([defaultedType("contextformbutton"),iC,id,customField("original",identity)]),iS=iE.concat([defaultedType("contextformbutton"),iC,id,customField("original",identity)]),iN=iv.concat([defaultedType("contextformbutton")]),iO=iE.concat([defaultedType("contextformtogglebutton")]),iP=choose("type",{contextformbutton:i$,contextformtogglebutton:iS});objOf([defaultedType("contextform"),defaultedFunction("initValue",constant("")),ig,field(u="commands",u,required(),arrOf(iP)),optionOf("launch",choose("type",{contextformbutton:iN,contextformtogglebutton:iO}))].concat(ik));let register$2=e=>{let t=e.ui.registry.getAll().popups,n=map$2(t,e=>createAutocompleter(e).fold(e=>{throw Error(formatError(e))},identity)),o=stringArray(mapToArray(n,e=>e.trigger)),a=values(n);return{dataset:n,triggers:o,lookupByTrigger:e=>filter$5(a,t=>t.trigger===e)}},setupEditorInput=(e,t)=>{let n=last$1(t.load,50);e.on("keypress compositionend",e=>{27!==e.which&&n.throttle()}),e.on("keydown",e=>{let o=e.which;8===o?n.throttle():27===o&&t.cancelIfNecessary()}),e.on("remove",n.cancel)},setup$j=e=>{let t=value$2(),n=Cell(!1),o=t.isSet,cancelIfNecessary=()=>{o()&&(removeAutocompleterDecoration(e),fireAutocompleterEnd(e),n.set(!1),t.clear())},commenceIfNecessary=n=>{o()||(addAutocompleterDecoration(e,n.range),t.set({trigger:n.trigger,matchLength:n.text.length}))},a=cached(()=>register$2(e)),doLookup=n=>t.get().map(t=>getContext(e.dom,e.selection.getRng(),t.trigger).bind(t=>lookupWithContext(e,a,t,n))).getOrThunk(()=>lookup(e,a)),load=o=>{doLookup(o).fold(cancelIfNecessary,o=>{commenceIfNecessary(o.context),o.lookupData.then(a=>{t.get().map(i=>{let l=o.context;i.trigger===l.trigger&&(l.text.length-i.matchLength>=10?cancelIfNecessary():(t.set({...i,matchLength:l.text.length}),n.get()?fireAutocompleterUpdate(e,{lookupData:a}):(n.set(!0),fireAutocompleterStart(e,{lookupData:a}))))})})})};e.addCommand("mceAutocompleterReload",(e,t)=>{let n=$(t)?t.fetchOptions:{};load(n)}),e.addCommand("mceAutocompleterClose",cancelIfNecessary),setupEditorInput(e,{cancelIfNecessary,load})},iR=detect$2().browser,ix=iR.isSafari(),emptyNodeContents=e=>fillWithPaddingBr(eS.fromDom(e)),isEntireNodeSelected=(e,t)=>{var n;return 0===e.startOffset&&e.endOffset===(null===(n=t.textContent)||void 0===n?void 0:n.length)},getParentDetailsElementAtPos=(e,t)=>Optional.from(e.getParent(t.container(),"details")),isInDetailsElement=(e,t)=>getParentDetailsElementAtPos(e,t).isSome(),getDetailsElements=(e,t)=>{let n=Optional.from(e.getParent(t.startContainer,"details")),o=Optional.from(e.getParent(t.endContainer,"details"));if(!(n.isSome()||o.isSome()))return Optional.none();{let t=n.bind(t=>Optional.from(e.select("summary",t)[0]));return Optional.some({startSummary:t,startDetails:n,endDetails:o})}},isCaretInTheBeginningOf=(e,t)=>r$(t).exists(t=>t.isEqual(e)),isCaretInTheEndOf=(e,t)=>rS(t).exists(n=>eF(n.getNode())&&rk(t,n).exists(t=>t.isEqual(e))||n.isEqual(e)),isCaretAtStartOfSummary=(e,t)=>t.startSummary.exists(t=>isCaretInTheBeginningOf(e,t)),isCaretAtEndOfSummary=(e,t)=>t.startSummary.exists(t=>isCaretInTheEndOf(e,t)),isCaretInFirstPositionInBody=(e,t)=>t.startDetails.exists(n=>rk(n,e).forall(n=>t.startSummary.exists(t=>!t.contains(e.container())&&t.contains(n.container())))),isCaretInLastPositionInBody=(e,t,n)=>n.startDetails.exists(n=>rE(e,t).forall(e=>!n.contains(e.container()))),setCaretToPosition=(e,t)=>{let n=t.getNode();P(n)||e.selection.setCursorLocation(n,t.offset())},moveCaretToDetailsPos=(e,t,n)=>{let o=e.dom.getParent(t.container(),"details");if(o&&!o.open){let t=e.dom.select("summary",o)[0];if(t){let o=n?r$(t):rS(t);o.each(t=>setCaretToPosition(e,t))}}else setCaretToPosition(e,t)},isPartialDelete=(e,t)=>{let n=t.startSummary.exists(t=>t.contains(e.startContainer)),o=t.startSummary.exists(t=>t.contains(e.endContainer)),a=t.startDetails.forall(e=>t.endDetails.forall(t=>e!==t));return(n||o)&&!(n&&o)||a},shouldPreventDeleteIntoDetails=(e,t,n)=>{let{dom:o,selection:a}=e,i=e.getBody();if("character"!==n)return!1;{let n=CaretPosition.fromRangeStart(a.getRng()),l=o.getParent(n.container(),o.isBlock),s=getParentDetailsElementAtPos(o,n),d=l&&o.isEmpty(l),c=N(null==l?void 0:l.previousSibling),m=N(null==l?void 0:l.nextSibling);if(d){let e=t?m:c;if(e){let e=navigate(!t,i,n).exists(e=>isInDetailsElement(o,e)&&!equals(s,getParentDetailsElementAtPos(o,e)));if(e)return!0}}return navigate(t,i,n).fold(w,n=>{let a=getParentDetailsElementAtPos(o,n);if(!isInDetailsElement(o,n)||equals(s,a))return!1;if(t||moveCaretToDetailsPos(e,n,!1),l&&d){if(t&&c||!t&&m)return!0;moveCaretToDetailsPos(e,n,t),e.dom.remove(l)}return!0})}},shouldPreventDeleteSummaryAction=(e,t,n,o)=>{let a=e.selection,i=a.getRng(),l=CaretPosition.fromRangeStart(i),s=e.getBody();return"selection"===o?isPartialDelete(i,t):n?isCaretAtEndOfSummary(l,t)||isCaretInLastPositionInBody(s,l,t):isCaretAtStartOfSummary(l,t)||isCaretInFirstPositionInBody(l,t)},shouldPreventDeleteAction=(e,t,n)=>getDetailsElements(e.dom,e.selection.getRng()).fold(()=>shouldPreventDeleteIntoDetails(e,t,n),o=>shouldPreventDeleteSummaryAction(e,o,t,n)||shouldPreventDeleteIntoDetails(e,t,n)),handleDeleteActionSafari=(e,t,n)=>{let o=e.selection,a=o.getNode(),i=o.getRng(),l=CaretPosition.fromRangeStart(i);return!!ej(a)&&("selection"===n&&isEntireNodeSelected(i,a)||willDeleteLastPositionInElement(t,l,a)?emptyNodeContents(a):e.undoManager.transact(()=>{let i=o.getSel(),{anchorNode:l,anchorOffset:s,focusNode:d,focusOffset:c}=null!=i?i:{},applySelection=()=>{isNonNullable(l)&&isNonNullable(s)&&isNonNullable(d)&&isNonNullable(c)&&(null==i||i.setBaseAndExtent(l,s,d,c))},appendAllChildNodes=(e,t)=>{each$e(e.childNodes,e=>{isNode(e)&&t.appendChild(e)})},m=e.dom.create("span",{"data-mce-bogus":"1"});appendAllChildNodes(a,m),a.appendChild(m),applySelection(),("word"===n||"line"===n)&&(null==i||i.modify("extend",t?"right":"left",n)),!o.isCollapsed()&&isEntireNodeSelected(o.getRng(),m)?emptyNodeContents(a):(e.execCommand(t?"ForwardDelete":"Delete"),l=null==i?void 0:i.anchorNode,s=null==i?void 0:i.anchorOffset,d=null==i?void 0:i.focusNode,c=null==i?void 0:i.focusOffset,appendAllChildNodes(m,a),applySelection()),e.dom.remove(m)}),!0)},backspaceDelete=(e,t,n)=>shouldPreventDeleteAction(e,t,n)||ix&&handleDeleteActionSafari(e,t,n)?Optional.some(noop):Optional.none(),createAndFireInputEvent=e=>(t,n,o={})=>{let a=t.getBody(),i={bubbles:!0,composed:!0,data:null,isComposing:!1,detail:0,view:null,target:a,currentTarget:a,eventPhase:Event.AT_TARGET,originalTarget:a,explicitOriginalTarget:a,isTrusted:!1,srcElement:a,cancelable:!1,preventDefault:noop,inputType:n},l=clone$3(new InputEvent(e));return t.dispatch(e,{...l,...i,...o})},iw=createAndFireInputEvent("input"),iA=createAndFireInputEvent("beforeinput"),iT=detect$2(),iB=iT.os,iD=iB.isMacOS()||iB.isiOS(),iI=iT.browser,iF=iI.isFirefox(),executeKeydownOverride$3=(e,t,n)=>{let o=n.keyCode===rx.BACKSPACE?"deleteContentBackward":"deleteContentForward",a=e.selection.isCollapsed(),i=a?"character":"selection",getModifiedGranularity=e=>a?e?"word":"line":"selection";executeWithDelayedAction([{keyCode:rx.BACKSPACE,action:action(backspaceDelete$1,e)},{keyCode:rx.BACKSPACE,action:action(backspaceDelete$6,e,!1)},{keyCode:rx.DELETE,action:action(backspaceDelete$6,e,!0)},{keyCode:rx.BACKSPACE,action:action(backspaceDelete$7,e,!1)},{keyCode:rx.DELETE,action:action(backspaceDelete$7,e,!0)},{keyCode:rx.BACKSPACE,action:action(backspaceDelete$4,e,t,!1)},{keyCode:rx.DELETE,action:action(backspaceDelete$4,e,t,!0)},{keyCode:rx.BACKSPACE,action:action(backspaceDelete$a,e,!1)},{keyCode:rx.DELETE,action:action(backspaceDelete$a,e,!0)},{keyCode:rx.BACKSPACE,action:action(backspaceDelete,e,!1,i)},{keyCode:rx.DELETE,action:action(backspaceDelete,e,!0,i)},...iD?[{keyCode:rx.BACKSPACE,altKey:!0,action:action(backspaceDelete,e,!1,getModifiedGranularity(!0))},{keyCode:rx.DELETE,altKey:!0,action:action(backspaceDelete,e,!0,getModifiedGranularity(!0))},{keyCode:rx.BACKSPACE,metaKey:!0,action:action(backspaceDelete,e,!1,getModifiedGranularity(!1))}]:[{keyCode:rx.BACKSPACE,ctrlKey:!0,action:action(backspaceDelete,e,!1,getModifiedGranularity(!0))},{keyCode:rx.DELETE,ctrlKey:!0,action:action(backspaceDelete,e,!0,getModifiedGranularity(!0))}],{keyCode:rx.BACKSPACE,action:action(backspaceDelete$5,e,!1)},{keyCode:rx.DELETE,action:action(backspaceDelete$5,e,!0)},{keyCode:rx.BACKSPACE,action:action(backspaceDelete$2,e,!1)},{keyCode:rx.DELETE,action:action(backspaceDelete$2,e,!0)},{keyCode:rx.BACKSPACE,action:action(backspaceDelete$8,e,!1)},{keyCode:rx.DELETE,action:action(backspaceDelete$8,e,!0)},{keyCode:rx.BACKSPACE,action:action(backspaceDelete$9,e,!1)},{keyCode:rx.DELETE,action:action(backspaceDelete$9,e,!0)},{keyCode:rx.BACKSPACE,action:action(backspaceDelete$3,e,!1)},{keyCode:rx.DELETE,action:action(backspaceDelete$3,e,!0)}],n).filter(t=>e.selection.isEditable()).each(t=>{n.preventDefault();let a=iA(e,o);a.isDefaultPrevented()||(t(),iw(e,o))})},executeKeyupOverride=(e,t,n)=>execute([{keyCode:rx.BACKSPACE,action:action(paddEmptyElement,e)},{keyCode:rx.DELETE,action:action(paddEmptyElement,e)},...iD?[{keyCode:rx.BACKSPACE,altKey:!0,action:action(refreshCaret,e)},{keyCode:rx.DELETE,altKey:!0,action:action(refreshCaret,e)},...n?[{keyCode:iF?224:91,action:action(refreshCaret,e)}]:[]]:[{keyCode:rx.BACKSPACE,ctrlKey:!0,action:action(refreshCaret,e)},{keyCode:rx.DELETE,ctrlKey:!0,action:action(refreshCaret,e)}]],t),setup$i=(e,t)=>{let n=!1;e.on("keydown",o=>{n=o.keyCode===rx.BACKSPACE,o.isDefaultPrevented()||executeKeydownOverride$3(e,t,o)}),e.on("keyup",t=>{t.isDefaultPrevented()||executeKeyupOverride(e,t,n),n=!1})},firstNonWhiteSpaceNodeSibling=e=>{for(;e;){if(eR(e)||ew(e)&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}return null},moveToCaretPosition=(e,t)=>{let n=e.dom,o=e.schema.getMoveCaretBeforeOnEnterElements();if(!t)return;if(/^(LI|DT|DD)$/.test(t.nodeName)){let e=firstNonWhiteSpaceNodeSibling(t.firstChild);e&&/^(UL|OL|DL)$/.test(e.nodeName)&&t.insertBefore(n.doc.createTextNode("\xa0"),t.firstChild)}let a=n.createRng();if(t.normalize(),t.hasChildNodes()){let e;let n=new DomTreeWalker(t,t),i=t;for(;e=n.current();){if(ew(e)){a.setStart(e,0),a.setEnd(e,0);break}if(o[e.nodeName.toLowerCase()]){a.setStartBefore(e),a.setEndBefore(e);break}i=e,e=n.next()}e||(a.setStart(i,0),a.setEnd(i,0))}else eF(t)?t.nextSibling&&n.isBlock(t.nextSibling)?(a.setStartBefore(t),a.setEndBefore(t)):(a.setStartAfter(t),a.setEndAfter(t)):(a.setStart(t,0),a.setEnd(t,0));e.selection.setRng(a),scrollRangeIntoView(e,a)},getEditableRoot=(e,t)=>{let n;let o=e.getRoot(),a=t;for(;a!==o&&a&&"false"!==e.getContentEditable(a);){if("true"===e.getContentEditable(a)){n=a;break}a=a.parentNode}return a!==o?n:o},getParentBlock$1=e=>Optional.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock)),getParentBlockName=e=>getParentBlock$1(e).fold(constant(""),e=>e.nodeName.toUpperCase()),isListItemParentBlock=e=>getParentBlock$1(e).filter(e=>eQ(eS.fromDom(e))).isSome(),emptyBlock=e=>{e.innerHTML='<br data-mce-bogus="1">'},applyAttributes=(e,t,n)=>{let o=e.dom;Optional.from(n.style).map(o.parseStyle).each(e=>{let n=getAllRaw(eS.fromDom(t)),a={...n,...e};o.setStyles(t,a)});let a=Optional.from(n.class).map(e=>e.split(/\s+/)),i=Optional.from(t.className).map(e=>filter$5(e.split(/\s+/),e=>""!==e));lift2(a,i,(e,n)=>{let a=filter$5(n,t=>!contains$2(e,t)),i=[...e,...a];o.setAttrib(t,"class",i.join(" "))});let l=["style","class"],s=filter$4(n,(e,t)=>!contains$2(l,t));o.setAttribs(t,s)},setForcedBlockAttrs=(e,t)=>{let n=t2(e);if(n.toLowerCase()===t.tagName.toLowerCase()){let n=t3(e);applyAttributes(e,t,n)}},createNewBlock=(e,t,n,o,a=!0,i)=>{let l;let s=e.dom,d=e.schema,c=t2(e),m=n?n.nodeName.toUpperCase():"",u=t,p=d.getTextInlineElements(),g=l=i||"TABLE"===m||"HR"===m?s.create(i||c):n.cloneNode(!1);if(a)do if(p[u.nodeName]){if(isCaretNode(u)||isBookmarkNode$1(u))continue;let e=u.cloneNode(!1);s.setAttrib(e,"id",""),l.hasChildNodes()?e.appendChild(l.firstChild):g=e,l.appendChild(e)}while((u=u.parentNode)&&u!==o);else s.setAttrib(l,"style",null),s.setAttrib(l,"class",null);return setForcedBlockAttrs(e,l),emptyBlock(g),l},getDetailsRoot=(e,t)=>e.dom.getParent(t,eV),isAtDetailsEdge=(e,t,n)=>{let o=t;for(;o&&o!==e&&N(o.nextSibling);){let e=o.parentElement;if(!e||!n(e))return eV(e);o=e}return!1},isLastEmptyBlockInDetails=(e,t,n)=>!t&&n.nodeName.toLowerCase()===t2(e)&&e.dom.isEmpty(n)&&isAtDetailsEdge(e.getBody(),n,t=>has$2(e.schema.getTextBlockElements(),t.nodeName.toLowerCase())),insertNewLine=(e,t,n)=>{var o,a,i;let l=t(t2(e)),s=getDetailsRoot(e,n);s&&(e.dom.insertAfter(l,s),moveToCaretPosition(e,l),(null!==(i=null===(a=null===(o=n.parentElement)||void 0===o?void 0:o.childNodes)||void 0===a?void 0:a.length)&&void 0!==i?i:0)>1&&e.dom.remove(n))},hasFirstChild=(e,t)=>e.firstChild&&e.firstChild.nodeName===t,isFirstChild=e=>{var t;return(null===(t=e.parentNode)||void 0===t?void 0:t.firstChild)===e},hasParent=(e,t)=>{let n=null==e?void 0:e.parentNode;return isNonNullable(n)&&n.nodeName===t},isListBlock=e=>isNonNullable(e)&&/^(OL|UL|LI)$/.test(e.nodeName),isListItem=e=>isNonNullable(e)&&/^(LI|DT|DD)$/.test(e.nodeName),isNestedList=e=>isListBlock(e)&&isListBlock(e.parentNode),getContainerBlock=e=>{let t=e.parentNode;return isListItem(t)?t:e},isFirstOrLastLi=(e,t,n)=>{let o=e[n?"firstChild":"lastChild"];for(;o&&!eR(o);)o=o[n?"nextSibling":"previousSibling"];return o===t},insert$4=(e,t,n,o,a)=>{let i=e.dom,l=e.selection.getRng(),s=n.parentNode;if(n===e.getBody()||!s)return;isNestedList(n)&&(a="LI");let d=t(a);if(isFirstOrLastLi(n,o,!0)&&isFirstOrLastLi(n,o,!1)){if(hasParent(n,"LI")){let e=getContainerBlock(n);i.insertAfter(d,e),isFirstChild(n)?i.remove(e):i.remove(n)}else i.replace(d,n)}else if(isFirstOrLastLi(n,o,!0))hasParent(n,"LI")?(i.insertAfter(d,getContainerBlock(n)),d.appendChild(i.doc.createTextNode(" ")),d.appendChild(n)):s.insertBefore(d,n),i.remove(o);else if(isFirstOrLastLi(n,o,!1))i.insertAfter(d,getContainerBlock(n)),i.remove(o);else{n=getContainerBlock(n);let e=l.cloneRange();e.setStartAfter(o),e.setEndAfter(n);let t=e.extractContents();"LI"===a&&hasFirstChild(t,"LI")?(d=t.firstChild,i.insertAfter(t,n)):(i.insertAfter(t,n),i.insertAfter(d,n)),i.remove(o)}moveToCaretPosition(e,d)},trimZwsp=e=>{each$e(descendants$1(eS.fromDom(e),eE),e=>{let t=e.dom;t.nodeValue=trim$2(t.data)})},isWithinNonEditableList=(e,t)=>{let n=e.dom.getParent(t,"ol,ul,dl");return null!==n&&"false"===e.dom.getContentEditableParent(n)},isEmptyAnchor=(e,t)=>t&&"A"===t.nodeName&&e.isEmpty(t),containerAndSiblingName=(e,t)=>e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t,canSplitBlock=(e,t)=>isNonNullable(t)&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&e.isEditable(t.parentNode)&&"false"!==e.getContentEditable(t),trimInlineElementsOnLeftSideOfBlock=(e,t,n)=>{var o;let a=[];if(!n)return;let i=n;for(;i=i.firstChild;){if(e.isBlock(i))return;eR(i)&&!t[i.nodeName.toLowerCase()]&&a.push(i)}let l=a.length;for(;l--;)(i=a[l]).hasChildNodes()&&(i.firstChild!==i.lastChild||(null===(o=i.firstChild)||void 0===o?void 0:o.nodeValue)!=="")?isEmptyAnchor(e,i)&&e.remove(i):e.remove(i)},normalizeZwspOffset=(e,t,n)=>ew(t)?e?1===n&&"\uFEFF"===t.data.charAt(n-1)?0:n:n===t.data.length-1&&"\uFEFF"===t.data.charAt(n)?t.data.length:n:n,includeZwspInRange=e=>{let t=e.cloneRange();return t.setStart(e.startContainer,normalizeZwspOffset(!0,e.startContainer,e.startOffset)),t.setEnd(e.endContainer,normalizeZwspOffset(!1,e.endContainer,e.endOffset)),t},trimLeadingLineBreaks=e=>{let t=e;do ew(t)&&(t.data=t.data.replace(/^[\r\n]+/,"")),t=t.firstChild;while(t)},wrapSelfAndSiblingsInDefaultBlock=(e,t,n,o,a)=>{var i,l;let s=e.dom,d=null!==(i=getEditableRoot(s,o))&&void 0!==i?i:s.getRoot(),c=s.getParent(o,s.isBlock);if(!c||!canSplitBlock(s,c)){let i;if(!(c=c||d).hasChildNodes()){let o=s.create(t);return setForcedBlockAttrs(e,o),c.appendChild(o),n.setStart(o,0),n.setEnd(o,0),o}let m=o;for(;m&&m.parentNode!==c;)m=m.parentNode;for(;m&&!s.isBlock(m);)i=m,m=m.previousSibling;let u=null===(l=null==i?void 0:i.parentElement)||void 0===l?void 0:l.nodeName;if(i&&u&&e.schema.isValidChild(u,t.toLowerCase())){let l=i.parentNode,d=s.create(t);for(setForcedBlockAttrs(e,d),l.insertBefore(d,i),m=i;m&&!s.isBlock(m);){let e=m.nextSibling;d.appendChild(m),m=e}n.setStart(o,a),n.setEnd(o,a)}}return o},addBrToBlockIfNeeded=(e,t)=>{t.normalize();let n=t.lastChild;(!n||eR(n)&&/^(left|right)$/gi.test(e.getStyle(n,"float",!0)))&&e.add(t,"br")},shouldEndContainer=(e,t)=>{let n=t9(e);return!isNullable(t)&&(k(n)?contains$2(eb.explode(n),t.nodeName.toLowerCase()):n)},i_={insert:(e,t)=>{let n,o,a,i,l;let s=!1,d=e.dom,c=e.schema,m=c.getNonEmptyElements(),u=e.selection.getRng(),p=t2(e),g=eS.fromDom(u.startContainer),f=child$1(g,u.startOffset),h=f.exists(e=>isHTMLElement(e)&&!isEditable$3(e)),b=u.collapsed&&h,createNewBlock$1=t=>createNewBlock(e,n,E,v,t6(e),t),isCaretAtStartOrEndOfBlock=e=>{let t;let a=normalizeZwspOffset(e,n,o);if(ew(n)&&(e?a>0:a<n.data.length))return!1;if(n.parentNode===E&&s&&!e||e&&eR(n)&&n===E.firstChild)return!0;if(containerAndSiblingName(n,"TABLE")||containerAndSiblingName(n,"HR"))return s&&!e||!s&&e;let i=new DomTreeWalker(n,E);for(ew(n)&&(e&&0===a?i.prev():e||a!==n.data.length||i.next());t=i.current();){if(eR(t)){if(!t.getAttribute("data-mce-bogus")){let e=t.nodeName.toLowerCase();if(m[e]&&"br"!==e)return!1}}else if(ew(t)&&!isWhitespaceText(t.data))return!1;e?i.prev():i.next()}return!0},insertNewBlockAfter=()=>{let t;return t=/^(H[1-6]|PRE|FIGURE)$/.test(a)&&"HGROUP"!==k?createNewBlock$1(p):createNewBlock$1(),shouldEndContainer(e,i)&&canSplitBlock(d,i)&&d.isEmpty(E,void 0,{includeZwsp:!0})?t=d.split(i,E):d.insertAfter(t,E),moveToCaretPosition(e,t),t};normalize$2(d,u).each(e=>{u.setStart(e.startContainer,e.startOffset),u.setEnd(e.endContainer,e.endOffset)}),n=u.startContainer,o=u.startOffset;let C=!!(t&&t.shiftKey),y=!!(t&&t.ctrlKey);eR(n)&&n.hasChildNodes()&&!b&&(s=o>n.childNodes.length-1,n=n.childNodes[Math.min(o,n.childNodes.length-1)]||n,o=s&&ew(n)?n.data.length:0);let v=getEditableRoot(d,n);if(!v||isWithinNonEditableList(e,n))return;C||(n=wrapSelfAndSiblingsInDefaultBlock(e,p,u,n,o));let E=d.getParent(n,d.isBlock)||d.getRoot();i=isNonNullable(null==E?void 0:E.parentNode)?d.getParent(E.parentNode,d.isBlock):null,a=E?E.nodeName.toUpperCase():"";let k=i?i.nodeName.toUpperCase():"";if("LI"===k&&!y){let e=i;E=e,i=e.parentNode,a=k}if(eR(i)&&isLastEmptyBlockInDetails(e,C,E))return insertNewLine(e,createNewBlock$1,E);if(/^(LI|DT|DD)$/.test(a)&&eR(i)&&d.isEmpty(E)){insert$4(e,createNewBlock$1,i,E,p);return}if(!b&&(E===e.getBody()||!canSplitBlock(d,E)))return;let $=E.parentNode;if(b)l=createNewBlock$1(p),f.fold(()=>{append$1(g,eS.fromDom(l))},e=>{before$3(e,eS.fromDom(l))}),e.selection.setCursorLocation(l,0);else if(isCaretContainerBlock$1(E))l=showCaretContainerBlock(E),d.isEmpty(E)&&emptyBlock(E),setForcedBlockAttrs(e,l),moveToCaretPosition(e,l);else if(isCaretAtStartOrEndOfBlock(!1))l=insertNewBlockAfter();else if(isCaretAtStartOrEndOfBlock(!0)&&$){l=$.insertBefore(createNewBlock$1(),E);let t=hasChildNodes(eS.fromDom(u.startContainer))&&u.collapsed;moveToCaretPosition(e,containerAndSiblingName(E,"HR")||t?l:E)}else{let t=includeZwspInRange(u).cloneRange();t.setEndAfter(E);let n=t.extractContents();trimZwsp(n),trimLeadingLineBreaks(n),l=n.firstChild,d.insertAfter(n,E),trimInlineElementsOnLeftSideOfBlock(d,m,l),addBrToBlockIfNeeded(d,E),d.isEmpty(E)&&emptyBlock(E),l.normalize(),d.isEmpty(l)?(d.remove(l),insertNewBlockAfter()):(setForcedBlockAttrs(e,l),moveToCaretPosition(e,l))}d.setAttrib(l,"id",""),e.dispatch("NewBlock",{newBlock:l})},fakeEventName:"insertParagraph"},hasRightSideContent=(e,t,n)=>{let o;let a=new DomTreeWalker(t,n),i=e.getNonEmptyElements();for(;o=a.next();)if(i[o.nodeName.toLowerCase()]||ew(o)&&o.length>0)return!0;return!1},moveSelectionToBr=(e,t,n)=>{let o=e.dom.createRng();n?(o.setStartBefore(t),o.setEndBefore(t)):(o.setStartAfter(t),o.setEndAfter(t)),e.selection.setRng(o),scrollRangeIntoView(e,o)},insertBrAtCaret=(e,t)=>{let n;let o=e.selection,a=e.dom,i=o.getRng(),l=!1;normalize$2(a,i).each(e=>{i.setStart(e.startContainer,e.startOffset),i.setEnd(e.endContainer,e.endOffset)});let s=i.startOffset,d=i.startContainer;if(eR(d)&&d.hasChildNodes()){let e=s>d.childNodes.length-1;d=d.childNodes[Math.min(s,d.childNodes.length-1)]||d,s=e&&ew(d)?d.data.length:0}let c=a.getParent(d,a.isBlock),m=c&&c.parentNode?a.getParent(c.parentNode,a.isBlock):null,u=m?m.nodeName.toUpperCase():"",p=!!(t&&t.ctrlKey);"LI"!==u||p||(c=m),ew(d)&&s>=d.data.length&&!hasRightSideContent(e.schema,d,c||a.getRoot())&&(n=a.create("br"),i.insertNode(n),i.setStartAfter(n),i.setEndAfter(n),l=!0),n=a.create("br"),rangeInsertNode(a,i,n),moveSelectionToBr(e,n,l),e.undoManager.add()},insertBrBefore=(e,t)=>{let n=eS.fromTag("br");before$3(eS.fromDom(t),n),e.undoManager.add()},insertBrAfter=(e,t)=>{hasBrAfter(e.getBody(),t)||after$4(eS.fromDom(t),eS.fromTag("br"));let n=eS.fromTag("br");after$4(eS.fromDom(t),n),moveSelectionToBr(e,n.dom,!1),e.undoManager.add()},isBeforeBr=e=>eF(e.getNode()),hasBrAfter=(e,t)=>!!isBeforeBr(CaretPosition.after(t))||rE(e,CaretPosition.after(t)).map(e=>eF(e.getNode())).getOr(!1),isAnchorLink=e=>e&&"A"===e.nodeName&&"href"in e,isInsideAnchor=e=>e.fold(w,isAnchorLink,isAnchorLink,w),readInlineAnchorLocation=e=>{let t=curry(isInlineTarget,e),n=CaretPosition.fromRangeStart(e.selection.getRng());return readLocation(t,e.getBody(),n).filter(isInsideAnchor)},insertBrOutsideAnchor=(e,t)=>{t.fold(noop,curry(insertBrBefore,e),curry(insertBrAfter,e),noop)},iL={insert:(e,t)=>{let n=readInlineAnchorLocation(e);n.isSome()?n.each(curry(insertBrOutsideAnchor,e)):insertBrAtCaret(e,t)},fakeEventName:"insertLineBreak"},matchesSelector=(e,t)=>getParentBlock$1(e).filter(e=>t.length>0&&is$1(eS.fromDom(e),t)).isSome(),shouldInsertBr=e=>matchesSelector(e,t4(e)),shouldBlockNewLine$1=e=>matchesSelector(e,t8(e)),iM=tq.generate([{br:[]},{block:[]},{none:[]}]),shouldBlockNewLine=(e,t)=>shouldBlockNewLine$1(e),inListBlock=e=>(t,n)=>isListItemParentBlock(t)===e,inBlock=(e,t)=>(n,o)=>{let a=getParentBlockName(n)===e.toUpperCase();return a===t},inCefBlock=e=>{let t=getEditableRoot(e.dom,e.selection.getStart());return isNullable(t)},inPreBlock=e=>inBlock("pre",e),inSummaryBlock=()=>inBlock("summary",!0),shouldPutBrInPre=e=>(t,n)=>t1(t)===e,inBrContext=(e,t)=>shouldInsertBr(e),hasShiftKey=(e,t)=>t,canInsertIntoEditableRoot=e=>{let t=t2(e),n=getEditableRoot(e.dom,e.selection.getStart());return isNonNullable(n)&&e.schema.isValidChild(n.nodeName,t)},isInRootWithEmptyOrCEF=e=>{let t=e.selection.getRng(),n=eS.fromDom(t.startContainer),o=child$1(n,t.startOffset),a=o.map(e=>isHTMLElement(e)&&!isEditable$3(e));return t.collapsed&&a.getOr(!0)},match=(e,t)=>(n,o)=>{let a=foldl(e,(e,t)=>e&&t(n,o),!0);return a?Optional.some(t):Optional.none()},getAction=(e,t)=>evaluateUntil([match([shouldBlockNewLine],iM.none()),match([inPreBlock(!0),inCefBlock],iM.none()),match([inSummaryBlock()],iM.br()),match([inPreBlock(!0),shouldPutBrInPre(!1),hasShiftKey],iM.br()),match([inPreBlock(!0),shouldPutBrInPre(!1)],iM.block()),match([inPreBlock(!0),shouldPutBrInPre(!0),hasShiftKey],iM.block()),match([inPreBlock(!0),shouldPutBrInPre(!0)],iM.br()),match([inListBlock(!0),hasShiftKey],iM.br()),match([inListBlock(!0)],iM.block()),match([inBrContext],iM.br()),match([hasShiftKey],iM.br()),match([canInsertIntoEditableRoot],iM.block()),match([isInRootWithEmptyOrCEF],iM.block())],[e,!!(t&&t.shiftKey)]).getOr(iM.none()),insertBreak=(e,t,n)=>{if(t.selection.isCollapsed()||execEditorDeleteCommand(t),isNonNullable(n)){let n=iA(t,e.fakeEventName);if(n.isDefaultPrevented())return}e.insert(t,n),isNonNullable(n)&&iw(t,e.fakeEventName)},insert$1=(e,t)=>{let br=()=>insertBreak(iL,e,t),block=()=>insertBreak(i_,e,t),n=getAction(e,t);switch(t5(e)){case"linebreak":n.fold(br,br,noop);break;case"block":n.fold(block,block,noop);break;case"invert":n.fold(block,br,noop);break;default:n.fold(br,block,noop)}},iU=detect$2(),iz=iU.os.isiOS()&&iU.browser.isSafari(),handleEnterKeyEvent=(e,t)=>{t.isDefaultPrevented()||(t.preventDefault(),endTypingLevelIgnoreLocks(e.undoManager),e.undoManager.transact(()=>{insert$1(e,t)}))},isCaretAfterKoreanCharacter=e=>{if(!e.collapsed)return!1;let t=e.startContainer;if(!ew(t))return!1;{let n=t.data.charAt(e.startOffset-1);return/^[\uAC00-\uD7AF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uD7B0-\uD7FF]$/.test(n)}},setup$h=e=>{let t=Optional.none(),iOSSafariKeydownOverride=e=>{t=Optional.some(e.selection.getBookmark()),e.undoManager.add()},iOSSafariKeyupOverride=(e,n)=>{e.undoManager.undo(),t.fold(noop,t=>e.selection.moveToBookmark(t)),handleEnterKeyEvent(e,n),t=Optional.none()};e.on("keydown",t=>{t.keyCode===rx.ENTER&&(iz&&isCaretAfterKoreanCharacter(e.selection.getRng())?iOSSafariKeydownOverride(e):handleEnterKeyEvent(e,t))}),e.on("keyup",n=>{n.keyCode===rx.ENTER&&t.each(()=>iOSSafariKeyupOverride(e,n))})},executeKeydownOverride$2=(e,t,n)=>{let o=ef.os.isMacOS()||ef.os.isiOS();execute([{keyCode:rx.END,action:action(moveToLineEndPoint$1,e,!0)},{keyCode:rx.HOME,action:action(moveToLineEndPoint$1,e,!1)},...o?[]:[{keyCode:rx.HOME,action:action(selectToEndPoint,e,!1),ctrlKey:!0,shiftKey:!0},{keyCode:rx.END,action:action(selectToEndPoint,e,!0),ctrlKey:!0,shiftKey:!0}],{keyCode:rx.END,action:action(moveToLineEndPoint,e,!0)},{keyCode:rx.HOME,action:action(moveToLineEndPoint,e,!1)},{keyCode:rx.END,action:action(moveToLineEndPoint$2,e,!0,t)},{keyCode:rx.HOME,action:action(moveToLineEndPoint$2,e,!1,t)}],n).each(e=>{n.preventDefault()})},setup$g=(e,t)=>{e.on("keydown",n=>{n.isDefaultPrevented()||executeKeydownOverride$2(e,t,n)})},setup$f=e=>{e.on("input",t=>{t.isComposing||normalizeNbspsInEditor(e)})},iW=detect$2(),executeKeyupAction=(e,t,n)=>{execute([{keyCode:rx.PAGE_UP,action:action(moveToLineEndPoint$2,e,!1,t)},{keyCode:rx.PAGE_DOWN,action:action(moveToLineEndPoint$2,e,!0,t)}],n)},stopImmediatePropagation=e=>e.stopImmediatePropagation(),isPageUpDown=e=>e.keyCode===rx.PAGE_UP||e.keyCode===rx.PAGE_DOWN,setNodeChangeBlocker=(e,t,n)=>{n&&!e.get()?t.on("NodeChange",stopImmediatePropagation,!0):!n&&e.get()&&t.off("NodeChange",stopImmediatePropagation),e.set(n)},setup$e=(e,t)=>{if(iW.os.isMacOS())return;let n=Cell(!1);e.on("keydown",t=>{isPageUpDown(t)&&setNodeChangeBlocker(n,e,!0)}),e.on("keyup",o=>{o.isDefaultPrevented()||executeKeyupAction(e,t,o),isPageUpDown(o)&&n.get()&&(setNodeChangeBlocker(n,e,!1),e.nodeChanged())})},insertTextAtPosition=(e,t)=>{let n=t.container(),o=t.offset();return ew(n)?(n.insertData(o,e),Optional.some(CaretPosition(n,o+e.length))):getElementFromPosition(t).map(n=>{let o=eS.fromText(e);return t.isAtEnd()?after$4(n,o):before$3(n,o),CaretPosition(o.dom,e.length)})},iH=curry(insertTextAtPosition,"\xa0"),iV=curry(insertTextAtPosition," "),insertSpaceOrNbspAtPosition=(e,t)=>needsToHaveNbsp(e,t)?iH(t):iV(t),locationToCaretPosition=e=>t=>t.fold(t=>rk(e.dom,CaretPosition.before(t)),e=>r$(e),e=>rS(e),t=>rE(e.dom,CaretPosition.after(t))),insertInlineBoundarySpaceOrNbsp=(e,t)=>n=>needsToHaveNbsp(e,n)?iH(t):iV(t),setSelection=e=>t=>{e.selection.setRng(t.toRange()),e.nodeChanged()},isInsideSummary=(e,t)=>e.isEditable(e.getParent(t,"summary")),insertSpaceOrNbspAtSelection=e=>{let t=CaretPosition.fromRangeStart(e.selection.getRng()),n=eS.fromDom(e.getBody());if(!e.selection.isCollapsed())return Optional.none();{let o=curry(isInlineTarget,e),a=CaretPosition.fromRangeStart(e.selection.getRng());return readLocation(o,e.getBody(),a).bind(locationToCaretPosition(n)).map(o=>()=>insertInlineBoundarySpaceOrNbsp(n,t)(o).each(setSelection(e)))}},insertSpaceInSummaryAtSelectionOnFirefox=e=>someIf(ef.browser.isFirefox()&&e.selection.isEditable()&&isInsideSummary(e.dom,e.selection.getRng().startContainer),()=>{let t=eS.fromDom(e.getBody());e.selection.isCollapsed()||e.getDoc().execCommand("Delete");let n=CaretPosition.fromRangeStart(e.selection.getRng());insertSpaceOrNbspAtPosition(t,n).each(setSelection(e))}),executeKeydownOverride$1=(e,t)=>{executeWithDelayedAction([{keyCode:rx.SPACEBAR,action:action(insertSpaceOrNbspAtSelection,e)},{keyCode:rx.SPACEBAR,action:action(insertSpaceInSummaryAtSelectionOnFirefox,e)}],t).each(n=>{t.preventDefault();let o=iA(e,"insertText",{data:" "});o.isDefaultPrevented()||(n(),iw(e,"insertText",{data:" "}))})},setup$d=e=>{e.on("keydown",t=>{t.isDefaultPrevented()||executeKeydownOverride$1(e,t)})},tableTabNavigation=e=>rf(e)?[{keyCode:rx.TAB,action:action(handleTab,e,!0)},{keyCode:rx.TAB,shiftKey:!0,action:action(handleTab,e,!1)}]:[],executeKeydownOverride=(e,t)=>{execute([...tableTabNavigation(e)],t).each(e=>{t.preventDefault()})},setup$c=e=>{e.on("keydown",t=>{t.isDefaultPrevented()||executeKeydownOverride(e,t)})},setup$b=e=>{if(e.addShortcut("Meta+P","","mcePrint"),setup$j(e),isRtc(e))return Cell(null);{let t=setupSelectedState(e);return setup$l(e),setup$k(e,t),setup$i(e,t),setup$h(e),setup$d(e),setup$f(e),setup$c(e),setup$g(e,t),setup$e(e,t),t}};let NodeChange=class NodeChange{constructor(e){let t;this.lastPath=[],this.editor=e;let n=this;"onselectionchange"in e.getDoc()||e.on("NodeChange click mouseup keyup focus",n=>{let o=e.selection.getRng(),a={startContainer:o.startContainer,startOffset:o.startOffset,endContainer:o.endContainer,endOffset:o.endOffset};"nodechange"!==n.type&&isEq$4(a,t)||e.dispatch("SelectionChange"),t=a}),e.on("contextmenu",()=>{e.dispatch("SelectionChange")}),e.on("SelectionChange",()=>{let t=e.selection.getStart(!0);t&&hasAnyRanges(e)&&!n.isSameElementPath(t)&&e.dom.isChildOf(t,e.getBody())&&e.nodeChanged({selectionChange:!0})}),e.on("mouseup",t=>{!t.isDefaultPrevented()&&hasAnyRanges(e)&&("IMG"===e.selection.getNode().nodeName?rZ.setEditorTimeout(e,()=>{e.nodeChanged()}):e.nodeChanged())})}nodeChanged(e={}){let t;let n=this.editor.selection;if(this.editor.initialized&&n&&!nz(this.editor)&&!this.editor.mode.isReadOnly()){let o=this.editor.getBody();(t=n.getStart(!0)||o).ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(t,o)||(t=o);let a=[];this.editor.dom.getParent(t,e=>e===o||(a.push(e),!1)),this.editor.dispatch("NodeChange",{...e,element:t,parents:a})}}isSameElementPath(e){let t;let n=this.editor,o=reverse(n.dom.getParents(e,A,n.getBody()));if(o.length===this.lastPath.length){for(t=o.length;t>=0&&o[t]===this.lastPath[t];t--);if(-1===t)return this.lastPath=o,!0}return this.lastPath=o,!1}};let iq=generate$1("image"),getDragImage=e=>Optional.from(e[iq]),setDragImage=(e,t)=>{e[iq]=t},ij=generate$1("event"),getEvent=e=>Optional.from(e[ij]),mkSetEventFn=e=>t=>{t[ij]=e},setEvent=(e,t)=>mkSetEventFn(t)(e),iK=mkSetEventFn(0),iG=mkSetEventFn(2),iY=mkSetEventFn(1),isInDragStartEvent=e=>Optional.from(e[ij]).exists(e=>0===e),createEmptyFileList=()=>Object.freeze({length:0,item:e=>null}),iX=generate$1("mode"),getMode=e=>Optional.from(e[iX]),mkSetModeFn=e=>t=>{t[iX]=e},setMode$1=(e,t)=>mkSetModeFn(t)(e),iZ=mkSetModeFn(0),iQ=mkSetModeFn(2),iJ=mkSetModeFn(1),checkMode=e=>t=>Optional.from(t[iX]).exists(t=>t===e),i0=checkMode(0),i1=checkMode(1),normalizeItems=(e,t)=>({...t,get length(){return t.length},add:(n,o)=>{if(i0(e)){if(!k(n))return t.add(n);if(!P(o))return t.add(n,o)}return null},remove:n=>{i0(e)&&t.remove(n)},clear:()=>{i0(e)&&t.clear()}}),i2=["none","copy","link","move"],i3=["none","copy","copyLink","copyMove","link","linkMove","move","all","uninitialized"],createDataTransfer=()=>{let e=new window.DataTransfer,t="move",n="all",o={get dropEffect(){return t},set dropEffect(effect){contains$2(i2,effect)&&(t=effect)},get effectAllowed(){return n},set effectAllowed(allowed){isInDragStartEvent(o)&&contains$2(i3,allowed)&&(n=allowed)},get items(){return normalizeItems(o,e.items)},get files(){if(i1(o))return createEmptyFileList();return e.files},get types(){return e.types},setDragImage:(t,n,a)=>{i0(o)&&(setDragImage(o,{image:t,x:n,y:a}),e.setDragImage(t,n,a))},getData:t=>i1(o)?"":e.getData(t),setData:(t,n)=>{i0(o)&&e.setData(t,n)},clearData:t=>{i0(o)&&e.clearData(t)}};return iZ(o),o},cloneDataTransfer=e=>{let t=createDataTransfer(),n=getMode(e);return iQ(e),iK(t),t.dropEffect=e.dropEffect,t.effectAllowed=e.effectAllowed,getDragImage(e).each(e=>t.setDragImage(e.image,e.x,e.y)),each$e(e.types,n=>{"Files"!==n&&t.setData(n,e.getData(n))}),each$e(e.files,e=>t.items.add(e)),getEvent(e).each(e=>{setEvent(t,e)}),n.each(n=>{setMode$1(e,n),setMode$1(t,n)}),t},getHtmlData=e=>{let t=e.getData("text/html");return""===t?Optional.none():Optional.some(t)},setHtmlData=(e,t)=>e.setData("text/html",t),i5="x-tinymce/html",i4=constant(i5),i8="<!-- "+i5+" -->",mark=e=>i8+e,unmark=e=>e.replace(i8,""),isMarked=e=>-1!==e.indexOf(i8),isPlainText=e=>!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(e),openContainer=(e,t)=>{let n="<"+e,o=mapToArray(t,(e,t)=>t+'="'+tu.encodeAllRaw(e)+'"');return o.length&&(n+=" "+o.join(" ")),n+">"},toBlockElements=(e,t,n)=>{let o=e.split(/\n\n/),a=openContainer(t,n),i="</"+t+">",l=map$3(o,e=>e.split(/\n/).join("<br />"));return 1===l.length?l[0]:map$3(l,e=>a+e+i).join("")},i6="%MCEPASTEBIN%",create$6=(e,t)=>{let{dom:n,selection:o}=e,a=e.getBody();t.set(o.getRng());let i=n.add(e.getBody(),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},i6);ef.browser.isFirefox()&&n.setStyle(i,"left","rtl"===n.getStyle(a,"direction",!0)?65535:-65535),n.bind(i,"beforedeactivate focusin focusout",e=>{e.stopPropagation()}),i.focus(),o.select(i,!0)},remove=(e,t)=>{let n=e.dom;if(getEl(e)){let o;let a=t.get();for(;o=getEl(e);)n.remove(o),n.unbind(o);a&&e.selection.setRng(a)}t.set(null)},getEl=e=>e.dom.get("mcepastebin"),isPasteBin=e=>isNonNullable(e)&&"mcepastebin"===e.id,getHtml=e=>{let t=e.dom,copyAndRemove=(e,n)=>{e.appendChild(n),t.remove(n,!0)},[n,...o]=filter$5(e.getBody().childNodes,isPasteBin);each$e(o,e=>{copyAndRemove(n,e)});let a=t.select("div[id=mcepastebin]",n);for(let e=a.length-1;e>=0;e--){let o=t.create("div");n.insertBefore(o,a[e]),copyAndRemove(o,a[e])}return n?n.innerHTML:""},isDefaultPasteBinContent=e=>e===i6,PasteBin=e=>{let t=Cell(null);return{create:()=>create$6(e,t),remove:()=>remove(e,t),getEl:()=>getEl(e),getHtml:()=>getHtml(e),getLastRng:t.get}},filter$1=(e,t)=>(eb.each(t,t=>{e=is$4(t,RegExp)?e.replace(t,""):e.replace(t[0],t[1])}),e),innerText=e=>{let t=Schema(),n=DomParser({},t),o="",a=t.getVoidElements(),i=eb.makeMap("script noscript style textarea video audio iframe object"," "),l=t.getBlockElements(),walk=e=>{let n=e.name;if("br"===n){o+="\n";return}if("wbr"!==n){if(a[n]&&(o+=" "),i[n]){o+=" ";return}if(3===e.type&&(o+=e.value),!(e.name in t.getVoidElements())){let t=e.firstChild;if(t)do walk(t);while(t=t.next)}l[n]&&e.next&&(o+="\n","p"===n&&(o+="\n"))}};return e=filter$1(e,[/<!\[[^\]]+\]>/g]),walk(n.parse(e)),o},trimHtml=e=>e=filter$1(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/ig,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,(e,t,n)=>t||n?"\xa0":" "],/<br class="Apple-interchange-newline">/g,/<br>$/i]),getImageMimeType=e=>{let t=e.toLowerCase(),n={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"};return eb.hasOwn(n,t)?"image/"+n[t]:"image/"+t},preProcess=(e,t)=>{let n=DomParser({sanitize:rp(e)},e.schema);n.addNodeFilter("meta",e=>{eb.each(e,e=>{e.remove()})});let o=n.parse(t,{forced_root_block:!1,isRootContent:!0});return HtmlSerializer({validate:!0},e.schema).serialize(o)},processResult=(e,t)=>({content:e,cancelled:t}),postProcessFilter=(e,t,n)=>{let o=e.dom.create("div",{style:"display:none"},t),a=firePastePostProcess(e,o,n);return processResult(a.node.innerHTML,a.isDefaultPrevented())},filterContent=(e,t,n)=>{let o=firePastePreProcess(e,t,n),a=preProcess(e,o.content);return e.hasEventListeners("PastePostProcess")&&!o.isDefaultPrevented()?postProcessFilter(e,a,n):processResult(a,o.isDefaultPrevented())},process=(e,t,n)=>filterContent(e,t,n),pasteHtml$1=(e,t)=>(e.insertContent(t,{merge:rt(e),paste:!0}),!0),isAbsoluteUrl=e=>/^https?:\/\/[\w\-\/+=.,!;:&%@^~(){}?#]+$/i.test(e),isImageUrl=(e,t)=>isAbsoluteUrl(t)&&exists(getAllowedImageFileTypes(e),e=>endsWith(t.toLowerCase(),`.${e.toLowerCase()}`)),createImage=(e,t,n)=>(e.undoManager.extra(()=>{n(e,t)},()=>{e.insertContent('<img src="'+t+'">')}),!0),createLink=(e,t,n)=>(e.undoManager.extra(()=>{n(e,t)},()=>{e.execCommand("mceInsertLink",!1,t)}),!0),linkSelection=(e,t,n)=>!!(!e.selection.isCollapsed()&&isAbsoluteUrl(t))&&createLink(e,t,n),insertImage=(e,t,n)=>!!isImageUrl(e,t)&&createImage(e,t,n),smartInsertContent=(e,t)=>{eb.each([linkSelection,insertImage,pasteHtml$1],n=>!n(e,t,pasteHtml$1))},insertContent=(e,t,n)=>{n||!rn(e)?pasteHtml$1(e,t):smartInsertContent(e,t)},i9=(a=0,()=>"mceclip"+a++),createPasteDataTransfer=e=>{let t=createDataTransfer();return setHtmlData(t,e),iQ(t),t},doPaste=(e,t,n,o,a)=>{let i=process(e,t,n);if(!i.cancelled){let t=i.content,doPasteAction=()=>insertContent(e,t,o);if(a){let n=iA(e,"insertFromPaste",{dataTransfer:createPasteDataTransfer(t)});n.isDefaultPrevented()||(doPasteAction(),iw(e,"insertFromPaste"))}else doPasteAction()}},pasteHtml=(e,t,n,o)=>{let a=n||isMarked(t);doPaste(e,unmark(t),a,!1,o)},pasteText=(e,t,n)=>{let o=e.dom.encode(t).replace(/\r\n/g,"\n"),a=normalize$4(o,ro(e)),i=toBlockElements(a,t2(e),t3(e));doPaste(e,i,!1,!0,n)},getDataTransferItems=e=>{let t={};if(e&&e.types)for(let n=0;n<e.types.length;n++){let o=e.types[n];try{t[o]=e.getData(o)}catch(e){t[o]=""}}return t},hasContentType=(e,t)=>t in e&&e[t].length>0,hasHtmlOrText=e=>hasContentType(e,"text/html")||hasContentType(e,"text/plain"),extractFilename=(e,t)=>{let n=t.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return isNonNullable(n)?e.dom.encode(n[1]):void 0},createBlobInfo=(e,t,n,o)=>{let a=i9(),i=ne(e)&&isNonNullable(n.name),l=i?extractFilename(e,n.name):a,s=i?n.name:void 0,d=t.create(a,n,o,l,s);return t.add(d),d},pasteImage=(e,t)=>{parseDataUri(t.uri).each(({data:n,type:o,base64Encoded:a})=>{let i=a?n:btoa(n),l=t.file,s=e.editorUpload.blobCache,d=s.getByData(i,o),c=null!=d?d:createBlobInfo(e,s,l,i);pasteHtml(e,`<img src="${c.blobUri()}">`,!1,!0)})},isClipboardEvent=e=>"paste"===e.type,readFilesAsDataUris=e=>Promise.all(map$3(e,e=>blobToDataUri(e).then(t=>({file:e,uri:t})))),isImage=e=>{let t=getAllowedImageFileTypes(e);return e=>startsWith(e.type,"image/")&&exists(t,t=>getImageMimeType(t)===e.type)},getImagesFromDataTransfer=(e,t)=>{let n=t.items?bind$3(I(t.items),e=>"file"===e.kind?[e.getAsFile()]:[]):[],o=t.files?I(t.files):[];return filter$5(n.length>0?n:o,isImage(e))},pasteImageData=(e,t,n)=>{let o=isClipboardEvent(t)?t.clipboardData:t.dataTransfer;if(n4(e)&&o){let a=getImagesFromDataTransfer(e,o);if(a.length>0)return t.preventDefault(),readFilesAsDataUris(a).then(t=>{n&&e.selection.setRng(n),each$e(t,t=>{pasteImage(e,t)})}),!0}return!1},isBrokenAndroidClipboardEvent=e=>{var t,n;return ef.os.isAndroid()&&(null===(n=null===(t=e.clipboardData)||void 0===t?void 0:t.items)||void 0===n?void 0:n.length)===0},isKeyboardPasteEvent=e=>rx.metaKeyPressed(e)&&86===e.keyCode||e.shiftKey&&45===e.keyCode,insertClipboardContent=(e,t,n,o,a)=>{let i=trimHtml(n),l=hasContentType(t,i4())||isMarked(n),s=!l&&isPlainText(i),d=isAbsoluteUrl(i);(isDefaultPasteBinContent(i)||!i.length||s&&!d)&&(o=!0),(o||d)&&(i=hasContentType(t,"text/plain")&&s?t["text/plain"]:innerText(i)),isDefaultPasteBinContent(i)||(o?pasteText(e,i,a):pasteHtml(e,i,l,a))},registerEventHandlers=(e,t,n)=>{let o;let getLastRng=()=>t.getLastRng()||e.selection.getRng();e.on("keydown",e=>{isKeyboardPasteEvent(e)&&!e.isDefaultPrevented()&&(o=e.shiftKey&&86===e.keyCode)}),e.on("paste",a=>{if(a.isDefaultPrevented()||isBrokenAndroidClipboardEvent(a))return;let i="text"===n.get()||o;o=!1;let l=getDataTransferItems(a.clipboardData);!hasHtmlOrText(l)&&pasteImageData(e,a,getLastRng())||(hasContentType(l,"text/html")?(a.preventDefault(),insertClipboardContent(e,l,l["text/html"],i,!0)):hasContentType(l,"text/plain")&&hasContentType(l,"text/uri-list")?(a.preventDefault(),insertClipboardContent(e,l,l["text/plain"],i,!0)):(t.create(),rZ.setEditorTimeout(e,()=>{let n=t.getHtml();t.remove(),insertClipboardContent(e,l,n,i,!1)},0)))})},registerDataImageFilter=e=>{let isWebKitFakeUrl=e=>startsWith(e,"webkit-fake-url"),isDataUri=e=>startsWith(e,"data:"),isPasteInsert=e=>{var t;return(null===(t=e.data)||void 0===t?void 0:t.paste)===!0};e.parser.addNodeFilter("img",(t,n,o)=>{if(!n4(e)&&isPasteInsert(o))for(let n of t){let t=n.attr("src");k(t)&&!n.attr("data-mce-object")&&t!==ef.transparentSrc&&(isWebKitFakeUrl(t)?n.remove():!ra(e)&&isDataUri(t)&&n.remove())}})},registerEventsAndFilters=(e,t,n)=>{registerEventHandlers(e,t,n),registerDataImageFilter(e)},togglePlainTextPaste=(e,t)=>{"text"===t.get()?(t.set("html"),firePastePlainTextToggle(e,!1)):(t.set("text"),firePastePlainTextToggle(e,!0)),e.focus()},register$1=(e,t)=>{e.addCommand("mceTogglePlainTextPaste",()=>{togglePlainTextPaste(e,t)}),e.addCommand("mceInsertClipboardContent",(t,n)=>{n.html&&pasteHtml(e,n.html,n.internal,!1),n.text&&pasteText(e,n.text,!1)})},setHtml5Clipboard=(e,t,n)=>{if(!e)return!1;try{return e.clearData(),e.setData("text/html",t),e.setData("text/plain",n),e.setData(i4(),t),!0}catch(e){return!1}},setClipboardData=(e,t,n,o)=>{setHtml5Clipboard(e.clipboardData,t.html,t.text)?(e.preventDefault(),o()):n(t.html,o)},fallback=e=>(t,n)=>{let{dom:o,selection:a}=e,i=o.create("div",{contenteditable:"false","data-mce-bogus":"all"}),l=o.create("div",{contenteditable:"true"},t);o.setStyles(i,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),i.appendChild(l),o.add(e.getBody(),i);let s=a.getRng();l.focus();let d=o.createRng();d.selectNodeContents(l),a.setRng(d),rZ.setEditorTimeout(e,()=>{a.setRng(s),o.remove(i),n()},0)},getData=e=>({html:mark(e.selection.getContent({contextual:!0})),text:e.selection.getContent({format:"text"})}),isTableSelection=e=>!!e.dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody()),hasSelectedContent=e=>!e.selection.isCollapsed()||isTableSelection(e),cut=e=>t=>{!t.isDefaultPrevented()&&hasSelectedContent(e)&&setClipboardData(t,getData(e),fallback(e),()=>{if(ef.browser.isChromium()||ef.browser.isFirefox()){let t=e.selection.getRng();rZ.setEditorTimeout(e,()=>{e.selection.setRng(t),e.execCommand("Delete")},0)}else e.execCommand("Delete")})},copy=e=>t=>{!t.isDefaultPrevented()&&hasSelectedContent(e)&&setClipboardData(t,getData(e),fallback(e),noop)},register=e=>{e.on("cut",cut(e)),e.on("copy",copy(e))},getCaretRangeFromEvent=(e,t)=>{var n,o;return RangeUtils.getCaretRangeFromPoint(null!==(n=t.clientX)&&void 0!==n?n:0,null!==(o=t.clientY)&&void 0!==o?o:0,e.getDoc())},isPlainTextFileUrl=e=>{let t=e["text/plain"];return!!t&&0===t.indexOf("file://")},setFocusedRange=(e,t)=>{e.focus(),t&&e.selection.setRng(t)},hasImage=e=>exists(e.files,e=>/^image\//.test(e.type)),needsCustomInternalDrop=(e,t,n,o)=>{let a=e.getParent(n,e=>isTransparentBlock(t,e)),i=!N(e.getParent(n,"summary"));if(i)return!0;if(!(a&&has$2(o,"text/html")))return!1;{let e=new DOMParser().parseFromString(o["text/html"],"text/html").body;return!N(e.querySelector(a.nodeName.toLowerCase()))}},setupSummaryDeleteByDragFix=e=>{e.on("input",t=>{if("deleteByDrag"===t.inputType){let t=filter$5(e.dom.select("details"),e=>N(e.querySelector("summary")));each$e(t,t=>{eF(t.firstChild)&&t.firstChild.remove();let n=e.dom.create("summary");n.appendChild(createPaddingBr().dom),t.prepend(n)})}})},setup$a=(e,t)=>{n5(e)&&e.on("dragend dragover draggesture dragdrop drop drag",e=>{e.preventDefault(),e.stopPropagation()}),n4(e)||e.on("drop",e=>{let t=e.dataTransfer;t&&hasImage(t)&&e.preventDefault()}),e.on("drop",n=>{if(n.isDefaultPrevented())return;let o=getCaretRangeFromEvent(e,n);if(isNullable(o))return;let a=getDataTransferItems(n.dataTransfer),i=hasContentType(a,i4());if((!hasHtmlOrText(a)||isPlainTextFileUrl(a))&&pasteImageData(e,n,o))return;let l=a[i4()],s=l||a["text/html"]||a["text/plain"],d=needsCustomInternalDrop(e.dom,e.schema,o.startContainer,a),c=t.get();(!c||d)&&s&&(n.preventDefault(),rZ.setEditorTimeout(e,()=>{e.undoManager.transact(()=>{(l||c&&d)&&e.execCommand("Delete"),setFocusedRange(e,o);let t=trimHtml(s);a["text/html"]?pasteHtml(e,t,i,!0):pasteText(e,t,!0)})}))}),e.on("dragstart",e=>{t.set(!0)}),e.on("dragover dragend",n=>{n4(e)&&!t.get()&&(n.preventDefault(),setFocusedRange(e,getCaretRangeFromEvent(e,n))),"dragend"===n.type&&t.set(!1)}),setupSummaryDeleteByDragFix(e)},setup$9=e=>{let processEvent=t=>n=>{t(e,n)},t=n8(e);R(t)&&e.on("PastePreProcess",processEvent(t));let n=n6(e);R(n)&&e.on("PastePostProcess",processEvent(n))},addPreProcessFilter=(e,t)=>{e.on("PastePreProcess",n=>{n.content=t(e,n.content,n.internal)})},i7=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,rgbToHex=e=>eb.trim(e).replace(i7,rgbaToHexString).toLowerCase(),removeWebKitStyles=(e,t,n)=>{let o=n7(e);if(n||"all"===o||!re(e))return t;let a=o?o.split(/[, ]/):[];if(a&&"none"!==o){let n=e.dom,o=e.selection.getNode();t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(e,t,i,l)=>{let s=n.parseStyle(n.decode(i)),d={};for(let e=0;e<a.length;e++){let t=s[a[e]],i=t,l=n.getStyle(o,a[e],!0);/color/.test(a[e])&&(i=rgbToHex(i),l=rgbToHex(l)),l!==i&&(d[a[e]]=t)}let c=n.serializeStyle(d,"span");return c?t+' style="'+c+'"'+l:t+l})}else t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return t=t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(e,t,n,o)=>t+' style="'+n+'"'+o)},setup$8=e=>{(ef.browser.isChromium()||ef.browser.isSafari())&&addPreProcessFilter(e,removeWebKitStyles)},setup$7=e=>{let t=Cell(!1),n=Cell(rr(e)?"text":"html"),o=PasteBin(e);setup$8(e),register$1(e,n),setup$9(e),e.on("PreInit",()=>{register(e),setup$a(e,t),registerEventsAndFilters(e,o,n)})},preventSummaryToggle=e=>{e.on("click",t=>{e.dom.getParent(t.target,"details")&&t.preventDefault()})},filterDetails=e=>{e.parser.addNodeFilter("details",t=>{let n=rh(e);each$e(t,e=>{"expanded"===n?e.attr("open","open"):"collapsed"===n&&e.attr("open",null)})}),e.serializer.addNodeFilter("details",t=>{let n=rb(e);each$e(t,e=>{"expanded"===n?e.attr("open","open"):"collapsed"===n&&e.attr("open",null)})})},setup$6=e=>{preventSummaryToggle(e),filterDetails(e)},isContentEditableFalse$2=e=>eM(e.dom),isContentEditableTrue=e=>eL(e.dom),isRoot=e=>t=>eq(eS.fromDom(e),t),getClosestScope=(e,t)=>closest$4(eS.fromDom(e),e=>isContentEditableTrue(e)||eY(e),isRoot(t)).getOr(eS.fromDom(t)).dom,getClosestCef=(e,t)=>closest$4(eS.fromDom(e),isContentEditableFalse$2,isRoot(t)),findEdgeCaretCandidate=(e,t,n)=>{let o=new DomTreeWalker(e,t),a=n?o.next.bind(o):o.prev.bind(o),i=e;for(let t=n?e:a();t&&!eF(t);t=a())isCaretCandidate$3(t)&&(i=t);return i},findClosestBlockRange=(e,t)=>{let n=CaretPosition.fromRangeStart(e),o=n.getNode(),a=getClosestScope(o,t),i=findEdgeCaretCandidate(o,a,!1),l=findEdgeCaretCandidate(o,a,!0),s=document.createRange();return getClosestCef(i,a).fold(()=>{ew(i)?s.setStart(i,0):s.setStartBefore(i)},e=>s.setStartBefore(e.dom)),getClosestCef(l,a).fold(()=>{ew(l)?s.setEnd(l,l.data.length):s.setEndAfter(l)},e=>s.setEndAfter(e.dom)),s},onTripleClickSelect=e=>{let t=findClosestBlockRange(e.selection.getRng(),e.getBody());e.selection.setRng(normalize(t))},setup$5=e=>{e.on("mousedown",t=>{t.detail>=3&&(t.preventDefault(),onTripleClickSelect(e))})};(p=C||(C={})).Before="before",p.After="after";let distanceToRectLeft=(e,t)=>Math.abs(e.left-t),distanceToRectRight=(e,t)=>Math.abs(e.right-t),isInsideY=(e,t)=>e>=t.top&&e<=t.bottom,collidesY=(e,t)=>e.top<t.bottom&&e.bottom>t.top,isOverlapping=(e,t)=>{let n=overlapY(e,t)/Math.min(e.height,t.height);return collidesY(e,t)&&n>.5},splitRectsPerAxis=(e,t)=>{let n=filter$5(e,e=>isInsideY(t,e));return boundingClientRectFromRects(n).fold(()=>[[],e],t=>{let{pass:n,fail:o}=partition$2(e,e=>isOverlapping(e,t));return[n,o]})},clientInfo=(e,t)=>({node:e.node,position:distanceToRectLeft(e,t)<distanceToRectRight(e,t)?C.Before:C.After}),horizontalDistance=(e,t,n)=>t>e.left&&t<e.right?0:Math.min(Math.abs(e.left-t),Math.abs(e.right-t)),closestChildCaretCandidateNodeRect=(e,t,n)=>{let caretCandidateRect=e=>isCaretCandidate$3(e.node)?Optional.some(e):eR(e.node)?closestChildCaretCandidateNodeRect(I(e.node.childNodes),t,n):Optional.none(),getClosestTextNode=(e,o)=>{if(e.length>=2){let a=caretCandidateRect(e[0]).getOr(e[0]),i=caretCandidateRect(e[1]).getOr(e[1]),l=Math.abs(o(a,t,n)-o(i,t,n));if(l<2){if(ew(a.node))return Optional.some(a);if(ew(i.node))return Optional.some(i)}}return Optional.none()},findClosestCaretCandidateNodeRect=(e,o)=>{let a=sort(e,(e,a)=>o(e,t,n)-o(a,t,n));return getClosestTextNode(a,o).orThunk(()=>findMap(a,caretCandidateRect))},[o,a]=splitRectsPerAxis(getClientRects(e),n),{pass:i,fail:l}=partition$2(a,e=>e.top<n);return findClosestCaretCandidateNodeRect(o,horizontalDistance).orThunk(()=>findClosestCaretCandidateNodeRect(l,distanceToRectEdgeFromXY)).orThunk(()=>findClosestCaretCandidateNodeRect(i,distanceToRectEdgeFromXY))},traverseUp=(e,t,n,o)=>{let helper=(t,a)=>{let i=filter$5(t.dom.childNodes,not(e=>eR(e)&&e.classList.contains("mce-drag-container")));return a.fold(()=>closestChildCaretCandidateNodeRect(i,n,o),e=>{let t=filter$5(i,t=>t!==e.dom);return closestChildCaretCandidateNodeRect(t,n,o)}).orThunk(()=>{let n=eq(t,e)?Optional.none():parentElement(t);return n.bind(e=>helper(e,Optional.some(t)))})};return helper(t,Optional.none())},closestCaretCandidateNodeRect=(e,t,n)=>{let o=eS.fromDom(e),a=documentOrOwner(o),i=eS.fromPoint(a,t,n).filter(e=>contains(o,e)),l=i.getOr(o);return traverseUp(o,l,t,n)},closestFakeCaretCandidate=(e,t,n)=>closestCaretCandidateNodeRect(e,t,n).filter(e=>isFakeCaretTarget(e.node)).map(e=>clientInfo(e,t)),getAbsolutePosition=e=>{var t,n;let o=e.getBoundingClientRect(),a=e.ownerDocument,i=a.documentElement,l=a.defaultView;return{top:o.top+(null!==(t=null==l?void 0:l.scrollY)&&void 0!==t?t:0)-i.clientTop,left:o.left+(null!==(n=null==l?void 0:l.scrollX)&&void 0!==n?n:0)-i.clientLeft}},getBodyPosition=e=>e.inline?getAbsolutePosition(e.getBody()):{left:0,top:0},getScrollPosition=e=>{let t=e.getBody();return e.inline?{left:t.scrollLeft,top:t.scrollTop}:{left:0,top:0}},getBodyScroll=e=>{let t=e.getBody(),n=e.getDoc().documentElement,o={left:t.scrollLeft,top:t.scrollTop},a={left:t.scrollLeft||n.scrollLeft,top:t.scrollTop||n.scrollTop};return e.inline?o:a},getMousePosition=(e,t)=>{if(t.target.ownerDocument!==e.getDoc()){let n=getAbsolutePosition(e.getContentAreaContainer()),o=getBodyScroll(e);return{left:t.pageX-n.left+o.left,top:t.pageY-n.top+o.top}}return{left:t.pageX,top:t.pageY}},calculatePosition=(e,t,n)=>({pageX:n.left-e.left+t.left,pageY:n.top-e.top+t.top}),calc=(e,t)=>calculatePosition(getBodyPosition(e),getScrollPosition(e),getMousePosition(e,t)),getTargetProps=e=>({target:e,srcElement:e}),makeDndEventFromMouseEvent=(e,t,n,o)=>({...t,dataTransfer:o,type:e,...getTargetProps(n)}),makeDndEvent=(e,t,n)=>{let o=die("Function not supported on simulated event."),a={bubbles:!0,cancelBubble:!1,cancelable:!0,composed:!1,currentTarget:null,defaultPrevented:!1,eventPhase:0,isTrusted:!0,returnValue:!1,timeStamp:0,type:e,composedPath:o,initEvent:o,preventDefault:noop,stopImmediatePropagation:noop,stopPropagation:noop,AT_TARGET:window.Event.AT_TARGET,BUBBLING_PHASE:window.Event.BUBBLING_PHASE,CAPTURING_PHASE:window.Event.CAPTURING_PHASE,NONE:window.Event.NONE,altKey:!1,button:0,buttons:0,clientX:0,clientY:0,ctrlKey:!1,metaKey:!1,movementX:0,movementY:0,offsetX:0,offsetY:0,pageX:0,pageY:0,relatedTarget:null,screenX:0,screenY:0,shiftKey:!1,x:0,y:0,detail:0,view:null,which:0,initUIEvent:o,initMouseEvent:o,getModifierState:o,dataTransfer:n,...getTargetProps(t)};return a},makeDataTransferCopyForDragEvent=(e,t)=>{let n=cloneDataTransfer(e);return"dragstart"===t?(iK(n),iZ(n)):"drop"===t?(iG(n),iQ(n)):(iY(n),iJ(n)),n},makeDragEvent=(e,t,n,o)=>{let a=makeDataTransferCopyForDragEvent(n,e);return P(o)?makeDndEvent(e,t,a):makeDndEventFromMouseEvent(e,o,t,a)},le=((...e)=>t=>{for(let n=0;n<e.length;n++)if(e[n](t))return!0;return!1})(eM,eL),isDraggable=(e,t,n)=>eM(n)&&n!==t&&e.isEditable(n.parentElement),isValidDropTarget=(e,t,n)=>!isNullable(t)&&!(t===n||e.dom.isChildOf(t,n))&&e.dom.isEditable(t),createGhost=(e,t,n,o)=>{let a=e.dom,i=t.cloneNode(!0);a.setStyles(i,{width:n,height:o}),a.setAttrib(i,"data-mce-selected",null);let l=a.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return a.setStyles(l,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:o}),a.setStyles(i,{margin:0,boxSizing:"border-box"}),l.appendChild(i),l},appendGhostToBody=(e,t)=>{e.parentNode!==t&&t.appendChild(e)},scrollEditor=(e,t)=>n=>()=>{let o="left"===e?n.scrollX:n.scrollY;n.scroll({[e]:o+t,behavior:"smooth"})},lt=scrollEditor("left",-32),ln=scrollEditor("left",32),lr=scrollEditor("top",-32),lo=scrollEditor("top",32),moveGhost=(e,t,n,o,a,i,l,s,d,c,m,u)=>{let p=0,g=0;e.style.left=t.pageX+"px",e.style.top=t.pageY+"px",t.pageX+n>a&&(p=t.pageX+n-a),t.pageY+o>i&&(g=t.pageY+o-i),e.style.width=n-p+"px",e.style.height=o-g+"px";let f=d.clientHeight,h=d.clientWidth,b=l+d.getBoundingClientRect().top,C=s+d.getBoundingClientRect().left;m.on(e=>{e.intervalId.clear(),e.dragging&&u&&(l+8>=f?e.intervalId.set(lo(c)):l-8<=0?e.intervalId.set(lr(c)):s+8>=h?e.intervalId.set(ln(c)):s-8<=0?e.intervalId.set(lt(c)):b+16>=window.innerHeight?e.intervalId.set(lo(window)):b-16<=0?e.intervalId.set(lr(window)):C+16>=window.innerWidth?e.intervalId.set(ln(window)):C-16<=0&&e.intervalId.set(lt(window)))})},removeElement=e=>{e&&e.parentNode&&e.parentNode.removeChild(e)},removeElementWithPadding=(e,t)=>{let n=e.getParent(t.parentNode,e.isBlock);removeElement(t),n&&n!==e.getRoot()&&e.isEmpty(n)&&fillWithPaddingBr(eS.fromDom(n))},isLeftMouseButtonPressed=e=>0===e.button,applyRelPos=(e,t)=>({pageX:t.pageX-e.relX,pageY:t.pageY+5}),start=(e,t)=>n=>{if(isLeftMouseButtonPressed(n)){let o=find$2(t.dom.getParents(n.target),le).getOr(null);if(isNonNullable(o)&&isDraggable(t.dom,t.getBody(),o)){let a=t.dom.getPos(o),i=t.getBody(),l=t.getDoc().documentElement;e.set({element:o,dataTransfer:createDataTransfer(),dragging:!1,screenX:n.screenX,screenY:n.screenY,maxX:(t.inline?i.scrollWidth:l.offsetWidth)-2,maxY:(t.inline?i.scrollHeight:l.offsetHeight)-2,relX:n.pageX-a.x,relY:n.pageY-a.y,width:o.offsetWidth,height:o.offsetHeight,ghost:createGhost(t,o,o.offsetWidth,o.offsetHeight),intervalId:repeatable(100)})}}},placeCaretAt=(e,t,n)=>{e._selectionOverrides.hideFakeCaret(),closestFakeCaretCandidate(e.getBody(),t,n).fold(()=>e.selection.placeCaretAt(t,n),o=>{let a=e._selectionOverrides.showCaret(1,o.node,o.position===C.Before,!1);a?e.selection.setRng(a):e.selection.placeCaretAt(t,n)})},dispatchDragEvent=(e,t,n,o,a)=>{"dragstart"===t&&setHtmlData(o,e.dom.getOuterHTML(n));let i=makeDragEvent(t,n,o,a),l=e.dispatch(t,i);return l},move=(e,t)=>{let n=first$1((e,n)=>placeCaretAt(t,e,n),0);return t.on("remove",n.cancel),o=>e.on(a=>{let i=Math.max(Math.abs(o.screenX-a.screenX),Math.abs(o.screenY-a.screenY));if(!a.dragging&&i>10){let e=dispatchDragEvent(t,"dragstart",a.element,a.dataTransfer,o);if(isNonNullable(e.dataTransfer)&&(a.dataTransfer=e.dataTransfer),e.isDefaultPrevented())return;a.dragging=!0,t.focus()}if(a.dragging){let i=o.currentTarget===t.getDoc().documentElement,l=applyRelPos(a,calc(t,o));appendGhostToBody(a.ghost,t.getBody()),moveGhost(a.ghost,l,a.width,a.height,a.maxX,a.maxY,o.clientY,o.clientX,t.getContentAreaContainer(),t.getWin(),e,i),n.throttle(o.clientX,o.clientY)}})},getRawTarget=e=>{let t=e.getSel();if(!isNonNullable(t))return null;{let e=t.getRangeAt(0),n=e.startContainer;return ew(n)?n.parentNode:n}},drop=(e,t)=>n=>{e.on(e=>{var o;if(e.intervalId.clear(),e.dragging){if(isValidDropTarget(t,getRawTarget(t.selection),e.element)){let a=null!==(o=t.getDoc().elementFromPoint(n.clientX,n.clientY))&&void 0!==o?o:t.getBody(),i=dispatchDragEvent(t,"drop",a,e.dataTransfer,n);i.isDefaultPrevented()||t.undoManager.transact(()=>{removeElementWithPadding(t.dom,e.element),getHtmlData(e.dataTransfer).each(e=>t.insertContent(e)),t._selectionOverrides.hideFakeCaret()})}dispatchDragEvent(t,"dragend",t.getBody(),e.dataTransfer,n)}}),removeDragState(e)},stopDragging=(e,t,n)=>{e.on(e=>{e.intervalId.clear(),e.dragging&&n.fold(()=>dispatchDragEvent(t,"dragend",e.element,e.dataTransfer),n=>dispatchDragEvent(t,"dragend",e.element,e.dataTransfer,n))}),removeDragState(e)},stop=(e,t)=>n=>stopDragging(e,t,Optional.some(n)),removeDragState=e=>{e.on(e=>{e.intervalId.clear(),removeElement(e.ghost)}),e.clear()},bindFakeDragEvents=e=>{let t=value$2(),n=DOMUtils.DOM,o=document,a=start(t,e),i=move(t,e),l=drop(t,e),s=stop(t,e);e.on("mousedown",a),e.on("mousemove",i),e.on("mouseup",l),n.bind(o,"mousemove",i),n.bind(o,"mouseup",s),e.on("remove",()=>{n.unbind(o,"mousemove",i),n.unbind(o,"mouseup",s)}),e.on("keydown",n=>{n.keyCode===rx.ESC&&stopDragging(t,e,Optional.none())})},blockUnsupportedFileDrop=e=>{let preventFileDrop=t=>{if(!t.isDefaultPrevented()){let n=t.dataTransfer;n&&(contains$2(n.types,"Files")||n.files.length>0)&&(t.preventDefault(),"drop"===t.type&&displayError(e,"Dropped file type is not supported"))}},preventFileDropIfUIElement=t=>{isUIElement(e,t.target)&&preventFileDrop(t)},setup=()=>{let t=DOMUtils.DOM,n=e.dom,o=document,a=e.inline?e.getBody():e.getDoc(),i=["drop","dragover"];each$e(i,e=>{t.bind(o,e,preventFileDropIfUIElement),n.bind(a,e,preventFileDrop)}),e.on("remove",()=>{each$e(i,e=>{t.unbind(o,e,preventFileDropIfUIElement),n.unbind(a,e,preventFileDrop)})})};e.on("init",()=>{rZ.setEditorTimeout(e,setup,0)})},init$2=e=>{bindFakeDragEvents(e),nK(e)&&blockUnsupportedFileDrop(e)},setup$4=e=>{let t=first$1(()=>{if(!e.removed&&e.getBody().contains(document.activeElement)){let t=e.selection.getRng();if(t.collapsed){let n=renderRangeCaret(e,t,!1);e.selection.setRng(n)}}},0);e.on("focus",()=>{t.throttle()}),e.on("blur",()=>{t.cancel()})},setup$3=e=>{e.on("init",()=>{e.on("focusin",t=>{let n=t.target;if(eW(n)){let t=getContentEditableRoot$1(e.getBody(),n),o=eM(t)?t:n;e.selection.getNode()!==o&&selectNode(e,o).each(t=>e.selection.setRng(t))}})})},getContentEditableRoot=(e,t)=>getContentEditableRoot$1(e.getBody(),t),SelectionOverrides=e=>{let t;let n=e.selection,o=e.dom,a=e.getBody(),i=FakeCaret(e,a,o.isBlock,()=>hasFocus(e)),l="sel-"+o.uniqueId(),s="data-mce-selected",isFakeSelectionElement=e=>isNonNullable(e)&&o.hasClass(e,"mce-offscreen-selection"),isFakeSelectionTargetElement=e=>e!==a&&(eM(e)||eW(e))&&o.isChildOf(e,a)&&o.isEditable(e.parentNode),setRange=e=>{e&&n.setRng(e)},showCaret=(t,o,a,l=!0)=>{let s=e.dispatch("ShowCaret",{target:o,direction:t,before:a});return s.isDefaultPrevented()?null:(l&&n.scrollIntoView(o,-1===t),i.show(a,o))},isWithinCaretContainer=e=>isCaretContainer$2(e)||startsWithCaretContainer$1(e)||endsWithCaretContainer$1(e),isRangeInCaretContainer=e=>isWithinCaretContainer(e.startContainer)||isWithinCaretContainer(e.endContainer),normalizeVoidElementSelection=t=>{let n=e.schema.getVoidElements(),a=o.createRng(),i=t.startContainer,l=t.startOffset,s=t.endContainer,d=t.endOffset;return has$2(n,i.nodeName.toLowerCase())?0===l?a.setStartBefore(i):a.setStartAfter(i):a.setStart(i,l),has$2(n,s.nodeName.toLowerCase())?0===d?a.setEndBefore(s):a.setEndAfter(s):a.setEnd(s,d),a},setupOffscreenSelection=(t,a)=>{let i=eS.fromDom(e.getBody()),s=e.getDoc(),d=descendant(i,"#"+l).getOrThunk(()=>{let e=eS.fromHtml('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>',s);return set$3(e,"id",l),append$1(i,e),e}),c=o.createRng();empty(d),append(d,[eS.fromText("\xa0",s),eS.fromDom(a),eS.fromText("\xa0",s)]),c.setStart(d.dom.firstChild,1),c.setEnd(d.dom.lastChild,0),setAll(d,{top:o.getPos(t,e.getBody()).y+"px"}),focus$1(d);let m=n.getSel();return m&&(m.removeAllRanges(),m.addRange(c)),c},selectElement=n=>{let a=n.cloneNode(!0),i=e.dispatch("ObjectSelected",{target:n,targetClone:a});if(i.isDefaultPrevented())return null;let l=setupOffscreenSelection(n,i.targetClone),d=eS.fromDom(n);return each$e(descendants(eS.fromDom(e.getBody()),`*[${s}]`),e=>{eq(d,e)||remove$a(e,s)}),o.getAttrib(n,s)||n.setAttribute(s,"1"),t=n,hideFakeCaret(),l},setElementSelection=(e,t)=>{if(!e)return null;if(e.collapsed){if(!isRangeInCaretContainer(e)){let n=t?1:-1,i=getNormalizedRangeEndPoint(n,a,e),l=i.getNode(!t);if(isNonNullable(l)){if(isFakeCaretTarget(l))return showCaret(n,l,!!t&&!i.isAtEnd(),!1);if(isCaretContainerInline(l)&&eM(l.nextSibling)){let e=o.createRng();return e.setStart(l,0),e.setEnd(l,0),e}}let s=i.getNode(t);if(isNonNullable(s)){if(isFakeCaretTarget(s))return showCaret(n,s,!t&&!i.isAtEnd(),!1);if(isCaretContainerInline(s)&&eM(s.previousSibling)){let e=o.createRng();return e.setStart(s,1),e.setEnd(s,1),e}}}return null}let n=e.startContainer,i=e.startOffset,l=e.endOffset;if(ew(n)&&0===i&&eM(n.parentNode)&&(n=n.parentNode,i=o.nodeIndex(n),n=n.parentNode),!eR(n))return null;if(l===i+1&&n===e.endContainer){let e=n.childNodes[i];if(isFakeSelectionTargetElement(e))return selectElement(e)}return null},removeElementSelection=()=>{t&&t.removeAttribute(s),descendant(eS.fromDom(e.getBody()),"#"+l).each(remove$5),t=null},hideFakeCaret=()=>{i.hide()};return isRtc(e)||(()=>{e.on("click",t=>{o.isEditable(t.target)||(t.preventDefault(),e.focus())}),e.on("blur NewBlock",removeElementSelection),e.on("ResizeWindow FullscreenStateChanged",i.reposition),e.on("tap",t=>{let n=t.target,o=getContentEditableRoot(e,n);eM(o)?(t.preventDefault(),selectNode(e,o).each(setElementSelection)):isFakeSelectionTargetElement(n)&&selectNode(e,n).each(setElementSelection)},!0),e.on("mousedown",t=>{let n=t.target;if(n!==a&&"HTML"!==n.nodeName&&!o.isChildOf(n,a)||!isXYInContentArea(e,t.clientX,t.clientY))return;removeElementSelection(),hideFakeCaret();let i=getContentEditableRoot(e,n);eM(i)?(t.preventDefault(),selectNode(e,i).each(setElementSelection)):closestFakeCaretCandidate(a,t.clientX,t.clientY).each(n=>{t.preventDefault();let o=showCaret(1,n.node,n.position===C.Before,!1);setRange(o),eR(i)?i.focus():e.getBody().focus()})}),e.on("keypress",e=>{!rx.modifierPressed(e)&&eM(n.getNode())&&e.preventDefault()}),e.on("GetSelectionRange",e=>{let n=e.range;if(t){if(!t.parentNode){t=null;return}(n=n.cloneRange()).selectNode(t),e.range=n}}),e.on("SetSelectionRange",e=>{e.range=normalizeVoidElementSelection(e.range);let t=setElementSelection(e.range,e.forward);t&&(e.range=t)});let isPasteBin=e=>eR(e)&&"mcepastebin"===e.id;e.on("AfterSetSelectionRange",e=>{let t=e.range,n=t.startContainer.parentElement;isRangeInCaretContainer(t)||isPasteBin(n)||hideFakeCaret(),isFakeSelectionElement(n)||removeElementSelection()}),init$2(e),setup$4(e),setup$3(e)})(),{showCaret,showBlockCaretContainer:e=>{e.hasAttribute("data-mce-caret")&&(showCaretContainerBlock(e),n.scrollIntoView(e))},hideFakeCaret,destroy:()=>{i.destroy(),t=null}}},getNormalizedTextOffset=(e,t)=>{let n=t;for(let t=e.previousSibling;ew(t);t=t.previousSibling)n+=t.data.length;return n},generatePath=(e,t,n,o,a)=>{if(ew(n)&&(o<0||o>n.data.length))return[];let i=a&&ew(n)?[getNormalizedTextOffset(n,o)]:[o],l=n;for(;l!==t&&l.parentNode;)i.push(e.nodeIndex(l,a)),l=l.parentNode;return l===t?i.reverse():[]},generatePathRange=(e,t,n,o,a,i,l=!1)=>{let s=generatePath(e,t,n,o,l),d=generatePath(e,t,a,i,l);return{start:s,end:d}},resolvePath=(e,t)=>{let n=t.slice(),o=n.pop();if(!x(o))return Optional.none();{let t=foldl(n,(e,t)=>e.bind(e=>Optional.from(e.childNodes[t])),Optional.some(e));return t.bind(e=>ew(e)&&(o<0||o>e.data.length)?Optional.none():Optional.some({node:e,offset:o}))}},resolvePathRange=(e,t)=>resolvePath(e,t.start).bind(({node:n,offset:o})=>resolvePath(e,t.end).map(({node:e,offset:t})=>{let a=document.createRange();return a.setStart(n,o),a.setEnd(e,t),a})),generatePathRangeFromRange=(e,t,n,o=!1)=>generatePathRange(e,t,n.startContainer,n.startOffset,n.endContainer,n.endOffset,o),cleanEmptyNodes=(e,t,n)=>{if(t&&e.isEmpty(t)&&!n(t)){let o=t.parentNode;e.remove(t,ew(t.firstChild)&&isWhitespaceText(t.firstChild.data)),cleanEmptyNodes(e,o,n)}},deleteRng=(e,t,n,o=!0)=>{let a=t.startContainer.parentNode,i=t.endContainer.parentNode;t.deleteContents(),o&&!n(t.startContainer)&&(ew(t.startContainer)&&0===t.startContainer.data.length&&e.remove(t.startContainer),ew(t.endContainer)&&0===t.endContainer.data.length&&e.remove(t.endContainer),cleanEmptyNodes(e,a,n),a!==i&&cleanEmptyNodes(e,i,n))},getParentBlock=(e,t)=>Optional.from(e.dom.getParent(t.startContainer,e.dom.isBlock)),resolveFromDynamicPatterns=(e,t,n)=>{let o=e.dynamicPatternsLookup({text:n,block:t});return{...e,blockPatterns:getBlockPatterns(o).concat(e.blockPatterns),inlinePatterns:getInlinePatterns(o).concat(e.inlinePatterns)}},getBeforeText=(e,t,n,o)=>{let a=e.createRng();return a.setStart(t,0),a.setEnd(n,o),a.toString()},startsWithSingleSpace=e=>/^\s[^\s]/.test(e),stripPattern=(e,t,n)=>{let o=textAfter(t,0,t);o.each(o=>{let a=o.container;scanRight(a,n.start.length,t).each(n=>{let o=e.createRng();o.setStart(a,0),o.setEnd(n.container,n.offset),deleteRng(e,o,e=>e===t)});let i=eS.fromDom(a),l=get$3(i);startsWithSingleSpace(l)&&set(i,l.slice(1))})},applyPattern$1=(e,t)=>{let n=e.dom,o=t.pattern,a=resolvePathRange(n.getRoot(),t.range).getOrDie("Unable to resolve path range"),isBlockFormatName=(e,t)=>{let n=t.get(e);return S(n)&&head(n).exists(e=>has$2(e,"block"))};return getParentBlock(e,a).each(t=>{"block-format"===o.type?isBlockFormatName(o.format,e.formatter)&&e.undoManager.transact(()=>{stripPattern(e.dom,t,o),e.formatter.apply(o.format)}):"block-command"===o.type&&e.undoManager.transact(()=>{stripPattern(e.dom,t,o),e.execCommand(o.cmd,!1,o.value)})}),!0},sortPatterns$1=e=>sort(e,(e,t)=>t.start.length-e.start.length),findPattern$1=(e,t)=>{let n=sortPatterns$1(e),o=t.replace("\xa0"," ");return find$2(n,e=>0===t.indexOf(e.start)||0===o.indexOf(e.start))},findPatterns$1=(e,t,n,o)=>{var a;let i=e.dom,l=t2(e);if(!i.is(t,l))return[];let s=null!==(a=t.textContent)&&void 0!==a?a:"";return findPattern$1(n.blockPatterns,s).map(e=>eb.trim(s).length===e.start.length?[]:[{pattern:e,range:generatePathRange(i,i.getRoot(),t,0,t,0,o)}]).getOr([])},applyMatches$1=(e,t)=>{if(0===t.length)return;let n=e.selection.getBookmark();each$e(t,t=>applyPattern$1(e,t)),e.selection.moveToBookmark(n)},newMarker=(e,t)=>e.create("span",{"data-mce-type":"bookmark",id:t}),rangeFromMarker=(e,t)=>{let n=e.createRng();return n.setStartAfter(t.start),n.setEndBefore(t.end),n},createMarker=(e,t,n)=>{let o=resolvePathRange(e.getRoot(),n).getOrDie("Unable to resolve path range"),a=o.startContainer,i=o.endContainer,l=0===o.endOffset?i:i.splitText(o.endOffset),s=0===o.startOffset?a:a.splitText(o.startOffset),d=s.parentNode,c=l.parentNode;return{prefix:t,end:c.insertBefore(newMarker(e,t+"-end"),l),start:d.insertBefore(newMarker(e,t+"-start"),s)}},removeMarker=(e,t,n)=>{cleanEmptyNodes(e,e.get(t.prefix+"-end"),n),cleanEmptyNodes(e,e.get(t.prefix+"-start"),n)},isReplacementPattern=e=>0===e.start.length,matchesPattern=e=>(t,n)=>{let o=t.data,a=o.substring(0,n),i=a.lastIndexOf(e.charAt(e.length-1)),l=a.lastIndexOf(e);return -1!==l?l+e.length:-1!==i?i+1:-1},findPatternStartFromSpot=(e,t,n,o)=>{let a=t.start,i=repeatLeft(e,o.container,o.offset,matchesPattern(a),n);return i.bind(o=>{var i,l;let s=null!==(l=null===(i=n.textContent)||void 0===i?void 0:i.indexOf(a))&&void 0!==l?l:-1,d=-1!==s&&o.offset>=s+a.length;if(d){let t=e.createRng();return t.setStart(o.container,o.offset-a.length),t.setEnd(o.container,o.offset),Optional.some(t)}{let i=o.offset-a.length;return scanLeft(o.container,i,n).map(t=>{let n=e.createRng();return n.setStart(t.container,t.offset),n.setEnd(o.container,o.offset),n}).filter(e=>e.toString()===a).orThunk(()=>findPatternStartFromSpot(e,t,n,point(o.container,0)))}})},findPatternStart=(e,t,n,o,a,i=!1)=>{if(0===t.start.length&&!i){let t=e.createRng();return t.setStart(n,o),t.setEnd(n,o),Optional.some(t)}return textBefore(n,o,a).bind(n=>{let o=findPatternStartFromSpot(e,t,a,n);return o.bind(e=>{var t;return i&&(e.endContainer===n.container&&e.endOffset===n.offset||0===n.offset&&(null===(t=e.endContainer.textContent)||void 0===t?void 0:t.length)===e.endOffset)?Optional.none():Optional.some(e)})})},findPattern=(e,t,n,o)=>{let a=e.dom,i=a.getRoot(),l=n.pattern,s=n.position.container,d=n.position.offset;return scanLeft(s,d-n.pattern.end.length,t).bind(c=>{let m=generatePathRange(a,i,c.container,c.offset,s,d,o);if(isReplacementPattern(l))return Optional.some({matches:[{pattern:l,startRng:m,endRng:m}],position:c});{let s=findPatternsRec(e,n.remainingPatterns,c.container,c.offset,t,o),d=s.getOr({matches:[],position:c}),u=d.position,p=findPatternStart(a,l,u.container,u.offset,t,s.isNone());return p.map(e=>{let t=generatePathRangeFromRange(a,i,e,o);return{matches:d.matches.concat([{pattern:l,startRng:t,endRng:m}]),position:point(e.startContainer,e.startOffset)}})}})},findPatternsRec=(e,t,n,o,a,i)=>{let l=e.dom;return textBefore(n,o,l.getRoot()).bind(s=>{let d=getBeforeText(l,a,n,o);for(let l=0;l<t.length;l++){let c=t[l];if(!endsWith(d,c.end))continue;let m=t.slice();m.splice(l,1);let u=findPattern(e,a,{pattern:c,remainingPatterns:m,position:s},i);if(u.isNone()&&o>0)return findPatternsRec(e,t,n,o-1,a,i);if(u.isSome())return u}return Optional.none()})},applyPattern=(e,t,n)=>{e.selection.setRng(n),"inline-format"===t.type?each$e(t.format,t=>{e.formatter.apply(t)}):e.execCommand(t.cmd,!1,t.value)},applyReplacementPattern=(e,t,n,o)=>{let a=rangeFromMarker(e.dom,n);deleteRng(e.dom,a,o),applyPattern(e,t,a)},applyPatternWithContent=(e,t,n,o,a)=>{let i=e.dom,l=rangeFromMarker(i,o),s=rangeFromMarker(i,n);deleteRng(i,s,a),deleteRng(i,l,a);let d={prefix:n.prefix,start:n.end,end:o.start},c=rangeFromMarker(i,d);applyPattern(e,t,c)},addMarkers=(e,t)=>{let n=generate$1("mce_textpattern"),o=foldr(t,(t,o)=>{let a=createMarker(e,n+`_end${t.length}`,o.endRng);return t.concat([{...o,endMarker:a}])},[]);return foldr(o,(t,a)=>{let i=o.length-t.length-1,l=isReplacementPattern(a.pattern)?a.endMarker:createMarker(e,n+`_start${i}`,a.startRng);return t.concat([{...a,startMarker:l}])},[])},sortPatterns=e=>sort(e,(e,t)=>t.end.length-e.end.length),getBestMatches=(e,t)=>{let n=forall(e,e=>exists(t,t=>e.pattern.start===t.pattern.start&&e.pattern.end===t.pattern.end));return e.length===t.length?n?e:t:e.length>t.length?e:t},findPatterns=(e,t,n,o,a,i)=>{let l=findPatternsRec(e,a.inlinePatterns,n,o,t,i).fold(()=>[],e=>e.matches),s=findPatternsRec(e,sortPatterns(a.inlinePatterns),n,o,t,i).fold(()=>[],e=>e.matches);return getBestMatches(l,s)},applyMatches=(e,t)=>{if(0===t.length)return;let n=e.dom,o=e.selection.getBookmark(),a=addMarkers(n,t);each$e(a,t=>{let o=n.getParent(t.startMarker.start,n.isBlock),isRoot=e=>e===o;isReplacementPattern(t.pattern)?applyReplacementPattern(e,t.pattern,t.endMarker,isRoot):applyPatternWithContent(e,t.pattern,t.startMarker,t.endMarker,isRoot),removeMarker(n,t.endMarker,isRoot),removeMarker(n,t.startMarker,isRoot)}),e.selection.moveToBookmark(o)},handleEnter=(e,t)=>{let n=e.selection.getRng();return getParentBlock(e,n).map(o=>{var a;let i=Math.max(0,n.startOffset),l=resolveFromDynamicPatterns(t,o,null!==(a=o.textContent)&&void 0!==a?a:""),s=findPatterns(e,o,n.startContainer,i,l,!0),d=findPatterns$1(e,o,l,!0);return(d.length>0||s.length>0)&&(e.undoManager.add(),e.undoManager.extra(()=>{e.execCommand("mceInsertNewLine")},()=>{e.insertContent("\uFEFF"),applyMatches(e,s),applyMatches$1(e,d);let t=e.selection.getRng(),n=textBefore(t.startContainer,t.startOffset,e.dom.getRoot());e.execCommand("mceInsertNewLine"),n.each(t=>{let n=t.container;"\uFEFF"===n.data.charAt(t.offset-1)&&(n.deleteData(t.offset-1,1),cleanEmptyNodes(e.dom,n.parentNode,t=>t===e.dom.getRoot()))})}),!0)}).getOr(!1)},handleInlineKey=(e,t)=>{let n=e.selection.getRng();getParentBlock(e,n).map(o=>{let a=Math.max(0,n.startOffset-1),i=getBeforeText(e.dom,o,n.startContainer,a),l=resolveFromDynamicPatterns(t,o,i),s=findPatterns(e,o,n.startContainer,a,l,!1);s.length>0&&e.undoManager.transact(()=>{applyMatches(e,s)})})},checkKeyEvent=(e,t,n)=>{for(let o=0;o<e.length;o++)if(n(e[o],t))return!0;return!1},checkKeyCode=(e,t)=>checkKeyEvent(e,t,(e,t)=>e===t.keyCode&&!rx.modifierPressed(t)),checkCharCode=(e,t)=>checkKeyEvent(e,t,(e,t)=>e.charCodeAt(0)===t.charCode),setup$2=e=>{let t=[",",".",";",":","!","?"],n=[32],getPatternSet=()=>createPatternSet(ri(e),rl(e)),hasDynamicPatterns=()=>hasTextPatternsLookup(e);e.on("keydown",t=>{if(13===t.keyCode&&!rx.modifierPressed(t)&&e.selection.isCollapsed()){let n=getPatternSet(),o=n.inlinePatterns.length>0||n.blockPatterns.length>0||hasDynamicPatterns();o&&handleEnter(e,n)&&t.preventDefault()}},!0);let handleInlineTrigger=()=>{if(e.selection.isCollapsed()){let t=getPatternSet(),n=t.inlinePatterns.length>0||hasDynamicPatterns();n&&handleInlineKey(e,t)}};e.on("keyup",e=>{checkKeyCode(n,e)&&handleInlineTrigger()}),e.on("keypress",n=>{checkCharCode(t,n)&&rZ.setEditorTimeout(e,handleInlineTrigger)})},setup$1=e=>{setup$2(e)},Quirks=e=>{let t=eb.each,n=rx.BACKSPACE,o=rx.DELETE,a=e.dom,i=e.selection,l=e.parser,s=ef.browser,d=s.isFirefox(),c=s.isChromium()||s.isSafari(),m=ef.deviceType.isiPhone()||ef.deviceType.isiPad(),u=ef.os.isMacOS()||ef.os.isiOS(),setEditorCommandState=(t,n)=>{try{e.getDoc().execCommand(t,!1,String(n))}catch(e){}},isDefaultPrevented=e=>e.isDefaultPrevented(),selectAll=()=>{e.shortcuts.add("meta+a",null,"SelectAll")},documentElementEditingFocus=()=>{e.inline||a.bind(e.getDoc(),"mousedown mouseup",t=>{let n;if(t.target===e.getDoc().documentElement){if(n=i.getRng(),e.getBody().focus(),"mousedown"===t.type){if(isCaretContainer$2(n.startContainer))return;i.placeCaretAt(t.clientX,t.clientY)}else i.setRng(n)}})},focusBody=()=>{Range.prototype.getClientRects||e.on("mousedown",t=>{if(!isDefaultPrevented(t)&&"HTML"===t.target.nodeName){let t=e.getBody();t.blur(),rZ.setEditorTimeout(e,()=>{t.focus()})}})},selectControlElements=()=>{let t=nX(e);e.on("click",n=>{let o=n.target;/^(IMG|HR)$/.test(o.nodeName)&&a.isEditable(o.parentNode)&&(n.preventDefault(),e.selection.select(o),e.nodeChanged()),"A"===o.nodeName&&a.hasClass(o,t)&&0===o.childNodes.length&&a.isEditable(o.parentNode)&&(n.preventDefault(),i.select(o))})},disableBackspaceIntoATable=()=>{e.on("keydown",e=>{if(!isDefaultPrevented(e)&&e.keyCode===n&&i.isCollapsed()&&0===i.getRng().startOffset){let t=i.getNode().previousSibling;if(t&&t.nodeName&&"table"===t.nodeName.toLowerCase())return e.preventDefault(),!1}return!0})},setGeckoEditingOptions=()=>{nW(e)||e.on("BeforeExecCommand mousedown",()=>{setEditorCommandState("StyleWithCSS",!1),setEditorCommandState("enableInlineTableEditing",!1),nv(e)||setEditorCommandState("enableObjectResizing",!1)})},isAllContentSelected=e=>{let t=e.getBody(),n=e.selection.getRng();return n.startContainer===n.endContainer&&n.startContainer===t&&0===n.startOffset&&n.endOffset===t.childNodes.length},showBrokenImageIcon=()=>{e.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},restoreFocusOnKeyDown=()=>{e.inline||e.on("keydown",()=>{document.activeElement===document.body&&e.getWin().focus()})},bodyHeight=()=>{e.inline||(e.contentStyles.push("body {min-height: 150px}"),e.on("click",t=>{let n;"HTML"===t.target.nodeName&&(n=e.selection.getRng(),e.getBody().focus(),e.selection.setRng(n),e.selection.normalize(),e.nodeChanged())}))},blockCmdArrowNavigation=()=>{u&&e.on("keydown",t=>{if(rx.metaKeyPressed(t)&&!t.shiftKey&&(37===t.keyCode||39===t.keyCode)){t.preventDefault();let n=e.selection.getSel();n.modify("move",37===t.keyCode?"backward":"forward","lineboundary")}})},tapLinksAndImages=()=>{e.on("click",e=>{let t=e.target;do if("A"===t.tagName){e.preventDefault();return}while(t=t.parentNode)}),e.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},blockFormSubmitInsideEditor=()=>{e.on("init",()=>{e.dom.bind(e.getBody(),"submit",e=>{e.preventDefault()})})};return isRtc(e)?(c&&(documentElementEditingFocus(),selectControlElements(),blockFormSubmitInsideEditor(),selectAll(),m&&(restoreFocusOnKeyDown(),bodyHeight(),tapLinksAndImages())),d&&(focusBody(),setGeckoEditingOptions(),showBrokenImageIcon(),blockCmdArrowNavigation())):(e.on("keydown",t=>{if(isDefaultPrevented(t)||t.keyCode!==rx.BACKSPACE)return;let n=i.getRng(),o=n.startContainer,l=n.startOffset,s=a.getRoot(),d=o;if(n.collapsed&&0===l){for(;d.parentNode&&d.parentNode.firstChild===d&&d.parentNode!==s;)d=d.parentNode;"BLOCKQUOTE"===d.nodeName&&(e.formatter.toggle("blockquote",void 0,d),(n=a.createRng()).setStart(o,0),n.setEnd(o,0),i.setRng(n))}}),(()=>{let serializeRng=e=>{let t=a.create("body"),n=e.cloneContents();return t.appendChild(n),i.serializer.serialize(t,{format:"html"})},allContentsSelected=t=>{let n=serializeRng(t),o=a.createRng();o.selectNode(e.getBody());let i=serializeRng(o);return n===i},hasPreservedEmptyElements=e=>{let t=eS.fromDom(e);return exists(descendants(t,'[contenteditable="true"]'),e=>parentElement(e).exists(e=>!isEditable$3(e)))};e.on("keydown",t=>{let i=t.keyCode;if(!isDefaultPrevented(t)&&(i===o||i===n)&&e.selection.isEditable()){let n=e.selection.isCollapsed(),o=e.getBody();if(n&&(!a.isEmpty(o)||hasPreservedEmptyElements(o))||!n&&!allContentsSelected(e.selection.getRng()))return;t.preventDefault(),e.setContent(""),o.firstChild&&a.isBlock(o.firstChild)?e.selection.setCursorLocation(o.firstChild,0):e.selection.setCursorLocation(o,0),e.nodeChanged()}})})(),ef.windowsPhone||e.on("keyup focusin mouseup",t=>{rx.modifierPressed(t)||isAllContentSelected(e)||i.normalize()},!0),c&&(documentElementEditingFocus(),selectControlElements(),e.on("init",()=>{setEditorCommandState("DefaultParagraphSeparator",t2(e))}),blockFormSubmitInsideEditor(),disableBackspaceIntoATable(),l.addNodeFilter("br",e=>{let t=e.length;for(;t--;)"Apple-interchange-newline"===e[t].attr("class")&&e[t].remove()}),m?(restoreFocusOnKeyDown(),bodyHeight(),tapLinksAndImages()):selectAll()),d&&(e.on("keydown",t=>{if(!isDefaultPrevented(t)&&t.keyCode===n&&e.getBody().getElementsByTagName("hr").length&&i.isCollapsed()&&0===i.getRng().startOffset){let e=i.getNode(),n=e.previousSibling;if("HR"===e.nodeName){a.remove(e),t.preventDefault();return}n&&n.nodeName&&"hr"===n.nodeName.toLowerCase()&&(a.remove(n),t.preventDefault())}}),focusBody(),(()=>{let getAttributeApplyFunction=()=>{let n=a.getAttribs(i.getStart().cloneNode(!1));return()=>{let o=i.getStart();o!==e.getBody()&&(a.setAttrib(o,"style",null),t(n,e=>{o.setAttributeNode(e.cloneNode(!0))}))}},isSelectionAcrossElements=()=>!i.isCollapsed()&&a.getParent(i.getStart(),a.isBlock)!==a.getParent(i.getEnd(),a.isBlock);e.on("keypress",t=>{let n;return!(!isDefaultPrevented(t)&&(8===t.keyCode||46===t.keyCode)&&isSelectionAcrossElements())||(n=getAttributeApplyFunction(),e.getDoc().execCommand("delete",!1),n(),t.preventDefault(),!1)}),a.bind(e.getDoc(),"cut",t=>{if(!isDefaultPrevented(t)&&isSelectionAcrossElements()){let t=getAttributeApplyFunction();rZ.setEditorTimeout(e,()=>{t()})}})})(),setGeckoEditingOptions(),(()=>{let fixLinks=()=>{t(a.select("a:not([data-mce-block])"),e=>{var t;let n=e.parentNode,o=a.getRoot();if((null==n?void 0:n.lastChild)===e){for(;n&&!a.isBlock(n);){if((null===(t=n.parentNode)||void 0===t?void 0:t.lastChild)!==n||n===o)return;n=n.parentNode}a.add(n,"br",{"data-mce-bogus":1})}})};e.on("SetContent ExecCommand",e=>{("setcontent"===e.type||"mceInsertLink"===e.command)&&fixLinks()})})(),showBrokenImageIcon(),blockCmdArrowNavigation(),disableBackspaceIntoATable(),e.on("drop",t=>{var n;let o=null===(n=t.dataTransfer)||void 0===n?void 0:n.getData("text/html");k(o)&&/^<img[^>]*>$/.test(o)&&e.dispatch("dragend",new window.DragEvent("dragend",t))}))),{refreshContentEditable:noop,isHidden:()=>{if(!d||e.removed)return!1;let t=e.selection.getSel();return!t||!t.rangeCount||0===t.rangeCount}}},la=DOMUtils.DOM,appendStyle=(e,t)=>{let n=eS.fromDom(e.getBody()),o=getStyleContainer(eP(n)),a=eS.fromTag("style");set$3(a,"type","text/css"),append$1(a,eS.fromText(t)),append$1(o,a),e.on("remove",()=>{remove$5(a)})},getRootName=e=>e.inline?e.getElement().nodeName.toLowerCase():void 0,removeUndefined=e=>filter$4(e,e=>!1===P(e)),mkParserSettings=e=>{let t=e.options.get,n=e.editorUpload.blobCache;return removeUndefined({allow_conditional_comments:t("allow_conditional_comments"),allow_html_data_urls:t("allow_html_data_urls"),allow_svg_data_urls:t("allow_svg_data_urls"),allow_html_in_named_anchor:t("allow_html_in_named_anchor"),allow_script_urls:t("allow_script_urls"),allow_unsafe_link_target:t("allow_unsafe_link_target"),convert_fonts_to_spans:t("convert_fonts_to_spans"),fix_list_elements:t("fix_list_elements"),font_size_legacy_values:t("font_size_legacy_values"),forced_root_block:t("forced_root_block"),forced_root_block_attrs:t("forced_root_block_attrs"),preserve_cdata:t("preserve_cdata"),inline_styles:t("inline_styles"),root_name:getRootName(e),sanitize:t("xss_sanitization"),validate:!0,blob_cache:n,document:e.getDoc()})},mkSchemaSettings=e=>{let t=e.options.get;return removeUndefined({custom_elements:t("custom_elements"),extended_valid_elements:t("extended_valid_elements"),invalid_elements:t("invalid_elements"),invalid_styles:t("invalid_styles"),schema:t("schema"),valid_children:t("valid_children"),valid_classes:t("valid_classes"),valid_elements:t("valid_elements"),valid_styles:t("valid_styles"),verify_html:t("verify_html"),padd_empty_block_inline_children:t("format_empty_lines")})},mkSerializerSettings=e=>{let t=e.options.get;return{...mkParserSettings(e),...mkSchemaSettings(e),...removeUndefined({remove_trailing_brs:t("remove_trailing_brs"),pad_empty_with_br:t("pad_empty_with_br"),url_converter:t("url_converter"),url_converter_scope:t("url_converter_scope"),element_format:t("element_format"),entities:t("entities"),entity_encoding:t("entity_encoding"),indent:t("indent"),indent_after:t("indent_after"),indent_before:t("indent_before")})}},createParser=e=>{let t=DomParser(mkParserSettings(e),e.schema);return t.addAttributeFilter("src,href,style,tabindex",(t,n)=>{let o=e.dom,a="data-mce-"+n,i=t.length;for(;i--;){let l=t[i],s=l.attr(n);if(s&&!l.attr(a)){if(0===s.indexOf("data:")||0===s.indexOf("blob:"))continue;"style"===n?((s=o.serializeStyle(o.parseStyle(s),l.name)).length||(s=null),l.attr(a,s),l.attr(n,s)):"tabindex"===n?(l.attr(a,s),l.attr(n,null)):l.attr(a,e.convertURL(s,n,l.name))}}}),t.addNodeFilter("script",e=>{let t=e.length;for(;t--;){let n=e[t],o=n.attr("type")||"no/type";0!==o.indexOf("mce-")&&n.attr("type","mce-"+o)}}),rm(e)&&t.addNodeFilter("#cdata",t=>{var n;let o=t.length;for(;o--;){let a=t[o];a.type=8,a.name="#comment",a.value="[CDATA["+e.dom.encode(null!==(n=a.value)&&void 0!==n?n:"")+"]]"}}),t.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",t=>{let n=t.length,o=e.schema.getNonEmptyElements();for(;n--;){let e=t[n];e.isEmpty(o)&&0===e.getAll("br").length&&e.append(new AstNode("br",1))}}),t},autoFocus=e=>{let t=n1(e);t&&rZ.setEditorTimeout(e,()=>{let n;(n=!0===t?e:e.editorManager.get(t))&&!n.destroyed&&(n.focus(),n.selection.scrollIntoView())},100)},moveSelectionToFirstCaretPosition=e=>{let t=e.dom.getRoot();e.inline||hasAnyRanges(e)&&e.selection.getStart(!0)!==t||r$(t).each(t=>{let n=t.getNode(),o=isTable$2(n)?r$(n).getOr(t):t;e.selection.setRng(o.toRange())})},initEditor=e=>{e.bindPendingEventDelegates(),e.initialized=!0,fireInit(e),e.focus(!0),moveSelectionToFirstCaretPosition(e),e.nodeChanged({initial:!0});let t=nJ(e);R(t)&&t.call(e,e),autoFocus(e)},getStyleSheetLoader$1=e=>e.inline?e.ui.styleSheetLoader:e.dom.styleSheetLoader,makeStylesheetLoadingPromises=(e,t,n)=>{let o=[getStyleSheetLoader$1(e).loadAll(t)];return e.inline?o:o.concat([e.ui.styleSheetLoader.loadAll(n)])},loadContentCss=e=>{let t=getStyleSheetLoader$1(e),n=nb(e),o=e.contentCSS,removeCss=()=>{t.unloadAll(o),e.inline||e.ui.styleSheetLoader.unloadAll(n)},loaded=()=>{e.removed?removeCss():e.on("remove",removeCss)};if(e.contentStyles.length>0){let t="";eb.each(e.contentStyles,e=>{t+=e+"\r\n"}),e.dom.addStyle(t)}let a=Promise.all(makeStylesheetLoadingPromises(e,o,n)).then(loaded).catch(loaded),i=nh(e);return i&&appendStyle(e,i),a},preInit=e=>{let t=e.getDoc(),n=e.getBody();firePreInit(e),n2(e)||(t.body.spellcheck=!1,la.setAttrib(n,"spellcheck","false")),e.quirks=Quirks(e),firePostRender(e);let o=nC(e);void 0!==o&&(n.dir=o);let a=n3(e);a&&e.on("BeforeSetContent",e=>{eb.each(a,t=>{e.content=e.content.replace(t,e=>"<!--mce:protected "+escape(e)+"-->")})}),e.on("SetContent",()=>{e.addVisual(e.getBody())}),e.on("compositionstart compositionend",t=>{e.composing="compositionstart"===t.type})},loadInitialContent=e=>{isRtc(e)||e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"})},initEditorWithInitialContent=e=>{!0!==e.removed&&(loadInitialContent(e),initEditor(e))},startProgress=e=>{let t=!1,n=setTimeout(()=>{t||e.setProgressState(!0)},500);return()=>{clearTimeout(n),t=!0,e.setProgressState(!1)}},contentBodyLoaded=e=>{let t=e.getElement(),n=e.getDoc();e.inline&&(la.addClass(t,"mce-content-body"),e.contentDocument=n=document,e.contentWindow=window,e.bodyElement=t,e.contentAreaContainer=t);let o=e.getBody();o.disabled=!0,e.readonly=nW(e),e._editableRoot=nH(e),!e.readonly&&e.hasEditableRoot()&&(e.inline&&"static"===la.getStyle(o,"position",!0)&&(o.style.position="relative"),o.contentEditable="true"),o.disabled=!1,e.editorUpload=EditorUpload(e),e.schema=Schema(mkSchemaSettings(e)),e.dom=DOMUtils(n,{keep_values:!0,url_converter:e.convertURL,url_converter_scope:e,update_styles:!0,root_element:e.inline?e.getBody():null,collect:e.inline,schema:e.schema,contentCssCors:ns(e),referrerPolicy:nd(e),onSetAttrib:t=>{e.dispatch("SetAttrib",t)}}),e.parser=createParser(e),e.serializer=DomSerializer(mkSerializerSettings(e),e),e.selection=EditorSelection(e.dom,e.getWin(),e.serializer,e),e.annotator=Annotator(e),e.formatter=Formatter(e),e.undoManager=UndoManager(e),e._nodeChangeDispatcher=new NodeChange(e),e._selectionOverrides=SelectionOverrides(e),setup$o(e),setup$6(e),setup$m(e),isRtc(e)||(setup$5(e),setup$1(e));let a=setup$b(e);setup$p(e,a),setup$n(e),setup$q(e),setup$7(e);let i=setup$s(e);preInit(e),i.fold(()=>{let t=startProgress(e);loadContentCss(e).then(()=>{initEditorWithInitialContent(e),t()})},t=>{e.setProgressState(!0),loadContentCss(e).then(()=>{t().then(t=>{e.setProgressState(!1),initEditorWithInitialContent(e),bindEvents(e)},t=>{e.notificationManager.open({type:"error",text:String(t)}),initEditorWithInitialContent(e),bindEvents(e)})})})},bind=(e,t,n)=>bind$2(e,t,A,n),li=DOMUtils.DOM,createIframeElement=(e,t,n,o)=>{let a=eS.fromTag("iframe");return o.each(e=>set$3(a,"tabindex",e)),setAll$1(a,n),setAll$1(a,{id:e+"_ifr",frameBorder:"0",allowTransparency:"true",title:t}),add$2(a,"tox-edit-area__iframe"),a},getIframeHtml=e=>{let t=tX(e)+"<html><head>";tZ(e)!==e.documentBaseUrl&&(t+='<base href="'+e.documentBaseURI.getURI()+'" />'),t+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';let n=tQ(e),o=tJ(e),a=e.translate(nZ(e));return t0(e)&&(t+='<meta http-equiv="Content-Security-Policy" content="'+t0(e)+'" />'),t+=`</head><body id="${n}" class="mce-content-body ${o}" data-id="${e.id}" aria-label="${a}"><br></body></html>`},createIframe=(e,t)=>{let n=e.translate("Rich Text Area"),o=getOpt(eS.fromDom(e.getElement()),"tabindex").bind(toInt),a=createIframeElement(e.id,n,tY(e),o).dom;a.onload=()=>{a.onload=null,e.dispatch("load")},e.contentAreaContainer=t.iframeContainer,e.iframeElement=a,e.iframeHTML=getIframeHtml(e),li.add(t.iframeContainer,a)},setupIframeBody=e=>{let t=e.iframeElement,ready=()=>{e.contentDocument=t.contentDocument,contentBodyLoaded(e)};if(rg(e)||ef.browser.isFirefox()){let t=e.getDoc();t.open(),t.write(e.iframeHTML),t.close(),ready()}else{let n=bind(eS.fromDom(t),"load",()=>{n.unbind(),ready()});t.srcdoc=e.iframeHTML}},init$1=(e,t)=>{createIframe(e,t),t.editorContainer&&(t.editorContainer.style.display=e.orgDisplay,e.hidden=li.isHidden(t.editorContainer)),e.getElement().style.display="none",li.setAttrib(e.id,"aria-hidden","true"),e.getElement().style.visibility=e.orgVisibility,setupIframeBody(e)},ll=DOMUtils.DOM,initPlugin=(e,t,n)=>{let o=aR.get(n),a=aR.urls[n]||e.documentBaseUrl.replace(/\/$/,"");if(n=eb.trim(n),o&&-1===eb.inArray(t,n)){if(e.plugins[n])return;try{let i=o(e,a)||{};e.plugins[n]=i,R(i.init)&&(i.init(e,a),t.push(n))}catch(t){pluginInitError(e,n,t)}}},trimLegacyPrefix=e=>e.replace(/^\-/,""),initPlugins=e=>{let t=[];each$e(nq(e),n=>{initPlugin(e,t,trimLegacyPrefix(n))})},initIcons=e=>{let t=eb.trim(nn(e)),n=e.ui.registry.getAll().icons,o={...ak.get("default").icons,...ak.get(t).icons};each$d(o,(t,o)=>{has$2(n,o)||e.ui.registry.addIcon(o,t)})},initTheme=e=>{let t=nN(e);if(k(t)){let n=ax.get(t);e.theme=n(e,ax.urls[t])||{},R(e.theme.init)&&e.theme.init(e,ax.urls[t]||e.documentBaseUrl.replace(/\/$/,""))}else e.theme={}},initModel=e=>{let t=nP(e),n=a$.get(t);e.model=n(e,a$.urls[t])},renderFromLoadedTheme=e=>{let t=e.theme.renderUI;return t?t():renderThemeFalse(e)},renderFromThemeFunc=e=>{let t=e.getElement(),n=nN(e),o=n(e,t);return o.editorContainer.nodeType&&(o.editorContainer.id=o.editorContainer.id||e.id+"_parent"),o.iframeContainer&&o.iframeContainer.nodeType&&(o.iframeContainer.id=o.iframeContainer.id||e.id+"_iframecontainer"),o.height=o.iframeHeight?o.iframeHeight:t.offsetHeight,o},createThemeFalseResult=(e,t)=>({editorContainer:e,iframeContainer:t,api:{}}),renderThemeFalseIframe=e=>{let t=ll.create("div");return ll.insertAfter(t,e),createThemeFalseResult(t,t)},renderThemeFalse=e=>{let t=e.getElement();return e.inline?createThemeFalseResult(null):renderThemeFalseIframe(t)},renderThemeUi=e=>{let t=e.getElement();return(e.orgDisplay=t.style.display,k(nN(e)))?renderFromLoadedTheme(e):R(nN(e))?renderFromThemeFunc(e):renderThemeFalse(e)},augmentEditorUiApi=(e,t)=>{let n={show:Optional.from(t.show).getOr(noop),hide:Optional.from(t.hide).getOr(noop),isEnabled:Optional.from(t.isEnabled).getOr(A),setEnabled:n=>{e.mode.isReadOnly()||Optional.from(t.setEnabled).each(e=>e(n))}};e.ui={...e.ui,...n}},init=async e=>{e.dispatch("ScriptsLoaded"),initIcons(e),initTheme(e),initModel(e),initPlugins(e);let t=await renderThemeUi(e);augmentEditorUiApi(e,Optional.from(t.api).getOr({})),e.editorContainer=t.editorContainer,appendContentCssFromSettings(e),e.inline?contentBodyLoaded(e):init$1(e,{editorContainer:t.editorContainer,iframeContainer:t.iframeContainer})},ls=DOMUtils.DOM,hasSkipLoadPrefix=e=>"-"===e.charAt(0),loadLanguage=(e,t)=>{let n=nc(t),o=nm(t);if(!tP.hasCode(n)&&"en"!==n){let a=isNotEmpty(o)?o:`${t.editorManager.baseURL}/langs/${n}.js`;e.add(a).catch(()=>{languageLoadError(t,a,n)})}},loadTheme=(e,t)=>{let n=nN(e);if(k(n)&&!hasSkipLoadPrefix(n)&&!has$2(ax.urls,n)){let o=nO(e),a=o?e.documentBaseURI.toAbsolute(o):`themes/${n}/theme${t}.js`;ax.load(n,a).catch(()=>{themeLoadError(e,a,n)})}},loadModel=(e,t)=>{let n=nP(e);if("plugin"!==n&&!has$2(a$.urls,n)){let o=nR(e),a=k(o)?e.documentBaseURI.toAbsolute(o):`models/${n}/model${t}.js`;a$.load(n,a).catch(()=>{modelLoadError(e,a,n)})}},getIconsUrlMetaFromUrl=e=>Optional.from(nr(e)).filter(isNotEmpty).map(e=>({url:e,name:Optional.none()})),getIconsUrlMetaFromName=(e,t,n)=>Optional.from(t).filter(e=>isNotEmpty(e)&&!ak.has(e)).map(t=>({url:`${e.editorManager.baseURL}/icons/${t}/icons${n}.js`,name:Optional.some(t)})),loadIcons=(e,t,n)=>{let o=getIconsUrlMetaFromName(t,"default",n),a=getIconsUrlMetaFromUrl(t).orThunk(()=>getIconsUrlMetaFromName(t,nn(t),""));each$e(cat([o,a]),n=>{e.add(n.url).catch(()=>{iconsLoadError(t,n.url,n.name.getOrUndefined())})})},loadPlugins=(e,t)=>{let loadPlugin=(t,n)=>{aR.load(t,n).catch(()=>{pluginLoadError(e,n,t)})};each$d(nj(e),(t,n)=>{loadPlugin(n,t),e.options.set("plugins",nq(e).concat(n))}),each$e(nq(e),e=>{(e=eb.trim(e))&&!aR.urls[e]&&!hasSkipLoadPrefix(e)&&loadPlugin(e,`plugins/${e}/plugin${t}.js`)})},isThemeLoaded=e=>{let t=nN(e);return!k(t)||isNonNullable(ax.get(t))},isModelLoaded=e=>{let t=nP(e);return isNonNullable(a$.get(t))},loadScripts=(e,t)=>{let n=ScriptLoader.ScriptLoader,initEditor=()=>{!e.removed&&isThemeLoaded(e)&&isModelLoaded(e)&&init(e)};loadTheme(e,t),loadModel(e,t),loadLanguage(n,e),loadIcons(n,e,t),loadPlugins(e,t),n.loadQueue().then(initEditor,initEditor)},getStyleSheetLoader=(e,t)=>tt.forElement(e,{contentCssCors:nV(t),referrerPolicy:nd(t)}),render=e=>{let t=e.id;tP.setCode(nc(e));let readyHandler=()=>{ls.unbind(window,"ready",readyHandler),e.render()};if(!EventUtils.Event.domLoaded){ls.bind(window,"ready",readyHandler);return}if(!e.getElement())return;let n=eS.fromDom(e.getElement()),o=clone$4(n);e.on("remove",()=>{eachr(n.dom.attributes,e=>remove$a(n,e.name)),setAll$1(n,o)}),e.ui.styleSheetLoader=getStyleSheetLoader(n,e),nI(e)?e.inline=!0:(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden");let a=e.getElement().form||ls.getParent(t,"form");!a||(e.formElement=a,nF(e)&&!ex(e.getElement())&&(ls.insertAfter(ls.create("input",{type:"hidden",name:t}),t),e.hasHiddenInput=!0),e.formEventDelegate=t=>{e.dispatch(t.type,t)},ls.bind(a,"submit reset",e.formEventDelegate),e.on("reset",()=>{e.resetContent()}),!n_(e)||a.submit.nodeType||a.submit.length||a._mceOldSubmit||(a._mceOldSubmit=a.submit,a.submit=()=>(e.editorManager.triggerSave(),e.setDirty(!1),a._mceOldSubmit(a)))),e.windowManager=WindowManager(e),e.notificationManager=NotificationManager(e),isEncodingXml(e)&&e.on("GetContent",e=>{e.save&&(e.content=ls.encode(e.content))}),nL(e)&&e.on("submit",()=>{e.initialized&&e.save()}),nM(e)&&(e._beforeUnload=()=>{!e.initialized||e.destroyed||e.isHidden()||e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),loadScripts(e,e.suffix)},setEditableRoot=(e,t)=>{e._editableRoot!==t&&(e._editableRoot=t,e.readonly||(e.getBody().contentEditable=String(e.hasEditableRoot()),e.nodeChanged()),fireEditableRootStateChange(e,t))},hasEditableRoot=e=>e._editableRoot,sectionResult=(e,t)=>({sections:constant(e),options:constant(t)}),ld=detect$2().deviceType,lc=ld.isPhone(),lm=ld.isTablet(),normalizePlugins=e=>{if(isNullable(e))return[];{let t=S(e)?e:e.split(/[ ,]/),n=map$3(t,U);return filter$5(n,isNotEmpty)}},extractSections=(e,t)=>{let n=bifilter(t,(t,n)=>contains$2(e,n));return sectionResult(n.t,n.f)},getSection=(e,t,n={})=>{let o=e.sections(),a=get$a(o,t).getOr({});return eb.extend({},n,a)},hasSection=(e,t)=>has$2(e.sections(),t),getSectionConfig=(e,t)=>hasSection(e,t)?e.sections()[t]:{},getMobileOverrideOptions=(e,t)=>{let n={table_grid:!1,object_resizing:!1,resize:!1,toolbar_mode:get$a(e,"toolbar_mode").getOr("scrolling"),toolbar_sticky:!1};return{...n,...t?{menubar:!1}:{}}},getExternalPlugins=(e,t)=>{var n;let o=null!==(n=t.external_plugins)&&void 0!==n?n:{};return e&&e.external_plugins?eb.extend({},e.external_plugins,o):o},combinePlugins=(e,t)=>[...normalizePlugins(e),...normalizePlugins(t)],getPlatformPlugins=(e,t,n,o)=>e&&hasSection(t,"mobile")?o:n,processPlugins=(e,t,n,o)=>{let a=normalizePlugins(n.forced_plugins),i=normalizePlugins(o.plugins),l=getSectionConfig(t,"mobile"),s=l.plugins?normalizePlugins(l.plugins):i,d=getPlatformPlugins(e,t,i,s),c=combinePlugins(a,d);return eb.extend(o,{forced_plugins:a,plugins:c})},isOnMobile=(e,t)=>e&&hasSection(t,"mobile"),combineOptions=(e,t,n,o,a)=>{var i;let l=e?{mobile:getMobileOverrideOptions(null!==(i=a.mobile)&&void 0!==i?i:{},t)}:{},s=extractSections(["mobile"],a8(l,a)),d=eb.extend(n,o,s.options(),isOnMobile(e,s)?getSection(s,"mobile"):{},{external_plugins:getExternalPlugins(o,s.options())});return processPlugins(e,s,o,d)},normalizeOptions=(e,t)=>combineOptions(lc||lm,lc,t,e,t),addVisual=(e,t)=>addVisual$1(e,t),registerExecCommands$3=e=>{let toggleFormat=(t,n)=>{e.formatter.toggle(t,n),e.nodeChanged()},toggleAlign=t=>()=>{each$e("left,center,right,justify".split(","),n=>{t!==n&&e.formatter.remove("align"+n)}),"none"!==t&&toggleFormat("align"+t)};e.editorCommands.addCommands({JustifyLeft:toggleAlign("left"),JustifyCenter:toggleAlign("center"),JustifyRight:toggleAlign("right"),JustifyFull:toggleAlign("justify"),JustifyNone:toggleAlign("none")})},registerQueryStateCommands$1=e=>{let alignStates=t=>()=>{let n=e.selection,o=n.isCollapsed()?[e.dom.getParent(n.getNode(),e.dom.isBlock)]:n.getSelectedBlocks();return exists(o,n=>isNonNullable(e.formatter.matchNode(n,t)))};e.editorCommands.addCommands({JustifyLeft:alignStates("alignleft"),JustifyCenter:alignStates("aligncenter"),JustifyRight:alignStates("alignright"),JustifyFull:alignStates("alignjustify")},"state")},registerCommands$b=e=>{registerExecCommands$3(e),registerQueryStateCommands$1(e)},registerCommands$a=e=>{e.editorCommands.addCommands({"Cut,Copy,Paste":t=>{let n;let o=e.getDoc();try{o.execCommand(t)}catch(e){n=!0}if("paste"!==t||o.queryCommandEnabled(t)||(n=!0),n||!o.queryCommandSupported(t)){let t=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");(ef.os.isMacOS()||ef.os.isiOS())&&(t=t.replace(/Ctrl\+/g,"⌘+")),e.notificationManager.open({text:t,type:"error"})}}})},trimOrPadLeftRight=(e,t,n)=>{let o=eS.fromDom(e.getRoot());return n=needsToBeNbspLeft(o,CaretPosition.fromRangeStart(t))?n.replace(/^ /,"&nbsp;"):n.replace(/^&nbsp;/," "),n=needsToBeNbspRight(o,CaretPosition.fromRangeEnd(t))?n.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):n.replace(/&nbsp;(<br( \/)?>)?$/," ")},processValue$1=e=>{if("string"!=typeof e){let t=eb.extend({paste:e.paste,data:{paste:e.paste}},e);return{content:e.content,details:t}}return{content:e,details:{}}},trimOrPad=(e,t)=>{let n=e.selection,o=e.dom;return/^ | $/.test(t)?trimOrPadLeftRight(o,n.getRng(),t):t},insertAtCaret=(e,t)=>{if(e.selection.isEditable()){let{content:n,details:o}=processValue$1(t);preProcessSetContent(e,{...o,content:trimOrPad(e,n),format:"html",set:!1,selection:!0}).each(t=>{let n=insertContent$1(e,t.content,o);postProcessSetContent(e,n,t),e.addVisual()})}},registerCommands$9=e=>{e.editorCommands.addCommands({mceCleanup:()=>{let t=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(t)},insertImage:(t,n,o)=>{insertAtCaret(e,e.dom.createHTML("img",{src:o}))},insertHorizontalRule:()=>{e.execCommand("mceInsertContent",!1,"<hr>")},insertText:(t,n,o)=>{insertAtCaret(e,e.dom.encode(o))},insertHTML:(t,n,o)=>{insertAtCaret(e,o)},mceInsertContent:(t,n,o)=>{insertAtCaret(e,o)},mceSetContent:(t,n,o)=>{e.setContent(o)},mceReplaceContent:(t,n,o)=>{e.execCommand("mceInsertContent",!1,o.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceNewDocument:()=>{e.setContent(n9(e))}})},lu={"font-size":"size","font-family":"face"},lp=isTag("font"),getSpecifiedFontProp=(e,t,n)=>{let getProperty=t=>getRaw(t,e).orThunk(()=>lp(t)?get$a(lu,e).bind(e=>getOpt(t,e)):Optional.none());return closest$1(eS.fromDom(n),e=>getProperty(e),e=>eq(eS.fromDom(t),e))},getComputedFontProp=(e,t)=>Optional.from(DOMUtils.DOM.getStyle(t,e,!0)),getFontProp=e=>(t,n)=>Optional.from(n).map(eS.fromDom).filter(ev).bind(n=>getSpecifiedFontProp(e,t,n.dom).or(getComputedFontProp(e,n.dom))).getOr(""),lg=getFontProp("font-size"),lf=compose(e=>e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,","),getFontProp("font-family")),findFirstCaretElement=e=>r$(e.getBody()).bind(e=>{let t=e.container();return Optional.from(ew(t)?t.parentNode:t)}),getCaretElement=e=>Optional.from(e.selection.getRng()).bind(t=>{let n=e.getBody(),o=t.startContainer===n&&0===t.startOffset;return o?Optional.none():Optional.from(e.selection.getStart(!0))}),bindRange=(e,t)=>getCaretElement(e).orThunk(curry(findFirstCaretElement,e)).map(eS.fromDom).filter(ev).bind(t),mapRange=(e,t)=>bindRange(e,compose1(Optional.some,t)),fromFontSizeNumber=(e,t)=>{if(!/^[0-9.]+$/.test(t))return t;{let n=parseInt(t,10);if(!(n>=1)||!(n<=7))return t;{let o=getFontStyleValues(e),a=getFontSizeClasses(e);return a.length>0?a[n-1]||t:o[n-1]||t}}},normalizeFontNames=e=>{let t=e.split(/\s*,\s*/);return map$3(t,e=>-1===e.indexOf(" ")||startsWith(e,'"')||startsWith(e,"'")?e:`'${e}'`).join(",")},fontNameAction=(e,t)=>{let n=fromFontSizeNumber(e,t);e.formatter.toggle("fontname",{value:normalizeFontNames(n)}),e.nodeChanged()},fontNameQuery=e=>mapRange(e,t=>lf(e.getBody(),t.dom)).getOr(""),fontSizeAction=(e,t)=>{e.formatter.toggle("fontsize",{value:fromFontSizeNumber(e,t)}),e.nodeChanged()},fontSizeQuery=e=>mapRange(e,t=>lg(e.getBody(),t.dom)).getOr(""),lineHeightQuery=e=>mapRange(e,t=>{let n=eS.fromDom(e.getBody()),o=closest$1(t,e=>getRaw(e,"line-height"),curry(eq,n));return o.getOrThunk(()=>{let e=parseFloat(get$7(t,"line-height")),n=parseFloat(get$7(t,"font-size"));return String(e/n)})}).getOr(""),lineHeightAction=(e,t)=>{e.formatter.toggle("lineheight",{value:String(t)}),e.nodeChanged()},registerExecCommands$2=e=>{let toggleFormat=(t,n)=>{e.formatter.toggle(t,n),e.nodeChanged()};e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":e=>{toggleFormat(e)},"ForeColor,HiliteColor":(e,t,n)=>{toggleFormat(e,{value:n})},BackColor:(e,t,n)=>{toggleFormat("hilitecolor",{value:n})},FontName:(t,n,o)=>{fontNameAction(e,o)},FontSize:(t,n,o)=>{fontSizeAction(e,o)},LineHeight:(t,n,o)=>{lineHeightAction(e,o)},Lang:(e,t,n)=>{var o;toggleFormat(e,{value:n.code,customValue:null!==(o=n.customCode)&&void 0!==o?o:null})},RemoveFormat:t=>{e.formatter.remove(t)},mceBlockQuote:()=>{toggleFormat("blockquote")},FormatBlock:(e,t,n)=>{toggleFormat(k(n)?n:"p")},mceToggleFormat:(e,t,n)=>{toggleFormat(n)}})},registerQueryValueCommands=e=>{let isFormatMatch=t=>e.formatter.match(t);e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":e=>isFormatMatch(e),mceBlockQuote:()=>isFormatMatch("blockquote")},"state"),e.editorCommands.addQueryValueHandler("FontName",()=>fontNameQuery(e)),e.editorCommands.addQueryValueHandler("FontSize",()=>fontSizeQuery(e)),e.editorCommands.addQueryValueHandler("LineHeight",()=>lineHeightQuery(e))},registerCommands$8=e=>{registerExecCommands$2(e),registerQueryValueCommands(e)},registerCommands$7=e=>{e.editorCommands.addCommands({mceAddUndoLevel:()=>{e.undoManager.add()},mceEndUndoLevel:()=>{e.undoManager.add()},Undo:()=>{e.undoManager.undo()},Redo:()=>{e.undoManager.redo()}})},registerCommands$6=e=>{e.editorCommands.addCommands({Indent:()=>{indent(e)},Outdent:()=>{outdent(e)}}),e.editorCommands.addCommands({Outdent:()=>canOutdent(e)},"state")},registerCommands$5=e=>{let applyLinkToSelection=(t,n,o)=>{let a=k(o)?{href:o}:o,i=e.dom.getParent(e.selection.getNode(),"a");$(a)&&k(a.href)&&(a.href=a.href.replace(/ /g,"%20"),i&&a.href||e.formatter.remove("link"),a.href&&e.formatter.apply("link",a,i))};e.editorCommands.addCommands({unlink:()=>{if(e.selection.isEditable()){if(e.selection.isCollapsed()){let t=e.dom.getParent(e.selection.getStart(),"a");t&&e.dom.remove(t,!0);return}e.formatter.remove("link")}},mceInsertLink:applyLinkToSelection,createLink:applyLinkToSelection})},registerExecCommands$1=e=>{e.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":t=>{e.getDoc().execCommand(t);let n=e.dom.getParent(e.selection.getNode(),"ol,ul");if(n){let t=n.parentNode;if(t&&/^(H[1-6]|P|ADDRESS|PRE)$/.test(t.nodeName)){let o=e.selection.getBookmark();e.dom.split(t,n),e.selection.moveToBookmark(o)}}}})},registerQueryStateCommands=e=>{e.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":t=>{let n=e.dom.getParent(e.selection.getNode(),"ul,ol");return n&&("insertunorderedlist"===t&&"UL"===n.tagName||"insertorderedlist"===t&&"OL"===n.tagName)}},"state")},registerCommands$4=e=>{registerExecCommands$1(e),registerQueryStateCommands(e)},getTopParentBlock=(e,t,n,o)=>{let a=e.dom,selector=e=>a.isBlock(e)&&e.parentElement===n,i=selector(t)?t:a.getParent(o,selector,n);return Optional.from(i).map(eS.fromDom)},insert=(e,t)=>{let n=e.dom,o=e.selection.getRng(),a=t?e.selection.getStart():e.selection.getEnd(),i=t?o.startContainer:o.endContainer,l=getEditableRoot(n,i);if(!l||!l.isContentEditable)return;let s=t?before$3:after$4,d=t2(e);getTopParentBlock(e,a,l,i).each(t=>{let n=createNewBlock(e,i,t.dom,l,!1,d);s(t,eS.fromDom(n)),e.selection.setCursorLocation(n,0),e.dispatch("NewBlock",{newBlock:n}),iw(e,"insertParagraph")})},insertBefore=e=>insert(e,!0),insertAfter=e=>insert(e,!1),registerCommands$3=e=>{e.editorCommands.addCommands({InsertNewBlockBefore:()=>{insertBefore(e)},InsertNewBlockAfter:()=>{insertAfter(e)}})},registerCommands$2=e=>{e.editorCommands.addCommands({insertParagraph:()=>{insertBreak(i_,e)},mceInsertNewLine:(t,n,o)=>{insert$1(e,o)},InsertLineBreak:(t,n,o)=>{insertBreak(iL,e)}})},registerCommands$1=e=>{e.editorCommands.addCommands({mceSelectNodeDepth:(t,n,o)=>{let a=0;e.dom.getParent(e.selection.getNode(),t=>!eR(t)||a++!==o||(e.selection.select(t),!1),e.getBody())},mceSelectNode:(t,n,o)=>{e.selection.select(o)},selectAll:()=>{let t=e.dom.getParent(e.selection.getStart(),eL);if(t){let n=e.dom.createRng();n.selectNodeContents(t),e.selection.setRng(n)}}})},registerExecCommands=e=>{e.editorCommands.addCommands({mceRemoveNode:(t,n,o)=>{let a=null!=o?o:e.selection.getNode();if(a!==e.getBody()){let t=e.selection.getBookmark();e.dom.remove(a,!0),e.selection.moveToBookmark(t)}},mcePrint:()=>{e.getWin().print()},mceFocus:(t,n,o)=>{focus(e,!0===o)},mceToggleVisualAid:()=>{e.hasVisual=!e.hasVisual,e.addVisual()}})},registerCommands=e=>{registerCommands$b(e),registerCommands$a(e),registerCommands$7(e),registerCommands$1(e),registerCommands$9(e),registerCommands$5(e),registerCommands$6(e),registerCommands$3(e),registerCommands$2(e),registerCommands$4(e),registerCommands$8(e),registerExecCommands(e)},lh=["toggleview"],isSelectionSafeCommand=e=>contains$2(lh,e.toLowerCase());let EditorCommands=class EditorCommands{constructor(e){this.commands={state:{},exec:{},value:{}},this.editor=e}execCommand(e,t=!1,n,o){let a=this.editor,i=e.toLowerCase(),l=null==o?void 0:o.skip_focus;if(a.removed)return!1;"mcefocus"!==i&&(/^(mceAddUndoLevel|mceEndUndoLevel)$/i.test(i)||l?restore(a):a.focus());let s=a.dispatch("BeforeExecCommand",{command:e,ui:t,value:n});if(s.isDefaultPrevented())return!1;let d=this.commands.exec[i];return!!R(d)&&(d(i,t,n),a.dispatch("ExecCommand",{command:e,ui:t,value:n}),!0)}queryCommandState(e){if(!isSelectionSafeCommand(e)&&this.editor.quirks.isHidden()||this.editor.removed)return!1;let t=e.toLowerCase(),n=this.commands.state[t];return!!R(n)&&n(t)}queryCommandValue(e){if(!isSelectionSafeCommand(e)&&this.editor.quirks.isHidden()||this.editor.removed)return"";let t=e.toLowerCase(),n=this.commands.value[t];return R(n)?n(t):""}addCommands(e,t="exec"){let n=this.commands;each$d(e,(e,o)=>{each$e(o.toLowerCase().split(","),o=>{n[t][o]=e})})}addCommand(e,t,n){let o=e.toLowerCase();this.commands.exec[o]=(e,o,a)=>t.call(null!=n?n:this.editor,o,a)}queryCommandSupported(e){let t=e.toLowerCase();return!!this.commands.exec[t]}addQueryStateHandler(e,t,n){this.commands.state[e.toLowerCase()]=()=>t.call(null!=n?n:this.editor)}addQueryValueHandler(e,t,n){this.commands.value[e.toLowerCase()]=()=>t.call(null!=n?n:this.editor)}};let lb="data-mce-contenteditable",toggleClass=(e,t,n)=>{has(e,t)&&!n?remove$7(e,t):n&&add$2(e,t)},setEditorCommandState=(e,t,n)=>{try{e.getDoc().execCommand(t,!1,String(n))}catch(e){}},setContentEditable=(e,t)=>{e.dom.contentEditable=t?"true":"false"},switchOffContentEditableTrue=e=>{each$e(descendants(e,'*[contenteditable="true"]'),e=>{set$3(e,lb,"true"),setContentEditable(e,!1)})},switchOnContentEditableTrue=e=>{each$e(descendants(e,`*[${lb}="true"]`),e=>{remove$a(e,lb),setContentEditable(e,!0)})},removeFakeSelection=e=>{Optional.from(e.selection.getNode()).each(e=>{e.removeAttribute("data-mce-selected")})},restoreFakeSelection=e=>{e.selection.setRng(e.selection.getRng())},toggleReadOnly=(e,t)=>{let n=eS.fromDom(e.getBody());toggleClass(n,"mce-content-readonly",t),t?(e.selection.controlSelection.hideResizeRect(),e._selectionOverrides.hideFakeCaret(),removeFakeSelection(e),e.readonly=!0,setContentEditable(n,!1),switchOffContentEditableTrue(n)):(e.readonly=!1,e.hasEditableRoot()&&setContentEditable(n,!0),switchOnContentEditableTrue(n),setEditorCommandState(e,"StyleWithCSS",!1),setEditorCommandState(e,"enableInlineTableEditing",!1),setEditorCommandState(e,"enableObjectResizing",!1),hasEditorOrUiFocus(e)&&e.focus(),restoreFakeSelection(e),e.nodeChanged())},isReadOnly=e=>e.readonly,registerFilters=e=>{e.parser.addAttributeFilter("contenteditable",t=>{isReadOnly(e)&&each$e(t,e=>{e.attr(lb,e.attr("contenteditable")),e.attr("contenteditable","false")})}),e.serializer.addAttributeFilter(lb,t=>{isReadOnly(e)&&each$e(t,e=>{e.attr("contenteditable",e.attr(lb))})}),e.serializer.addTempAttr(lb)},registerReadOnlyContentFilters=e=>{e.serializer?registerFilters(e):e.on("PreInit",()=>{registerFilters(e)})},isClickEvent=e=>"click"===e.type,lC=["copy"],isReadOnlyAllowedEvent=e=>contains$2(lC,e.type),getAnchorHrefOpt=(e,t)=>closest$3(t,"a",t=>eq(t,eS.fromDom(e.getBody()))).bind(e=>getOpt(e,"href")),processReadonlyEvents=(e,t)=>{if(isClickEvent(t)&&!rx.metaKeyPressed(t)){let n=eS.fromDom(t.target);getAnchorHrefOpt(e,n).each(n=>{if(t.preventDefault(),/^#/.test(n)){let t=e.dom.select(`${n},[name="${removeLeading(n,"#")}"]`);t.length&&e.selection.scrollIntoView(t[0],!0)}else window.open(n,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")})}else isReadOnlyAllowedEvent(t)&&e.dispatch(t.type,t)},registerReadOnlySelectionBlockers=e=>{e.on("ShowCaret",t=>{isReadOnly(e)&&t.preventDefault()}),e.on("ObjectSelected",t=>{isReadOnly(e)&&t.preventDefault()})},ly=eb.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," ");let EventDispatcher=class EventDispatcher{static isNative(e){return!!ly[e.toLowerCase()]}constructor(e){this.bindings={},this.settings=e||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||w}fire(e,t){return this.dispatch(e,t)}dispatch(e,t){let n=e.toLowerCase(),o=normalize$3(n,null!=t?t:{},this.scope);this.settings.beforeFire&&this.settings.beforeFire(o);let a=this.bindings[n];if(a)for(let e=0,t=a.length;e<t;e++){let t=a[e];if(!t.removed){if(t.once&&this.off(n,t.func),o.isImmediatePropagationStopped())break;if(!1===t.func.call(this.scope,o)){o.preventDefault();break}}}return o}on(e,t,n,o){if(!1===t&&(t=w),t){let a={func:t,removed:!1};o&&eb.extend(a,o);let i=e.toLowerCase().split(" "),l=i.length;for(;l--;){let e=i[l],t=this.bindings[e];t||(t=[],this.toggleEvent(e,!0)),t=n?[a,...t]:[...t,a],this.bindings[e]=t}}return this}off(e,t){if(e){let n=e.toLowerCase().split(" "),o=n.length;for(;o--;){let a=n[o],i=this.bindings[a];if(!a){each$d(this.bindings,(e,t)=>{this.toggleEvent(t,!1),delete this.bindings[t]});break}if(i){if(t){let e=partition$2(i,e=>e.func===t);i=e.fail,this.bindings[a]=i,each$e(e.pass,e=>{e.removed=!0})}else i.length=0;i.length||(this.toggleEvent(e,!1),delete this.bindings[a])}}}else each$d(this.bindings,(e,t)=>{this.toggleEvent(t,!1)}),this.bindings={};return this}once(e,t,n){return this.on(e,t,n,{once:!0})}has(e){e=e.toLowerCase();let t=this.bindings[e];return!(!t||0===t.length)}};let getEventDispatcher=e=>(e._eventDispatcher||(e._eventDispatcher=new EventDispatcher({scope:e,toggleEvent:(t,n)=>{EventDispatcher.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}})),e._eventDispatcher),lv={fire(e,t,n){return this.dispatch(e,t,n)},dispatch(e,t,n){if(this.removed&&"remove"!==e&&"detach"!==e)return normalize$3(e.toLowerCase(),null!=t?t:{},this);let o=getEventDispatcher(this).dispatch(e,t);if(!1!==n&&this.parent){let t=this.parent();for(;t&&!o.isPropagationStopped();)t.dispatch(e,o,!1),t=t.parent?t.parent():void 0}return o},on(e,t,n){return getEventDispatcher(this).on(e,t,n)},off(e,t){return getEventDispatcher(this).off(e,t)},once(e,t){return getEventDispatcher(this).once(e,t)},hasEventListeners(e){return getEventDispatcher(this).has(e)}},lE=DOMUtils.DOM,getEventTarget=(e,t)=>{if("selectionchange"===t)return e.getDoc();if(!e.inline&&/^(?:mouse|touch|click|contextmenu|drop|dragover|dragend)/.test(t))return e.getDoc().documentElement;let n=n$(e);return n?(e.eventRoot||(e.eventRoot=lE.select(n)[0]),e.eventRoot):e.getBody()},isListening=e=>!e.hidden&&!isReadOnly(e),fireEvent=(e,t,n)=>{isListening(e)?e.dispatch(t,n):isReadOnly(e)&&processReadonlyEvents(e,n)},bindEventDelegate=(e,n)=>{if(e.delegates||(e.delegates={}),e.delegates[n]||e.removed)return;let o=getEventTarget(e,n);if(n$(e)){if(t||(t={},e.editorManager.on("removeEditor",()=>{!e.editorManager.activeEditor&&t&&(each$d(t,(t,n)=>{e.dom.unbind(getEventTarget(e,n))}),t=null)})),t[n])return;let delegate=t=>{let o=t.target,a=e.editorManager.get(),i=a.length;for(;i--;){let e=a[i].getBody();(e===o||lE.isChildOf(o,e))&&fireEvent(a[i],n,t)}};t[n]=delegate,lE.bind(o,n,delegate)}else{let delegate=t=>{fireEvent(e,n,t)};lE.bind(o,n,delegate),e.delegates[n]=delegate}},lk={...lv,bindPendingEventDelegates(){let e=this;eb.each(e._pendingNativeEvents,t=>{bindEventDelegate(e,t)})},toggleNativeEvent(e,t){"focus"!==e&&"blur"!==e&&!this.removed&&(t?this.initialized?bindEventDelegate(this,e):this._pendingNativeEvents?this._pendingNativeEvents.push(e):this._pendingNativeEvents=[e]:this.initialized&&this.delegates&&(this.dom.unbind(getEventTarget(this,e),e,this.delegates[e]),delete this.delegates[e]))},unbindAllNativeEvents(){let e=this,t=e.getBody(),n=e.dom;e.delegates&&(each$d(e.delegates,(t,n)=>{e.dom.unbind(getEventTarget(e,n),n,t)}),delete e.delegates),!e.inline&&t&&n&&(t.onload=null,n.unbind(e.getWin()),n.unbind(e.getDoc())),n&&(n.unbind(t),n.unbind(e.getContainer()))}},stringListProcessor=e=>k(e)?{value:e.split(/[ ,]/),valid:!0}:isArrayOf(e,k)?{value:e,valid:!0}:{valid:!1,message:"The value must be a string[] or a comma/space separated string."},getBuiltInProcessor=e=>{let t=(()=>{switch(e){case"array":return S;case"boolean":return O;case"function":return R;case"number":return x;case"object":return $;case"string":return k;case"string[]":return stringListProcessor;case"object[]":return e=>isArrayOf(e,$);case"regexp":return e=>is$4(e,RegExp);default:return A}})();return n=>processValue(n,t,`The value must be a ${e}.`)},isBuiltInSpec=e=>k(e.processor),getErrorMessage=(e,t)=>{let n=isEmpty$3(t.message)?"":`. ${t.message}`;return e+n},isValidResult=e=>e.valid,processValue=(e,t,n="")=>{let o=t(e);return O(o)?o?{value:e,valid:!0}:{valid:!1,message:n}:o},processDefaultValue=(e,t,n)=>{if(!P(t)){let o=processValue(t,n);if(isValidResult(o))return o.value;console.error(getErrorMessage(`Invalid default value passed for the "${e}" option`,o))}},create$5=(e,t)=>{let n={},o={},setValue=(e,t,n)=>{let a=processValue(t,n);return isValidResult(a)?(o[e]=a.value,!0):(console.warn(getErrorMessage(`Invalid value passed for the ${e} option`,a)),!1)},isRegistered=e=>has$2(n,e);return{register:(e,a)=>{let i=isBuiltInSpec(a)?getBuiltInProcessor(a.processor):a.processor,l=processDefaultValue(e,a.default,i);n[e]={...a,default:l,processor:i};let s=get$a(o,e).orThunk(()=>get$a(t,e));s.each(t=>setValue(e,t,i))},isRegistered,get:e=>get$a(o,e).orThunk(()=>get$a(n,e).map(e=>e.default)).getOrUndefined(),set:(e,t)=>{if(!isRegistered(e))return console.warn(`"${e}" is not a registered option. Ensure the option has been registered before setting a value.`),!1;{let o=n[e];return o.immutable?(console.error(`"${e}" is an immutable option and cannot be updated`),!1):setValue(e,t,o.processor)}},unset:e=>{let t=isRegistered(e);return t&&delete o[e],t},isSet:e=>has$2(o,e)}},l$=["design","readonly"],switchToMode=(e,t,n,o)=>{let a=n[t.get()],i=n[o];try{i.activate()}catch(e){console.error(`problem while activating editor mode ${o}:`,e);return}a.deactivate(),a.editorReadOnly!==i.editorReadOnly&&toggleReadOnly(e,i.editorReadOnly),t.set(o),fireSwitchMode(e,o)},setMode=(e,t,n,o)=>{if(o!==n.get()){if(!has$2(t,o))throw Error(`Editor mode '${o}' is invalid`);e.initialized?switchToMode(e,n,t,o):e.on("init",()=>switchToMode(e,n,t,o))}},registerMode=(e,t,n)=>{if(contains$2(l$,t))throw Error(`Cannot override default mode ${t}`);return{...e,[t]:{...n,deactivate:()=>{try{n.deactivate()}catch(e){console.error(`problem while deactivating editor mode ${t}:`,e)}}}}},create$4=e=>{let t=Cell("design"),n=Cell({design:{activate:noop,deactivate:noop,editorReadOnly:!1},readonly:{activate:noop,deactivate:noop,editorReadOnly:!0}});return registerReadOnlyContentFilters(e),registerReadOnlySelectionBlockers(e),{isReadOnly:()=>isReadOnly(e),set:o=>setMode(e,n.get(),t,o),get:()=>t.get(),register:(e,t)=>{n.set(registerMode(n.get(),e,t))}}},lS=eb.each,lN=eb.explode,lO={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},lP=eb.makeMap("alt,ctrl,shift,meta,access"),isModifier=e=>e in lP,parseShortcut=e=>{let t;let n={},o=ef.os.isMacOS()||ef.os.isiOS();lS(lN(e.toLowerCase(),"+"),e=>{isModifier(e)?n[e]=!0:/^[0-9]{2,}$/.test(e)?n.keyCode=parseInt(e,10):(n.charCode=e.charCodeAt(0),n.keyCode=lO[e]||e.toUpperCase().charCodeAt(0))});let a=[n.keyCode];for(t in lP)n[t]?a.push(t):n[t]=!1;return n.id=a.join(","),n.access&&(n.alt=!0,o?n.ctrl=!0:n.shift=!0),n.meta&&(o?n.meta=!0:(n.ctrl=!0,n.meta=!1)),n};let Shortcuts=class Shortcuts{constructor(e){this.shortcuts={},this.pendingPatterns=[],this.editor=e;let t=this;e.on("keyup keypress keydown",e=>{(t.hasModifier(e)||t.isFunctionKey(e))&&!e.isDefaultPrevented()&&(lS(t.shortcuts,n=>{t.matchShortcut(e,n)&&(t.pendingPatterns=n.subpatterns.slice(0),"keydown"===e.type&&t.executeShortcutAction(n))}),t.matchShortcut(e,t.pendingPatterns[0])&&(1===t.pendingPatterns.length&&"keydown"===e.type&&t.executeShortcutAction(t.pendingPatterns[0]),t.pendingPatterns.shift()))})}add(e,t,n,o){let a=this,i=a.normalizeCommandFunc(n);return lS(lN(eb.trim(e)),e=>{let n=a.createShortcut(e,t,i,o);a.shortcuts[n.id]=n}),!0}remove(e){let t=this.createShortcut(e);return!!this.shortcuts[t.id]&&(delete this.shortcuts[t.id],!0)}normalizeCommandFunc(e){let t=this;return"string"==typeof e?()=>{t.editor.execCommand(e,!1,null)}:eb.isArray(e)?()=>{t.editor.execCommand(e[0],e[1],e[2])}:e}createShortcut(e,t,n,o){let a=eb.map(lN(e,">"),parseShortcut);return a[a.length-1]=eb.extend(a[a.length-1],{func:n,scope:o||this.editor}),eb.extend(a[0],{desc:this.editor.translate(t),subpatterns:a.slice(1)})}hasModifier(e){return e.altKey||e.ctrlKey||e.metaKey}isFunctionKey(e){return"keydown"===e.type&&e.keyCode>=112&&e.keyCode<=123}matchShortcut(e,t){return!!t&&t.ctrl===e.ctrlKey&&t.meta===e.metaKey&&t.alt===e.altKey&&t.shift===e.shiftKey&&(e.keyCode===t.keyCode||!!e.charCode&&e.charCode===t.charCode)&&(e.preventDefault(),!0)}executeShortcutAction(e){return e.func?e.func.call(e.scope):null}};let create$3=()=>{let e={},t={},n={},o={},a={},i={},l={},s={},add=(e,t)=>(n,o)=>{e[n.toLowerCase()]={...o,type:t}};return{addButton:add(e,"button"),addGroupToolbarButton:add(e,"grouptoolbarbutton"),addToggleButton:add(e,"togglebutton"),addMenuButton:add(e,"menubutton"),addSplitButton:add(e,"splitbutton"),addMenuItem:add(t,"menuitem"),addNestedMenuItem:add(t,"nestedmenuitem"),addToggleMenuItem:add(t,"togglemenuitem"),addAutocompleter:add(n,"autocompleter"),addContextMenu:add(a,"contextmenu"),addContextToolbar:add(i,"contexttoolbar"),addContextForm:add(i,"contextform"),addSidebar:add(l,"sidebar"),addView:add(s,"views"),addIcon:(e,t)=>o[e.toLowerCase()]=t,getAll:()=>({buttons:e,menuItems:t,icons:o,popups:n,contextMenus:a,contextToolbars:i,sidebars:l,views:s})}},registry=()=>{let e=create$3();return{addAutocompleter:e.addAutocompleter,addButton:e.addButton,addContextForm:e.addContextForm,addContextMenu:e.addContextMenu,addContextToolbar:e.addContextToolbar,addIcon:e.addIcon,addMenuButton:e.addMenuButton,addMenuItem:e.addMenuItem,addNestedMenuItem:e.addNestedMenuItem,addSidebar:e.addSidebar,addSplitButton:e.addSplitButton,addToggleButton:e.addToggleButton,addGroupToolbarButton:e.addGroupToolbarButton,addToggleMenuItem:e.addToggleMenuItem,addView:e.addView,getAll:e.getAll}},lR=DOMUtils.DOM,lx=eb.extend,lw=eb.each;let Editor=class Editor{constructor(e,t,n){this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.composing=!1,this.destroyed=!1,this.hasHiddenInput=!1,this.iframeElement=null,this.initialized=!1,this.readonly=!1,this.removed=!1,this.startContent="",this._pendingNativeEvents=[],this._skinLoaded=!1,this._editableRoot=!0,this.editorManager=n,this.documentBaseUrl=n.documentBaseURL,lx(this,lk),this.id=e,this.hidden=!1;let o=normalizeOptions(n.defaultOptions,t);this.options=create$5(this,o),register$7(this);let a=this.options.get;a("deprecation_warnings")&&logWarnings(t,o);let i=a("suffix");i&&(n.suffix=i),this.suffix=n.suffix;let l=a("base_url");l&&n._setBaseUrl(l),this.baseUri=n.baseURI;let s=nd(this);s&&(ScriptLoader.ScriptLoader._setReferrerPolicy(s),DOMUtils.DOM.styleSheetLoader._setReferrerPolicy(s));let d=nV(this);isNonNullable(d)&&DOMUtils.DOM.styleSheetLoader._setContentCssCors(d),AddOnManager.languageLoad=a("language_load"),AddOnManager.baseURL=n.baseURL,this.setDirty(!1),this.documentBaseURI=new URI(tZ(this),{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=nI(this),this.hasVisual=nG(this),this.shortcuts=new Shortcuts(this),this.editorCommands=new EditorCommands(this),registerCommands(this);let c=a("cache_suffix");c&&(ef.cacheSuffix=c.replace(/^[\?\&]+/,"")),this.ui={registry:registry(),styleSheetLoader:void 0,show:noop,hide:noop,setEnabled:noop,isEnabled:A},this.mode=create$4(this),n.dispatch("SetupEditor",{editor:this});let m=nQ(this);R(m)&&m.call(this,this)}render(){render(this)}focus(e){this.execCommand("mceFocus",!1,e)}hasFocus(){return hasFocus(this)}translate(e){return tP.translate(e)}getParam(e,t,n){let o=this.options;return o.isRegistered(e)||(isNonNullable(n)?o.register(e,{processor:n,default:t}):o.register(e,{processor:A,default:t})),o.isSet(e)||P(t)?o.get(e):t}hasPlugin(e,t){let n=contains$2(nq(this),e);return!!n&&(!t||void 0!==aR.get(e))}nodeChanged(e){this._nodeChangeDispatcher.nodeChanged(e)}addCommand(e,t,n){this.editorCommands.addCommand(e,t,n)}addQueryStateHandler(e,t,n){this.editorCommands.addQueryStateHandler(e,t,n)}addQueryValueHandler(e,t,n){this.editorCommands.addQueryValueHandler(e,t,n)}addShortcut(e,t,n,o){this.shortcuts.add(e,t,n,o)}execCommand(e,t,n,o){return this.editorCommands.execCommand(e,t,n,o)}queryCommandState(e){return this.editorCommands.queryCommandState(e)}queryCommandValue(e){return this.editorCommands.queryCommandValue(e)}queryCommandSupported(e){return this.editorCommands.queryCommandSupported(e)}show(){this.hidden&&(this.hidden=!1,this.inline?this.getBody().contentEditable="true":(lR.show(this.getContainer()),lR.hide(this.id)),this.load(),this.dispatch("show"))}hide(){this.hidden||(this.save(),this.inline?(this.getBody().contentEditable="false",this===this.editorManager.focusedEditor&&(this.editorManager.focusedEditor=null)):(lR.hide(this.getContainer()),lR.setStyle(this.id,"display",this.orgDisplay)),this.hidden=!0,this.dispatch("hide"))}isHidden(){return this.hidden}setProgressState(e,t){this.dispatch("ProgressState",{state:e,time:t})}load(e={}){let t=this.getElement();if(this.removed||!t)return"";{let n={...e,load:!0},o=ex(t)?t.value:t.innerHTML,a=this.setContent(o,n);return n.no_events||this.dispatch("LoadContent",{...n,element:t}),a}}save(e={}){let t=this,n=t.getElement();if(!n||!t.initialized||t.removed)return"";let o={...e,save:!0,element:n},a=t.getContent(o),i={...o,content:a};if(i.no_events||t.dispatch("SaveContent",i),"raw"===i.format&&t.dispatch("RawSaveContent",i),a=i.content,ex(n))n.value=a;else{(e.is_removing||!t.inline)&&(n.innerHTML=a);let o=lR.getParent(t.id,"form");o&&lw(o.elements,e=>e.name!==t.id||(e.value=a,!1))}return i.element=o.element=n=null,!1!==i.set_dirty&&t.setDirty(!1),a}setContent(e,t){return setContent(this,e,t)}getContent(e){return getContent(this,e)}insertContent(e,t){t&&(e=lx({content:e},t)),this.execCommand("mceInsertContent",!1,e)}resetContent(e){void 0===e?setContent(this,this.startContent,{format:"raw"}):setContent(this,e),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()}isDirty(){return!this.isNotDirty}setDirty(e){let t=!this.isNotDirty;this.isNotDirty=!e,e&&e!==t&&this.dispatch("dirty")}getContainer(){return this.container||(this.container=this.editorContainer||lR.get(this.id+"_parent")),this.container}getContentAreaContainer(){return this.contentAreaContainer}getElement(){return this.targetElm||(this.targetElm=lR.get(this.id)),this.targetElm}getWin(){if(!this.contentWindow){let e=this.iframeElement;e&&(this.contentWindow=e.contentWindow)}return this.contentWindow}getDoc(){if(!this.contentDocument){let e=this.getWin();e&&(this.contentDocument=e.document)}return this.contentDocument}getBody(){var e,t;let n=this.getDoc();return null!==(t=null!==(e=this.bodyElement)&&void 0!==e?e:null==n?void 0:n.body)&&void 0!==t?t:null}convertURL(e,t,n){let o=this.options.get,a=n0(this);return R(a)?a.call(this,e,n,!0,t):!o("convert_urls")||"link"===n||$(n)&&"LINK"===n.nodeName||0===e.indexOf("file:")||0===e.length?e:o("relative_urls")?this.documentBaseURI.toRelative(e):e=this.documentBaseURI.toAbsolute(e,o("remove_script_host"))}addVisual(e){addVisual(this,e)}setEditableRoot(e){setEditableRoot(this,e)}hasEditableRoot(){return hasEditableRoot(this)}remove(){remove$1(this)}destroy(e){destroy(this,e)}uploadImages(){return this.editorUpload.uploadImages()}_scanForImages(){return this.editorUpload.scanForImages()}};let lA=DOMUtils.DOM,lT=eb.each,lB=!1,lD=[],globalEventDelegate=e=>{let t=e.type;lT(lF.get(),n=>{switch(t){case"scroll":n.dispatch("ScrollWindow",e);break;case"resize":n.dispatch("ResizeWindow",e)}})},toggleGlobalEvents=e=>{if(e!==lB){let t=DOMUtils.DOM;e?(t.bind(window,"resize",globalEventDelegate),t.bind(window,"scroll",globalEventDelegate)):(t.unbind(window,"resize",globalEventDelegate),t.unbind(window,"scroll",globalEventDelegate)),lB=e}},removeEditorFromList=e=>{let t=lD;return lD=filter$5(lD,t=>e!==t),lF.activeEditor===e&&(lF.activeEditor=lD.length>0?lD[0]:null),lF.focusedEditor===e&&(lF.focusedEditor=null),t.length!==lD.length},purgeDestroyedEditor=e=>{e&&e.initialized&&!(e.getContainer()||e.getBody()).parentNode&&(removeEditorFromList(e),e.unbindAllNativeEvents(),e.destroy(!0),e.removed=!0)},lI="CSS1Compat"!==document.compatMode,lF={...lv,baseURI:null,baseURL:null,defaultOptions:{},documentBaseURL:null,suffix:null,majorVersion:"6",minorVersion:"7.2",releaseDate:"2023-10-25",i18n:tP,activeEditor:null,focusedEditor:null,setup(){let e="",t="",n=URI.getDocumentBaseUrl(document.location);/^[^:]+:\/\/\/?[^\/]+\//.test(n)&&(n=n.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(n)||(n+="/"));let o=window.tinymce||window.tinyMCEPreInit;if(o)e=o.base||o.baseURL,t=o.suffix;else{let n=document.getElementsByTagName("script");for(let o=0;o<n.length;o++){let a=n[o].src||"";if(""===a)continue;let i=a.substring(a.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(a)){-1!==i.indexOf(".min")&&(t=".min"),e=a.substring(0,a.lastIndexOf("/"));break}}if(!e&&document.currentScript){let n=document.currentScript.src;-1!==n.indexOf(".min")&&(t=".min"),e=n.substring(0,n.lastIndexOf("/"))}}this.baseURL=new URI(n).toAbsolute(e),this.documentBaseURL=n,this.baseURI=new URI(this.baseURL),this.suffix=t,setup$v(this)},overrideDefaults(e){let t=e.base_url;t&&this._setBaseUrl(t);let n=e.suffix;n&&(this.suffix=n),this.defaultOptions=e;let o=e.plugin_base_urls;void 0!==o&&each$d(o,(e,t)=>{AddOnManager.PluginManager.urls[t]=e})},init(e){let t;let n=this,o=eb.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),isInvalidInlineTarget=(e,t)=>e.inline&&t.tagName.toLowerCase() in o,createId=e=>{let t=e.id;return t||(t=get$a(e,"name").filter(e=>!lA.get(e)).getOrThunk(lA.uniqueId),e.setAttribute("id",t)),t},execCallback=t=>{let o=e[t];if(o)return o.apply(n,[])},findTargets=e=>ef.browser.isIE()||ef.browser.isEdge()?(initError("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tiny.cloud/docs/tinymce/6/support/#supportedwebbrowsers"),[]):lI?(initError("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[]):k(e.selector)?lA.select(e.selector):isNonNullable(e.target)?[e.target]:[],provideResults=e=>{t=e},initEditors=()=>{let t,o=0,a=[],createEditor=(e,i,l)=>{let s=new Editor(e,i,n);a.push(s),s.on("init",()=>{++o===t.length&&provideResults(a)}),s.targetElm=s.targetElm||l,s.render()};lA.unbind(window,"ready",initEditors),execCallback("onpageload"),t=unique$1(findTargets(e)),eb.each(t,e=>{purgeDestroyedEditor(n.get(e.id))}),0===(t=eb.grep(t,e=>!n.get(e.id))).length?provideResults([]):lT(t,t=>{isInvalidInlineTarget(e,t)?initError("Could not initialize inline editor on invalid inline target element",t):createEditor(createId(t),e,t)})};return lA.bind(window,"ready",initEditors),new Promise(e=>{t?e(t):provideResults=t=>{e(t)}})},get(e){return 0==arguments.length?lD.slice(0):k(e)?find$2(lD,t=>t.id===e).getOr(null):x(e)&&lD[e]?lD[e]:null},add(e){let t=this,o=t.get(e.id);return o===e||(null===o&&lD.push(e),toggleGlobalEvents(!0),t.activeEditor=e,t.dispatch("AddEditor",{editor:e}),n||(n=e=>{let n=t.dispatch("BeforeUnload");if(n.returnValue)return e.preventDefault(),e.returnValue=n.returnValue,n.returnValue},window.addEventListener("beforeunload",n))),e},createEditor(e,t){return this.add(new Editor(e,t,this))},remove(e){let t;let o=this;if(!e){for(let e=lD.length-1;e>=0;e--)o.remove(lD[e]);return}if(k(e)){lT(lA.select(e),e=>{(t=o.get(e.id))&&o.remove(t)});return}return(t=e,N(o.get(t.id)))?null:(removeEditorFromList(t)&&o.dispatch("RemoveEditor",{editor:t}),0===lD.length&&window.removeEventListener("beforeunload",n),t.remove(),toggleGlobalEvents(lD.length>0),t)},execCommand(e,t,n){var o;let a=$(n)?null!==(o=n.id)&&void 0!==o?o:n.index:n;switch(e){case"mceAddEditor":if(!this.get(a)){let e=n.options;new Editor(a,e,this).render()}return!0;case"mceRemoveEditor":{let e=this.get(a);return e&&e.remove(),!0}case"mceToggleEditor":{let e=this.get(a);if(!e)return this.execCommand("mceAddEditor",!1,n),!0;return e.isHidden()?e.show():e.hide(),!0}}return!!this.activeEditor&&this.activeEditor.execCommand(e,t,n)},triggerSave:()=>{lT(lD,e=>{e.save()})},addI18n:(e,t)=>{tP.add(e,t)},translate:e=>tP.translate(e),setActive(e){let t=this.activeEditor;this.activeEditor!==e&&(t&&t.dispatch("deactivate",{relatedTarget:e}),e.dispatch("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl(e){this.baseURL=new URI(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new URI(this.baseURL)}};lF.setup();let l_=(()=>{let e=value$2(),t=e.clear;return{FakeClipboardItem:e=>({items:e,types:F(e),getType:t=>get$a(e,t).getOrUndefined()}),write:t=>{e.set(t)},read:()=>e.get().getOrUndefined(),clear:t}})(),lL=Math.min,lM=Math.max,lU=Math.round,relativePosition=(e,t,n)=>{let o=t.x,a=t.y,i=e.w,l=e.h,s=t.w,d=t.h,c=(n||"").split("");return"b"===c[0]&&(a+=d),"r"===c[1]&&(o+=s),"c"===c[0]&&(a+=lU(d/2)),"c"===c[1]&&(o+=lU(s/2)),"b"===c[3]&&(a-=l),"r"===c[4]&&(o-=i),"c"===c[3]&&(a-=lU(l/2)),"c"===c[4]&&(o-=lU(i/2)),create$2(o,a,i,l)},create$2=(e,t,n,o)=>({x:e,y:t,w:n,h:o}),awaiter=(e,t,n=1e3)=>{let o=!1,a=null,complete=e=>(...t)=>{o||(o=!0,null!==a&&(clearTimeout(a),a=null),e.apply(null,t))},i=complete(e),l=complete(t);return{start:(...e)=>{o||null!==a||(a=setTimeout(()=>l.apply(null,e),n))},resolve:i,reject:l}},lz=(()=>{let e={},t={};return{load:(n,o)=>{let a=`Script at URL "${o}" failed to load`,i=`Script at URL "${o}" did not call \`tinymce.Resource.add('${n}', data)\` within 1 second`;if(void 0!==e[n])return e[n];{let l=new Promise((e,l)=>{let s=awaiter(e,l);t[n]=s.resolve,ScriptLoader.ScriptLoader.loadScript(o).then(()=>s.start(i),()=>s.reject(a))});return e[n]=l,l}},add:(n,o)=>{void 0!==t[n]&&(t[n](o),delete t[n]),e[n]=Promise.resolve(o)},unload:t=>{delete e[t]}}})();try{let e="__storage_test__";(o=window.localStorage).setItem(e,e),o.removeItem(e)}catch(e){o=(()=>{let e={},t=[],n={getItem:t=>{let n=e[t];return n||null},setItem:(n,o)=>{t.push(n),e[n]=String(o)},key:e=>t[e],removeItem:n=>{t=t.filter(e=>e===n),delete e[n]},clear:()=>{t=[],e={}},length:0};return Object.defineProperty(n,"length",{get:()=>t.length,configurable:!1,enumerable:!1}),n})()}var lW=o;let lH={geom:{Rect:{inflate:(e,t,n)=>create$2(e.x-t,e.y-n,e.w+2*t,e.h+2*n),relativePosition,findBestRelativePosition:(e,t,n,o)=>{for(let a=0;a<o.length;a++){let i=relativePosition(e,t,o[a]);if(i.x>=n.x&&i.x+i.w<=n.w+n.x&&i.y>=n.y&&i.y+i.h<=n.h+n.y)return o[a]}return null},intersect:(e,t)=>{let n=lM(e.x,t.x),o=lM(e.y,t.y),a=lL(e.x+e.w,t.x+t.w),i=lL(e.y+e.h,t.y+t.h);return a-n<0||i-o<0?null:create$2(n,o,a-n,i-o)},clamp:(e,t,n)=>{let o=e.x,a=e.y,i=e.x+e.w,l=e.y+e.h,s=t.x+t.w,d=t.y+t.h,c=lM(0,t.x-o),m=lM(0,t.y-a),u=lM(0,i-s),p=lM(0,l-d);return o+=c,a+=m,n&&(i+=c,l+=m,o-=u,a-=p),create$2(o,a,(i-=u)-o,(l-=p)-a)},create:create$2,fromClientRect:e=>create$2(e.left,e.top,e.width,e.height)}},util:{Delay:rZ,Tools:eb,VK:rx,URI,EventDispatcher,Observable:lv,I18n:tP,LocalStorage:lW,ImageUploader:e=>{let t=UploadStatus(),n=createUploader(e,t);return{upload:(t,o=!0)=>n.upload(t,o?openNotification(e):void 0)}}},dom:{EventUtils,TreeWalker:DomTreeWalker,TextSeeker,DOMUtils,ScriptLoader,RangeUtils,Serializer:DomSerializer,StyleSheetLoader,ControlSelection,BookmarkManager,Selection:EditorSelection,Event:EventUtils.Event},html:{Styles,Entities:tu,Node:AstNode,Schema,DomParser,Writer,Serializer:HtmlSerializer},Env:ef,AddOnManager,Annotator,Formatter,UndoManager,EditorCommands,WindowManager,NotificationManager,EditorObservable:lk,Shortcuts,Editor,FocusManager:rX,EditorManager:lF,DOM:DOMUtils.DOM,ScriptLoader:ScriptLoader.ScriptLoader,PluginManager:aR,ThemeManager:ax,ModelManager:a$,IconManager:ak,Resource:lz,FakeClipboard:l_,trim:eb.trim,isArray:eb.isArray,is:eb.is,toArray:eb.toArray,makeMap:eb.makeMap,each:eb.each,map:eb.map,grep:eb.grep,inArray:eb.inArray,extend:eb.extend,walk:eb.walk,resolve:eb.resolve,explode:eb.explode,_addCacheSuffix:eb._addCacheSuffix},lV=eb.extend(lF,lH);window.tinymce=lV,window.tinyMCE=lV,(e=>{if("object"==typeof module)try{module.exports=e}catch(e){}})(lV)}();