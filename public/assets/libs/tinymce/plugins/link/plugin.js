!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");let hasProto=(e,t,n)=>{var l;return!!n(e,t.prototype)||(null===(l=e.constructor)||void 0===l?void 0:l.name)===t.name},typeOf=e=>{let t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&hasProto(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},isType=e=>t=>typeOf(t)===e,isSimpleType=e=>t=>typeof t===e,t=isType("string"),n=isType("object"),l=isType("array"),isNull=e=>null===e,o=isSimpleType("boolean"),isNullable=e=>null==e,isNonNullable=e=>!isNullable(e),i=isSimpleType("function"),isArrayOf=(e,t)=>{if(l(e)){for(let n=0,l=e.length;n<l;++n)if(!t(e[n]))return!1;return!0}return!1},noop=()=>{},constant=e=>()=>e,tripleEquals=(e,t)=>e===t;let Optional=class Optional{constructor(e,t){this.tag=e,this.value=t}static some(e){return new Optional(!0,e)}static none(){return Optional.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?Optional.some(e(this.value)):Optional.none()}bind(e){return this.tag?e(this.value):Optional.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:Optional.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return isNonNullable(e)?Optional.some(e):Optional.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}};Optional.singletonNone=new Optional(!1);let a=Array.prototype.indexOf,r=Array.prototype.push,rawIndexOf=(e,t)=>a.call(e,t),contains=(e,t)=>rawIndexOf(e,t)>-1,map=(e,t)=>{let n=e.length,l=Array(n);for(let o=0;o<n;o++){let n=e[o];l[o]=t(n,o)}return l},each$1=(e,t)=>{for(let n=0,l=e.length;n<l;n++){let l=e[n];t(l,n)}},foldl=(e,t,n)=>(each$1(e,(e,l)=>{n=t(n,e,l)}),n),flatten=e=>{let t=[];for(let n=0,o=e.length;n<o;++n){if(!l(e[n]))throw Error("Arr.flatten item "+n+" was not an array, input: "+e);r.apply(t,e[n])}return t},bind=(e,t)=>flatten(map(e,t)),findMap=(e,t)=>{for(let n=0;n<e.length;n++){let l=t(e[n],n);if(l.isSome())return l}return Optional.none()},is=(e,t,n=tripleEquals)=>e.exists(e=>n(e,t)),cat=e=>{let t=[],push=e=>{t.push(e)};for(let t=0;t<e.length;t++)e[t].each(push);return t},someIf=(e,t)=>e?Optional.some(t):Optional.none(),option=e=>t=>t.options.get(e),register$1=e=>{let l=e.options.register;l("link_assume_external_targets",{processor:e=>{let n=t(e)||o(e);return n?!0===e?{value:1,valid:n}:"http"===e||"https"===e?{value:e,valid:n}:{value:0,valid:n}:{valid:!1,message:"Must be a string or a boolean."}},default:!1}),l("link_context_toolbar",{processor:"boolean",default:!1}),l("link_list",{processor:e=>t(e)||i(e)||isArrayOf(e,n)}),l("link_default_target",{processor:"string"}),l("link_default_protocol",{processor:"string",default:"https"}),l("link_target_list",{processor:e=>o(e)||isArrayOf(e,n),default:!0}),l("link_rel_list",{processor:"object[]",default:[]}),l("link_class_list",{processor:"object[]",default:[]}),l("link_title",{processor:"boolean",default:!0}),l("allow_unsafe_link_target",{processor:"boolean",default:!1}),l("link_quicklink",{processor:"boolean",default:!1})},s=option("link_assume_external_targets"),u=option("link_context_toolbar"),g=option("link_list"),c=option("link_default_target"),p=option("link_default_protocol"),d=option("link_target_list"),h=option("link_rel_list"),m=option("link_class_list"),k=option("link_title"),f=option("allow_unsafe_link_target"),y=option("link_quicklink");var O=tinymce.util.Tools.resolve("tinymce.util.Tools");let getValue=e=>t(e.value)?e.value:"",getText=e=>t(e.text)?e.text:t(e.title)?e.title:"",sanitizeList=(e,t)=>{let n=[];return O.each(e,e=>{let l=getText(e);if(void 0!==e.menu){let o=sanitizeList(e.menu,t);n.push({text:l,items:o})}else{let o=t(e);n.push({text:l,value:o})}}),n},sanitizeWith=(e=getValue)=>t=>Optional.from(t).map(t=>sanitizeList(t,e)),x={sanitize:e=>sanitizeWith(getValue)(e),sanitizeWith,createUi:(e,t)=>n=>({name:e,type:"listbox",label:t,items:n}),getValue},v=Object.keys,b=Object.hasOwnProperty,each=(e,t)=>{let n=v(e);for(let l=0,o=n.length;l<o;l++){let o=n[l],i=e[o];t(i,o)}},objAcc=e=>(t,n)=>{e[n]=t},internalFilter=(e,t,n,l)=>{each(e,(e,o)=>{(t(e,o)?n:l)(e,o)})},filter=(e,t)=>{let n={};return internalFilter(e,t,objAcc(n),noop),n},has=(e,t)=>b.call(e,t),hasNonNullableKey=(e,t)=>has(e,t)&&void 0!==e[t]&&null!==e[t];var L=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),S=tinymce.util.Tools.resolve("tinymce.util.URI");let isAnchor=e=>isNonNullable(e)&&"a"===e.nodeName.toLowerCase(),isLink=e=>isAnchor(e)&&!!getHref(e),collectNodesInRange=(e,t)=>{if(e.collapsed)return[];{let n=e.cloneContents(),l=n.firstChild,o=new L(l,n),i=[],a=l;do t(a)&&i.push(a);while(a=o.next());return i}},hasProtocol=e=>/^\w+:/i.test(e),getHref=e=>{var t,n;return null!==(n=null!==(t=e.getAttribute("data-mce-href"))&&void 0!==t?t:e.getAttribute("href"))&&void 0!==n?n:""},applyRelTargetRules=(e,t)=>{var n;let l=["noopener"],o=e?e.split(/\s+/):[],removeTargetRules=e=>e.filter(e=>-1===O.inArray(l,e)),i=t?(n=removeTargetRules(n=o)).length>0?n.concat(l):l:removeTargetRules(o);return i.length>0?O.trim(i.sort().join(" ")):""},trimCaretContainers=e=>e.replace(/\uFEFF/g,""),getAnchorElement=(e,t)=>isImageFigure(t=t||getLinksInSelection(e.selection.getRng())[0]||e.selection.getNode())?Optional.from(e.dom.select("a[href]",t)[0]):Optional.from(e.dom.getParent(t,"a[href]")),isInAnchor=(e,t)=>getAnchorElement(e,t).isSome(),getAnchorText=(e,t)=>{let n=t.fold(()=>e.getContent({format:"text"}),e=>e.innerText||e.textContent||"");return trimCaretContainers(n)},getLinksInSelection=e=>collectNodesInRange(e,isLink),getLinks$1=e=>O.grep(e,isLink),hasLinks=e=>getLinks$1(e).length>0,hasLinksInSelection=e=>getLinksInSelection(e).length>0,isOnlyTextSelected=e=>{let t=e.schema.getTextInlineElements(),n=getAnchorElement(e).exists(e=>e.hasAttribute("data-mce-block"));if(n)return!1;let l=e.selection.getRng();if(l.collapsed)return!0;{let e=collectNodesInRange(l,e=>1===e.nodeType&&!isAnchor(e)&&!has(t,e.nodeName.toLowerCase()));return 0===e.length}},isImageFigure=e=>isNonNullable(e)&&"FIGURE"===e.nodeName&&/\bimage\b/i.test(e.className),getLinkAttrs=e=>foldl(["title","rel","class","target"],(t,n)=>(e[n].each(e=>{t[n]=e.length>0?e:null}),t),{href:e.href}),handleExternalTargets=(e,t)=>"http"!==t&&"https"!==t||hasProtocol(e)?e:t+"://"+e,applyLinkOverrides=(e,t)=>{let n={...t};if(0===h(e).length&&!f(e)){let e=applyRelTargetRules(n.rel,"_blank"===n.target);n.rel=e||null}return Optional.from(n.target).isNone()&&!1===d(e)&&(n.target=c(e)),n.href=handleExternalTargets(n.href,s(e)),n},updateLink=(e,t,n,l)=>{n.each(e=>{has(t,"innerText")?t.innerText=e:t.textContent=e}),e.dom.setAttribs(t,l),e.selection.select(t)},createLink=(e,t,n,l)=>{let o=e.dom;isImageFigure(t)?linkImageFigure(o,t,l):n.fold(()=>{e.execCommand("mceInsertLink",!1,l)},t=>{e.insertContent(o.createHTML("a",l,o.encode(t)))})},linkDomMutation=(e,t,n)=>{let l=e.selection.getNode(),o=getAnchorElement(e,l),i=applyLinkOverrides(e,getLinkAttrs(n));e.undoManager.transact(()=>{n.href===t.href&&t.attach(),o.fold(()=>{createLink(e,l,n.text,i)},t=>{e.focus(),updateLink(e,t,n.text,i)})})},unlinkSelection=e=>{let t=e.dom,n=e.selection,l=n.getBookmark(),o=n.getRng().cloneRange(),i=t.getParent(o.startContainer,"a[href]",e.getBody()),a=t.getParent(o.endContainer,"a[href]",e.getBody());i&&o.setStartBefore(i),a&&o.setEndAfter(a),n.setRng(o),e.execCommand("unlink"),n.moveToBookmark(l)},unlinkDomMutation=e=>{e.undoManager.transact(()=>{let t=e.selection.getNode();isImageFigure(t)?unlinkImageFigure(e,t):unlinkSelection(e),e.focus()})},unwrapOptions=e=>{let{class:t,href:n,rel:l,target:o,text:i,title:a}=e;return filter({class:t.getOrNull(),href:n,rel:l.getOrNull(),target:o.getOrNull(),text:i.getOrNull(),title:a.getOrNull()},(e,t)=>!1===isNull(e))},sanitizeData=(e,t)=>{let n=e.options.get,l={allow_html_data_urls:n("allow_html_data_urls"),allow_script_urls:n("allow_script_urls"),allow_svg_data_urls:n("allow_svg_data_urls")},o=t.href;return{...t,href:S.isDomSafe(o,"a",l)?o:""}},link=(e,t,n)=>{let l=sanitizeData(e,n);e.hasPlugin("rtc",!0)?e.execCommand("createlink",!1,unwrapOptions(l)):linkDomMutation(e,t,l)},unlink=e=>{e.hasPlugin("rtc",!0)?e.execCommand("unlink"):unlinkDomMutation(e)},unlinkImageFigure=(e,t)=>{var n;let l=e.dom.select("img",t)[0];if(l){let o=e.dom.getParents(l,"a[href]",t)[0];o&&(null===(n=o.parentNode)||void 0===n||n.insertBefore(l,o),e.dom.remove(o))}},linkImageFigure=(e,t,n)=>{var l;let o=e.select("img",t)[0];if(o){let t=e.create("a",n);null===(l=o.parentNode)||void 0===l||l.insertBefore(t,o),t.appendChild(o)}},isListGroup=e=>hasNonNullableKey(e,"items"),findTextByValue=(e,t)=>findMap(t,t=>isListGroup(t)?findTextByValue(e,t.items):someIf(t.value===e,t)),getDelta=(e,t,n,l)=>{let o=l[t],i=e.length>0;return void 0!==o?findTextByValue(o,n).map(t=>({url:{value:t.value,meta:{text:i?e:t.text,attach:noop}},text:i?e:t.text})):Optional.none()},findCatalog=(e,t)=>"link"===t?e.link:"anchor"===t?e.anchor:Optional.none(),C={init:(e,t)=>{let n={text:e.text,title:e.title},getTitleFromUrlChange=e=>{var t;return someIf(n.title.length<=0,Optional.from(null===(t=e.meta)||void 0===t?void 0:t.title).getOr(""))},getTextFromUrlChange=e=>{var t;return someIf(n.text.length<=0,Optional.from(null===(t=e.meta)||void 0===t?void 0:t.text).getOr(e.value))},onUrlChange=e=>{let t=getTextFromUrlChange(e.url),n=getTitleFromUrlChange(e.url);return t.isSome()||n.isSome()?Optional.some({...t.map(e=>({text:e})).getOr({}),...n.map(e=>({title:e})).getOr({})}):Optional.none()},onCatalogChange=(e,l)=>{let o=findCatalog(t,l).getOr([]);return getDelta(n.text,l,o,e)};return{onChange:(e,t)=>{let l=t.name;return"url"===l?onUrlChange(e()):contains(["anchor","link"],l)?onCatalogChange(e(),l):(("text"===l||"title"===l)&&(n[l]=e()[l]),Optional.none())}}},getDelta};var T=tinymce.util.Tools.resolve("tinymce.util.Delay");let delayedConfirm=(e,t,n)=>{let l=e.selection.getRng();T.setEditorTimeout(e,()=>{e.windowManager.confirm(t,t=>{e.selection.setRng(l),n(t)})})},tryEmailTransform=e=>{let t=e.href,n=t.indexOf("@")>0&&-1===t.indexOf("/")&&-1===t.indexOf("mailto:");return n?Optional.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:e=>({...e,href:"mailto:"+t})}):Optional.none()},tryProtocolTransform=(e,t)=>n=>{let l=n.href,o=1===e&&!hasProtocol(l)||0===e&&/^\s*www(\.|\d\.)/i.test(l);return o?Optional.some({message:`The URL you entered seems to be an external link. Do you want to add the required ${t}:// prefix?`,preprocess:e=>({...e,href:t+"://"+l})}):Optional.none()},A={preprocess:(e,t)=>findMap([tryEmailTransform,tryProtocolTransform(s(e),p(e))],e=>e(t)).fold(()=>Promise.resolve(t),n=>new Promise(l=>{delayedConfirm(e,n.message,e=>{l(e?n.preprocess(t):t)})}))},_={getAnchors:e=>{let t=e.dom.select("a:not([href])"),n=bind(t,e=>{let t=e.name||e.id;return t?[{text:t,value:"#"+t}]:[]});return n.length>0?Optional.some([{text:"None",value:""}].concat(n)):Optional.none()}},N={getClasses:e=>{let t=m(e);return t.length>0?x.sanitize(t):Optional.none()}},parseJson=e=>{try{return Optional.some(JSON.parse(e))}catch(e){return Optional.none()}},E={getLinks:e=>{let extractor=t=>e.convertURL(t.value||t.url||"","href"),n=g(e);return new Promise(e=>{t(n)?fetch(n).then(e=>e.ok?e.text().then(parseJson):Promise.reject()).then(e,()=>e(Optional.none())):i(n)?n(t=>e(Optional.some(t))):e(Optional.from(n))}).then(e=>e.bind(x.sanitizeWith(extractor)).map(e=>e.length>0?[{text:"None",value:""}].concat(e):e))}},w={getRels:(e,t)=>{let n=h(e);if(n.length>0){let l=is(t,"_blank"),o=!1===f(e),i=o?x.sanitizeWith(e=>applyRelTargetRules(x.getValue(e),l)):x.sanitize;return i(n)}return Optional.none()}},I=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],R={getTargets:e=>{let t=d(e);return l(t)?x.sanitize(t).orThunk(()=>Optional.some(I)):!1===t?Optional.none():Optional.some(I)}},nonEmptyAttr=(e,t,n)=>{let l=e.getAttrib(t,n);return null!==l&&l.length>0?Optional.some(l):Optional.none()},extractFromAnchor=(e,t)=>{let n=e.dom,l=isOnlyTextSelected(e),o=l?Optional.some(getAnchorText(e.selection,t)):Optional.none(),i=t.bind(e=>Optional.from(n.getAttrib(e,"href"))),a=t.bind(e=>Optional.from(n.getAttrib(e,"target"))),r=t.bind(e=>nonEmptyAttr(n,e,"rel")),s=t.bind(e=>nonEmptyAttr(n,e,"class")),u=t.bind(e=>nonEmptyAttr(n,e,"title"));return{url:i,text:o,title:u,target:a,rel:r,linkClass:s}},D={collect:(e,t)=>E.getLinks(e).then(n=>{let l=extractFromAnchor(e,t);return{anchor:l,catalogs:{targets:R.getTargets(e),rels:w.getRels(e,l.target),classes:N.getClasses(e),anchor:_.getAnchors(e),link:n},optNode:t,flags:{titleEnabled:k(e)}}})},handleSubmit=(e,t)=>n=>{let l=n.getData();if(!l.url.value){unlink(e),n.close();return}let getChangedValue=e=>Optional.from(l[e]).filter(n=>!is(t.anchor[e],n)),o={href:l.url.value,text:getChangedValue("text"),target:getChangedValue("target"),rel:getChangedValue("rel"),class:getChangedValue("linkClass"),title:getChangedValue("title")},i={href:l.url.value,attach:void 0!==l.url.meta&&l.url.meta.attach?l.url.meta.attach:noop};A.preprocess(e,o).then(t=>{link(e,i,t)}),n.close()},collectData=e=>{let t=getAnchorElement(e);return D.collect(e,t)},getInitialData=(e,t)=>{let n=e.anchor,l=n.url.getOr("");return{url:{value:l,meta:{original:{value:l}}},text:n.text.getOr(""),title:n.title.getOr(""),anchor:l,link:l,rel:n.rel.getOr(""),target:n.target.or(t).getOr(""),linkClass:n.linkClass.getOr("")}},makeDialog=(e,t,n)=>{let l=e.anchor.text.map(()=>({name:"text",type:"input",label:"Text to display"})).toArray(),o=e.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],i=Optional.from(c(n)),a=getInitialData(e,i),r=e.catalogs,s=C.init(a,r),u={type:"panel",items:flatten([[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],l,o,cat([r.anchor.map(x.createUi("anchor","Anchors")),r.rels.map(x.createUi("rel","Rel")),r.targets.map(x.createUi("target","Open link in...")),r.link.map(x.createUi("link","Link list")),r.classes.map(x.createUi("linkClass","Class"))])])};return{title:"Insert/Edit Link",size:"normal",body:u,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:a,onChange:(e,{name:t})=>{s.onChange(e.getData,{name:t}).each(t=>{e.setData(t)})},onSubmit:t}},open$1=e=>{let t=collectData(e);t.then(t=>{let n=handleSubmit(e,t);return makeDialog(t,n,e)}).then(t=>{e.windowManager.open(t)})},register=e=>{e.addCommand("mceLink",(t,n)=>{(null==n?void 0:n.dialog)!==!0&&y(e)?e.dispatch("contexttoolbar-show",{toolbarKey:"quicklink"}):open$1(e)})};var M=tinymce.util.Tools.resolve("tinymce.util.VK");let appendClickRemove=(e,t)=>{document.body.appendChild(e),e.dispatchEvent(t),document.body.removeChild(e)},open=e=>{let t=document.createElement("a");t.target="_blank",t.href=e,t.rel="noreferrer noopener";let n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),appendClickRemove(t,n)},getLink=(e,t)=>e.dom.getParent(t,"a[href]"),getSelectedLink=e=>getLink(e,e.selection.getStart()),hasOnlyAltModifier=e=>!0===e.altKey&&!1===e.shiftKey&&!1===e.ctrlKey&&!1===e.metaKey,gotoLink=(e,t)=>{if(t){let n=getHref(t);if(/^#/.test(n)){let t=e.dom.select(n);t.length&&e.selection.scrollIntoView(t[0],!0)}else open(t.href)}},openDialog=e=>()=>{e.execCommand("mceLink",!1,{dialog:!0})},gotoSelectedLink=e=>()=>{gotoLink(e,getSelectedLink(e))},setupGotoLinks=e=>{e.on("click",t=>{let n=getLink(e,t.target);n&&M.metaKeyPressed(t)&&(t.preventDefault(),gotoLink(e,n))}),e.on("keydown",t=>{if(!t.isDefaultPrevented()&&13===t.keyCode&&hasOnlyAltModifier(t)){let n=getSelectedLink(e);n&&(t.preventDefault(),gotoLink(e,n))}})},toggleState=(e,t)=>(e.on("NodeChange",t),()=>e.off("NodeChange",t)),toggleLinkState=e=>t=>{let updateState=()=>{t.setActive(!e.mode.isReadOnly()&&isInAnchor(e,e.selection.getNode())),t.setEnabled(e.selection.isEditable())};return updateState(),toggleState(e,updateState)},toggleLinkMenuState=e=>t=>{let updateState=()=>{t.setEnabled(e.selection.isEditable())};return updateState(),toggleState(e,updateState)},hasExactlyOneLinkInSelection=e=>{let t=e.selection.isCollapsed()?getLinks$1(e.dom.getParents(e.selection.getStart())):getLinksInSelection(e.selection.getRng());return 1===t.length},toggleGotoLinkState=e=>t=>{let updateState=()=>t.setEnabled(hasExactlyOneLinkInSelection(e));return updateState(),toggleState(e,updateState)},toggleUnlinkState=e=>t=>{let hasLinks$1=t=>hasLinks(t)||hasLinksInSelection(e.selection.getRng()),n=e.dom.getParents(e.selection.getStart()),updateEnabled=n=>{t.setEnabled(hasLinks$1(n)&&e.selection.isEditable())};return updateEnabled(n),toggleState(e,e=>updateEnabled(e.parents))},setup=e=>{e.addShortcut("Meta+K","",()=>{e.execCommand("mceLink")})},setupButtons=e=>{e.ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:openDialog(e),onSetup:toggleLinkState(e)}),e.ui.registry.addButton("openlink",{icon:"new-tab",tooltip:"Open link",onAction:gotoSelectedLink(e),onSetup:toggleGotoLinkState(e)}),e.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:()=>unlink(e),onSetup:toggleUnlinkState(e)})},setupMenuItems=e=>{e.ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:gotoSelectedLink(e),onSetup:toggleGotoLinkState(e)}),e.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onSetup:toggleLinkMenuState(e),onAction:openDialog(e)}),e.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:()=>unlink(e),onSetup:toggleUnlinkState(e)})},setupContextMenu=e=>{e.ui.registry.addContextMenu("link",{update:t=>{let n=e.dom.isEditable(t);return n?hasLinks(e.dom.getParents(t,"a"))?"link unlink openlink":"link":""}})},setupContextToolbars=e=>{let collapseSelectionToEnd=e=>{e.selection.collapse(!1)},onSetupLink=t=>{let n=e.selection.getNode();return t.setEnabled(isInAnchor(e,n)),noop},getLinkText=t=>{let n=getAnchorElement(e),l=isOnlyTextSelected(e);if(!n.isNone()||!l)return Optional.none();{let l=getAnchorText(e.selection,n);return someIf(0===l.length,t)}};e.ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:toggleLinkState(e)},label:"Link",predicate:t=>u(e)&&isInAnchor(e,t),initValue:()=>{let t=getAnchorElement(e);return t.fold(constant(""),getHref)},commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:t=>{let n=e.selection.getNode();return t.setActive(isInAnchor(e,n)),toggleLinkState(e)(t)},onAction:t=>{let n=t.getValue(),l=getLinkText(n);link(e,{href:n,attach:noop},{href:n,text:l,title:Optional.none(),rel:Optional.none(),target:Optional.none(),class:Optional.none()}),collapseSelectionToEnd(e),t.hide()}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:onSetupLink,onAction:t=>{unlink(e),t.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:onSetupLink,onAction:t=>{gotoSelectedLink(e)(),t.hide()}}]})};e.add("link",e=>{register$1(e),setupButtons(e),setupMenuItems(e),setupContextMenu(e),setupContextToolbars(e),setupGotoLinks(e),register(e),setup(e)})}();