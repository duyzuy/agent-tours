!function(){"use strict";let e,t;var o=tinymce.util.Tools.resolve("tinymce.PluginManager");let r=0,n=e=>{let t=new Date().getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++r+String(t)},l=(e,t,o)=>{var r;return!!o(e,t.prototype)||(null===(r=e.constructor)||void 0===r?void 0:r.name)===t.name},i=e=>{let t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&l(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},a=e=>t=>typeof t===e,d=(e="string",t=>i(t)===e),s=a("boolean"),m=e=>null==e,c=e=>!m(e),u=a("function"),g=a("number"),p=(e,t)=>o=>e(t(o)),h=e=>()=>e,f=(e,t)=>e===t,y=h(!1);class v{constructor(e,t){this.tag=e,this.value=t}static some(e){return new v(!0,e)}static none(){return v.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?v.some(e(this.value)):v.none()}bind(e){return this.tag?e(this.value):v.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:v.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return c(e)?v.some(e):v.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}v.singletonNone=new v(!1);let b=Array.prototype.indexOf,T=(e,t)=>b.call(e,t),w=(e,t)=>T(e,t)>-1,A=(e,t)=>{let o=e.length,r=Array(o);for(let n=0;n<o;n++){let o=e[n];r[n]=t(o,n)}return r},C=(e,t)=>{for(let o=0,r=e.length;o<r;o++)t(e[o],o)},N=(e,t)=>{let o=[];for(let r=0,n=e.length;r<n;r++){let n=e[r];t(n,r)&&o.push(n)}return o},S=(e,t,o)=>(C(e,(e,r)=>{o=t(o,e,r)}),o),x=Object.keys,D=(e,t)=>{let o=x(e);for(let r=0,n=o.length;r<n;r++){let n=o[r];t(e[n],n)}};"undefined"!=typeof window?window:Function("return this;")();let E=e=>e.dom.nodeName.toLowerCase(),M=e=>e.dom.nodeType,P=e=>t=>M(t)===e,k=P(1),B=P(3),O=P(9),R=P(11),$=(e,t,o)=>{if(d(o)||s(o)||g(o))e.setAttribute(t,o+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",e),Error("Attribute value was not simple")},I=(e,t)=>{let o=e.dom;D(t,(e,t)=>{$(o,t,e)})},L=(e,t)=>{let o=e.dom.getAttribute(t);return null===o?void 0:o},V=(e,t)=>v.from(L(e,t)),j=(e,t)=>{e.dom.removeAttribute(t)},q=e=>S(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),F=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},K={fromTag:(e,t)=>F((t||document).createElement(e)),fromText:(e,t)=>F((t||document).createTextNode(e)),fromDom:F},z=(e,t)=>{let o=e.dom;if(1!==o.nodeType)return!1;if(void 0!==o.matches)return o.matches(t);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(t);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(t);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(t);throw Error("Browser lacks native selectors")},U=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,H=(e,t)=>{let o=void 0===t?document:t.dom;return U(o)?[]:A(o.querySelectorAll(e),K.fromDom)},Y=(e,t)=>{let o=void 0===t?document:t.dom;return U(o)?v.none():v.from(o.querySelector(e)).map(K.fromDom)},_=(e,t,o=f)=>e.exists(e=>o(e,t)),G=(t=/^\s+|\s+$/g,e=>e.replace(t,"")),J=e=>void 0!==e.style&&u(e.style.getPropertyValue),Q=e=>K.fromDom(e.dom.ownerDocument),W=e=>O(e)?e:Q(e),X=e=>v.from(e.dom.parentNode).map(K.fromDom),Z=e=>v.from(e.dom.nextSibling).map(K.fromDom),ee=e=>A(e.dom.childNodes,K.fromDom),et=(e,t)=>{let o=e.dom.childNodes;return v.from(o[t]).map(K.fromDom)},eo=e=>et(e,0),er=e=>R(e)&&c(e.dom.host),en=u(Element.prototype.attachShadow)&&u(Node.prototype.getRootNode)?e=>K.fromDom(e.dom.getRootNode()):W,el=e=>{let t=en(e);return er(t)?v.some(t):v.none()},ei=e=>K.fromDom(e.dom.host),ea=e=>{let t=B(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;let o=t.ownerDocument;return el(K.fromDom(t)).fold(()=>o.body.contains(t),p(ea,ei))},ed=(e,t,o)=>{if(!d(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),Error("CSS value must be a string: "+o);J(e)&&e.style.setProperty(t,o)},es=(e,t)=>{J(e)&&e.style.removeProperty(t)},em=(e,t)=>J(e)?e.style.getPropertyValue(t):"",ec=(e,t)=>{X(e).each(o=>{o.dom.insertBefore(t.dom,e.dom)})},eu=(e,t)=>{Z(e).fold(()=>{X(e).each(e=>{eg(e,t)})},e=>{ec(e,t)})},eg=(e,t)=>{e.dom.appendChild(t.dom)},ep=(e,t)=>{C(t,(o,r)=>{eu(0===r?e:t[r-1],o)})},eh=(e,t)=>{let o=[];return C(ee(e),e=>{t(e)&&(o=o.concat([e])),o=o.concat(eh(e,t))}),o};var ef=(e,t,o,r,n)=>e(o,r)?v.some(o):u(n)&&n(o)?v.none():t(o,r,n);let ey=(e,t,o)=>{let r=e.dom,n=u(o)?o:y;for(;r.parentNode;){r=r.parentNode;let e=K.fromDom(r);if(t(e))return v.some(e);if(n(e))break}return v.none()},ev=e=>{let t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},eb=(e,t,o)=>ey(e,e=>z(e,t),o),eT=(e,t)=>Y(t,e),ew=((e,t)=>{let o=t=>e(t)?v.from(t.dom.nodeValue):v.none();return{get:r=>{if(!e(r))throw Error("Can only get "+t+" value of a "+t+" node");return o(r).getOr("")},getOption:o,set:(o,r)=>{if(!e(o))throw Error("Can only set raw "+t+" value of a "+t+" node");o.dom.nodeValue=r}}})(B,"text");var eA=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];let eC=(e,t)=>({element:e,offset:t}),eN=(e,t,o)=>e.property().isText(t)&&0===e.property().getText(t).trim().length||e.property().isComment(t)?o(t).bind(t=>eN(e,t,o).orThunk(()=>v.some(t))):v.none(),eS=(e,t)=>e.property().isText(t)?e.property().getText(t).length:e.property().children(t).length,ex=(e,t)=>{let o=eN(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(o))return eC(o,eS(e,o));let r=e.property().children(o);return r.length>0?ex(e,r[r.length-1]):eC(o,eS(e,o))},eD={up:h({selector:eb,closest:(e,t,o)=>ef((e,t)=>z(e,t),eb,e,t,o),predicate:ey,all:(e,t)=>{let o=u(t)?t:y,r=e.dom,n=[];for(;null!==r.parentNode&&void 0!==r.parentNode;){let e=r.parentNode,t=K.fromDom(e);if(n.push(t),!0===o(t))break;r=e}return n}}),down:h({selector:(e,t)=>H(t,e),predicate:eh}),styles:h({get:(e,t)=>{let o=e.dom,r=window.getComputedStyle(o).getPropertyValue(t);return""!==r||ea(e)?r:em(o,t)},getRaw:(e,t)=>{let o=em(e.dom,t);return v.from(o).filter(e=>e.length>0)},set:(e,t,o)=>{ed(e.dom,t,o)},remove:(e,t)=>{es(e.dom,t),_(V(e,"style").map(G),"")&&j(e,"style")}}),attrs:h({get:L,set:(e,t,o)=>{$(e.dom,t,o)},remove:j,copyTo:(e,t)=>{I(t,q(e))}}),insert:h({before:ec,after:eu,afterAll:ep,append:eg,appendAll:(e,t)=>{C(t,t=>{eg(e,t)})},prepend:(e,t)=>{eo(e).fold(()=>{eg(e,t)},o=>{e.dom.insertBefore(t.dom,o.dom)})},wrap:(e,t)=>{ec(e,t),eg(t,e)}}),remove:h({unwrap:e=>{let t=ee(e);t.length>0&&ep(e,t),ev(e)},remove:ev}),create:h({nu:K.fromTag,clone:e=>K.fromDom(e.dom.cloneNode(!1)),text:K.fromText}),query:h({comparePosition:(e,t)=>e.dom.compareDocumentPosition(t.dom),prevSibling:e=>v.from(e.dom.previousSibling).map(K.fromDom),nextSibling:Z}),property:h({children:ee,name:E,parent:X,document:e=>W(e).dom,isText:B,isComment:e=>8===M(e)||"#comment"===E(e),isElement:k,isSpecial:e=>w(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],E(e)),getLanguage:e=>k(e)?V(e,"lang"):v.none(),getText:e=>ew.get(e),setText:(e,t)=>ew.set(e,t),isBoundary:e=>!!k(e)&&("body"===E(e)||w(eA,E(e))),isEmptyTag:e=>!!k(e)&&w(["br","img","hr","input"],E(e)),isNonEditable:e=>k(e)&&"false"===L(e,"contenteditable")}),eq:(e,t)=>e.dom===t.dom,is:z},eE=e=>ex(eD,e),eM=(e,t,o)=>e.dispatch("ToggledAccordion",{element:t,state:o}),eP=(e,t,o)=>e.dispatch("ToggledAllAccordions",{elements:t,state:o}),ek="details",eB="mce-accordion",eO="mce-accordion-summary",eR="mce-accordion-body";var e$=tinymce.util.Tools.resolve("tinymce.util.Tools");let eI=e=>(null==e?void 0:e.nodeName)==="SUMMARY",eL=e=>(null==e?void 0:e.nodeName)==="DETAILS",eV=e=>e.hasAttribute("open"),ej=e=>{let t=e.selection.getNode();return eI(t)||!!e.dom.getParent(t,eI)},eq=e=>!ej(e)&&e.dom.isEditable(e.selection.getNode()),eF=e=>v.from(e.dom.getParent(e.selection.getNode(),eL)),eK=e=>eF(e).isSome(),ez=e=>(e.innerHTML='<br data-mce-bogus="1" />',e),eU=e=>ez(e.dom.create("p")),eH=e=>ez(e.dom.create("summary")),eY=(e,t)=>{let o=eU(e);t.insertAdjacentElement("afterend",o),e.selection.setCursorLocation(o,0)},e_=(e,t)=>{if(eI(null==t?void 0:t.lastChild)){let o=eU(e);t.appendChild(o),e.selection.setCursorLocation(o,0)}},eG=(e,t)=>{if(!eI(null==t?void 0:t.firstChild)){let o=eH(e);t.prepend(o),e.selection.setCursorLocation(o,0)}},eJ=e=>t=>{e_(e,t),eG(e,t)},eQ=e=>{e$.each(e$.grep(e.dom.select("details",e.getBody())),eJ(e))},eW=e=>{if(!eq(e))return;let t=K.fromDom(e.getBody()),o=n("acc"),r=e.dom.encode(e.selection.getRng().toString()||e.translate("Accordion summary...")),l=e.dom.encode(e.translate("Accordion body...")),i=`<summary class="${eO}">${r}</summary>`,a=`<div class="${eR}"><p>${l}</p></div>`;e.undoManager.transact(()=>{e.insertContent([`<details data-mce-id="${o}" class="${eB}" open="open">`,i,a,"</details>"].join("")),eT(t,`[data-mce-id="${o}"]`).each(t=>{j(t,"data-mce-id"),eT(t,"summary").each(t=>{let o=e.dom.createRng(),r=eE(t);o.setStart(r.element.dom,r.offset),o.setEnd(r.element.dom,r.offset),e.selection.setRng(o)})})})},eX=(e,t)=>{let o=null!=t?t:!eV(e);return o?e.setAttribute("open","open"):e.removeAttribute("open"),o},eZ=(e,t)=>{eF(e).each(o=>{eM(e,o,eX(o,t))})},e0=e=>{eF(e).each(t=>{let{nextSibling:o}=t;o?(e.selection.select(o,!0),e.selection.collapse(!0)):eY(e,t),t.remove()})},e1=(e,t)=>{let o=Array.from(e.getBody().querySelectorAll("details"));0!==o.length&&(C(o,e=>eX(e,null!=t?t:!eV(e))),eP(e,o,t))},e9=e=>{e.addCommand("InsertAccordion",()=>eW(e)),e.addCommand("ToggleAccordion",(t,o)=>eZ(e,o)),e.addCommand("ToggleAllAccordions",(t,o)=>e1(e,o)),e.addCommand("RemoveAccordion",()=>e0(e))};var e3=tinymce.util.Tools.resolve("tinymce.html.Node");let e2=e=>{var t,o;return null!==(o=null===(t=e.attr("class"))||void 0===t?void 0:t.split(" "))&&void 0!==o?o:[]},e4=(e,t)=>{let o=Array.from(new Set([...e2(e),...t]));o.length>0&&e.attr("class",o.join(" "))},e5=(e,t)=>{let o=N(e2(e),e=>!t.has(e));e.attr("class",o.length>0?o.join(" "):null)},e6=e=>e.name===ek&&w(e2(e),eB),e8=e=>"div"===e.name&&w(e2(e),eR),e7=e=>{let t,o;let r=e.children(),n=[];for(let e=0;e<r.length;e++){let l=r[e];"summary"===l.name&&m(t)?t=l:e8(l)&&m(o)?o=l:n.push(l)}return{summaryNode:t,wrapperNode:o,otherNodes:n}},te=e=>{let t=new e3("br",1);t.attr("data-mce-bogus","1"),e.empty(),e.append(t)},tt=e=>{e.on("PreInit",()=>{let{serializer:t,parser:o}=e;o.addNodeFilter(ek,e=>{for(let t=0;t<e.length;t++){let o=e[t];if(e6(o)){let{summaryNode:e,wrapperNode:t,otherNodes:r}=e7(o),n=c(e),l=n?e:new e3("summary",1);m(l.firstChild)&&te(l),e4(l,[eO]),n||(c(o.firstChild)?o.insert(l,o.firstChild,!0):o.append(l));let i=c(t),a=i?t:new e3("div",1);if(e4(a,[eR]),r.length>0)for(let e=0;e<r.length;e++){let t=r[e];a.append(t)}if(m(a.firstChild)){let e=new e3("p",1);te(e),a.append(e)}i||o.append(a)}}}),t.addNodeFilter(ek,e=>{let t=new Set([eO]);for(let o=0;o<e.length;o++){let r=e[o];if(e6(r)){let{summaryNode:e,wrapperNode:o}=e7(r);c(e)&&e5(e,t),c(o)&&o.unwrap()}}})})};var to=tinymce.util.Tools.resolve("tinymce.util.VK");let tr=e=>{e.on("keydown",t=>{!t.shiftKey&&t.keyCode===to.ENTER&&ej(e)&&(t.preventDefault(),e.execCommand("ToggleAccordion"))})},tn=e=>{tr(e),e.on("ExecCommand",t=>{let o=t.command.toLowerCase();("delete"===o||"forwarddelete"===o)&&eK(e)&&eQ(e)})},tl=e=>t=>{let o=()=>t.setEnabled(eq(e));return e.on("NodeChange",o),()=>e.off("NodeChange",o)},ti=e=>{let t=()=>e.execCommand("InsertAccordion");e.ui.registry.addButton("accordion",{icon:"accordion",tooltip:"Insert accordion",onSetup:tl(e),onAction:t}),e.ui.registry.addMenuItem("accordion",{icon:"accordion",text:"Accordion",onSetup:tl(e),onAction:t}),e.ui.registry.addToggleButton("accordiontoggle",{icon:"accordion-toggle",tooltip:"Toggle accordion",onAction:()=>e.execCommand("ToggleAccordion")}),e.ui.registry.addToggleButton("accordionremove",{icon:"remove",tooltip:"Delete accordion",onAction:()=>e.execCommand("RemoveAccordion")}),e.ui.registry.addContextToolbar("accordion",{predicate:t=>e.dom.is(t,"details")&&e.getBody().contains(t)&&e.dom.isEditable(t.parentNode),items:"accordiontoggle accordionremove",scope:"node",position:"node"})};o.add("accordion",e=>{ti(e),e9(e),tn(e),tt(e)})}();