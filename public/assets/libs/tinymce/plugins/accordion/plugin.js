!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");let t=0,o=e=>{let o=new Date,r=o.getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++t+String(r)},r=(e,t,o)=>{var r;return!!o(e,t.prototype)||(null===(r=e.constructor)||void 0===r?void 0:r.name)===t.name},n=e=>{let t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&r(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},l=e=>t=>typeof t===e,i=e=>"string"===n(e),a=l("boolean"),d=e=>null==e,s=e=>!d(e),m=l("function"),c=l("number"),u=(e,t)=>o=>e(t(o)),g=e=>()=>e,p=(e,t)=>e===t,h=g(!1);class f{constructor(e,t){this.tag=e,this.value=t}static some(e){return new f(!0,e)}static none(){return f.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?f.some(e(this.value)):f.none()}bind(e){return this.tag?e(this.value):f.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:f.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return s(e)?f.some(e):f.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}f.singletonNone=new f(!1);let y=Array.prototype.indexOf,v=(e,t)=>y.call(e,t),b=(e,t)=>v(e,t)>-1,T=(e,t)=>{let o=e.length,r=Array(o);for(let n=0;n<o;n++){let o=e[n];r[n]=t(o,n)}return r},w=(e,t)=>{for(let o=0,r=e.length;o<r;o++){let r=e[o];t(r,o)}},A=(e,t)=>{let o=[];for(let r=0,n=e.length;r<n;r++){let n=e[r];t(n,r)&&o.push(n)}return o},N=(e,t,o)=>(w(e,(e,r)=>{o=t(o,e,r)}),o),C=Object.keys,S=(e,t)=>{let o=C(e);for(let r=0,n=o.length;r<n;r++){let n=o[r],l=e[n];t(l,n)}};"undefined"!=typeof window?window:Function("return this;")();let x=e=>{let t=e.dom.nodeName;return t.toLowerCase()},E=e=>e.dom.nodeType,D=e=>t=>E(t)===e,M=D(1),P=D(3),k=D(9),B=D(11),O=(e,t,o)=>{if(i(o)||a(o)||c(o))e.setAttribute(t,o+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",e),Error("Attribute value was not simple")},L=(e,t)=>{let o=e.dom;S(t,(e,t)=>{O(o,t,e)})},R=(e,t)=>{let o=e.dom.getAttribute(t);return null===o?void 0:o},$=(e,t)=>f.from(R(e,t)),I=(e,t)=>{e.dom.removeAttribute(t)},V=e=>N(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),j=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},q={fromHtml:(e,t)=>{let o=t||document,r=o.createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||r.childNodes.length>1){let t="HTML does not have a single root node";throw console.error(t,e),Error(t)}return j(r.childNodes[0])},fromTag:(e,t)=>{let o=t||document,r=o.createElement(e);return j(r)},fromText:(e,t)=>{let o=t||document,r=o.createTextNode(e);return j(r)},fromDom:j,fromPoint:(e,t,o)=>f.from(e.dom.elementFromPoint(t,o)).map(j)},F=(e,t)=>{let o=e.dom;if(1!==o.nodeType)return!1;if(void 0!==o.matches)return o.matches(t);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(t);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(t);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(t);throw Error("Browser lacks native selectors")},H=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,K=(e,t)=>{let o=void 0===t?document:t.dom;return H(o)?[]:T(o.querySelectorAll(e),q.fromDom)},z=(e,t)=>{let o=void 0===t?document:t.dom;return H(o)?f.none():f.from(o.querySelector(e)).map(q.fromDom)},U=(e,t,o=p)=>e.exists(e=>o(e,t)),Y=e=>e.replace(/^\s+|\s+$/g,""),_=e=>void 0!==e.style&&m(e.style.getPropertyValue),G=e=>q.fromDom(e.dom.ownerDocument),J=e=>k(e)?e:G(e),Q=e=>f.from(e.dom.parentNode).map(q.fromDom),W=e=>f.from(e.dom.nextSibling).map(q.fromDom),X=e=>T(e.dom.childNodes,q.fromDom),Z=(e,t)=>{let o=e.dom.childNodes;return f.from(o[t]).map(q.fromDom)},ee=e=>Z(e,0),et=e=>B(e)&&s(e.dom.host),eo=m(Element.prototype.attachShadow)&&m(Node.prototype.getRootNode),er=eo?e=>q.fromDom(e.dom.getRootNode()):J,en=e=>{let t=er(e);return et(t)?f.some(t):f.none()},el=e=>q.fromDom(e.dom.host),ei=e=>{let t=P(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;let o=t.ownerDocument;return en(q.fromDom(t)).fold(()=>o.body.contains(t),u(ei,el))},ea=(e,t,o)=>{if(!i(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),Error("CSS value must be a string: "+o);_(e)&&e.style.setProperty(t,o)},ed=(e,t)=>{_(e)&&e.style.removeProperty(t)},es=(e,t)=>_(e)?e.style.getPropertyValue(t):"",em=(e,t)=>{let o=Q(e);o.each(o=>{o.dom.insertBefore(t.dom,e.dom)})},ec=(e,t)=>{let o=W(e);o.fold(()=>{let o=Q(e);o.each(e=>{eu(e,t)})},e=>{em(e,t)})},eu=(e,t)=>{e.dom.appendChild(t.dom)},eg=(e,t)=>{w(t,(o,r)=>{let n=0===r?e:t[r-1];ec(n,o)})},ep=(e,t)=>{let o=[];return w(X(e),e=>{t(e)&&(o=o.concat([e])),o=o.concat(ep(e,t))}),o};var eh=(e,t,o,r,n)=>e(o,r)?f.some(o):m(n)&&n(o)?f.none():t(o,r,n);let ef=(e,t,o)=>{let r=e.dom,n=m(o)?o:h;for(;r.parentNode;){r=r.parentNode;let e=q.fromDom(r);if(t(e))return f.some(e);if(n(e))break}return f.none()},ey=e=>{let t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},ev=(e,t,o)=>ef(e,e=>F(e,t),o),eb=(e,t)=>z(t,e),eT=((e,t)=>{let o=t=>e(t)?f.from(t.dom.nodeValue):f.none();return{get:r=>{if(!e(r))throw Error("Can only get "+t+" value of a "+t+" node");return o(r).getOr("")},getOption:o,set:(o,r)=>{if(!e(o))throw Error("Can only set raw "+t+" value of a "+t+" node");o.dom.nodeValue=r}}})(P,"text");var ew=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];let eA=(e,t)=>({element:e,offset:t}),eN=(e,t,o)=>e.property().isText(t)&&0===e.property().getText(t).trim().length||e.property().isComment(t)?o(t).bind(t=>eN(e,t,o).orThunk(()=>f.some(t))):f.none(),eC=(e,t)=>{if(e.property().isText(t))return e.property().getText(t).length;let o=e.property().children(t);return o.length},eS=(e,t)=>{let o=eN(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(o))return eA(o,eC(e,o));let r=e.property().children(o);return r.length>0?eS(e,r[r.length-1]):eA(o,eC(e,o))},ex={up:g({selector:ev,closest:(e,t,o)=>eh((e,t)=>F(e,t),ev,e,t,o),predicate:ef,all:(e,t)=>{let o=m(t)?t:h,r=e.dom,n=[];for(;null!==r.parentNode&&void 0!==r.parentNode;){let e=r.parentNode,t=q.fromDom(e);if(n.push(t),!0===o(t))break;r=e}return n}}),down:g({selector:(e,t)=>K(t,e),predicate:ep}),styles:g({get:(e,t)=>{let o=e.dom,r=window.getComputedStyle(o),n=r.getPropertyValue(t);return""!==n||ei(e)?n:es(o,t)},getRaw:(e,t)=>{let o=e.dom,r=es(o,t);return f.from(r).filter(e=>e.length>0)},set:(e,t,o)=>{let r=e.dom;ea(r,t,o)},remove:(e,t)=>{let o=e.dom;ed(o,t),U($(e,"style").map(Y),"")&&I(e,"style")}}),attrs:g({get:R,set:(e,t,o)=>{O(e.dom,t,o)},remove:I,copyTo:(e,t)=>{let o=V(e);L(t,o)}}),insert:g({before:em,after:ec,afterAll:eg,append:eu,appendAll:(e,t)=>{w(t,t=>{eu(e,t)})},prepend:(e,t)=>{let o=ee(e);o.fold(()=>{eu(e,t)},o=>{e.dom.insertBefore(t.dom,o.dom)})},wrap:(e,t)=>{em(e,t),eu(t,e)}}),remove:g({unwrap:e=>{let t=X(e);t.length>0&&eg(e,t),ey(e)},remove:ey}),create:g({nu:q.fromTag,clone:e=>q.fromDom(e.dom.cloneNode(!1)),text:q.fromText}),query:g({comparePosition:(e,t)=>e.dom.compareDocumentPosition(t.dom),prevSibling:e=>f.from(e.dom.previousSibling).map(q.fromDom),nextSibling:W}),property:g({children:X,name:x,parent:Q,document:e=>J(e).dom,isText:P,isComment:e=>8===E(e)||"#comment"===x(e),isElement:M,isSpecial:e=>{let t=x(e);return b(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},getLanguage:e=>M(e)?$(e,"lang"):f.none(),getText:e=>eT.get(e),setText:(e,t)=>eT.set(e,t),isBoundary:e=>!!M(e)&&("body"===x(e)||b(ew,x(e))),isEmptyTag:e=>!!M(e)&&b(["br","img","hr","input"],x(e)),isNonEditable:e=>M(e)&&"false"===R(e,"contenteditable")}),eq:(e,t)=>e.dom===t.dom,is:F},eE=e=>eS(ex,e),eD=(e,t,o)=>e.dispatch("ToggledAccordion",{element:t,state:o}),eM=(e,t,o)=>e.dispatch("ToggledAllAccordions",{elements:t,state:o}),eP="details",ek="mce-accordion",eB="mce-accordion-summary",eO="mce-accordion-body";var eL=tinymce.util.Tools.resolve("tinymce.util.Tools");let eR=e=>(null==e?void 0:e.nodeName)==="SUMMARY",e$=e=>(null==e?void 0:e.nodeName)==="DETAILS",eI=e=>e.hasAttribute("open"),eV=e=>{let t=e.selection.getNode();return eR(t)||!!e.dom.getParent(t,eR)},ej=e=>!eV(e)&&e.dom.isEditable(e.selection.getNode()),eq=e=>f.from(e.dom.getParent(e.selection.getNode(),e$)),eF=e=>eq(e).isSome(),eH=e=>(e.innerHTML='<br data-mce-bogus="1" />',e),eK=e=>eH(e.dom.create("p")),ez=e=>eH(e.dom.create("summary")),eU=(e,t)=>{let o=eK(e);t.insertAdjacentElement("afterend",o),e.selection.setCursorLocation(o,0)},eY=(e,t)=>{if(eR(null==t?void 0:t.lastChild)){let o=eK(e);t.appendChild(o),e.selection.setCursorLocation(o,0)}},e_=(e,t)=>{if(!eR(null==t?void 0:t.firstChild)){let o=ez(e);t.prepend(o),e.selection.setCursorLocation(o,0)}},eG=e=>t=>{eY(e,t),e_(e,t)},eJ=e=>{eL.each(eL.grep(e.dom.select("details",e.getBody())),eG(e))},eQ=e=>{if(!ej(e))return;let t=q.fromDom(e.getBody()),r=o("acc"),n=e.dom.encode(e.selection.getRng().toString()||e.translate("Accordion summary...")),l=e.dom.encode(e.translate("Accordion body...")),i=`<summary class="${eB}">${n}</summary>`,a=`<div class="${eO}"><p>${l}</p></div>`;e.undoManager.transact(()=>{e.insertContent([`<details data-mce-id="${r}" class="${ek}" open="open">`,i,a,"</details>"].join("")),eb(t,`[data-mce-id="${r}"]`).each(t=>{I(t,"data-mce-id"),eb(t,"summary").each(t=>{let o=e.dom.createRng(),r=eE(t);o.setStart(r.element.dom,r.offset),o.setEnd(r.element.dom,r.offset),e.selection.setRng(o)})})})},eW=(e,t)=>{let o=null!=t?t:!eI(e);return o?e.setAttribute("open","open"):e.removeAttribute("open"),o},eX=(e,t)=>{eq(e).each(o=>{eD(e,o,eW(o,t))})},eZ=e=>{eq(e).each(t=>{let{nextSibling:o}=t;o?(e.selection.select(o,!0),e.selection.collapse(!0)):eU(e,t),t.remove()})},e0=(e,t)=>{let o=Array.from(e.getBody().querySelectorAll("details"));0!==o.length&&(w(o,e=>eW(e,null!=t?t:!eI(e))),eM(e,o,t))},e1=e=>{e.addCommand("InsertAccordion",()=>eQ(e)),e.addCommand("ToggleAccordion",(t,o)=>eX(e,o)),e.addCommand("ToggleAllAccordions",(t,o)=>e0(e,o)),e.addCommand("RemoveAccordion",()=>eZ(e))};var e9=tinymce.util.Tools.resolve("tinymce.html.Node");let e3=e=>{var t,o;return null!==(o=null===(t=e.attr("class"))||void 0===t?void 0:t.split(" "))&&void 0!==o?o:[]},e2=(e,t)=>{let o=new Set([...e3(e),...t]),r=Array.from(o);r.length>0&&e.attr("class",r.join(" "))},e4=(e,t)=>{let o=A(e3(e),e=>!t.has(e));e.attr("class",o.length>0?o.join(" "):null)},e5=e=>e.name===eP&&b(e3(e),ek),e6=e=>"div"===e.name&&b(e3(e),eO),e8=e=>{let t,o;let r=e.children(),n=[];for(let e=0;e<r.length;e++){let l=r[e];"summary"===l.name&&d(t)?t=l:e6(l)&&d(o)?o=l:n.push(l)}return{summaryNode:t,wrapperNode:o,otherNodes:n}},e7=e=>{let t=new e9("br",1);t.attr("data-mce-bogus","1"),e.empty(),e.append(t)},te=e=>{e.on("PreInit",()=>{let{serializer:t,parser:o}=e;o.addNodeFilter(eP,e=>{for(let t=0;t<e.length;t++){let o=e[t];if(e5(o)){let{summaryNode:e,wrapperNode:t,otherNodes:r}=e8(o),n=s(e),l=n?e:new e9("summary",1);d(l.firstChild)&&e7(l),e2(l,[eB]),n||(s(o.firstChild)?o.insert(l,o.firstChild,!0):o.append(l));let i=s(t),a=i?t:new e9("div",1);if(e2(a,[eO]),r.length>0)for(let e=0;e<r.length;e++){let t=r[e];a.append(t)}if(d(a.firstChild)){let e=new e9("p",1);e7(e),a.append(e)}i||o.append(a)}}}),t.addNodeFilter(eP,e=>{let t=new Set([eB]);for(let o=0;o<e.length;o++){let r=e[o];if(e5(r)){let{summaryNode:e,wrapperNode:o}=e8(r);s(e)&&e4(e,t),s(o)&&o.unwrap()}}})})};var tt=tinymce.util.Tools.resolve("tinymce.util.VK");let to=e=>{e.on("keydown",t=>{!t.shiftKey&&t.keyCode===tt.ENTER&&eV(e)&&(t.preventDefault(),e.execCommand("ToggleAccordion"))})},tr=e=>{to(e),e.on("ExecCommand",t=>{let o=t.command.toLowerCase();("delete"===o||"forwarddelete"===o)&&eF(e)&&eJ(e)})},tn=e=>t=>{let o=()=>t.setEnabled(ej(e));return e.on("NodeChange",o),()=>e.off("NodeChange",o)},tl=e=>{let t=()=>e.execCommand("InsertAccordion");e.ui.registry.addButton("accordion",{icon:"accordion",tooltip:"Insert accordion",onSetup:tn(e),onAction:t}),e.ui.registry.addMenuItem("accordion",{icon:"accordion",text:"Accordion",onSetup:tn(e),onAction:t}),e.ui.registry.addToggleButton("accordiontoggle",{icon:"accordion-toggle",tooltip:"Toggle accordion",onAction:()=>e.execCommand("ToggleAccordion")}),e.ui.registry.addToggleButton("accordionremove",{icon:"remove",tooltip:"Delete accordion",onAction:()=>e.execCommand("RemoveAccordion")}),e.ui.registry.addContextToolbar("accordion",{predicate:t=>e.dom.is(t,"details")&&e.getBody().contains(t)&&e.dom.isEditable(t.parentNode),items:"accordiontoggle accordionremove",scope:"node",position:"node"})};e.add("accordion",e=>{tl(e),e1(e),tr(e),te(e)})}();