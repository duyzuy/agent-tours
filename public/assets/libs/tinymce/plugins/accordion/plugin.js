!function(){"use strict";var e,t=tinymce.util.Tools.resolve("tinymce.PluginManager");let o=0,generate=e=>{let t=new Date,r=t.getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++o+String(r)},hasProto=(e,t,o)=>{var r;return!!o(e,t.prototype)||(null===(r=e.constructor)||void 0===r?void 0:r.name)===t.name},typeOf=e=>{let t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&hasProto(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},isSimpleType=e=>t=>typeof t===e,isString=e=>"string"===typeOf(e),r=isSimpleType("boolean"),isNullable=e=>null==e,isNonNullable=e=>!isNullable(e),n=isSimpleType("function"),l=isSimpleType("number"),compose1=(e,t)=>o=>e(t(o)),constant=e=>()=>e,tripleEquals=(e,t)=>e===t,i=constant(!1);let Optional=class Optional{constructor(e,t){this.tag=e,this.value=t}static some(e){return new Optional(!0,e)}static none(){return Optional.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?Optional.some(e(this.value)):Optional.none()}bind(e){return this.tag?e(this.value):Optional.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:Optional.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return isNonNullable(e)?Optional.some(e):Optional.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}};Optional.singletonNone=new Optional(!1);let a=Array.prototype.indexOf,rawIndexOf=(e,t)=>a.call(e,t),contains=(e,t)=>rawIndexOf(e,t)>-1,map=(e,t)=>{let o=e.length,r=Array(o);for(let n=0;n<o;n++){let o=e[n];r[n]=t(o,n)}return r},each$1=(e,t)=>{for(let o=0,r=e.length;o<r;o++){let r=e[o];t(r,o)}},filter=(e,t)=>{let o=[];for(let r=0,n=e.length;r<n;r++){let n=e[r];t(n,r)&&o.push(n)}return o},foldl=(e,t,o)=>(each$1(e,(e,r)=>{o=t(o,e,r)}),o),s=Object.keys,each=(e,t)=>{let o=s(e);for(let r=0,n=o.length;r<n;r++){let n=o[r],l=e[n];t(l,n)}};"undefined"!=typeof window?window:Function("return this;")();let name=e=>{let t=e.dom.nodeName;return t.toLowerCase()},type=e=>e.dom.nodeType,isType=e=>t=>type(t)===e,d=isType(1),c=isType(3),m=isType(9),p=isType(11),rawSet=(e,t,o)=>{if(isString(o)||r(o)||l(o))e.setAttribute(t,o+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",e),Error("Attribute value was not simple")},setAll=(e,t)=>{let o=e.dom;each(t,(e,t)=>{rawSet(o,t,e)})},get$2=(e,t)=>{let o=e.dom.getAttribute(t);return null===o?void 0:o},getOpt=(e,t)=>Optional.from(get$2(e,t)),remove$2=(e,t)=>{e.dom.removeAttribute(t)},clone=e=>foldl(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),fromDom=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},u={fromHtml:(e,t)=>{let o=t||document,r=o.createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||r.childNodes.length>1){let t="HTML does not have a single root node";throw console.error(t,e),Error(t)}return fromDom(r.childNodes[0])},fromTag:(e,t)=>{let o=t||document,r=o.createElement(e);return fromDom(r)},fromText:(e,t)=>{let o=t||document,r=o.createTextNode(e);return fromDom(r)},fromDom,fromPoint:(e,t,o)=>Optional.from(e.dom.elementFromPoint(t,o)).map(fromDom)},is$2=(e,t)=>{let o=e.dom;if(1!==o.nodeType)return!1;if(void 0!==o.matches)return o.matches(t);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(t);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(t);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(t);throw Error("Browser lacks native selectors")},bypassSelector=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,all=(e,t)=>{let o=void 0===t?document:t.dom;return bypassSelector(o)?[]:map(o.querySelectorAll(e),u.fromDom)},one=(e,t)=>{let o=void 0===t?document:t.dom;return bypassSelector(o)?Optional.none():Optional.from(o.querySelector(e)).map(u.fromDom)},is=(e,t,o=tripleEquals)=>e.exists(e=>o(e,t)),g=(e=/^\s+|\s+$/g,t=>t.replace(e,"")),isSupported=e=>void 0!==e.style&&n(e.style.getPropertyValue),owner=e=>u.fromDom(e.dom.ownerDocument),documentOrOwner=e=>m(e)?e:owner(e),parent=e=>Optional.from(e.dom.parentNode).map(u.fromDom),nextSibling=e=>Optional.from(e.dom.nextSibling).map(u.fromDom),children=e=>map(e.dom.childNodes,u.fromDom),child=(e,t)=>{let o=e.dom.childNodes;return Optional.from(o[t]).map(u.fromDom)},firstChild=e=>child(e,0),isShadowRoot=e=>p(e)&&isNonNullable(e.dom.host),h=n(Element.prototype.attachShadow)&&n(Node.prototype.getRootNode),f=h?e=>u.fromDom(e.dom.getRootNode()):documentOrOwner,getShadowRoot=e=>{let t=f(e);return isShadowRoot(t)?Optional.some(t):Optional.none()},getShadowHost=e=>u.fromDom(e.dom.host),inBody=e=>{let t=c(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;let o=t.ownerDocument;return getShadowRoot(u.fromDom(t)).fold(()=>o.body.contains(t),compose1(inBody,getShadowHost))},internalSet=(e,t,o)=>{if(!isString(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),Error("CSS value must be a string: "+o);isSupported(e)&&e.style.setProperty(t,o)},internalRemove=(e,t)=>{isSupported(e)&&e.style.removeProperty(t)},getUnsafeProperty=(e,t)=>isSupported(e)?e.style.getPropertyValue(t):"",before=(e,t)=>{let o=parent(e);o.each(o=>{o.dom.insertBefore(t.dom,e.dom)})},after$1=(e,t)=>{let o=nextSibling(e);o.fold(()=>{let o=parent(e);o.each(e=>{append$1(e,t)})},e=>{before(e,t)})},append$1=(e,t)=>{e.dom.appendChild(t.dom)},after=(e,t)=>{each$1(t,(o,r)=>{let n=0===r?e:t[r-1];after$1(n,o)})},descendants$1=(e,t)=>{let o=[];return each$1(children(e),e=>{t(e)&&(o=o.concat([e])),o=o.concat(descendants$1(e,t))}),o};var ClosestOrAncestor=(e,t,o,r,l)=>e(o,r)?Optional.some(o):n(l)&&l(o)?Optional.none():t(o,r,l);let ancestor$1=(e,t,o)=>{let r=e.dom,l=n(o)?o:i;for(;r.parentNode;){r=r.parentNode;let e=u.fromDom(r);if(t(e))return Optional.some(e);if(l(e))break}return Optional.none()},remove=e=>{let t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},ancestor=(e,t,o)=>ancestor$1(e,e=>is$2(e,t),o),descendant=(e,t)=>one(t,e),y=((e,t)=>{let getOption=t=>e(t)?Optional.from(t.dom.nodeValue):Optional.none();return{get:o=>{if(!e(o))throw Error("Can only get "+t+" value of a "+t+" node");return getOption(o).getOr("")},getOption,set:(o,r)=>{if(!e(o))throw Error("Can only set raw "+t+" value of a "+t+" node");o.dom.nodeValue=r}}})(c,"text");var v=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];let point=(e,t)=>({element:e,offset:t}),scan=(e,t,o)=>e.property().isText(t)&&0===e.property().getText(t).trim().length||e.property().isComment(t)?o(t).bind(t=>scan(e,t,o).orThunk(()=>Optional.some(t))):Optional.none(),toEnd=(e,t)=>{if(e.property().isText(t))return e.property().getText(t).length;let o=e.property().children(t);return o.length},freefallRtl$2=(e,t)=>{let o=scan(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(o))return point(o,toEnd(e,o));let r=e.property().children(o);return r.length>0?freefallRtl$2(e,r[r.length-1]):point(o,toEnd(e,o))},S={up:constant({selector:ancestor,closest:(e,t,o)=>ClosestOrAncestor((e,t)=>is$2(e,t),ancestor,e,t,o),predicate:ancestor$1,all:(e,t)=>{let o=n(t)?t:i,r=e.dom,l=[];for(;null!==r.parentNode&&void 0!==r.parentNode;){let e=r.parentNode,t=u.fromDom(e);if(l.push(t),!0===o(t))break;r=e}return l}}),down:constant({selector:(e,t)=>all(t,e),predicate:descendants$1}),styles:constant({get:(e,t)=>{let o=e.dom,r=window.getComputedStyle(o),n=r.getPropertyValue(t);return""!==n||inBody(e)?n:getUnsafeProperty(o,t)},getRaw:(e,t)=>{let o=e.dom,r=getUnsafeProperty(o,t);return Optional.from(r).filter(e=>e.length>0)},set:(e,t,o)=>{let r=e.dom;internalSet(r,t,o)},remove:(e,t)=>{let o=e.dom;internalRemove(o,t),is(getOpt(e,"style").map(g),"")&&remove$2(e,"style")}}),attrs:constant({get:get$2,set:(e,t,o)=>{rawSet(e.dom,t,o)},remove:remove$2,copyTo:(e,t)=>{let o=clone(e);setAll(t,o)}}),insert:constant({before:before,after:after$1,afterAll:after,append:append$1,appendAll:(e,t)=>{each$1(t,t=>{append$1(e,t)})},prepend:(e,t)=>{let o=firstChild(e);o.fold(()=>{append$1(e,t)},o=>{e.dom.insertBefore(t.dom,o.dom)})},wrap:(e,t)=>{before(e,t),append$1(t,e)}}),remove:constant({unwrap:e=>{let t=children(e);t.length>0&&after(e,t),remove(e)},remove:remove}),create:constant({nu:u.fromTag,clone:e=>u.fromDom(e.dom.cloneNode(!1)),text:u.fromText}),query:constant({comparePosition:(e,t)=>e.dom.compareDocumentPosition(t.dom),prevSibling:e=>Optional.from(e.dom.previousSibling).map(u.fromDom),nextSibling:nextSibling}),property:constant({children:children,name:name,parent:parent,document:e=>documentOrOwner(e).dom,isText:c,isComment:e=>8===type(e)||"#comment"===name(e),isElement:d,isSpecial:e=>{let t=name(e);return contains(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},getLanguage:e=>d(e)?getOpt(e,"lang"):Optional.none(),getText:e=>y.get(e),setText:(e,t)=>y.set(e,t),isBoundary:e=>!!d(e)&&("body"===name(e)||contains(v,name(e))),isEmptyTag:e=>!!d(e)&&contains(["br","img","hr","input"],name(e)),isNonEditable:e=>d(e)&&"false"===get$2(e,"contenteditable")}),eq:(e,t)=>e.dom===t.dom,is:is$2},freefallRtl=e=>freefallRtl$2(S,e),fireToggleAccordionEvent=(e,t,o)=>e.dispatch("ToggledAccordion",{element:t,state:o}),fireToggleAllAccordionsEvent=(e,t,o)=>e.dispatch("ToggledAllAccordions",{elements:t,state:o}),A="details",b="mce-accordion",N="mce-accordion-summary",O="mce-accordion-body";var w=tinymce.util.Tools.resolve("tinymce.util.Tools");let isSummary=e=>(null==e?void 0:e.nodeName)==="SUMMARY",isDetails=e=>(null==e?void 0:e.nodeName)==="DETAILS",isOpen=e=>e.hasAttribute("open"),isInSummary=e=>{let t=e.selection.getNode();return isSummary(t)||!!e.dom.getParent(t,isSummary)},isInsertAllowed=e=>!isInSummary(e)&&e.dom.isEditable(e.selection.getNode()),getSelectedDetails=e=>Optional.from(e.dom.getParent(e.selection.getNode(),isDetails)),isDetailsSelected=e=>getSelectedDetails(e).isSome(),insertBogus=e=>(e.innerHTML='<br data-mce-bogus="1" />',e),createParagraph=e=>insertBogus(e.dom.create("p")),createSummary=e=>insertBogus(e.dom.create("summary")),insertAndSelectParagraphAfter=(e,t)=>{let o=createParagraph(e);t.insertAdjacentElement("afterend",o),e.selection.setCursorLocation(o,0)},normalizeContent=(e,t)=>{if(isSummary(null==t?void 0:t.lastChild)){let o=createParagraph(e);t.appendChild(o),e.selection.setCursorLocation(o,0)}},normalizeSummary=(e,t)=>{if(!isSummary(null==t?void 0:t.firstChild)){let o=createSummary(e);t.prepend(o),e.selection.setCursorLocation(o,0)}},normalizeAccordion=e=>t=>{normalizeContent(e,t),normalizeSummary(e,t)},normalizeDetails=e=>{w.each(w.grep(e.dom.select("details",e.getBody())),normalizeAccordion(e))},insertAccordion=e=>{if(!isInsertAllowed(e))return;let t=u.fromDom(e.getBody()),o=generate("acc"),r=e.dom.encode(e.selection.getRng().toString()||e.translate("Accordion summary...")),n=e.dom.encode(e.translate("Accordion body...")),l=`<summary class="${N}">${r}</summary>`,i=`<div class="${O}"><p>${n}</p></div>`;e.undoManager.transact(()=>{e.insertContent([`<details data-mce-id="${o}" class="${b}" open="open">`,l,i,"</details>"].join("")),descendant(t,`[data-mce-id="${o}"]`).each(t=>{remove$2(t,"data-mce-id"),descendant(t,"summary").each(t=>{let o=e.dom.createRng(),r=freefallRtl(t);o.setStart(r.element.dom,r.offset),o.setEnd(r.element.dom,r.offset),e.selection.setRng(o)})})})},toggleDetailsElement=(e,t)=>{let o=null!=t?t:!isOpen(e);return o?e.setAttribute("open","open"):e.removeAttribute("open"),o},toggleAccordion=(e,t)=>{getSelectedDetails(e).each(o=>{fireToggleAccordionEvent(e,o,toggleDetailsElement(o,t))})},removeAccordion=e=>{getSelectedDetails(e).each(t=>{let{nextSibling:o}=t;o?(e.selection.select(o,!0),e.selection.collapse(!0)):insertAndSelectParagraphAfter(e,t),t.remove()})},toggleAllAccordions=(e,t)=>{let o=Array.from(e.getBody().querySelectorAll("details"));0!==o.length&&(each$1(o,e=>toggleDetailsElement(e,null!=t?t:!isOpen(e))),fireToggleAllAccordionsEvent(e,o,t))},register$1=e=>{e.addCommand("InsertAccordion",()=>insertAccordion(e)),e.addCommand("ToggleAccordion",(t,o)=>toggleAccordion(e,o)),e.addCommand("ToggleAllAccordions",(t,o)=>toggleAllAccordions(e,o)),e.addCommand("RemoveAccordion",()=>removeAccordion(e))};var C=tinymce.util.Tools.resolve("tinymce.html.Node");let getClassList=e=>{var t,o;return null!==(o=null===(t=e.attr("class"))||void 0===t?void 0:t.split(" "))&&void 0!==o?o:[]},addClasses=(e,t)=>{let o=new Set([...getClassList(e),...t]),r=Array.from(o);r.length>0&&e.attr("class",r.join(" "))},removeClasses=(e,t)=>{let o=filter(getClassList(e),e=>!t.has(e));e.attr("class",o.length>0?o.join(" "):null)},isAccordionDetailsNode=e=>e.name===A&&contains(getClassList(e),b),isAccordionBodyWrapperNode=e=>"div"===e.name&&contains(getClassList(e),O),getAccordionChildren=e=>{let t,o;let r=e.children(),n=[];for(let e=0;e<r.length;e++){let l=r[e];"summary"===l.name&&isNullable(t)?t=l:isAccordionBodyWrapperNode(l)&&isNullable(o)?o=l:n.push(l)}return{summaryNode:t,wrapperNode:o,otherNodes:n}},padInputNode=e=>{let t=new C("br",1);t.attr("data-mce-bogus","1"),e.empty(),e.append(t)},setup$1=e=>{e.on("PreInit",()=>{let{serializer:t,parser:o}=e;o.addNodeFilter(A,e=>{for(let t=0;t<e.length;t++){let o=e[t];if(isAccordionDetailsNode(o)){let{summaryNode:e,wrapperNode:t,otherNodes:r}=getAccordionChildren(o),n=isNonNullable(e),l=n?e:new C("summary",1);isNullable(l.firstChild)&&padInputNode(l),addClasses(l,[N]),n||(isNonNullable(o.firstChild)?o.insert(l,o.firstChild,!0):o.append(l));let i=isNonNullable(t),a=i?t:new C("div",1);if(addClasses(a,[O]),r.length>0)for(let e=0;e<r.length;e++){let t=r[e];a.append(t)}if(isNullable(a.firstChild)){let e=new C("p",1);padInputNode(e),a.append(e)}i||o.append(a)}}}),t.addNodeFilter(A,e=>{let t=new Set([N]);for(let o=0;o<e.length;o++){let r=e[o];if(isAccordionDetailsNode(r)){let{summaryNode:e,wrapperNode:o}=getAccordionChildren(r);isNonNullable(e)&&removeClasses(e,t),isNonNullable(o)&&o.unwrap()}}})})};var T=tinymce.util.Tools.resolve("tinymce.util.VK");let setupEnterKeyInSummary=e=>{e.on("keydown",t=>{!t.shiftKey&&t.keyCode===T.ENTER&&isInSummary(e)&&(t.preventDefault(),e.execCommand("ToggleAccordion"))})},setup=e=>{setupEnterKeyInSummary(e),e.on("ExecCommand",t=>{let o=t.command.toLowerCase();("delete"===o||"forwarddelete"===o)&&isDetailsSelected(e)&&normalizeDetails(e)})},onSetup=e=>t=>{let onNodeChange=()=>t.setEnabled(isInsertAllowed(e));return e.on("NodeChange",onNodeChange),()=>e.off("NodeChange",onNodeChange)},register=e=>{let onAction=()=>e.execCommand("InsertAccordion");e.ui.registry.addButton("accordion",{icon:"accordion",tooltip:"Insert accordion",onSetup:onSetup(e),onAction}),e.ui.registry.addMenuItem("accordion",{icon:"accordion",text:"Accordion",onSetup:onSetup(e),onAction}),e.ui.registry.addToggleButton("accordiontoggle",{icon:"accordion-toggle",tooltip:"Toggle accordion",onAction:()=>e.execCommand("ToggleAccordion")}),e.ui.registry.addToggleButton("accordionremove",{icon:"remove",tooltip:"Delete accordion",onAction:()=>e.execCommand("RemoveAccordion")}),e.ui.registry.addContextToolbar("accordion",{predicate:t=>e.dom.is(t,"details")&&e.getBody().contains(t)&&e.dom.isEditable(t.parentNode),items:"accordiontoggle accordionremove",scope:"node",position:"node"})};t.add("accordion",e=>{register(e),register$1(e),setup(e),setup$1(e)})}();