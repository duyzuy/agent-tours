!function(){"use strict";var e,r=tinymce.util.Tools.resolve("tinymce.PluginManager");let a=0,o=e=>r=>typeof r===e,n=e=>"string"===(e=>{var r,a;let d=typeof e;return null===e?"null":"object"===d&&Array.isArray(e)?"array":"object"===d&&((r=String).prototype.isPrototypeOf(e)||(null===(a=e.constructor)||void 0===a?void 0:a.name)===r.name)?"string":d})(e),d=o("boolean"),s=e=>null==e,i=e=>!s(e),m=o("function"),p=o("number"),l=e=>()=>e,c=(e,r)=>e===r,y=l(!1);let u=class u{constructor(e,r){this.tag=e,this.value=r}static some(e){return new u(!0,e)}static none(){return u.singletonNone}fold(e,r){return this.tag?r(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?u.some(e(this.value)):u.none()}bind(e){return this.tag?e(this.value):u.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:u.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return i(e)?u.some(e):u.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}};u.singletonNone=new u(!1);let N=Array.prototype.indexOf,g=(e,r)=>N.call(e,r)>-1,h=(e,r)=>{let a=e.length,d=Array(a);for(let m=0;m<a;m++){let a=e[m];d[m]=r(a,m)}return d},f=(e,r)=>{for(let a=0,d=e.length;a<d;a++)r(e[a],a)},T=Object.keys;"undefined"!=typeof window?window:Function("return this;")();let v=e=>e.dom.nodeName.toLowerCase(),w=e=>e.dom.nodeType,b=e=>r=>w(r)===e,A=b(1),C=b(3),P=b(9),O=b(11),S=(e,r,a)=>{if(!(n(a)||d(a)||p(a)))throw console.error("Invalid call to Attribute.set. Key ",r,":: Value ",a,":: Element ",e),Error("Attribute value was not simple");e.setAttribute(r,a+"")},x=(e,r)=>{let a=e.dom.getAttribute(r);return null===a?void 0:a},D=(e,r)=>u.from(x(e,r)),E=(e,r)=>{e.dom.removeAttribute(r)},M=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},L={fromHtml:(e,r)=>{let a=(r||document).createElement("div");if(a.innerHTML=e,!a.hasChildNodes()||a.childNodes.length>1){let r="HTML does not have a single root node";throw console.error(r,e),Error(r)}return M(a.childNodes[0])},fromTag:(e,r)=>{let a=(r||document).createElement(e);return M(a)},fromText:(e,r)=>{let a=(r||document).createTextNode(e);return M(a)},fromDom:M,fromPoint:(e,r,a)=>u.from(e.dom.elementFromPoint(r,a)).map(M)},k=(e,r)=>{let a=e.dom;if(1!==a.nodeType)return!1;if(void 0!==a.matches)return a.matches(r);if(void 0!==a.msMatchesSelector)return a.msMatchesSelector(r);if(void 0!==a.webkitMatchesSelector)return a.webkitMatchesSelector(r);if(void 0!==a.mozMatchesSelector)return a.mozMatchesSelector(r);throw Error("Browser lacks native selectors")},B=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,$=(e=/^\s+|\s+$/g,r=>r.replace(e,"")),R=e=>void 0!==e.style&&m(e.style.getPropertyValue),I=e=>P(e)?e:L.fromDom(e.dom.ownerDocument),V=e=>u.from(e.dom.parentNode).map(L.fromDom),j=e=>u.from(e.dom.nextSibling).map(L.fromDom),q=e=>h(e.dom.childNodes,L.fromDom),F=m(Element.prototype.attachShadow)&&m(Node.prototype.getRootNode)?e=>L.fromDom(e.dom.getRootNode()):I,H=e=>L.fromDom(e.dom.host),z=e=>{let r=C(e)?e.dom.parentNode:e.dom;if(null==r||null===r.ownerDocument)return!1;let a=r.ownerDocument;return(e=>{let r=F(e);return O(r)&&i(r.dom.host)?u.some(r):u.none()})(L.fromDom(r)).fold(()=>a.body.contains(r),e=>z(H(e)))},K=(e,r)=>R(e)?e.style.getPropertyValue(r):"",U=(e,r)=>{V(e).each(a=>{a.dom.insertBefore(r.dom,e.dom)})},Y=(e,r)=>{j(e).fold(()=>{V(e).each(e=>{_(e,r)})},e=>{U(e,r)})},_=(e,r)=>{e.dom.appendChild(r.dom)},G=(e,r)=>{f(r,(a,d)=>{let m=0===d?e:r[d-1];Y(m,a)})},J=(e,r)=>{let a=[];return f(q(e),e=>{r(e)&&(a=a.concat([e])),a=a.concat(J(e,r))}),a},Q=(e,r,a)=>{let d=e.dom,p=m(a)?a:y;for(;d.parentNode;){d=d.parentNode;let e=L.fromDom(d);if(r(e))return u.some(e);if(p(e))break}return u.none()},W=e=>{let r=e.dom;null!==r.parentNode&&r.parentNode.removeChild(r)},X=(e,r,a)=>Q(e,e=>k(e,r),a),Z=(e,r)=>((e,r)=>{let a=void 0===r?document:r.dom;return B(a)?u.none():u.from(a.querySelector(e)).map(L.fromDom)})(r,e),ee=((e,r)=>{let o=r=>e(r)?u.from(r.dom.nodeValue):u.none();return{get:r=>{if(!e(r))throw Error("Can only get text value of a text node");return o(r).getOr("")},getOption:o,set:(r,a)=>{if(!e(r))throw Error("Can only set raw text value of a text node");r.dom.nodeValue=a}}})(C);var et=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];let oe=(e,r)=>({element:e,offset:r}),ne=(e,r,a)=>e.property().isText(r)&&0===e.property().getText(r).trim().length||e.property().isComment(r)?a(r).bind(r=>ne(e,r,a).orThunk(()=>u.some(r))):u.none(),re=(e,r)=>e.property().isText(r)?e.property().getText(r).length:e.property().children(r).length,se=(e,r)=>{let a=ne(e,r,e.query().prevSibling).getOr(r);if(e.property().isText(a))return oe(a,re(e,a));let d=e.property().children(a);return d.length>0?se(e,d[d.length-1]):oe(a,re(e,a))},eo={up:l({selector:X,closest:(e,r,a)=>k(e,r)?u.some(e):m(a)&&a(e)?u.none():X(e,r,a),predicate:Q,all:(e,r)=>{let a=m(r)?r:y,d=e.dom,p=[];for(;null!==d.parentNode&&void 0!==d.parentNode;){let e=d.parentNode,r=L.fromDom(e);if(p.push(r),!0===a(r))break;d=e}return p}}),down:l({selector:(e,r)=>((e,r)=>{let a=void 0===r?document:r.dom;return B(a)?[]:h(a.querySelectorAll(e),L.fromDom)})(r,e),predicate:J}),styles:l({get:(e,r)=>{let a=e.dom,d=window.getComputedStyle(a).getPropertyValue(r);return""!==d||z(e)?d:K(a,r)},getRaw:(e,r)=>{let a=e.dom,d=K(a,r);return u.from(d).filter(e=>e.length>0)},set:(e,r,a)=>{((e,r,a)=>{if(!n(a))throw console.error("Invalid call to CSS.set. Property ",r,":: Value ",a,":: Element ",e),Error("CSS value must be a string: "+a);R(e)&&e.style.setProperty(r,a)})(e.dom,r,a)},remove:(e,r)=>{var a;R(a=e.dom)&&a.style.removeProperty(r),((e,r,a=c)=>e.exists(e=>a(e,"")))(D(e,"style").map($),0)&&E(e,"style")}}),attrs:l({get:x,set:(e,r,a)=>{S(e.dom,r,a)},remove:E,copyTo:(e,r)=>{var a,d,m;let p=(a=e.dom.attributes,d=(e,r)=>(e[r.name]=r.value,e),m={},f(a,(e,r)=>{m=d(m,e)}),m);((e,r)=>{let a=e.dom;((e,r)=>{let a=T(e);for(let d=0,m=a.length;d<m;d++){let m=a[d];r(e[m],m)}})(r,(e,r)=>{S(a,r,e)})})(r,p)}}),insert:l({before:U,after:Y,afterAll:G,append:_,appendAll:(e,r)=>{f(r,r=>{_(e,r)})},prepend:(e,r)=>{((e,r)=>{let a=e.dom.childNodes;return u.from(a[0]).map(L.fromDom)})(e).fold(()=>{_(e,r)},a=>{e.dom.insertBefore(r.dom,a.dom)})},wrap:(e,r)=>{U(e,r),_(r,e)}}),remove:l({unwrap:e=>{let r=q(e);r.length>0&&G(e,r),W(e)},remove:W}),create:l({nu:L.fromTag,clone:e=>L.fromDom(e.dom.cloneNode(!1)),text:L.fromText}),query:l({comparePosition:(e,r)=>e.dom.compareDocumentPosition(r.dom),prevSibling:e=>u.from(e.dom.previousSibling).map(L.fromDom),nextSibling:j}),property:l({children:q,name:v,parent:V,document:e=>I(e).dom,isText:C,isComment:e=>8===w(e)||"#comment"===v(e),isElement:A,isSpecial:e=>{let r=v(e);return g(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],r)},getLanguage:e=>A(e)?D(e,"lang"):u.none(),getText:e=>ee.get(e),setText:(e,r)=>ee.set(e,r),isBoundary:e=>!!A(e)&&("body"===v(e)||g(et,v(e))),isEmptyTag:e=>!!A(e)&&g(["br","img","hr","input"],v(e)),isNonEditable:e=>A(e)&&"false"===x(e,"contenteditable")}),eq:(e,r)=>e.dom===r.dom,is:k},er="details",en="mce-accordion",el="mce-accordion-summary",ei="mce-accordion-body";var ea=tinymce.util.Tools.resolve("tinymce.util.Tools");let ge=e=>"SUMMARY"===(null==e?void 0:e.nodeName),he=e=>"DETAILS"===(null==e?void 0:e.nodeName),fe=e=>e.hasAttribute("open"),ye=e=>{let r=e.selection.getNode();return ge(r)||!!e.dom.getParent(r,ge)},ve=e=>!ye(e)&&e.dom.isEditable(e.selection.getNode()),we=e=>u.from(e.dom.getParent(e.selection.getNode(),he)),be=e=>(e.innerHTML='<br data-mce-bogus="1" />',e),Ne=e=>be(e.dom.create("p")),Te=e=>r=>{((e,r)=>{if(ge(null==r?void 0:r.lastChild)){let a=Ne(e);r.appendChild(a),e.selection.setCursorLocation(a,0)}})(e,r),((e,r)=>{if(!ge(null==r?void 0:r.firstChild)){let a=be(e.dom.create("summary"));r.prepend(a),e.selection.setCursorLocation(a,0)}})(e,r)},Ae=(e,r)=>{let a=null!=r?r:!fe(e);return a?e.setAttribute("open","open"):e.removeAttribute("open"),a},Ce=e=>{e.addCommand("InsertAccordion",()=>(e=>{if(!ve(e))return;let r=L.fromDom(e.getBody()),d=(e=>{let r=(new Date).getTime();return"acc_"+Math.floor(1e9*Math.random())+ ++a+String(r)})(),m=e.dom.encode(e.selection.getRng().toString()||e.translate("Accordion summary...")),p=e.dom.encode(e.translate("Accordion body...")),y=`<summary class="${el}">${m}</summary>`,N=`<div class="${ei}"><p>${p}</p></div>`;e.undoManager.transact(()=>{e.insertContent([`<details data-mce-id="${d}" class="${en}" open="open">`,y,N,"</details>"].join("")),Z(r,`[data-mce-id="${d}"]`).each(r=>{E(r,"data-mce-id"),Z(r,"summary").each(r=>{let a=e.dom.createRng(),d=se(eo,r);a.setStart(d.element.dom,d.offset),a.setEnd(d.element.dom,d.offset),e.selection.setRng(a)})})})})(e)),e.addCommand("ToggleAccordion",(r,a)=>((e,r)=>{we(e).each(a=>{((e,r,a)=>{e.dispatch("ToggledAccordion",{element:r,state:a})})(e,a,Ae(a,r))})})(e,a)),e.addCommand("ToggleAllAccordions",(r,a)=>((e,r)=>{let a=Array.from(e.getBody().querySelectorAll("details"));0!==a.length&&(f(a,e=>Ae(e,null!=r?r:!fe(e))),((e,r,a)=>{e.dispatch("ToggledAllAccordions",{elements:r,state:a})})(e,a,r))})(e,a)),e.addCommand("RemoveAccordion",()=>(e=>{we(e).each(r=>{let{nextSibling:a}=r;a?(e.selection.select(a,!0),e.selection.collapse(!0)):((e,r)=>{let a=Ne(e);r.insertAdjacentElement("afterend",a),e.selection.setCursorLocation(a,0)})(e,r),r.remove()})})(e))};var ed=tinymce.util.Tools.resolve("tinymce.html.Node");let xe=e=>{var r,a;return null!==(a=null===(r=e.attr("class"))||void 0===r?void 0:r.split(" "))&&void 0!==a?a:[]},De=(e,r)=>{let a=new Set([...xe(e),...r]),d=Array.from(a);d.length>0&&e.attr("class",d.join(" "))},Ee=(e,r)=>{let a=((e,a)=>{let d=[];for(let a=0,m=e.length;a<m;a++){let m=e[a];r.has(m)||d.push(m)}return d})(xe(e));e.attr("class",a.length>0?a.join(" "):null)},Me=e=>e.name===er&&g(xe(e),en),Pe=e=>{let r,a;let d=e.children(),m=[];for(let e=0;e<d.length;e++){let p=d[e];"summary"===p.name&&s(r)?r=p:"div"===p.name&&g(xe(p),ei)&&s(a)?a=p:m.push(p)}return{summaryNode:r,wrapperNode:a,otherNodes:m}},ke=e=>{let r=new ed("br",1);r.attr("data-mce-bogus","1"),e.empty(),e.append(r)};var es=tinymce.util.Tools.resolve("tinymce.util.VK");let Oe=e=>r=>{let o=()=>r.setEnabled(ve(e));return e.on("NodeChange",o),()=>e.off("NodeChange",o)};r.add("accordion",e=>{(e=>{let t=()=>e.execCommand("InsertAccordion");e.ui.registry.addButton("accordion",{icon:"accordion",tooltip:"Insert accordion",onSetup:Oe(e),onAction:t}),e.ui.registry.addMenuItem("accordion",{icon:"accordion",text:"Accordion",onSetup:Oe(e),onAction:t}),e.ui.registry.addToggleButton("accordiontoggle",{icon:"accordion-toggle",tooltip:"Toggle accordion",onAction:()=>e.execCommand("ToggleAccordion")}),e.ui.registry.addToggleButton("accordionremove",{icon:"remove",tooltip:"Delete accordion",onAction:()=>e.execCommand("RemoveAccordion")}),e.ui.registry.addContextToolbar("accordion",{predicate:r=>e.dom.is(r,"details")&&e.getBody().contains(r)&&e.dom.isEditable(r.parentNode),items:"accordiontoggle accordionremove",scope:"node",position:"node"})})(e),Ce(e),(e=>{e.on("keydown",r=>{!r.shiftKey&&r.keyCode===es.ENTER&&ye(e)&&(r.preventDefault(),e.execCommand("ToggleAccordion"))})})(e),e.on("ExecCommand",r=>{let a=r.command.toLowerCase();("delete"===a||"forwarddelete"===a)&&we(e).isSome()&&ea.each(ea.grep(e.dom.select("details",e.getBody())),Te(e))}),(e=>{e.on("PreInit",()=>{let{serializer:r,parser:a}=e;a.addNodeFilter(er,e=>{for(let r=0;r<e.length;r++){let a=e[r];if(Me(a)){let{summaryNode:e,wrapperNode:r,otherNodes:d}=Pe(a),m=i(e),p=m?e:new ed("summary",1);s(p.firstChild)&&ke(p),De(p,[el]),m||(i(a.firstChild)?a.insert(p,a.firstChild,!0):a.append(p));let y=i(r),N=y?r:new ed("div",1);if(De(N,[ei]),d.length>0)for(let e=0;e<d.length;e++){let r=d[e];N.append(r)}if(s(N.firstChild)){let e=new ed("p",1);ke(e),N.append(e)}y||a.append(N)}}}),r.addNodeFilter(er,e=>{let r=new Set([el]);for(let a=0;a<e.length;a++){let d=e[a];if(Me(d)){let{summaryNode:e,wrapperNode:a}=Pe(d);i(e)&&Ee(e,r),i(a)&&a.unwrap()}}})})})(e)})}();