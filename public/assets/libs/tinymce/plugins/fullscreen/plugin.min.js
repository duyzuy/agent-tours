!function(){"use strict";let t,l;let e=t=>{let l=t;return{get:()=>l,set:t=>{l=t}}};var i,a=tinymce.util.Tools.resolve("tinymce.PluginManager");let n=t=>l=>(t=>{var l,i;let a=typeof t;return null===t?"null":"object"===a&&Array.isArray(t)?"array":"object"===a&&((l=String).prototype.isPrototypeOf(t)||(null===(i=t.constructor)||void 0===i?void 0:i.name)===l.name)?"string":a})(l)===t,r=t=>l=>typeof l===t,o=t=>l=>t===l,d=n("string"),c=n("array"),m=o(null),p=r("boolean"),f=o(void 0),u=t=>null!=t,S=r("function"),T=r("number"),h=()=>{},g=t=>()=>t,A=g(!1),M=g(!0);let w=class w{constructor(t,l){this.tag=t,this.value=l}static some(t){return new w(!0,t)}static none(){return w.singletonNone}fold(t,l){return this.tag?l(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?w.some(t(this.value)):w.none()}bind(t){return this.tag?t(this.value):w.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:w.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw Error(null!=t?t:"Called getOrDie on None")}static from(t){return u(t)?w.some(t):w.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}};w.singletonNone=new w(!1);let y=t=>{let l=e(w.none()),r=()=>l.get().each(t);return{clear:()=>{r(),l.set(w.none())},isSet:()=>l.get().isSome(),get:()=>l.get(),set:t=>{r(),l.set(w.some(t))}}},b=()=>y(t=>t.unbind()),N=Array.prototype.push,x=(t,l)=>{let i=t.length,a=Array(i);for(let d=0;d<i;d++){let i=t[d];a[d]=l(i,d)}return a},E=(t,l)=>{for(let i=0,a=t.length;i<a;i++)l(t[i],i)},F=(t,l)=>{let i=[];for(let a=0,d=t.length;a<d;a++){let d=t[a];l(d,a)&&i.push(d)}return i},O=(t,l)=>((t,l,i)=>{for(let a=0,d=t.length;a<d;a++){let d=t[a];if(l(d,a))return w.some(d);if(i(d,a))break}return w.none()})(t,l,A),P=Object.keys,k=(t,l,i=0,a)=>{let d=t.indexOf(l,i);return -1!==d&&(!!f(a)||d+l.length<=a)},C=t=>void 0!==t.style&&S(t.style.getPropertyValue),R=t=>{if(null==t)throw Error("Node cannot be null or undefined");return{dom:t}};"undefined"!=typeof window?window:Function("return this;")();let L=t=>l=>l.dom.nodeType===t,D=L(1),I=L(3),B=L(9),V=L(11),W=(t,l)=>{let i=t.dom;if(1!==i.nodeType)return!1;if(void 0!==i.matches)return i.matches(l);if(void 0!==i.msMatchesSelector)return i.msMatchesSelector(l);if(void 0!==i.webkitMatchesSelector)return i.webkitMatchesSelector(l);if(void 0!==i.mozMatchesSelector)return i.mozMatchesSelector(l);throw Error("Browser lacks native selectors")},q=t=>R(t.dom.ownerDocument),H=t=>x(t.dom.childNodes,R),G=S(Element.prototype.attachShadow)&&S(Node.prototype.getRootNode),ee=g(G),et=G?t=>R(t.dom.getRootNode()):t=>B(t)?t:q(t),_=t=>{let l=et(t);return V(l)&&u(l.dom.host)?w.some(l):w.none()},j=t=>R(t.dom.host),z=t=>{let l=I(t)?t.dom.parentNode:t.dom;if(null==l||null===l.ownerDocument)return!1;let i=l.ownerDocument;return _(R(l)).fold(()=>i.body.contains(l),t=>z(j(t)))},$=(t,l)=>{let i=t.dom.getAttribute(l);return null===i?void 0:i},U=(t,l)=>{t.dom.removeAttribute(l)},K=(t,l)=>{let i=t.dom;((t,l)=>{let i=P(t);for(let a=0,d=i.length;a<d;a++){let d=i[a];l(t[d],d)}})(l,(t,l)=>{((t,l,i)=>{if(!d(i))throw console.error("Invalid call to CSS.set. Property ",l,":: Value ",i,":: Element ",t),Error("CSS value must be a string: "+i);C(t)&&t.style.setProperty(l,i)})(i,l,t)})},X=t=>{let l=R((t=>{if(ee()&&u(t.target)){let l=R(t.target);if(D(l)&&u(l.dom.shadowRoot)&&t.composed&&t.composedPath){let l=t.composedPath();if(l)return 0<l.length?w.some(l[0]):w.none()}}return w.from(t.target)})(t).getOr(t.target)),n=()=>t.stopPropagation(),r=()=>t.preventDefault();return{target:l,x:t.clientX,y:t.clientY,stop:n,prevent:r,kill:(...t)=>r(n.apply(null,t)),raw:t}},Y=(t,l,i,a)=>{t.dom.removeEventListener(l,i,a)},J=(t,l,i)=>((t,l,i,a,d)=>{let s=t=>{i(t)&&a(X(t))};return t.dom.addEventListener(l,s,d),{unbind:function(t,...l){return(...i)=>{let a=l.concat(i);return t.apply(null,a)}}(Y,t,l,s,d)}})(t,l,M,i,!1),Q=()=>Z(0,0),Z=(t,l)=>({major:t,minor:l}),er={nu:Z,detect:(t,l)=>{let i=String(l).toLowerCase();return 0===t.length?Q():((t,l)=>{let i=((t,l)=>{for(let i=0;i<t.length;i++){let a=t[i];if(a.test(l))return a}})(t,l);if(!i)return{major:0,minor:0};let r=t=>Number(l.replace(i,"$"+t));return Z(r(1),r(2))})(t,i)},unknown:Q},te=(t,l)=>{let i=String(l).toLowerCase();return O(t,t=>t.search(i))},en=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,re=t=>l=>k(l,t),eo=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:t=>k(t,"edge/")&&k(t,"chrome")&&k(t,"safari")&&k(t,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,en],search:t=>k(t,"chrome")&&!k(t,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:t=>k(t,"msie")||k(t,"trident")},{name:"Opera",versionRegexes:[en,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:re("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:re("firefox")},{name:"Safari",versionRegexes:[en,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:t=>(k(t,"safari")||k(t,"mobile/"))&&k(t,"applewebkit")}],el=[{name:"Windows",search:re("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:t=>k(t,"iphone")||k(t,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:re("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:re("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:re("linux"),versionRegexes:[]},{name:"Solaris",search:re("sunos"),versionRegexes:[]},{name:"FreeBSD",search:re("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:re("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ei={browsers:g(eo),oses:g(el)},es="Edge",ea="Chromium",eu="Opera",ed="Firefox",ec="Safari",me=t=>{let l=t.current,i=t.version,r=t=>()=>l===t;return{current:l,version:i,isEdge:r(es),isChromium:r(ea),isIE:r("IE"),isOpera:r(eu),isFirefox:r(ed),isSafari:r(ec)}},he=()=>me({current:void 0,version:er.unknown()}),em=(g(es),g(ea),g("IE"),g(eu),g(ed),g(ec),"Windows"),eh="Android",eg="Linux",ep="macOS",ef="Solaris",ev="FreeBSD",ew="ChromeOS",xe=t=>{let l=t.current,i=t.version,r=t=>()=>l===t;return{current:l,version:i,isWindows:r(em),isiOS:r("iOS"),isAndroid:r(eh),isMacOS:r(ep),isLinux:r(eg),isSolaris:r(ef),isFreeBSD:r(ev),isChromeOS:r(ew)}},Ee=()=>xe({current:void 0,version:er.unknown()}),ey=(g(em),g("iOS"),g(eh),g(eg),g(ep),g(ef),g(ev),g(ew),(t,l,i)=>{let a=ei.browsers(),d=ei.oses(),c=l.bind(t=>((t,l)=>{for(let i=0;i<t.length;i++){let a=l(t[i]);if(a.isSome())return a}return w.none()})(t.brands,t=>{let l=t.brand.toLowerCase();return O(a,t=>{var i;return l===(null===(i=t.brand)||void 0===i?void 0:i.toLowerCase())}).map(l=>({current:l.name,version:er.nu(parseInt(t.version,10),0)}))})).orThunk(()=>te(a,t).map(l=>{let i=er.detect(l.versionRegexes,t);return{current:l.name,version:i}})).fold(he,me),m=te(d,t).map(l=>{let i=er.detect(l.versionRegexes,t);return{current:l.name,version:i}}).fold(Ee,xe),p=((t,l,i,a)=>{let d=t.isiOS()&&!0===/ipad/i.test(i),c=t.isiOS()&&!d,m=t.isiOS()||t.isAndroid(),p=m||a("(pointer:coarse)"),f=d||!c&&m&&a("(min-device-width:768px)"),S=c||m&&!f,T=l.isSafari()&&t.isiOS()&&!1===/safari/i.test(i),A=!S&&!f&&!T;return{isiPad:g(d),isiPhone:g(c),isTablet:g(f),isPhone:g(S),isTouch:g(p),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:g(T),isDesktop:g(A)}})(m,c,t,i);return{browser:c,os:m,deviceType:p}}),Te=t=>window.matchMedia(t).matches,eb=(i=()=>ey(navigator.userAgent,w.from(navigator.userAgentData),Te),l=!1,(...a)=>(l||(l=!0,t=i.apply(null,a)),t)),Ce=(t,l)=>({left:t,top:l,translate:(i,a)=>Ce(t+i,l+a)}),Re=t=>{let l=void 0===t?window:t;return eb().browser.isFirefox()?w.none():w.from(l.visualViewport)},Le=(t,l,i,a)=>({x:t,y:l,width:i,height:a,right:t+i,bottom:l+a}),Me=t=>{let l=void 0===t?window:t,i=l.document,a=(t=>{let l=void 0!==t?t.dom:document,i=l.body.scrollLeft||l.documentElement.scrollLeft,a=l.body.scrollTop||l.documentElement.scrollTop;return Ce(i,a)})(R(i));return Re(l).fold(()=>{let t=l.document.documentElement,i=t.clientWidth,d=t.clientHeight;return Le(a.left,a.top,i,d)},t=>Le(Math.max(t.pageLeft,a.left),Math.max(t.pageTop,a.top),t.width,t.height))},Ne=(t,l,i)=>Re(i).map(i=>{let r=t=>l(X(t));return i.addEventListener(t,r),{unbind:()=>i.removeEventListener(t,r)}}).getOrThunk(()=>({unbind:h}));var eS=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),ex=tinymce.util.Tools.resolve("tinymce.Env");let We=(t,l)=>{t.dispatch("FullscreenStateChanged",{state:l}),t.dispatch("ResizeEditor")},qe=t=>t.options.get("fullscreen_native"),He=t=>{var l;return t.dom===(void 0!==(l=q(t).dom).fullscreenElement?l.fullscreenElement:void 0!==l.msFullscreenElement?l.msFullscreenElement:void 0!==l.webkitFullscreenElement?l.webkitFullscreenElement:null)},Ie=(t,l,i)=>F(((t,l)=>{let i=S(l)?l:A,a=t.dom,d=[];for(;null!==a.parentNode&&void 0!==a.parentNode;){let t=a.parentNode,l=R(t);if(d.push(l),!0===i(l))break;a=t}return d})(t,i),t=>W(t,l)),Be=(t,l)=>{var i,a;return i=t,F(w.from(i.dom.parentNode).map(R).map(H).map(t=>F(t,t=>i.dom!==t.dom)).getOr([]),t=>W(t,l))},eE="data-ephox-mobile-fullscreen-style",ek="position:absolute!important;",eR="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",eF=ex.os.isAndroid(),$e=t=>{let l=((t,l)=>{let i=t.dom,a=window.getComputedStyle(i).getPropertyValue(l);return""!==a||z(t)?a:C(i)?i.style.getPropertyValue(l):""})(t,"background-color");return void 0!==l&&""!==l?"background-color:"+l+"!important":"background-color:rgb(255,255,255)!important;"},eO=eS.DOM,eC=Re().fold(()=>({bind:h,unbind:h}),t=>{var l;let i;let a=(()=>{let t=y(h);return{...t,on:l=>t.get().each(l)}})(),d=b(),c=b(),p=(l=()=>{document.body.scrollTop=0,document.documentElement.scrollTop=0,window.requestAnimationFrame(()=>{a.on(l=>K(l,{top:t.offsetTop+"px",left:t.offsetLeft+"px",height:t.height+"px",width:t.width+"px"}))})},i=null,{cancel:()=>{m(i)||(clearTimeout(i),i=null)},throttle:(...t)=>{m(i)&&(i=setTimeout(()=>{i=null,l.apply(null,t)},50))}});return{bind:t=>{a.set(t),p.throttle(),d.set(Ne("resize",p.throttle)),c.set(Ne("scroll",p.throttle))},unbind:()=>{a.on(()=>{d.clear(),c.clear()}),a.clear()}}}),Xe=(t,l)=>{var i;let a=document.body,m=document.documentElement,f=t.getContainer(),S=R(f),A=(t=>{let l=R(t.getElement());return _(l).map(j).getOrThunk(()=>(t=>{let l=t.dom.body;if(null==l)throw Error("Body is not available yet");return R(l)})(q(l)))})(t),M=l.get(),P=R(t.getBody()),D=ex.deviceType.isTouch(),I=f.style,B=t.iframeElement,V=null==B?void 0:B.style,v=t=>{t(a,"tox-fullscreen"),t(m,"tox-fullscreen"),t(f,"tox-fullscreen"),_(S).map(t=>j(t).dom).each(l=>{t(l,"tox-fullscreen"),t(l,"tox-shadowhost")})},y=()=>{D&&(t=>{let l=((t,l)=>{let i=document;return 1!==i.nodeType&&9!==i.nodeType&&11!==i.nodeType||0===i.childElementCount?[]:x(i.querySelectorAll(t),R)})("["+eE+"]");E(l,l=>{let i=$(l,eE);i&&"no-styles"!==i?K(l,t.parseStyle(i)):U(l,"style"),U(l,eE)})})(t.dom),v(eO.removeClass),eC.unbind(),w.from(l.get()).each(t=>t.fullscreenChangeHandler.unbind())};if(M)M.fullscreenChangeHandler.unbind(),qe(t)&&He(A)&&(t=>{let l=t.dom;l.exitFullscreen?l.exitFullscreen():l.msExitFullscreen?l.msExitFullscreen():l.webkitCancelFullScreen&&l.webkitCancelFullScreen()})(q(A)),V.width=M.iframeWidth,V.height=M.iframeHeight,I.width=M.containerWidth,I.height=M.containerHeight,I.top=M.containerTop,I.left=M.containerLeft,y(),i=M.scrollPos,window.scrollTo(i.x,i.y),l.set(null),We(t,!1),t.off("remove",y);else{let i=J(q(A),void 0!==document.fullscreenElement?"fullscreenchange":void 0!==document.msFullscreenElement?"MSFullscreenChange":void 0!==document.webkitFullscreenElement?"webkitfullscreenchange":"fullscreenchange",i=>{qe(t)&&(He(A)||null===l.get()||Xe(t,l))}),a={scrollPos:Me(window),containerWidth:I.width,containerHeight:I.height,containerTop:I.top,containerLeft:I.left,iframeWidth:V.width,iframeHeight:V.height,fullscreenChangeHandler:i};D&&((t,l,i)=>{let r=l=>i=>{let a=$(i,"style"),c=void 0===a?"no-styles":a.trim();c!==l&&(((t,l,i)=>{if(!(d(i)||p(i)||T(i)))throw console.error("Invalid call to Attribute.set. Key ",l,":: Value ",i,":: Element ",t),Error("Attribute value was not simple");t.setAttribute(l,i+"")})(i.dom,eE,c),K(i,t.parseStyle(l)))},a=Ie(l,"*"),m=(t=>{let l=[];for(let i=0,a=t.length;i<a;++i){if(!c(t[i]))throw Error("Arr.flatten item "+i+" was not an array, input: "+t);N.apply(l,t[i])}return l})(x(a,t=>Be(t,"*:not(.tox-silver-sink)"))),f=$e(i);E(m,r("display:none!important;")),E(a,r(ek+eR+f)),r((!0===eF?"":ek)+eR+f)(l)})(t.dom,S,P),V.width=V.height="100%",I.width=I.height="",v(eO.addClass),eC.bind(S),t.on("remove",y),l.set(a),qe(t)&&(t=>{let l=t.dom;l.requestFullscreen?l.requestFullscreen():l.msRequestFullscreen?l.msRequestFullscreen():l.webkitRequestFullScreen&&l.webkitRequestFullScreen()})(A),We(t,!0)}},Ye=(t,l)=>i=>{i.setActive(null!==l.get());let r=t=>i.setActive(t.state);return t.on("FullscreenStateChanged",r),()=>t.off("FullscreenStateChanged",r)};a.add("fullscreen",t=>{let l=e(null);return t.inline||((t=>{(0,t.options.register)("fullscreen_native",{processor:"boolean",default:!1})})(t),((t,l)=>{t.addCommand("mceFullScreen",()=>{Xe(t,l)})})(t,l),((t,l)=>{let n=()=>t.execCommand("mceFullScreen");t.ui.registry.addToggleMenuItem("fullscreen",{text:"Fullscreen",icon:"fullscreen",shortcut:"Meta+Shift+F",onAction:n,onSetup:Ye(t,l)}),t.ui.registry.addToggleButton("fullscreen",{tooltip:"Fullscreen",icon:"fullscreen",onAction:n,onSetup:Ye(t,l)})})(t,l),t.addShortcut("Meta+Shift+F","","mceFullScreen")),{isFullscreen:()=>null!==l.get()}})}();