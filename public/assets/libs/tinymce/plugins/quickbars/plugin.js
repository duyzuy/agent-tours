!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");let hasProto=(e,t,o)=>{var r;return!!o(e,t.prototype)||(null===(r=e.constructor)||void 0===r?void 0:r.name)===t.name},typeOf=e=>{let t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&hasProto(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},isSimpleType=e=>t=>typeof t===e,isString=e=>"string"===typeOf(e),t=isSimpleType("boolean"),isNullable=e=>null==e,isNonNullable=e=>!isNullable(e),o=isSimpleType("function"),option=e=>t=>t.options.get(e),register=e=>{let o=e.options.register,toolbarProcessor=e=>o=>{let r=t(o)||isString(o);return r?t(o)?{value:o?e:"",valid:r}:{value:o.trim(),valid:r}:{valid:!1,message:"Must be a boolean or string."}},r="bold italic | quicklink h2 h3 blockquote";o("quickbars_selection_toolbar",{processor:toolbarProcessor(r),default:r});let i="quickimage quicktable";o("quickbars_insert_toolbar",{processor:toolbarProcessor(i),default:i});let n="alignleft aligncenter alignright";o("quickbars_image_toolbar",{processor:toolbarProcessor(n),default:n})},r=option("quickbars_selection_toolbar"),i=option("quickbars_insert_toolbar"),n=option("quickbars_image_toolbar"),l=0,generate=e=>{let t=new Date,o=t.getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++l+String(o)},insertTable=(e,t,o)=>{e.execCommand("mceInsertTable",!1,{rows:o,columns:t})},insertBlob=(e,t,o)=>{let r=e.editorUpload.blobCache,i=r.create(generate("mceu"),o,t);r.add(i),e.insertContent(e.dom.createHTML("img",{src:i.blobUri()}))},blobToBase64=e=>new Promise(t=>{let o=new FileReader;o.onloadend=()=>{t(o.result.split(",")[1])},o.readAsDataURL(e)});var s=tinymce.util.Tools.resolve("tinymce.util.Delay");let pickFile=e=>new Promise(t=>{let o=!1,r=document.createElement("input");r.type="file",r.accept="image/*",r.style.position="fixed",r.style.left="0",r.style.top="0",r.style.opacity="0.001",document.body.appendChild(r);let resolveFileInput=e=>{var i;o||(null===(i=r.parentNode)||void 0===i||i.removeChild(r),o=!0,t(e))},changeHandler=e=>{resolveFileInput(Array.prototype.slice.call(e.target.files))};r.addEventListener("input",changeHandler),r.addEventListener("change",changeHandler);let cancelHandler=t=>{let cleanup=()=>{resolveFileInput([])};o||("focusin"===t.type?s.setEditorTimeout(e,cleanup,1e3):cleanup()),e.off("focusin remove",cancelHandler)};e.on("focusin remove",cancelHandler),r.click()}),setupButtons=e=>{e.ui.registry.addButton("quickimage",{icon:"image",tooltip:"Insert image",onAction:()=>{pickFile(e).then(t=>{if(t.length>0){let o=t[0];blobToBase64(o).then(t=>{insertBlob(e,t,o)})}})}}),e.ui.registry.addButton("quicktable",{icon:"table",tooltip:"Insert table",onAction:()=>{insertTable(e,2,2)}})},never=()=>!1;let Optional=class Optional{constructor(e,t){this.tag=e,this.value=t}static some(e){return new Optional(!0,e)}static none(){return Optional.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?Optional.some(e(this.value)):Optional.none()}bind(e){return this.tag?e(this.value):Optional.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:Optional.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return isNonNullable(e)?Optional.some(e):Optional.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}};Optional.singletonNone=new Optional(!1),"undefined"!=typeof window?window:Function("return this;")();let name=e=>{let t=e.dom.nodeName;return t.toLowerCase()},has$1=(e,t)=>{let o=e.dom;return!!o&&!!o.hasAttribute&&o.hasAttribute(t)};var ClosestOrAncestor=(e,t,r,i,n)=>e(r,i)?Optional.some(r):o(n)&&n(r)?Optional.none():t(r,i,n);let fromDom=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},a={fromHtml:(e,t)=>{let o=(t||document).createElement("div");if(o.innerHTML=e,!o.hasChildNodes()||o.childNodes.length>1){let t="HTML does not have a single root node";throw console.error(t,e),Error(t)}return fromDom(o.childNodes[0])},fromTag:(e,t)=>{let o=(t||document).createElement(e);return fromDom(o)},fromText:(e,t)=>{let o=(t||document).createTextNode(e);return fromDom(o)},fromDom,fromPoint:(e,t,o)=>Optional.from(e.dom.elementFromPoint(t,o)).map(fromDom)},is=(e,t)=>{let o=e.dom;if(1!==o.nodeType)return!1;if(void 0!==o.matches)return o.matches(t);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(t);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(t);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(t);throw Error("Browser lacks native selectors")},ancestor$1=(e,t,r)=>{let i=e.dom,n=o(r)?r:never;for(;i.parentNode;){i=i.parentNode;let e=a.fromDom(i);if(t(e))return Optional.some(e);if(n(e))break}return Optional.none()},closest$2=(e,t,o)=>ClosestOrAncestor((e,t)=>t(e),ancestor$1,e,t,o),closest$1=(e,t,o)=>closest$2(e,t,o).isSome(),ancestor=(e,t,o)=>ancestor$1(e,e=>is(e,t),o),closest=(e,t,o)=>ClosestOrAncestor((e,t)=>is(e,t),ancestor,e,t,o),addToEditor$1=e=>{let t=i(e);t.length>0&&e.ui.registry.addContextToolbar("quickblock",{predicate:t=>{let o=a.fromDom(t),r=e.schema.getTextBlockElements(),isRoot=t=>t.dom===e.getBody();return!has$1(o,"data-mce-bogus")&&closest(o,'table,[data-mce-bogus="all"]',isRoot).fold(()=>closest$1(o,t=>name(t) in r&&e.dom.isEmpty(t.dom),isRoot),never)},items:t,position:"line",scope:"editor"})},supports=e=>void 0!==e.dom.classList,has=(e,t)=>supports(e)&&e.dom.classList.contains(t),addToEditor=e=>{let isEditable=t=>e.dom.isEditable(t),isInEditableContext=e=>isEditable(e.parentElement),isImage=e=>{let t="FIGURE"===e.nodeName&&/image/i.test(e.className),o="IMG"===e.nodeName||t,r=has(a.fromDom(e),"mce-pagebreak");return o&&isInEditableContext(e)&&!r},t=n(e);t.length>0&&e.ui.registry.addContextToolbar("imageselection",{predicate:isImage,items:t,position:"node"});let o=r(e);o.length>0&&e.ui.registry.addContextToolbar("textselection",{predicate:t=>!isImage(t)&&!e.selection.isCollapsed()&&isEditable(t),items:o,position:"selection",scope:"editor"})};e.add("quickbars",e=>{register(e),setupButtons(e),addToEditor$1(e),addToEditor(e)})}();