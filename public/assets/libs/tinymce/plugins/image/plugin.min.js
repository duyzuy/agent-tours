!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");let t=Object.getPrototypeOf,a=(e,t,r)=>{var l;return!!r(e,t.prototype)||(null===(l=e.constructor)||void 0===l?void 0:l.name)===t.name},i=e=>t=>(e=>{let t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&a(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t})(t)===e,s=e=>t=>typeof t===e,r=i("string"),l=i("object"),n=e=>{var r;return r=Object,l(e)&&a(e,r,(e,r)=>t(e)===r)},m=i("array"),c=e=>null===e,g=s("boolean"),d=e=>null!=e,u=s("function"),b=s("number"),p=()=>{};let h=class h{constructor(e,t){this.tag=e,this.value=t}static some(e){return new h(!0,e)}static none(){return h.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?h.some(e(this.value)):h.none()}bind(e){return this.tag?e(this.value):h.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:h.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return d(e)?h.some(e):h.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}};h.singletonNone=new h(!1);let v=Object.keys,f=Object.hasOwnProperty,y=(e,t)=>f.call(e,t),D=Array.prototype.push,w=e=>{let t=[];for(let r=0,l=e.length;r<l;++r){if(!m(e[r]))throw Error("Arr.flatten item "+r+" was not an array, input: "+e);D.apply(t,e[r])}return t};"undefined"!=typeof window?window:Function("return this;")();let A=(e,t,l)=>{((e,t,l)=>{if(!(r(l)||g(l)||b(l)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",l,":: Element ",e),Error("Attribute value was not simple");e.setAttribute(t,l+"")})(e.dom,t,l)},_=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}};var C=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),I=tinymce.util.Tools.resolve("tinymce.util.URI");let U=e=>e.length>0,S=e=>t=>t.options.get(e),x=S("image_dimensions"),N=S("image_advtab"),T=S("image_uploadtab"),O=S("image_prepend_url"),L=S("image_class_list"),E=S("image_description"),M=S("image_title"),j=S("image_caption"),R=S("image_list"),k=S("a11y_advanced_options"),z=S("automatic_uploads"),P=(e,t)=>Math.max(parseInt(e,10),parseInt(t,10)),B=e=>(e&&(e=e.replace(/px$/,"")),e),F=e=>(e.length>0&&/^[0-9]+$/.test(e)&&(e+="px"),e),H=e=>"IMG"===e.nodeName&&(e.hasAttribute("data-mce-object")||e.hasAttribute("data-mce-placeholder")),G=(e,t)=>{let r=e.options.get;return I.isDomSafe(t,"img",{allow_html_data_urls:r("allow_html_data_urls"),allow_script_urls:r("allow_script_urls"),allow_svg_data_urls:r("allow_svg_data_urls")})},W=C.DOM,$=e=>e.style.marginLeft&&e.style.marginRight&&e.style.marginLeft===e.style.marginRight?B(e.style.marginLeft):"",V=e=>e.style.marginTop&&e.style.marginBottom&&e.style.marginTop===e.style.marginBottom?B(e.style.marginTop):"",K=e=>e.style.borderWidth?B(e.style.borderWidth):"",Z=(e,t)=>{var r;return e.hasAttribute(t)&&null!==(r=e.getAttribute(t))&&void 0!==r?r:""},q=e=>null!==e.parentNode&&"FIGURE"===e.parentNode.nodeName,J=(e,t,r)=>{""===r||null===r?e.removeAttribute(t):e.setAttribute(t,r)},Q=(e,t)=>{let r=e.getAttribute("style"),l=t(null!==r?r:"");l.length>0?(e.setAttribute("style",l),e.setAttribute("data-mce-style",l)):e.removeAttribute("style")},X=(e,t)=>(e,r,l)=>{let m=e.style;m[r]?(m[r]=F(l),Q(e,t)):J(e,r,l)},Y=(e,t)=>e.style[t]?B(e.style[t]):Z(e,t),ee=(e,t)=>{let r=F(t);e.style.marginLeft=r,e.style.marginRight=r},te=(e,t)=>{let r=F(t);e.style.marginTop=r,e.style.marginBottom=r},ae=(e,t)=>{let r=F(t);e.style.borderWidth=r},ie=(e,t)=>{e.style.borderStyle=t},se=e=>{var t;return null!==(t=e.style.borderStyle)&&void 0!==t?t:""},re=e=>d(e)&&"FIGURE"===e.nodeName,oe=e=>0===W.getAttrib(e,"alt").length&&"presentation"===W.getAttrib(e,"role"),ne=e=>oe(e)?"":Z(e,"alt"),le=(e,t)=>{var r;let l=document.createElement("img");return J(l,"style",t.style),($(l)||""!==t.hspace)&&ee(l,t.hspace),(V(l)||""!==t.vspace)&&te(l,t.vspace),(K(l)||""!==t.border)&&ae(l,t.border),(se(l)||""!==t.borderStyle)&&ie(l,t.borderStyle),e(null!==(r=l.getAttribute("style"))&&void 0!==r?r:"")},ce=(e,t)=>({src:Z(t,"src"),alt:ne(t),title:Z(t,"title"),width:Y(t,"width"),height:Y(t,"height"),class:Z(t,"class"),style:e(Z(t,"style")),caption:q(t),hspace:$(t),vspace:V(t),border:K(t),borderStyle:se(t),isDecorative:oe(t)}),me=(e,t,r,l,m)=>{r[l]!==t[l]&&m(e,l,String(r[l]))},de=(e,t,r)=>{if(r){W.setAttrib(e,"role","presentation");let t=_(e);A(t,"alt","")}else{if(c(t))_(e).dom.removeAttribute("alt");else{let r=_(e);A(r,"alt",t)}"presentation"===W.getAttrib(e,"role")&&W.setAttrib(e,"role","")}},ge=(e,t)=>(r,l,m)=>{e(r,m),Q(r,t)},ue=(e,t,r)=>{let l=ce(e,r);me(r,l,t,"caption",(e,t,r)=>{q(e)?(e=>{let t=e.parentNode;d(t)&&(W.insertAfter(e,t),W.remove(t))})(e):(e=>{let t=W.create("figure",{class:"image"});W.insertAfter(t,e),t.appendChild(e),t.appendChild(W.create("figcaption",{contentEditable:"true"},"Caption")),t.contentEditable="false"})(e)}),me(r,l,t,"src",J),me(r,l,t,"title",J),me(r,l,t,"width",X(0,e)),me(r,l,t,"height",X(0,e)),me(r,l,t,"class",J),me(r,l,t,"style",ge((e,t)=>J(e,"style",t),e)),me(r,l,t,"hspace",ge(ee,e)),me(r,l,t,"vspace",ge(te,e)),me(r,l,t,"border",ge(ae,e)),me(r,l,t,"borderStyle",ge(ie,e)),t.alt===l.alt&&t.isDecorative===l.isDecorative||de(r,t.alt,t.isDecorative)},pe=(e,t)=>{let r=(e=>{if(e.margin){let t=String(e.margin).split(" ");switch(t.length){case 1:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[0],e["margin-bottom"]=e["margin-bottom"]||t[0],e["margin-left"]=e["margin-left"]||t[0];break;case 2:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[1],e["margin-bottom"]=e["margin-bottom"]||t[0],e["margin-left"]=e["margin-left"]||t[1];break;case 3:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[1],e["margin-bottom"]=e["margin-bottom"]||t[2],e["margin-left"]=e["margin-left"]||t[1];break;case 4:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[1],e["margin-bottom"]=e["margin-bottom"]||t[2],e["margin-left"]=e["margin-left"]||t[3]}delete e.margin}return e})(e.dom.styles.parse(t)),l=e.dom.styles.parse(e.dom.styles.serialize(r));return e.dom.styles.serialize(l)},he=e=>{let t=e.selection.getNode(),r=e.dom.getParent(t,"figure.image");return r?e.dom.select("img",r)[0]:t&&("IMG"!==t.nodeName||H(t))?null:t},be=(e,t)=>{var r;let l=e.dom,m=((t,r)=>{var l,m;let g={};return l=(t,r)=>!e.schema.isValidChild(r,"figure"),m=(e,t)=>{g[t]=e},((e,t)=>{let r=v(e);for(let l=0,m=r.length;l<m;l++){let m=r[l];t(e[m],m)}})(t,(e,t)=>{(l(e,t)?m:p)(e,t)}),g})(e.schema.getTextBlockElements()),g=l.getParent(t.parentNode,e=>{var t;return y(m,t=e.nodeName)&&void 0!==m[t]&&null!==m[t]},e.getBody());return g&&null!==(r=l.split(g,t))&&void 0!==r?r:t},ve=(e,t)=>{let r=((t,r)=>{let l=document.createElement("img");if(ue(t=>pe(e,t),{...r,caption:!1},l),de(l,r.alt,r.isDecorative),r.caption){let e=W.create("figure",{class:"image"});return e.appendChild(l),e.appendChild(W.create("figcaption",{contentEditable:"true"},"Caption")),e.contentEditable="false",e}return l})(0,t);e.dom.setAttrib(r,"data-mce-id","__mcenew"),e.focus(),e.selection.setContent(r.outerHTML);let l=e.dom.select('*[data-mce-id="__mcenew"]')[0];if(e.dom.setAttrib(l,"data-mce-id",null),re(l)){let t=be(e,l);e.selection.select(t)}else e.selection.select(l)},ye=(e,t)=>{let r=he(e);if(r){let l={...ce(t=>pe(e,t),r),...t},m=((e,t)=>{let r=t.src;return{...t,src:G(e,r)?r:""}})(e,l);l.src?((e,t)=>{let r=he(e);if(r){if(ue(t=>pe(e,t),t,r),((e,t)=>{e.dom.setAttrib(t,"src",t.getAttribute("src"))})(e,r),re(r.parentNode)){let t=r.parentNode;be(e,t),e.selection.select(r.parentNode)}else e.selection.select(r),((e,t,r)=>{let i=()=>{r.onload=r.onerror=null,e.selection&&(e.selection.select(r),e.nodeChanged())};r.onload=()=>{t.width||t.height||!x(e)||e.dom.setAttribs(r,{width:String(r.clientWidth),height:String(r.clientHeight)}),i()},r.onerror=i})(e,t,r)}})(e,m):((e,t)=>{if(t){let r=e.dom.is(t.parentNode,"figure.image")?t.parentNode:t;e.dom.remove(r),e.focus(),e.nodeChanged(),e.dom.isEmpty(e.getBody())&&(e.setContent(""),e.selection.setCursorLocation())}})(e,r)}else t.src&&ve(e,{src:"",alt:"",title:"",width:"",height:"",class:"",style:"",caption:!1,hspace:"",vspace:"",border:"",borderStyle:"",isDecorative:!1,...t})},et=(ea=(e,t)=>n(e)&&n(t)?et(e,t):t,(...e)=>{if(0===e.length)throw Error("Can't merge zero objects");let t={};for(let r=0;r<e.length;r++){let l=e[r];for(let e in l)y(l,e)&&(t[e]=ea(t[e],l[e]))}return t});var ea,ei=tinymce.util.Tools.resolve("tinymce.util.ImageUploader"),er=tinymce.util.Tools.resolve("tinymce.util.Tools");let _e=e=>r(e.value)?e.value:"",Ce=(e,t)=>{let l=[];return er.each(e,e=>{let m=r(e.text)?e.text:r(e.title)?e.title:"";if(void 0!==e.menu){let r=Ce(e.menu,t);l.push({text:m,items:r})}else{let r=t(e);l.push({text:m,value:r})}}),l},Ie=(e=_e)=>t=>t?h.from(t).map(t=>Ce(t,e)):h.none(),Ue=(e,t)=>((e,r)=>{var l;for(let r=0;r<e.length;r++){let m=y(l=e[r],"items")?Ue(l.items,t):l.value===t?h.some(l):h.none();if(m.isSome())return m}return h.none()})(e),xe=(e,t)=>e.bind(e=>Ue(e,t)),Ne=e=>{var t;let l=Ie(t=>e.convertURL(t.value||t.url||"","src")),m=new Promise(t=>{((e,t)=>{let l=R(e);r(l)?fetch(l).then(e=>{e.ok&&e.json().then(t)}):u(l)?l(t):t(l)})(e,e=>{t(l(e).map(e=>w([[{text:"None",value:""}],e])))})}),g=(t=L(e),Ie(_e)(t)),b=N(e),v=T(e),f=U(e.options.get("images_upload_url")),D=d(e.options.get("images_upload_handler")),C=(e=>{let t=he(e);return t?ce(t=>pe(e,t),t):{src:"",alt:"",title:"",width:"",height:"",class:"",style:"",caption:!1,hspace:"",vspace:"",border:"",borderStyle:"",isDecorative:!1}})(e),I=E(e),W=M(e),et=x(e),ea=j(e),ei=k(e),er=z(e),el=h.some(O(e)).filter(e=>r(e)&&e.length>0);return m.then(e=>({image:C,imageList:e,classList:g,hasAdvTab:b,hasUploadTab:v,hasUploadUrl:f,hasUploadHandler:D,hasDescription:I,hasImageTitle:W,hasDimensions:et,hasImageCaption:ea,prependURL:el,hasAccessibilityOptions:ei,automaticUploads:er}))},Te=e=>{let t=e.imageList.map(e=>({name:"images",type:"listbox",label:"Image list",items:e})),r={name:"alt",type:"input",label:"Alternative description",enabled:!(e.hasAccessibilityOptions&&e.image.isDecorative)},l=e.classList.map(e=>({name:"classes",type:"listbox",label:"Class",items:e}));return w([[{name:"src",type:"urlinput",filetype:"image",label:"Source"}],t.toArray(),e.hasAccessibilityOptions&&e.hasDescription?[{type:"label",label:"Accessibility",items:[{name:"isDecorative",type:"checkbox",label:"Image is decorative"}]}]:[],e.hasDescription?[r]:[],e.hasImageTitle?[{name:"title",type:"input",label:"Image title"}]:[],e.hasDimensions?[{name:"dimensions",type:"sizeinput"}]:[],[{...e.classList.isSome()&&e.hasImageCaption?{type:"grid",columns:2}:{type:"panel"},items:w([l.toArray(),e.hasImageCaption?[{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[]])}]])},Oe=e=>({title:"General",name:"general",items:Te(e)}),Le=e=>({src:{value:e.src,meta:{}},images:e.src,alt:e.alt,title:e.title,dimensions:{width:e.width,height:e.height},classes:e.class,caption:e.caption,style:e.style,vspace:e.vspace,border:e.border,hspace:e.hspace,borderstyle:e.borderStyle,fileinput:[],isDecorative:e.isDecorative}),je=(e,t)=>({src:e.src.value,alt:(null===e.alt||0===e.alt.length)&&t?null:e.alt,title:e.title,width:e.dimensions.width,height:e.dimensions.height,class:e.classes,style:e.style,caption:e.caption,hspace:e.hspace,vspace:e.vspace,border:e.border,borderStyle:e.borderstyle,isDecorative:e.isDecorative}),Me=(e,t,l,m)=>{((e,t)=>{var r;let l=t.getData();(r=l.src.value,/^(?:[a-zA-Z]+:)?\/\//.test(r)?h.none():e.prependURL.bind(e=>r.substring(0,e.length)!==e?h.some(e+r):h.none())).each(e=>{t.setData({src:{value:e,meta:l.src.meta}})})})(t,m),((e,t)=>{let l=t.getData(),m=l.src.meta;if(void 0!==m){let u=et({},l);e.hasDescription&&r(m.alt)&&(u.alt=m.alt),e.hasAccessibilityOptions&&(u.isDecorative=m.isDecorative||u.isDecorative||!1),e.hasImageTitle&&r(m.title)&&(u.title=m.title),e.hasDimensions&&(r(m.width)&&(u.dimensions.width=m.width),r(m.height)&&(u.dimensions.height=m.height)),r(m.class)&&xe(e.classList,m.class).each(e=>{u.classes=e.value}),e.hasImageCaption&&g(m.caption)&&(u.caption=m.caption),e.hasAdvTab&&(r(m.style)&&(u.style=m.style),r(m.vspace)&&(u.vspace=m.vspace),r(m.border)&&(u.border=m.border),r(m.hspace)&&(u.hspace=m.hspace),r(m.borderstyle)&&(u.borderstyle=m.borderstyle)),t.setData(u)}})(t,m),((e,t,r,l)=>{let m=l.getData(),g=m.src.value,u=m.src.meta||{};u.width||u.height||!t.hasDimensions||(U(g)?e.imageSize(g).then(e=>{r.open&&l.setData({dimensions:e})}).catch(e=>console.error(e)):l.setData({dimensions:{width:"",height:""}}))})(e,t,l,m),((e,t,r)=>{let l=r.getData(),m=xe(e.imageList,l.src.value);t.prevImage=m,r.setData({images:m.map(e=>e.value).getOr("")})})(t,l,m)},Re=(e,t,r,l)=>{var m;let g=l.getData();l.block("Uploading image"),(0<(m=g.fileinput).length?h.some(m[0]):h.none()).fold(()=>{l.unblock()},m=>{let g=URL.createObjectURL(m),o=()=>{l.unblock(),URL.revokeObjectURL(g)},n=m=>{l.setData({src:{value:m,meta:{}}}),l.showTab("general"),Me(e,t,r,l)};new Promise((e,t)=>{let r=new FileReader;r.onload=()=>{e(r.result)},r.onerror=()=>{var e;t(null===(e=r.error)||void 0===e?void 0:e.message)},r.readAsDataURL(m)}).then(r=>{let u=e.createBlobCache(m,g,r);t.automaticUploads?e.uploadImage(u).then(e=>{n(e.url),o()}).catch(t=>{o(),e.alertErr(t)}):(e.addToBlobCache(u),n(u.blobUri()),l.unblock())})})},ke=(e,t,r)=>(l,m)=>{"src"===m.name?Me(e,t,r,l):"images"===m.name?((e,t,r,l)=>{let m=l.getData(),g=xe(t.imageList,m.images);g.each(e=>{let t=""===m.alt||r.prevImage.map(e=>e.text===m.alt).getOr(!1);t?""===e.value?l.setData({src:e,alt:r.prevAlt}):l.setData({src:e,alt:e.text}):l.setData({src:e})}),r.prevImage=g,Me(e,t,r,l)})(e,t,r,l):"alt"===m.name?r.prevAlt=l.getData().alt:"fileinput"===m.name?Re(e,t,r,l):"isDecorative"===m.name&&l.setEnabled("alt",!l.getData().isDecorative)},ze=e=>()=>{e.open=!1},Pe=e=>e.hasAdvTab||e.hasUploadUrl||e.hasUploadHandler?{type:"tabpanel",tabs:w([[Oe(e)],e.hasAdvTab?[{title:"Advanced",name:"advanced",items:[{type:"grid",columns:2,items:[{type:"input",label:"Vertical space",name:"vspace",inputMode:"numeric"},{type:"input",label:"Horizontal space",name:"hspace",inputMode:"numeric"},{type:"input",label:"Border width",name:"border",inputMode:"numeric"},{type:"listbox",name:"borderstyle",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]}]}]}]:[],e.hasUploadTab&&(e.hasUploadUrl||e.hasUploadHandler)?[{title:"Upload",name:"upload",items:[{type:"dropzone",name:"fileinput"}]}]:[]])}:{type:"panel",items:Te(e)},Be=(e,t,r)=>l=>{let m=et(Le(t.image),l.getData()),g={...m,style:le(r.normalizeCss,je(m,!1))};e.execCommand("mceUpdateImage",!1,je(g,t.hasAccessibilityOptions)),e.editorUpload.uploadImagesAuto(),l.close()},Fe=e=>t=>{var r;return G(e,t)?(r=e.documentBaseURI.toAbsolute(t),new Promise(e=>{let t=document.createElement("img"),i=r=>{t.onload=t.onerror=null,t.parentNode&&t.parentNode.removeChild(t),e(r)};t.onload=()=>{let e={width:P(t.width,t.clientWidth),height:P(t.height,t.clientHeight)};i(Promise.resolve(e))},t.onerror=()=>{i(Promise.reject(`Failed to get image dimensions for: ${r}`))};let l=t.style;l.visibility="hidden",l.position="fixed",l.bottom=l.left="0px",l.width=l.height="auto",document.body.appendChild(t),t.src=r})).then(e=>({width:String(e.width),height:String(e.height)})):Promise.resolve({width:"",height:""})},He=e=>(t,r,l)=>{var m;return e.editorUpload.blobCache.create({blob:t,blobUri:r,name:null===(m=t.name)||void 0===m?void 0:m.replace(/\.[^\.]+$/,""),filename:t.name,base64:l.split(",")[1]})},Ge=e=>t=>{e.editorUpload.blobCache.add(t)},We=e=>t=>{e.windowManager.alert(t)},$e=e=>t=>pe(e,t),Ve=e=>t=>e.dom.parseStyle(t),Ke=e=>(t,r)=>e.dom.serializeStyle(t,r),Ze=e=>t=>ei(e).upload([t],!1).then(e=>{var t;return 0===e.length?Promise.reject("Failed to upload image"):!1===e[0].status?Promise.reject(null===(t=e[0].error)||void 0===t?void 0:t.message):e[0]}),qe=e=>{let t={imageSize:Fe(e),addToBlobCache:Ge(e),createBlobCache:He(e),alertErr:We(e),normalizeCss:$e(e),parseStyle:Ve(e),serializeStyle:Ke(e),uploadImage:Ze(e)};return{open:()=>{Ne(e).then(r=>{let l={prevImage:xe(r.imageList,r.image.src),prevAlt:r.image.alt,open:!0};return{title:"Insert/Edit Image",size:"normal",body:Pe(r),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:Le(r.image),onSubmit:Be(e,r,t),onChange:ke(t,r,l),onClose:ze(l)}}).then(e.windowManager.open)}}},Je=e=>{let t=e.attr("class");return d(t)&&/\bimage\b/.test(t)},Qe=e=>t=>{let r=t.length,i=t=>{t.attr("contenteditable",e?"true":null)};for(;r--;){let l=t[r];Je(l)&&(l.attr("contenteditable",e?"false":null),er.each(l.getAll("figcaption"),i))}},Xe=e=>t=>{let a=()=>{t.setEnabled(e.selection.isEditable())};return e.on("NodeChange",a),a(),()=>{e.off("NodeChange",a)}};e.add("image",e=>{(e=>{let t=e.options.register;t("image_dimensions",{processor:"boolean",default:!0}),t("image_advtab",{processor:"boolean",default:!1}),t("image_uploadtab",{processor:"boolean",default:!0}),t("image_prepend_url",{processor:"string",default:""}),t("image_class_list",{processor:"object[]"}),t("image_description",{processor:"boolean",default:!0}),t("image_title",{processor:"boolean",default:!1}),t("image_caption",{processor:"boolean",default:!1}),t("image_list",{processor:e=>{let t=!1===e||r(e)||((e,t)=>{if(m(e)){for(let r=0,l=e.length;r<l;++r)if(!t(e[r]))return!1;return!0}return!1})(e,l)||u(e);return t?{value:e,valid:t}:{valid:!1,message:"Must be false, a string, an array or a function."}},default:!1})})(e),(e=>{e.on("PreInit",()=>{e.parser.addNodeFilter("figure",Qe(!0)),e.serializer.addNodeFilter("figure",Qe(!1))})})(e),e.ui.registry.addToggleButton("image",{icon:"image",tooltip:"Insert/edit image",onAction:qe(e).open,onSetup:t=>{t.setActive(d(he(e)));let r=e.selection.selectorChangedWithUnbind("img:not([data-mce-object]):not([data-mce-placeholder]),figure.image",t.setActive).unbind,l=Xe(e)(t);return()=>{r(),l()}}}),e.ui.registry.addMenuItem("image",{icon:"image",text:"Image...",onAction:qe(e).open,onSetup:Xe(e)}),e.ui.registry.addContextMenu("image",{update:t=>e.selection.isEditable()&&(re(t)||"IMG"===t.nodeName&&!H(t))?["image"]:[]}),e.addCommand("mceImage",qe(e).open),e.addCommand("mceUpdateImage",(t,r)=>{e.undoManager.transact(()=>ye(e,r))})})}();