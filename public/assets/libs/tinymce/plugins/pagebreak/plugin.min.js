!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),r=tinymce.util.Tools.resolve("tinymce.Env");let t=e=>r=>r.options.get(e),n=t("pagebreak_separator"),o=t("pagebreak_split_block"),l="mce-pagebreak",s=e=>{let n=`<img src="${r.transparentSrc}" class="${l}" data-mce-resize="false" data-mce-placeholder />`;return e?`<p>${n}</p>`:n},c=e=>r=>{let t=()=>{r.setEnabled(e.selection.isEditable())};return e.on("NodeChange",t),t(),()=>{e.off("NodeChange",t)}};e.add("pagebreak",e=>{(e=>{let r=e.options.register;r("pagebreak_separator",{processor:"string",default:"<!-- pagebreak -->"}),r("pagebreak_split_block",{processor:"boolean",default:!1})})(e),(e=>{e.addCommand("mcePageBreak",()=>{e.insertContent(s(o(e)))})})(e),(e=>{let a=()=>e.execCommand("mcePageBreak");e.ui.registry.addButton("pagebreak",{icon:"page-break",tooltip:"Page break",onAction:a,onSetup:c(e)}),e.ui.registry.addMenuItem("pagebreak",{text:"Page break",icon:"page-break",onAction:a,onSetup:c(e)})})(e),(e=>{let r=n(e),t=()=>o(e),i=RegExp(r.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,e=>"\\"+e),"gi");e.on("BeforeSetContent",e=>{e.content=e.content.replace(i,s(t()))}),e.on("PreInit",()=>{e.serializer.addNodeFilter("img",n=>{let o,i,g=n.length;for(;g--;)if((i=(o=n[g]).attr("class"))&&-1!==i.indexOf(l)){let n=o.parent;if(n&&e.schema.getBlockElements()[n.name]&&t()){n.type=3,n.value=r,n.raw=!0,o.remove();continue}o.type=3,o.value=r,o.raw=!0}})})})(e),(e=>{e.on("ResolveName",r=>{"IMG"===r.target.nodeName&&e.dom.hasClass(r.target,l)&&(r.name="pagebreak")})})(e)})}();