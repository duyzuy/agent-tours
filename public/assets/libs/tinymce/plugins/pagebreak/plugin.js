!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.Env");let option=e=>t=>t.options.get(e),register$2=e=>{let t=e.options.register;t("pagebreak_separator",{processor:"string",default:"<!-- pagebreak -->"}),t("pagebreak_split_block",{processor:"boolean",default:!1})},a=option("pagebreak_separator"),o=option("pagebreak_split_block"),r="mce-pagebreak",getPlaceholderHtml=e=>{let a=`<img src="${t.transparentSrc}" class="${r}" data-mce-resize="false" data-mce-placeholder />`;return e?`<p>${a}</p>`:a},setup$1=e=>{let t=a(e),shouldSplitBlock$1=()=>o(e),n=RegExp(t.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,e=>"\\"+e),"gi");e.on("BeforeSetContent",e=>{e.content=e.content.replace(n,getPlaceholderHtml(shouldSplitBlock$1()))}),e.on("PreInit",()=>{e.serializer.addNodeFilter("img",a=>{let o=a.length,n,l;for(;o--;)if((l=(n=a[o]).attr("class"))&&-1!==l.indexOf(r)){let a=n.parent;if(a&&e.schema.getBlockElements()[a.name]&&shouldSplitBlock$1()){a.type=3,a.value=t,a.raw=!0,n.remove();continue}n.type=3,n.value=t,n.raw=!0}})})},register$1=e=>{e.addCommand("mcePageBreak",()=>{e.insertContent(getPlaceholderHtml(o(e)))})},setup=e=>{e.on("ResolveName",t=>{"IMG"===t.target.nodeName&&e.dom.hasClass(t.target,r)&&(t.name="pagebreak")})},onSetupEditable=e=>t=>{let nodeChanged=()=>{t.setEnabled(e.selection.isEditable())};return e.on("NodeChange",nodeChanged),nodeChanged(),()=>{e.off("NodeChange",nodeChanged)}},register=e=>{let onAction=()=>e.execCommand("mcePageBreak");e.ui.registry.addButton("pagebreak",{icon:"page-break",tooltip:"Page break",onAction,onSetup:onSetupEditable(e)}),e.ui.registry.addMenuItem("pagebreak",{text:"Page break",icon:"page-break",onAction,onSetup:onSetupEditable(e)})};e.add("pagebreak",e=>{register$2(e),register$1(e),register(e),setup$1(e),setup(e)})}();