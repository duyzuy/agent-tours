!function(){"use strict";var u,y=tinymce.util.Tools.resolve("tinymce.ModelManager");let t=u=>y=>(u=>{var y,x;let R=typeof u;return null===u?"null":"object"===R&&Array.isArray(u)?"array":"object"===R&&((y=String).prototype.isPrototypeOf(u)||(null===(x=u.constructor)||void 0===x?void 0:x.name)===y.name)?"string":R})(y)===u,o=u=>y=>typeof y===u,n=u=>y=>u===y,x=t("string"),R=t("object"),S=t("array"),T=n(null),q=o("boolean"),Z=n(void 0),m=u=>null!=u,U=o("function"),en=o("number"),f=()=>{},g=u=>()=>u,h=u=>u,p=(u,y)=>u===y;function w(u,...y){return(...x)=>{let R=y.concat(x);return u.apply(null,R)}}let b=u=>y=>!u(y),v=u=>u(),ea=g(!1),ei=g(!0);let C=class C{constructor(u,y){this.tag=u,this.value=y}static some(u){return new C(!0,u)}static none(){return C.singletonNone}fold(u,y){return this.tag?y(this.value):u()}isSome(){return this.tag}isNone(){return!this.tag}map(u){return this.tag?C.some(u(this.value)):C.none()}bind(u){return this.tag?u(this.value):C.none()}exists(u){return this.tag&&u(this.value)}forall(u){return!this.tag||u(this.value)}filter(u){return!this.tag||u(this.value)?this:C.none()}getOr(u){return this.tag?this.value:u}or(u){return this.tag?this:u}getOrThunk(u){return this.tag?this.value:u()}orThunk(u){return this.tag?this:u()}getOrDie(u){if(this.tag)return this.value;throw Error(null!=u?u:"Called getOrDie on None")}static from(u){return m(u)?C.some(u):C.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(u){this.tag&&u(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}};C.singletonNone=new C(!1);let ec=Array.prototype.slice,ed=Array.prototype.indexOf,eu=Array.prototype.push,D=(u,y)=>ed.call(u,y)>-1,O=(u,y)=>{for(let x=0,R=u.length;x<R;x++)if(y(u[x],x))return!0;return!1},k=(u,y)=>{let x=[];for(let R=0;R<u;R++)x.push(y(R));return x},E=(u,y)=>{let x=u.length,R=Array(x);for(let S=0;S<x;S++){let x=u[S];R[S]=y(x,S)}return R},N=(u,y)=>{for(let x=0,R=u.length;x<R;x++)y(u[x],x)},B=(u,y)=>{let x=[],R=[];for(let S=0,T=u.length;S<T;S++){let T=u[S];(y(T,S)?x:R).push(T)}return{pass:x,fail:R}},_=(u,y)=>{let x=[];for(let R=0,S=u.length;R<S;R++){let S=u[R];y(S,R)&&x.push(S)}return x},z=(u,y,x)=>(((u,y)=>{for(let x=u.length-1;x>=0;x--)y(u[x],x)})(u,(u,R)=>{x=y(x,u,R)}),x),A=(u,y,x)=>(N(u,(u,R)=>{x=y(x,u,R)}),x),L=(u,y)=>((u,y,x)=>{for(let R=0,S=u.length;R<S;R++){let S=u[R];if(y(S,R))return C.some(S);if(x(S,R))break}return C.none()})(u,y,ea),W=(u,y)=>{for(let x=0,R=u.length;x<R;x++)if(y(u[x],x))return C.some(x);return C.none()},M=u=>{let y=[];for(let x=0,R=u.length;x<R;++x){if(!S(u[x]))throw Error("Arr.flatten item "+x+" was not an array, input: "+u);eu.apply(y,u[x])}return y},j=(u,y)=>M(E(u,y)),P=(u,y)=>{for(let x=0,R=u.length;x<R;++x)if(!0!==y(u[x],x))return!1;return!0},I=(u,y)=>{let x={};for(let R=0,S=u.length;R<S;R++){let S=u[R];x[String(S)]=y(S,R)}return x},F=(u,y)=>y>=0&&y<u.length?C.some(u[y]):C.none(),H=u=>F(u,0),$=u=>F(u,u.length-1),V=(u,y)=>{for(let x=0;x<u.length;x++){let R=y(u[x],x);if(R.isSome())return R}return C.none()},ef=Object.keys,eg=Object.hasOwnProperty,G=(u,y)=>{let x=ef(u);for(let R=0,S=x.length;R<S;R++){let S=x[R];y(u[S],S)}},K=(u,y)=>Y(u,(u,x)=>({k:x,v:y(u,x)})),Y=(u,y)=>{let x={};return G(u,(u,R)=>{let S=y(u,R);x[S.k]=S.v}),x},J=(u,y)=>{let x=[];return G(u,(u,R)=>{x.push(y(u,R))}),x},Q=u=>J(u,h),X=(u,y)=>eg.call(u,y),eh="undefined"!=typeof window?window:Function("return this;")(),ee=(u,y)=>((u,y)=>{let x=null!=y?y:eh;for(let y=0;y<u.length&&null!=x;++y)x=x[u[y]];return x})(u.split("."),y),ep=Object.getPrototypeOf,oe=u=>{let y=ee("ownerDocument.defaultView",u);return R(u)&&(((u,y)=>{let x=ee(u,y);if(null==x)throw Error(u+" not available on this browser");return x})("HTMLElement",y).prototype.isPrototypeOf(u)||/^HTML\w*Element$/.test(ep(u).constructor.name))},ne=u=>u.dom.nodeName.toLowerCase(),re=u=>u.dom.nodeType,se=u=>y=>re(y)===u,le=u=>8===re(u)||"#comment"===ne(u),ae=u=>eb(u)&&oe(u.dom),eb=se(1),ew=se(3),eC=se(9),ev=se(11),ue=u=>y=>eb(y)&&ne(y)===u,fe=(u,y,R)=>{if(!(x(R)||q(R)||en(R)))throw console.error("Invalid call to Attribute.set. Key ",y,":: Value ",R,":: Element ",u),Error("Attribute value was not simple");u.setAttribute(y,R+"")},ge=(u,y,x)=>{fe(u.dom,y,x)},he=(u,y)=>{let x=u.dom;G(y,(u,y)=>{fe(x,y,u)})},pe=(u,y)=>{let x=u.dom.getAttribute(y);return null===x?void 0:x},we=(u,y)=>C.from(pe(u,y)),be=(u,y)=>{u.dom.removeAttribute(y)},ve=u=>A(u.dom.attributes,(u,y)=>(u[y.name]=y.value,u),{}),ye=u=>{if(null==u)throw Error("Node cannot be null or undefined");return{dom:u}},ey={fromHtml:(u,y)=>{let x=(y||document).createElement("div");if(x.innerHTML=u,!x.hasChildNodes()||x.childNodes.length>1){let y="HTML does not have a single root node";throw console.error(y,u),Error(y)}return ye(x.childNodes[0])},fromTag:(u,y)=>{let x=(y||document).createElement(u);return ye(x)},fromText:(u,y)=>{let x=(y||document).createTextNode(u);return ye(x)},fromDom:ye,fromPoint:(u,y,x)=>C.from(u.dom.elementFromPoint(y,x)).map(ye)},Ce=(u,y)=>{let x=u.dom;if(1!==x.nodeType)return!1;if(void 0!==x.matches)return x.matches(y);if(void 0!==x.msMatchesSelector)return x.msMatchesSelector(y);if(void 0!==x.webkitMatchesSelector)return x.webkitMatchesSelector(y);if(void 0!==x.mozMatchesSelector)return x.mozMatchesSelector(y);throw Error("Browser lacks native selectors")},Se=u=>1!==u.nodeType&&9!==u.nodeType&&11!==u.nodeType||0===u.childElementCount,Te=(u,y)=>{let x=void 0===y?document:y.dom;return Se(x)?C.none():C.from(x.querySelector(u)).map(ey.fromDom)},Re=(u,y)=>u.dom===y.dom,De=(u,y)=>{let x=u.dom,R=y.dom;return x!==R&&x.contains(R)},ke=u=>ey.fromDom(u.dom.ownerDocument),Ee=u=>eC(u)?u:ke(u),Ne=u=>C.from(u.dom.parentNode).map(ey.fromDom),Be=u=>C.from(u.dom.parentElement).map(ey.fromDom),_e=(u,y)=>{let x=U(y)?y:ea,R=u.dom,S=[];for(;null!==R.parentNode&&void 0!==R.parentNode;){let u=R.parentNode,y=ey.fromDom(u);if(S.push(y),!0===x(y))break;R=u}return S},ze=u=>C.from(u.dom.previousSibling).map(ey.fromDom),Ae=u=>C.from(u.dom.nextSibling).map(ey.fromDom),Le=u=>E(u.dom.childNodes,ey.fromDom),We=(u,y)=>{let x=u.dom.childNodes;return C.from(x[y]).map(ey.fromDom)},Me=(u,y)=>{Ne(u).each(x=>{x.dom.insertBefore(y.dom,u.dom)})},je=(u,y)=>{Ae(u).fold(()=>{Ne(u).each(u=>{Ie(u,y)})},u=>{Me(u,y)})},Pe=(u,y)=>{let x=We(u,0);x.fold(()=>{Ie(u,y)},x=>{u.dom.insertBefore(y.dom,x.dom)})},Ie=(u,y)=>{u.dom.appendChild(y.dom)},Fe=(u,y)=>{Me(u,y),Ie(y,u)},He=(u,y)=>{N(y,(x,R)=>{let S=0===R?u:y[R-1];je(S,x)})},$e=(u,y)=>{N(y,y=>{Ie(u,y)})},Ve=u=>{u.dom.textContent="",N(Le(u),u=>{qe(u)})},qe=u=>{let y=u.dom;null!==y.parentNode&&y.parentNode.removeChild(y)},Ue=u=>{let y=Le(u);y.length>0&&He(u,y),qe(u)},Ge=(u,y)=>ey.fromDom(u.dom.cloneNode(y)),Ke=u=>Ge(u,!1),Ye=u=>Ge(u,!0),Je=(u,y)=>{let x=ey.fromTag(y),R=ve(u);return he(x,R),x},ex=["tfoot","thead","tbody","colgroup"],Xe=(u,y,x)=>({element:u,rowspan:y,colspan:x}),Ze=(u,y,x)=>({element:u,cells:y,section:x}),et=(u,y,x)=>({element:u,isNew:y,isLocked:x}),tt=(u,y,x,R)=>({element:u,cells:y,section:x,isNew:R}),eR=U(Element.prototype.attachShadow)&&U(Node.prototype.getRootNode),eS=g(eR),eD=eR?u=>ey.fromDom(u.dom.getRootNode()):Ee,st=u=>ey.fromDom(u.dom.host),lt=u=>{let y=ew(u)?u.dom.parentNode:u.dom;if(null==y||null===y.ownerDocument)return!1;let x=y.ownerDocument;return(u=>{let y=eD(u);return ev(y)&&m(y.dom.host)?C.some(y):C.none()})(ey.fromDom(y)).fold(()=>x.body.contains(y),u=>lt(st(u)))},at=u=>{let y=u.dom.body;if(null==y)throw Error("Body is not available yet");return ey.fromDom(y)},ct=(u,y)=>{let x=[];return N(Le(u),u=>{y(u)&&(x=x.concat([u])),x=x.concat(ct(u,y))}),x},it=(u,y,x)=>_(_e(u,x),u=>Ce(u,y)),mt=(u,y)=>_(Le(u),u=>Ce(u,y)),dt=(u,y)=>((u,y)=>{let x=void 0===y?document:y.dom;return Se(x)?[]:E(x.querySelectorAll(u),ey.fromDom)})(y,u);var ut=(u,y,x,R,S)=>u(x,R)?C.some(x):U(S)&&S(x)?C.none():y(x,R,S);let ft=(u,y,x)=>{let R=u.dom,S=U(x)?x:ea;for(;R.parentNode;){R=R.parentNode;let u=ey.fromDom(R);if(y(u))return C.some(u);if(S(u))break}return C.none()},gt=(u,y,x)=>ut((u,y)=>y(u),ft,u,y,x),ht=(u,y,x)=>ft(u,u=>Ce(u,y),x),pt=(u,y)=>L(u.dom.childNodes,u=>Ce(ey.fromDom(u),y)).map(ey.fromDom),wt=(u,y)=>Te(y,u),bt=(u,y,x)=>ut((u,y)=>Ce(u,y),ht,u,y,x),vt=(u,y,x=p)=>u.exists(u=>x(u,y)),yt=u=>{let y=[],o=u=>{y.push(u)};for(let y=0;y<u.length;y++)u[y].each(o);return y},xt=(u,y)=>u?C.some(y):C.none(),Ct=(u,y,x)=>""===y||u.length>=y.length&&u.substr(x,x+y.length)===y,St=(u,y,x=0,R)=>{let S=u.indexOf(y,x);return -1!==S&&(!!Z(R)||S+y.length<=R)},Tt=(u,y)=>Ct(u,y,0),Rt=(u,y)=>Ct(u,y,u.length-y.length),eT=(u=/^\s+|\s+$/g,y=>y.replace(u,"")),Ot=u=>u.length>0,kt=u=>void 0!==u.style&&U(u.style.getPropertyValue),Et=(u,y,R)=>{if(!x(R))throw console.error("Invalid call to CSS.set. Property ",y,":: Value ",R,":: Element ",u),Error("CSS value must be a string: "+R);kt(u)&&u.style.setProperty(y,R)},Nt=(u,y,x)=>{let R=u.dom;Et(R,y,x)},Bt=(u,y)=>{let x=u.dom;G(y,(u,y)=>{Et(x,y,u)})},_t=(u,y)=>{let x=u.dom,R=window.getComputedStyle(x).getPropertyValue(y);return""!==R||lt(u)?R:zt(x,y)},zt=(u,y)=>kt(u)?u.style.getPropertyValue(y):"",At=(u,y)=>{let x=u.dom,R=zt(x,y);return C.from(R).filter(u=>u.length>0)},Lt=(u,y)=>{var x;kt(x=u.dom)&&x.style.removeProperty(y),vt(we(u,"style").map(eT),"")&&be(u,"style")},Wt=(u,y,x=0)=>we(u,y).map(u=>parseInt(u,10)).getOr(x),Mt=(u,y)=>Wt(u,y,1),jt=u=>ue("col")(u)?Wt(u,"span",1)>1:Mt(u,"colspan")>1,Pt=u=>Mt(u,"rowspan")>1,It=(u,y)=>parseInt(_t(u,y),10),eE=g(10),ek=g(10),$t=(u,y)=>Vt(u,y,ei),Vt=(u,y,x)=>j(Le(u),u=>Ce(u,y)?x(u)?[u]:[]:Vt(u,y,x)),qt=(u,y)=>((u,y,x=ea)=>x(y)?C.none():D(u,ne(y))?C.some(y):ht(y,u.join(","),u=>Ce(u,"table")||x(u)))(["td","th"],u,y),Ut=u=>$t(u,"th,td"),Gt=u=>Ce(u,"colgroup")?mt(u,"col"):j(Jt(u),u=>mt(u,"col")),Kt=(u,y)=>bt(u,"table",y),Yt=u=>$t(u,"tr"),Jt=u=>Kt(u).fold(g([]),u=>mt(u,"colgroup")),Qt=(u,y)=>E(u,u=>{if("colgroup"===ne(u)){let y=E(Gt(u),u=>{let y=Wt(u,"span",1);return Xe(u,1,y)});return Ze(u,y,"colgroup")}{let x=E(Ut(u),u=>{let y=Wt(u,"rowspan",1),x=Wt(u,"colspan",1);return Xe(u,y,x)});return Ze(u,x,y(u))}}),Xt=u=>Ne(u).map(u=>{let y=ne(u);return D(ex,y)?y:"tbody"}).getOr("tbody"),Zt=u=>{let y=Yt(u),x=[...Jt(u),...y];return Qt(x,Xt)},eo=u=>{let y,x=!1;return(...R)=>(x||(x=!0,y=u.apply(null,R)),y)},to=()=>oo(0,0),oo=(u,y)=>({major:u,minor:y}),eO={nu:oo,detect:(u,y)=>{let x=String(y).toLowerCase();return 0===u.length?to():((u,y)=>{let x=((u,y)=>{for(let x=0;x<u.length;x++){let R=u[x];if(R.test(y))return R}})(u,y);if(!x)return{major:0,minor:0};let n=u=>Number(y.replace(x,"$"+u));return oo(n(1),n(2))})(u,x)},unknown:to},ro=(u,y)=>{let x=String(y).toLowerCase();return L(u,u=>u.search(x))},eN=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,lo=u=>y=>St(y,u),eL=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:u=>St(u,"edge/")&&St(u,"chrome")&&St(u,"safari")&&St(u,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,eN],search:u=>St(u,"chrome")&&!St(u,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:u=>St(u,"msie")||St(u,"trident")},{name:"Opera",versionRegexes:[eN,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:lo("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:lo("firefox")},{name:"Safari",versionRegexes:[eN,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:u=>(St(u,"safari")||St(u,"mobile/"))&&St(u,"applewebkit")}],e_=[{name:"Windows",search:lo("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:u=>St(u,"iphone")||St(u,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:lo("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:lo("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:lo("linux"),versionRegexes:[]},{name:"Solaris",search:lo("sunos"),versionRegexes:[]},{name:"FreeBSD",search:lo("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:lo("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],eB={browsers:g(eL),oses:g(e_)},ez="Edge",eW="Chromium",eI="Opera",eA="Firefox",ej="Safari",po=u=>{let y=u.current,x=u.version,n=u=>()=>y===u;return{current:y,version:x,isEdge:n(ez),isChromium:n(eW),isIE:n("IE"),isOpera:n(eI),isFirefox:n(eA),isSafari:n(ej)}},wo=()=>po({current:void 0,version:eO.unknown()}),eP=(g(ez),g(eW),g("IE"),g(eI),g(eA),g(ej),"Windows"),eM="Android",e$="Linux",eH="macOS",eq="Solaris",eV="FreeBSD",eF="ChromeOS",Do=u=>{let y=u.current,x=u.version,n=u=>()=>y===u;return{current:y,version:x,isWindows:n(eP),isiOS:n("iOS"),isAndroid:n(eM),isMacOS:n(eH),isLinux:n(e$),isSolaris:n(eq),isFreeBSD:n(eV),isChromeOS:n(eF)}},Oo=()=>Do({current:void 0,version:eO.unknown()}),eY=(g(eP),g("iOS"),g(eM),g(e$),g(eH),g(eq),g(eV),g(eF),u=>window.matchMedia(u).matches),eK=eo(()=>((u,y,x)=>{let R=eB.browsers(),S=eB.oses(),T=y.bind(u=>V(u.brands,u=>{let y=u.brand.toLowerCase();return L(R,u=>{var x;return y===(null===(x=u.brand)||void 0===x?void 0:x.toLowerCase())}).map(y=>({current:y.name,version:eO.nu(parseInt(u.version,10),0)}))})).orThunk(()=>ro(R,u).map(y=>{let x=eO.detect(y.versionRegexes,u);return{current:y.name,version:x}})).fold(wo,po),q=ro(S,u).map(y=>{let x=eO.detect(y.versionRegexes,u);return{current:y.name,version:x}}).fold(Oo,Do),Z=((u,y,x,R)=>{let S=u.isiOS()&&!0===/ipad/i.test(x),T=u.isiOS()&&!S,q=u.isiOS()||u.isAndroid(),Z=q||R("(pointer:coarse)"),U=S||!T&&q&&R("(min-device-width:768px)"),en=T||q&&!U,ea=y.isSafari()&&u.isiOS()&&!1===/safari/i.test(x),ei=!en&&!U&&!ea;return{isiPad:g(S),isiPhone:g(T),isTablet:g(U),isPhone:g(en),isTouch:g(Z),isAndroid:u.isAndroid,isiOS:u.isiOS,isWebView:g(ea),isDesktop:g(ei)}})(q,T,u,x);return{browser:T,os:q,deviceType:Z}})(navigator.userAgent,C.from(navigator.userAgentData),eY)),Bo=()=>eK(),_o=(u,y)=>{let o=x=>{let R=y(x);if(R<=0||null===R){let y=_t(x,u);return parseFloat(y)||0}return R},n=(u,y)=>A(y,(y,x)=>{let R=_t(u,x),S=void 0===R?0:parseInt(R,10);return isNaN(S)?y:y+S},0);return{set:(y,x)=>{if(!en(x)&&!x.match(/^[0-9]+$/))throw Error(u+".set accepts only positive integer values. Value was "+x);let R=y.dom;kt(R)&&(R.style[u]=x+"px")},get:o,getOuter:o,aggregate:n,max:(u,y,x)=>{let R=n(u,x);return y>R?y-R:0}}},zo=(u,y,x)=>(u=>{let y=parseFloat(u);return isNaN(y)?C.none():C.some(y)})(_t(u,y)).getOr(x),eZ=_o("width",u=>u.dom.offsetWidth),Lo=u=>eZ.get(u),Wo=u=>eZ.getOuter(u),Mo=u=>((u,y)=>{var x,R;let S=u.dom,T=S.getBoundingClientRect().width||S.offsetWidth;return"border-box"===y?T:(x="left",R="right",T-zo(u,`padding-${x}`,0)-zo(u,`padding-${R}`,0)-zo(u,`border-${x}-width`,0)-zo(u,`border-${R}-width`,0))})(u,"content-box"),jo=(u,y,x)=>{let R=u.cells,S=R.slice(0,y),T=R.slice(y),q=S.concat(x).concat(T);return Fo(u,q)},Po=(u,y,x)=>jo(u,y,[x]),Io=(u,y,x)=>{u.cells[y]=x},Fo=(u,y)=>tt(u.element,y,u.section,u.isNew),Ho=(u,y)=>u.cells[y],$o=(u,y)=>Ho(u,y).element,Vo=u=>u.cells.length,qo=u=>{let y=B(u,u=>"colgroup"===u.section);return{rows:y.fail,cols:y.pass}},Uo=(u,y,x)=>{let R=E(u.cells,x);return tt(y(u.element),R,u.section,!0)},eG="data-snooker-locked-cols",Ko=u=>we(u,eG).bind(u=>C.from(u.match(/\d+/g))).map(u=>I(u,ei)),Yo=u=>{let y=A(qo(u).rows,(u,y)=>(N(y.cells,(y,x)=>{y.isLocked&&(u[x]=!0)}),u),{}),x=J(y,(u,y)=>parseInt(y,10));return((u,y)=>{let x=ec.call(u,0);return x.sort(void 0),x})(x)},Jo=(u,y)=>u+","+y,Qo=(u,y)=>{let x=j(u.all,u=>u.cells);return _(x,y)},Xo=u=>{let y={},x=[],R=H(u).map(u=>u.element).bind(Kt).bind(Ko).getOr({}),S=0,T=0,q=0,{pass:Z,fail:U}=B(u,u=>"colgroup"===u.section);N(U,u=>{let Z=[];N(u.cells,u=>{var x,S,U;let en=0;for(;void 0!==y[Jo(q,en)];)en++;let ea=X(R,x=en.toString())&&void 0!==R[x]&&null!==R[x],ei=(S=u.element,U=u.rowspan,{element:S,rowspan:U,colspan:u.colspan,row:q,column:en,isLocked:ea});for(let x=0;x<u.colspan;x++)for(let R=0;R<u.rowspan;R++){let u=en+x,S=Jo(q+R,u);y[S]=ei,T=Math.max(T,u+1)}Z.push(ei)}),S++,x.push(Ze(u.element,Z,u.section)),q++});let{columns:en,colgroups:ea}=$(Z).map(u=>{let y=(u=>{let y={},x=0;return N(u.cells,u=>{let R=u.colspan;k(R,S=>{let T=x+S;y[T]={element:u.element,colspan:R,column:T}}),x+=R}),y})(u),x={element:u.element,columns:Q(y)};return{colgroups:[x],columns:y}}).getOrThunk(()=>({colgroups:[],columns:{}})),ei={rows:S,columns:T};return{grid:ei,access:y,all:x,columns:en,colgroups:ea}},Zo=u=>{let y=Zt(u);return Xo(y)},tn=(u,y,x)=>C.from(u.access[Jo(y,x)]),on=(u,y,x)=>{let R=Qo(u,u=>x(y,u.element));return R.length>0?C.some(R[0]):C.none()},rn=u=>j(u.all,u=>u.cells),sn=u=>Q(u.columns),ln=u=>ef(u.columns).length>0,an=(u,y)=>C.from(u.columns[y]),cn=(u,y=ei)=>{let x=u.grid,R=k(x.columns,h),S=k(x.rows,h);return E(R,x=>mn(()=>j(S,y=>tn(u,y,x).filter(u=>u.column===x).toArray()),u=>1===u.colspan&&y(u.element),()=>tn(u,0,x)))},mn=(u,y,x)=>{let R=u();return L(R,y).orThunk(()=>C.from(R[0]).orThunk(x)).map(u=>u.element)},dn=u=>{let y=u.grid,x=k(y.rows,h),R=k(y.columns,h);return E(x,y=>mn(()=>j(R,x=>tn(u,y,x).filter(u=>u.row===y).fold(g([]),u=>[u])),u=>1===u.rowspan,()=>tn(u,y,0)))},un=(u,y)=>x=>"rtl"===fn(x)?y:u,fn=u=>"rtl"===_t(u,"direction")?"rtl":"ltr",eJ=_o("height",u=>{let y=u.dom;return lt(u)?y.getBoundingClientRect().height:y.offsetHeight}),hn=u=>eJ.get(u),pn=u=>eJ.getOuter(u),wn=(u,y)=>({left:u,top:y,translate:(x,R)=>wn(u+x,y+R)}),vn=(u,y)=>void 0!==u?u:void 0!==y?y:0,yn=u=>{let y=u.dom.ownerDocument,x=y.body,R=y.defaultView,S=y.documentElement;if(x===u.dom)return wn(x.offsetLeft,x.offsetTop);let T=vn(null==R?void 0:R.pageYOffset,S.scrollTop),q=vn(null==R?void 0:R.pageXOffset,S.scrollLeft),Z=vn(S.clientTop,x.clientTop),U=vn(S.clientLeft,x.clientLeft);return xn(u).translate(q-U,T-Z)},xn=u=>{let y=u.dom,x=y.ownerDocument.body;return x===y?wn(x.offsetLeft,x.offsetTop):lt(u)?(u=>{let y=u.getBoundingClientRect();return wn(y.left,y.top)})(y):wn(0,0)},Cn=(u,y)=>({row:u,y:y}),Sn=(u,y)=>({col:u,x:y}),Tn=u=>yn(u).left+Wo(u),Rn=u=>yn(u).left,Dn=(u,y)=>Sn(u,Rn(y)),On=(u,y)=>Sn(u,Tn(y)),kn=u=>yn(u).top,En=(u,y)=>Cn(u,kn(y)),Nn=(u,y)=>Cn(u,kn(y)+pn(y)),Bn=(u,y,x)=>{if(0===x.length)return[];let R=E(x.slice(1),(y,x)=>y.map(y=>u(x,y))),S=x[x.length-1].map(u=>y(x.length-1,u));return R.concat([S])},eU={delta:h,positions:u=>Bn(En,Nn,u),edge:kn},eQ=un({delta:h,edge:Rn,positions:u=>Bn(Dn,On,u)},{delta:u=>-u,edge:Tn,positions:u=>Bn(On,Dn,u)}),eX={delta:(u,y)=>eQ(y).delta(u,y),positions:(u,y)=>eQ(y).positions(u,y),edge:u=>eQ(u).edge(u)},e0={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},e1=(()=>{let u="[0-9]+",y="[eE][+-]?"+u,o=u=>`(?:${u})?`,x=["Infinity",u+"\\."+o(u)+o(y),"\\."+u+o(y),u+o(y)].join("|");return RegExp(`^([+-]?(?:${x}))(.*)$`)})(),e9=/(\d+(\.\d+)?)%/,e3=/(\d+(\.\d+)?)px|em/,e5=ue("col"),In=(u,y,x)=>{let R=Be(u).getOrThunk(()=>at(ke(u)));return y(u)/x(R)*100},Fn=(u,y)=>{Nt(u,"width",y+"px")},Hn=(u,y)=>{Nt(u,"width",y+"%")},$n=(u,y)=>{Nt(u,"height",y+"px")},Vn=u=>{let y=zo(u,"height",u.dom.offsetHeight)+"px";return y?((u,y,x,R)=>{let S=parseFloat(u);return Rt(u,"%")&&"table"!==ne(y)?((u,y,x,R)=>{let S=Kt(u).map(u=>{let R=x(u);return Math.floor(y/100*R)}).getOr(y);return R(u,S),S})(y,S,x,R):S})(y,u,hn,$n):hn(u)},qn=(u,y)=>At(u,y).orThunk(()=>we(u,y).map(u=>u+"px")),Un=u=>qn(u,"width"),Gn=u=>In(u,Lo,Mo),Kn=u=>e5(u)?Lo(u):zo(u,"width",u.dom.offsetWidth),Yn=u=>Vn(u)/Mt(u,"rowspan"),Jn=(u,y,x)=>{Nt(u,"width",y+x)},Qn=u=>In(u,Lo,Mo)+"%",e2=g(e9),e7=ue("col"),er=u=>Un(u).getOrThunk(()=>Kn(u)+"px"),tr=u=>qn(u,"height").getOrThunk(()=>Yn(u)+"px"),or=(u,y,x,R,S,T)=>u.filter(R).fold(()=>T(((u,y)=>{if(y<0||y>=u.length-1)return C.none();let x=u[y].fold(()=>{let x=(u=>{let y=ec.call(u,0);return y.reverse(),y})(u.slice(0,y));return V(x,(u,y)=>u.map(u=>({value:u,delta:y+1})))},u=>C.some({value:u,delta:0})),R=u[y+1].fold(()=>{let x=u.slice(y+1);return V(x,(u,y)=>u.map(u=>({value:u,delta:y+1})))},u=>C.some({value:u,delta:1}));return x.bind(u=>R.map(y=>{let x=y.delta+u.delta;return Math.abs(y.value-u.value)/x}))})(x,y)),u=>S(u)),nr=(u,y,x,R)=>{let S=cn(u),T=ln(u)?E(sn(u),u=>C.from(u.element)):S,q=[C.some(eX.edge(y))].concat(E(eX.positions(S,y),u=>u.map(u=>u.x))),Z=b(jt);return E(T,(u,y)=>or(u,y,q,Z,u=>{var T;if((u=>{let y=Bo().browser,x=y.isChromium()||y.isFirefox();return!e7(u)||x})(u))return x(u);{let u=null!=(T=S[y])?h(T):C.none();return or(u,y,q,Z,u=>R(C.some(Lo(u))),R)}},R))},rr=u=>u.map(u=>u+"px").getOr(""),sr=(u,y,x)=>nr(u,y,Kn,u=>u.getOrThunk(x.minCellWidth)),lr=(u,y,x,R,S)=>{let T=dn(u),q=[C.some(x.edge(y))].concat(E(x.positions(T,y),u=>u.map(u=>u.y)));return E(T,(u,y)=>or(u,y,q,b(Pt),R,S))},ar=(u,y)=>()=>lt(u)?y(u):parseFloat(At(u,"width").getOr("0")),cr=u=>{let y=ar(u,u=>parseFloat(Qn(u))),x=ar(u,Lo);return{width:y,pixelWidth:x,getWidths:(y,x)=>nr(y,u,Gn,u=>u.fold(()=>x.minCellWidth(),u=>u/x.pixelWidth()*100)),getCellDelta:u=>u/x()*100,singleColumnWidth:(u,y)=>[100-u],minCellWidth:()=>eE()/x()*100,setElementWidth:Hn,adjustTableWidth:x=>{let R=y();Hn(u,R+x/100*R)},isRelative:!0,label:"percent"}},ir=u=>{let y=ar(u,Lo);return{width:y,pixelWidth:y,getWidths:(y,x)=>sr(y,u,x),getCellDelta:h,singleColumnWidth:(u,y)=>[Math.max(eE(),u+y)-u],minCellWidth:eE,setElementWidth:Fn,adjustTableWidth:x=>{let R=y()+x;Fn(u,R)},isRelative:!1,label:"pixel"}},mr=u=>Un(u).fold(()=>(u=>{let y=ar(u,Lo),x=g(0);return{width:y,pixelWidth:y,getWidths:(y,x)=>sr(y,u,x),getCellDelta:x,singleColumnWidth:g([0]),minCellWidth:x,setElementWidth:f,adjustTableWidth:f,isRelative:!0,label:"none"}})(u),y=>null!==e2().exec(y)?cr(u):ir(u)),fr=(u,y,x)=>{let R=u[x].element,S=ey.fromTag("td");Ie(S,ey.fromTag("br")),(y?Ie:Pe)(R,S)},e4=((u,y)=>{let o=y=>u(y)?C.from(y.dom.nodeValue):C.none();return{get:y=>{if(!u(y))throw Error("Can only get text value of a text node");return o(y).getOr("")},getOption:o,set:(y,x)=>{if(!u(y))throw Error("Can only set raw text value of a text node");y.dom.nodeValue=x}}})(ew),hr=u=>e4.get(u),pr=u=>e4.getOption(u),wr=(u,y)=>e4.set(u,y),br=u=>"img"===ne(u)?1:pr(u).fold(()=>Le(u).length,u=>u.length),e6=["img","br"],yr=u=>pr(u).filter(u=>0!==u.trim().length||u.indexOf("\xa0")>-1).isSome()||D(e6,ne(u))||ae(u)&&"false"===pe(u,"contenteditable"),xr=u=>((u,y)=>{let o=u=>{for(let x=0;x<u.childNodes.length;x++){let R=ey.fromDom(u.childNodes[x]);if(y(R))return C.some(R);let S=o(u.childNodes[x]);if(S.isSome())return S}return C.none()};return o(u.dom)})(u,yr),Cr=u=>Sr(u,yr),Sr=(u,y)=>{let o=u=>{let x=Le(u);for(let u=x.length-1;u>=0;u--){let R=x[u];if(y(R))return C.some(R);let S=o(R);if(S.isSome())return S}return C.none()};return o(u)},e8={scope:["row","col"]},Rr=u=>()=>{let y=ey.fromTag("td",u.dom);return Ie(y,ey.fromTag("br",u.dom)),y},Dr=u=>()=>ey.fromTag("col",u.dom),Or=u=>()=>ey.fromTag("colgroup",u.dom),kr=u=>()=>ey.fromTag("tr",u.dom),Er=(u,y,x)=>{let R=((u,y)=>{let x=Je(u,y),R=Le(Ye(u));return $e(x,R),x})(u,y);return G(x,(u,y)=>{null===u?be(R,y):ge(R,y,u)}),R},Nr=u=>u,Br=(u,y,x)=>{let n=(u,y)=>{((u,y)=>{let x=u.dom,R=y.dom;kt(x)&&kt(R)&&(R.style.cssText=x.style.cssText)})(u.element,y),Lt(y,"height"),1!==u.colspan&&Lt(y,"width")};return{col:x=>{let R=ey.fromTag(ne(x.element),y.dom);return n(x,R),u(x.element,R),R},colgroup:Or(y),row:kr(y),cell:R=>{var S,T;let q=ey.fromTag(ne(R.element),y.dom),Z=x.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),U=Z.length>0?xr(S=R.element).map(u=>{let y=Z.join(","),x=it(u,y,u=>Re(u,S));return z(x,(u,y)=>{let x=Ke(y);return Ie(u,x),x},q)}).getOr(q):q;return Ie(U,ey.fromTag("br")),n(R,q),T=R.element,G(e8,(u,y)=>we(T,y).filter(y=>D(u,y)).each(u=>ge(q,y,u))),u(R.element,q),q},replace:Er,colGap:Dr(y),gap:Rr(y)}},_r=u=>({col:Dr(u),colgroup:Or(u),row:kr(u),cell:Rr(u),replace:Nr,colGap:Dr(u),gap:Rr(u)}),zr=u=>y=>y.options.get(u),te="100%",Lr=u=>{var y;let x=u.dom,R=null!==(y=x.getParent(u.selection.getStart(),x.isBlock))&&void 0!==y?y:u.getBody();return Mo(ey.fromDom(R))+"px"},Wr=u=>C.from(u.options.get("table_clone_elements")),tc=zr("table_header_type"),td=zr("table_column_resizing"),Pr=u=>"preservetable"===td(u),Ir=u=>"resizetable"===td(u),tu=zr("table_sizing_mode"),Hr=u=>"relative"===tu(u),$r=u=>"fixed"===tu(u),Vr=u=>"responsive"===tu(u),tf=zr("table_resize_bars"),tg=zr("table_style_by_css"),th=zr("table_merge_content_on_paste"),Kr=u=>{let y=u.options,x=y.get("table_default_attributes");return y.isSet("table_default_attributes")?x:Vr(u)||tg(u)?x:$r(u)?{...x,width:Lr(u)}:{...x,width:te}},tp=zr("table_use_colgroups"),Jr=u=>bt(u,"[contenteditable]"),Qr=(u,y=!1)=>lt(u)?u.dom.isContentEditable:Jr(u).fold(g(y),u=>"true"===Xr(u)),Xr=u=>u.dom.contentEditable,Zr=u=>ey.fromDom(u.getBody()),es=u=>y=>Re(y,Zr(u)),ts=u=>{be(u,"data-mce-style");let t=u=>be(u,"data-mce-style");N(Ut(u),t),N(Gt(u),t),N(Yt(u),t)},os=u=>ey.fromDom(u.selection.getStart()),ns=u=>u.getBoundingClientRect().width,rs=u=>u.getBoundingClientRect().height,ss=u=>gt(u,ue("table")).exists(Qr),ls=(u,y)=>{let x=y.column,R=y.column+y.colspan-1,S=y.row,T=y.row+y.rowspan-1;return x<=u.finishCol&&R>=u.startCol&&S<=u.finishRow&&T>=u.startRow},as=(u,y)=>y.column>=u.startCol&&y.column+y.colspan-1<=u.finishCol&&y.row>=u.startRow&&y.row+y.rowspan-1<=u.finishRow,cs=(u,y,x)=>{let R=on(u,y,Re),S=on(u,x,Re);return R.bind(u=>S.map(y=>({startRow:Math.min(u.row,y.row),startCol:Math.min(u.column,y.column),finishRow:Math.max(u.row+u.rowspan-1,y.row+y.rowspan-1),finishCol:Math.max(u.column+u.colspan-1,y.column+y.colspan-1)})))},is=(u,y,x)=>cs(u,y,x).map(y=>{let x=Qo(u,w(ls,y));return E(x,u=>u.element)}),ms=(u,y)=>on(u,y,(u,y)=>De(y,u)).map(u=>u.element),ds=(u,y,x)=>{let R=tb(u);return is(R,y,x)},us=(u,y,x,R,S)=>{let T=tb(u),q=Re(u,x)?C.some(y):ms(T,y),Z=Re(u,S)?C.some(R):ms(T,R);return q.bind(u=>Z.bind(y=>is(T,u,y)))},tb=Zo;var tw=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],hs=()=>({up:g({selector:ht,closest:bt,predicate:ft,all:_e}),down:g({selector:dt,predicate:ct}),styles:g({get:_t,getRaw:At,set:Nt,remove:Lt}),attrs:g({get:pe,set:ge,remove:be,copyTo:(u,y)=>{let x=ve(u);he(y,x)}}),insert:g({before:Me,after:je,afterAll:He,append:Ie,appendAll:$e,prepend:Pe,wrap:Fe}),remove:g({unwrap:Ue,remove:qe}),create:g({nu:ey.fromTag,clone:u=>ey.fromDom(u.dom.cloneNode(!1)),text:ey.fromText}),query:g({comparePosition:(u,y)=>u.dom.compareDocumentPosition(y.dom),prevSibling:ze,nextSibling:Ae}),property:g({children:Le,name:ne,parent:Ne,document:u=>Ee(u).dom,isText:ew,isComment:le,isElement:eb,isSpecial:u=>{let y=ne(u);return D(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],y)},getLanguage:u=>eb(u)?we(u,"lang"):C.none(),getText:hr,setText:wr,isBoundary:u=>!!eb(u)&&("body"===ne(u)||D(tw,ne(u))),isEmptyTag:u=>!!eb(u)&&D(["br","img","hr","input"],ne(u)),isNonEditable:u=>eb(u)&&"false"===pe(u,"contenteditable")}),eq:Re,is:Ce});let ps=(u,y,x,R)=>{let S=y(u,x);return z(R,(x,R)=>{let S=y(u,R);return ws(u,x,S)},S)},ws=(u,y,x)=>y.bind(y=>x.filter(w(u.eq,y))),tC=hs(),vs=(u,y)=>y.length>0?ps(tC,(y,x)=>u(x),y[0],y.slice(1)):C.none(),ys=u=>ht(u,"table"),xs=(u,y,x)=>{let n=u=>y=>void 0!==x&&x(y)||Re(y,u);return Re(u,y)?C.some({boxes:C.some([u]),start:u,finish:y}):ys(u).bind(R=>ys(y).bind(S=>{if(Re(R,S))return C.some({boxes:ds(R,u,y),start:u,finish:y});if(De(R,S)){let x=it(y,"td,th",n(R)),T=x.length>0?x[x.length-1]:y;return C.some({boxes:us(R,u,R,y,S),start:u,finish:T})}if(De(S,R)){let x=it(u,"td,th",n(S)),T=x.length>0?x[x.length-1]:u;return C.some({boxes:us(S,u,R,y,S),start:u,finish:T})}return((u,y,x,R=ea)=>{let S=[y].concat(u.up().all(y)),T=[x].concat(u.up().all(x)),l=u=>W(u,R).fold(()=>u,y=>u.slice(0,y+1)),q=l(S),Z=l(T),U=L(q,y=>O(Z,w(u.eq,y)));return{firstpath:q,secondpath:Z,shared:U}})(tC,u,y,void 0).shared.bind(T=>bt(T,"table",x).bind(x=>{let T=it(y,"td,th",n(x)),q=T.length>0?T[T.length-1]:y,Z=it(u,"td,th",n(x)),U=Z.length>0?Z[Z.length-1]:u;return C.some({boxes:us(x,u,R,y,S),start:U,finish:q})}))}))},Cs=(u,y)=>{let x=dt(u,y);return x.length>0?C.some(x):C.none()},Ss=(u,y,x)=>wt(u,y).bind(y=>wt(u,x).bind(u=>vs(ys,[y,u]).map(x=>({first:y,last:u,table:x})))),Ts=(u,y,x,R,S)=>L(u,u=>Ce(u,S)).bind(u=>Kt(u).bind(R=>{var S;return on(S=tb(R),u,Re).bind(u=>{let R=y>0?u.row+u.rowspan-1:u.row,T=x>0?u.column+u.colspan-1:u.column;return tn(S,R+y,T+x).map(u=>u.element)})}).bind(u=>ht(u,"table").bind(y=>wt(y,R).bind(y=>xs(y,u).bind(u=>u.boxes.map(y=>({boxes:y,start:u.start,finish:u.finish}))))))),Rs=(u,y)=>Cs(u,y),Ds=(u,y,x)=>Ss(u,y,x).bind(y=>{let o=y=>Re(u,y),x="thead,tfoot,tbody,table",R=ht(y.first,x,o),S=ht(y.last,x,o);return R.bind(u=>S.bind(x=>{var R,S,T,q;return Re(u,x)?(R=y.table,S=y.first,T=y.last,cs(q=tb(R),S,T).bind(u=>((u,y)=>{let x=!0,R=w(as,y);for(let S=y.startRow;S<=y.finishRow;S++)for(let T=y.startCol;T<=y.finishCol;T++)x=x&&tn(u,S,T).exists(R);return x?C.some(y):C.none()})(q,u))):C.none()}))}),ks=u=>{let t=(u,y)=>we(u,y).exists(u=>parseInt(u,10)>1);return u.length>0&&P(u,u=>t(u,"rowspan")||t(u,"colspan"))?C.some(u):C.none()},Es=(u,y,x)=>y.length<=1?C.none():Ds(u,x.firstSelectedSelector,x.lastSelectedSelector).map(u=>({bounds:u,cells:y})),tv="data-mce-selected",ty="data-mce-first-selected",tx="data-mce-last-selected",tR="["+tv+"]",tS={selected:tv,selectedSelector:"td["+tv+"],th["+tv+"]",firstSelected:ty,firstSelectedSelector:"td["+ty+"],th["+ty+"]",lastSelected:tx,lastSelectedSelector:"td["+tx+"],th["+tx+"]"},Ls=(u,y,x)=>({element:x,mergable:Es(y,u,tS),unmergable:ks(u),selection:h(u)}),Ws=u=>(y,x)=>{let R=ne(y),S="col"===R||"colgroup"===R?Kt(y).bind(u=>Rs(u,tS.firstSelectedSelector)).fold(g(y),u=>u[0]):y;return bt(S,u,x)},tD=Ws("th,td,caption"),tT=Ws("th,td"),Ps=u=>E(u.model.table.getSelectedCells(),ey.fromDom),Is=(u,y)=>{u.on("BeforeGetContent",y=>{if(!0===y.selection){let x=_(Ps(u),u=>Ce(u,tS.selectedSelector));x.length>=1&&(y.preventDefault(),Kt(x[0]).map(u=>{let y=((u,y)=>{let o=u=>Ce(u.element,y),x=Ye(u),R=Zt(x),S=mr(u),T=Xo(R),q=((u,y)=>{let x=u.grid.columns,R=u.grid.rows,S=x,T=0,q=0,Z=[],U=[];return G(u.access,u=>{if(Z.push(u),y(u)){U.push(u);let y=u.row,x=y+u.rowspan-1,Z=u.column,en=Z+u.colspan-1;y<R?R=y:x>T&&(T=x),Z<S?S=Z:en>q&&(q=en)}}),{minRow:R,minCol:S,maxRow:T,maxCol:q,allCells:Z,selectedCells:U}})(T,o),Z="th:not("+y+"),td:not("+y+")",U=Vt(x,"th,td",u=>Ce(u,Z));N(U,qe),((u,y,x,R)=>{let S=_(u,u=>"colgroup"!==u.section),T=y.grid.columns,q=y.grid.rows;for(let u=0;u<q;u++){let q=!1;for(let Z=0;Z<T;Z++)u<x.minRow||u>x.maxRow||Z<x.minCol||Z>x.maxCol||(tn(y,u,Z).filter(R).isNone()?fr(S,q,u):q=!0)}})(R,T,q,o);let en=((u,y,x,R)=>{if(0===R.minCol&&y.grid.columns===R.maxCol+1)return 0;let S=sr(y,u,x),T=A(S,(u,y)=>u+y,0),q=A(S.slice(R.minCol,R.maxCol+1),(u,y)=>u+y,0),Z=q/T*x.pixelWidth()-x.pixelWidth();return x.getCellDelta(Z)})(u,Zo(u),S,q);return((u,y,x,R)=>{G(x.columns,u=>{(u.column<y.minCol||u.column>y.maxCol)&&qe(u.element)});let S=_($t(u,"tr"),u=>0===u.dom.childElementCount);N(S,qe),y.minCol!==y.maxCol&&y.minRow!==y.maxRow||N($t(u,"th,td"),u=>{be(u,"rowspan"),be(u,"colspan")}),be(u,eG),be(u,"data-snooker-col-series"),mr(u).adjustTableWidth(R)})(x,q,T,en),x})(u,tR);return ts(y),[y]}).each(x=>{y.content="text"===y.format?E(x,u=>u.dom.innerText).join(""):E(x,y=>u.selection.serializer.serialize(y.dom,{})).join("")}))}}),u.on("BeforeSetContent",x=>{if(!0===x.selection&&!0===x.paste){let R=Ps(u);H(R).each(R=>{Kt(R).each(S=>{let T=_(((u,y)=>{let x=document.createElement("div");return x.innerHTML=u,Le(ey.fromDom(x))})(x.content),u=>"meta"!==ne(u)),q=ue("table");if(th(u)&&1===T.length&&q(T[0])){x.preventDefault();let q=ey.fromDom(u.getDoc()),Z=_r(q),U={element:R,clipboard:T[0],generators:Z};y.pasteCells(S,U).each(()=>{u.focus()})}})})}})},Fs=(u,y)=>({element:u,offset:y}),Hs=(u,y,x)=>u.property().isText(y)&&0===u.property().getText(y).trim().length||u.property().isComment(y)?x(y).bind(y=>Hs(u,y,x).orThunk(()=>C.some(y))):C.none(),$s=(u,y)=>u.property().isText(y)?u.property().getText(y).length:u.property().children(y).length,Vs=(u,y)=>{let x=Hs(u,y,u.query().prevSibling).getOr(y);if(u.property().isText(x))return Fs(x,$s(u,x));let R=u.property().children(x);return R.length>0?Vs(u,R[R.length-1]):Fs(x,$s(u,x))},tE=hs(),Gs=(u,y)=>{if(!jt(u)){let x=Un(u).bind(u=>{var y;return y=["fixed","relative","empty"],C.from(e1.exec(u)).bind(u=>{let x=Number(u[1]),R=u[2];return O(y,u=>O(e0[u],u=>R===u))?C.some({value:x,unit:R}):C.none()})});x.each(x=>{let R=x.value/2;Jn(u,R,x.unit),Jn(y,R,x.unit)})}},Ks=u=>E(u,g(0)),Ys=(u,y,x,R,S)=>S(u.slice(0,y)).concat(R).concat(S(u.slice(x))),Js=u=>(y,x,R,S)=>{if(u(R)){let u=Math.max(S,y[x]-Math.abs(R)),T=Math.abs(u-y[x]);return R>=0?T:-T}return R},tk=Js(u=>u<0),tO=Js(ei),Zs=()=>{let e=(u,y,x,R)=>{let S=(100+x)/100,T=Math.max(R,(u[y]+x)/S);return E(u,(u,x)=>(x===y?T:u/S)-u)},t=(u,y,x,R,S,T)=>T?e(u,y,R,S):((u,y,x,R,S)=>{let T=tk(u,y,R,S);return Ys(u,y,x+1,[T,0],Ks)})(u,y,x,R,S);return{resizeTable:(u,y)=>u(y),clampTableDelta:tk,calcLeftEdgeDeltas:t,calcMiddleDeltas:(u,y,x,R,S,T,q)=>t(u,x,R,S,T,q),calcRightEdgeDeltas:(u,y,x,R,S,T)=>{if(T)return e(u,x,R,S);{let y=tk(u,x,R,S);return Ks(u.slice(0,x)).concat([y])}},calcRedestributedWidths:(u,y,x,R)=>{if(R){let R=(y+x)/y,S=E(u,u=>u/R);return{delta:100*R-100,newSizes:S}}return{delta:x,newSizes:u}}}},el=()=>{let e=(u,y,x,R,S)=>{let T=tO(u,R>=0?x:y,R,S);return Ys(u,y,x+1,[T,-T],Ks)};return{resizeTable:(u,y,x)=>{x&&u(y)},clampTableDelta:(u,y,x,R,S)=>{if(S){if(x>=0)return x;{let y=A(u,(u,y)=>u+y-R,0);return Math.max(-y,x)}}return tk(u,y,x,R)},calcLeftEdgeDeltas:e,calcMiddleDeltas:(u,y,x,R,S,T)=>e(u,x,R,S,T),calcRightEdgeDeltas:(u,y,x,R,S,T)=>{if(T)return Ks(u);{let y=R/u.length;return E(u,g(y))}},calcRedestributedWidths:(u,y,x,R)=>({delta:0,newSizes:u})}},tl=u=>Zo(u).grid,tN=ue("th"),nl=u=>P(u,u=>tN(u.element)),rl=(u,y)=>u&&y?"sectionCells":u?"section":"cells",sl=u=>{let y="thead"===u.section,x=vt(ll(u.cells),"th");return"tfoot"===u.section?{type:"footer"}:y||x?{type:"header",subType:rl(y,x)}:{type:"body"}},ll=u=>{let y=_(u,u=>tN(u.element));return 0===y.length?C.some("td"):y.length===u.length?C.some("th"):C.none()},al=(u,y,x)=>et(x(u.element,y),!0,u.isLocked),cl=(u,y)=>u.section!==y?tt(u.element,u.cells,y,u.isNew):u,il=()=>({transformRow:cl,transformCell:(u,y,x)=>{let R=x(u.element,y),S="td"!==ne(R)?((u,y)=>{let x=Je(u,"td");je(u,x);let R=Le(u);return $e(x,R),qe(u),x})(R):R;return et(S,u.isNew,u.isLocked)}}),ml=()=>({transformRow:cl,transformCell:al}),dl=()=>({transformRow:(u,y)=>cl(u,"thead"===y?"tbody":y),transformCell:al}),hl=()=>({transformRow:h,transformCell:al}),pl=(u,y,x,R)=>{x===R?be(u,y):ge(u,y,x)},wl=(u,y,x)=>{$(mt(u,y)).fold(()=>Pe(u,x),u=>je(u,x))},bl=(u,y)=>{let x=[],R=[],r=u=>E(u,u=>{u.isNew&&x.push(u.element);let y=u.element;return Ve(y),N(u.cells,u=>{u.isNew&&R.push(u.element),pl(u.element,"colspan",u.colspan,1),pl(u.element,"rowspan",u.rowspan,1),Ie(y,u.element)}),y}),s=u=>j(u,u=>E(u.cells,u=>(pl(u.element,"span",u.colspan,1),u.element))),l=(y,x)=>{let R=((u,y)=>{let x=pt(u,y).getOrThunk(()=>{let x=ey.fromTag(y,ke(u).dom);return"thead"===y?wl(u,"caption,colgroup",x):"colgroup"===y?wl(u,"caption",x):Ie(u,x),x});return Ve(x),x})(u,x),S=("colgroup"===x?s:r)(y);$e(R,S)},a=(y,x)=>{y.length>0?l(y,x):(y=>{pt(u,y).each(qe)})(x)},S=[],T=[],q=[],Z=[];return N(y,u=>{switch(u.section){case"thead":S.push(u);break;case"tbody":T.push(u);break;case"tfoot":q.push(u);break;case"colgroup":Z.push(u)}}),a(Z,"colgroup"),a(S,"thead"),a(T,"tbody"),a(q,"tfoot"),{newRows:x,newCells:R}},vl=(u,y)=>{if(0===u.length)return 0;let x=u[0];return W(u,u=>!y(x.element,u.element)).getOr(u.length)},yl=(u,y)=>{let x=E(u,u=>E(u.cells,ea));return E(u,(R,S)=>{var T;let q=j(R.cells,(R,T)=>{var q;if(!1===x[S][T]){let Z=((u,y,x,R)=>{let S=u[y],T="colgroup"===S.section,q=vl(S.cells.slice(x),R),Z=T?1:vl(E(u.slice(y),u=>Ho(u,x)),R);return{colspan:q,rowspan:Z}})(u,S,T,y);return((u,y,R,S)=>{for(let T=u;T<u+R;T++)for(let u=y;u<y+S;u++)x[T][u]=!0})(S,T,Z.rowspan,Z.colspan),[(q=R.element,{element:q,rowspan:Z.rowspan,colspan:Z.colspan,isNew:R.isNew})]}return[]});return T=R.element,{element:T,cells:q,section:R.section,isNew:R.isNew}})},xl=(u,y,x)=>{let R=[];N(u.colgroups,S=>{let T=[];for(let R=0;R<u.grid.columns;R++){let S=an(u,R).map(u=>et(u.element,x,!1)).getOrThunk(()=>et(y.colGap(),!0,!1));T.push(S)}R.push(tt(S.element,T,"colgroup",x))});for(let S=0;S<u.grid.rows;S++){let T=[];for(let R=0;R<u.grid.columns;R++){let q=tn(u,S,R).map(u=>et(u.element,x,u.isLocked)).getOrThunk(()=>et(y.gap(),!0,!1));T.push(q)}let q=u.all[S],Z=tt(q.element,T,q.section,x);R.push(Z)}return R},Cl=u=>yl(u,Re),Sl=(u,y)=>V(u.all,u=>L(u.cells,u=>Re(y,u.element))),Tl=(u,y,x)=>{let R=E(y.selection,y=>qt(y).bind(y=>Sl(u,y)).filter(x)),S=yt(R);return xt(S.length>0,S)},Rl=(u,y,x,R,S)=>(T,q,Z,U)=>{let en=Zo(T),ea=C.from(null==U?void 0:U.section).getOrThunk(hl);return y(en,q).map(y=>{let x=xl(en,Z,!1),R=u(x,y,Re,S(Z),ea),T=Yo(R.grid);return{info:y,grid:Cl(R.grid),cursor:R.cursor,lockedColumns:T}}).bind(u=>{let y=bl(T,u.grid),S=C.from(null==U?void 0:U.sizing).getOrThunk(()=>mr(T)),q=C.from(null==U?void 0:U.resize).getOrThunk(el);return x(T,u.grid,u.info,{sizing:S,resize:q,section:ea}),R(T),be(T,eG),u.lockedColumns.length>0&&ge(T,eG,u.lockedColumns.join(",")),C.some({cursor:u.cursor,newRows:y.newRows,newCells:y.newCells})})},Dl=(u,y)=>Tl(u,y,ei).map(u=>({cells:u,generators:y.generators,clipboard:y.clipboard})),Ol=(u,y)=>Tl(u,y,ei),kl=(u,y)=>Tl(u,y,u=>!u.isLocked),El=(u,y)=>P(y,y=>Sl(u,y).exists(u=>!u.isLocked)),Nl=(u,y,x,R)=>{let S=qo(u).rows,T=!0;for(let u=0;u<S.length;u++)for(let q=0;q<Vo(S[0]);q++){let Z=S[u],U=Ho(Z,q),en=x(U.element,y);en&&!T?Io(Z,q,et(R(),!0,U.isLocked)):en&&(T=!1)}return u},Bl=u=>{let t=y=>y(u),y=g(u),n=()=>x,x={tag:!0,inner:u,fold:(y,x)=>x(u),isValue:ei,isError:ea,map:y=>tL.value(y(u)),mapError:n,bind:t,exists:t,forall:t,getOr:y,or:n,getOrThunk:y,orThunk:n,getOrDie:y,each:y=>{y(u)},toOptional:()=>C.some(u)};return x},_l=u=>{var y;let t=()=>x,x={tag:!1,inner:u,fold:(y,x)=>y(u),isValue:ea,isError:ei,map:t,mapError:y=>tL.error(y(u)),bind:t,exists:ea,forall:ei,getOr:h,or:h,getOrThunk:v,orThunk:v,getOrDie:(y=String(u),()=>{throw Error(y)}),each:f,toOptional:C.none};return x},tL={value:Bl,error:_l,fromOption:(u,y)=>u.fold(()=>_l(y),Bl)},Al=(u,y)=>({rowDelta:0,colDelta:Vo(u[0])-Vo(y[0])}),Ll=(u,y)=>({rowDelta:u.length-y.length,colDelta:0}),Wl=(u,y,x,R)=>{let S="colgroup"===y.section?x.col:x.cell;return k(u,u=>et(S(),!0,R(u)))},Ml=(u,y,x,R)=>{let S=u[u.length-1];return u.concat(k(y,()=>{let u="colgroup"===S.section?x.colgroup:x.row,y=Uo(S,u,h),T=Wl(y.cells.length,y,x,u=>X(R,u.toString()));return Fo(y,T)}))},jl=(u,y,x,R)=>E(u,u=>{let S=Wl(y,u,x,ea);return jo(u,R,S)}),Pl=(u,y,x)=>{let R=y.colDelta<0?jl:h,S=y.rowDelta<0?Ml:h,T=Yo(u),q=Vo(u[0]),Z=O(T,u=>u===q-1),U=R(u,Math.abs(y.colDelta),x,Z?q-1:q),en=Yo(U);return S(U,Math.abs(y.rowDelta),x,I(en,ei))},Il=(u,y,x,R)=>{let S=w(R,Ho(u[y],x).element),T=u[y];return u.length>1&&Vo(T)>1&&(x>0&&S($o(T,x-1))||x<T.cells.length-1&&S($o(T,x+1))||y>0&&S($o(u[y-1],x))||y<u.length-1&&S($o(u[y+1],x)))},Fl=(u,y,x)=>_(x,x=>x>=u.column&&x<=Vo(y[0])+u.column),Hl=(u,y,x,R,S)=>{var T;T=R.cell,u>0&&u<y[0].cells.length&&N(y,y=>{let x=y.cells[u-1],R=0,q=T();for(;y.cells.length>u+R&&S(x.element,y.cells[u+R].element);)Io(y,u+R,et(q,!0,y.cells[u+R].isLocked)),R++});let q=Ll(x,y),Z=Pl(x,q,R),U=Ll(y,Z),en=Pl(y,U,R);return E(en,(y,x)=>jo(y,u,Z[x].cells))},$l=(u,y,x,R,S)=>{((u,y,x,R)=>{let S=qo(u).rows;if(y>0&&y<S.length){let u=A(S[y-1].cells,(u,y)=>O(u,u=>x(u.element,y.element))?u:u.concat([y]),[]);N(u,u=>{let T=C.none();for(let q=y;q<S.length;q++)for(let y=0;y<Vo(S[0]);y++){let Z=S[q],U=Ho(Z,y);x(U.element,u.element)&&(T.isNone()&&(T=C.some(R())),T.each(u=>{Io(Z,y,et(u,!0,U.isLocked))}))}})}})(y,u,S,R.cell);let T=Yo(y),q=Al(y,x),Z={...q,colDelta:q.colDelta-T.length},U=Pl(y,Z,R),{cols:en,rows:ea}=qo(U),ec=Yo(U),ed=Al(x,y),eu={...ed,colDelta:ed.colDelta+ec.length},ef=E(x,u=>A(ec,(y,x)=>{let S=Wl(1,u,R,ei)[0];return Po(y,x,S)},u)),eg=Pl(ef,eu,R);return[...en,...ea.slice(0,u),...eg,...ea.slice(u,ea.length)]},Vl=(u,y,x,R,S)=>{let{rows:T,cols:q}=qo(u),Z=T.slice(0,y),U=T.slice(y);return[...q,...Z,Uo(T[x],u=>S(u,R),(u,x)=>y>0&&y<T.length&&R($o(T[y-1],x),$o(T[y],x))?Ho(T[y],x):et(S(u.element,R),!0,u.isLocked)),...U]},ql=(u,y,x,R,S)=>E(u,u=>{let T=y>0&&y<Vo(u)&&R($o(u,y-1),$o(u,y)),q=((u,y,x,R,S,T,q)=>{if("colgroup"!==x&&R)return Ho(u,y);{let y=Ho(u,S);return et(q(y.element,T),!0,!1)}})(u,y,u.section,T,x,R,S);return Po(u,y,q)}),Ul=(u,y,x,R)=>{var S;return void 0!==$o(u[y],x)&&y>0&&R($o(u[y-1],x),$o(u[y],x))||(S=u[y],x>0&&R($o(S,x-1),$o(S,x)))},Gl=(u,y,x,R)=>{let r=u=>("row"===u?Pt(y):jt(y))?`${u}group`:u;return u?tN(y)?r(x):null:R&&tN(y)?r("row"===x?"col":"row"):null},Kl=(u,y,x)=>et(x(u.element,y),!0,u.isLocked),Yl=(u,y,x,R,S,T,q)=>E(u,(u,Z)=>((u,U)=>{let en=u.cells,ea=E(en,(u,U)=>{if(O(y,y=>x(u.element,y.element))){let y=q(u,Z,U)?S(u,x,R):u;return T(y,Z,U).each(u=>{var x;x=y.element,G({scope:C.from(u)},(u,y)=>{u.fold(()=>{be(x,y)},u=>{fe(x.dom,y,u)})})}),y}return u});return tt(u.element,ea,u.section,u.isNew)})(u)),Jl=(u,y,x)=>j(u,(R,S)=>Ul(u,S,y,x)?[]:[Ho(R,y)]),Ql=(u,y,x,R,S)=>{let T=qo(u).rows,q=j(y,u=>Jl(T,u,R)),Z=E(T,u=>nl(u.cells)),U=P(Z,h)&&nl(q)?ei:(u,y,x)=>!("th"===ne(u.element)&&Z[y]);return Yl(u,q,R,S,Kl,(u,y)=>C.some(Gl(x,u.element,"row",Z[y])),U)},Xl=(u,y,x,R)=>{let S=qo(u).rows,T=E(y,u=>Ho(S[u.row],u.column));return Yl(u,T,x,R,Kl,C.none,ei)},Zl=u=>{if(!S(u))throw Error("cases must be an array");if(0===u.length)throw Error("there must be at least one case");let y=[],x={};return N(u,(R,T)=>{let q=ef(R);if(1!==q.length)throw Error("one and only one name per case");let Z=q[0],U=R[Z];if(void 0!==x[Z])throw Error("duplicate key detected:"+Z);if("cata"===Z)throw Error("cannot have a case named cata (sorry)");if(!S(U))throw Error("case arguments must be an array");y.push(Z),x[Z]=(...x)=>{let R=x.length;if(R!==U.length)throw Error("Wrong number of arguments to case "+Z+". Expected "+U.length+" ("+U+"), got "+R);return{fold:(...y)=>{if(y.length!==u.length)throw Error("Wrong number of arguments to fold. Expected "+u.length+", got "+y.length);return y[T].apply(null,x)},match:u=>{let R=ef(u);if(y.length!==R.length)throw Error("Wrong number of arguments to match. Expected: "+y.join(",")+"\nActual: "+R.join(","));if(!P(y,u=>D(R,u)))throw Error("Not all branches were specified when using match. Specified: "+R.join(", ")+"\nRequired: "+y.join(", "));return u[Z].apply(null,x)},log:u=>{console.log(u,{constructors:y,constructor:Z,params:x})}}}}),x},t_={...Zl([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}])},ta=(u,y,x)=>{let R=0;for(let S=u;S<y;S++)R+=void 0!==x[S]?x[S]:0;return R},oa=(u,y)=>{let x=rn(u);return E(x,u=>{let x=ta(u.row,u.row+u.rowspan,y);return{element:u.element,height:x,rowspan:u.rowspan}})},na=(u,y,x)=>{let R=ln(u)?((u,y)=>{let x=sn(u);return E(x,(u,x)=>({element:u.element,width:y[x],colspan:u.colspan}))})(u,y):((u,y)=>{let x=rn(u);return E(x,u=>{let x=ta(u.column,u.column+u.colspan,y);return{element:u.element,width:x,colspan:u.colspan}})})(u,y);N(R,u=>{x.setElementWidth(u.element,u.width)})},ra=(u,y,x,R,S)=>{let T=Zo(u),q=S.getCellDelta(y),Z=S.getWidths(T,S),U=x===T.grid.columns-1,en=R.clampTableDelta(Z,x,q,S.minCellWidth(),U),ea=((u,y,x,R,S)=>{let T=u.slice(0),q=0===u.length?t_.none():1===u.length?t_.only(0):0===y?t_.left(0,1):y===u.length-1?t_.right(y-1,y):y>0&&y<u.length-1?t_.middle(y-1,y,y+1):t_.none(),Z=g(E(T,g(0)));return q.fold(Z,u=>R.singleColumnWidth(T[u],x),(u,y)=>S.calcLeftEdgeDeltas(T,u,y,x,R.minCellWidth(),R.isRelative),(u,y,q)=>S.calcMiddleDeltas(T,u,y,q,x,R.minCellWidth(),R.isRelative),(u,y)=>S.calcRightEdgeDeltas(T,u,y,x,R.minCellWidth(),R.isRelative))})(Z,x,en,S,R),ei=E(ea,(u,y)=>u+Z[y]);na(T,ei,S),R.resizeTable(S.adjustTableWidth,en,U)},sa=u=>A(u,(u,y)=>O(u,u=>u.column===y.column)?u:u.concat([y]),[]).sort((u,y)=>u.column-y.column),tB=ue("col"),tz=ue("colgroup"),ca=u=>"tr"===ne(u)||tz(u),ia=u=>({element:u,colspan:Wt(u,"colspan",1),rowspan:Wt(u,"rowspan",1)}),ma=u=>we(u,"scope").map(u=>u.substr(0,3)),da=(u,y=ia)=>{let o=R=>{var S,T;if(ca(R))return tz((S={element:R}).element)?u.colgroup(S):u.row(S);{let S=tB((T=y(R)).element)?u.col(T):u.cell(T);return x=C.some({item:R,replacement:S}),S}},x=C.none();return{getOrInit:(u,y)=>x.fold(()=>o(u),x=>y(u,x.item)?x.replacement:o(u))}},ua=u=>y=>{let x=[],n=R=>{let S="td"===u?{scope:null}:{},T=y.replace(R,u,S);return x.push({item:R,sub:T}),T};return{replaceOrInit:(u,y)=>ca(u)||tB(u)?u:L(x,x=>y(x.item,u)).fold(()=>n(u),x=>y(u,x.item)?x.sub:n(u))}},fa=u=>({unmerge:y=>{let x=ma(y);return x.each(u=>ge(y,"scope",u)),()=>{let R=u.cell({element:y,colspan:1,rowspan:1});return Lt(R,"width"),Lt(y,"width"),x.each(u=>ge(R,"scope",u)),R}},merge:u=>(Lt(u[0],"width"),(()=>{let y=yt(E(u,ma));if(0===y.length)return C.none();{let u=y[0],x=["row","col"];return O(y,y=>y!==u&&D(x,y))?C.none():C.from(u)}})().fold(()=>be(u[0],"scope"),y=>ge(u[0],"scope",y+"group")),g(u[0]))}),tW=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],tI=hs(),pa=u=>((u,y)=>{let x=u.property().name(y);return D(tW,x)})(tI,u),wa=u=>((u,y)=>{let x=u.property().name(y);return D(["ol","ul"],x)})(tI,u),ba=u=>{let y=ue("br"),o=u=>Cr(u).bind(x=>{let R=Ae(x).map(u=>!!pa(u)||!!D(["br","img","hr","input"],tI.property().name(u))&&"img"!==ne(u)).getOr(!1);return Ne(x).map(S=>!0===R||"li"===ne(S)||ft(S,wa).isSome()||y(x)||pa(S)&&!Re(u,S)?[]:[ey.fromTag("br")])}).getOr([]),x=(()=>{let x=j(u,u=>{let x=Le(u);return P(x,u=>y(u)||ew(u)&&0===hr(u).trim().length)?[]:x.concat(o(u))});return 0===x.length?[ey.fromTag("br")]:x})();Ve(u[0]),$e(u[0],x)},va=u=>Qr(u,!0),ya=u=>{0===Ut(u).length&&qe(u)},xa=(u,y)=>({grid:u,cursor:y}),Ca=(u,y,x)=>{let R=((u,y,x)=>{var R,S;let T=qo(u).rows;return C.from(null===(S=null===(R=T[y])||void 0===R?void 0:R.cells[x])||void 0===S?void 0:S.element).filter(va).orThunk(()=>V(T,u=>V(u.cells,u=>{let y=u.element;return xt(va(y),y)})))})(u,y,x);return xa(u,R)},Sa=u=>A(u,(u,y)=>O(u,u=>u.row===y.row)?u:u.concat([y]),[]).sort((u,y)=>u.row-y.row),Ta=(u,y)=>(x,R,S,T,q)=>{let Z=Sa(R),U=E(Z,u=>u.row),en=((u,y,x,R,S,T,q)=>{let{cols:Z,rows:U}=qo(u),en=U[y[0]],ea=j(y,u=>((u,y,x)=>{let R=u[y];return j(R.cells,(R,S)=>Ul(u,y,S,x)?[]:[R])})(U,u,S)),ec=E(en.cells,(u,y)=>nl(Jl(U,y,S))),ed=[...U];N(y,u=>{ed[u]=q.transformRow(U[u],x)});let eu=[...Z,...ed],ef=P(ec,h)&&nl(en.cells)?ei:(u,y,x)=>!("th"===ne(u.element)&&ec[x]);return Yl(eu,ea,S,T,q.transformCell,(u,y,x)=>C.some(Gl(R,u.element,"col",ec[x])),ef)})(x,U,u,y,S,T.replaceOrInit,q);return Ca(en,R[0].row,R[0].column)},tA=Ta("thead",!0),tj=Ta("tbody",!1),tP=Ta("tfoot",!1),ka=(u,y,x)=>{var R;let S=(R=x.section,Qt(u,()=>R)),T=Xo(S);return xl(T,y,!0)},Ea=(u,y,x,R)=>((u,y,x,R)=>{let S=Xo(y),T=R.getWidths(S,R);na(S,T,R)})(0,y,0,R.sizing),Na=(u,y,x,R)=>((u,y,x,R,S)=>{let T=Xo(y),q=R.getWidths(T,R),Z=R.pixelWidth(),{newSizes:U,delta:en}=S.calcRedestributedWidths(q,Z,x.pixelDelta,R.isRelative);na(T,U,R),R.adjustTableWidth(en)})(0,y,x,R.sizing,R.resize),Ba=(u,y)=>O(y,u=>0===u.column&&u.isLocked),_a=(u,y)=>O(y,y=>y.column+y.colspan>=u.grid.columns&&y.isLocked),za=(u,y)=>{let x=cn(u),R=sa(y);return A(R,(u,y)=>u+x[y.column].map(Wo).getOr(0),0)},Aa=u=>(y,x)=>Ol(y,x).filter(x=>!(u?Ba:_a)(y,x)).map(u=>({details:u,pixelDelta:za(y,u)})),La=u=>(y,x)=>Dl(y,x).filter(x=>!(u?Ba:_a)(y,x.cells)),tM=ua("th"),t$=ua("td"),tH=Rl((u,y,x,R)=>{let S=y[0].row,T=Sa(y),q=z(T,(u,y)=>({grid:Vl(u.grid,S,y.row+u.delta,x,R.getOrInit),delta:u.delta+1}),{grid:u,delta:0}).grid;return Ca(q,S,y[0].column)},Ol,f,f,da),tq=Rl((u,y,x,R)=>{let S=Sa(y),T=S[S.length-1],q=T.row+T.rowspan,Z=z(S,(u,y)=>Vl(u,q,y.row,x,R.getOrInit),u);return Ca(Z,q,y[0].column)},Ol,f,f,da),tV=Rl((u,y,x,R)=>{let S=y.details,T=sa(S),q=T[0].column,Z=z(T,(u,y)=>({grid:ql(u.grid,q,y.column+u.delta,x,R.getOrInit),delta:u.delta+1}),{grid:u,delta:0}).grid;return Ca(Z,S[0].row,q)},Aa(!0),Na,f,da),tF=Rl((u,y,x,R)=>{let S=y.details,T=S[S.length-1],q=T.column+T.colspan,Z=sa(S),U=z(Z,(u,y)=>ql(u,q,y.column,x,R.getOrInit),u);return Ca(U,S[0].row,q)},Aa(!1),Na,f,da),tY=Rl((u,y,x,R)=>{var S;let T=sa(y.details),q=(S=E(T,u=>u.column),j(u,u=>{let y=u.cells,x=z(S,(u,y)=>y>=0&&y<u.length?u.slice(0,y).concat(u.slice(y+1)):u,y);return x.length>0?[tt(u.element,x,u.section,u.isNew)]:[]})),Z=q.length>0?q[0].cells.length-1:0;return Ca(q,T[0].row,Math.min(T[0].column,Z))},(u,y)=>kl(u,y).map(y=>({details:y,pixelDelta:-za(u,y)})),Na,ya,da),tK=Rl((u,y,x,R)=>{let S=Sa(y),T=((u,y,x)=>{let{rows:R,cols:S}=qo(u);return[...S,...R.slice(0,y),...R.slice(x+1)]})(u,S[0].row,S[S.length-1].row),q=T.length>0?T.length-1:0;return Ca(T,Math.min(y[0].row,q),y[0].column)},Ol,f,ya,da),tZ=Rl((u,y,x,R)=>{let S=sa(y),T=E(S,u=>u.column),q=Ql(u,T,!0,x,R.replaceOrInit);return Ca(q,y[0].row,y[0].column)},kl,f,f,tM),tG=Rl((u,y,x,R)=>{let S=sa(y),T=E(S,u=>u.column),q=Ql(u,T,!1,x,R.replaceOrInit);return Ca(q,y[0].row,y[0].column)},kl,f,f,t$),tJ=Rl(tA,kl,f,f,tM),tU=Rl(tj,kl,f,f,t$),tQ=Rl(tP,kl,f,f,t$),tX=Rl((u,y,x,R)=>{let S=Xl(u,y,x,R.replaceOrInit);return Ca(S,y[0].row,y[0].column)},kl,f,f,tM),t0=Rl((u,y,x,R)=>{let S=Xl(u,y,x,R.replaceOrInit);return Ca(S,y[0].row,y[0].column)},kl,f,f,t$),t1=Rl((u,y,x,R)=>{let S=y.cells;ba(S);let T=((u,y,x,R)=>{let S=qo(u).rows;if(0===S.length)return u;for(let u=y.startRow;u<=y.finishRow;u++)for(let x=y.startCol;x<=y.finishCol;x++){let y=S[u],T=Ho(y,x).isLocked;Io(y,x,et(R(),!1,T))}return u})(u,y.bounds,0,R.merge(S));return xa(T,C.from(S[0]))},(u,y)=>(0,y.mergable).filter(y=>El(u,y.cells)),Ea,f,fa),t9=Rl((u,y,x,R)=>{let S=z(y,(u,y)=>Nl(u,y,x,R.unmerge(y)),u);return xa(S,C.from(y[0]))},(u,y)=>(0,y.unmergable).filter(y=>El(u,y)),Ea,f,fa),t3=Rl((u,y,x,R)=>{let S=((u,y)=>{let x=Zo(u);return xl(x,y,!0)})(y.clipboard,y.generators);return((u,y,x,R,S)=>{let T=Yo(y),q=((u,y,x)=>{let R=Vo(y[0]),S=qo(y).cols.length+u.row,T=k(R-u.column,y=>y+u.column);return{row:S,column:L(T,u=>P(x,y=>y!==u)).getOr(R-1)}})(u,y,T),Z=qo(x).rows,U=Fl(q,Z,T),en=((u,y,x)=>{if(u.row>=y.length||u.column>Vo(y[0]))return tL.error("invalid start address out of table bounds, row: "+u.row+", column: "+u.column);let R=y.slice(u.row),S=R[0].cells.slice(u.column),T=Vo(x[0]),q=x.length;return tL.value({rowDelta:R.length-q,colDelta:S.length-T})})(q,y,Z);return en.map(u=>{let x={...u,colDelta:u.colDelta-U.length},T=Pl(y,x,R),en=Yo(T),ea=Fl(q,Z,en);return((u,y,x,R,S,T)=>{let q=u.row,Z=u.column,U=q+x.length,en=Z+Vo(x[0])+T.length,ea=I(T,ei);for(let u=q;u<U;u++){let T=0;for(let U=Z;U<en;U++){if(ea[U]){T++;continue}Il(y,u,U,S)&&Nl(y,$o(y[u],U),S,R.cell);let en=U-Z-T,ei=Ho(x[u-q],en),ec=ei.element,ed=R.replace(ec);Io(y[u],U,et(ed,!0,ei.isLocked))}}return y})(q,T,Z,R,S,ea)})})({row:y.row,column:y.column},u,S,y.generators,x).fold(()=>xa(u,C.some(y.element)),u=>Ca(u,y.row,y.column))},(u,y)=>qt(y.element).bind(x=>Sl(u,x).map(u=>({...u,generators:y.generators,clipboard:y.clipboard}))),Ea,f,da),t5=Rl((u,y,x,R)=>{let S=qo(u).rows,T=y.cells[0].column,q=S[y.cells[0].row],Z=ka(y.clipboard,y.generators,q),U=Hl(T,u,Z,y.generators,x);return Ca(U,y.cells[0].row,y.cells[0].column)},La(!0),f,f,da),t2=Rl((u,y,x,R)=>{let S=qo(u).rows,T=y.cells[y.cells.length-1].column+y.cells[y.cells.length-1].colspan,q=S[y.cells[0].row],Z=ka(y.clipboard,y.generators,q),U=Hl(T,u,Z,y.generators,x);return Ca(U,y.cells[0].row,y.cells[0].column)},La(!1),f,f,da),t7=Rl((u,y,x,R)=>{let S=qo(u).rows,T=y.cells[0].row,q=S[T],Z=ka(y.clipboard,y.generators,q),U=$l(T,u,Z,y.generators,x);return Ca(U,y.cells[0].row,y.cells[0].column)},Dl,f,f,da),t4=Rl((u,y,x,R)=>{let S=qo(u).rows,T=y.cells[y.cells.length-1].row+y.cells[y.cells.length-1].rowspan,q=S[y.cells[0].row],Z=ka(y.clipboard,y.generators,q),U=$l(T,u,Z,y.generators,x);return Ca(U,y.cells[0].row,y.cells[0].column)},Dl,f,f,da),rc=(u,y)=>{let x=Zo(u);return Ol(x,y).bind(u=>{let y=u[u.length-1],R=u[0].column,S=y.column+y.colspan,T=M(E(x.all,u=>_(u.cells,u=>u.column>=R&&u.column<S)));return ll(T)}).getOr("")},sc=(u,y)=>{let x=Zo(u);return Ol(x,y).bind(ll).getOr("")},lc=(u,y)=>{let x=Zo(u);return Ol(x,y).bind(u=>{let y=u[u.length-1],R=u[0].row,S=y.row+y.rowspan;return(u=>{let y=E(u,u=>sl(u).type),x=D(y,"header"),R=D(y,"footer");if(x||R){let u=D(y,"body");return!x||u||R?x||u||!R?C.none():C.some("footer"):C.some("header")}return C.some("body")})(x.all.slice(R,S))}).getOr("")},ac=(u,y)=>u.dispatch("NewRow",{node:y}),cc=(u,y)=>u.dispatch("NewCell",{node:y}),ic=(u,y,x)=>{u.dispatch("TableModified",{...x,table:y})},t6={structure:!1,style:!0},t8={structure:!0,style:!1},rt={structure:!0,style:!0},fc=(u,y)=>Hr(u)?cr(y):$r(u)?ir(y):mr(y),gc=(u,y,x)=>{let n=u=>"table"===ne(Zr(u)),R=Wr(u),S=Ir(u)?f:Gs,l=y=>{switch(tc(u)){case"section":return il();case"sectionCells":return ml();case"cells":return dl();default:return((u,y)=>{switch(V(Zo(u).all,u=>{let y=sl(u);return"header"===y.type?C.from(y.subType):C.none()}).getOr(y)){case"section":return il();case"sectionCells":return ml();case"cells":return dl()}})(y,"section")}},a=(S,T,q,Z)=>(U,en,ea=!1)=>{ts(U);let ei=ey.fromDom(u.getDoc()),ec=Br(q,ei,R),ed={sizing:fc(u,U),resize:Ir(u)?Zs():el(),section:l(U)};return T(U)?S(U,en,ec,ed).bind(R=>{y.refresh(U.dom),N(R.newRows,y=>{ac(u,y.dom)}),N(R.newCells,y=>{cc(u,y.dom)});let S=R.cursor.fold(()=>{let y=Ut(U);return H(y).filter(lt).map(y=>{x.clearSelectedCells(U.dom);let R=u.dom.createRng();return R.selectNode(y.dom),u.selection.setRng(R),ge(y,"data-mce-selected","1"),R})},y=>{let R=Vs(tE,y),S=u.dom.createRng();return S.setStart(R.element.dom,R.offset),S.setEnd(R.element.dom,R.offset),u.selection.setRng(S),x.clearSelectedCells(U.dom),C.some(S)});return lt(U)&&(ts(U),ea||ic(u,U.dom,Z)),S.map(u=>({rng:u,effect:Z}))}):C.none()},T=a(tK,y=>!n(u)||tl(y).rows>1,f,t8),q=a(tY,y=>!n(u)||tl(y).columns>1,f,t8);return{deleteRow:T,deleteColumn:q,insertRowsBefore:a(tH,ei,f,t8),insertRowsAfter:a(tq,ei,f,t8),insertColumnsBefore:a(tV,ei,S,t8),insertColumnsAfter:a(tF,ei,S,t8),mergeCells:a(t1,ei,f,t8),unmergeCells:a(t9,ei,f,t8),pasteColsBefore:a(t5,ei,f,t8),pasteColsAfter:a(t2,ei,f,t8),pasteRowsBefore:a(t7,ei,f,t8),pasteRowsAfter:a(t4,ei,f,t8),pasteCells:a(t3,ei,f,rt),makeCellsHeader:a(tX,ei,f,t8),unmakeCellsHeader:a(t0,ei,f,t8),makeColumnsHeader:a(tZ,ei,f,t8),unmakeColumnsHeader:a(tG,ei,f,t8),makeRowsHeader:a(tJ,ei,f,t8),makeRowsBody:a(tU,ei,f,t8),makeRowsFooter:a(tQ,ei,f,t8),getTableRowType:lc,getTableCellType:sc,getTableColType:rc}},hc=(u,y,x)=>{let R=Wt(u,y,1);1===x||R<=1?be(u,y):ge(u,y,Math.min(x,R))},pc=(u,y)=>x=>{let R=x.column+x.colspan-1,S=x.column;return R>=u&&S<y},ru=Zl([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),bc=(u,y,x)=>{let R=x.substring(0,x.length-u.length),S=parseFloat(R);return R===S.toString()?y(S):ru.invalid(x)},rf={...ru,from:u=>Rt(u,"%")?bc("%",ru.percent,u):Rt(u,"px")?bc("px",ru.pixels,u):ru.invalid(u)},yc=(u,y,x)=>{let R=rf.from(x),S=P(u,u=>"0px"===u)?((u,y)=>{let x=u.fold(()=>g(""),u=>g(u/y+"px"),()=>g(100/y+"%"));return k(y,x)})(R,u.length):R.fold(()=>u,x=>((u,y,x)=>{let R=x/y;return E(u,u=>rf.from(u).fold(()=>u,u=>u*R+"px",u=>u/100*x+"px"))})(u,y,x),x=>E(u,u=>rf.from(u).fold(()=>u,u=>u/y*100+"%",u=>u+"%")));return Sc(S)},xc=(u,y)=>0===u.length?y:z(u,(u,y)=>rf.from(y).fold(g(0),h,h)+u,0),Cc=(u,y)=>rf.from(u).fold(g(u),u=>u+y+"px",u=>u+y+"%"),Sc=u=>{if(0===u.length)return u;let y=z(u,(u,y)=>{let x=rf.from(y).fold(()=>({value:y,remainder:0}),u=>((u,y)=>{let x=Math.floor(u);return{value:x+"px",remainder:u-x}})(u),u=>({value:u+"%",remainder:0}));return{output:[x.value].concat(u.output),remainder:u.remainder+x.remainder}},{output:[],remainder:0}),x=y.output;return x.slice(0,x.length-1).concat([Cc(x[x.length-1],Math.round(y.remainder))])},rg=rf.from,Rc=u=>rg(u).fold(g("px"),g("px"),g("%")),Dc=(u,y,x)=>{let R=Zo(u),S=R.all,T=rn(R),q=sn(R);y.each(y=>{let x=Rc(y),S=Lo(u),Z=nr(R,u,er,rr),U=yc(Z,S,y);ln(R)?N(q,(u,y)=>{let R=xc([U[y]],eE());Nt(u.element,"width",R+x)}):N(T,u=>{let y=U.slice(u.column,u.colspan+u.column),R=xc(y,eE());Nt(u.element,"width",R+x)}),Nt(u,"width",y)}),x.each(y=>{var x;let q=Rc(y),Z=hn(u),U=lr(R,u,eU,tr,rr);x=yc(U,Z,y),N(T,u=>{let y=x.slice(u.row,u.rowspan+u.row),R=xc(y,ek());Nt(u.element,"height",R+q)}),N(S,(u,y)=>{Nt(u.element,"height",x[y])}),Nt(u,"height",y)})},Oc=u=>Un(u).exists(u=>e9.test(u)),kc=u=>Un(u).exists(u=>e3.test(u)),Ec=u=>Un(u).isNone(),Nc=u=>{be(u,"width")},Bc=u=>{let y=Qn(u);Dc(u,C.some(y),C.none()),Nc(u)},_c=u=>{let y=Lo(u)+"px";Dc(u,C.some(y),C.none()),Nc(u)},zc=u=>{Lt(u,"width");let y=Gt(u),x=y.length>0?y:Ut(u);N(x,u=>{Lt(u,"width"),Nc(u)}),Nc(u)},rh={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},Lc=(u,y,x,R)=>k(u,u=>((u,y,x,R)=>{let S=ey.fromTag("tr");for(let T=0;T<u;T++){let u=ey.fromTag(R<y||T<x?"th":"td");T<x&&ge(u,"scope","row"),R<y&&ge(u,"scope","col"),Ie(u,ey.fromTag("br")),Ie(S,u)}return S})(y,x,R,u)),Wc=(u,y)=>{u.selection.select(y.dom,!0),u.selection.collapse(!0)},Mc=(u,y,R,S,T)=>{let q=(u=>{let y=u.options,x=y.get("table_default_styles");return y.isSet("table_default_styles")?x:Vr(u)||!tg(u)?x:$r(u)?{...x,width:Lr(u)}:{...x,width:te}})(u),Z={styles:q,attributes:Kr(u),colGroups:tp(u)};return u.undoManager.ignore(()=>{let x=((u,y,x,R,S,T=rh)=>{let q=ey.fromTag("table"),Z="cells"!==S;Bt(q,T.styles),he(q,T.attributes),T.colGroups&&Ie(q,(u=>{let y=ey.fromTag("colgroup");return k(u,()=>Ie(y,ey.fromTag("col"))),y})(y));let U=Math.min(u,x);if(Z&&x>0){let u=ey.fromTag("thead");Ie(q,u);let T=Lc(x,y,"sectionCells"===S?U:0,R);$e(u,T)}let en=ey.fromTag("tbody");Ie(q,en);let ea=Lc(Z?u-U:u,y,Z?0:x,R);return $e(en,ea),q})(R,y,T,S,tc(u),Z);ge(x,"data-mce-id","__mce");let q=(u=>{let y=ey.fromTag("div"),x=ey.fromDom(u.dom.cloneNode(!0));return Ie(y,x),y.dom.innerHTML})(x);u.insertContent(q),u.addVisual()}),wt(Zr(u),'table[data-mce-id="__mce"]').map(y=>{var R;return $r(u)?_c(y):Vr(u)?zc(y):(Hr(u)||x(R=q.width)&&-1!==R.indexOf("%"))&&Bc(y),ts(y),be(y,"data-mce-id"),N(dt(y,"tr"),y=>{ac(u,y.dom),N(dt(y,"th,td"),y=>{cc(u,y.dom)})}),((u,y)=>{wt(y,"td,th").each(w(Wc,u))})(u,y),y.dom}).getOrNull()};var rp=tinymce.util.Tools.resolve("tinymce.FakeClipboard");let rb="x-tinymce/dom-table-",rw=rb+"rows",rC=rb+"columns",Hc=u=>{let y=rp.FakeClipboardItem(u);rp.write([y])},$c=u=>{var y;let x=null!==(y=rp.read())&&void 0!==y?y:[];return V(x,y=>C.from(y.getType(u)))},Vc=u=>{$c(u).isSome()&&rp.clear()},qc=u=>{u.fold(Gc,u=>Hc({[rw]:u}))},Uc=()=>$c(rw),Gc=()=>Vc(rw),Kc=u=>{u.fold(Jc,u=>Hc({[rC]:u}))},Yc=()=>$c(rC),Jc=()=>Vc(rC),Qc=u=>tD(os(u),es(u)).filter(ss),Xc=(u,y)=>{let S=es(u),n=u=>Kt(u,S),l=y=>tT(os(u),es(u)).filter(ss).bind(u=>n(u).map(x=>y(x,u))),a=y=>{u.focus()},c=(y,x=!1)=>l((R,S)=>{let T=Ls(Ps(u),R,S);y(R,T,x).each(a)}),i=()=>l((y,x)=>((u,y,x)=>{let R=Zo(u);return Ol(R,y).bind(u=>{let y=xl(R,x,!1),S=qo(y).rows.slice(u[0].row,u[u.length-1].row+u[u.length-1].rowspan),T=j(S,u=>{let y=_(u.cells,u=>!u.isLocked);return y.length>0?[{...u,cells:y}]:[]}),q=Cl(T);return xt(q.length>0,q)}).map(u=>E(u,u=>{let y=Ke(u.element);return N(u.cells,u=>{let x=Ye(u.element);pl(x,"colspan",u.colspan,1),pl(x,"rowspan",u.rowspan,1),Ie(y,x)}),y}))})(y,Ls(Ps(u),y,x),Br(f,ey.fromDom(u.getDoc()),C.none()))),m=()=>l((y,x)=>((u,y)=>{let x=Zo(u);return kl(x,y).map(u=>{let y=u[u.length-1],R=u[0].column,S=y.column+y.colspan,T=((u,y,x)=>{if(ln(u)){let R=_(sn(u),pc(y,x)),S=E(R,u=>{let R=Ye(u.element);return hc(R,"span",x-y),R}),T=ey.fromTag("colgroup");return $e(T,S),[T]}return[]})(x,R,S),q=E(x.all,u=>{let y=_(u.cells,pc(R,S)),x=E(y,u=>{let y=Ye(u.element);return hc(y,"colspan",S-R),y}),T=ey.fromTag("tr");return $e(T,x),T});return[...T,...q]})})(y,Ls(Ps(u),y,x))),d=(y,x)=>x().each(x=>{let R=E(x,u=>Ye(u));l((x,S)=>{let T=_r(ey.fromDom(u.getDoc())),q={selection:h(Ps(u)),clipboard:R,generators:T};y(x,q).each(a)})}),g=u=>(y,x)=>{var R;return(X(x,R="type")?C.from(x[R]):C.none()).each(y=>{c(u(y),x.no_events)})};G({mceTableSplitCells:()=>c(y.unmergeCells),mceTableMergeCells:()=>c(y.mergeCells),mceTableInsertRowBefore:()=>c(y.insertRowsBefore),mceTableInsertRowAfter:()=>c(y.insertRowsAfter),mceTableInsertColBefore:()=>c(y.insertColumnsBefore),mceTableInsertColAfter:()=>c(y.insertColumnsAfter),mceTableDeleteCol:()=>c(y.deleteColumn),mceTableDeleteRow:()=>c(y.deleteRow),mceTableCutCol:()=>m().each(u=>{Kc(u),c(y.deleteColumn)}),mceTableCutRow:()=>i().each(u=>{qc(u),c(y.deleteRow)}),mceTableCopyCol:()=>m().each(u=>Kc(u)),mceTableCopyRow:()=>i().each(u=>qc(u)),mceTablePasteColBefore:()=>d(y.pasteColsBefore,Yc),mceTablePasteColAfter:()=>d(y.pasteColsAfter,Yc),mceTablePasteRowBefore:()=>d(y.pasteRowsBefore,Uc),mceTablePasteRowAfter:()=>d(y.pasteRowsAfter,Uc),mceTableDelete:()=>Qc(u).each(y=>{Kt(y,S).filter(b(S)).each(y=>{let x=ey.fromText("");if(je(y,x),qe(y),u.dom.isEmpty(u.getBody()))u.setContent(""),u.selection.setCursorLocation();else{let y=u.dom.createRng();y.setStart(x.dom,0),y.setEnd(x.dom,0),u.selection.setRng(y),u.nodeChanged()}})}),mceTableCellToggleClass:(y,x)=>{l(y=>{let R=Ps(u),S=P(R,y=>u.formatter.match("tablecellclass",{value:x},y.dom)),T=S?u.formatter.remove:u.formatter.apply;N(R,u=>T("tablecellclass",{value:x},u.dom)),ic(u,y.dom,t6)})},mceTableToggleClass:(y,x)=>{l(y=>{u.formatter.toggle("tableclass",{value:x},y.dom),ic(u,y.dom,t6)})},mceTableToggleCaption:()=>{Qc(u).each(y=>{Kt(y,S).each(x=>{pt(x,"caption").fold(()=>{let y=ey.fromTag("caption");Ie(y,ey.fromText("Caption")),((u,y,x)=>{We(u,0).fold(()=>{Ie(u,y)},u=>{Me(u,y)})})(x,y),u.selection.setCursorLocation(y.dom,0)},R=>{ue("caption")(y)&&Te("td",x).each(y=>u.selection.setCursorLocation(y.dom,0)),qe(R)}),ic(u,x.dom,t8)})})},mceTableSizingMode:(y,x)=>Qc(u).each(y=>{Vr(u)||$r(u)||Hr(u)||Kt(y,S).each(y=>{"relative"!==x||Oc(y)?"fixed"!==x||kc(y)?"responsive"!==x||Ec(y)||zc(y):_c(y):Bc(y),ts(y),ic(u,y.dom,t8)})}),mceTableCellType:g(u=>"th"===u?y.makeCellsHeader:y.unmakeCellsHeader),mceTableColType:g(u=>"th"===u?y.makeColumnsHeader:y.unmakeColumnsHeader),mceTableRowType:g(u=>{switch(u){case"header":return y.makeRowsHeader;case"footer":return y.makeRowsFooter;default:return y.makeRowsBody}})},(y,x)=>u.addCommand(x,y)),u.addCommand("mceInsertTable",(y,x)=>{((u,y,x,R={})=>{let r=u=>en(u)&&u>0;if(r(y)&&r(x)){let S=R.headerRows||0,T=R.headerColumns||0;return Mc(u,x,y,T,S)}console.error("Invalid values for mceInsertTable - rows and columns values are required to insert a table.")})(u,x.rows,x.columns,x.options)}),u.addCommand("mceTableApplyCellStyle",(y,S)=>{let l=u=>"tablecell"+u.toLowerCase().replace("-","");if(!R(S))return;let T=_(Ps(u),ss);if(0===T.length)return;let q=((u,y)=>{var x;let R={};return x=(u,y)=>{R[y]=u},G(u,(u,R)=>{(y(u,R)?x:f)(u,R)}),R})(S,(y,R)=>u.formatter.has(l(R))&&x(y));(u=>{for(let y in u)if(eg.call(u,y))return!1;return!0})(q)||(G(q,(y,x)=>{let R=l(x);N(T,x=>{""===y?u.formatter.remove(R,{value:null},x.dom,!0):u.formatter.apply(R,{value:y},x.dom)})}),n(T[0]).each(y=>ic(u,y.dom,t6)))})},rv=Zl([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),ry={before:rv.before,on:rv.on,after:rv.after,cata:(u,y,x,R)=>u.fold(y,x,R),getStart:u=>u.fold(h,h,h)},ti=(u,y)=>({selection:u,kill:y}),oi=(u,y)=>{let x=u.document.createRange();return x.selectNode(y.dom),x},ni=(u,y)=>{let x=u.document.createRange();return ri(x,y),x},ri=(u,y)=>u.selectNodeContents(y.dom),si=(u,y,x)=>{let R=u.document.createRange();return y.fold(u=>{R.setStartBefore(u.dom)},(u,y)=>{R.setStart(u.dom,y)},u=>{R.setStartAfter(u.dom)}),((u,y)=>{y.fold(y=>{u.setEndBefore(y.dom)},(y,x)=>{u.setEnd(y.dom,x)},y=>{u.setEndAfter(y.dom)})})(R,x),R},li=(u,y,x,R,S)=>{let T=u.document.createRange();return T.setStart(y.dom,x),T.setEnd(R.dom,S),T},ai=u=>({left:u.left,top:u.top,right:u.right,bottom:u.bottom,width:u.width,height:u.height}),rx=Zl([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),ii=(u,y,x)=>y(ey.fromDom(x.startContainer),x.startOffset,ey.fromDom(x.endContainer),x.endOffset),mi=(u,y)=>{let x=y.match({domRange:u=>({ltr:g(u),rtl:C.none}),relative:(y,x)=>({ltr:eo(()=>si(u,y,x)),rtl:eo(()=>C.some(si(u,x,y)))}),exact:(y,x,R,S)=>({ltr:eo(()=>li(u,y,x,R,S)),rtl:eo(()=>C.some(li(u,R,S,y,x)))})});return((u,y)=>{let x=y.ltr();return x.collapsed?y.rtl().filter(u=>!1===u.collapsed).map(u=>rx.rtl(ey.fromDom(u.endContainer),u.endOffset,ey.fromDom(u.startContainer),u.startOffset)).getOrThunk(()=>ii(0,rx.ltr,x)):ii(0,rx.ltr,x)})(0,x)},di=(u,y)=>mi(u,y).match({ltr:(y,x,R,S)=>{let T=u.document.createRange();return T.setStart(y.dom,x),T.setEnd(R.dom,S),T},rtl:(y,x,R,S)=>{let T=u.document.createRange();return T.setStart(R.dom,S),T.setEnd(y.dom,x),T}});rx.ltr,rx.rtl;let ui=(u,y,x,R)=>({start:u,soffset:y,finish:x,foffset:R}),fi=(u,y,x,R)=>({start:ry.on(u,y),finish:ry.on(x,R)}),gi=(u,y)=>{let x=di(u,y);return ui(ey.fromDom(x.startContainer),x.startOffset,ey.fromDom(x.endContainer),x.endOffset)},pi=(u,y,x,R,S)=>Re(x,R)?C.none():xs(x,R,y).bind(y=>{let R=y.boxes.getOr([]);return R.length>1?(S(u,R,y.start,y.finish),C.some(ti(C.some(fi(x,0,x,br(x))),!0))):C.none()}),wi=(u,y)=>({item:u,mode:y}),bi=(u,y,x,R=vi)=>u.property().parent(y).map(u=>wi(u,R)),vi=(u,y,x,R=yi)=>x.sibling(u,y).map(u=>wi(u,R)),yi=(u,y,x,R=yi)=>{let S=u.property().children(y);return x.first(S).map(u=>wi(u,R))},rR=[{current:bi,next:vi,fallback:C.none()},{current:vi,next:yi,fallback:C.some(bi)},{current:yi,next:yi,fallback:C.some(vi)}],Ci=(u,y,x,R,S=rR)=>L(S,u=>u.current===x).bind(x=>x.current(u,y,R,x.next).orThunk(()=>x.fallback.bind(x=>Ci(u,y,x,R)))),Si=(u,y,x,R,S,T)=>Ci(u,y,R,S).bind(y=>T(y.item)?C.none():x(y.item)?C.some(y.item):Si(u,y.item,x,y.mode,S,T)),Ti=u=>y=>0===u.property().children(y).length,Ri=(u,y,x,R)=>Si(u,y,x,vi,{sibling:(u,y)=>u.query().prevSibling(y),first:u=>u.length>0?C.some(u[u.length-1]):C.none()},R),Di=(u,y,x,R)=>Si(u,y,x,vi,{sibling:(u,y)=>u.query().nextSibling(y),first:u=>u.length>0?C.some(u[0]):C.none()},R),rS=hs(),ki=(u,y)=>Ri(rS,u,Ti(rS),y),Ei=(u,y)=>Di(rS,u,Ti(rS),y),rD=Zl([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Bi=u=>bt(u,"tr"),rT={...rD,verify:(u,y,x,R,S,T,q)=>bt(R,"td,th",q).bind(x=>bt(y,"td,th",q).map(y=>Re(x,y)?Re(R,x)&&br(x)===S?T(y):rD.none("in same cell"):vs(Bi,[x,y]).fold(()=>((u,y,x)=>{let R=u.getRect(y),S=u.getRect(x);return S.right>R.left&&S.left<R.right})(u,y,x)?rD.success():T(y),u=>T(y)))).getOr(rD.none("default")),cata:(u,y,x,R,S)=>u.fold(y,x,R,S)},rE=ue("br"),Ai=(u,y,x)=>y(u,x).bind(u=>ew(u)&&0===hr(u).trim().length?Ai(u,y,x):C.some(u)),Li=(u,y,x,R)=>We(y,x).filter(rE).orThunk(()=>We(y,x-1).filter(rE)).bind(y=>R.traverse(y).fold(()=>Ai(y,R.gather,u).map(R.relative),u=>Ne(u).bind(y=>{let x=Le(y);return W(x,w(Re,u)).map(R=>({parent:y,children:x,element:u,index:R}))}).map(u=>ry.on(u.parent,u.index)))),Wi=(u,y)=>({left:u.left,top:u.top+y,right:u.right,bottom:u.bottom+y}),Mi=(u,y)=>({left:u.left,top:u.top-y,right:u.right,bottom:u.bottom-y}),ji=(u,y,x)=>({left:u.left+y,top:u.top+x,right:u.right+y,bottom:u.bottom+x}),Pi=u=>({left:u.left,top:u.top,right:u.right,bottom:u.bottom}),Ii=(u,y)=>C.some(u.getRect(y)),Fi=(u,y,x)=>eb(y)?Ii(u,y).map(Pi):ew(y)?(x>=0&&x<br(y)?u.getRangedRect(y,x,y,x+1):x>0?u.getRangedRect(y,x-1,y,x):C.none()).map(Pi):C.none(),Hi=(u,y)=>eb(y)?Ii(u,y).map(Pi):ew(y)?u.getRangedRect(y,0,y,br(y)).map(Pi):C.none(),rk=Zl([{none:[]},{retry:["caret"]}]),Vi=(u,y,x)=>gt(y,pa).fold(ea,y=>Hi(u,y).exists(u=>x.left<u.left||1>Math.abs(u.right-x.left)||x.left>u.right)),Ui=(u,y,x,R,S)=>{var T,q,Z;return 0===S?C.some(R):(T=R.left,q=y.point(R),u.elementFromPoint(T,q).filter(u=>"table"===ne(u)).isSome())?(Z=S-1,Ui(u,y,x,y.move(R,5),Z)):u.situsFromPoint(R.left,y.point(R)).bind(T=>T.start.fold(C.none,T=>Hi(u,T).bind(q=>y.adjuster(u,T,q,x,R).fold(C.none,R=>Ui(u,y,x,R,S-1))).orThunk(()=>C.some(R)),C.none))},Gi=(u,y,x)=>{let R=u.move(x,5),S=Ui(y,u,x,R,100).getOr(R);return(u.point(S)>y.getInnerHeight()?C.some(u.point(S)-y.getInnerHeight()):0>u.point(S)?C.some(-u.point(S)):C.none()).fold(()=>y.situsFromPoint(S.left,u.point(S)),x=>(y.scrollBy(0,x),y.situsFromPoint(S.left,u.point(S)-x)))},rO={tryUp:w(Gi,{point:u=>u.top,adjuster:(u,y,x,R,S)=>{let T=Mi(S,5);return 1>Math.abs(x.top-R.top)||x.bottom<S.top?rk.retry(T):x.bottom===S.top?rk.retry(Mi(S,1)):Vi(u,y,S)?rk.retry(ji(T,5,0)):rk.none()},move:Mi,gather:ki}),tryDown:w(Gi,{point:u=>u.bottom,adjuster:(u,y,x,R,S)=>{let T=Wi(S,5);return 1>Math.abs(x.bottom-R.bottom)||x.top>S.bottom?rk.retry(T):x.top===S.bottom?rk.retry(Wi(S,1)):Vi(u,y,S)?rk.retry(ji(T,5,0)):rk.none()},move:Wi,gather:Ei}),getJumpSize:g(5)},Yi=(u,y,x)=>u.getSelection().bind(R=>((u,y,x,R)=>{let S=rE(y)?R.traverse(y).orThunk(()=>Ai(y,R.gather,u)).map(R.relative):Li(u,y,x,R);return S.map(u=>({start:u,finish:u}))})(y,R.finish,R.foffset,x).fold(()=>C.some(Fs(R.finish,R.foffset)),S=>{var T;let q=u.fromSitus(S);return T=rT.verify(u,R.finish,R.foffset,q.finish,q.foffset,x.failure,y),rT.cata(T,u=>C.none(),()=>C.none(),u=>C.some(Fs(u,0)),u=>C.some(Fs(u,br(u))))})),Ji=(u,y,x,R,S,T)=>0===T?C.none():Zi(u,y,x,R,S).bind(q=>{let Z=u.fromSitus(q),U=rT.verify(u,x,R,Z.finish,Z.foffset,S.failure,y);return rT.cata(U,()=>C.none(),()=>C.some(q),q=>Re(x,q)&&0===R?Qi(u,x,R,Mi,S):Ji(u,y,q,0,S,T-1),q=>Re(x,q)&&R===br(q)?Qi(u,x,R,Wi,S):Ji(u,y,q,br(q),S,T-1))}),Qi=(u,y,x,R,S)=>Fi(u,y,x).bind(y=>Xi(u,S,R(y,rO.getJumpSize()))),Xi=(u,y,x)=>{let R=Bo().browser;return R.isChromium()||R.isSafari()||R.isFirefox()?y.retry(u,x):C.none()},Zi=(u,y,x,R,S)=>Fi(u,x,R).bind(y=>Xi(u,S,y)),em=(u,y,x,R,S)=>bt(R,"td,th",y).bind(R=>bt(R,"table",y).bind(T=>ft(S,u=>Ne(u).exists(u=>Re(u,T)),void 0).isSome()?Yi(u,y,x).bind(R=>Ji(u,y,R.element,R.offset,x,20).map(u.fromSitus)).bind(u=>bt(u.finish,"td,th",y).map(y=>({start:R,finish:y,range:u}))):C.none())),tm=(u,y,x,R,S,T)=>T(R,y).orThunk(()=>em(u,y,x,R,S).map(u=>{let y=u.range;return ti(C.some(fi(y.start,y.soffset,y.finish,y.foffset)),!0)})),om=(u,y)=>bt(u,"tr",y).bind(u=>bt(u,"table",y).bind(x=>{let R=dt(x,"tr");return Re(u,R[0])?Ri(rS,x,u=>Cr(u).isSome(),y).map(u=>{let y=br(u);return ti(C.some(fi(u,y,u,y)),!0)}):C.none()})),nm=(u,y)=>bt(u,"tr",y).bind(u=>bt(u,"table",y).bind(x=>{let R=dt(x,"tr");return Re(u,R[R.length-1])?Di(rS,x,u=>xr(u).isSome(),y).map(u=>ti(C.some(fi(u,0,u,0)),!0)):C.none()})),rm=(u,y,x,R,S,T,q)=>em(u,x,R,S,T).bind(u=>pi(y,x,u.start,u.finish,q)),sm=u=>{let y=u;return{get:()=>y,set:u=>{y=u}}},lm=()=>{let u=(u=>{let y=sm(C.none()),o=()=>y.get().each(u);return{clear:()=>{o(),y.set(C.none())},isSet:()=>y.get().isSome(),get:()=>y.get(),set:u=>{o(),y.set(C.some(u))}}})(f);return{...u,on:y=>u.get().each(y)}},am=(u,y)=>bt(u,"td,th",y),cm=u=>Be(u).exists(Qr),rN={traverse:Ae,gather:Ei,relative:ry.before,retry:rO.tryDown,failure:rT.failedDown},rL={traverse:ze,gather:ki,relative:ry.before,retry:rO.tryUp,failure:rT.failedUp},dm=u=>y=>y===u,r_=dm(38),rB=dm(40),gm=u=>u>=37&&u<=40,rz={isBackward:dm(37),isForward:dm(39)},rW={isBackward:dm(39),isForward:dm(37)},rI=Zl([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),rA={domRange:rI.domRange,relative:rI.relative,exact:rI.exact,exactFromRange:u=>rI.exact(u.start,u.soffset,u.finish,u.foffset),getWin:u=>{let y=u.match({domRange:u=>ey.fromDom(u.startContainer),relative:(u,y)=>ry.getStart(u),exact:(u,y,x,R)=>u});return ey.fromDom(Ee(y).dom.defaultView)},range:ui},rj=document.caretPositionFromPoint?(u,y,x)=>{var R,S;return C.from(null===(S=(R=u.dom).caretPositionFromPoint)||void 0===S?void 0:S.call(R,y,x)).bind(y=>{if(null===y.offsetNode)return C.none();let x=u.dom.createRange();return x.setStart(y.offsetNode,y.offset),x.collapse(),C.some(x)})}:document.caretRangeFromPoint?(u,y,x)=>{var R,S;return C.from(null===(S=(R=u.dom).caretRangeFromPoint)||void 0===S?void 0:S.call(R,y,x))}:C.none,ym=(u,y)=>{let x=ne(u);return"input"===x?ry.after(u):D(["br","img"],x)?0===y?ry.before(u):ry.after(u):ry.on(u,y)},xm=u=>C.from(u.getSelection()),Cm=(u,y)=>{xm(u).each(u=>{u.removeAllRanges(),u.addRange(y)})},Sm=(u,y,x,R,S)=>{let T=li(u,y,x,R,S);Cm(u,T)},Tm=(u,y)=>mi(u,y).match({ltr:(y,x,R,S)=>{Sm(u,y,x,R,S)},rtl:(y,x,R,S)=>{xm(u).each(T=>{if(T.setBaseAndExtent)T.setBaseAndExtent(y.dom,x,R.dom,S);else if(T.extend)try{T.collapse(y.dom,x),T.extend(R.dom,S)}catch(T){Sm(u,R,S,y,x)}else Sm(u,R,S,y,x)})}}),Rm=(u,y,x,R,S)=>{let T=((u,y,x,R)=>{let S=ym(u,y),T=ym(x,R);return rA.relative(S,T)})(y,x,R,S);Tm(u,T)},Dm=(u,y,x)=>{let R=((u,y)=>{let x=u.fold(ry.before,ym,ry.after),R=y.fold(ry.before,ym,ry.after);return rA.relative(x,R)})(y,x);Tm(u,R)},Om=u=>{if(u.rangeCount>0){let y=u.getRangeAt(0),x=u.getRangeAt(u.rangeCount-1);return C.some(ui(ey.fromDom(y.startContainer),y.startOffset,ey.fromDom(x.endContainer),x.endOffset))}return C.none()},km=u=>{if(null===u.anchorNode||null===u.focusNode)return Om(u);{let y=ey.fromDom(u.anchorNode),x=ey.fromDom(u.focusNode);return((u,y,x,R)=>{let S=((u,y,x,R)=>{let S=ke(u).dom.createRange();return S.setStart(u.dom,y),S.setEnd(x.dom,R),S})(u,y,x,R),T=Re(u,x)&&y===R;return S.collapsed&&!T})(y,u.anchorOffset,x,u.focusOffset)?C.some(ui(y,u.anchorOffset,x,u.focusOffset)):Om(u)}},Em=(u,y,x=!0)=>{let R=(x?ni:oi)(u,y);Cm(u,R)},Nm=u=>xm(u).filter(u=>u.rangeCount>0).bind(km).map(u=>rA.exact(u.start,u.soffset,u.finish,u.foffset)),Bm=u=>({elementFromPoint:(y,x)=>ey.fromPoint(ey.fromDom(u.document),y,x),getRect:u=>u.dom.getBoundingClientRect(),getRangedRect:(y,x,R,S)=>{let T=rA.exact(y,x,R,S);return(u=>{let y=u.getClientRects(),x=y.length>0?y[0]:u.getBoundingClientRect();return x.width>0||x.height>0?C.some(x).map(ai):C.none()})(di(u,T))},getSelection:()=>Nm(u).map(y=>gi(u,y)),fromSitus:y=>{let x=rA.relative(y.start,y.finish);return gi(u,x)},situsFromPoint:(y,x)=>((u,y,x)=>{let R=ey.fromDom(u.document);return rj(R,y,x).map(u=>ui(ey.fromDom(u.startContainer),u.startOffset,ey.fromDom(u.endContainer),u.endOffset))})(u,y,x).map(u=>fi(u.start,u.soffset,u.finish,u.foffset)),clearSelection:()=>{(u=>{xm(u).each(u=>u.removeAllRanges())})(u)},collapseSelection:(y=!1)=>{Nm(u).each(x=>x.fold(u=>u.collapse(y),(x,R)=>{let S=y?x:R;Dm(u,S,S)},(x,R,S,T)=>{let q=y?x:S,Z=y?R:T;Rm(u,q,Z,q,Z)}))},setSelection:y=>{Rm(u,y.start,y.soffset,y.finish,y.foffset)},setRelativeSelection:(y,x)=>{Dm(u,y,x)},selectNode:y=>{Em(u,y,!1)},selectContents:y=>{Em(u,y)},getInnerHeight:()=>u.innerHeight,getScrollY:()=>(u=>{let y=void 0!==u?u.dom:document,x=y.body.scrollLeft||y.documentElement.scrollLeft,R=y.body.scrollTop||y.documentElement.scrollTop;return wn(x,R)})(ey.fromDom(u.document)).top,scrollBy:(y,x)=>{((u,y,x)=>{let R=(void 0!==x?x.dom:document).defaultView;R&&R.scrollBy(u,y)})(y,x,ey.fromDom(u.document))}}),_m=(u,y)=>({rows:u,cols:y}),zm=u=>gt(u,ae).exists(Qr),Am=(u,y)=>zm(u)||zm(y),Lm=u=>void 0!==u.dom.classList,Wm=(u,y)=>((u,y,x)=>{let R=((u,y)=>{let x=pe(u,y);return void 0===x||""===x?[]:x.split(" ")})(u,y).concat([x]);return ge(u,y,R.join(" ")),!0})(u,"class",y),Mm=(u,y)=>{Lm(u)?u.dom.classList.add(y):Wm(u,y)},jm=(u,y)=>Lm(u)&&u.dom.classList.contains(y),Pm=()=>({tag:"none"}),Im=u=>({tag:"multiple",elements:u}),Fm=u=>({tag:"single",element:u}),Hm=u=>{let y=ey.fromDom((u=>{if(eS()&&m(u.target)){let y=ey.fromDom(u.target);if(eb(y)&&m(y.dom.shadowRoot)&&u.composed&&u.composedPath){let y=u.composedPath();if(y)return H(y)}}return C.from(u.target)})(u).getOr(u.target)),o=()=>u.stopPropagation(),n=()=>u.preventDefault();return{target:y,x:u.clientX,y:u.clientY,stop:o,prevent:n,kill:(...u)=>n(o.apply(null,u)),raw:u}},$m=(u,y,x,R)=>{u.dom.removeEventListener(y,x,R)},qm=(u,y,x)=>((u,y,x,R,S)=>{let s=u=>{x(u)&&R(Hm(u))};return u.dom.addEventListener(y,s,S),{unbind:w($m,u,y,s,S)}})(u,y,ei,x,!1),Gm=u=>!jm(ey.fromDom(u.target),"ephox-snooker-resizer-bar"),Km=(u,y)=>{var x;let R=(x=tS.selectedSelector,{get:()=>Rs(ey.fromDom(u.getBody()),x).fold(()=>tT(os(u),es(u)).fold(Pm,Fm),Im)}),S=((u,y,x)=>{let n=y=>{be(y,u.selected),be(y,u.firstSelected),be(y,u.lastSelected)},r=y=>{ge(y,u.selected,"1")},s=u=>{l(u),x()},l=y=>{let x=dt(y,`${u.selectedSelector},${u.firstSelectedSelector},${u.lastSelectedSelector}`);N(x,n)};return{clearBeforeUpdate:l,clear:s,selectRange:(x,R,S,T)=>{s(x),N(R,r),ge(S,u.firstSelected,"1"),ge(T,u.lastSelected,"1"),y(R,S,T)},selectedSelector:u.selectedSelector,firstSelectedSelector:u.firstSelectedSelector,lastSelectedSelector:u.lastSelectedSelector}})(tS,(y,x,R)=>{Kt(x).each(S=>{let T=Wr(u),q=Br(f,ey.fromDom(u.getDoc()),T),Z=((u,y,x)=>{let R=Zo(u);return Ol(R,y).map(u=>{let y=xl(R,x,!1),{rows:S}=qo(y),T=((u,y)=>{let x=u.slice(0,y[y.length-1].row+1),R=Cl(x);return j(R,u=>{let x=u.cells.slice(0,y[y.length-1].column+1);return E(x,u=>u.element)})})(S,u),q=((u,y)=>{let x=u.slice(y[0].row+y[0].rowspan-1,u.length),R=Cl(x);return j(R,u=>{let x=u.cells.slice(y[0].column+y[0].colspan-1,u.cells.length);return E(x,u=>u.element)})})(S,u);return{upOrLeftCells:T,downOrRightCells:q}})})(S,{selection:Ps(u)},q);((u,y,x,R,S)=>{u.dispatch("TableSelectionChange",{cells:y,start:x,finish:R,otherCells:S})})(u,y,x,R,Z)})},()=>(u=>{u.dispatch("TableSelectionClear")})(u));return u.on("init",x=>{let R=u.getWin(),T=Zr(u),q=es(u),Z=((u,y,x,R)=>{let S=((u,y,x,R)=>{let S=lm(),T=S.clear,l=T=>{S.on(S=>{R.clearBeforeUpdate(y),am(T.target,x).each(q=>{xs(S,q,x).each(x=>{let S=x.boxes.getOr([]);if(1===S.length){let x=S[0],q="false"===Xr(x),Z=vt(Jr(T.target),x,Re);q&&Z&&(R.selectRange(y,S,x,x),u.selectContents(x))}else S.length>1&&(R.selectRange(y,S,x.start,x.finish),u.selectContents(q))})})})};return{clearstate:T,mousedown:u=>{R.clear(y),am(u.target,x).filter(cm).each(S.set)},mouseover:u=>{l(u)},mouseup:u=>{l(u),T()}}})(Bm(u),y,x,R);return{clearstate:S.clearstate,mousedown:S.mousedown,mouseover:S.mouseover,mouseup:S.mouseup}})(R,T,q,S),U=((u,y,x,R)=>{let S=Bm(u),s=()=>(R.clear(y),C.none());return{keydown:(u,T,q,Z,U,en)=>{let ea=u.raw,ei=ea.which,ec=!0===ea.shiftKey,ed=Cs(y,R.selectedSelector).fold(()=>(gm(ei)&&!ec&&R.clearBeforeUpdate(y),gm(ei)&&ec&&!Am(T,Z)?C.none:rB(ei)&&ec?w(rm,S,y,x,rN,Z,T,R.selectRange):r_(ei)&&ec?w(rm,S,y,x,rL,Z,T,R.selectRange):rB(ei)?w(tm,S,x,rN,Z,T,nm):r_(ei)?w(tm,S,x,rL,Z,T,om):C.none),u=>{let o=x=>()=>{let T=V(x,x=>Ts(u,x.rows,x.cols,R.firstSelectedSelector,R.lastSelectedSelector).map(u=>(R.clearBeforeUpdate(y),R.selectRange(y,u.boxes,u.start,u.finish),u.boxes)));return T.fold(()=>Ss(y,R.firstSelectedSelector,R.lastSelectedSelector).map(u=>{let x=rB(ei)||en.isForward(ei)?ry.after:ry.before;return S.setRelativeSelection(ry.on(u.first,0),x(u.table)),R.clear(y),ti(C.none(),!0)}),u=>C.some(ti(C.none(),!0)))};return gm(ei)&&ec&&!Am(T,Z)?C.none:rB(ei)&&ec?o([_m(1,0)]):r_(ei)&&ec?o([_m(-1,0)]):en.isBackward(ei)&&ec?o([_m(0,-1),_m(-1,0)]):en.isForward(ei)&&ec?o([_m(0,1),_m(1,0)]):gm(ei)&&!ec?s:C.none});return ed()},keyup:(u,S,T,q,Z)=>Cs(y,R.selectedSelector).fold(()=>{var U;let en=u.raw,ea=en.which;return!0===en.shiftKey&&gm(ea)&&Am(S,q)?(U=R.selectRange,Re(S,q)&&T===Z?C.none():bt(S,"td,th",x).bind(u=>bt(q,"td,th",x).bind(R=>pi(y,x,u,R,U)))):C.none()},C.none)}})(R,T,q,S),en=((u,y,x,R)=>{let S=Bm(u);return(u,T)=>{R.clearBeforeUpdate(y),xs(u,T,x).each(u=>{let x=u.boxes.getOr([]);R.selectRange(y,x,u.start,u.finish),S.selectContents(T),S.collapseSelection()})}})(R,T,q,S);u.on("TableSelectorChange",u=>en(u.start,u.finish));let m=(y,x)=>{!0===y.raw.shiftKey&&(x.kill&&y.kill(),x.selection.each(y=>{let x=rA.relative(y.start,y.finish),S=di(R,x);u.selection.setRng(S)}))},d=u=>0===u.button,ea=(()=>{let u=sm(ey.fromDom(T)),y=sm(0);return{touchEnd:x=>{let R=ey.fromDom(x.target);if(ue("td")(R)||ue("th")(R)){let S=u.get(),T=y.get();Re(S,R)&&x.timeStamp-T<300&&(x.preventDefault(),en(R,R))}u.set(R),y.set(x.timeStamp)}}})();u.on("dragstart",u=>{Z.clearstate()}),u.on("mousedown",u=>{d(u)&&Gm(u)&&Z.mousedown(Hm(u))}),u.on("mouseover",u=>{(void 0===u.buttons||0!=(1&u.buttons))&&Gm(u)&&Z.mouseover(Hm(u))}),u.on("mouseup",u=>{d(u)&&Gm(u)&&Z.mouseup(Hm(u))}),u.on("touchend",ea.touchEnd),u.on("keyup",y=>{let x=Hm(y);if(x.raw.shiftKey&&gm(x.raw.which)){let y=u.selection.getRng(),R=ey.fromDom(y.startContainer),S=ey.fromDom(y.endContainer);U.keyup(x,R,y.startOffset,S,y.endOffset).each(u=>{m(x,u)})}}),u.on("keydown",x=>{let R=Hm(x);y.hide();let S=u.selection.getRng(),T=ey.fromDom(S.startContainer),q=ey.fromDom(S.endContainer),Z=un(rz,rW)(ey.fromDom(u.selection.getStart()));U.keydown(R,T,S.startOffset,q,S.endOffset,Z).each(u=>{m(R,u)}),y.show()}),u.on("NodeChange",()=>{let y=u.selection,x=ey.fromDom(y.getStart()),R=ey.fromDom(y.getEnd());vs(Kt,[x,R]).fold(()=>S.clear(T),f)})}),u.on("PreInit",()=>{u.serializer.addTempAttr(tS.firstSelected),u.serializer.addTempAttr(tS.lastSelected)}),{getSelectedCells:()=>((u,y,x,R)=>{switch(u.tag){case"none":return y();case"single":return[u.element.dom];case"multiple":return E(u.elements,u=>u.dom)}})(R.get(),g([])),clearSelectedCells:u=>S.clear(ey.fromDom(u))}},Ym=u=>{let y=[];return{bind:u=>{if(void 0===u)throw Error("Event bind error: undefined handler");y.push(u)},unbind:u=>{y=_(y,y=>y!==u)},trigger:(...x)=>{let R={};N(u,(u,y)=>{R[u]=x[y]}),N(y,u=>{u(R)})}}},Jm=u=>({registry:K(u,u=>({bind:u.bind,unbind:u.unbind})),trigger:K(u,u=>u.trigger)}),Qm=u=>u.slice(0).sort(),Xm=(u,y)=>{let x=_(y,y=>!D(u,y));x.length>0&&(u=>{throw Error("Unsupported keys for object: "+Qm(u).join(", "))})(x)},Zm=u=>((u,y,R)=>{if(0===y.length)throw Error("You must specify at least one required field.");return((u,y)=>{if(!S(y))throw Error("The "+u+" fields must be an array. Was: "+y+".");N(y,y=>{if(!x(y))throw Error("The value "+y+" in the "+u+" fields was not a string.")})})("required",y),(u=>{let y=Qm(u);L(y,(u,x)=>x<y.length-1&&u===y[x+1]).each(u=>{throw Error("The field: "+u+" occurs more than once in the combined fields: ["+y.join(", ")+"].")})})(y),x=>{let S=ef(x);P(y,u=>D(S,u))||((u,y)=>{throw Error("All required keys ("+Qm(u).join(", ")+") were not specified. Specified keys were: "+Qm(y).join(", ")+".")})(y,S),u(y,S);let T=_(y,u=>!R.validate(x[u],u));return T.length>0&&((u,y)=>{throw Error("All values need to be of type: "+y+". Keys ("+Qm(u).join(", ")+") were not.")})(T,R.label),x}})(Xm,u,{validate:U,label:"function"}),rP=Zm(["compare","extract","mutate","sink"]),rM=Zm(["element","start","stop","destroy"]),r$=Zm(["forceDrop","drop","move","delayDrop"]),nd=()=>{let u=(()=>{let u=Jm({move:Ym(["info"])});return{onEvent:f,reset:f,events:u.registry}})(),y=(()=>{let u=C.none(),y=Jm({move:Ym(["info"])});return{onEvent:(x,R)=>{R.extract(x).each(x=>{let S=((y,x)=>{let R=u.map(u=>y.compare(u,x));return u=C.some(x),R})(R,x);S.each(u=>{y.trigger.move(u)})})},reset:()=>{u=C.none()},events:y.registry}})(),x=u;return{on:()=>{x.reset(),x=y},off:()=>{x.reset(),x=u},isOn:()=>x===y,onEvent:(u,y)=>{x.onEvent(u,y)},events:y.events}},rd=u=>{let y=u.replace(/\./g,"-");return{resolve:u=>y+"-"+u}},rH=rd("ephox-dragster").resolve;var rq=rP({compare:(u,y)=>wn(y.left-u.left,y.top-u.top),extract:u=>C.some(wn(u.x,u.y)),sink:(u,y)=>{let x=(u=>{let y={layerClass:rH("blocker"),...u},x=ey.fromTag("div");return ge(x,"role","presentation"),Bt(x,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Mm(x,rH("blocker")),Mm(x,y.layerClass),{element:g(x),destroy:()=>{qe(x)}}})(y),R=qm(x.element(),"mousedown",u.forceDrop),S=qm(x.element(),"mouseup",u.drop),T=qm(x.element(),"mousemove",u.move),q=qm(x.element(),"mouseout",u.delayDrop);return rM({element:x.element,start:u=>{Ie(u,x.element())},stop:()=>{qe(x.element())},destroy:()=>{x.destroy(),S.unbind(),T.unbind(),q.unbind(),R.unbind()}})},mutate:(u,y)=>{u.mutate(y.left,y.top)}});let rV=rd("ephox-snooker").resolve,rF=rV("resizer-bar"),rY=rV("resizer-rows"),rK=rV("resizer-cols"),dd=u=>{let y=dt(u.parent(),"."+rF);N(y,qe)},ud=(u,y,x)=>{let R=u.origin();N(y,y=>{y.each(y=>{let S=x(R,y);Mm(S,rF),Ie(u.parent(),S)})})},fd=(u,y,x,R,S)=>{var T,q,Z,U;let en=yn(x),ea=y.isResizable,ei=R.length>0?eU.positions(R,x):[],ec=ei.length>0?j(u.all,(u,y)=>ea(u.element)?[y]:[]):[];T=_(ei,(u,y)=>O(ec,u=>y===u)),q=Wo(x),ud(y,T,(u,y)=>{let x=((u,y,x,R,S)=>{let T=ey.fromTag("div");return Bt(T,{position:"absolute",left:y+"px",top:x-3.5+"px",height:"7px",width:R+"px"}),he(T,{"data-row":u,role:"presentation"}),T})(y.row,en.left-u.left,y.y-u.top,q);return Mm(x,rY),x});let ed=S.length>0?eX.positions(S,x):[],eu=ed.length>0?((u,y)=>{let x=[];return k(u.grid.columns,R=>{an(u,R).map(u=>u.element).forall(y)&&x.push(R)}),_(x,x=>{let R=Qo(u,u=>u.column===x);return P(R,u=>y(u.element))})})(u,ea):[];Z=_(ed,(u,y)=>O(eu,u=>y===u)),U=pn(x),ud(y,Z,(u,y)=>{let x=((u,y,x,R,S)=>{let T=ey.fromTag("div");return Bt(T,{position:"absolute",left:y-3.5+"px",top:x+"px",height:S+"px",width:"7px"}),he(T,{"data-column":u,role:"presentation"}),T})(y.col,y.x-u.left,en.top-u.top,0,U);return Mm(x,rK),x})},gd=(u,y)=>{if(dd(u),u.isResizable(y)){let x=Zo(y),R=dn(x),S=cn(x);fd(x,u,y,R,S)}},hd=(u,y)=>{let x=dt(u.parent(),"."+rF);N(x,y)},pd=u=>{hd(u,u=>{Nt(u,"display","none")})},wd=u=>{hd(u,u=>{Nt(u,"display","block")})},rZ=rV("resizer-bar-dragging"),vd=u=>{let y=(()=>{let u=Jm({drag:Ym(["xDelta","yDelta","target"])}),y=C.none(),x=(()=>{let u=Jm({drag:Ym(["xDelta","yDelta"])});return{mutate:(y,x)=>{u.trigger.drag(y,x)},events:u.registry}})();return x.events.drag.bind(x=>{y.each(y=>{u.trigger.drag(x.xDelta,x.yDelta,y)})}),{assign:u=>{y=C.some(u)},get:()=>y,mutate:x.mutate,events:u.registry}})(),x=((u,y={})=>{var x;return((u,y,x)=>{let R=!1,S=Jm({start:Ym([]),stop:Ym([])}),q=nd(),l=()=>{U.stop(),q.isOn()&&(q.off(),S.trigger.stop())},Z=((u,y)=>{let x=null,n=()=>{T(x)||(clearTimeout(x),x=null)};return{cancel:n,throttle:(...y)=>{n(),x=setTimeout(()=>{x=null,u.apply(null,y)},200)}}})(l);q.events.move.bind(x=>{y.mutate(u,x.info)});let i=u=>(...y)=>{R&&u.apply(null,y)},U=y.sink(r$({forceDrop:l,drop:i(l),move:i(u=>{Z.cancel(),q.onEvent(u,y)}),delayDrop:i(Z.throttle)}),x);return{element:U.element,go:u=>{U.start(u),q.on(),S.trigger.start()},on:()=>{R=!0},off:()=>{R=!1},isActive:()=>R,destroy:()=>{U.destroy()},events:S.registry}})(u,null!==(x=y.mode)&&void 0!==x?x:rq,y)})(y,{}),R=C.none(),r=(u,y)=>C.from(pe(u,y));y.events.drag.bind(u=>{r(u.target,"data-row").each(y=>{let x=It(u.target,"top");Nt(u.target,"top",x+u.yDelta+"px")}),r(u.target,"data-column").each(y=>{let x=It(u.target,"left");Nt(u.target,"left",x+u.xDelta+"px")})});let s=(u,y)=>It(u,y)-Wt(u,"data-initial-"+y,0);x.events.stop.bind(()=>{y.get().each(y=>{R.each(x=>{r(y,"data-row").each(u=>{let R=s(y,"top");be(y,"data-initial-top"),Z.trigger.adjustHeight(x,R,parseInt(u,10))}),r(y,"data-column").each(u=>{let R=s(y,"left");be(y,"data-initial-left"),Z.trigger.adjustWidth(x,R,parseInt(u,10))}),gd(u,x)})})});let l=(R,S)=>{Z.trigger.startAdjust(),y.assign(R),ge(R,"data-initial-"+S,It(R,S)),Mm(R,rZ),Nt(R,"opacity","0.2"),x.go(u.parent())},S=qm(u.parent(),"mousedown",u=>{jm(u.target,rY)&&l(u.target,"top"),jm(u.target,rK)&&l(u.target,"left")}),i=y=>Re(y,u.view()),q=qm(u.view(),"mouseover",y=>{bt(y.target,"table",i).filter(Qr).fold(()=>{lt(y.target)&&dd(u)},y=>{x.isActive()&&(R=C.some(y),gd(u,y))})}),Z=Jm({adjustHeight:Ym(["table","delta","row"]),adjustWidth:Ym(["table","delta","column"]),startAdjust:Ym([])});return{destroy:()=>{S.unbind(),q.unbind(),x.destroy(),dd(u)},refresh:y=>{gd(u,y)},on:x.on,off:x.off,hideBars:w(pd,u),showBars:w(wd,u),events:Z.registry}},yd=(u,y,x)=>{let R=vd(u),S=Jm({beforeResize:Ym(["table","type"]),afterResize:Ym(["table","type"]),startDrag:Ym([])});return R.events.adjustHeight.bind(u=>{let y=u.table;S.trigger.beforeResize(y,"row"),((u,y,x,R)=>{let S=Zo(u),T=lr(S,u,R,Yn,u=>u.getOrThunk(ek)),q=E(T,(u,R)=>x===R?Math.max(y+u,ek()):u),Z=oa(S,q),U=E(S.all,(u,y)=>({element:u.element,height:q[y]}));N(U,u=>{$n(u.element,u.height)}),N(Z,u=>{$n(u.element,u.height)});let en=z(q,(u,y)=>u+y,0);$n(u,en)})(y,eU.delta(u.delta,y),u.row,eU),S.trigger.afterResize(y,"row")}),R.events.startAdjust.bind(u=>{S.trigger.startDrag()}),R.events.adjustWidth.bind(u=>{let R=u.table;S.trigger.beforeResize(R,"col");let T=eX.delta(u.delta,R),q=x(R);ra(R,T,u.column,y,q),S.trigger.afterResize(R,"col")}),{on:R.on,off:R.off,refreshBars:R.refresh,hideBars:R.hideBars,showBars:R.showBars,destroy:R.destroy,events:S.registry}},xd=u=>m(u)&&"TABLE"===u.nodeName,rG="bar-",Sd=u=>"false"!==pe(u,"data-mce-resize"),Td=u=>{let y,x;let R=lm(),S=lm(),T=lm(),l=y=>fc(u,y),a=()=>Pr(u)?el():Zs();return u.on("init",()=>{var y;let x=u.inline?(y=ey.fromDom(u.getBody()),{parent:g((()=>{let u=ey.fromTag("div");return Bt(u,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Ie(at(ey.fromDom(document)),u),u})()),view:g(y),origin:g(wn(0,0)),isResizable:Sd}):((u,y)=>{let x=eC(u)?ey.fromDom(Ee(u).dom.documentElement):u;return{parent:g(x),view:g(u),origin:g(wn(0,0)),isResizable:y}})(ey.fromDom(u.getDoc()),Sd);if(T.set(x),(u=>{let y=u.options.get("object_resizing");return D(y.split(","),"table")})(u)&&tf(u)){let y=a(),T=yd(x,y,l);T.on(),T.events.startDrag.bind(y=>{R.set(u.selection.getRng())}),T.events.beforeResize.bind(y=>{let x=y.table.dom;((u,y,x,R,S)=>{u.dispatch("ObjectResizeStart",{target:y,width:x,height:R,origin:S})})(u,x,ns(x),rs(x),rG+y.type)}),T.events.afterResize.bind(y=>{let x=y.table,S=x.dom;ts(x),R.on(y=>{u.selection.setRng(y),u.focus()}),((u,y,x,R,S)=>{u.dispatch("ObjectResized",{target:y,width:x,height:R,origin:S})})(u,S,ns(S),rs(S),rG+y.type),u.undoManager.add()}),S.set(T)}}),u.on("ObjectResizeStart",R=>{let S=R.target;if(xd(S)){let T=ey.fromDom(S);N(u.dom.select(".mce-clonedresizable"),y=>{u.dom.addClass(y,"mce-"+td(u)+"-columns")}),!kc(T)&&$r(u)?_c(T):!Oc(T)&&Hr(u)&&Bc(T),Ec(T)&&Tt(R.origin,rG)&&Bc(T),y=R.width,x=Vr(u)?"":((u,y)=>{let x=u.dom.getStyle(y,"width")||u.dom.getAttrib(y,"width");return C.from(x).filter(Ot)})(u,S).getOr("")}}),u.on("ObjectResized",R=>{let S=R.target;if(xd(S)){let T=ey.fromDom(S),q=R.origin;Tt(q,"corner-")&&((R,S,T)=>{var q,Z;let U=Rt(S,"e");if(""===x&&Bc(R),T!==y&&""!==x){Nt(R,"width",x);let S=a(),q=l(R),Z=Pr(u)||U?tl(R).columns-1:0;ra(R,T-y,Z,S,q)}else if(q=x,/^(\d+(\.\d+)?)%$/.test(q)){let u=parseFloat(x.replace("%",""));Nt(R,"width",T*u/y+"%")}Z=x,/^(\d+(\.\d+)?)px$/.test(Z)&&(u=>{let y=Zo(u);ln(y)||N(Ut(u),u=>{let y=_t(u,"width");Nt(u,"width",y),be(u,"width")})})(R)})(T,q,R.width),ts(T),ic(u,T.dom,t6)}}),u.on("SwitchMode",()=>{S.on(y=>{u.mode.isReadOnly()?y.hideBars():y.showBars()})}),u.on("dragstart dragend",u=>{S.on(y=>{"dragstart"===u.type?(y.hideBars(),y.off()):(y.on(),y.showBars())})}),u.on("remove",()=>{S.on(u=>{u.destroy()}),T.on(y=>{u.inline&&qe(y.parent())})}),{refresh:u=>{S.on(y=>y.refreshBars(ey.fromDom(u)))},hide:()=>{S.on(u=>u.hideBars())},show:()=>{S.on(u=>u.showBars())}}},Rd=u=>{(u=>{let y=u.options.register;y("table_clone_elements",{processor:"string[]"}),y("table_use_colgroups",{processor:"boolean",default:!0}),y("table_header_type",{processor:u=>{let y=D(["section","cells","sectionCells","auto"],u);return y?{value:u,valid:y}:{valid:!1,message:"Must be one of: section, cells, sectionCells or auto."}},default:"section"}),y("table_sizing_mode",{processor:"string",default:"auto"}),y("table_default_attributes",{processor:"object",default:{border:"1"}}),y("table_default_styles",{processor:"object",default:{"border-collapse":"collapse"}}),y("table_column_resizing",{processor:u=>{let y=D(["preservetable","resizetable"],u);return y?{value:u,valid:y}:{valid:!1,message:"Must be preservetable, or resizetable."}},default:"preservetable"}),y("table_resize_bars",{processor:"boolean",default:!0}),y("table_style_by_css",{processor:"boolean",default:!0}),y("table_merge_content_on_paste",{processor:"boolean",default:!0})})(u);let y=Td(u),x=Km(u,y),R=gc(u,y,x);return Xc(u,R),((u,y)=>{let x=es(u),n=y=>tT(os(u)).bind(R=>Kt(R,x).map(x=>{let S=Ls(Ps(u),x,R);return y(x,S)})).getOr("");G({mceTableRowType:()=>n(y.getTableRowType),mceTableCellType:()=>n(y.getTableCellType),mceTableColType:()=>n(y.getTableColType)},(y,x)=>u.addQueryValueHandler(x,y))})(u,R),Is(u,R),{getSelectedCells:x.getSelectedCells,clearSelectedCells:x.clearSelectedCells}};y.add("dom",u=>({table:Rd(u)}))}();