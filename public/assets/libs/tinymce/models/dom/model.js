!function(){"use strict";var e,t=tinymce.util.Tools.resolve("tinymce.ModelManager");let hasProto=(e,t,o)=>{var l;return!!o(e,t.prototype)||(null===(l=e.constructor)||void 0===l?void 0:l.name)===t.name},typeOf=e=>{let t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&hasProto(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},isType$1=e=>t=>typeOf(t)===e,isSimpleType=e=>t=>typeof t===e,eq$2=e=>t=>e===t,o=isType$1("string"),l=isType$1("object"),n=isType$1("array"),a=eq$2(null),i=isSimpleType("boolean"),s=eq$2(void 0),isNullable=e=>null==e,isNonNullable=e=>!isNullable(e),c=isSimpleType("function"),d=isSimpleType("number"),noop=()=>{},compose=(e,t)=>(...o)=>e(t.apply(null,o)),compose1=(e,t)=>o=>e(t(o)),constant=e=>()=>e,identity=e=>e,tripleEquals=(e,t)=>e===t;function curry(e,...t){return(...o)=>{let l=t.concat(o);return e.apply(null,l)}}let not=e=>t=>!e(t),die=e=>()=>{throw Error(e)},apply=e=>e(),m=constant(!1),u=constant(!0);let Optional=class Optional{constructor(e,t){this.tag=e,this.value=t}static some(e){return new Optional(!0,e)}static none(){return Optional.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?Optional.some(e(this.value)):Optional.none()}bind(e){return this.tag?e(this.value):Optional.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:Optional.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return isNonNullable(e)?Optional.some(e):Optional.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}};Optional.singletonNone=new Optional(!1);let p=Array.prototype.slice,g=Array.prototype.indexOf,f=Array.prototype.push,rawIndexOf=(e,t)=>g.call(e,t),contains$2=(e,t)=>rawIndexOf(e,t)>-1,exists=(e,t)=>{for(let o=0,l=e.length;o<l;o++){let l=e[o];if(t(l,o))return!0}return!1},range$1=(e,t)=>{let o=[];for(let l=0;l<e;l++)o.push(t(l));return o},map$1=(e,t)=>{let o=e.length,l=Array(o);for(let n=0;n<o;n++){let o=e[n];l[n]=t(o,n)}return l},each$2=(e,t)=>{for(let o=0,l=e.length;o<l;o++){let l=e[o];t(l,o)}},eachr=(e,t)=>{for(let o=e.length-1;o>=0;o--){let l=e[o];t(l,o)}},partition=(e,t)=>{let o=[],l=[];for(let n=0,a=e.length;n<a;n++){let a=e[n],i=t(a,n)?o:l;i.push(a)}return{pass:o,fail:l}},filter$2=(e,t)=>{let o=[];for(let l=0,n=e.length;l<n;l++){let n=e[l];t(n,l)&&o.push(n)}return o},foldr=(e,t,o)=>(eachr(e,(e,l)=>{o=t(o,e,l)}),o),foldl=(e,t,o)=>(each$2(e,(e,l)=>{o=t(o,e,l)}),o),findUntil=(e,t,o)=>{for(let l=0,n=e.length;l<n;l++){let n=e[l];if(t(n,l))return Optional.some(n);if(o(n,l))break}return Optional.none()},find$1=(e,t)=>findUntil(e,t,m),findIndex=(e,t)=>{for(let o=0,l=e.length;o<l;o++){let l=e[o];if(t(l,o))return Optional.some(o)}return Optional.none()},flatten=e=>{let t=[];for(let o=0,l=e.length;o<l;++o){if(!n(e[o]))throw Error("Arr.flatten item "+o+" was not an array, input: "+e);f.apply(t,e[o])}return t},bind$2=(e,t)=>flatten(map$1(e,t)),forall=(e,t)=>{for(let o=0,l=e.length;o<l;++o){let l=e[o];if(!0!==t(l,o))return!1}return!0},reverse=e=>{let t=p.call(e,0);return t.reverse(),t},mapToObject=(e,t)=>{let o={};for(let l=0,n=e.length;l<n;l++){let n=e[l];o[String(n)]=t(n,l)}return o},sort$1=(e,t)=>{let o=p.call(e,0);return o.sort(t),o},get$d=(e,t)=>t>=0&&t<e.length?Optional.some(e[t]):Optional.none(),head=e=>get$d(e,0),last$2=e=>get$d(e,e.length-1),findMap=(e,t)=>{for(let o=0;o<e.length;o++){let l=t(e[o],o);if(l.isSome())return l}return Optional.none()},h=Object.keys,b=Object.hasOwnProperty,each$1=(e,t)=>{let o=h(e);for(let l=0,n=o.length;l<n;l++){let n=o[l],a=e[n];t(a,n)}},map=(e,t)=>tupleMap(e,(e,o)=>({k:o,v:t(e,o)})),tupleMap=(e,t)=>{let o={};return each$1(e,(e,l)=>{let n=t(e,l);o[n.k]=n.v}),o},objAcc=e=>(t,o)=>{e[o]=t},internalFilter=(e,t,o,l)=>{each$1(e,(e,n)=>{(t(e,n)?o:l)(e,n)})},filter$1=(e,t)=>{let o={};return internalFilter(e,t,objAcc(o),noop),o},mapToArray=(e,t)=>{let o=[];return each$1(e,(e,l)=>{o.push(t(e,l))}),o},values=e=>mapToArray(e,identity),get$c=(e,t)=>has$1(e,t)?Optional.from(e[t]):Optional.none(),has$1=(e,t)=>b.call(e,t),hasNonNullableKey=(e,t)=>has$1(e,t)&&void 0!==e[t]&&null!==e[t],isEmpty=e=>{for(let t in e)if(b.call(e,t))return!1;return!0},$="undefined"!=typeof window?window:Function("return this;")(),path=(e,t)=>{let o=null!=t?t:$;for(let t=0;t<e.length&&null!=o;++t)o=o[e[t]];return o},resolve$2=(e,t)=>{let o=e.split(".");return path(o,t)},unsafe=(e,t)=>resolve$2(e,t),getOrDie=(e,t)=>{let o=unsafe(e,t);if(null==o)throw Error(e+" not available on this browser");return o},w=Object.getPrototypeOf,sandHTMLElement=e=>getOrDie("HTMLElement",e),isPrototypeOf=e=>{let t=resolve$2("ownerDocument.defaultView",e);return l(e)&&(sandHTMLElement(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(w(e).constructor.name))},name=e=>{let t=e.dom.nodeName;return t.toLowerCase()},type=e=>e.dom.nodeType,isType=e=>t=>type(t)===e,isComment=e=>8===type(e)||"#comment"===name(e),isHTMLElement=e=>C(e)&&isPrototypeOf(e.dom),C=isType(1),v=isType(3),y=isType(9),S=isType(11),isTag=e=>t=>C(t)&&name(t)===e,rawSet=(e,t,l)=>{if(o(l)||i(l)||d(l))e.setAttribute(t,l+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",l,":: Element ",e),Error("Attribute value was not simple")},set$2=(e,t,o)=>{rawSet(e.dom,t,o)},setAll$1=(e,t)=>{let o=e.dom;each$1(t,(e,t)=>{rawSet(o,t,e)})},setOptions=(e,t)=>{each$1(t,(t,o)=>{t.fold(()=>{remove$7(e,o)},t=>{rawSet(e.dom,o,t)})})},get$b=(e,t)=>{let o=e.dom.getAttribute(t);return null===o?void 0:o},getOpt=(e,t)=>Optional.from(get$b(e,t)),remove$7=(e,t)=>{e.dom.removeAttribute(t)},clone$2=e=>foldl(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),fromDom$1=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},O={fromHtml:(e,t)=>{let o=t||document,l=o.createElement("div");if(l.innerHTML=e,!l.hasChildNodes()||l.childNodes.length>1){let t="HTML does not have a single root node";throw console.error(t,e),Error(t)}return fromDom$1(l.childNodes[0])},fromTag:(e,t)=>{let o=t||document,l=o.createElement(e);return fromDom$1(l)},fromText:(e,t)=>{let o=t||document,l=o.createTextNode(e);return fromDom$1(l)},fromDom:fromDom$1,fromPoint:(e,t,o)=>Optional.from(e.dom.elementFromPoint(t,o)).map(fromDom$1)},is$2=(e,t)=>{let o=e.dom;if(1!==o.nodeType)return!1;if(void 0!==o.matches)return o.matches(t);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(t);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(t);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(t);throw Error("Browser lacks native selectors")},bypassSelector=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,all$1=(e,t)=>{let o=void 0===t?document:t.dom;return bypassSelector(o)?[]:map$1(o.querySelectorAll(e),O.fromDom)},one=(e,t)=>{let o=void 0===t?document:t.dom;return bypassSelector(o)?Optional.none():Optional.from(o.querySelector(e)).map(O.fromDom)},eq$1=(e,t)=>e.dom===t.dom,contains$1=(e,t)=>{let o=e.dom,l=t.dom;return o!==l&&o.contains(l)},owner=e=>O.fromDom(e.dom.ownerDocument),documentOrOwner=e=>y(e)?e:owner(e),documentElement=e=>O.fromDom(documentOrOwner(e).dom.documentElement),defaultView=e=>O.fromDom(documentOrOwner(e).dom.defaultView),parent=e=>Optional.from(e.dom.parentNode).map(O.fromDom),parentElement=e=>Optional.from(e.dom.parentElement).map(O.fromDom),parents=(e,t)=>{let o=c(t)?t:m,l=e.dom,n=[];for(;null!==l.parentNode&&void 0!==l.parentNode;){let e=l.parentNode,t=O.fromDom(e);if(n.push(t),!0===o(t))break;l=e}return n},prevSibling=e=>Optional.from(e.dom.previousSibling).map(O.fromDom),nextSibling=e=>Optional.from(e.dom.nextSibling).map(O.fromDom),children$2=e=>map$1(e.dom.childNodes,O.fromDom),child$2=(e,t)=>{let o=e.dom.childNodes;return Optional.from(o[t]).map(O.fromDom)},firstChild=e=>child$2(e,0),before$3=(e,t)=>{let o=parent(e);o.each(o=>{o.dom.insertBefore(t.dom,e.dom)})},after$5=(e,t)=>{let o=nextSibling(e);o.fold(()=>{let o=parent(e);o.each(e=>{append$1(e,t)})},e=>{before$3(e,t)})},prepend=(e,t)=>{let o=firstChild(e);o.fold(()=>{append$1(e,t)},o=>{e.dom.insertBefore(t.dom,o.dom)})},append$1=(e,t)=>{e.dom.appendChild(t.dom)},appendAt=(e,t,o)=>{child$2(e,o).fold(()=>{append$1(e,t)},e=>{before$3(e,t)})},wrap=(e,t)=>{before$3(e,t),append$1(t,e)},after$4=(e,t)=>{each$2(t,(o,l)=>{let n=0===l?e:t[l-1];after$5(n,o)})},append=(e,t)=>{each$2(t,t=>{append$1(e,t)})},empty=e=>{e.dom.textContent="",each$2(children$2(e),e=>{remove$6(e)})},remove$6=e=>{let t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},unwrap=e=>{let t=children$2(e);t.length>0&&after$4(e,t),remove$6(e)},clone$1=(e,t)=>O.fromDom(e.dom.cloneNode(t)),shallow=e=>clone$1(e,!1),deep=e=>clone$1(e,!0),shallowAs=(e,t)=>{let o=O.fromTag(t),l=clone$2(e);return setAll$1(o,l),o},copy$2=(e,t)=>{let o=shallowAs(e,t),l=children$2(deep(e));return append(o,l),o},mutate$1=(e,t)=>{let o=shallowAs(e,t);after$5(e,o);let l=children$2(e);return append(o,l),remove$6(e),o},T=["tfoot","thead","tbody","colgroup"],isValidSection=e=>contains$2(T,e),grid=(e,t)=>({rows:e,columns:t}),address=(e,t)=>({row:e,column:t}),detail=(e,t,o)=>({element:e,rowspan:t,colspan:o}),detailnew=(e,t,o,l)=>({element:e,rowspan:t,colspan:o,isNew:l}),extended=(e,t,o,l,n,a)=>({element:e,rowspan:t,colspan:o,row:l,column:n,isLocked:a}),rowdetail=(e,t,o)=>({element:e,cells:t,section:o}),rowdetailnew=(e,t,o,l)=>({element:e,cells:t,section:o,isNew:l}),elementnew=(e,t,o)=>({element:e,isNew:t,isLocked:o}),rowcells=(e,t,o,l)=>({element:e,cells:t,section:o,isNew:l}),bounds=(e,t,o,l)=>({startRow:e,startCol:t,finishRow:o,finishCol:l}),columnext=(e,t,o)=>({element:e,colspan:t,column:o}),colgroup=(e,t)=>({element:e,columns:t}),isShadowRoot=e=>S(e)&&isNonNullable(e.dom.host),R=c(Element.prototype.attachShadow)&&c(Node.prototype.getRootNode),x=constant(R),D=R?e=>O.fromDom(e.dom.getRootNode()):documentOrOwner,getShadowRoot=e=>{let t=D(e);return isShadowRoot(t)?Optional.some(t):Optional.none()},getShadowHost=e=>O.fromDom(e.dom.host),getOriginalEventTarget=e=>{if(x()&&isNonNullable(e.target)){let t=O.fromDom(e.target);if(C(t)&&isOpenShadowHost(t)&&e.composed&&e.composedPath){let t=e.composedPath();if(t)return head(t)}}return Optional.from(e.target)},isOpenShadowHost=e=>isNonNullable(e.dom.shadowRoot),inBody=e=>{let t=v(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;let o=t.ownerDocument;return getShadowRoot(O.fromDom(t)).fold(()=>o.body.contains(t),compose1(inBody,getShadowHost))},body$1=()=>getBody$1(O.fromDom(document)),getBody$1=e=>{let t=e.dom.body;if(null==t)throw Error("Body is not available yet");return O.fromDom(t)},ancestors$4=(e,t,o)=>filter$2(parents(e,o),t),children$1=(e,t)=>filter$2(children$2(e),t),descendants$1=(e,t)=>{let o=[];return each$2(children$2(e),e=>{t(e)&&(o=o.concat([e])),o=o.concat(descendants$1(e,t))}),o},ancestors$3=(e,t,o)=>ancestors$4(e,e=>is$2(e,t),o),children=(e,t)=>children$1(e,e=>is$2(e,t)),descendants=(e,t)=>all$1(t,e);var ClosestOrAncestor=(e,t,o,l,n)=>e(o,l)?Optional.some(o):c(n)&&n(o)?Optional.none():t(o,l,n);let ancestor$2=(e,t,o)=>{let l=e.dom,n=c(o)?o:m;for(;l.parentNode;){l=l.parentNode;let e=O.fromDom(l);if(t(e))return Optional.some(e);if(n(e))break}return Optional.none()},closest$2=(e,t,o)=>ClosestOrAncestor((e,t)=>t(e),ancestor$2,e,t,o),child$1=(e,t)=>{let o=find$1(e.dom.childNodes,e=>t(O.fromDom(e)));return o.map(O.fromDom)},descendant$1=(e,t)=>{let descend=e=>{for(let o=0;o<e.childNodes.length;o++){let l=O.fromDom(e.childNodes[o]);if(t(l))return Optional.some(l);let n=descend(e.childNodes[o]);if(n.isSome())return n}return Optional.none()};return descend(e.dom)},ancestor$1=(e,t,o)=>ancestor$2(e,e=>is$2(e,t),o),child=(e,t)=>child$1(e,e=>is$2(e,t)),descendant=(e,t)=>one(t,e),closest$1=(e,t,o)=>ClosestOrAncestor((e,t)=>is$2(e,t),ancestor$1,e,t,o),is=(e,t,o=tripleEquals)=>e.exists(e=>o(e,t)),cat=e=>{let t=[],push=e=>{t.push(e)};for(let t=0;t<e.length;t++)e[t].each(push);return t},bindFrom=(e,t)=>null!=e?t(e):Optional.none(),someIf=(e,t)=>e?Optional.some(t):Optional.none(),checkRange=(e,t,o)=>""===t||e.length>=t.length&&e.substr(o,o+t.length)===t,contains=(e,t,o=0,l)=>{let n=e.indexOf(t,o);return -1!==n&&(!!s(l)||n+t.length<=l)},startsWith=(e,t)=>checkRange(e,t,0),endsWith=(e,t)=>checkRange(e,t,e.length-t.length),E=(e=/^\s+|\s+$/g,t=>t.replace(e,"")),isNotEmpty=e=>e.length>0,toFloat=e=>{let t=parseFloat(e);return isNaN(t)?Optional.none():Optional.some(t)},isSupported=e=>void 0!==e.style&&c(e.style.getPropertyValue),internalSet=(e,t,l)=>{if(!o(l))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",l,":: Element ",e),Error("CSS value must be a string: "+l);isSupported(e)&&e.style.setProperty(t,l)},internalRemove=(e,t)=>{isSupported(e)&&e.style.removeProperty(t)},set$1=(e,t,o)=>{let l=e.dom;internalSet(l,t,o)},setAll=(e,t)=>{let o=e.dom;each$1(t,(e,t)=>{internalSet(o,t,e)})},get$a=(e,t)=>{let o=e.dom,l=window.getComputedStyle(o),n=l.getPropertyValue(t);return""!==n||inBody(e)?n:getUnsafeProperty(o,t)},getUnsafeProperty=(e,t)=>isSupported(e)?e.style.getPropertyValue(t):"",getRaw$2=(e,t)=>{let o=e.dom,l=getUnsafeProperty(o,t);return Optional.from(l).filter(e=>e.length>0)},remove$5=(e,t)=>{let o=e.dom;internalRemove(o,t),is(getOpt(e,"style").map(E),"")&&remove$7(e,"style")},copy$1=(e,t)=>{let o=e.dom,l=t.dom;isSupported(o)&&isSupported(l)&&(l.style.cssText=o.style.cssText)},getAttrValue=(e,t,o=0)=>getOpt(e,t).map(e=>parseInt(e,10)).getOr(o),getSpan=(e,t)=>getAttrValue(e,t,1),hasColspan=e=>isTag("col")(e)?getAttrValue(e,"span",1)>1:getSpan(e,"colspan")>1,hasRowspan=e=>getSpan(e,"rowspan")>1,getCssValue=(e,t)=>parseInt(get$a(e,t),10),k=constant(10),A=constant(10),firstLayer=(e,t)=>filterFirstLayer(e,t,u),filterFirstLayer=(e,t,o)=>bind$2(children$2(e),e=>is$2(e,t)?o(e)?[e]:[]:filterFirstLayer(e,t,o)),lookup=(e,t,o=m)=>o(t)?Optional.none():contains$2(e,name(t))?Optional.some(t):ancestor$1(t,e.join(","),e=>is$2(e,"table")||o(e)),cell=(e,t)=>lookup(["td","th"],e,t),cells$1=e=>firstLayer(e,"th,td"),columns$1=e=>is$2(e,"colgroup")?children(e,"col"):bind$2(columnGroups(e),e=>children(e,"col")),table=(e,t)=>closest$1(e,"table",t),rows$1=e=>firstLayer(e,"tr"),columnGroups=e=>table(e).fold(constant([]),e=>children(e,"colgroup")),fromRowsOrColGroups=(e,t)=>map$1(e,e=>{if("colgroup"===name(e)){let t=map$1(columns$1(e),e=>{let t=getAttrValue(e,"span",1);return detail(e,1,t)});return rowdetail(e,t,"colgroup")}{let o=map$1(cells$1(e),e=>{let t=getAttrValue(e,"rowspan",1),o=getAttrValue(e,"colspan",1);return detail(e,t,o)});return rowdetail(e,o,t(e))}}),getParentSection=e=>parent(e).map(e=>{let t=name(e);return isValidSection(t)?t:"tbody"}).getOr("tbody"),fromTable$1=e=>{let t=rows$1(e),o=columnGroups(e),l=[...o,...t];return fromRowsOrColGroups(l,getParentSection)},fromPastedRows=(e,t)=>fromRowsOrColGroups(e,()=>t),cached=e=>{let t,o=!1;return(...l)=>(o||(o=!0,t=e.apply(null,l)),t)},DeviceType=(e,t,o,l)=>{let n=e.isiOS()&&!0===/ipad/i.test(o),a=e.isiOS()&&!n,i=e.isiOS()||e.isAndroid(),s=i||l("(pointer:coarse)"),c=n||!a&&i&&l("(min-device-width:768px)"),d=a||i&&!c,m=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(o),u=!d&&!c&&!m;return{isiPad:constant(n),isiPhone:constant(a),isTablet:constant(c),isPhone:constant(d),isTouch:constant(s),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:constant(m),isDesktop:constant(u)}},firstMatch=(e,t)=>{for(let o=0;o<e.length;o++){let l=e[o];if(l.test(t))return l}},find=(e,t)=>{let o=firstMatch(e,t);if(!o)return{major:0,minor:0};let group=e=>Number(t.replace(o,"$"+e));return nu$2(group(1),group(2))},unknown$2=()=>nu$2(0,0),nu$2=(e,t)=>({major:e,minor:t}),B={nu:nu$2,detect:(e,t)=>{let o=String(t).toLowerCase();return 0===e.length?unknown$2():find(e,o)},unknown:unknown$2},detectBrowser$1=(e,t)=>findMap(t.brands,t=>{let o=t.brand.toLowerCase();return find$1(e,e=>{var t;return o===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())}).map(e=>({current:e.name,version:B.nu(parseInt(t.version,10),0)}))}),detect$4=(e,t)=>{let o=String(t).toLowerCase();return find$1(e,e=>e.search(o))},detectBrowser=(e,t)=>detect$4(e,t).map(e=>{let o=B.detect(e.versionRegexes,t);return{current:e.name,version:o}}),detectOs=(e,t)=>detect$4(e,t).map(e=>{let o=B.detect(e.versionRegexes,t);return{current:e.name,version:o}}),P=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,checkContains=e=>t=>contains(t,e),z=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>contains(e,"edge/")&&contains(e,"chrome")&&contains(e,"safari")&&contains(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,P],search:e=>contains(e,"chrome")&&!contains(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>contains(e,"msie")||contains(e,"trident")},{name:"Opera",versionRegexes:[P,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:checkContains("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:checkContains("firefox")},{name:"Safari",versionRegexes:[P,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(contains(e,"safari")||contains(e,"mobile/"))&&contains(e,"applewebkit")}],W=[{name:"Windows",search:checkContains("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>contains(e,"iphone")||contains(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:checkContains("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:checkContains("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:checkContains("linux"),versionRegexes:[]},{name:"Solaris",search:checkContains("sunos"),versionRegexes:[]},{name:"FreeBSD",search:checkContains("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:checkContains("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],N={browsers:constant(z),oses:constant(W)},L="Edge",F="Chromium",I="Opera",M="Firefox",H="Safari",nu$1=e=>{let t=e.current,o=e.version,isBrowser=e=>()=>t===e;return{current:t,version:o,isEdge:isBrowser(L),isChromium:isBrowser(F),isIE:isBrowser("IE"),isOpera:isBrowser(I),isFirefox:isBrowser(M),isSafari:isBrowser(H)}},j={unknown:()=>nu$1({current:void 0,version:B.unknown()}),nu:nu$1,edge:constant(L),chromium:constant(F),ie:constant("IE"),opera:constant(I),firefox:constant(M),safari:constant(H)},G="Windows",q="Android",_="Linux",U="macOS",V="Solaris",K="FreeBSD",Z="ChromeOS",nu=e=>{let t=e.current,o=e.version,isOS=e=>()=>t===e;return{current:t,version:o,isWindows:isOS(G),isiOS:isOS("iOS"),isAndroid:isOS(q),isMacOS:isOS(U),isLinux:isOS(_),isSolaris:isOS(V),isFreeBSD:isOS(K),isChromeOS:isOS(Z)}},Q={unknown:()=>nu({current:void 0,version:B.unknown()}),nu,windows:constant(G),ios:constant("iOS"),android:constant(q),linux:constant(_),macos:constant(U),solaris:constant(V),freebsd:constant(K),chromeos:constant(Z)},Y={detect:(e,t,o)=>{let l=N.browsers(),n=N.oses(),a=t.bind(e=>detectBrowser$1(l,e)).orThunk(()=>detectBrowser(l,e)).fold(j.unknown,j.nu),i=detectOs(n,e).fold(Q.unknown,Q.nu),s=DeviceType(i,a,e,o);return{browser:a,os:i,deviceType:s}}},mediaMatch=e=>window.matchMedia(e).matches,J=cached(()=>Y.detect(navigator.userAgent,Optional.from(navigator.userAgentData),mediaMatch)),detect$2=()=>J(),Dimension=(e,t)=>{let get=o=>{let l=t(o);if(l<=0||null===l){let t=get$a(o,e);return parseFloat(t)||0}return l},aggregate=(e,t)=>foldl(t,(t,o)=>{let l=get$a(e,o),n=void 0===l?0:parseInt(l,10);return isNaN(n)?t:t+n},0);return{set:(t,o)=>{if(!d(o)&&!o.match(/^[0-9]+$/))throw Error(e+".set accepts only positive integer values. Value was "+o);let l=t.dom;isSupported(l)&&(l.style[e]=o+"px")},get,getOuter:get,aggregate,max:(e,t,o)=>{let l=aggregate(e,o);return t>l?t-l:0}}},toNumber=(e,t)=>toFloat(e).getOr(t),getProp=(e,t,o)=>toNumber(get$a(e,t),o),calcContentBoxSize=(e,t,o,l)=>{let n=getProp(e,`padding-${o}`,0),a=getProp(e,`padding-${l}`,0),i=getProp(e,`border-${o}-width`,0),s=getProp(e,`border-${l}-width`,0);return t-n-a-i-s},getCalculatedWidth=(e,t)=>{let o=e.dom,l=o.getBoundingClientRect().width||o.offsetWidth;return"border-box"===t?l:calcContentBoxSize(e,l,"left","right")},X=Dimension("width",e=>e.dom.offsetWidth),get$9=e=>X.get(e),getOuter$2=e=>X.getOuter(e),getInner=e=>getCalculatedWidth(e,"content-box"),getRuntime$1=e=>getProp(e,"width",e.dom.offsetWidth),addCells=(e,t,o)=>{let l=e.cells,n=l.slice(0,t),a=l.slice(t),i=n.concat(o).concat(a);return setCells(e,i)},addCell=(e,t,o)=>addCells(e,t,[o]),mutateCell=(e,t,o)=>{let l=e.cells;l[t]=o},setCells=(e,t)=>rowcells(e.element,t,e.section,e.isNew),mapCells=(e,t)=>{let o=e.cells,l=map$1(o,t);return rowcells(e.element,l,e.section,e.isNew)},getCell=(e,t)=>e.cells[t],getCellElement=(e,t)=>getCell(e,t).element,cellLength=e=>e.cells.length,extractGridDetails=e=>{let t=partition(e,e=>"colgroup"===e.section);return{rows:t.fail,cols:t.pass}},clone=(e,t,o)=>{let l=map$1(e.cells,o);return rowcells(t(e.element),l,e.section,!0)},ee="data-snooker-locked-cols",getLockedColumnsFromTable=e=>getOpt(e,ee).bind(e=>Optional.from(e.match(/\d+/g))).map(e=>mapToObject(e,u)),getLockedColumnsFromGrid=e=>{let t=foldl(extractGridDetails(e).rows,(e,t)=>(each$2(t.cells,(t,o)=>{t.isLocked&&(e[o]=!0)}),e),{}),o=mapToArray(t,(e,t)=>parseInt(t,10));return sort$1(o)},key=(e,t)=>e+","+t,filterItems=(e,t)=>{let o=bind$2(e.all,e=>e.cells);return filter$2(o,t)},generateColumns=e=>{let t={},o=0;return each$2(e.cells,e=>{let l=e.colspan;range$1(l,n=>{let a=o+n;t[a]=columnext(e.element,l,a)}),o+=l}),t},generate$1=e=>{let t={},o=[],l=head(e).map(e=>e.element).bind(table),n=l.bind(getLockedColumnsFromTable).getOr({}),a=0,i=0,s=0,{pass:c,fail:d}=partition(e,e=>"colgroup"===e.section);each$2(d,e=>{let l=[];each$2(e.cells,e=>{let o=0;for(;void 0!==t[key(s,o)];)o++;let a=hasNonNullableKey(n,o.toString()),c=extended(e.element,e.rowspan,e.colspan,s,o,a);for(let l=0;l<e.colspan;l++)for(let n=0;n<e.rowspan;n++){let e=s+n,a=o+l,d=key(e,a);t[d]=c,i=Math.max(i,a+1)}l.push(c)}),a++,o.push(rowdetail(e.element,l,e.section)),s++});let{columns:m,colgroups:u}=last$2(c).map(e=>{let t=generateColumns(e),o=colgroup(e.element,values(t));return{colgroups:[o],columns:t}}).getOrThunk(()=>({colgroups:[],columns:{}})),p=grid(a,i);return{grid:p,access:t,all:o,columns:m,colgroups:u}},et={fromTable:e=>{let t=fromTable$1(e);return generate$1(t)},generate:generate$1,getAt:(e,t,o)=>Optional.from(e.access[key(t,o)]),findItem:(e,t,o)=>{let l=filterItems(e,e=>o(t,e.element));return l.length>0?Optional.some(l[0]):Optional.none()},filterItems,justCells:e=>bind$2(e.all,e=>e.cells),justColumns:e=>values(e.columns),hasColumns:e=>h(e.columns).length>0,getColumnAt:(e,t)=>Optional.from(e.columns[t])},columns=(e,t=u)=>{let o=e.grid,l=range$1(o.columns,identity),n=range$1(o.rows,identity);return map$1(l,o=>decide(()=>bind$2(n,t=>et.getAt(e,t,o).filter(e=>e.column===o).toArray()),e=>1===e.colspan&&t(e.element),()=>et.getAt(e,0,o)))},decide=(e,t,o)=>{let l=e(),n=find$1(l,t),a=n.orThunk(()=>Optional.from(l[0]).orThunk(o));return a.map(e=>e.element)},rows=e=>{let t=e.grid,o=range$1(t.rows,identity),l=range$1(t.columns,identity);return map$1(o,t=>decide(()=>bind$2(l,o=>et.getAt(e,t,o).filter(e=>e.row===t).fold(constant([]),e=>[e])),e=>1===e.rowspan,()=>et.getAt(e,t,0)))},deduce=(e,t)=>{if(t<0||t>=e.length-1)return Optional.none();let o=e[t].fold(()=>{let o=reverse(e.slice(0,t));return findMap(o,(e,t)=>e.map(e=>({value:e,delta:t+1})))},e=>Optional.some({value:e,delta:0})),l=e[t+1].fold(()=>{let o=e.slice(t+1);return findMap(o,(e,t)=>e.map(e=>({value:e,delta:t+1})))},e=>Optional.some({value:e,delta:1}));return o.bind(e=>l.map(t=>{let o=t.delta+e.delta;return Math.abs(t.value-e.value)/o}))},onDirection=(e,t)=>o=>"rtl"===getDirection(o)?t:e,getDirection=e=>"rtl"===get$a(e,"direction")?"rtl":"ltr",eo=Dimension("height",e=>{let t=e.dom;return inBody(e)?t.getBoundingClientRect().height:t.offsetHeight}),get$8=e=>eo.get(e),getOuter$1=e=>eo.getOuter(e),getRuntime=e=>getProp(e,"height",e.dom.offsetHeight),r=(e,t)=>({left:e,top:t,translate:(o,l)=>r(e+o,t+l)}),boxPosition=e=>{let t=e.getBoundingClientRect();return r(t.left,t.top)},firstDefinedOrZero=(e,t)=>void 0!==e?e:void 0!==t?t:0,absolute=e=>{let t=e.dom.ownerDocument,o=t.body,l=t.defaultView,n=t.documentElement;if(o===e.dom)return r(o.offsetLeft,o.offsetTop);let a=firstDefinedOrZero(null==l?void 0:l.pageYOffset,n.scrollTop),i=firstDefinedOrZero(null==l?void 0:l.pageXOffset,n.scrollLeft),s=firstDefinedOrZero(n.clientTop,o.clientTop),c=firstDefinedOrZero(n.clientLeft,o.clientLeft);return viewport(e).translate(i-c,a-s)},viewport=e=>{let t=e.dom,o=t.ownerDocument,l=o.body;return l===t?r(l.offsetLeft,l.offsetTop):inBody(e)?boxPosition(t):r(0,0)},rowInfo=(e,t)=>({row:e,y:t}),colInfo=(e,t)=>({col:e,x:t}),rtlEdge=e=>{let t=absolute(e);return t.left+getOuter$2(e)},ltrEdge=e=>absolute(e).left,getLeftEdge=(e,t)=>colInfo(e,ltrEdge(t)),getRightEdge=(e,t)=>colInfo(e,rtlEdge(t)),getTop$1=e=>absolute(e).top,getTopEdge=(e,t)=>rowInfo(e,getTop$1(t)),getBottomEdge=(e,t)=>rowInfo(e,getTop$1(t)+getOuter$1(t)),findPositions=(e,t,o)=>{if(0===o.length)return[];let l=map$1(o.slice(1),(t,o)=>t.map(t=>e(o,t))),n=o[o.length-1].map(e=>t(o.length-1,e));return l.concat([n])},el={delta:identity,positions:e=>findPositions(getTopEdge,getBottomEdge,e),edge:getTop$1},er=onDirection({delta:identity,edge:ltrEdge,positions:e=>findPositions(getLeftEdge,getRightEdge,e)},{delta:e=>-e,edge:rtlEdge,positions:e=>findPositions(getRightEdge,getLeftEdge,e)}),en={delta:(e,t)=>er(t).delta(e,t),positions:(e,t)=>er(t).positions(e,t),edge:e=>er(e).edge(e)},ea={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},ei=(()=>{let e="[0-9]+",t="[+-]?"+e,o="[eE]"+t,opt=e=>`(?:${e})?`,l=["Infinity",e+"\\."+opt(e)+opt(o),"\\."+e+opt(o),e+opt(o)].join("|"),n=`[+-]?(?:${l})`;return RegExp(`^(${n})(.*)$`)})(),isUnit=(e,t)=>exists(t,t=>exists(ea[t],t=>e===t)),parse=(e,t)=>{let o=Optional.from(ei.exec(e));return o.bind(e=>{let o=Number(e[1]),l=e[2];return isUnit(l,t)?Optional.some({value:o,unit:l}):Optional.none()})},es=/(\d+(\.\d+)?)%/,ec=/(\d+(\.\d+)?)px|em/,ed=isTag("col"),getPercentSize=(e,t,o)=>{let l=parentElement(e).getOrThunk(()=>getBody$1(owner(e)));return t(e)/o(l)*100},setPixelWidth=(e,t)=>{set$1(e,"width",t+"px")},setPercentageWidth=(e,t)=>{set$1(e,"width",t+"%")},setHeight=(e,t)=>{set$1(e,"height",t+"px")},getHeightValue=e=>getRuntime(e)+"px",convert=(e,t,o,l)=>{let n=table(e).map(e=>{let l=o(e);return Math.floor(t/100*l)}).getOr(t);return l(e,n),n},normalizePixelSize=(e,t,o,l)=>{let n=parseFloat(e);return endsWith(e,"%")&&"table"!==name(t)?convert(t,n,o,l):n},getTotalHeight=e=>{let t=getHeightValue(e);return t?normalizePixelSize(t,e,get$8,setHeight):get$8(e)},get$7=(e,t,o)=>{let l=o(e),n=getSpan(e,t);return l/n},getRaw$1=(e,t)=>getRaw$2(e,t).orThunk(()=>getOpt(e,t).map(e=>e+"px")),getRawWidth$1=e=>getRaw$1(e,"width"),getRawHeight=e=>getRaw$1(e,"height"),getPercentageWidth=e=>getPercentSize(e,get$9,getInner),getPixelWidth$1=e=>ed(e)?get$9(e):getRuntime$1(e),getHeight=e=>get$7(e,"rowspan",getTotalHeight),getGenericWidth=e=>{let t=getRawWidth$1(e);return t.bind(e=>parse(e,["fixed","relative","empty"]))},setGenericWidth=(e,t,o)=>{set$1(e,"width",t+o)},getPixelTableWidth=e=>get$9(e)+"px",getPercentTableWidth=e=>getPercentSize(e,get$9,getInner)+"%",em=constant(es),eu=isTag("col"),getRawW=e=>getRawWidth$1(e).getOrThunk(()=>getPixelWidth$1(e)+"px"),getRawH=e=>getRawHeight(e).getOrThunk(()=>getHeight(e)+"px"),justCols=e=>map$1(et.justColumns(e),e=>Optional.from(e.element)),isValidColumn=e=>{let t=detect$2().browser,o=t.isChromium()||t.isFirefox();return!eu(e)||o},getDimension=(e,t,o,l,n,a)=>e.filter(l).fold(()=>a(deduce(o,t)),e=>n(e)),getWidthFrom=(e,t,o,l)=>{let n=columns(e),a=et.hasColumns(e)?justCols(e):n,i=[Optional.some(en.edge(t))].concat(map$1(en.positions(n,t),e=>e.map(e=>e.x))),s=not(hasColspan);return map$1(a,(e,t)=>getDimension(e,t,i,s,e=>{if(isValidColumn(e))return o(e);{let e=bindFrom(n[t],identity);return getDimension(e,t,i,s,e=>l(Optional.some(get$9(e))),l)}},l))},getDeduced=e=>e.map(e=>e+"px").getOr(""),getRawWidths=(e,t)=>getWidthFrom(e,t,getRawW,getDeduced),getPercentageWidths=(e,t,o)=>getWidthFrom(e,t,getPercentageWidth,e=>e.fold(()=>o.minCellWidth(),e=>e/o.pixelWidth()*100)),getPixelWidths=(e,t,o)=>getWidthFrom(e,t,getPixelWidth$1,e=>e.getOrThunk(o.minCellWidth)),getHeightFrom=(e,t,o,l,n)=>{let a=rows(e),i=[Optional.some(o.edge(t))].concat(map$1(o.positions(a,t),e=>e.map(e=>e.y)));return map$1(a,(e,t)=>getDimension(e,t,i,not(hasRowspan),l,n))},getPixelHeights=(e,t,o)=>getHeightFrom(e,t,o,getHeight,e=>e.getOrThunk(A)),getRawHeights=(e,t,o)=>getHeightFrom(e,t,o,getRawH,getDeduced),widthLookup=(e,t)=>()=>inBody(e)?t(e):parseFloat(getRaw$2(e,"width").getOr("0")),noneSize=e=>{let t=widthLookup(e,get$9),o=constant(0);return{width:t,pixelWidth:t,getWidths:(t,o)=>getPixelWidths(t,e,o),getCellDelta:o,singleColumnWidth:constant([0]),minCellWidth:o,setElementWidth:noop,adjustTableWidth:noop,isRelative:!0,label:"none"}},percentageSize=e=>{let t=widthLookup(e,e=>parseFloat(getPercentTableWidth(e))),o=widthLookup(e,get$9);return{width:t,pixelWidth:o,getWidths:(t,o)=>getPercentageWidths(t,e,o),getCellDelta:e=>e/o()*100,singleColumnWidth:(e,t)=>[100-e],minCellWidth:()=>k()/o()*100,setElementWidth:setPercentageWidth,adjustTableWidth:o=>{let l=t();setPercentageWidth(e,l+o/100*l)},isRelative:!0,label:"percent"}},pixelSize=e=>{let t=widthLookup(e,get$9);return{width:t,pixelWidth:t,getWidths:(t,o)=>getPixelWidths(t,e,o),getCellDelta:identity,singleColumnWidth:(e,t)=>{let o=Math.max(k(),e+t);return[o-e]},minCellWidth:k,setElementWidth:setPixelWidth,adjustTableWidth:o=>{let l=t()+o;setPixelWidth(e,l)},isRelative:!1,label:"pixel"}},chooseSize=(e,t)=>{let o=em().exec(t);return null!==o?percentageSize(e):pixelSize(e)},ep={getTableSize:e=>{let t=getRawWidth$1(e);return t.fold(()=>noneSize(e),t=>chooseSize(e,t))},pixelSize,percentageSize,noneSize},statsStruct=(e,t,o,l,n,a)=>({minRow:e,minCol:t,maxRow:o,maxCol:l,allCells:n,selectedCells:a}),findSelectedStats=(e,t)=>{let o=e.grid.columns,l=e.grid.rows,n=l,a=o,i=0,s=0,c=[],d=[];return each$1(e.access,e=>{if(c.push(e),t(e)){d.push(e);let t=e.row,o=t+e.rowspan-1,l=e.column,c=l+e.colspan-1;t<n?n=t:o>i&&(i=o),l<a?a=l:c>s&&(s=c)}}),statsStruct(n,a,i,s,c,d)},makeCell=(e,t,o)=>{let l=e[o].element,n=O.fromTag("td");append$1(n,O.fromTag("br"));let a=t?append$1:prepend;a(l,n)},fillInGaps=(e,t,o,l)=>{let n=filter$2(e,e=>"colgroup"!==e.section),a=t.grid.columns,i=t.grid.rows;for(let e=0;e<i;e++){let i=!1;for(let s=0;s<a;s++)if(!(e<o.minRow||e>o.maxRow||s<o.minCol||s>o.maxCol)){let o=et.getAt(t,e,s).filter(l).isNone();o?makeCell(n,i,e):i=!0}}},clean=(e,t,o,l)=>{each$1(o.columns,e=>{(e.column<t.minCol||e.column>t.maxCol)&&remove$6(e.element)});let n=filter$2(firstLayer(e,"tr"),e=>0===e.dom.childElementCount);each$2(n,remove$6),(t.minCol===t.maxCol||t.minRow===t.maxRow)&&each$2(firstLayer(e,"th,td"),e=>{remove$7(e,"rowspan"),remove$7(e,"colspan")}),remove$7(e,ee),remove$7(e,"data-snooker-col-series");let a=ep.getTableSize(e);a.adjustTableWidth(l)},getTableWidthDelta=(e,t,o,l)=>{if(0===l.minCol&&t.grid.columns===l.maxCol+1)return 0;let n=getPixelWidths(t,e,o),a=foldl(n,(e,t)=>e+t,0),i=foldl(n.slice(l.minCol,l.maxCol+1),(e,t)=>e+t,0),s=i/a*o.pixelWidth(),c=s-o.pixelWidth();return o.getCellDelta(c)},extract$1=(e,t)=>{let isSelected=e=>is$2(e.element,t),o=deep(e),l=fromTable$1(o),n=ep.getTableSize(e),a=et.generate(l),i=findSelectedStats(a,isSelected),s="th:not("+t+"),td:not("+t+")",c=filterFirstLayer(o,"th,td",e=>is$2(e,s));each$2(c,remove$6),fillInGaps(l,a,i,isSelected);let d=et.fromTable(e),m=getTableWidthDelta(e,d,n,i);return clean(o,i,a,m),o},eg=((e,t)=>{let getOption=t=>e(t)?Optional.from(t.dom.nodeValue):Optional.none();return{get:o=>{if(!e(o))throw Error("Can only get "+t+" value of a "+t+" node");return getOption(o).getOr("")},getOption,set:(o,l)=>{if(!e(o))throw Error("Can only set raw "+t+" value of a "+t+" node");o.dom.nodeValue=l}}})(v,"text"),get$6=e=>eg.get(e),getOption=e=>eg.getOption(e),set=(e,t)=>eg.set(e,t),getEnd=e=>"img"===name(e)?1:getOption(e).fold(()=>children$2(e).length,e=>e.length),isTextNodeWithCursorPosition=e=>getOption(e).filter(e=>0!==e.trim().length||e.indexOf("\xa0")>-1).isSome(),isContentEditableFalse=e=>isHTMLElement(e)&&"false"===get$b(e,"contenteditable"),ef=["img","br"],isCursorPosition=e=>{let t=isTextNodeWithCursorPosition(e);return t||contains$2(ef,name(e))||isContentEditableFalse(e)},first=e=>descendant$1(e,isCursorPosition),last$1=e=>descendantRtl(e,isCursorPosition),descendantRtl=(e,t)=>{let descend=e=>{let o=children$2(e);for(let e=o.length-1;e>=0;e--){let l=o[e];if(t(l))return Optional.some(l);let n=descend(l);if(n.isSome())return n}return Optional.none()};return descend(e)},eh={scope:["row","col"]},createCell=e=>()=>{let t=O.fromTag("td",e.dom);return append$1(t,O.fromTag("br",e.dom)),t},createCol=e=>()=>O.fromTag("col",e.dom),createColgroup=e=>()=>O.fromTag("colgroup",e.dom),createRow$1=e=>()=>O.fromTag("tr",e.dom),replace$1=(e,t,o)=>{let l=copy$2(e,t);return each$1(o,(e,t)=>{null===e?remove$7(l,t):set$2(l,t,e)}),l},pasteReplace=e=>e,cloneFormats=(e,t,o)=>{let l=first(e);return l.map(l=>{let n=o.join(","),a=ancestors$3(l,n,t=>eq$1(t,e));return foldr(a,(e,t)=>{let o=shallow(t);return append$1(e,o),o},t)}).getOr(t)},cloneAppropriateAttributes=(e,t)=>{each$1(eh,(o,l)=>getOpt(e,l).filter(e=>contains$2(o,e)).each(e=>set$2(t,l,e)))},cellOperations=(e,t,o)=>{let cloneCss=(e,t)=>{copy$1(e.element,t),remove$5(t,"height"),1!==e.colspan&&remove$5(t,"width")};return{col:o=>{let l=O.fromTag(name(o.element),t.dom);return cloneCss(o,l),e(o.element,l),l},colgroup:createColgroup(t),row:createRow$1(t),cell:l=>{let n=O.fromTag(name(l.element),t.dom),a=o.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),i=a.length>0?cloneFormats(l.element,n,a):n;return append$1(i,O.fromTag("br")),cloneCss(l,n),cloneAppropriateAttributes(l.element,n),e(l.element,n),n},replace:replace$1,colGap:createCol(t),gap:createCell(t)}},paste$1=e=>({col:createCol(e),colgroup:createColgroup(e),row:createRow$1(e),cell:createCell(e),replace:pasteReplace,colGap:createCol(e),gap:createCell(e)}),fromHtml=(e,t)=>{let o=t||document,l=o.createElement("div");return l.innerHTML=e,children$2(O.fromDom(l))},fromDom=e=>map$1(e,O.fromDom),option=e=>t=>t.options.get(e),eb="100%",getPixelForcedWidth=e=>{var t;let o=e.dom,l=null!==(t=o.getParent(e.selection.getStart(),o.isBlock))&&void 0!==t?t:e.getBody();return getInner(O.fromDom(l))+"px"},determineDefaultTableStyles=(e,t)=>isTableResponsiveForced(e)||!ey(e)?t:isTablePixelsForced(e)?{...t,width:getPixelForcedWidth(e)}:{...t,width:eb},determineDefaultTableAttributes=(e,t)=>isTableResponsiveForced(e)||ey(e)?t:isTablePixelsForced(e)?{...t,width:getPixelForcedWidth(e)}:{...t,width:eb},register=e=>{let t=e.options.register;t("table_clone_elements",{processor:"string[]"}),t("table_use_colgroups",{processor:"boolean",default:!0}),t("table_header_type",{processor:e=>{let t=contains$2(["section","cells","sectionCells","auto"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be one of: section, cells, sectionCells or auto."}},default:"section"}),t("table_sizing_mode",{processor:"string",default:"auto"}),t("table_default_attributes",{processor:"object",default:{border:"1"}}),t("table_default_styles",{processor:"object",default:{"border-collapse":"collapse"}}),t("table_column_resizing",{processor:e=>{let t=contains$2(["preservetable","resizetable"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be preservetable, or resizetable."}},default:"preservetable"}),t("table_resize_bars",{processor:"boolean",default:!0}),t("table_style_by_css",{processor:"boolean",default:!0}),t("table_merge_content_on_paste",{processor:"boolean",default:!0})},getTableCloneElements=e=>Optional.from(e.options.get("table_clone_elements")),hasTableObjectResizing=e=>{let t=e.options.get("object_resizing");return contains$2(t.split(","),"table")},e$=option("table_header_type"),ew=option("table_column_resizing"),isPreserveTableColumnResizing=e=>"preservetable"===ew(e),isResizeTableColumnResizing=e=>"resizetable"===ew(e),eC=option("table_sizing_mode"),isTablePercentagesForced=e=>"relative"===eC(e),isTablePixelsForced=e=>"fixed"===eC(e),isTableResponsiveForced=e=>"responsive"===eC(e),ev=option("table_resize_bars"),ey=option("table_style_by_css"),eS=option("table_merge_content_on_paste"),getTableDefaultAttributes=e=>{let t=e.options,o=t.get("table_default_attributes");return t.isSet("table_default_attributes")?o:determineDefaultTableAttributes(e,o)},getTableDefaultStyles=e=>{let t=e.options,o=t.get("table_default_styles");return t.isSet("table_default_styles")?o:determineDefaultTableStyles(e,o)},eO=option("table_use_colgroups"),closest=e=>closest$1(e,"[contenteditable]"),isEditable$1=(e,t=!1)=>inBody(e)?e.dom.isContentEditable:closest(e).fold(constant(t),e=>"true"===getRaw(e)),getRaw=e=>e.dom.contentEditable,getBody=e=>O.fromDom(e.getBody()),getIsRoot=e=>t=>eq$1(t,getBody(e)),removeDataStyle=e=>{remove$7(e,"data-mce-style");let removeStyleAttribute=e=>remove$7(e,"data-mce-style");each$2(cells$1(e),removeStyleAttribute),each$2(columns$1(e),removeStyleAttribute),each$2(rows$1(e),removeStyleAttribute)},getSelectionStart=e=>O.fromDom(e.selection.getStart()),getPixelWidth=e=>e.getBoundingClientRect().width,getPixelHeight=e=>e.getBoundingClientRect().height,getRawWidth=(e,t)=>{let o=e.dom.getStyle(t,"width")||e.dom.getAttrib(t,"width");return Optional.from(o).filter(isNotEmpty)},isPercentage$1=e=>/^(\d+(\.\d+)?)%$/.test(e),isPixel=e=>/^(\d+(\.\d+)?)px$/.test(e),isInEditableContext$1=e=>closest$2(e,isTag("table")).exists(isEditable$1),inSelection=(e,t)=>{let o=t.column,l=t.column+t.colspan-1,n=t.row,a=t.row+t.rowspan-1;return o<=e.finishCol&&l>=e.startCol&&n<=e.finishRow&&a>=e.startRow},isWithin=(e,t)=>t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow,isRectangular=(e,t)=>{let o=!0,l=curry(isWithin,t);for(let n=t.startRow;n<=t.finishRow;n++)for(let a=t.startCol;a<=t.finishCol;a++)o=o&&et.getAt(e,n,a).exists(l);return o?Optional.some(t):Optional.none()},getBounds=(e,t)=>bounds(Math.min(e.row,t.row),Math.min(e.column,t.column),Math.max(e.row+e.rowspan-1,t.row+t.rowspan-1),Math.max(e.column+e.colspan-1,t.column+t.colspan-1)),getAnyBox=(e,t,o)=>{let l=et.findItem(e,t,eq$1),n=et.findItem(e,o,eq$1);return l.bind(e=>n.map(t=>getBounds(e,t)))},getBox$1=(e,t,o)=>getAnyBox(e,t,o).bind(t=>isRectangular(e,t)),moveBy$1=(e,t,o,l)=>et.findItem(e,t,eq$1).bind(t=>{let n=o>0?t.row+t.rowspan-1:t.row,a=l>0?t.column+t.colspan-1:t.column,i=et.getAt(e,n+o,a+l);return i.map(e=>e.element)}),intercepts$1=(e,t,o)=>getAnyBox(e,t,o).map(t=>{let o=et.filterItems(e,curry(inSelection,t));return map$1(o,e=>e.element)}),parentCell=(e,t)=>et.findItem(e,t,(e,t)=>contains$1(t,e)).map(e=>e.element),moveBy=(e,t,o)=>table(e).bind(l=>{let n=eT(l);return moveBy$1(n,e,t,o)}),intercepts=(e,t,o)=>{let l=eT(e);return intercepts$1(l,t,o)},nestedIntercepts=(e,t,o,l,n)=>{let a=eT(e),i=eq$1(e,o)?Optional.some(t):parentCell(a,t),s=eq$1(e,n)?Optional.some(l):parentCell(a,l);return i.bind(e=>s.bind(t=>intercepts$1(a,e,t)))},getBox=(e,t,o)=>{let l=eT(e);return getBox$1(l,t,o)},eT=et.fromTable;var eR=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],DomUniverse=()=>({up:constant({selector:ancestor$1,closest:closest$1,predicate:ancestor$2,all:parents}),down:constant({selector:descendants,predicate:descendants$1}),styles:constant({get:get$a,getRaw:getRaw$2,set:set$1,remove:remove$5}),attrs:constant({get:get$b,set:set$2,remove:remove$7,copyTo:(e,t)=>{let o=clone$2(e);setAll$1(t,o)}}),insert:constant({before:before$3,after:after$5,afterAll:after$4,append:append$1,appendAll:append,prepend:prepend,wrap:wrap}),remove:constant({unwrap:unwrap,remove:remove$6}),create:constant({nu:O.fromTag,clone:e=>O.fromDom(e.dom.cloneNode(!1)),text:O.fromText}),query:constant({comparePosition:(e,t)=>e.dom.compareDocumentPosition(t.dom),prevSibling:prevSibling,nextSibling:nextSibling}),property:constant({children:children$2,name:name,parent:parent,document:e=>documentOrOwner(e).dom,isText:v,isComment:isComment,isElement:C,isSpecial:e=>{let t=name(e);return contains$2(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},getLanguage:e=>C(e)?getOpt(e,"lang"):Optional.none(),getText:get$6,setText:set,isBoundary:e=>!!C(e)&&("body"===name(e)||contains$2(eR,name(e))),isEmptyTag:e=>!!C(e)&&contains$2(["br","img","hr","input"],name(e)),isNonEditable:e=>C(e)&&"false"===get$b(e,"contenteditable")}),eq:eq$1,is:is$2});let all=(e,t,o,l)=>{let n=o[0],a=o.slice(1);return l(e,t,n,a)},unsafeOne=(e,t,o,l)=>{let n=t(e,o);return foldr(l,(o,l)=>{let n=t(e,l);return commonElement(e,o,n)},n)},commonElement=(e,t,o)=>t.bind(t=>o.filter(curry(e.eq,t))),eq=(e,t)=>curry(e.eq,t),sharedOne$1=(e,t,o)=>o.length>0?all(e,t,o,unsafeOne):Optional.none(),ancestors$1=(e,t,o,l=m)=>{let n=[t].concat(e.up().all(t)),a=[o].concat(e.up().all(o)),prune=e=>{let t=findIndex(e,l);return t.fold(()=>e,t=>e.slice(0,t+1))},i=prune(n),s=prune(a),c=find$1(i,t=>exists(s,eq(e,t)));return{firstpath:i,secondpath:s,shared:c}},ex=DomUniverse(),sharedOne=(e,t)=>sharedOne$1(ex,(t,o)=>e(o),t),ancestors=(e,t,o)=>ancestors$1(ex,e,t,o),lookupTable=e=>ancestor$1(e,"table"),identify=(e,t,o)=>{let getIsRoot=e=>t=>void 0!==o&&o(t)||eq$1(t,e);return eq$1(e,t)?Optional.some({boxes:Optional.some([e]),start:e,finish:t}):lookupTable(e).bind(l=>lookupTable(t).bind(n=>{if(eq$1(l,n))return Optional.some({boxes:intercepts(l,e,t),start:e,finish:t});if(contains$1(l,n)){let o=ancestors$3(t,"td,th",getIsRoot(l)),a=o.length>0?o[o.length-1]:t;return Optional.some({boxes:nestedIntercepts(l,e,l,t,n),start:e,finish:a})}if(!contains$1(n,l))return ancestors(e,t).shared.bind(a=>closest$1(a,"table",o).bind(o=>{let a=ancestors$3(t,"td,th",getIsRoot(o)),i=a.length>0?a[a.length-1]:t,s=ancestors$3(e,"td,th",getIsRoot(o)),c=s.length>0?s[s.length-1]:e;return Optional.some({boxes:nestedIntercepts(o,e,l,t,n),start:c,finish:i})}));{let o=ancestors$3(e,"td,th",getIsRoot(n)),a=o.length>0?o[o.length-1]:e;return Optional.some({boxes:nestedIntercepts(n,e,l,t,n),start:e,finish:a})}}))},retrieve$1=(e,t)=>{let o=descendants(e,t);return o.length>0?Optional.some(o):Optional.none()},getLast=(e,t)=>find$1(e,e=>is$2(e,t)),getEdges=(e,t,o)=>descendant(e,t).bind(t=>descendant(e,o).bind(e=>sharedOne(lookupTable,[t,e]).map(o=>({first:t,last:e,table:o})))),expandTo=(e,t)=>ancestor$1(e,"table").bind(o=>descendant(o,t).bind(t=>identify(t,e).bind(e=>e.boxes.map(t=>({boxes:t,start:e.start,finish:e.finish}))))),shiftSelection=(e,t,o,l,n)=>getLast(e,n).bind(e=>moveBy(e,t,o).bind(e=>expandTo(e,l))),retrieve=(e,t)=>retrieve$1(e,t),retrieveBox=(e,t,o)=>getEdges(e,t,o).bind(t=>{let isRoot=t=>eq$1(e,t),o="thead,tfoot,tbody,table",l=ancestor$1(t.first,o,isRoot),n=ancestor$1(t.last,o,isRoot);return l.bind(e=>n.bind(o=>eq$1(e,o)?getBox(t.table,t.first,t.last):Optional.none()))}),unmergable=e=>{let hasSpan=(e,t)=>getOpt(e,t).exists(e=>parseInt(e,10)>1);return e.length>0&&forall(e,e=>hasSpan(e,"rowspan")||hasSpan(e,"colspan"))?Optional.some(e):Optional.none()},mergable=(e,t,o)=>t.length<=1?Optional.none():retrieveBox(e,o.firstSelectedSelector,o.lastSelectedSelector).map(e=>({bounds:e,cells:t})),eD="data-mce-selected",eE="data-mce-first-selected",ek="data-mce-last-selected",eA="["+eD+"]",eB={selected:eD,selectedSelector:"td["+eD+"],th["+eD+"]",firstSelected:eE,firstSelectedSelector:"td["+eE+"],th["+eE+"]",lastSelected:ek,lastSelectedSelector:"td["+ek+"],th["+ek+"]"},forMenu=(e,t,o)=>({element:o,mergable:mergable(t,e,eB),unmergable:unmergable(e),selection:identity(e)}),paste=(e,t,o)=>({element:e,clipboard:t,generators:o}),pasteRows=(e,t,o,l)=>({selection:identity(e),clipboard:o,generators:l}),getSelectionCellFallback=e=>table(e).bind(e=>retrieve(e,eB.firstSelectedSelector)).fold(constant(e),e=>e[0]),getSelectionFromSelector=e=>(t,o)=>{let l=name(t),n="col"===l||"colgroup"===l?getSelectionCellFallback(t):t;return closest$1(n,e,o)},eP=getSelectionFromSelector("th,td,caption"),ez=getSelectionFromSelector("th,td"),getCellsFromSelection=e=>fromDom(e.model.table.getSelectedCells()),getCellsFromFakeSelection=e=>filter$2(getCellsFromSelection(e),e=>is$2(e,eB.selectedSelector)),extractSelected=e=>table(e[0]).map(e=>{let t=extract$1(e,eA);return removeDataStyle(t),[t]}),serializeElements=(e,t)=>map$1(t,t=>e.selection.serializer.serialize(t.dom,{})).join(""),getTextContent=e=>map$1(e,e=>e.dom.innerText).join(""),registerEvents=(e,t)=>{e.on("BeforeGetContent",t=>{if(!0===t.selection){let o=getCellsFromFakeSelection(e);o.length>=1&&(t.preventDefault(),extractSelected(o).each(o=>{t.content="text"===t.format?getTextContent(o):serializeElements(e,o)}))}}),e.on("BeforeSetContent",o=>{if(!0===o.selection&&!0===o.paste){let l=getCellsFromSelection(e);head(l).each(l=>{table(l).each(n=>{let a=filter$2(fromHtml(o.content),e=>"meta"!==name(e)),i=isTag("table");if(eS(e)&&1===a.length&&i(a[0])){o.preventDefault();let i=O.fromDom(e.getDoc()),s=paste$1(i),c=paste(l,a[0],s);t.pasteCells(n,c).each(()=>{e.focus()})}})})}})},point=(e,t)=>({element:e,offset:t}),scan$1=(e,t,o)=>e.property().isText(t)&&0===e.property().getText(t).trim().length||e.property().isComment(t)?o(t).bind(t=>scan$1(e,t,o).orThunk(()=>Optional.some(t))):Optional.none(),toEnd=(e,t)=>{if(e.property().isText(t))return e.property().getText(t).length;let o=e.property().children(t);return o.length},freefallRtl$2=(e,t)=>{let o=scan$1(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(o))return point(o,toEnd(e,o));let l=e.property().children(o);return l.length>0?freefallRtl$2(e,l[l.length-1]):point(o,toEnd(e,o))},eW=DomUniverse(),freefallRtl=e=>freefallRtl$2(eW,e),halve=(e,t)=>{if(!hasColspan(e)){let o=getGenericWidth(e);o.each(o=>{let l=o.value/2;setGenericWidth(e,l,o.unit),setGenericWidth(t,l,o.unit)})}},zero=e=>map$1(e,constant(0)),surround=(e,t,o,l,n)=>n(e.slice(0,t)).concat(l).concat(n(e.slice(o))),clampDeltaHelper=e=>(t,o,l,n)=>{if(!e(l))return l;{let e=Math.max(n,t[o]-Math.abs(l)),a=Math.abs(e-t[o]);return l>=0?a:-a}},eN=clampDeltaHelper(e=>e<0),eL=clampDeltaHelper(u),resizeTable=()=>{let calcFixedDeltas=(e,t,o,l,n)=>{let a=eN(e,t,l,n);return surround(e,t,o+1,[a,0],zero)},calcRelativeDeltas=(e,t,o,l)=>{let n=(100+o)/100,a=Math.max(l,(e[t]+o)/n);return map$1(e,(e,o)=>(o===t?a:e/n)-e)},calcLeftEdgeDeltas=(e,t,o,l,n,a)=>a?calcRelativeDeltas(e,t,l,n):calcFixedDeltas(e,t,o,l,n);return{resizeTable:(e,t)=>e(t),clampTableDelta:eN,calcLeftEdgeDeltas,calcMiddleDeltas:(e,t,o,l,n,a,i)=>calcLeftEdgeDeltas(e,o,l,n,a,i),calcRightEdgeDeltas:(e,t,o,l,n,a)=>{if(a)return calcRelativeDeltas(e,o,l,n);{let t=eN(e,o,l,n);return zero(e.slice(0,o)).concat([t])}},calcRedestributedWidths:(e,t,o,l)=>{if(!l)return{delta:o,newSizes:e};{let l=(t+o)/t,n=map$1(e,e=>e/l);return{delta:100*l-100,newSizes:n}}}}},preserveTable=()=>{let calcLeftEdgeDeltas=(e,t,o,l,n)=>{let a=l>=0?o:t,i=eL(e,a,l,n);return surround(e,t,o+1,[i,-i],zero)};return{resizeTable:(e,t,o)=>{o&&e(t)},clampTableDelta:(e,t,o,l,n)=>{if(!n)return eN(e,t,o,l);if(o>=0)return o;{let t=foldl(e,(e,t)=>e+t-l,0);return Math.max(-t,o)}},calcLeftEdgeDeltas,calcMiddleDeltas:(e,t,o,l,n,a)=>calcLeftEdgeDeltas(e,o,l,n,a),calcRightEdgeDeltas:(e,t,o,l,n,a)=>{if(a)return zero(e);{let t=l/e.length;return map$1(e,constant(t))}},calcRedestributedWidths:(e,t,o,l)=>({delta:0,newSizes:e})}},getGridSize=e=>{let t=et.fromTable(e);return t.grid},eF=isTag("th"),isHeaderCells=e=>forall(e,e=>eF(e.element)),getRowHeaderType=(e,t)=>e&&t?"sectionCells":e?"section":"cells",getRowType=e=>{let t="thead"===e.section,o=is(findCommonCellType(e.cells),"th");return"tfoot"===e.section?{type:"footer"}:t||o?{type:"header",subType:getRowHeaderType(t,o)}:{type:"body"}},findCommonCellType=e=>{let t=filter$2(e,e=>eF(e.element));return 0===t.length?Optional.some("td"):t.length===e.length?Optional.some("th"):Optional.none()},findCommonRowType=e=>{let t=map$1(e,e=>getRowType(e).type),o=contains$2(t,"header"),l=contains$2(t,"footer");if(!o&&!l)return Optional.some("body");{let e=contains$2(t,"body");return!o||e||l?o||e||!l?Optional.none():Optional.some("footer"):Optional.some("header")}},findTableRowHeaderType=e=>findMap(e.all,e=>{let t=getRowType(e);return"header"===t.type?Optional.from(t.subType):Optional.none()}),transformCell=(e,t,o)=>elementnew(o(e.element,t),!0,e.isLocked),transformRow=(e,t)=>e.section!==t?rowcells(e.element,e.cells,t,e.isNew):e,section=()=>({transformRow,transformCell:(e,t,o)=>{let l=o(e.element,t),n="td"!==name(l)?mutate$1(l,"td"):l;return elementnew(n,e.isNew,e.isLocked)}}),sectionCells=()=>({transformRow,transformCell}),cells=()=>({transformRow:(e,t)=>{let o="thead"===t?"tbody":t;return transformRow(e,o)},transformCell}),eI={getTableSectionType:(e,t)=>{let o=et.fromTable(e),l=findTableRowHeaderType(o).getOr(t);switch(l){case"section":return section();case"sectionCells":return sectionCells();case"cells":return cells()}},section,sectionCells,cells,fallback:()=>({transformRow:identity,transformCell})},setIfNot=(e,t,o,l)=>{o===l?remove$7(e,t):set$2(e,t,o)},insert$1=(e,t,o)=>{last$2(children(e,t)).fold(()=>prepend(e,o),e=>after$5(e,o))},generateSection=(e,t)=>{let o=child(e,t).getOrThunk(()=>{let o=O.fromTag(t,owner(e).dom);return"thead"===t?insert$1(e,"caption,colgroup",o):"colgroup"===t?insert$1(e,"caption",o):append$1(e,o),o});return empty(o),o},render$1=(e,t)=>{let o=[],l=[],syncRows=e=>map$1(e,e=>{e.isNew&&o.push(e.element);let t=e.element;return empty(t),each$2(e.cells,e=>{e.isNew&&l.push(e.element),setIfNot(e.element,"colspan",e.colspan,1),setIfNot(e.element,"rowspan",e.rowspan,1),append$1(t,e.element)}),t}),syncColGroup=e=>bind$2(e,e=>map$1(e.cells,e=>(setIfNot(e.element,"span",e.colspan,1),e.element))),renderSection=(t,o)=>{let l=generateSection(e,o),n="colgroup"===o?syncColGroup:syncRows,a=n(t);append(l,a)},removeSection=t=>{child(e,t).each(remove$6)},renderOrRemoveSection=(e,t)=>{e.length>0?renderSection(e,t):removeSection(t)},n=[],a=[],i=[],s=[];return each$2(t,e=>{switch(e.section){case"thead":n.push(e);break;case"tbody":a.push(e);break;case"tfoot":i.push(e);break;case"colgroup":s.push(e)}}),renderOrRemoveSection(s,"colgroup"),renderOrRemoveSection(n,"thead"),renderOrRemoveSection(a,"tbody"),renderOrRemoveSection(i,"tfoot"),{newRows:o,newCells:l}},copy=e=>map$1(e,e=>{let t=shallow(e.element);return each$2(e.cells,e=>{let o=deep(e.element);setIfNot(o,"colspan",e.colspan,1),setIfNot(o,"rowspan",e.rowspan,1),append$1(t,o)}),t}),getColumn=(e,t)=>map$1(e,e=>getCell(e,t)),getRow=(e,t)=>e[t],findDiff=(e,t)=>{if(0===e.length)return 0;let o=e[0],l=findIndex(e,e=>!t(o.element,e.element));return l.getOr(e.length)},subgrid=(e,t,o,l)=>{let n=getRow(e,t),a="colgroup"===n.section,i=findDiff(n.cells.slice(o),l),s=a?1:findDiff(getColumn(e.slice(t),o),l);return{colspan:i,rowspan:s}},toDetails=(e,t)=>{let o=map$1(e,e=>map$1(e.cells,m)),updateSeen=(e,t,l,n)=>{for(let a=e;a<e+l;a++)for(let e=t;e<t+n;e++)o[a][e]=!0};return map$1(e,(l,n)=>{let a=bind$2(l.cells,(l,a)=>{if(!1!==o[n][a])return[];{let o=subgrid(e,n,a,t);return updateSeen(n,a,o.rowspan,o.colspan),[detailnew(l.element,o.rowspan,o.colspan,l.isNew)]}});return rowdetailnew(l.element,a,l.section,l.isNew)})},toGrid=(e,t,o)=>{let l=[];each$2(e.colgroups,n=>{let a=[];for(let l=0;l<e.grid.columns;l++){let n=et.getColumnAt(e,l).map(e=>elementnew(e.element,o,!1)).getOrThunk(()=>elementnew(t.colGap(),!0,!1));a.push(n)}l.push(rowcells(n.element,a,"colgroup",o))});for(let n=0;n<e.grid.rows;n++){let a=[];for(let l=0;l<e.grid.columns;l++){let i=et.getAt(e,n,l).map(e=>elementnew(e.element,o,e.isLocked)).getOrThunk(()=>elementnew(t.gap(),!0,!1));a.push(i)}let i=e.all[n],s=rowcells(i.element,a,i.section,o);l.push(s)}return l},fromWarehouse=(e,t)=>toGrid(e,t,!1),toDetailList=e=>toDetails(e,eq$1),findInWarehouse=(e,t)=>findMap(e.all,e=>find$1(e.cells,e=>eq$1(t,e.element))),extractCells=(e,t,o)=>{let l=map$1(t.selection,t=>cell(t).bind(t=>findInWarehouse(e,t)).filter(o)),n=cat(l);return someIf(n.length>0,n)},run=(e,t,o,l,n)=>(a,i,s,c)=>{let d=et.fromTable(a),m=Optional.from(null==c?void 0:c.section).getOrThunk(eI.fallback),u=t(d,i).map(t=>{let o=fromWarehouse(d,s),l=e(o,t,eq$1,n(s),m),a=getLockedColumnsFromGrid(l.grid),i=toDetailList(l.grid);return{info:t,grid:i,cursor:l.cursor,lockedColumns:a}});return u.bind(e=>{let t=render$1(a,e.grid),n=Optional.from(null==c?void 0:c.sizing).getOrThunk(()=>ep.getTableSize(a)),i=Optional.from(null==c?void 0:c.resize).getOrThunk(preserveTable);return o(a,e.grid,e.info,{sizing:n,resize:i,section:m}),l(a),remove$7(a,ee),e.lockedColumns.length>0&&set$2(a,ee,e.lockedColumns.join(",")),Optional.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})})},onPasteByEditor=(e,t)=>extractCells(e,t,u).map(e=>({cells:e,generators:t.generators,clipboard:t.clipboard})),onMergable=(e,t)=>t.mergable,onUnmergable=(e,t)=>t.unmergable,onCells=(e,t)=>extractCells(e,t,u),onUnlockedCells=(e,t)=>extractCells(e,t,e=>!e.isLocked),isUnlockedTableCell=(e,t)=>findInWarehouse(e,t).exists(e=>!e.isLocked),allUnlocked=(e,t)=>forall(t,t=>isUnlockedTableCell(e,t)),merge$2=(e,t,o,l)=>{let n=extractGridDetails(e).rows;if(0===n.length)return e;for(let e=t.startRow;e<=t.finishRow;e++)for(let o=t.startCol;o<=t.finishCol;o++){let t=n[e],a=getCell(t,o).isLocked;mutateCell(t,o,elementnew(l(),!1,a))}return e},unmerge=(e,t,o,l)=>{let n=extractGridDetails(e).rows,a=!0;for(let e=0;e<n.length;e++)for(let i=0;i<cellLength(n[0]);i++){let s=n[e],c=getCell(s,i),d=c.element,m=o(d,t);m&&!a?mutateCell(s,i,elementnew(l(),!0,c.isLocked)):m&&(a=!1)}return e},uniqueCells=(e,t)=>foldl(e,(e,o)=>exists(e,e=>t(e.element,o.element))?e:e.concat([o]),[]),splitCols=(e,t,o,l)=>(t>0&&t<e[0].cells.length&&each$2(e,e=>{let n=e.cells[t-1],a=0,i=l();for(;e.cells.length>t+a&&o(n.element,e.cells[t+a].element);)mutateCell(e,t+a,elementnew(i,!0,e.cells[t+a].isLocked)),a++}),e),splitRows=(e,t,o,l)=>{let n=extractGridDetails(e).rows;if(t>0&&t<n.length){let e=n[t-1].cells,a=uniqueCells(e,o);each$2(a,e=>{let a=Optional.none();for(let i=t;i<n.length;i++)for(let t=0;t<cellLength(n[0]);t++){let s=n[i],c=getCell(s,t),d=o(c.element,e.element);d&&(a.isNone()&&(a=Optional.some(l())),a.each(e=>{mutateCell(s,t,elementnew(e,!0,c.isLocked))}))}})}return e},value$1=e=>{let applyHelper=t=>t(e),t=constant(e),outputHelper=()=>o,o={tag:!0,inner:e,fold:(t,o)=>o(e),isValue:u,isError:m,map:t=>eM.value(t(e)),mapError:outputHelper,bind:applyHelper,exists:applyHelper,forall:applyHelper,getOr:t,or:outputHelper,getOrThunk:t,orThunk:outputHelper,getOrDie:t,each:t=>{t(e)},toOptional:()=>Optional.some(e)};return o},error=e=>{let outputHelper=()=>t,t={tag:!1,inner:e,fold:(t,o)=>t(e),isValue:m,isError:u,map:outputHelper,mapError:t=>eM.error(t(e)),bind:outputHelper,exists:m,forall:u,getOr:identity,or:identity,getOrThunk:apply,orThunk:apply,getOrDie:die(String(e)),each:noop,toOptional:Optional.none};return t},eM={value:value$1,error,fromOption:(e,t)=>e.fold(()=>error(t),value$1)},measure=(e,t,o)=>{if(e.row>=t.length||e.column>cellLength(t[0]))return eM.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);let l=t.slice(e.row),n=l[0].cells.slice(e.column),a=cellLength(o[0]),i=o.length;return eM.value({rowDelta:l.length-i,colDelta:n.length-a})},measureWidth=(e,t)=>{let o=cellLength(e[0]),l=cellLength(t[0]);return{rowDelta:0,colDelta:o-l}},measureHeight=(e,t)=>{let o=e.length,l=t.length;return{rowDelta:o-l,colDelta:0}},generateElements=(e,t,o,l)=>{let n="colgroup"===t.section?o.col:o.cell;return range$1(e,e=>elementnew(n(),!0,l(e)))},rowFill=(e,t,o,l)=>{let n=e[e.length-1];return e.concat(range$1(t,()=>{let e="colgroup"===n.section?o.colgroup:o.row,t=clone(n,e,identity),a=generateElements(t.cells.length,t,o,e=>has$1(l,e.toString()));return setCells(t,a)}))},colFill=(e,t,o,l)=>map$1(e,e=>{let n=generateElements(t,e,o,m);return addCells(e,l,n)}),lockedColFill=(e,t,o)=>map$1(e,e=>foldl(o,(o,l)=>{let n=generateElements(1,e,t,u)[0];return addCell(o,l,n)},e)),tailor=(e,t,o)=>{let l=t.colDelta<0?colFill:identity,n=t.rowDelta<0?rowFill:identity,a=getLockedColumnsFromGrid(e),i=cellLength(e[0]),s=exists(a,e=>e===i-1),c=l(e,Math.abs(t.colDelta),o,s?i-1:i),d=getLockedColumnsFromGrid(c);return n(c,Math.abs(t.rowDelta),o,mapToObject(d,u))},isSpanning=(e,t,o,l)=>{let n=getCell(e[t],o),a=curry(l,n.element),i=e[t];return e.length>1&&cellLength(i)>1&&(o>0&&a(getCellElement(i,o-1))||o<i.cells.length-1&&a(getCellElement(i,o+1))||t>0&&a(getCellElement(e[t-1],o))||t<e.length-1&&a(getCellElement(e[t+1],o)))},mergeTables=(e,t,o,l,n,a)=>{let i=e.row,s=e.column,c=o.length,d=cellLength(o[0]),m=i+c,p=s+d+a.length,g=mapToObject(a,u);for(let e=i;e<m;e++){let a=0;for(let c=s;c<p;c++){if(g[c]){a++;continue}isSpanning(t,e,c,n)&&unmerge(t,getCellElement(t[e],c),n,l.cell);let d=c-s-a,m=getCell(o[e-i],d),u=m.element,p=l.replace(u);mutateCell(t[e],c,elementnew(p,!0,m.isLocked))}}return t},getValidStartAddress=(e,t,o)=>{let l=cellLength(t[0]),n=extractGridDetails(t).cols.length+e.row,a=range$1(l-e.column,t=>t+e.column),i=find$1(a,e=>forall(o,t=>t!==e)).getOr(l-1);return{row:n,column:i}},getLockedColumnsWithinBounds=(e,t,o)=>filter$2(o,o=>o>=e.column&&o<=cellLength(t[0])+e.column),merge$1=(e,t,o,l,n)=>{let a=getLockedColumnsFromGrid(t),i=getValidStartAddress(e,t,a),s=extractGridDetails(o).rows,c=getLockedColumnsWithinBounds(i,s,a),d=measure(i,t,s);return d.map(e=>{let o={...e,colDelta:e.colDelta-c.length},a=tailor(t,o,l),d=getLockedColumnsFromGrid(a),m=getLockedColumnsWithinBounds(i,s,d);return mergeTables(i,a,s,l,n,m)})},insertCols=(e,t,o,l,n)=>{splitCols(t,e,n,l.cell);let a=measureHeight(o,t),i=tailor(o,a,l),s=measureHeight(t,i),c=tailor(t,s,l);return map$1(c,(t,o)=>addCells(t,e,i[o].cells))},insertRows=(e,t,o,l,n)=>{splitRows(t,e,n,l.cell);let a=getLockedColumnsFromGrid(t),i=measureWidth(t,o),s={...i,colDelta:i.colDelta-a.length},c=tailor(t,s,l),{cols:d,rows:m}=extractGridDetails(c),u=getLockedColumnsFromGrid(c),p=measureWidth(o,t),g={...p,colDelta:p.colDelta+u.length},f=lockedColFill(o,l,u),h=tailor(f,g,l);return[...d,...m.slice(0,e),...h,...m.slice(e,m.length)]},cloneRow=(e,t,o,l)=>clone(e,e=>l(e,o),t),insertRowAt=(e,t,o,l,n)=>{let{rows:a,cols:i}=extractGridDetails(e),s=a.slice(0,t),c=a.slice(t),d=cloneRow(a[o],(e,o)=>{let i=t>0&&t<a.length&&l(getCellElement(a[t-1],o),getCellElement(a[t],o)),s=i?getCell(a[t],o):elementnew(n(e.element,l),!0,e.isLocked);return s},l,n);return[...i,...s,d,...c]},getElementFor=(e,t,o,l,n,a,i)=>{if("colgroup"!==o&&l)return getCell(e,t);{let t=getCell(e,n);return elementnew(i(t.element,a),!0,!1)}},insertColumnAt=(e,t,o,l,n)=>map$1(e,e=>{let a=t>0&&t<cellLength(e)&&l(getCellElement(e,t-1),getCellElement(e,t)),i=getElementFor(e,t,e.section,a,o,l,n);return addCell(e,t,i)}),deleteColumnsAt=(e,t)=>bind$2(e,e=>{let o=e.cells,l=foldr(t,(e,t)=>t>=0&&t<e.length?e.slice(0,t).concat(e.slice(t+1)):e,o);return l.length>0?[rowcells(e.element,l,e.section,e.isNew)]:[]}),deleteRowsAt=(e,t,o)=>{let{rows:l,cols:n}=extractGridDetails(e);return[...n,...l.slice(0,t),...l.slice(o+1)]},notInStartRow=(e,t,o,l)=>void 0!==getCellElement(e[t],o)&&t>0&&l(getCellElement(e[t-1],o),getCellElement(e[t],o)),notInStartColumn=(e,t,o)=>t>0&&o(getCellElement(e,t-1),getCellElement(e,t)),isDuplicatedCell=(e,t,o,l)=>notInStartRow(e,t,o,l)||notInStartColumn(e[t],o,l),rowReplacerPredicate=(e,t)=>{let o=forall(t,identity)&&isHeaderCells(e.cells);return o?u:(e,o,l)=>{let n=name(e.element);return!("th"===n&&t[l])}},columnReplacePredicate=(e,t)=>{let o=forall(t,identity)&&isHeaderCells(e);return o?u:(e,o,l)=>{let n=name(e.element);return!("th"===n&&t[o])}},determineScope=(e,t,o,l)=>{let hasSpan=e=>"row"===e?hasRowspan(t):hasColspan(t),getScope=e=>hasSpan(e)?`${e}group`:e;if(e)return eF(t)?getScope(o):null;if(!(l&&eF(t)))return null;{let e="row"===o?"col":"row";return getScope(e)}},rowScopeGenerator=(e,t)=>(o,l,n)=>Optional.some(determineScope(e,o.element,"col",t[n])),columnScopeGenerator=(e,t)=>(o,l)=>Optional.some(determineScope(e,o.element,"row",t[l])),replace=(e,t,o)=>elementnew(o(e.element,t),!0,e.isLocked),replaceIn=(e,t,o,l,n,a,i)=>{let isTarget=e=>exists(t,t=>o(e.element,t.element));return map$1(e,(e,t)=>mapCells(e,(e,s)=>{if(!isTarget(e))return e;{let c=i(e,t,s)?n(e,o,l):e;return a(c,t,s).each(e=>{setOptions(c.element,{scope:Optional.from(e)})}),c}}))},getColumnCells=(e,t,o)=>bind$2(e,(l,n)=>isDuplicatedCell(e,n,t,o)?[]:[getCell(l,t)]),getRowCells=(e,t,o)=>{let l=e[t];return bind$2(l.cells,(l,n)=>isDuplicatedCell(e,t,n,o)?[]:[l])},replaceColumns=(e,t,o,l,n)=>{let a=extractGridDetails(e).rows,i=bind$2(t,e=>getColumnCells(a,e,l)),s=map$1(a,e=>isHeaderCells(e.cells)),c=columnReplacePredicate(i,s),d=columnScopeGenerator(o,s);return replaceIn(e,i,l,n,replace,d,c)},replaceRows=(e,t,o,l,n,a,i)=>{let{cols:s,rows:c}=extractGridDetails(e),d=c[t[0]],m=bind$2(t,e=>getRowCells(c,e,n)),u=map$1(d.cells,(e,t)=>isHeaderCells(getColumnCells(c,t,n))),p=[...c];each$2(t,e=>{p[e]=i.transformRow(c[e],o)});let g=[...s,...p],f=rowReplacerPredicate(d,u),h=rowScopeGenerator(l,u);return replaceIn(g,m,n,a,i.transformCell,h,f)},replaceCells=(e,t,o,l)=>{let n=extractGridDetails(e).rows,a=map$1(t,e=>getCell(n[e.row],e.column));return replaceIn(e,a,o,l,replace,Optional.none,u)},eH={generate:e=>{if(!n(e))throw Error("cases must be an array");if(0===e.length)throw Error("there must be at least one case");let t=[],o={};return each$2(e,(l,a)=>{let i=h(l);if(1!==i.length)throw Error("one and only one name per case");let s=i[0],c=l[s];if(void 0!==o[s])throw Error("duplicate key detected:"+s);if("cata"===s)throw Error("cannot have a case named cata (sorry)");if(!n(c))throw Error("case arguments must be an array");t.push(s),o[s]=(...o)=>{let l=o.length;if(l!==c.length)throw Error("Wrong number of arguments to case "+s+". Expected "+c.length+" ("+c+"), got "+l);return{fold:(...t)=>{if(t.length!==e.length)throw Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);let l=t[a];return l.apply(null,o)},match:e=>{let l=h(e);if(t.length!==l.length)throw Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+l.join(","));let n=forall(t,e=>contains$2(l,e));if(!n)throw Error("Not all branches were specified when using match. Specified: "+l.join(", ")+"\nRequired: "+t.join(", "));return e[s].apply(null,o)},log:e=>{console.log(e,{constructors:t,constructor:s,params:o})}}}}),o}},ej=eH.generate([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),eG={...ej},neighbours=(e,t)=>0===e.length?eG.none():1===e.length?eG.only(0):0===t?eG.left(0,1):t===e.length-1?eG.right(t-1,t):t>0&&t<e.length-1?eG.middle(t-1,t,t+1):eG.none(),determine=(e,t,o,l,n)=>{let a=e.slice(0),i=neighbours(e,t),s=constant(map$1(a,constant(0)));return i.fold(s,e=>l.singleColumnWidth(a[e],o),(e,t)=>n.calcLeftEdgeDeltas(a,e,t,o,l.minCellWidth(),l.isRelative),(e,t,i)=>n.calcMiddleDeltas(a,e,t,i,o,l.minCellWidth(),l.isRelative),(e,t)=>n.calcRightEdgeDeltas(a,e,t,o,l.minCellWidth(),l.isRelative))},total=(e,t,o)=>{let l=0;for(let n=e;n<t;n++)l+=void 0!==o[n]?o[n]:0;return l},recalculateWidthForCells=(e,t)=>{let o=et.justCells(e);return map$1(o,e=>{let o=total(e.column,e.column+e.colspan,t);return{element:e.element,width:o,colspan:e.colspan}})},recalculateWidthForColumns=(e,t)=>{let o=et.justColumns(e);return map$1(o,(e,o)=>({element:e.element,width:t[o],colspan:e.colspan}))},recalculateHeightForCells=(e,t)=>{let o=et.justCells(e);return map$1(o,e=>{let o=total(e.row,e.row+e.rowspan,t);return{element:e.element,height:o,rowspan:e.rowspan}})},matchRowHeight=(e,t)=>map$1(e.all,(e,o)=>({element:e.element,height:t[o]})),sumUp=e=>foldr(e,(e,t)=>e+t,0),recalculate=(e,t)=>et.hasColumns(e)?recalculateWidthForColumns(e,t):recalculateWidthForCells(e,t),recalculateAndApply=(e,t,o)=>{let l=recalculate(e,t);each$2(l,e=>{o.setElementWidth(e.element,e.width)})},adjustWidth=(e,t,o,l,n)=>{let a=et.fromTable(e),i=n.getCellDelta(t),s=n.getWidths(a,n),c=o===a.grid.columns-1,d=l.clampTableDelta(s,o,i,n.minCellWidth(),c),m=determine(s,o,d,n,l),u=map$1(m,(e,t)=>e+s[t]);recalculateAndApply(a,u,n),l.resizeTable(n.adjustTableWidth,d,c)},adjustHeight=(e,t,o,l)=>{let n=et.fromTable(e),a=getPixelHeights(n,e,l),i=map$1(a,(e,l)=>o===l?Math.max(t+e,A()):e),s=recalculateHeightForCells(n,i),c=matchRowHeight(n,i);each$2(c,e=>{setHeight(e.element,e.height)}),each$2(s,e=>{setHeight(e.element,e.height)});let d=sumUp(i);setHeight(e,d)},adjustAndRedistributeWidths$1=(e,t,o,l,n)=>{let a=et.generate(t),i=l.getWidths(a,l),s=l.pixelWidth(),{newSizes:c,delta:d}=n.calcRedestributedWidths(i,s,o.pixelDelta,l.isRelative);recalculateAndApply(a,c,l),l.adjustTableWidth(d)},adjustWidthTo=(e,t,o,l)=>{let n=et.generate(t),a=l.getWidths(n,l);recalculateAndApply(n,a,l)},uniqueColumns=e=>foldl(e,(e,t)=>{let o=exists(e,e=>e.column===t.column);return o?e:e.concat([t])},[]).sort((e,t)=>e.column-t.column),e_=isTag("col"),eU=isTag("colgroup"),isRow$1=e=>"tr"===name(e)||eU(e),elementToData=e=>{let t=getAttrValue(e,"colspan",1),o=getAttrValue(e,"rowspan",1);return{element:e,colspan:t,rowspan:o}},getScopeAttribute=e=>getOpt(e,"scope").map(e=>e.substr(0,3)),eV={modification:(e,t=elementToData)=>{let nuCell=t=>e_(t.element)?e.col(t):e.cell(t),nuRow=t=>eU(t.element)?e.colgroup(t):e.row(t),add=e=>{if(isRow$1(e))return nuRow({element:e});{let l=nuCell(t(e));return o=Optional.some({item:e,replacement:l}),l}},o=Optional.none();return{getOrInit:(e,t)=>o.fold(()=>add(e),o=>t(e,o.item)?o.replacement:add(e))}},transform:e=>t=>{let o=[],find=(e,t)=>find$1(o,o=>t(o.item,e)),makeNew=l=>{let n="td"===e?{scope:null}:{},a=t.replace(l,e,n);return o.push({item:l,sub:a}),a};return{replaceOrInit:(e,t)=>isRow$1(e)||e_(e)?e:find(e,t).fold(()=>makeNew(e),o=>t(e,o.item)?o.sub:makeNew(e))}},merging:e=>({unmerge:t=>{let o=getScopeAttribute(t);return o.each(e=>set$2(t,"scope",e)),()=>{let l=e.cell({element:t,colspan:1,rowspan:1});return remove$5(l,"width"),remove$5(t,"width"),o.each(e=>set$2(l,"scope",e)),l}},merge:e=>(remove$5(e[0],"width"),(()=>{let t=cat(map$1(e,getScopeAttribute));if(0===t.length)return Optional.none();{let e=t[0],o=["row","col"],l=exists(t,t=>t!==e&&contains$2(o,t));return l?Optional.none():Optional.from(e)}})().fold(()=>remove$7(e[0],"scope"),t=>set$2(e[0],"scope",t+"group")),constant(e[0]))})},eK=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],isList$1=(e,t)=>{let o=e.property().name(t);return contains$2(["ol","ul"],o)},isBlock$1=(e,t)=>{let o=e.property().name(t);return contains$2(eK,o)},isEmptyTag$1=(e,t)=>contains$2(["br","img","hr","input"],e.property().name(t)),eZ=DomUniverse(),isBlock=e=>isBlock$1(eZ,e),isList=e=>isList$1(eZ,e),isEmptyTag=e=>isEmptyTag$1(eZ,e),merge=e=>{let t=isTag("br"),advancedBr=e=>forall(e,e=>t(e)||v(e)&&0===get$6(e).trim().length),isListItem=e=>"li"===name(e)||ancestor$2(e,isList).isSome(),siblingIsBlock=e=>nextSibling(e).map(e=>!!isBlock(e)||!!isEmptyTag(e)&&"img"!==name(e)).getOr(!1),markCell=e=>last$1(e).bind(o=>{let l=siblingIsBlock(o);return parent(o).map(n=>!0===l||isListItem(n)||t(o)||isBlock(n)&&!eq$1(e,n)?[]:[O.fromTag("br")])}).getOr([]),o=(()=>{let t=bind$2(e,e=>{let t=children$2(e);return advancedBr(t)?[]:t.concat(markCell(e))});return 0===t.length?[O.fromTag("br")]:t})();empty(e[0]),append(e[0],o)},isEditable=e=>isEditable$1(e,!0),prune=e=>{let t=cells$1(e);0===t.length&&remove$6(e)},outcome=(e,t)=>({grid:e,cursor:t}),findEditableCursorPosition=e=>findMap(e,e=>findMap(e.cells,e=>{let t=e.element;return someIf(isEditable(t),t)})),elementFromGrid=(e,t,o)=>{var l,n;let a=extractGridDetails(e).rows;return Optional.from(null===(n=null===(l=a[t])||void 0===l?void 0:l.cells[o])||void 0===n?void 0:n.element).filter(isEditable).orThunk(()=>findEditableCursorPosition(a))},bundle=(e,t,o)=>{let l=elementFromGrid(e,t,o);return outcome(e,l)},uniqueRows=e=>foldl(e,(e,t)=>{let o=exists(e,e=>e.row===t.row);return o?e:e.concat([t])},[]).sort((e,t)=>e.row-t.row),makeRowsSection=(e,t)=>(o,l,n,a,i)=>{let s=uniqueRows(l),c=map$1(s,e=>e.row),d=replaceRows(o,c,e,t,n,a.replaceOrInit,i);return bundle(d,l[0].row,l[0].column)},eQ=makeRowsSection("thead",!0),eY=makeRowsSection("tbody",!1),eJ=makeRowsSection("tfoot",!1),gridifyRows=(e,t,o)=>{let l=fromPastedRows(e,o.section),n=et.generate(l);return toGrid(n,t,!0)},resize=(e,t,o,l)=>adjustWidthTo(e,t,o,l.sizing),adjustAndRedistributeWidths=(e,t,o,l)=>adjustAndRedistributeWidths$1(e,t,o,l.sizing,l.resize),firstColumnIsLocked=(e,t)=>exists(t,e=>0===e.column&&e.isLocked),lastColumnIsLocked=(e,t)=>exists(t,t=>t.column+t.colspan>=e.grid.columns&&t.isLocked),getColumnsWidth=(e,t)=>{let o=columns(e),l=uniqueColumns(t);return foldl(l,(e,t)=>{let l=o[t.column],n=l.map(getOuter$2).getOr(0);return e+n},0)},insertColumnsExtractor=e=>(t,o)=>onCells(t,o).filter(o=>!(e?firstColumnIsLocked:lastColumnIsLocked)(t,o)).map(e=>({details:e,pixelDelta:getColumnsWidth(t,e)})),pasteColumnsExtractor=e=>(t,o)=>onPasteByEditor(t,o).filter(o=>!(e?firstColumnIsLocked:lastColumnIsLocked)(t,o.cells)),eX=eV.transform("th"),e1=eV.transform("td"),e0=run((e,t,o,l)=>{let n=t[0].row,a=uniqueRows(t),i=foldr(a,(e,t)=>{let a=insertRowAt(e.grid,n,t.row+e.delta,o,l.getOrInit);return{grid:a,delta:e.delta+1}},{grid:e,delta:0}).grid;return bundle(i,n,t[0].column)},onCells,noop,noop,eV.modification),e2=run((e,t,o,l)=>{let n=uniqueRows(t),a=n[n.length-1],i=a.row+a.rowspan,s=foldr(n,(e,t)=>insertRowAt(e,i,t.row,o,l.getOrInit),e);return bundle(s,i,t[0].column)},onCells,noop,noop,eV.modification),e9=run((e,t,o,l)=>{let n=t.details,a=uniqueColumns(n),i=a[0].column,s=foldr(a,(e,t)=>{let n=insertColumnAt(e.grid,i,t.column+e.delta,o,l.getOrInit);return{grid:n,delta:e.delta+1}},{grid:e,delta:0}).grid;return bundle(s,n[0].row,i)},insertColumnsExtractor(!0),adjustAndRedistributeWidths,noop,eV.modification),e7=run((e,t,o,l)=>{let n=t.details,a=n[n.length-1],i=a.column+a.colspan,s=uniqueColumns(n),c=foldr(s,(e,t)=>insertColumnAt(e,i,t.column,o,l.getOrInit),e);return bundle(c,n[0].row,i)},insertColumnsExtractor(!1),adjustAndRedistributeWidths,noop,eV.modification),e3=run((e,t,o,l)=>{let n=uniqueColumns(t.details),a=deleteColumnsAt(e,map$1(n,e=>e.column)),i=a.length>0?a[0].cells.length-1:0;return bundle(a,n[0].row,Math.min(n[0].column,i))},(e,t)=>onUnlockedCells(e,t).map(t=>({details:t,pixelDelta:-getColumnsWidth(e,t)})),adjustAndRedistributeWidths,prune,eV.modification),e5=run((e,t,o,l)=>{let n=uniqueRows(t),a=deleteRowsAt(e,n[0].row,n[n.length-1].row),i=a.length>0?a.length-1:0;return bundle(a,Math.min(t[0].row,i),t[0].column)},onCells,noop,prune,eV.modification),e6=run((e,t,o,l)=>{let n=uniqueColumns(t),a=map$1(n,e=>e.column),i=replaceColumns(e,a,!0,o,l.replaceOrInit);return bundle(i,t[0].row,t[0].column)},onUnlockedCells,noop,noop,eX),e4=run((e,t,o,l)=>{let n=uniqueColumns(t),a=map$1(n,e=>e.column),i=replaceColumns(e,a,!1,o,l.replaceOrInit);return bundle(i,t[0].row,t[0].column)},onUnlockedCells,noop,noop,e1),e8=run(eQ,onUnlockedCells,noop,noop,eX),te=run(eY,onUnlockedCells,noop,noop,e1),tt=run(eJ,onUnlockedCells,noop,noop,e1),to=run((e,t,o,l)=>{let n=replaceCells(e,t,o,l.replaceOrInit);return bundle(n,t[0].row,t[0].column)},onUnlockedCells,noop,noop,eX),tl=run((e,t,o,l)=>{let n=replaceCells(e,t,o,l.replaceOrInit);return bundle(n,t[0].row,t[0].column)},onUnlockedCells,noop,noop,e1),tr=run((e,t,o,l)=>{let n=t.cells;merge(n);let a=merge$2(e,t.bounds,o,l.merge(n));return outcome(a,Optional.from(n[0]))},(e,t)=>onMergable(e,t).filter(t=>allUnlocked(e,t.cells)),resize,noop,eV.merging),tn=run((e,t,o,l)=>{let n=foldr(t,(e,t)=>unmerge(e,t,o,l.unmerge(t)),e);return outcome(n,Optional.from(t[0]))},(e,t)=>onUnmergable(e,t).filter(t=>allUnlocked(e,t)),resize,noop,eV.merging),ta=run((e,t,o,l)=>{let n=((e,t)=>{let o=et.fromTable(e);return toGrid(o,t,!0)})(t.clipboard,t.generators),a=address(t.row,t.column),i=merge$1(a,e,n,t.generators,o);return i.fold(()=>outcome(e,Optional.some(t.element)),e=>bundle(e,t.row,t.column))},(e,t)=>cell(t.element).bind(o=>findInWarehouse(e,o).map(e=>{let o={...e,generators:t.generators,clipboard:t.clipboard};return o})),resize,noop,eV.modification),ti=run((e,t,o,l)=>{let n=extractGridDetails(e).rows,a=t.cells[0].column,i=n[t.cells[0].row],s=gridifyRows(t.clipboard,t.generators,i),c=insertCols(a,e,s,t.generators,o);return bundle(c,t.cells[0].row,t.cells[0].column)},pasteColumnsExtractor(!0),noop,noop,eV.modification),ts=run((e,t,o,l)=>{let n=extractGridDetails(e).rows,a=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,i=n[t.cells[0].row],s=gridifyRows(t.clipboard,t.generators,i),c=insertCols(a,e,s,t.generators,o);return bundle(c,t.cells[0].row,t.cells[0].column)},pasteColumnsExtractor(!1),noop,noop,eV.modification),tc=run((e,t,o,l)=>{let n=extractGridDetails(e).rows,a=t.cells[0].row,i=n[a],s=gridifyRows(t.clipboard,t.generators,i),c=insertRows(a,e,s,t.generators,o);return bundle(c,t.cells[0].row,t.cells[0].column)},onPasteByEditor,noop,noop,eV.modification),td=run((e,t,o,l)=>{let n=extractGridDetails(e).rows,a=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,i=n[t.cells[0].row],s=gridifyRows(t.clipboard,t.generators,i),c=insertRows(a,e,s,t.generators,o);return bundle(c,t.cells[0].row,t.cells[0].column)},onPasteByEditor,noop,noop,eV.modification),getColumnsType=(e,t)=>{let o=et.fromTable(e),l=onCells(o,t);return l.bind(e=>{let t=e[e.length-1],l=e[0].column,n=t.column+t.colspan,a=flatten(map$1(o.all,e=>filter$2(e.cells,e=>e.column>=l&&e.column<n)));return findCommonCellType(a)}).getOr("")},getCellsType=(e,t)=>{let o=et.fromTable(e),l=onCells(o,t);return l.bind(findCommonCellType).getOr("")},getRowsType=(e,t)=>{let o=et.fromTable(e),l=onCells(o,t);return l.bind(e=>{let t=e[e.length-1],l=e[0].row,n=t.row+t.rowspan,a=o.all.slice(l,n);return findCommonRowType(a)}).getOr("")},fireNewRow=(e,t)=>e.dispatch("NewRow",{node:t}),fireNewCell=(e,t)=>e.dispatch("NewCell",{node:t}),fireTableModified=(e,t,o)=>{e.dispatch("TableModified",{...o,table:t})},fireTableSelectionChange=(e,t,o,l,n)=>{e.dispatch("TableSelectionChange",{cells:t,start:o,finish:l,otherCells:n})},fireTableSelectionClear=e=>{e.dispatch("TableSelectionClear")},fireObjectResizeStart=(e,t,o,l,n)=>{e.dispatch("ObjectResizeStart",{target:t,width:o,height:l,origin:n})},fireObjectResized=(e,t,o,l,n)=>{e.dispatch("ObjectResized",{target:t,width:o,height:l,origin:n})},tm={structure:!1,style:!0},tu={structure:!0,style:!1},tp={structure:!0,style:!0},get$5=(e,t)=>isTablePercentagesForced(e)?ep.percentageSize(t):isTablePixelsForced(e)?ep.pixelSize(t):ep.getTableSize(t),TableActions=(e,t,o)=>{let isTableBody=e=>"table"===name(getBody(e)),l=getTableCloneElements(e),n=isResizeTableColumnResizing(e)?noop:halve,getTableSectionType=t=>{switch(e$(e)){case"section":return eI.section();case"sectionCells":return eI.sectionCells();case"cells":return eI.cells();default:return eI.getTableSectionType(t,"section")}},setSelectionFromAction=(t,l)=>l.cursor.fold(()=>{let l=cells$1(t);return head(l).filter(inBody).map(l=>{o.clearSelectedCells(t.dom);let n=e.dom.createRng();return n.selectNode(l.dom),e.selection.setRng(n),set$2(l,"data-mce-selected","1"),n})},l=>{let n=freefallRtl(l),a=e.dom.createRng();return a.setStart(n.element.dom,n.offset),a.setEnd(n.element.dom,n.offset),e.selection.setRng(a),o.clearSelectedCells(t.dom),Optional.some(a)}),execute=(o,n,a,i)=>(s,c,d=!1)=>{removeDataStyle(s);let m=O.fromDom(e.getDoc()),u=cellOperations(a,m,l),p={sizing:get$5(e,s),resize:isResizeTableColumnResizing(e)?resizeTable():preserveTable(),section:getTableSectionType(s)};return n(s)?o(s,c,u,p).bind(o=>{t.refresh(s.dom),each$2(o.newRows,t=>{fireNewRow(e,t.dom)}),each$2(o.newCells,t=>{fireNewCell(e,t.dom)});let l=setSelectionFromAction(s,o);return inBody(s)&&(removeDataStyle(s),d||fireTableModified(e,s.dom,i)),l.map(e=>({rng:e,effect:i}))}):Optional.none()},a=execute(e5,t=>!isTableBody(e)||getGridSize(t).rows>1,noop,tu),i=execute(e3,t=>!isTableBody(e)||getGridSize(t).columns>1,noop,tu),s=execute(e0,u,noop,tu),c=execute(e2,u,noop,tu),d=execute(e9,u,n,tu),m=execute(e7,u,n,tu),p=execute(tr,u,noop,tu),g=execute(tn,u,noop,tu),f=execute(ti,u,noop,tu),h=execute(ts,u,noop,tu),b=execute(tc,u,noop,tu),$=execute(td,u,noop,tu),w=execute(ta,u,noop,tp),C=execute(to,u,noop,tu),v=execute(tl,u,noop,tu),y=execute(e6,u,noop,tu),S=execute(e4,u,noop,tu),T=execute(e8,u,noop,tu),R=execute(te,u,noop,tu),x=execute(tt,u,noop,tu);return{deleteRow:a,deleteColumn:i,insertRowsBefore:s,insertRowsAfter:c,insertColumnsBefore:d,insertColumnsAfter:m,mergeCells:p,unmergeCells:g,pasteColsBefore:f,pasteColsAfter:h,pasteRowsBefore:b,pasteRowsAfter:$,pasteCells:w,makeCellsHeader:C,unmakeCellsHeader:v,makeColumnsHeader:y,unmakeColumnsHeader:S,makeRowsHeader:T,makeRowsBody:R,makeRowsFooter:x,getTableRowType:getRowsType,getTableCellType:getCellsType,getTableColType:getColumnsType}},constrainSpan=(e,t,o)=>{let l=getAttrValue(e,t,1);1===o||l<=1?remove$7(e,t):set$2(e,t,Math.min(o,l))},isColInRange=(e,t)=>o=>{let l=o.column+o.colspan-1,n=o.column;return l>=e&&n<t},generateColGroup=(e,t,o)=>{if(!et.hasColumns(e))return[];{let l=filter$2(et.justColumns(e),isColInRange(t,o)),n=map$1(l,e=>{let l=deep(e.element);return constrainSpan(l,"span",o-t),l}),a=O.fromTag("colgroup");return append(a,n),[a]}},generateRows=(e,t,o)=>map$1(e.all,e=>{let l=filter$2(e.cells,isColInRange(t,o)),n=map$1(l,e=>{let l=deep(e.element);return constrainSpan(l,"colspan",o-t),l}),a=O.fromTag("tr");return append(a,n),a}),copyCols=(e,t)=>{let o=et.fromTable(e),l=onUnlockedCells(o,t);return l.map(e=>{let t=e[e.length-1],l=e[0].column,n=t.column+t.colspan,a=generateColGroup(o,l,n),i=generateRows(o,l,n);return[...a,...i]})},copyRows=(e,t,o)=>{let l=et.fromTable(e),n=onCells(l,t);return n.bind(e=>{let t=toGrid(l,o,!1),n=extractGridDetails(t).rows,a=n.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),i=bind$2(a,e=>{let t=filter$2(e.cells,e=>!e.isLocked);return t.length>0?[{...e,cells:t}]:[]}),s=toDetailList(i);return someIf(s.length>0,s)}).map(e=>copy(e))},tg=eH.generate([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),validateFor=(e,t,o)=>{let l=o.substring(0,o.length-e.length),n=parseFloat(l);return l===n.toString()?t(n):tg.invalid(o)},tf={...tg,from:e=>endsWith(e,"%")?validateFor("%",tg.percent,e):endsWith(e,"px")?validateFor("px",tg.pixels,e):tg.invalid(e)},redistributeToPercent=(e,t)=>map$1(e,e=>{let o=tf.from(e);return o.fold(()=>e,e=>e/t*100+"%",e=>e+"%")}),redistributeToPx=(e,t,o)=>{let l=o/t;return map$1(e,e=>{let t=tf.from(e);return t.fold(()=>e,e=>e*l+"px",e=>e/100*o+"px")})},redistributeEmpty=(e,t)=>{let o=e.fold(()=>constant(""),e=>{let o=e/t;return constant(o+"px")},()=>{let e=100/t;return constant(e+"%")});return range$1(t,o)},redistributeValues=(e,t,o)=>e.fold(()=>t,e=>redistributeToPx(t,o,e),e=>redistributeToPercent(t,o)),redistribute$1=(e,t,o)=>{let l=tf.from(o),n=forall(e,e=>"0px"===e)?redistributeEmpty(l,e.length):redistributeValues(l,e,t);return normalize(n)},sum=(e,t)=>0===e.length?t:foldr(e,(e,t)=>tf.from(t).fold(constant(0),identity,identity)+e,0),roundDown=(e,t)=>{let o=Math.floor(e);return{value:o+t,remainder:e-o}},add$3=(e,t)=>tf.from(e).fold(constant(e),e=>e+t+"px",e=>e+t+"%"),normalize=e=>{if(0===e.length)return e;let t=foldr(e,(e,t)=>{let o=tf.from(t).fold(()=>({value:t,remainder:0}),e=>roundDown(e,"px"),e=>({value:e+"%",remainder:0}));return{output:[o.value].concat(e.output),remainder:e.remainder+o.remainder}},{output:[],remainder:0}),o=t.output;return o.slice(0,o.length-1).concat([add$3(o[o.length-1],Math.round(t.remainder))])},th=tf.from,redistributeToW=(e,t,o)=>{each$2(t,t=>{let l=e.slice(t.column,t.colspan+t.column),n=sum(l,k());set$1(t.element,"width",n+o)})},redistributeToColumns=(e,t,o)=>{each$2(t,(t,l)=>{let n=sum([e[l]],k());set$1(t.element,"width",n+o)})},redistributeToH=(e,t,o,l)=>{each$2(o,t=>{let o=e.slice(t.row,t.rowspan+t.row),n=sum(o,A());set$1(t.element,"height",n+l)}),each$2(t,(t,o)=>{set$1(t.element,"height",e[o])})},getUnit=e=>th(e).fold(constant("px"),constant("px"),constant("%")),redistribute=(e,t,o)=>{let l=et.fromTable(e),n=l.all,a=et.justCells(l),i=et.justColumns(l);t.each(t=>{let o=getUnit(t),n=get$9(e),s=getRawWidths(l,e),c=redistribute$1(s,n,t);et.hasColumns(l)?redistributeToColumns(c,i,o):redistributeToW(c,a,o),set$1(e,"width",t)}),o.each(t=>{let o=getUnit(t),i=get$8(e),s=getRawHeights(l,e,el),c=redistribute$1(s,i,t);redistributeToH(c,n,a,o),set$1(e,"height",t)})},isPercentSizing=e=>getRawWidth$1(e).exists(e=>es.test(e)),isPixelSizing=e=>getRawWidth$1(e).exists(e=>ec.test(e)),isNoneSizing=e=>getRawWidth$1(e).isNone(),cleanupLegacyAttributes=e=>{remove$7(e,"width")},convertToPercentSize=e=>{let t=getPercentTableWidth(e);redistribute(e,Optional.some(t),Optional.none()),cleanupLegacyAttributes(e)},convertToPixelSize=e=>{let t=getPixelTableWidth(e);redistribute(e,Optional.some(t),Optional.none()),cleanupLegacyAttributes(e)},convertToNoneSize=e=>{remove$5(e,"width");let t=columns$1(e),o=t.length>0?t:cells$1(e);each$2(o,e=>{remove$5(e,"width"),cleanupLegacyAttributes(e)}),cleanupLegacyAttributes(e)},tb={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},tableHeaderCell=()=>O.fromTag("th"),tableCell=()=>O.fromTag("td"),tableColumn=()=>O.fromTag("col"),createRow=(e,t,o,l)=>{let n=O.fromTag("tr");for(let a=0;a<e;a++){let e=l<t||a<o?tableHeaderCell():tableCell();a<o&&set$2(e,"scope","row"),l<t&&set$2(e,"scope","col"),append$1(e,O.fromTag("br")),append$1(n,e)}return n},createGroupRow=e=>{let t=O.fromTag("colgroup");return range$1(e,()=>append$1(t,tableColumn())),t},createRows=(e,t,o,l)=>range$1(e,e=>createRow(t,o,l,e)),render=(e,t,o,l,n,a=tb)=>{let i=O.fromTag("table"),s="cells"!==n;setAll(i,a.styles),setAll$1(i,a.attributes),a.colGroups&&append$1(i,createGroupRow(t));let c=Math.min(e,o);if(s&&o>0){let e=O.fromTag("thead");append$1(i,e);let a=createRows(o,t,"sectionCells"===n?c:0,l);append(e,a)}let d=O.fromTag("tbody");append$1(i,d);let m=s?0:o,u=createRows(s?e-c:e,t,m,l);return append(d,u),i},get$4=e=>e.dom.innerHTML,getOuter=e=>{let t=O.fromTag("div"),o=O.fromDom(e.dom.cloneNode(!0));return append$1(t,o),get$4(t)},placeCaretInCell=(e,t)=>{e.selection.select(t.dom,!0),e.selection.collapse(!0)},selectFirstCellInTable=(e,t)=>{descendant(t,"td,th").each(curry(placeCaretInCell,e))},fireEvents=(e,t)=>{each$2(descendants(t,"tr"),t=>{fireNewRow(e,t.dom),each$2(descendants(t,"th,td"),t=>{fireNewCell(e,t.dom)})})},isPercentage=e=>o(e)&&-1!==e.indexOf("%"),insert=(e,t,o,l,n)=>{let a=getTableDefaultStyles(e),i={styles:a,attributes:getTableDefaultAttributes(e),colGroups:eO(e)};return e.undoManager.ignore(()=>{let a=render(o,t,n,l,e$(e),i);set$2(a,"data-mce-id","__mce");let s=getOuter(a);e.insertContent(s),e.addVisual()}),descendant(getBody(e),'table[data-mce-id="__mce"]').map(t=>(isTablePixelsForced(e)?convertToPixelSize(t):isTableResponsiveForced(e)?convertToNoneSize(t):(isTablePercentagesForced(e)||isPercentage(a.width))&&convertToPercentSize(t),removeDataStyle(t),remove$7(t,"data-mce-id"),fireEvents(e,t),selectFirstCellInTable(e,t),t.dom)).getOrNull()},insertTable=(e,t,o,l={})=>{let checkInput=e=>d(e)&&e>0;if(!(checkInput(t)&&checkInput(o)))return console.error("Invalid values for mceInsertTable - rows and columns values are required to insert a table."),null;{let n=l.headerRows||0,a=l.headerColumns||0;return insert(e,o,t,a,n)}};var t$=tinymce.util.Tools.resolve("tinymce.FakeClipboard");let tw="x-tinymce/dom-table-",tC=tw+"rows",tv=tw+"columns",setData=e=>{let t=t$.FakeClipboardItem(e);t$.write([t])},getData=e=>{var t;let o=null!==(t=t$.read())&&void 0!==t?t:[];return findMap(o,t=>Optional.from(t.getType(e)))},clearData=e=>{getData(e).isSome()&&t$.clear()},setRows=e=>{e.fold(clearRows,e=>setData({[tC]:e}))},getRows=()=>getData(tC),clearRows=()=>clearData(tC),setColumns=e=>{e.fold(clearColumns,e=>setData({[tv]:e}))},getColumns=()=>getData(tv),clearColumns=()=>clearData(tv),getSelectionStartCellOrCaption=e=>eP(getSelectionStart(e),getIsRoot(e)).filter(isInEditableContext$1),getSelectionStartCell=e=>ez(getSelectionStart(e),getIsRoot(e)).filter(isInEditableContext$1),registerCommands=(e,t)=>{let n=getIsRoot(e),setSizingMode=t=>getSelectionStartCellOrCaption(e).each(o=>{let l=isTableResponsiveForced(e)||isTablePixelsForced(e)||isTablePercentagesForced(e);l||table(o,n).each(o=>{"relative"!==t||isPercentSizing(o)?"fixed"!==t||isPixelSizing(o)?"responsive"!==t||isNoneSizing(o)||convertToNoneSize(o):convertToPixelSize(o):convertToPercentSize(o),removeDataStyle(o),fireTableModified(e,o.dom,tu)})}),getTableFromCell=e=>table(e,n),performActionOnSelection=t=>getSelectionStartCell(e).bind(e=>getTableFromCell(e).map(o=>t(o,e))),postExecute=t=>{e.focus()},actOnSelection=(t,o=!1)=>performActionOnSelection((l,n)=>{let a=forMenu(getCellsFromSelection(e),l,n);t(l,a,o).each(postExecute)}),copyRowSelection=()=>performActionOnSelection((t,o)=>{let l=forMenu(getCellsFromSelection(e),t,o),n=cellOperations(noop,O.fromDom(e.getDoc()),Optional.none());return copyRows(t,l,n)}),copyColSelection=()=>performActionOnSelection((t,o)=>{let l=forMenu(getCellsFromSelection(e),t,o);return copyCols(t,l)}),pasteOnSelection=(t,o)=>o().each(o=>{let l=map$1(o,e=>deep(e));performActionOnSelection((o,n)=>{let a=paste$1(O.fromDom(e.getDoc())),i=pasteRows(getCellsFromSelection(e),n,l,a);t(o,i).each(postExecute)})}),actOnType=e=>(t,o)=>get$c(o,"type").each(t=>{actOnSelection(e(t),o.no_events)});each$1({mceTableSplitCells:()=>actOnSelection(t.unmergeCells),mceTableMergeCells:()=>actOnSelection(t.mergeCells),mceTableInsertRowBefore:()=>actOnSelection(t.insertRowsBefore),mceTableInsertRowAfter:()=>actOnSelection(t.insertRowsAfter),mceTableInsertColBefore:()=>actOnSelection(t.insertColumnsBefore),mceTableInsertColAfter:()=>actOnSelection(t.insertColumnsAfter),mceTableDeleteCol:()=>actOnSelection(t.deleteColumn),mceTableDeleteRow:()=>actOnSelection(t.deleteRow),mceTableCutCol:()=>copyColSelection().each(e=>{setColumns(e),actOnSelection(t.deleteColumn)}),mceTableCutRow:()=>copyRowSelection().each(e=>{setRows(e),actOnSelection(t.deleteRow)}),mceTableCopyCol:()=>copyColSelection().each(e=>setColumns(e)),mceTableCopyRow:()=>copyRowSelection().each(e=>setRows(e)),mceTablePasteColBefore:()=>pasteOnSelection(t.pasteColsBefore,getColumns),mceTablePasteColAfter:()=>pasteOnSelection(t.pasteColsAfter,getColumns),mceTablePasteRowBefore:()=>pasteOnSelection(t.pasteRowsBefore,getRows),mceTablePasteRowAfter:()=>pasteOnSelection(t.pasteRowsAfter,getRows),mceTableDelete:()=>getSelectionStartCellOrCaption(e).each(t=>{table(t,n).filter(not(n)).each(t=>{let o=O.fromText("");if(after$5(t,o),remove$6(t),e.dom.isEmpty(e.getBody()))e.setContent(""),e.selection.setCursorLocation();else{let t=e.dom.createRng();t.setStart(o.dom,0),t.setEnd(o.dom,0),e.selection.setRng(t),e.nodeChanged()}})}),mceTableCellToggleClass:(t,o)=>{performActionOnSelection(t=>{let l=getCellsFromSelection(e),n=forall(l,t=>e.formatter.match("tablecellclass",{value:o},t.dom)),a=n?e.formatter.remove:e.formatter.apply;each$2(l,e=>a("tablecellclass",{value:o},e.dom)),fireTableModified(e,t.dom,tm)})},mceTableToggleClass:(t,o)=>{performActionOnSelection(t=>{e.formatter.toggle("tableclass",{value:o},t.dom),fireTableModified(e,t.dom,tm)})},mceTableToggleCaption:()=>{getSelectionStartCellOrCaption(e).each(t=>{table(t,n).each(o=>{child(o,"caption").fold(()=>{let t=O.fromTag("caption");append$1(t,O.fromText("Caption")),appendAt(o,t,0),e.selection.setCursorLocation(t.dom,0)},l=>{isTag("caption")(t)&&one("td",o).each(t=>e.selection.setCursorLocation(t.dom,0)),remove$6(l)}),fireTableModified(e,o.dom,tu)})})},mceTableSizingMode:(e,t)=>setSizingMode(t),mceTableCellType:actOnType(e=>"th"===e?t.makeCellsHeader:t.unmakeCellsHeader),mceTableColType:actOnType(e=>"th"===e?t.makeColumnsHeader:t.unmakeColumnsHeader),mceTableRowType:actOnType(e=>{switch(e){case"header":return t.makeRowsHeader;case"footer":return t.makeRowsFooter;default:return t.makeRowsBody}})},(t,o)=>e.addCommand(o,t)),e.addCommand("mceInsertTable",(t,o)=>{insertTable(e,o.rows,o.columns,o.options)}),e.addCommand("mceTableApplyCellStyle",(t,n)=>{let getFormatName=e=>"tablecell"+e.toLowerCase().replace("-","");if(!l(n))return;let a=filter$2(getCellsFromSelection(e),isInEditableContext$1);if(0===a.length)return;let i=filter$1(n,(t,l)=>e.formatter.has(getFormatName(l))&&o(t));isEmpty(i)||(each$1(i,(t,o)=>{let l=getFormatName(o);each$2(a,o=>{""===t?e.formatter.remove(l,{value:null},o.dom,!0):e.formatter.apply(l,{value:t},o.dom)})}),getTableFromCell(a[0]).each(t=>fireTableModified(e,t.dom,tm)))})},registerQueryCommands=(e,t)=>{let o=getIsRoot(e),lookupOnSelection=t=>ez(getSelectionStart(e)).bind(l=>table(l,o).map(o=>{let n=forMenu(getCellsFromSelection(e),o,l);return t(o,n)})).getOr("");each$1({mceTableRowType:()=>lookupOnSelection(t.getTableRowType),mceTableCellType:()=>lookupOnSelection(t.getTableCellType),mceTableColType:()=>lookupOnSelection(t.getTableColType)},(t,o)=>e.addQueryValueHandler(o,t))},ty=eH.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),tS=ty.before,tO=ty.on,tT=ty.after,tR={before:tS,on:tO,after:tT,cata:(e,t,o,l)=>e.fold(t,o,l),getStart:e=>e.fold(identity,identity,identity)},tx={create:(e,t)=>({selection:e,kill:t})},selectNode=(e,t)=>{let o=e.document.createRange();return o.selectNode(t.dom),o},selectNodeContents=(e,t)=>{let o=e.document.createRange();return selectNodeContentsUsing(o,t),o},selectNodeContentsUsing=(e,t)=>e.selectNodeContents(t.dom),setStart=(e,t)=>{t.fold(t=>{e.setStartBefore(t.dom)},(t,o)=>{e.setStart(t.dom,o)},t=>{e.setStartAfter(t.dom)})},setFinish=(e,t)=>{t.fold(t=>{e.setEndBefore(t.dom)},(t,o)=>{e.setEnd(t.dom,o)},t=>{e.setEndAfter(t.dom)})},relativeToNative=(e,t,o)=>{let l=e.document.createRange();return setStart(l,t),setFinish(l,o),l},exactToNative=(e,t,o,l,n)=>{let a=e.document.createRange();return a.setStart(t.dom,o),a.setEnd(l.dom,n),a},toRect=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}),getFirstRect$1=e=>{let t=e.getClientRects(),o=t.length>0?t[0]:e.getBoundingClientRect();return o.width>0||o.height>0?Optional.some(o).map(toRect):Optional.none()},tD=eH.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),fromRange=(e,t,o)=>t(O.fromDom(o.startContainer),o.startOffset,O.fromDom(o.endContainer),o.endOffset),getRanges=(e,t)=>t.match({domRange:e=>({ltr:constant(e),rtl:Optional.none}),relative:(t,o)=>({ltr:cached(()=>relativeToNative(e,t,o)),rtl:cached(()=>Optional.some(relativeToNative(e,o,t)))}),exact:(t,o,l,n)=>({ltr:cached(()=>exactToNative(e,t,o,l,n)),rtl:cached(()=>Optional.some(exactToNative(e,l,n,t,o)))})}),doDiagnose=(e,t)=>{let o=t.ltr();if(!o.collapsed)return fromRange(e,tD.ltr,o);{let l=t.rtl().filter(e=>!1===e.collapsed);return l.map(e=>tD.rtl(O.fromDom(e.endContainer),e.endOffset,O.fromDom(e.startContainer),e.startOffset)).getOrThunk(()=>fromRange(e,tD.ltr,o))}},diagnose=(e,t)=>{let o=getRanges(e,t);return doDiagnose(e,o)},asLtrRange=(e,t)=>{let o=diagnose(e,t);return o.match({ltr:(t,o,l,n)=>{let a=e.document.createRange();return a.setStart(t.dom,o),a.setEnd(l.dom,n),a},rtl:(t,o,l,n)=>{let a=e.document.createRange();return a.setStart(l.dom,n),a.setEnd(t.dom,o),a}})};tD.ltr,tD.rtl;let tE={create:(e,t,o,l)=>({start:e,soffset:t,finish:o,foffset:l})},tk={create:(e,t,o,l)=>({start:tR.on(e,t),finish:tR.on(o,l)})},convertToRange=(e,t)=>{let o=asLtrRange(e,t);return tE.create(O.fromDom(o.startContainer),o.startOffset,O.fromDom(o.endContainer),o.endOffset)},tA=tk.create,sync=(e,t,o,l,n,a,i)=>eq$1(o,n)&&l===a?Optional.none():closest$1(o,"td,th",t).bind(o=>closest$1(n,"td,th",t).bind(l=>detect(e,t,o,l,i))),detect=(e,t,o,l,n)=>eq$1(o,l)?Optional.none():identify(o,l,t).bind(t=>{let l=t.boxes.getOr([]);return l.length>1?(n(e,l,t.start,t.finish),Optional.some(tx.create(Optional.some(tA(o,0,o,getEnd(o))),!0))):Optional.none()}),update=(e,t,o,l,n)=>shiftSelection(l,e,t,n.firstSelectedSelector,n.lastSelectedSelector).map(e=>(n.clearBeforeUpdate(o),n.selectRange(o,e.boxes,e.start,e.finish),e.boxes)),traverse=(e,t)=>({item:e,mode:t}),backtrack=(e,t,o,l=sidestep)=>e.property().parent(t).map(e=>traverse(e,l)),sidestep=(e,t,o,l=advance)=>o.sibling(e,t).map(e=>traverse(e,l)),advance=(e,t,o,l=advance)=>{let n=e.property().children(t),a=o.first(n);return a.map(e=>traverse(e,l))},tB=[{current:backtrack,next:sidestep,fallback:Optional.none()},{current:sidestep,next:advance,fallback:Optional.some(backtrack)},{current:advance,next:advance,fallback:Optional.some(sidestep)}],go=(e,t,o,l,n=tB)=>{let a=find$1(n,e=>e.current===o);return a.bind(o=>o.current(e,t,l,o.next).orThunk(()=>o.fallback.bind(o=>go(e,t,o,l))))},hone=(e,t,o,l,n,a)=>{let i=go(e,t,l,n);return i.bind(t=>a(t.item)?Optional.none():o(t.item)?Optional.some(t.item):hone(e,t.item,o,t.mode,n,a))},isLeaf=e=>t=>0===e.property().children(t).length,before$1=(e,t,o)=>seekLeft$1(e,t,isLeaf(e),o),after$2=(e,t,o)=>seekRight$1(e,t,isLeaf(e),o),seekLeft$1=(e,t,o,l)=>hone(e,t,o,sidestep,{sibling:(e,t)=>e.query().prevSibling(t),first:e=>e.length>0?Optional.some(e[e.length-1]):Optional.none()},l),seekRight$1=(e,t,o,l)=>hone(e,t,o,sidestep,{sibling:(e,t)=>e.query().nextSibling(t),first:e=>e.length>0?Optional.some(e[0]):Optional.none()},l),tP=DomUniverse(),before=(e,t)=>before$1(tP,e,t),after$1=(e,t)=>after$2(tP,e,t),seekLeft=(e,t,o)=>seekLeft$1(tP,e,t,o),seekRight=(e,t,o)=>seekRight$1(tP,e,t,o),ancestor=(e,t,o)=>ancestor$2(e,t,o).isSome(),tz=eH.generate([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),isOverlapping=(e,t,o)=>{let l=e.getRect(t),n=e.getRect(o);return n.right>l.left&&n.left<l.right},isRow=e=>closest$1(e,"tr"),tW={...tz,verify:(e,t,o,l,n,a,i)=>closest$1(l,"td,th",i).bind(o=>closest$1(t,"td,th",i).map(t=>eq$1(o,t)?eq$1(l,o)&&getEnd(o)===n?a(t):tz.none("in same cell"):sharedOne(isRow,[o,t]).fold(()=>isOverlapping(e,t,o)?tz.success():a(t),e=>a(t)))).getOr(tz.none("default")),cata:(e,t,o,l,n)=>e.fold(t,o,l,n)},inParent=(e,t,o,l)=>({parent:e,children:t,element:o,index:l}),indexInParent=e=>parent(e).bind(t=>{let o=children$2(t);return indexOf(o,e).map(l=>inParent(t,o,e,l))}),indexOf=(e,t)=>findIndex(e,curry(eq$1,t)),tN=isTag("br"),gatherer=(e,t,o)=>t(e,o).bind(e=>v(e)&&0===get$6(e).trim().length?gatherer(e,t,o):Optional.some(e)),handleBr=(e,t,o)=>o.traverse(t).orThunk(()=>gatherer(t,o.gather,e)).map(o.relative),findBr=(e,t)=>child$2(e,t).filter(tN).orThunk(()=>child$2(e,t-1).filter(tN)),handleParent=(e,t,o,l)=>findBr(t,o).bind(t=>l.traverse(t).fold(()=>gatherer(t,l.gather,e).map(l.relative),e=>indexInParent(e).map(e=>tR.on(e.parent,e.index)))),tryBr=(e,t,o,l)=>{let n=tN(t)?handleBr(e,t,l):handleParent(e,t,o,l);return n.map(e=>({start:e,finish:e}))},process=e=>tW.cata(e,e=>Optional.none(),()=>Optional.none(),e=>Optional.some(point(e,0)),e=>Optional.some(point(e,getEnd(e)))),moveDown=(e,t)=>({left:e.left,top:e.top+t,right:e.right,bottom:e.bottom+t}),moveUp=(e,t)=>({left:e.left,top:e.top-t,right:e.right,bottom:e.bottom-t}),translate=(e,t,o)=>({left:e.left+t,top:e.top+o,right:e.right+t,bottom:e.bottom+o}),getPartialBox=(e,t,o)=>o>=0&&o<getEnd(t)?e.getRangedRect(t,o,t,o+1):o>0?e.getRangedRect(t,o-1,t,o):Optional.none(),toCaret=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom}),getElemBox=(e,t)=>Optional.some(e.getRect(t)),getBoxAt=(e,t,o)=>C(t)?getElemBox(e,t).map(toCaret):v(t)?getPartialBox(e,t,o).map(toCaret):Optional.none(),getEntireBox=(e,t)=>C(t)?getElemBox(e,t).map(toCaret):v(t)?e.getRangedRect(t,0,t,getEnd(t)).map(toCaret):Optional.none(),tL=eH.generate([{none:[]},{retry:["caret"]}]),isOutside=(e,t)=>e.left<t.left||1>Math.abs(t.right-e.left)||e.left>t.right,inOutsideBlock=(e,t,o)=>closest$2(t,isBlock).fold(m,t=>getEntireBox(e,t).exists(e=>isOutside(o,e))),isAtTable=(e,t,o)=>e.elementFromPoint(t,o).filter(e=>"table"===name(e)).isSome(),adjustForTable=(e,t,o,l,n)=>adjustTil(e,t,o,t.move(l,5),n),adjustTil=(e,t,o,l,n)=>0===n?Optional.some(l):isAtTable(e,l.left,t.point(l))?adjustForTable(e,t,o,l,n-1):e.situsFromPoint(l.left,t.point(l)).bind(a=>a.start.fold(Optional.none,a=>getEntireBox(e,a).bind(i=>t.adjuster(e,a,i,o,l).fold(Optional.none,l=>adjustTil(e,t,o,l,n-1))).orThunk(()=>Optional.some(l)),Optional.none)),checkScroll=(e,t,o)=>e.point(t)>o.getInnerHeight()?Optional.some(e.point(t)-o.getInnerHeight()):0>e.point(t)?Optional.some(-e.point(t)):Optional.none(),retry=(e,t,o)=>{let l=e.move(o,5),n=adjustTil(t,e,o,l,100).getOr(l);return checkScroll(e,n,t).fold(()=>t.situsFromPoint(n.left,e.point(n)),o=>(t.scrollBy(0,o),t.situsFromPoint(n.left,e.point(n)-o)))},tF={tryUp:curry(retry,{point:e=>e.top,adjuster:(e,t,o,l,n)=>{let a=moveUp(n,5);return 1>Math.abs(o.top-l.top)||o.bottom<n.top?tL.retry(a):o.bottom===n.top?tL.retry(moveUp(n,1)):inOutsideBlock(e,t,n)?tL.retry(translate(a,5,0)):tL.none()},move:moveUp,gather:before}),tryDown:curry(retry,{point:e=>e.bottom,adjuster:(e,t,o,l,n)=>{let a=moveDown(n,5);return 1>Math.abs(o.bottom-l.bottom)||o.top>n.bottom?tL.retry(a):o.top===n.bottom?tL.retry(moveDown(n,1)):inOutsideBlock(e,t,n)?tL.retry(translate(a,5,0)):tL.none()},move:moveDown,gather:after$1}),getJumpSize:constant(5)},findSpot=(e,t,o)=>e.getSelection().bind(l=>tryBr(t,l.finish,l.foffset,o).fold(()=>Optional.some(point(l.finish,l.foffset)),n=>{let a=e.fromSitus(n),i=tW.verify(e,l.finish,l.foffset,a.finish,a.foffset,o.failure,t);return process(i)})),scan=(e,t,o,l,n,a)=>0===a?Optional.none():tryCursor(e,t,o,l,n).bind(i=>{let s=e.fromSitus(i),c=tW.verify(e,o,l,s.finish,s.foffset,n.failure,t);return tW.cata(c,()=>Optional.none(),()=>Optional.some(i),i=>eq$1(o,i)&&0===l?tryAgain(e,o,l,moveUp,n):scan(e,t,i,0,n,a-1),i=>eq$1(o,i)&&l===getEnd(i)?tryAgain(e,o,l,moveDown,n):scan(e,t,i,getEnd(i),n,a-1))}),tryAgain=(e,t,o,l,n)=>getBoxAt(e,t,o).bind(t=>tryAt(e,n,l(t,tF.getJumpSize()))),tryAt=(e,t,o)=>{let l=detect$2().browser;return l.isChromium()||l.isSafari()||l.isFirefox()?t.retry(e,o):Optional.none()},tryCursor=(e,t,o,l,n)=>getBoxAt(e,o,l).bind(t=>tryAt(e,n,t)),handle$1=(e,t,o)=>findSpot(e,t,o).bind(l=>scan(e,t,l.element,l.offset,o,20).map(e.fromSitus)),inSameTable=(e,t)=>ancestor(e,e=>parent(e).exists(e=>eq$1(e,t))),simulate=(e,t,o,l,n)=>closest$1(l,"td,th",t).bind(l=>closest$1(l,"table",t).bind(a=>inSameTable(n,a)?handle$1(e,t,o).bind(e=>closest$1(e.finish,"td,th",t).map(t=>({start:l,finish:t,range:e}))):Optional.none())),navigate=(e,t,o,l,n,a)=>a(l,t).orThunk(()=>simulate(e,t,o,l,n).map(e=>{let t=e.range;return tx.create(Optional.some(tA(t.start,t.soffset,t.finish,t.foffset)),!0)})),firstUpCheck=(e,t)=>closest$1(e,"tr",t).bind(e=>closest$1(e,"table",t).bind(o=>{let l=descendants(o,"tr");return eq$1(e,l[0])?seekLeft(o,e=>last$1(e).isSome(),t).map(e=>{let t=getEnd(e);return tx.create(Optional.some(tA(e,t,e,t)),!0)}):Optional.none()})),lastDownCheck=(e,t)=>closest$1(e,"tr",t).bind(e=>closest$1(e,"table",t).bind(o=>{let l=descendants(o,"tr");return eq$1(e,l[l.length-1])?seekRight(o,e=>first(e).isSome(),t).map(e=>tx.create(Optional.some(tA(e,0,e,0)),!0)):Optional.none()})),select=(e,t,o,l,n,a,i)=>simulate(e,o,l,n,a).bind(e=>detect(t,o,e.start,e.finish,i)),Cell=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}},singleton=e=>{let t=Cell(Optional.none()),revoke=()=>t.get().each(e);return{clear:()=>{revoke(),t.set(Optional.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:e=>{revoke(),t.set(Optional.some(e))}}},value=()=>{let e=singleton(noop);return{...e,on:t=>e.get().each(t)}},findCell=(e,t)=>closest$1(e,"td,th",t),isInEditableContext=e=>parentElement(e).exists(isEditable$1),MouseSelection=(e,t,o,l)=>{let n=value(),a=n.clear,applySelection=a=>{n.on(n=>{l.clearBeforeUpdate(t),findCell(a.target,o).each(i=>{identify(n,i,o).each(o=>{let n=o.boxes.getOr([]);if(1===n.length){let o=n[0],i="false"===getRaw(o),s=is(closest(a.target),o,eq$1);i&&s&&(l.selectRange(t,n,o,o),e.selectContents(o))}else n.length>1&&(l.selectRange(t,n,o.start,o.finish),e.selectContents(i))})})})};return{clearstate:a,mousedown:e=>{l.clear(t),findCell(e.target,o).filter(isInEditableContext).each(n.set)},mouseover:e=>{applySelection(e)},mouseup:e=>{applySelection(e),a()}}},tI={traverse:nextSibling,gather:after$1,relative:tR.before,retry:tF.tryDown,failure:tW.failedDown},tM={traverse:prevSibling,gather:before,relative:tR.before,retry:tF.tryUp,failure:tW.failedUp},isKey=e=>t=>t===e,tH=isKey(38),tj=isKey(40),isNavigation=e=>e>=37&&e<=40,tG={isBackward:isKey(37),isForward:isKey(39)},tq={isBackward:isKey(39),isForward:isKey(37)},get$3=e=>{let t=void 0!==e?e.dom:document,o=t.body.scrollLeft||t.documentElement.scrollLeft,l=t.body.scrollTop||t.documentElement.scrollTop;return r(o,l)},by=(e,t,o)=>{let l=void 0!==o?o.dom:document,n=l.defaultView;n&&n.scrollBy(e,t)},t_=eH.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),getStart=e=>e.match({domRange:e=>O.fromDom(e.startContainer),relative:(e,t)=>tR.getStart(e),exact:(e,t,o,l)=>e}),tU=t_.domRange,tV=t_.relative,tK=t_.exact,tZ=tE.create,tQ={domRange:tU,relative:tV,exact:tK,exactFromRange:e=>t_.exact(e.start,e.soffset,e.finish,e.foffset),getWin:e=>{let t=getStart(e);return defaultView(t)},range:tZ},tY=document.caretPositionFromPoint?(e,t,o)=>{var l,n;return Optional.from(null===(n=(l=e.dom).caretPositionFromPoint)||void 0===n?void 0:n.call(l,t,o)).bind(t=>{if(null===t.offsetNode)return Optional.none();let o=e.dom.createRange();return o.setStart(t.offsetNode,t.offset),o.collapse(),Optional.some(o)})}:document.caretRangeFromPoint?(e,t,o)=>{var l,n;return Optional.from(null===(n=(l=e.dom).caretRangeFromPoint)||void 0===n?void 0:n.call(l,t,o))}:Optional.none,fromPoint=(e,t,o)=>{let l=O.fromDom(e.document);return tY(l,t,o).map(e=>tE.create(O.fromDom(e.startContainer),e.startOffset,O.fromDom(e.endContainer),e.endOffset))},beforeSpecial=(e,t)=>{let o=name(e);return"input"===o?tR.after(e):contains$2(["br","img"],o)?0===t?tR.before(e):tR.after(e):tR.on(e,t)},preprocessRelative=(e,t)=>{let o=e.fold(tR.before,beforeSpecial,tR.after),l=t.fold(tR.before,beforeSpecial,tR.after);return tQ.relative(o,l)},preprocessExact=(e,t,o,l)=>{let n=beforeSpecial(e,t),a=beforeSpecial(o,l);return tQ.relative(n,a)},makeRange=(e,t,o,l)=>{let n=owner(e),a=n.dom.createRange();return a.setStart(e.dom,t),a.setEnd(o.dom,l),a},after=(e,t,o,l)=>{let n=makeRange(e,t,o,l),a=eq$1(e,o)&&t===l;return n.collapsed&&!a},getNativeSelection=e=>Optional.from(e.getSelection()),doSetNativeRange=(e,t)=>{getNativeSelection(e).each(e=>{e.removeAllRanges(),e.addRange(t)})},doSetRange=(e,t,o,l,n)=>{let a=exactToNative(e,t,o,l,n);doSetNativeRange(e,a)},setLegacyRtlRange=(e,t,o,l,n,a)=>{t.collapse(o.dom,l),t.extend(n.dom,a)},setRangeFromRelative=(e,t)=>diagnose(e,t).match({ltr:(t,o,l,n)=>{doSetRange(e,t,o,l,n)},rtl:(t,o,l,n)=>{getNativeSelection(e).each(a=>{if(a.setBaseAndExtent)a.setBaseAndExtent(t.dom,o,l.dom,n);else if(a.extend)try{setLegacyRtlRange(e,a,t,o,l,n)}catch(a){doSetRange(e,l,n,t,o)}else doSetRange(e,l,n,t,o)})}}),setExact=(e,t,o,l,n)=>{let a=preprocessExact(t,o,l,n);setRangeFromRelative(e,a)},setRelative=(e,t,o)=>{let l=preprocessRelative(t,o);setRangeFromRelative(e,l)},readRange=e=>{if(!(e.rangeCount>0))return Optional.none();{let t=e.getRangeAt(0),o=e.getRangeAt(e.rangeCount-1);return Optional.some(tE.create(O.fromDom(t.startContainer),t.startOffset,O.fromDom(o.endContainer),o.endOffset))}},doGetExact=e=>{if(null===e.anchorNode||null===e.focusNode)return readRange(e);{let t=O.fromDom(e.anchorNode),o=O.fromDom(e.focusNode);return after(t,e.anchorOffset,o,e.focusOffset)?Optional.some(tE.create(t,e.anchorOffset,o,e.focusOffset)):readRange(e)}},setToElement=(e,t,o=!0)=>{let l=(o?selectNodeContents:selectNode)(e,t);doSetNativeRange(e,l)},getExact=e=>getNativeSelection(e).filter(e=>e.rangeCount>0).bind(doGetExact),get$2=e=>getExact(e).map(e=>tQ.exact(e.start,e.soffset,e.finish,e.foffset)),getFirstRect=(e,t)=>{let o=asLtrRange(e,t);return getFirstRect$1(o)},getAtPoint=(e,t,o)=>fromPoint(e,t,o),clear=e=>{getNativeSelection(e).each(e=>e.removeAllRanges())},WindowBridge=e=>({elementFromPoint:(t,o)=>O.fromPoint(O.fromDom(e.document),t,o),getRect:e=>e.dom.getBoundingClientRect(),getRangedRect:(t,o,l,n)=>{let a=tQ.exact(t,o,l,n);return getFirstRect(e,a)},getSelection:()=>get$2(e).map(t=>convertToRange(e,t)),fromSitus:t=>{let o=tQ.relative(t.start,t.finish);return convertToRange(e,o)},situsFromPoint:(t,o)=>getAtPoint(e,t,o).map(e=>tk.create(e.start,e.soffset,e.finish,e.foffset)),clearSelection:()=>{clear(e)},collapseSelection:(t=!1)=>{get$2(e).each(o=>o.fold(e=>e.collapse(t),(o,l)=>{let n=t?o:l;setRelative(e,n,n)},(o,l,n,a)=>{let i=t?o:n,s=t?l:a;setExact(e,i,s,i,s)}))},setSelection:t=>{setExact(e,t.start,t.soffset,t.finish,t.foffset)},setRelativeSelection:(t,o)=>{setRelative(e,t,o)},selectNode:t=>{setToElement(e,t,!1)},selectContents:t=>{setToElement(e,t)},getInnerHeight:()=>e.innerHeight,getScrollY:()=>{let t=get$3(O.fromDom(e.document));return t.top},scrollBy:(t,o)=>{by(t,o,O.fromDom(e.document))}}),rc=(e,t)=>({rows:e,cols:t}),mouse=(e,t,o,l)=>{let n=WindowBridge(e),a=MouseSelection(n,t,o,l);return{clearstate:a.clearstate,mousedown:a.mousedown,mouseover:a.mouseover,mouseup:a.mouseup}},isEditableNode=e=>closest$2(e,isHTMLElement).exists(isEditable$1),isEditableSelection=(e,t)=>isEditableNode(e)||isEditableNode(t),keyboard=(e,t,o,l)=>{let n=WindowBridge(e),clearToNavigate=()=>(l.clear(t),Optional.none());return{keydown:(e,a,i,s,c,d)=>{let m=e.raw,u=m.which,p=!0===m.shiftKey,g=retrieve$1(t,l.selectedSelector).fold(()=>(isNavigation(u)&&!p&&l.clearBeforeUpdate(t),isNavigation(u)&&p&&!isEditableSelection(a,s))?Optional.none:tj(u)&&p?curry(select,n,t,o,tI,s,a,l.selectRange):tH(u)&&p?curry(select,n,t,o,tM,s,a,l.selectRange):tj(u)?curry(navigate,n,o,tI,s,a,lastDownCheck):tH(u)?curry(navigate,n,o,tM,s,a,firstUpCheck):Optional.none,e=>{let update$1=o=>()=>{let a=findMap(o,o=>update(o.rows,o.cols,t,e,l));return a.fold(()=>getEdges(t,l.firstSelectedSelector,l.lastSelectedSelector).map(e=>{let o=tj(u)||d.isForward(u)?tR.after:tR.before;return n.setRelativeSelection(tR.on(e.first,0),o(e.table)),l.clear(t),tx.create(Optional.none(),!0)}),e=>Optional.some(tx.create(Optional.none(),!0)))};return isNavigation(u)&&p&&!isEditableSelection(a,s)?Optional.none:tj(u)&&p?update$1([rc(1,0)]):tH(u)&&p?update$1([rc(-1,0)]):d.isBackward(u)&&p?update$1([rc(0,-1),rc(-1,0)]):d.isForward(u)&&p?update$1([rc(0,1),rc(1,0)]):isNavigation(u)&&!p?clearToNavigate:Optional.none});return g()},keyup:(e,n,a,i,s)=>retrieve$1(t,l.selectedSelector).fold(()=>{let c=e.raw,d=c.which,m=!0===c.shiftKey;return m&&isNavigation(d)&&isEditableSelection(n,i)?sync(t,o,n,a,i,s,l.selectRange):Optional.none()},Optional.none)}},external=(e,t,o,l)=>{let n=WindowBridge(e);return(e,a)=>{l.clearBeforeUpdate(t),identify(e,a,o).each(e=>{let o=e.boxes.getOr([]);l.selectRange(t,o,e.start,e.finish),n.selectContents(a),n.collapseSelection()})}},read=(e,t)=>{let o=get$b(e,t);return void 0===o||""===o?[]:o.split(" ")},add$2=(e,t,o)=>{let l=read(e,t),n=l.concat([o]);return set$2(e,t,n.join(" ")),!0},remove$4=(e,t,o)=>{let l=filter$2(read(e,t),e=>e!==o);return l.length>0?set$2(e,t,l.join(" ")):remove$7(e,t),!1},supports=e=>void 0!==e.dom.classList,get$1=e=>read(e,"class"),add$1=(e,t)=>add$2(e,"class",t),remove$3=(e,t)=>remove$4(e,"class",t),add=(e,t)=>{supports(e)?e.dom.classList.add(t):add$1(e,t)},cleanClass=e=>{let t=supports(e)?e.dom.classList:get$1(e);0===t.length&&remove$7(e,"class")},remove$2=(e,t)=>{if(supports(e)){let o=e.dom.classList;o.remove(t)}else remove$3(e,t);cleanClass(e)},has=(e,t)=>supports(e)&&e.dom.classList.contains(t),remove$1=(e,t)=>{each$2(t,t=>{remove$2(e,t)})},addClass=e=>t=>{add(t,e)},removeClasses=e=>t=>{remove$1(t,e)},tJ={byClass:e=>{let t=addClass(e.selected),o=removeClasses([e.selected,e.lastSelected,e.firstSelected]),clear=t=>{let l=descendants(t,e.selectedSelector);each$2(l,o)};return{clearBeforeUpdate:clear,clear,selectRange:(o,l,n,a)=>{clear(o),each$2(l,t),add(n,e.firstSelected),add(a,e.lastSelected)},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},byAttr:(e,t,o)=>{let removeSelectionAttributes=t=>{remove$7(t,e.selected),remove$7(t,e.firstSelected),remove$7(t,e.lastSelected)},addSelectionAttribute=t=>{set$2(t,e.selected,"1")},clear=e=>{clearBeforeUpdate(e),o()},clearBeforeUpdate=t=>{let o=descendants(t,`${e.selectedSelector},${e.firstSelectedSelector},${e.lastSelectedSelector}`);each$2(o,removeSelectionAttributes)};return{clearBeforeUpdate,clear,selectRange:(o,l,n,a)=>{clear(o),each$2(l,addSelectionAttribute),set$2(n,e.firstSelected,"1"),set$2(a,e.lastSelected,"1"),t(l,n,a)},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}}},fold=(e,t,o,l)=>{switch(e.tag){case"none":return t();case"single":return l(e.element);case"multiple":return o(e.elements)}},none=()=>({tag:"none"}),multiple=e=>({tag:"multiple",elements:e}),single=e=>({tag:"single",element:e}),Selections=(e,t,o)=>({get:()=>retrieve(e(),o).fold(()=>t().fold(none,single),multiple)}),getUpOrLeftCells=(e,t)=>{let o=e.slice(0,t[t.length-1].row+1),l=toDetailList(o);return bind$2(l,e=>{let o=e.cells.slice(0,t[t.length-1].column+1);return map$1(o,e=>e.element)})},getDownOrRightCells=(e,t)=>{let o=e.slice(t[0].row+t[0].rowspan-1,e.length),l=toDetailList(o);return bind$2(l,e=>{let o=e.cells.slice(t[0].column+t[0].colspan-1,e.cells.length);return map$1(o,e=>e.element)})},getOtherCells=(e,t,o)=>{let l=et.fromTable(e),n=onCells(l,t);return n.map(e=>{let t=toGrid(l,o,!1),{rows:n}=extractGridDetails(t),a=getUpOrLeftCells(n,e),i=getDownOrRightCells(n,e);return{upOrLeftCells:a,downOrRightCells:i}})},mkEvent=(e,t,o,l,n,a,i)=>({target:e,x:t,y:o,stop:l,prevent:n,kill:a,raw:i}),fromRawEvent$1=e=>{let t=O.fromDom(getOriginalEventTarget(e).getOr(e.target)),stop=()=>e.stopPropagation(),prevent=()=>e.preventDefault(),o=compose(prevent,stop);return mkEvent(t,e.clientX,e.clientY,stop,prevent,o,e)},handle=(e,t)=>o=>{e(o)&&t(fromRawEvent$1(o))},binder=(e,t,o,l,n)=>{let a=handle(o,l);return e.dom.addEventListener(t,a,n),{unbind:curry(unbind,e,t,a,n)}},bind$1=(e,t,o,l)=>binder(e,t,o,l,!1),unbind=(e,t,o,l)=>{e.dom.removeEventListener(t,o,l)},bind=(e,t,o)=>bind$1(e,t,u,o),hasInternalTarget=e=>!has(O.fromDom(e.target),"ephox-snooker-resizer-bar"),TableCellSelectionHandler=(e,t)=>{let o=Selections(()=>O.fromDom(e.getBody()),()=>ez(getSelectionStart(e),getIsRoot(e)),eB.selectedSelector),l=tJ.byAttr(eB,(t,o,l)=>{let n=table(o);n.each(n=>{let a=getTableCloneElements(e),i=cellOperations(noop,O.fromDom(e.getDoc()),a),s=getCellsFromSelection(e),c=getOtherCells(n,{selection:s},i);fireTableSelectionChange(e,t,o,l,c)})},()=>fireTableSelectionClear(e));return e.on("init",o=>{let n=e.getWin(),a=getBody(e),i=getIsRoot(e),s=mouse(n,a,i,l),c=keyboard(n,a,i,l),d=external(n,a,i,l),hasShiftKey=e=>!0===e.raw.shiftKey;e.on("TableSelectorChange",e=>d(e.start,e.finish));let handleResponse=(t,o)=>{hasShiftKey(t)&&(o.kill&&t.kill(),o.selection.each(t=>{let o=tQ.relative(t.start,t.finish),l=asLtrRange(n,o);e.selection.setRng(l)}))},isLeftMouse=e=>0===e.button,isLeftButtonPressed=e=>void 0===e.buttons||(1&e.buttons)!=0,m=(()=>{let e=Cell(O.fromDom(a)),t=Cell(0);return{touchEnd:o=>{let l=O.fromDom(o.target);if(isTag("td")(l)||isTag("th")(l)){let n=e.get(),a=t.get();eq$1(n,l)&&o.timeStamp-a<300&&(o.preventDefault(),d(l,l))}e.set(l),t.set(o.timeStamp)}}})();e.on("dragstart",e=>{s.clearstate()}),e.on("mousedown",e=>{isLeftMouse(e)&&hasInternalTarget(e)&&s.mousedown(fromRawEvent$1(e))}),e.on("mouseover",e=>{isLeftButtonPressed(e)&&hasInternalTarget(e)&&s.mouseover(fromRawEvent$1(e))}),e.on("mouseup",e=>{isLeftMouse(e)&&hasInternalTarget(e)&&s.mouseup(fromRawEvent$1(e))}),e.on("touchend",m.touchEnd),e.on("keyup",t=>{let o=fromRawEvent$1(t);if(o.raw.shiftKey&&isNavigation(o.raw.which)){let t=e.selection.getRng(),l=O.fromDom(t.startContainer),n=O.fromDom(t.endContainer);c.keyup(o,l,t.startOffset,n,t.endOffset).each(e=>{handleResponse(o,e)})}}),e.on("keydown",o=>{let l=fromRawEvent$1(o);t.hide();let n=e.selection.getRng(),a=O.fromDom(n.startContainer),i=O.fromDom(n.endContainer),s=onDirection(tG,tq)(O.fromDom(e.selection.getStart()));c.keydown(l,a,n.startOffset,i,n.endOffset,s).each(e=>{handleResponse(l,e)}),t.show()}),e.on("NodeChange",()=>{let t=e.selection,o=O.fromDom(t.getStart()),n=O.fromDom(t.getEnd()),i=sharedOne(table,[o,n]);i.fold(()=>l.clear(a),noop)})}),e.on("PreInit",()=>{e.serializer.addTempAttr(eB.firstSelected),e.serializer.addTempAttr(eB.lastSelected)}),{getSelectedCells:()=>fold(o.get(),constant([]),e=>map$1(e,e=>e.dom),e=>[e.dom]),clearSelectedCells:e=>l.clear(O.fromDom(e))}},Event=e=>{let t=[];return{bind:e=>{if(void 0===e)throw Error("Event bind error: undefined handler");t.push(e)},unbind:e=>{t=filter$2(t,t=>t!==e)},trigger:(...o)=>{let l={};each$2(e,(e,t)=>{l[e]=o[t]}),each$2(t,e=>{e(l)})}}},create$1=e=>{let t=map(e,e=>({bind:e.bind,unbind:e.unbind})),o=map(e,e=>e.trigger);return{registry:t,trigger:o}},last=(e,t)=>{let o=null,cancel=()=>{a(o)||(clearTimeout(o),o=null)};return{cancel,throttle:(...l)=>{cancel(),o=setTimeout(()=>{o=null,e.apply(null,l)},t)}}},sort=e=>e.slice(0).sort(),reqMessage=(e,t)=>{throw Error("All required keys ("+sort(e).join(", ")+") were not specified. Specified keys were: "+sort(t).join(", ")+".")},unsuppMessage=e=>{throw Error("Unsupported keys for object: "+sort(e).join(", "))},validateStrArr=(e,t)=>{if(!n(t))throw Error("The "+e+" fields must be an array. Was: "+t+".");each$2(t,t=>{if(!o(t))throw Error("The value "+t+" in the "+e+" fields was not a string.")})},invalidTypeMessage=(e,t)=>{throw Error("All values need to be of type: "+t+". Keys ("+sort(e).join(", ")+") were not.")},checkDupes=e=>{let t=sort(e),o=find$1(t,(e,o)=>o<t.length-1&&e===t[o+1]);o.each(e=>{throw Error("The field: "+e+" occurs more than once in the combined fields: ["+t.join(", ")+"].")})},base=(e,t)=>baseWith(e,t,{validate:c,label:"function"}),baseWith=(e,t,o)=>{if(0===t.length)throw Error("You must specify at least one required field.");return validateStrArr("required",t),checkDupes(t),l=>{let n=h(l),a=forall(t,e=>contains$2(n,e));a||reqMessage(t,n),e(t,n);let i=filter$2(t,e=>!o.validate(l[e],e));return i.length>0&&invalidTypeMessage(i,o.label),l}},handleExact=(e,t)=>{let o=filter$2(t,t=>!contains$2(e,t));o.length>0&&unsuppMessage(o)},exactly=e=>base(handleExact,e),tX=exactly(["compare","extract","mutate","sink"]),t1=exactly(["element","start","stop","destroy"]),t0=exactly(["forceDrop","drop","move","delayDrop"]),InDrag=()=>{let e=Optional.none(),update=(t,o)=>{let l=e.map(e=>t.compare(e,o));return e=Optional.some(o),l},t=create$1({move:Event(["info"])});return{onEvent:(e,o)=>{let l=o.extract(e);l.each(e=>{let l=update(o,e);l.each(e=>{t.trigger.move(e)})})},reset:()=>{e=Optional.none()},events:t.registry}},NoDrag=()=>{let e=create$1({move:Event(["info"])});return{onEvent:noop,reset:noop,events:e.registry}},Movement=()=>{let e=NoDrag(),t=InDrag(),o=e;return{on:()=>{o.reset(),o=t},off:()=>{o.reset(),o=e},isOn:()=>o===t,onEvent:(e,t)=>{o.onEvent(e,t)},events:t.events}},setup=(e,t,o)=>{let l=!1,n=create$1({start:Event([]),stop:Event([])}),a=Movement(),drop=()=>{s.stop(),a.isOn()&&(a.off(),n.trigger.stop())},i=last(drop,200);a.events.move.bind(o=>{t.mutate(e,o.info)});let runIfActive=e=>(...t)=>{l&&e.apply(null,t)},s=t.sink(t0({forceDrop:drop,drop:runIfActive(drop),move:runIfActive(e=>{i.cancel(),a.onEvent(e,t)}),delayDrop:runIfActive(i.throttle)}),o);return{element:s.element,go:e=>{s.start(e),a.on(),n.trigger.start()},on:()=>{l=!0},off:()=>{l=!1},isActive:()=>l,destroy:()=>{s.destroy()},events:n.registry}},css=e=>{let t=e.replace(/\./g,"-");return{resolve:e=>t+"-"+e}},t2=css("ephox-dragster"),t9=t2.resolve,Blocker=e=>{let t={layerClass:t9("blocker"),...e},o=O.fromTag("div");set$2(o,"role","presentation"),setAll(o,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),add(o,t9("blocker")),add(o,t.layerClass);let l=constant(o);return{element:l,destroy:()=>{remove$6(o)}}};var t7=tX({compare:(e,t)=>r(t.left-e.left,t.top-e.top),extract:e=>Optional.some(r(e.x,e.y)),sink:(e,t)=>{let o=Blocker(t),l=bind(o.element(),"mousedown",e.forceDrop),n=bind(o.element(),"mouseup",e.drop),a=bind(o.element(),"mousemove",e.move),i=bind(o.element(),"mouseout",e.delayDrop);return t1({element:o.element,start:e=>{append$1(e,o.element())},stop:()=>{remove$6(o.element())},destroy:()=>{o.destroy(),n.unbind(),a.unbind(),i.unbind(),l.unbind()}})},mutate:(e,t)=>{e.mutate(t.left,t.top)}});let transform=(e,t={})=>{var o;let l=null!==(o=t.mode)&&void 0!==o?o:t7;return setup(e,l,t)},t3=css("ephox-snooker"),t5=t3.resolve,Mutation=()=>{let e=create$1({drag:Event(["xDelta","yDelta"])});return{mutate:(t,o)=>{e.trigger.drag(t,o)},events:e.registry}},BarMutation=()=>{let e=create$1({drag:Event(["xDelta","yDelta","target"])}),t=Optional.none(),o=Mutation();return o.events.drag.bind(o=>{t.each(t=>{e.trigger.drag(o.xDelta,o.yDelta,t)})}),{assign:e=>{t=Optional.some(e)},get:()=>t,mutate:o.mutate,events:e.registry}},col=(e,t,o,l,n)=>{let a=O.fromTag("div");return setAll(a,{position:"absolute",left:t-l/2+"px",top:o+"px",height:n+"px",width:l+"px"}),setAll$1(a,{"data-column":e,role:"presentation"}),a},row=(e,t,o,l,n)=>{let a=O.fromTag("div");return setAll(a,{position:"absolute",left:t+"px",top:o-n/2+"px",height:n+"px",width:l+"px"}),setAll$1(a,{"data-row":e,role:"presentation"}),a},t6=t5("resizer-bar"),t4=t5("resizer-rows"),t8=t5("resizer-cols"),resizableRows=(e,t)=>bind$2(e.all,(e,o)=>t(e.element)?[o]:[]),resizableColumns=(e,t)=>{let o=[];return range$1(e.grid.columns,l=>{let n=et.getColumnAt(e,l).map(e=>e.element);n.forall(t)&&o.push(l)}),filter$2(o,o=>{let l=et.filterItems(e,e=>e.column===o);return forall(l,e=>t(e.element))})},destroy=e=>{let t=descendants(e.parent(),"."+t6);each$2(t,remove$6)},drawBar=(e,t,o)=>{let l=e.origin();each$2(t,t=>{t.each(t=>{let n=o(l,t);add(n,t6),append$1(e.parent(),n)})})},refreshCol=(e,t,o,l)=>{drawBar(e,t,(e,t)=>{let n=col(t.col,t.x-e.left,o.top-e.top,7,l);return add(n,t8),n})},refreshRow=(e,t,o,l)=>{drawBar(e,t,(e,t)=>{let n=row(t.row,o.left-e.left,t.y-e.top,l,7);return add(n,t4),n})},refreshGrid=(e,t,o,l,n)=>{let a=absolute(o),i=t.isResizable,s=l.length>0?el.positions(l,o):[],c=s.length>0?resizableRows(e,i):[],d=filter$2(s,(e,t)=>exists(c,e=>t===e));refreshRow(t,d,a,getOuter$2(o));let m=n.length>0?en.positions(n,o):[],u=m.length>0?resizableColumns(e,i):[],p=filter$2(m,(e,t)=>exists(u,e=>t===e));refreshCol(t,p,a,getOuter$1(o))},refresh=(e,t)=>{if(destroy(e),e.isResizable(t)){let o=et.fromTable(t),l=rows(o),n=columns(o);refreshGrid(o,e,t,l,n)}},each=(e,t)=>{let o=descendants(e.parent(),"."+t6);each$2(o,t)},hide=e=>{each(e,e=>{set$1(e,"display","none")})},show=e=>{each(e,e=>{set$1(e,"display","block")})},isRowBar=e=>has(e,t4),isColBar=e=>has(e,t8),oe=t5("resizer-bar-dragging"),BarManager=e=>{let t=BarMutation(),o=transform(t,{}),l=Optional.none(),getResizer=(e,t)=>Optional.from(get$b(e,t));t.events.drag.bind(e=>{getResizer(e.target,"data-row").each(t=>{let o=getCssValue(e.target,"top");set$1(e.target,"top",o+e.yDelta+"px")}),getResizer(e.target,"data-column").each(t=>{let o=getCssValue(e.target,"left");set$1(e.target,"left",o+e.xDelta+"px")})});let getDelta=(e,t)=>{let o=getCssValue(e,t),l=getAttrValue(e,"data-initial-"+t,0);return o-l};o.events.stop.bind(()=>{t.get().each(t=>{l.each(o=>{getResizer(t,"data-row").each(e=>{let l=getDelta(t,"top");remove$7(t,"data-initial-top"),i.trigger.adjustHeight(o,l,parseInt(e,10))}),getResizer(t,"data-column").each(e=>{let l=getDelta(t,"left");remove$7(t,"data-initial-left"),i.trigger.adjustWidth(o,l,parseInt(e,10))}),refresh(e,o)})})});let handler=(l,n)=>{i.trigger.startAdjust(),t.assign(l),set$2(l,"data-initial-"+n,getCssValue(l,n)),add(l,oe),set$1(l,"opacity","0.2"),o.go(e.parent())},n=bind(e.parent(),"mousedown",e=>{isRowBar(e.target)&&handler(e.target,"top"),isColBar(e.target)&&handler(e.target,"left")}),isRoot=t=>eq$1(t,e.view()),findClosestEditableTable=e=>closest$1(e,"table",isRoot).filter(isEditable$1),a=bind(e.view(),"mouseover",t=>{findClosestEditableTable(t.target).fold(()=>{inBody(t.target)&&destroy(e)},t=>{o.isActive()&&(l=Optional.some(t),refresh(e,t))})}),i=create$1({adjustHeight:Event(["table","delta","row"]),adjustWidth:Event(["table","delta","column"]),startAdjust:Event([])});return{destroy:()=>{n.unbind(),a.unbind(),o.destroy(),destroy(e)},refresh:t=>{refresh(e,t)},on:o.on,off:o.off,hideBars:curry(hide,e),showBars:curry(show,e),events:i.registry}},ot={create:(e,t,o)=>{let l=BarManager(e),n=create$1({beforeResize:Event(["table","type"]),afterResize:Event(["table","type"]),startDrag:Event([])});return l.events.adjustHeight.bind(e=>{let t=e.table;n.trigger.beforeResize(t,"row");let o=el.delta(e.delta,t);adjustHeight(t,o,e.row,el),n.trigger.afterResize(t,"row")}),l.events.startAdjust.bind(e=>{n.trigger.startDrag()}),l.events.adjustWidth.bind(e=>{let l=e.table;n.trigger.beforeResize(l,"col");let a=en.delta(e.delta,l),i=o(l);adjustWidth(l,a,e.column,t,i),n.trigger.afterResize(l,"col")}),{on:l.on,off:l.off,refreshBars:l.refresh,hideBars:l.hideBars,showBars:l.showBars,destroy:l.destroy,events:n.registry}}},oo={only:(e,t)=>{let o=y(e)?documentElement(e):e;return{parent:constant(o),view:constant(e),origin:constant(r(0,0)),isResizable:t}},detached:(e,t,o)=>({parent:constant(t),view:constant(e),origin:()=>absolute(t),isResizable:o}),body:(e,t,o)=>({parent:constant(t),view:constant(e),origin:constant(r(0,0)),isResizable:o})},createContainer=()=>{let e=O.fromTag("div");return setAll(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),append$1(body$1(),e),e},get=(e,t)=>e.inline?oo.body(O.fromDom(e.getBody()),createContainer(),t):oo.only(O.fromDom(e.getDoc()),t),remove=(e,t)=>{e.inline&&remove$6(t.parent())},isTable=e=>isNonNullable(e)&&"TABLE"===e.nodeName,ol="bar-",isResizable=e=>"false"!==get$b(e,"data-mce-resize"),syncPixels=e=>{let t=et.fromTable(e);et.hasColumns(t)||each$2(cells$1(e),e=>{let t=get$a(e,"width");set$1(e,"width",t),remove$7(e,"width")})},TableResizeHandler=e=>{let t,o;let l=value(),n=value(),a=value(),lazySizing=t=>get$5(e,t),lazyResizingBehaviour=()=>isPreserveTableColumnResizing(e)?preserveTable():resizeTable(),getNumColumns=e=>getGridSize(e).columns,afterCornerResize=(l,n,a)=>{let i=endsWith(n,"e");if(""===o&&convertToPercentSize(l),a!==t&&""!==o){set$1(l,"width",o);let n=lazyResizingBehaviour(),s=lazySizing(l),c=isPreserveTableColumnResizing(e)||i?getNumColumns(l)-1:0;adjustWidth(l,a-t,c,n,s)}else if(isPercentage$1(o)){let e=parseFloat(o.replace("%","")),n=a*e/t;set$1(l,"width",n+"%")}isPixel(o)&&syncPixels(l)},destroy=()=>{n.on(e=>{e.destroy()}),a.on(t=>{remove(e,t)})};return e.on("init",()=>{let t=get(e,isResizable);if(a.set(t),hasTableObjectResizing(e)&&ev(e)){let o=lazyResizingBehaviour(),a=ot.create(t,o,lazySizing);a.on(),a.events.startDrag.bind(t=>{l.set(e.selection.getRng())}),a.events.beforeResize.bind(t=>{let o=t.table.dom;fireObjectResizeStart(e,o,getPixelWidth(o),getPixelHeight(o),ol+t.type)}),a.events.afterResize.bind(t=>{let o=t.table,n=o.dom;removeDataStyle(o),l.on(t=>{e.selection.setRng(t),e.focus()}),fireObjectResized(e,n,getPixelWidth(n),getPixelHeight(n),ol+t.type),e.undoManager.add()}),n.set(a)}}),e.on("ObjectResizeStart",l=>{let n=l.target;if(isTable(n)){let a=O.fromDom(n);each$2(e.dom.select(".mce-clonedresizable"),t=>{e.dom.addClass(t,"mce-"+ew(e)+"-columns")}),!isPixelSizing(a)&&isTablePixelsForced(e)?convertToPixelSize(a):!isPercentSizing(a)&&isTablePercentagesForced(e)&&convertToPercentSize(a),isNoneSizing(a)&&startsWith(l.origin,ol)&&convertToPercentSize(a),t=l.width,o=isTableResponsiveForced(e)?"":getRawWidth(e,n).getOr("")}}),e.on("ObjectResized",t=>{let o=t.target;if(isTable(o)){let l=O.fromDom(o),n=t.origin;startsWith(n,"corner-")&&afterCornerResize(l,n,t.width),removeDataStyle(l),fireTableModified(e,l.dom,tm)}}),e.on("SwitchMode",()=>{n.on(t=>{e.mode.isReadOnly()?t.hideBars():t.showBars()})}),e.on("dragstart dragend",e=>{n.on(t=>{"dragstart"===e.type?(t.hideBars(),t.off()):(t.on(),t.showBars())})}),e.on("remove",()=>{destroy()}),{refresh:e=>{n.on(t=>t.refreshBars(O.fromDom(e)))},hide:()=>{n.on(e=>e.hideBars())},show:()=>{n.on(e=>e.showBars())}}},setupTable=e=>{register(e);let t=TableResizeHandler(e),o=TableCellSelectionHandler(e,t),l=TableActions(e,t,o);return registerCommands(e,l),registerQueryCommands(e,l),registerEvents(e,l),{getSelectedCells:o.getSelectedCells,clearSelectedCells:o.clearSelectedCells}};t.add("dom",e=>{let t=setupTable(e);return{table:t}})}();